function oN(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const u=Object.getOwnPropertyDescriptor(r,s);u&&Object.defineProperty(t,s,u.get?u:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerPolicy&&(u.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?u.credentials="include":s.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(s){if(s.ep)return;s.ep=!0;const u=n(s);fetch(s.href,u)}})();var m2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function HS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ls(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var aN={exports:{}},WS={},lN={exports:{}},Ns={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l9=Symbol.for("react.element"),_W=Symbol.for("react.portal"),vW=Symbol.for("react.fragment"),xW=Symbol.for("react.strict_mode"),bW=Symbol.for("react.profiler"),wW=Symbol.for("react.provider"),EW=Symbol.for("react.context"),SW=Symbol.for("react.forward_ref"),TW=Symbol.for("react.suspense"),MW=Symbol.for("react.memo"),kW=Symbol.for("react.lazy"),uL=Symbol.iterator;function CW(t){return t===null||typeof t!="object"?null:(t=uL&&t[uL]||t["@@iterator"],typeof t=="function"?t:null)}var uN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cN=Object.assign,hN={};function qb(t,e,n){this.props=t,this.context=e,this.refs=hN,this.updater=n||uN}qb.prototype.isReactComponent={};qb.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qb.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dN(){}dN.prototype=qb.prototype;function g2(t,e,n){this.props=t,this.context=e,this.refs=hN,this.updater=n||uN}var y2=g2.prototype=new dN;y2.constructor=g2;cN(y2,qb.prototype);y2.isPureReactComponent=!0;var cL=Array.isArray,fN=Object.prototype.hasOwnProperty,_2={current:null},pN={key:!0,ref:!0,__self:!0,__source:!0};function mN(t,e,n){var r,s={},u=null,p=null;if(e!=null)for(r in e.ref!==void 0&&(p=e.ref),e.key!==void 0&&(u=""+e.key),e)fN.call(e,r)&&!pN.hasOwnProperty(r)&&(s[r]=e[r]);var g=arguments.length-2;if(g===1)s.children=n;else if(1<g){for(var l=Array(g),E=0;E<g;E++)l[E]=arguments[E+2];s.children=l}if(t&&t.defaultProps)for(r in g=t.defaultProps,g)s[r]===void 0&&(s[r]=g[r]);return{$$typeof:l9,type:t,key:u,ref:p,props:s,_owner:_2.current}}function IW(t,e){return{$$typeof:l9,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function v2(t){return typeof t=="object"&&t!==null&&t.$$typeof===l9}function AW(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hL=/\/+/g;function b6(t,e){return typeof t=="object"&&t!==null&&t.key!=null?AW(""+t.key):e.toString(36)}function hE(t,e,n,r,s){var u=typeof t;(u==="undefined"||u==="boolean")&&(t=null);var p=!1;if(t===null)p=!0;else switch(u){case"string":case"number":p=!0;break;case"object":switch(t.$$typeof){case l9:case _W:p=!0}}if(p)return p=t,s=s(p),t=r===""?"."+b6(p,0):r,cL(s)?(n="",t!=null&&(n=t.replace(hL,"$&/")+"/"),hE(s,e,n,"",function(E){return E})):s!=null&&(v2(s)&&(s=IW(s,n+(!s.key||p&&p.key===s.key?"":(""+s.key).replace(hL,"$&/")+"/")+t)),e.push(s)),1;if(p=0,r=r===""?".":r+":",cL(t))for(var g=0;g<t.length;g++){u=t[g];var l=r+b6(u,g);p+=hE(u,e,n,l,s)}else if(l=CW(t),typeof l=="function")for(t=l.call(t),g=0;!(u=t.next()).done;)u=u.value,l=r+b6(u,g++),p+=hE(u,e,n,l,s);else if(u==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return p}function I4(t,e,n){if(t==null)return t;var r=[],s=0;return hE(t,r,"","",function(u){return e.call(n,u,s++)}),r}function LW(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Dc={current:null},dE={transition:null},PW={ReactCurrentDispatcher:Dc,ReactCurrentBatchConfig:dE,ReactCurrentOwner:_2};Ns.Children={map:I4,forEach:function(t,e,n){I4(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return I4(t,function(){e++}),e},toArray:function(t){return I4(t,function(e){return e})||[]},only:function(t){if(!v2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ns.Component=qb;Ns.Fragment=vW;Ns.Profiler=bW;Ns.PureComponent=g2;Ns.StrictMode=xW;Ns.Suspense=TW;Ns.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PW;Ns.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cN({},t.props),s=t.key,u=t.ref,p=t._owner;if(e!=null){if(e.ref!==void 0&&(u=e.ref,p=_2.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var g=t.type.defaultProps;for(l in e)fN.call(e,l)&&!pN.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&g!==void 0?g[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){g=Array(l);for(var E=0;E<l;E++)g[E]=arguments[E+2];r.children=g}return{$$typeof:l9,type:t.type,key:s,ref:u,props:r,_owner:p}};Ns.createContext=function(t){return t={$$typeof:EW,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:wW,_context:t},t.Consumer=t};Ns.createElement=mN;Ns.createFactory=function(t){var e=mN.bind(null,t);return e.type=t,e};Ns.createRef=function(){return{current:null}};Ns.forwardRef=function(t){return{$$typeof:SW,render:t}};Ns.isValidElement=v2;Ns.lazy=function(t){return{$$typeof:kW,_payload:{_status:-1,_result:t},_init:LW}};Ns.memo=function(t,e){return{$$typeof:MW,type:t,compare:e===void 0?null:e}};Ns.startTransition=function(t){var e=dE.transition;dE.transition={};try{t()}finally{dE.transition=e}};Ns.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ns.useCallback=function(t,e){return Dc.current.useCallback(t,e)};Ns.useContext=function(t){return Dc.current.useContext(t)};Ns.useDebugValue=function(){};Ns.useDeferredValue=function(t){return Dc.current.useDeferredValue(t)};Ns.useEffect=function(t,e){return Dc.current.useEffect(t,e)};Ns.useId=function(){return Dc.current.useId()};Ns.useImperativeHandle=function(t,e,n){return Dc.current.useImperativeHandle(t,e,n)};Ns.useInsertionEffect=function(t,e){return Dc.current.useInsertionEffect(t,e)};Ns.useLayoutEffect=function(t,e){return Dc.current.useLayoutEffect(t,e)};Ns.useMemo=function(t,e){return Dc.current.useMemo(t,e)};Ns.useReducer=function(t,e,n){return Dc.current.useReducer(t,e,n)};Ns.useRef=function(t){return Dc.current.useRef(t)};Ns.useState=function(t){return Dc.current.useState(t)};Ns.useSyncExternalStore=function(t,e,n){return Dc.current.useSyncExternalStore(t,e,n)};Ns.useTransition=function(){return Dc.current.useTransition()};Ns.version="18.2.0";lN.exports=Ns;var Lt=lN.exports;const bm=HS(Lt),gN=oN({__proto__:null,default:bm},[Lt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RW=Lt,NW=Symbol.for("react.element"),DW=Symbol.for("react.fragment"),OW=Object.prototype.hasOwnProperty,FW=RW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zW={key:!0,ref:!0,__self:!0,__source:!0};function yN(t,e,n){var r,s={},u=null,p=null;n!==void 0&&(u=""+n),e.key!==void 0&&(u=""+e.key),e.ref!==void 0&&(p=e.ref);for(r in e)OW.call(e,r)&&!zW.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:NW,type:t,key:u,ref:p,props:s,_owner:FW.current}}WS.Fragment=DW;WS.jsx=yN;WS.jsxs=yN;aN.exports=WS;var xn=aN.exports,D7={},_N={exports:{}},dd={},vN={exports:{}},xN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(xe,Ce){var tt=xe.length;xe.push(Ce);e:for(;0<tt;){var Je=tt-1>>>1,rt=xe[Je];if(0<s(rt,Ce))xe[Je]=Ce,xe[tt]=rt,tt=Je;else break e}}function n(xe){return xe.length===0?null:xe[0]}function r(xe){if(xe.length===0)return null;var Ce=xe[0],tt=xe.pop();if(tt!==Ce){xe[0]=tt;e:for(var Je=0,rt=xe.length,Ut=rt>>>1;Je<Ut;){var ht=2*(Je+1)-1,Ft=xe[ht],Nn=ht+1,zn=xe[Nn];if(0>s(Ft,tt))Nn<rt&&0>s(zn,Ft)?(xe[Je]=zn,xe[Nn]=tt,Je=Nn):(xe[Je]=Ft,xe[ht]=tt,Je=ht);else if(Nn<rt&&0>s(zn,tt))xe[Je]=zn,xe[Nn]=tt,Je=Nn;else break e}}return Ce}function s(xe,Ce){var tt=xe.sortIndex-Ce.sortIndex;return tt!==0?tt:xe.id-Ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;t.unstable_now=function(){return u.now()}}else{var p=Date,g=p.now();t.unstable_now=function(){return p.now()-g}}var l=[],E=[],P=1,O=null,j=3,$=!1,Y=!1,re=!1,_e=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function te(xe){for(var Ce=n(E);Ce!==null;){if(Ce.callback===null)r(E);else if(Ce.startTime<=xe)r(E),Ce.sortIndex=Ce.expirationTime,e(l,Ce);else break;Ce=n(E)}}function ce(xe){if(re=!1,te(xe),!Y)if(n(l)!==null)Y=!0,ye(Se);else{var Ce=n(E);Ce!==null&&ge(ce,Ce.startTime-xe)}}function Se(xe,Ce){Y=!1,re&&(re=!1,J(ut),ut=-1),$=!0;var tt=j;try{for(te(Ce),O=n(l);O!==null&&(!(O.expirationTime>Ce)||xe&&!Ot());){var Je=O.callback;if(typeof Je=="function"){O.callback=null,j=O.priorityLevel;var rt=Je(O.expirationTime<=Ce);Ce=t.unstable_now(),typeof rt=="function"?O.callback=rt:O===n(l)&&r(l),te(Ce)}else r(l);O=n(l)}if(O!==null)var Ut=!0;else{var ht=n(E);ht!==null&&ge(ce,ht.startTime-Ce),Ut=!1}return Ut}finally{O=null,j=tt,$=!1}}var Ie=!1,Ne=null,ut=-1,mt=5,We=-1;function Ot(){return!(t.unstable_now()-We<mt)}function st(){if(Ne!==null){var xe=t.unstable_now();We=xe;var Ce=!0;try{Ce=Ne(!0,xe)}finally{Ce?qe():(Ie=!1,Ne=null)}}else Ie=!1}var qe;if(typeof H=="function")qe=function(){H(st)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,Q=et.port2;et.port1.onmessage=st,qe=function(){Q.postMessage(null)}}else qe=function(){_e(st,0)};function ye(xe){Ne=xe,Ie||(Ie=!0,qe())}function ge(xe,Ce){ut=_e(function(){xe(t.unstable_now())},Ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(xe){xe.callback=null},t.unstable_continueExecution=function(){Y||$||(Y=!0,ye(Se))},t.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):mt=0<xe?Math.floor(1e3/xe):5},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(xe){switch(j){case 1:case 2:case 3:var Ce=3;break;default:Ce=j}var tt=j;j=Ce;try{return xe()}finally{j=tt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(xe,Ce){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var tt=j;j=xe;try{return Ce()}finally{j=tt}},t.unstable_scheduleCallback=function(xe,Ce,tt){var Je=t.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?Je+tt:Je):tt=Je,xe){case 1:var rt=-1;break;case 2:rt=250;break;case 5:rt=1073741823;break;case 4:rt=1e4;break;default:rt=5e3}return rt=tt+rt,xe={id:P++,callback:Ce,priorityLevel:xe,startTime:tt,expirationTime:rt,sortIndex:-1},tt>Je?(xe.sortIndex=tt,e(E,xe),n(l)===null&&xe===n(E)&&(re?(J(ut),ut=-1):re=!0,ge(ce,tt-Je))):(xe.sortIndex=rt,e(l,xe),Y||$||(Y=!0,ye(Se))),xe},t.unstable_shouldYield=Ot,t.unstable_wrapCallback=function(xe){var Ce=j;return function(){var tt=j;j=Ce;try{return xe.apply(this,arguments)}finally{j=tt}}}})(xN);vN.exports=xN;var BW=vN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN=Lt,td=BW;function pr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wN=new Set,m5={};function sv(t,e){ib(t,e),ib(t+"Capture",e)}function ib(t,e){for(m5[t]=e,t=0;t<e.length;t++)wN.add(e[t])}var Vg=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),O7=Object.prototype.hasOwnProperty,UW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dL={},fL={};function jW(t){return O7.call(fL,t)?!0:O7.call(dL,t)?!1:UW.test(t)?fL[t]=!0:(dL[t]=!0,!1)}function VW(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function GW(t,e,n,r){if(e===null||typeof e>"u"||VW(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Oc(t,e,n,r,s,u,p){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=u,this.removeEmptyString=p}var Du={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Du[t]=new Oc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Du[e]=new Oc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Du[t]=new Oc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Du[t]=new Oc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Du[t]=new Oc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Du[t]=new Oc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Du[t]=new Oc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Du[t]=new Oc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Du[t]=new Oc(t,5,!1,t.toLowerCase(),null,!1,!1)});var x2=/[\-:]([a-z])/g;function b2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(x2,b2);Du[e]=new Oc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(x2,b2);Du[e]=new Oc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(x2,b2);Du[e]=new Oc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Du[t]=new Oc(t,1,!1,t.toLowerCase(),null,!1,!1)});Du.xlinkHref=new Oc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Du[t]=new Oc(t,1,!1,t.toLowerCase(),null,!0,!0)});function w2(t,e,n,r){var s=Du.hasOwnProperty(e)?Du[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(GW(e,n,s,r)&&(n=null),r||s===null?jW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var s0=bN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A4=Symbol.for("react.element"),Px=Symbol.for("react.portal"),Rx=Symbol.for("react.fragment"),E2=Symbol.for("react.strict_mode"),F7=Symbol.for("react.profiler"),EN=Symbol.for("react.provider"),SN=Symbol.for("react.context"),S2=Symbol.for("react.forward_ref"),z7=Symbol.for("react.suspense"),B7=Symbol.for("react.suspense_list"),T2=Symbol.for("react.memo"),cy=Symbol.for("react.lazy"),TN=Symbol.for("react.offscreen"),pL=Symbol.iterator;function hw(t){return t===null||typeof t!="object"?null:(t=pL&&t[pL]||t["@@iterator"],typeof t=="function"?t:null)}var Wa=Object.assign,w6;function zw(t){if(w6===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);w6=e&&e[1]||""}return`
`+w6+t}var E6=!1;function S6(t,e){if(!t||E6)return"";E6=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(E){var r=E}Reflect.construct(t,[],e)}else{try{e.call()}catch(E){r=E}t.call(e.prototype)}else{try{throw Error()}catch(E){r=E}t()}}catch(E){if(E&&r&&typeof E.stack=="string"){for(var s=E.stack.split(`
`),u=r.stack.split(`
`),p=s.length-1,g=u.length-1;1<=p&&0<=g&&s[p]!==u[g];)g--;for(;1<=p&&0<=g;p--,g--)if(s[p]!==u[g]){if(p!==1||g!==1)do if(p--,g--,0>g||s[p]!==u[g]){var l=`
`+s[p].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=p&&0<=g);break}}}finally{E6=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?zw(t):""}function HW(t){switch(t.tag){case 5:return zw(t.type);case 16:return zw("Lazy");case 13:return zw("Suspense");case 19:return zw("SuspenseList");case 0:case 2:case 15:return t=S6(t.type,!1),t;case 11:return t=S6(t.type.render,!1),t;case 1:return t=S6(t.type,!0),t;default:return""}}function U7(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Rx:return"Fragment";case Px:return"Portal";case F7:return"Profiler";case E2:return"StrictMode";case z7:return"Suspense";case B7:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case SN:return(t.displayName||"Context")+".Consumer";case EN:return(t._context.displayName||"Context")+".Provider";case S2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case T2:return e=t.displayName||null,e!==null?e:U7(t.type)||"Memo";case cy:e=t._payload,t=t._init;try{return U7(t(e))}catch{}}return null}function WW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U7(e);case 8:return e===E2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ry(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function MN(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qW(t){var e=MN(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,u=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(p){r=""+p,u.call(this,p)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(p){r=""+p},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function L4(t){t._valueTracker||(t._valueTracker=qW(t))}function kN(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=MN(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function BE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function j7(t,e){var n=e.checked;return Wa({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function mL(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ry(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CN(t,e){e=e.checked,e!=null&&w2(t,"checked",e,!1)}function V7(t,e){CN(t,e);var n=Ry(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?G7(t,e.type,n):e.hasOwnProperty("defaultValue")&&G7(t,e.type,Ry(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gL(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function G7(t,e,n){(e!=="number"||BE(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Bw=Array.isArray;function qx(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ry(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function H7(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(pr(91));return Wa({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function yL(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(pr(92));if(Bw(n)){if(1<n.length)throw Error(pr(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ry(n)}}function IN(t,e){var n=Ry(e.value),r=Ry(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function _L(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function AN(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function W7(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?AN(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var P4,LN=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(P4=P4||document.createElement("div"),P4.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=P4.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function g5(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$W=["Webkit","ms","Moz","O"];Object.keys(Yw).forEach(function(t){$W.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yw[e]=Yw[t]})});function PN(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Yw.hasOwnProperty(t)&&Yw[t]?(""+e).trim():e+"px"}function RN(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=PN(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var XW=Wa({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function q7(t,e){if(e){if(XW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(pr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(pr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(pr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(pr(62))}}function $7(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X7=null;function M2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Z7=null,$x=null,Xx=null;function vL(t){if(t=h9(t)){if(typeof Z7!="function")throw Error(pr(280));var e=t.stateNode;e&&(e=YS(e),Z7(t.stateNode,t.type,e))}}function NN(t){$x?Xx?Xx.push(t):Xx=[t]:$x=t}function DN(){if($x){var t=$x,e=Xx;if(Xx=$x=null,vL(t),e)for(t=0;t<e.length;t++)vL(e[t])}}function ON(t,e){return t(e)}function FN(){}var T6=!1;function zN(t,e,n){if(T6)return t(e,n);T6=!0;try{return ON(t,e,n)}finally{T6=!1,($x!==null||Xx!==null)&&(FN(),DN())}}function y5(t,e){var n=t.stateNode;if(n===null)return null;var r=YS(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(pr(231,e,typeof n));return n}var Y7=!1;if(Vg)try{var dw={};Object.defineProperty(dw,"passive",{get:function(){Y7=!0}}),window.addEventListener("test",dw,dw),window.removeEventListener("test",dw,dw)}catch{Y7=!1}function ZW(t,e,n,r,s,u,p,g,l){var E=Array.prototype.slice.call(arguments,3);try{e.apply(n,E)}catch(P){this.onError(P)}}var Kw=!1,UE=null,jE=!1,K7=null,YW={onError:function(t){Kw=!0,UE=t}};function KW(t,e,n,r,s,u,p,g,l){Kw=!1,UE=null,ZW.apply(YW,arguments)}function JW(t,e,n,r,s,u,p,g,l){if(KW.apply(this,arguments),Kw){if(Kw){var E=UE;Kw=!1,UE=null}else throw Error(pr(198));jE||(jE=!0,K7=E)}}function ov(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function BN(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xL(t){if(ov(t)!==t)throw Error(pr(188))}function QW(t){var e=t.alternate;if(!e){if(e=ov(t),e===null)throw Error(pr(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var u=s.alternate;if(u===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===u.child){for(u=s.child;u;){if(u===n)return xL(s),t;if(u===r)return xL(s),e;u=u.sibling}throw Error(pr(188))}if(n.return!==r.return)n=s,r=u;else{for(var p=!1,g=s.child;g;){if(g===n){p=!0,n=s,r=u;break}if(g===r){p=!0,r=s,n=u;break}g=g.sibling}if(!p){for(g=u.child;g;){if(g===n){p=!0,n=u,r=s;break}if(g===r){p=!0,r=u,n=s;break}g=g.sibling}if(!p)throw Error(pr(189))}}if(n.alternate!==r)throw Error(pr(190))}if(n.tag!==3)throw Error(pr(188));return n.stateNode.current===n?t:e}function UN(t){return t=QW(t),t!==null?jN(t):null}function jN(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jN(t);if(e!==null)return e;t=t.sibling}return null}var VN=td.unstable_scheduleCallback,bL=td.unstable_cancelCallback,eq=td.unstable_shouldYield,tq=td.unstable_requestPaint,dl=td.unstable_now,nq=td.unstable_getCurrentPriorityLevel,k2=td.unstable_ImmediatePriority,GN=td.unstable_UserBlockingPriority,VE=td.unstable_NormalPriority,rq=td.unstable_LowPriority,HN=td.unstable_IdlePriority,qS=null,Mm=null;function iq(t){if(Mm&&typeof Mm.onCommitFiberRoot=="function")try{Mm.onCommitFiberRoot(qS,t,void 0,(t.current.flags&128)===128)}catch{}}var ip=Math.clz32?Math.clz32:aq,sq=Math.log,oq=Math.LN2;function aq(t){return t>>>=0,t===0?32:31-(sq(t)/oq|0)|0}var R4=64,N4=4194304;function Uw(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function GE(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,u=t.pingedLanes,p=n&268435455;if(p!==0){var g=p&~s;g!==0?r=Uw(g):(u&=p,u!==0&&(r=Uw(u)))}else p=n&~s,p!==0?r=Uw(p):u!==0&&(r=Uw(u));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,u=e&-e,s>=u||s===16&&(u&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ip(e),s=1<<n,r|=t[n],e&=~s;return r}function lq(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uq(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,u=t.pendingLanes;0<u;){var p=31-ip(u),g=1<<p,l=s[p];l===-1?(!(g&n)||g&r)&&(s[p]=lq(g,e)):l<=e&&(t.expiredLanes|=g),u&=~g}}function J7(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function WN(){var t=R4;return R4<<=1,!(R4&4194240)&&(R4=64),t}function M6(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function u9(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ip(e),t[e]=n}function cq(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ip(n),u=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~u}}function C2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ip(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var So=0;function qN(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var $N,I2,XN,ZN,YN,Q7=!1,D4=[],xy=null,by=null,wy=null,_5=new Map,v5=new Map,dy=[],hq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wL(t,e){switch(t){case"focusin":case"focusout":xy=null;break;case"dragenter":case"dragleave":by=null;break;case"mouseover":case"mouseout":wy=null;break;case"pointerover":case"pointerout":_5.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":v5.delete(e.pointerId)}}function fw(t,e,n,r,s,u){return t===null||t.nativeEvent!==u?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:u,targetContainers:[s]},e!==null&&(e=h9(e),e!==null&&I2(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function dq(t,e,n,r,s){switch(e){case"focusin":return xy=fw(xy,t,e,n,r,s),!0;case"dragenter":return by=fw(by,t,e,n,r,s),!0;case"mouseover":return wy=fw(wy,t,e,n,r,s),!0;case"pointerover":var u=s.pointerId;return _5.set(u,fw(_5.get(u)||null,t,e,n,r,s)),!0;case"gotpointercapture":return u=s.pointerId,v5.set(u,fw(v5.get(u)||null,t,e,n,r,s)),!0}return!1}function KN(t){var e=M1(t.target);if(e!==null){var n=ov(e);if(n!==null){if(e=n.tag,e===13){if(e=BN(n),e!==null){t.blockedOn=e,YN(t.priority,function(){XN(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fE(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ek(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);X7=r,n.target.dispatchEvent(r),X7=null}else return e=h9(n),e!==null&&I2(e),t.blockedOn=n,!1;e.shift()}return!0}function EL(t,e,n){fE(t)&&n.delete(e)}function fq(){Q7=!1,xy!==null&&fE(xy)&&(xy=null),by!==null&&fE(by)&&(by=null),wy!==null&&fE(wy)&&(wy=null),_5.forEach(EL),v5.forEach(EL)}function pw(t,e){t.blockedOn===e&&(t.blockedOn=null,Q7||(Q7=!0,td.unstable_scheduleCallback(td.unstable_NormalPriority,fq)))}function x5(t){function e(s){return pw(s,t)}if(0<D4.length){pw(D4[0],t);for(var n=1;n<D4.length;n++){var r=D4[n];r.blockedOn===t&&(r.blockedOn=null)}}for(xy!==null&&pw(xy,t),by!==null&&pw(by,t),wy!==null&&pw(wy,t),_5.forEach(e),v5.forEach(e),n=0;n<dy.length;n++)r=dy[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<dy.length&&(n=dy[0],n.blockedOn===null);)KN(n),n.blockedOn===null&&dy.shift()}var Zx=s0.ReactCurrentBatchConfig,HE=!0;function pq(t,e,n,r){var s=So,u=Zx.transition;Zx.transition=null;try{So=1,A2(t,e,n,r)}finally{So=s,Zx.transition=u}}function mq(t,e,n,r){var s=So,u=Zx.transition;Zx.transition=null;try{So=4,A2(t,e,n,r)}finally{So=s,Zx.transition=u}}function A2(t,e,n,r){if(HE){var s=ek(t,e,n,r);if(s===null)O6(t,e,r,WE,n),wL(t,r);else if(dq(s,t,e,n,r))r.stopPropagation();else if(wL(t,r),e&4&&-1<hq.indexOf(t)){for(;s!==null;){var u=h9(s);if(u!==null&&$N(u),u=ek(t,e,n,r),u===null&&O6(t,e,r,WE,n),u===s)break;s=u}s!==null&&r.stopPropagation()}else O6(t,e,r,null,n)}}var WE=null;function ek(t,e,n,r){if(WE=null,t=M2(r),t=M1(t),t!==null)if(e=ov(t),e===null)t=null;else if(n=e.tag,n===13){if(t=BN(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return WE=t,null}function JN(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nq()){case k2:return 1;case GN:return 4;case VE:case rq:return 16;case HN:return 536870912;default:return 16}default:return 16}}var my=null,L2=null,pE=null;function QN(){if(pE)return pE;var t,e=L2,n=e.length,r,s="value"in my?my.value:my.textContent,u=s.length;for(t=0;t<n&&e[t]===s[t];t++);var p=n-t;for(r=1;r<=p&&e[n-r]===s[u-r];r++);return pE=s.slice(t,1<r?1-r:void 0)}function mE(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function O4(){return!0}function SL(){return!1}function fd(t){function e(n,r,s,u,p){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=u,this.target=p,this.currentTarget=null;for(var g in t)t.hasOwnProperty(g)&&(n=t[g],this[g]=n?n(u):u[g]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?O4:SL,this.isPropagationStopped=SL,this}return Wa(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=O4)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=O4)},persist:function(){},isPersistent:O4}),e}var $b={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},P2=fd($b),c9=Wa({},$b,{view:0,detail:0}),gq=fd(c9),k6,C6,mw,$S=Wa({},c9,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:R2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==mw&&(mw&&t.type==="mousemove"?(k6=t.screenX-mw.screenX,C6=t.screenY-mw.screenY):C6=k6=0,mw=t),k6)},movementY:function(t){return"movementY"in t?t.movementY:C6}}),TL=fd($S),yq=Wa({},$S,{dataTransfer:0}),_q=fd(yq),vq=Wa({},c9,{relatedTarget:0}),I6=fd(vq),xq=Wa({},$b,{animationName:0,elapsedTime:0,pseudoElement:0}),bq=fd(xq),wq=Wa({},$b,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Eq=fd(wq),Sq=Wa({},$b,{data:0}),ML=fd(Sq),Tq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cq(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kq[t])?!!e[t]:!1}function R2(){return Cq}var Iq=Wa({},c9,{key:function(t){if(t.key){var e=Tq[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mE(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Mq[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:R2,charCode:function(t){return t.type==="keypress"?mE(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mE(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Aq=fd(Iq),Lq=Wa({},$S,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kL=fd(Lq),Pq=Wa({},c9,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:R2}),Rq=fd(Pq),Nq=Wa({},$b,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dq=fd(Nq),Oq=Wa({},$S,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Fq=fd(Oq),zq=[9,13,27,32],N2=Vg&&"CompositionEvent"in window,Jw=null;Vg&&"documentMode"in document&&(Jw=document.documentMode);var Bq=Vg&&"TextEvent"in window&&!Jw,eD=Vg&&(!N2||Jw&&8<Jw&&11>=Jw),CL=" ",IL=!1;function tD(t,e){switch(t){case"keyup":return zq.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nD(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nx=!1;function Uq(t,e){switch(t){case"compositionend":return nD(e);case"keypress":return e.which!==32?null:(IL=!0,CL);case"textInput":return t=e.data,t===CL&&IL?null:t;default:return null}}function jq(t,e){if(Nx)return t==="compositionend"||!N2&&tD(t,e)?(t=QN(),pE=L2=my=null,Nx=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eD&&e.locale!=="ko"?null:e.data;default:return null}}var Vq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AL(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Vq[t.type]:e==="textarea"}function rD(t,e,n,r){NN(r),e=qE(e,"onChange"),0<e.length&&(n=new P2("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Qw=null,b5=null;function Gq(t){pD(t,0)}function XS(t){var e=Fx(t);if(kN(e))return t}function Hq(t,e){if(t==="change")return e}var iD=!1;if(Vg){var A6;if(Vg){var L6="oninput"in document;if(!L6){var LL=document.createElement("div");LL.setAttribute("oninput","return;"),L6=typeof LL.oninput=="function"}A6=L6}else A6=!1;iD=A6&&(!document.documentMode||9<document.documentMode)}function PL(){Qw&&(Qw.detachEvent("onpropertychange",sD),b5=Qw=null)}function sD(t){if(t.propertyName==="value"&&XS(b5)){var e=[];rD(e,b5,t,M2(t)),zN(Gq,e)}}function Wq(t,e,n){t==="focusin"?(PL(),Qw=e,b5=n,Qw.attachEvent("onpropertychange",sD)):t==="focusout"&&PL()}function qq(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return XS(b5)}function $q(t,e){if(t==="click")return XS(e)}function Xq(t,e){if(t==="input"||t==="change")return XS(e)}function Zq(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var up=typeof Object.is=="function"?Object.is:Zq;function w5(t,e){if(up(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!O7.call(e,s)||!up(t[s],e[s]))return!1}return!0}function RL(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function NL(t,e){var n=RL(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=RL(n)}}function oD(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oD(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function aD(){for(var t=window,e=BE();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=BE(t.document)}return e}function D2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Yq(t){var e=aD(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oD(n.ownerDocument.documentElement,n)){if(r!==null&&D2(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,u=Math.min(r.start,s);r=r.end===void 0?u:Math.min(r.end,s),!t.extend&&u>r&&(s=r,r=u,u=s),s=NL(n,u);var p=NL(n,r);s&&p&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==p.node||t.focusOffset!==p.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),u>r?(t.addRange(e),t.extend(p.node,p.offset)):(e.setEnd(p.node,p.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Kq=Vg&&"documentMode"in document&&11>=document.documentMode,Dx=null,tk=null,e5=null,nk=!1;function DL(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nk||Dx==null||Dx!==BE(r)||(r=Dx,"selectionStart"in r&&D2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),e5&&w5(e5,r)||(e5=r,r=qE(tk,"onSelect"),0<r.length&&(e=new P2("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Dx)))}function F4(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ox={animationend:F4("Animation","AnimationEnd"),animationiteration:F4("Animation","AnimationIteration"),animationstart:F4("Animation","AnimationStart"),transitionend:F4("Transition","TransitionEnd")},P6={},lD={};Vg&&(lD=document.createElement("div").style,"AnimationEvent"in window||(delete Ox.animationend.animation,delete Ox.animationiteration.animation,delete Ox.animationstart.animation),"TransitionEvent"in window||delete Ox.transitionend.transition);function ZS(t){if(P6[t])return P6[t];if(!Ox[t])return t;var e=Ox[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in lD)return P6[t]=e[n];return t}var uD=ZS("animationend"),cD=ZS("animationiteration"),hD=ZS("animationstart"),dD=ZS("transitionend"),fD=new Map,OL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qy(t,e){fD.set(t,e),sv(e,[t])}for(var R6=0;R6<OL.length;R6++){var N6=OL[R6],Jq=N6.toLowerCase(),Qq=N6[0].toUpperCase()+N6.slice(1);qy(Jq,"on"+Qq)}qy(uD,"onAnimationEnd");qy(cD,"onAnimationIteration");qy(hD,"onAnimationStart");qy("dblclick","onDoubleClick");qy("focusin","onFocus");qy("focusout","onBlur");qy(dD,"onTransitionEnd");ib("onMouseEnter",["mouseout","mouseover"]);ib("onMouseLeave",["mouseout","mouseover"]);ib("onPointerEnter",["pointerout","pointerover"]);ib("onPointerLeave",["pointerout","pointerover"]);sv("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sv("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sv("onBeforeInput",["compositionend","keypress","textInput","paste"]);sv("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sv("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sv("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e$=new Set("cancel close invalid load scroll toggle".split(" ").concat(jw));function FL(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,JW(r,e,void 0,t),t.currentTarget=null}function pD(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var u=void 0;if(e)for(var p=r.length-1;0<=p;p--){var g=r[p],l=g.instance,E=g.currentTarget;if(g=g.listener,l!==u&&s.isPropagationStopped())break e;FL(s,g,E),u=l}else for(p=0;p<r.length;p++){if(g=r[p],l=g.instance,E=g.currentTarget,g=g.listener,l!==u&&s.isPropagationStopped())break e;FL(s,g,E),u=l}}}if(jE)throw t=K7,jE=!1,K7=null,t}function oa(t,e){var n=e[ak];n===void 0&&(n=e[ak]=new Set);var r=t+"__bubble";n.has(r)||(mD(e,t,2,!1),n.add(r))}function D6(t,e,n){var r=0;e&&(r|=4),mD(n,t,r,e)}var z4="_reactListening"+Math.random().toString(36).slice(2);function E5(t){if(!t[z4]){t[z4]=!0,wN.forEach(function(n){n!=="selectionchange"&&(e$.has(n)||D6(n,!1,t),D6(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[z4]||(e[z4]=!0,D6("selectionchange",!1,e))}}function mD(t,e,n,r){switch(JN(e)){case 1:var s=pq;break;case 4:s=mq;break;default:s=A2}n=s.bind(null,e,n,t),s=void 0,!Y7||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function O6(t,e,n,r,s){var u=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var p=r.tag;if(p===3||p===4){var g=r.stateNode.containerInfo;if(g===s||g.nodeType===8&&g.parentNode===s)break;if(p===4)for(p=r.return;p!==null;){var l=p.tag;if((l===3||l===4)&&(l=p.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;p=p.return}for(;g!==null;){if(p=M1(g),p===null)return;if(l=p.tag,l===5||l===6){r=u=p;continue e}g=g.parentNode}}r=r.return}zN(function(){var E=u,P=M2(n),O=[];e:{var j=fD.get(t);if(j!==void 0){var $=P2,Y=t;switch(t){case"keypress":if(mE(n)===0)break e;case"keydown":case"keyup":$=Aq;break;case"focusin":Y="focus",$=I6;break;case"focusout":Y="blur",$=I6;break;case"beforeblur":case"afterblur":$=I6;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$=TL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$=_q;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$=Rq;break;case uD:case cD:case hD:$=bq;break;case dD:$=Dq;break;case"scroll":$=gq;break;case"wheel":$=Fq;break;case"copy":case"cut":case"paste":$=Eq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$=kL}var re=(e&4)!==0,_e=!re&&t==="scroll",J=re?j!==null?j+"Capture":null:j;re=[];for(var H=E,te;H!==null;){te=H;var ce=te.stateNode;if(te.tag===5&&ce!==null&&(te=ce,J!==null&&(ce=y5(H,J),ce!=null&&re.push(S5(H,ce,te)))),_e)break;H=H.return}0<re.length&&(j=new $(j,Y,null,n,P),O.push({event:j,listeners:re}))}}if(!(e&7)){e:{if(j=t==="mouseover"||t==="pointerover",$=t==="mouseout"||t==="pointerout",j&&n!==X7&&(Y=n.relatedTarget||n.fromElement)&&(M1(Y)||Y[Gg]))break e;if(($||j)&&(j=P.window===P?P:(j=P.ownerDocument)?j.defaultView||j.parentWindow:window,$?(Y=n.relatedTarget||n.toElement,$=E,Y=Y?M1(Y):null,Y!==null&&(_e=ov(Y),Y!==_e||Y.tag!==5&&Y.tag!==6)&&(Y=null)):($=null,Y=E),$!==Y)){if(re=TL,ce="onMouseLeave",J="onMouseEnter",H="mouse",(t==="pointerout"||t==="pointerover")&&(re=kL,ce="onPointerLeave",J="onPointerEnter",H="pointer"),_e=$==null?j:Fx($),te=Y==null?j:Fx(Y),j=new re(ce,H+"leave",$,n,P),j.target=_e,j.relatedTarget=te,ce=null,M1(P)===E&&(re=new re(J,H+"enter",Y,n,P),re.target=te,re.relatedTarget=_e,ce=re),_e=ce,$&&Y)t:{for(re=$,J=Y,H=0,te=re;te;te=bx(te))H++;for(te=0,ce=J;ce;ce=bx(ce))te++;for(;0<H-te;)re=bx(re),H--;for(;0<te-H;)J=bx(J),te--;for(;H--;){if(re===J||J!==null&&re===J.alternate)break t;re=bx(re),J=bx(J)}re=null}else re=null;$!==null&&zL(O,j,$,re,!1),Y!==null&&_e!==null&&zL(O,_e,Y,re,!0)}}e:{if(j=E?Fx(E):window,$=j.nodeName&&j.nodeName.toLowerCase(),$==="select"||$==="input"&&j.type==="file")var Se=Hq;else if(AL(j))if(iD)Se=Xq;else{Se=qq;var Ie=Wq}else($=j.nodeName)&&$.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(Se=$q);if(Se&&(Se=Se(t,E))){rD(O,Se,n,P);break e}Ie&&Ie(t,j,E),t==="focusout"&&(Ie=j._wrapperState)&&Ie.controlled&&j.type==="number"&&G7(j,"number",j.value)}switch(Ie=E?Fx(E):window,t){case"focusin":(AL(Ie)||Ie.contentEditable==="true")&&(Dx=Ie,tk=E,e5=null);break;case"focusout":e5=tk=Dx=null;break;case"mousedown":nk=!0;break;case"contextmenu":case"mouseup":case"dragend":nk=!1,DL(O,n,P);break;case"selectionchange":if(Kq)break;case"keydown":case"keyup":DL(O,n,P)}var Ne;if(N2)e:{switch(t){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Nx?tD(t,n)&&(ut="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ut="onCompositionStart");ut&&(eD&&n.locale!=="ko"&&(Nx||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Nx&&(Ne=QN()):(my=P,L2="value"in my?my.value:my.textContent,Nx=!0)),Ie=qE(E,ut),0<Ie.length&&(ut=new ML(ut,t,null,n,P),O.push({event:ut,listeners:Ie}),Ne?ut.data=Ne:(Ne=nD(n),Ne!==null&&(ut.data=Ne)))),(Ne=Bq?Uq(t,n):jq(t,n))&&(E=qE(E,"onBeforeInput"),0<E.length&&(P=new ML("onBeforeInput","beforeinput",null,n,P),O.push({event:P,listeners:E}),P.data=Ne))}pD(O,e)})}function S5(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qE(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,u=s.stateNode;s.tag===5&&u!==null&&(s=u,u=y5(t,n),u!=null&&r.unshift(S5(t,u,s)),u=y5(t,e),u!=null&&r.push(S5(t,u,s))),t=t.return}return r}function bx(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zL(t,e,n,r,s){for(var u=e._reactName,p=[];n!==null&&n!==r;){var g=n,l=g.alternate,E=g.stateNode;if(l!==null&&l===r)break;g.tag===5&&E!==null&&(g=E,s?(l=y5(n,u),l!=null&&p.unshift(S5(n,l,g))):s||(l=y5(n,u),l!=null&&p.push(S5(n,l,g)))),n=n.return}p.length!==0&&t.push({event:e,listeners:p})}var t$=/\r\n?/g,n$=/\u0000|\uFFFD/g;function BL(t){return(typeof t=="string"?t:""+t).replace(t$,`
`).replace(n$,"")}function B4(t,e,n){if(e=BL(e),BL(t)!==e&&n)throw Error(pr(425))}function $E(){}var rk=null,ik=null;function sk(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ok=typeof setTimeout=="function"?setTimeout:void 0,r$=typeof clearTimeout=="function"?clearTimeout:void 0,UL=typeof Promise=="function"?Promise:void 0,i$=typeof queueMicrotask=="function"?queueMicrotask:typeof UL<"u"?function(t){return UL.resolve(null).then(t).catch(s$)}:ok;function s$(t){setTimeout(function(){throw t})}function F6(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),x5(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);x5(e)}function Ey(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function jL(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xb=Math.random().toString(36).slice(2),Em="__reactFiber$"+Xb,T5="__reactProps$"+Xb,Gg="__reactContainer$"+Xb,ak="__reactEvents$"+Xb,o$="__reactListeners$"+Xb,a$="__reactHandles$"+Xb;function M1(t){var e=t[Em];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gg]||n[Em]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jL(t);t!==null;){if(n=t[Em])return n;t=jL(t)}return e}t=n,n=t.parentNode}return null}function h9(t){return t=t[Em]||t[Gg],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fx(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(pr(33))}function YS(t){return t[T5]||null}var lk=[],zx=-1;function $y(t){return{current:t}}function ua(t){0>zx||(t.current=lk[zx],lk[zx]=null,zx--)}function Ko(t,e){zx++,lk[zx]=t.current,t.current=e}var Ny={},oc=$y(Ny),dh=$y(!1),z1=Ny;function sb(t,e){var n=t.type.contextTypes;if(!n)return Ny;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},u;for(u in n)s[u]=e[u];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function fh(t){return t=t.childContextTypes,t!=null}function XE(){ua(dh),ua(oc)}function VL(t,e,n){if(oc.current!==Ny)throw Error(pr(168));Ko(oc,e),Ko(dh,n)}function gD(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(pr(108,WW(t)||"Unknown",s));return Wa({},n,r)}function ZE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ny,z1=oc.current,Ko(oc,t),Ko(dh,dh.current),!0}function GL(t,e,n){var r=t.stateNode;if(!r)throw Error(pr(169));n?(t=gD(t,e,z1),r.__reactInternalMemoizedMergedChildContext=t,ua(dh),ua(oc),Ko(oc,t)):ua(dh),Ko(dh,n)}var Rg=null,KS=!1,z6=!1;function yD(t){Rg===null?Rg=[t]:Rg.push(t)}function l$(t){KS=!0,yD(t)}function Xy(){if(!z6&&Rg!==null){z6=!0;var t=0,e=So;try{var n=Rg;for(So=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Rg=null,KS=!1}catch(s){throw Rg!==null&&(Rg=Rg.slice(t+1)),VN(k2,Xy),s}finally{So=e,z6=!1}}return null}var Bx=[],Ux=0,YE=null,KE=0,Wd=[],qd=0,B1=null,Ng=1,Dg="";function g1(t,e){Bx[Ux++]=KE,Bx[Ux++]=YE,YE=t,KE=e}function _D(t,e,n){Wd[qd++]=Ng,Wd[qd++]=Dg,Wd[qd++]=B1,B1=t;var r=Ng;t=Dg;var s=32-ip(r)-1;r&=~(1<<s),n+=1;var u=32-ip(e)+s;if(30<u){var p=s-s%5;u=(r&(1<<p)-1).toString(32),r>>=p,s-=p,Ng=1<<32-ip(e)+s|n<<s|r,Dg=u+t}else Ng=1<<u|n<<s|r,Dg=t}function O2(t){t.return!==null&&(g1(t,1),_D(t,1,0))}function F2(t){for(;t===YE;)YE=Bx[--Ux],Bx[Ux]=null,KE=Bx[--Ux],Bx[Ux]=null;for(;t===B1;)B1=Wd[--qd],Wd[qd]=null,Dg=Wd[--qd],Wd[qd]=null,Ng=Wd[--qd],Wd[qd]=null}var Jh=null,Kh=null,Ta=!1,ep=null;function vD(t,e){var n=Xd(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function HL(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jh=t,Kh=Ey(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jh=t,Kh=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=B1!==null?{id:Ng,overflow:Dg}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xd(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Jh=t,Kh=null,!0):!1;default:return!1}}function uk(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ck(t){if(Ta){var e=Kh;if(e){var n=e;if(!HL(t,e)){if(uk(t))throw Error(pr(418));e=Ey(n.nextSibling);var r=Jh;e&&HL(t,e)?vD(r,n):(t.flags=t.flags&-4097|2,Ta=!1,Jh=t)}}else{if(uk(t))throw Error(pr(418));t.flags=t.flags&-4097|2,Ta=!1,Jh=t}}}function WL(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jh=t}function U4(t){if(t!==Jh)return!1;if(!Ta)return WL(t),Ta=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sk(t.type,t.memoizedProps)),e&&(e=Kh)){if(uk(t))throw xD(),Error(pr(418));for(;e;)vD(t,e),e=Ey(e.nextSibling)}if(WL(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(pr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kh=Ey(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kh=null}}else Kh=Jh?Ey(t.stateNode.nextSibling):null;return!0}function xD(){for(var t=Kh;t;)t=Ey(t.nextSibling)}function ob(){Kh=Jh=null,Ta=!1}function z2(t){ep===null?ep=[t]:ep.push(t)}var u$=s0.ReactCurrentBatchConfig;function Kf(t,e){if(t&&t.defaultProps){e=Wa({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var JE=$y(null),QE=null,jx=null,B2=null;function U2(){B2=jx=QE=null}function j2(t){var e=JE.current;ua(JE),t._currentValue=e}function hk(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yx(t,e){QE=t,B2=jx=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(hh=!0),t.firstContext=null)}function Qd(t){var e=t._currentValue;if(B2!==t)if(t={context:t,memoizedValue:e,next:null},jx===null){if(QE===null)throw Error(pr(308));jx=t,QE.dependencies={lanes:0,firstContext:t}}else jx=jx.next=t;return e}var k1=null;function V2(t){k1===null?k1=[t]:k1.push(t)}function bD(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,V2(e)):(n.next=s.next,s.next=n),e.interleaved=n,Hg(t,r)}function Hg(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var hy=!1;function G2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zg(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Sy(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,$s&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Hg(t,n)}return s=r.interleaved,s===null?(e.next=e,V2(r)):(e.next=s.next,s.next=e),r.interleaved=e,Hg(t,n)}function gE(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,C2(t,n)}}function qL(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,u=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};u===null?s=u=p:u=u.next=p,n=n.next}while(n!==null);u===null?s=u=e:u=u.next=e}else s=u=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:u,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function eS(t,e,n,r){var s=t.updateQueue;hy=!1;var u=s.firstBaseUpdate,p=s.lastBaseUpdate,g=s.shared.pending;if(g!==null){s.shared.pending=null;var l=g,E=l.next;l.next=null,p===null?u=E:p.next=E,p=l;var P=t.alternate;P!==null&&(P=P.updateQueue,g=P.lastBaseUpdate,g!==p&&(g===null?P.firstBaseUpdate=E:g.next=E,P.lastBaseUpdate=l))}if(u!==null){var O=s.baseState;p=0,P=E=l=null,g=u;do{var j=g.lane,$=g.eventTime;if((r&j)===j){P!==null&&(P=P.next={eventTime:$,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var Y=t,re=g;switch(j=e,$=n,re.tag){case 1:if(Y=re.payload,typeof Y=="function"){O=Y.call($,O,j);break e}O=Y;break e;case 3:Y.flags=Y.flags&-65537|128;case 0:if(Y=re.payload,j=typeof Y=="function"?Y.call($,O,j):Y,j==null)break e;O=Wa({},O,j);break e;case 2:hy=!0}}g.callback!==null&&g.lane!==0&&(t.flags|=64,j=s.effects,j===null?s.effects=[g]:j.push(g))}else $={eventTime:$,lane:j,tag:g.tag,payload:g.payload,callback:g.callback,next:null},P===null?(E=P=$,l=O):P=P.next=$,p|=j;if(g=g.next,g===null){if(g=s.shared.pending,g===null)break;j=g,g=j.next,j.next=null,s.lastBaseUpdate=j,s.shared.pending=null}}while(!0);if(P===null&&(l=O),s.baseState=l,s.firstBaseUpdate=E,s.lastBaseUpdate=P,e=s.shared.interleaved,e!==null){s=e;do p|=s.lane,s=s.next;while(s!==e)}else u===null&&(s.shared.lanes=0);j1|=p,t.lanes=p,t.memoizedState=O}}function $L(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(pr(191,s));s.call(r)}}}var ED=new bN.Component().refs;function dk(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Wa({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var JS={isMounted:function(t){return(t=t._reactInternals)?ov(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=kc(),s=My(t),u=zg(r,s);u.payload=e,n!=null&&(u.callback=n),e=Sy(t,u,s),e!==null&&(sp(e,t,s,r),gE(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=kc(),s=My(t),u=zg(r,s);u.tag=1,u.payload=e,n!=null&&(u.callback=n),e=Sy(t,u,s),e!==null&&(sp(e,t,s,r),gE(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=kc(),r=My(t),s=zg(n,r);s.tag=2,e!=null&&(s.callback=e),e=Sy(t,s,r),e!==null&&(sp(e,t,r,n),gE(e,t,r))}};function XL(t,e,n,r,s,u,p){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,u,p):e.prototype&&e.prototype.isPureReactComponent?!w5(n,r)||!w5(s,u):!0}function SD(t,e,n){var r=!1,s=Ny,u=e.contextType;return typeof u=="object"&&u!==null?u=Qd(u):(s=fh(e)?z1:oc.current,r=e.contextTypes,u=(r=r!=null)?sb(t,s):Ny),e=new e(n,u),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=JS,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=u),e}function ZL(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&JS.enqueueReplaceState(e,e.state,null)}function fk(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=ED,G2(t);var u=e.contextType;typeof u=="object"&&u!==null?s.context=Qd(u):(u=fh(e)?z1:oc.current,s.context=sb(t,u)),s.state=t.memoizedState,u=e.getDerivedStateFromProps,typeof u=="function"&&(dk(t,e,u,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&JS.enqueueReplaceState(s,s.state,null),eS(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function gw(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pr(309));var r=n.stateNode}if(!r)throw Error(pr(147,t));var s=r,u=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===u?e.ref:(e=function(p){var g=s.refs;g===ED&&(g=s.refs={}),p===null?delete g[u]:g[u]=p},e._stringRef=u,e)}if(typeof t!="string")throw Error(pr(284));if(!n._owner)throw Error(pr(290,t))}return t}function j4(t,e){throw t=Object.prototype.toString.call(e),Error(pr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function YL(t){var e=t._init;return e(t._payload)}function TD(t){function e(J,H){if(t){var te=J.deletions;te===null?(J.deletions=[H],J.flags|=16):te.push(H)}}function n(J,H){if(!t)return null;for(;H!==null;)e(J,H),H=H.sibling;return null}function r(J,H){for(J=new Map;H!==null;)H.key!==null?J.set(H.key,H):J.set(H.index,H),H=H.sibling;return J}function s(J,H){return J=ky(J,H),J.index=0,J.sibling=null,J}function u(J,H,te){return J.index=te,t?(te=J.alternate,te!==null?(te=te.index,te<H?(J.flags|=2,H):te):(J.flags|=2,H)):(J.flags|=1048576,H)}function p(J){return t&&J.alternate===null&&(J.flags|=2),J}function g(J,H,te,ce){return H===null||H.tag!==6?(H=W6(te,J.mode,ce),H.return=J,H):(H=s(H,te),H.return=J,H)}function l(J,H,te,ce){var Se=te.type;return Se===Rx?P(J,H,te.props.children,ce,te.key):H!==null&&(H.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===cy&&YL(Se)===H.type)?(ce=s(H,te.props),ce.ref=gw(J,H,te),ce.return=J,ce):(ce=wE(te.type,te.key,te.props,null,J.mode,ce),ce.ref=gw(J,H,te),ce.return=J,ce)}function E(J,H,te,ce){return H===null||H.tag!==4||H.stateNode.containerInfo!==te.containerInfo||H.stateNode.implementation!==te.implementation?(H=q6(te,J.mode,ce),H.return=J,H):(H=s(H,te.children||[]),H.return=J,H)}function P(J,H,te,ce,Se){return H===null||H.tag!==7?(H=N1(te,J.mode,ce,Se),H.return=J,H):(H=s(H,te),H.return=J,H)}function O(J,H,te){if(typeof H=="string"&&H!==""||typeof H=="number")return H=W6(""+H,J.mode,te),H.return=J,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case A4:return te=wE(H.type,H.key,H.props,null,J.mode,te),te.ref=gw(J,null,H),te.return=J,te;case Px:return H=q6(H,J.mode,te),H.return=J,H;case cy:var ce=H._init;return O(J,ce(H._payload),te)}if(Bw(H)||hw(H))return H=N1(H,J.mode,te,null),H.return=J,H;j4(J,H)}return null}function j(J,H,te,ce){var Se=H!==null?H.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Se!==null?null:g(J,H,""+te,ce);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case A4:return te.key===Se?l(J,H,te,ce):null;case Px:return te.key===Se?E(J,H,te,ce):null;case cy:return Se=te._init,j(J,H,Se(te._payload),ce)}if(Bw(te)||hw(te))return Se!==null?null:P(J,H,te,ce,null);j4(J,te)}return null}function $(J,H,te,ce,Se){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return J=J.get(te)||null,g(H,J,""+ce,Se);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case A4:return J=J.get(ce.key===null?te:ce.key)||null,l(H,J,ce,Se);case Px:return J=J.get(ce.key===null?te:ce.key)||null,E(H,J,ce,Se);case cy:var Ie=ce._init;return $(J,H,te,Ie(ce._payload),Se)}if(Bw(ce)||hw(ce))return J=J.get(te)||null,P(H,J,ce,Se,null);j4(H,ce)}return null}function Y(J,H,te,ce){for(var Se=null,Ie=null,Ne=H,ut=H=0,mt=null;Ne!==null&&ut<te.length;ut++){Ne.index>ut?(mt=Ne,Ne=null):mt=Ne.sibling;var We=j(J,Ne,te[ut],ce);if(We===null){Ne===null&&(Ne=mt);break}t&&Ne&&We.alternate===null&&e(J,Ne),H=u(We,H,ut),Ie===null?Se=We:Ie.sibling=We,Ie=We,Ne=mt}if(ut===te.length)return n(J,Ne),Ta&&g1(J,ut),Se;if(Ne===null){for(;ut<te.length;ut++)Ne=O(J,te[ut],ce),Ne!==null&&(H=u(Ne,H,ut),Ie===null?Se=Ne:Ie.sibling=Ne,Ie=Ne);return Ta&&g1(J,ut),Se}for(Ne=r(J,Ne);ut<te.length;ut++)mt=$(Ne,J,ut,te[ut],ce),mt!==null&&(t&&mt.alternate!==null&&Ne.delete(mt.key===null?ut:mt.key),H=u(mt,H,ut),Ie===null?Se=mt:Ie.sibling=mt,Ie=mt);return t&&Ne.forEach(function(Ot){return e(J,Ot)}),Ta&&g1(J,ut),Se}function re(J,H,te,ce){var Se=hw(te);if(typeof Se!="function")throw Error(pr(150));if(te=Se.call(te),te==null)throw Error(pr(151));for(var Ie=Se=null,Ne=H,ut=H=0,mt=null,We=te.next();Ne!==null&&!We.done;ut++,We=te.next()){Ne.index>ut?(mt=Ne,Ne=null):mt=Ne.sibling;var Ot=j(J,Ne,We.value,ce);if(Ot===null){Ne===null&&(Ne=mt);break}t&&Ne&&Ot.alternate===null&&e(J,Ne),H=u(Ot,H,ut),Ie===null?Se=Ot:Ie.sibling=Ot,Ie=Ot,Ne=mt}if(We.done)return n(J,Ne),Ta&&g1(J,ut),Se;if(Ne===null){for(;!We.done;ut++,We=te.next())We=O(J,We.value,ce),We!==null&&(H=u(We,H,ut),Ie===null?Se=We:Ie.sibling=We,Ie=We);return Ta&&g1(J,ut),Se}for(Ne=r(J,Ne);!We.done;ut++,We=te.next())We=$(Ne,J,ut,We.value,ce),We!==null&&(t&&We.alternate!==null&&Ne.delete(We.key===null?ut:We.key),H=u(We,H,ut),Ie===null?Se=We:Ie.sibling=We,Ie=We);return t&&Ne.forEach(function(st){return e(J,st)}),Ta&&g1(J,ut),Se}function _e(J,H,te,ce){if(typeof te=="object"&&te!==null&&te.type===Rx&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case A4:e:{for(var Se=te.key,Ie=H;Ie!==null;){if(Ie.key===Se){if(Se=te.type,Se===Rx){if(Ie.tag===7){n(J,Ie.sibling),H=s(Ie,te.props.children),H.return=J,J=H;break e}}else if(Ie.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===cy&&YL(Se)===Ie.type){n(J,Ie.sibling),H=s(Ie,te.props),H.ref=gw(J,Ie,te),H.return=J,J=H;break e}n(J,Ie);break}else e(J,Ie);Ie=Ie.sibling}te.type===Rx?(H=N1(te.props.children,J.mode,ce,te.key),H.return=J,J=H):(ce=wE(te.type,te.key,te.props,null,J.mode,ce),ce.ref=gw(J,H,te),ce.return=J,J=ce)}return p(J);case Px:e:{for(Ie=te.key;H!==null;){if(H.key===Ie)if(H.tag===4&&H.stateNode.containerInfo===te.containerInfo&&H.stateNode.implementation===te.implementation){n(J,H.sibling),H=s(H,te.children||[]),H.return=J,J=H;break e}else{n(J,H);break}else e(J,H);H=H.sibling}H=q6(te,J.mode,ce),H.return=J,J=H}return p(J);case cy:return Ie=te._init,_e(J,H,Ie(te._payload),ce)}if(Bw(te))return Y(J,H,te,ce);if(hw(te))return re(J,H,te,ce);j4(J,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,H!==null&&H.tag===6?(n(J,H.sibling),H=s(H,te),H.return=J,J=H):(n(J,H),H=W6(te,J.mode,ce),H.return=J,J=H),p(J)):n(J,H)}return _e}var ab=TD(!0),MD=TD(!1),d9={},km=$y(d9),M5=$y(d9),k5=$y(d9);function C1(t){if(t===d9)throw Error(pr(174));return t}function H2(t,e){switch(Ko(k5,e),Ko(M5,t),Ko(km,d9),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:W7(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=W7(e,t)}ua(km),Ko(km,e)}function lb(){ua(km),ua(M5),ua(k5)}function kD(t){C1(k5.current);var e=C1(km.current),n=W7(e,t.type);e!==n&&(Ko(M5,t),Ko(km,n))}function W2(t){M5.current===t&&(ua(km),ua(M5))}var Ba=$y(0);function tS(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var B6=[];function q2(){for(var t=0;t<B6.length;t++)B6[t]._workInProgressVersionPrimary=null;B6.length=0}var yE=s0.ReactCurrentDispatcher,U6=s0.ReactCurrentBatchConfig,U1=0,Ha=null,Zl=null,au=null,nS=!1,t5=!1,C5=0,c$=0;function Ju(){throw Error(pr(321))}function $2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!up(t[n],e[n]))return!1;return!0}function X2(t,e,n,r,s,u){if(U1=u,Ha=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yE.current=t===null||t.memoizedState===null?p$:m$,t=n(r,s),t5){u=0;do{if(t5=!1,C5=0,25<=u)throw Error(pr(301));u+=1,au=Zl=null,e.updateQueue=null,yE.current=g$,t=n(r,s)}while(t5)}if(yE.current=rS,e=Zl!==null&&Zl.next!==null,U1=0,au=Zl=Ha=null,nS=!1,e)throw Error(pr(300));return t}function Z2(){var t=C5!==0;return C5=0,t}function gm(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return au===null?Ha.memoizedState=au=t:au=au.next=t,au}function ef(){if(Zl===null){var t=Ha.alternate;t=t!==null?t.memoizedState:null}else t=Zl.next;var e=au===null?Ha.memoizedState:au.next;if(e!==null)au=e,Zl=t;else{if(t===null)throw Error(pr(310));Zl=t,t={memoizedState:Zl.memoizedState,baseState:Zl.baseState,baseQueue:Zl.baseQueue,queue:Zl.queue,next:null},au===null?Ha.memoizedState=au=t:au=au.next=t}return au}function I5(t,e){return typeof e=="function"?e(t):e}function j6(t){var e=ef(),n=e.queue;if(n===null)throw Error(pr(311));n.lastRenderedReducer=t;var r=Zl,s=r.baseQueue,u=n.pending;if(u!==null){if(s!==null){var p=s.next;s.next=u.next,u.next=p}r.baseQueue=s=u,n.pending=null}if(s!==null){u=s.next,r=r.baseState;var g=p=null,l=null,E=u;do{var P=E.lane;if((U1&P)===P)l!==null&&(l=l.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),r=E.hasEagerState?E.eagerState:t(r,E.action);else{var O={lane:P,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};l===null?(g=l=O,p=r):l=l.next=O,Ha.lanes|=P,j1|=P}E=E.next}while(E!==null&&E!==u);l===null?p=r:l.next=g,up(r,e.memoizedState)||(hh=!0),e.memoizedState=r,e.baseState=p,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do u=s.lane,Ha.lanes|=u,j1|=u,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function V6(t){var e=ef(),n=e.queue;if(n===null)throw Error(pr(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,u=e.memoizedState;if(s!==null){n.pending=null;var p=s=s.next;do u=t(u,p.action),p=p.next;while(p!==s);up(u,e.memoizedState)||(hh=!0),e.memoizedState=u,e.baseQueue===null&&(e.baseState=u),n.lastRenderedState=u}return[u,r]}function CD(){}function ID(t,e){var n=Ha,r=ef(),s=e(),u=!up(r.memoizedState,s);if(u&&(r.memoizedState=s,hh=!0),r=r.queue,Y2(PD.bind(null,n,r,t),[t]),r.getSnapshot!==e||u||au!==null&&au.memoizedState.tag&1){if(n.flags|=2048,A5(9,LD.bind(null,n,r,s,e),void 0,null),du===null)throw Error(pr(349));U1&30||AD(n,e,s)}return s}function AD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ha.updateQueue,e===null?(e={lastEffect:null,stores:null},Ha.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function LD(t,e,n,r){e.value=n,e.getSnapshot=r,RD(e)&&ND(t)}function PD(t,e,n){return n(function(){RD(e)&&ND(t)})}function RD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!up(t,n)}catch{return!0}}function ND(t){var e=Hg(t,1);e!==null&&sp(e,t,1,-1)}function KL(t){var e=gm();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:I5,lastRenderedState:t},e.queue=t,t=t.dispatch=f$.bind(null,Ha,t),[e.memoizedState,t]}function A5(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ha.updateQueue,e===null?(e={lastEffect:null,stores:null},Ha.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function DD(){return ef().memoizedState}function _E(t,e,n,r){var s=gm();Ha.flags|=t,s.memoizedState=A5(1|e,n,void 0,r===void 0?null:r)}function QS(t,e,n,r){var s=ef();r=r===void 0?null:r;var u=void 0;if(Zl!==null){var p=Zl.memoizedState;if(u=p.destroy,r!==null&&$2(r,p.deps)){s.memoizedState=A5(e,n,u,r);return}}Ha.flags|=t,s.memoizedState=A5(1|e,n,u,r)}function JL(t,e){return _E(8390656,8,t,e)}function Y2(t,e){return QS(2048,8,t,e)}function OD(t,e){return QS(4,2,t,e)}function FD(t,e){return QS(4,4,t,e)}function zD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BD(t,e,n){return n=n!=null?n.concat([t]):null,QS(4,4,zD.bind(null,e,t),n)}function K2(){}function UD(t,e){var n=ef();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$2(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function jD(t,e){var n=ef();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$2(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function VD(t,e,n){return U1&21?(up(n,e)||(n=WN(),Ha.lanes|=n,j1|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,hh=!0),t.memoizedState=n)}function h$(t,e){var n=So;So=n!==0&&4>n?n:4,t(!0);var r=U6.transition;U6.transition={};try{t(!1),e()}finally{So=n,U6.transition=r}}function GD(){return ef().memoizedState}function d$(t,e,n){var r=My(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},HD(t))WD(e,n);else if(n=bD(t,e,n,r),n!==null){var s=kc();sp(n,t,r,s),qD(n,e,r)}}function f$(t,e,n){var r=My(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(HD(t))WD(e,s);else{var u=t.alternate;if(t.lanes===0&&(u===null||u.lanes===0)&&(u=e.lastRenderedReducer,u!==null))try{var p=e.lastRenderedState,g=u(p,n);if(s.hasEagerState=!0,s.eagerState=g,up(g,p)){var l=e.interleaved;l===null?(s.next=s,V2(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=bD(t,e,s,r),n!==null&&(s=kc(),sp(n,t,r,s),qD(n,e,r))}}function HD(t){var e=t.alternate;return t===Ha||e!==null&&e===Ha}function WD(t,e){t5=nS=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function qD(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,C2(t,n)}}var rS={readContext:Qd,useCallback:Ju,useContext:Ju,useEffect:Ju,useImperativeHandle:Ju,useInsertionEffect:Ju,useLayoutEffect:Ju,useMemo:Ju,useReducer:Ju,useRef:Ju,useState:Ju,useDebugValue:Ju,useDeferredValue:Ju,useTransition:Ju,useMutableSource:Ju,useSyncExternalStore:Ju,useId:Ju,unstable_isNewReconciler:!1},p$={readContext:Qd,useCallback:function(t,e){return gm().memoizedState=[t,e===void 0?null:e],t},useContext:Qd,useEffect:JL,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_E(4194308,4,zD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _E(4194308,4,t,e)},useInsertionEffect:function(t,e){return _E(4,2,t,e)},useMemo:function(t,e){var n=gm();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=gm();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=d$.bind(null,Ha,t),[r.memoizedState,t]},useRef:function(t){var e=gm();return t={current:t},e.memoizedState=t},useState:KL,useDebugValue:K2,useDeferredValue:function(t){return gm().memoizedState=t},useTransition:function(){var t=KL(!1),e=t[0];return t=h$.bind(null,t[1]),gm().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ha,s=gm();if(Ta){if(n===void 0)throw Error(pr(407));n=n()}else{if(n=e(),du===null)throw Error(pr(349));U1&30||AD(r,e,n)}s.memoizedState=n;var u={value:n,getSnapshot:e};return s.queue=u,JL(PD.bind(null,r,u,t),[t]),r.flags|=2048,A5(9,LD.bind(null,r,u,n,e),void 0,null),n},useId:function(){var t=gm(),e=du.identifierPrefix;if(Ta){var n=Dg,r=Ng;n=(r&~(1<<32-ip(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=C5++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=c$++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},m$={readContext:Qd,useCallback:UD,useContext:Qd,useEffect:Y2,useImperativeHandle:BD,useInsertionEffect:OD,useLayoutEffect:FD,useMemo:jD,useReducer:j6,useRef:DD,useState:function(){return j6(I5)},useDebugValue:K2,useDeferredValue:function(t){var e=ef();return VD(e,Zl.memoizedState,t)},useTransition:function(){var t=j6(I5)[0],e=ef().memoizedState;return[t,e]},useMutableSource:CD,useSyncExternalStore:ID,useId:GD,unstable_isNewReconciler:!1},g$={readContext:Qd,useCallback:UD,useContext:Qd,useEffect:Y2,useImperativeHandle:BD,useInsertionEffect:OD,useLayoutEffect:FD,useMemo:jD,useReducer:V6,useRef:DD,useState:function(){return V6(I5)},useDebugValue:K2,useDeferredValue:function(t){var e=ef();return Zl===null?e.memoizedState=t:VD(e,Zl.memoizedState,t)},useTransition:function(){var t=V6(I5)[0],e=ef().memoizedState;return[t,e]},useMutableSource:CD,useSyncExternalStore:ID,useId:GD,unstable_isNewReconciler:!1};function ub(t,e){try{var n="",r=e;do n+=HW(r),r=r.return;while(r);var s=n}catch(u){s=`
Error generating stack: `+u.message+`
`+u.stack}return{value:t,source:e,stack:s,digest:null}}function G6(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pk(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var y$=typeof WeakMap=="function"?WeakMap:Map;function $D(t,e,n){n=zg(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sS||(sS=!0,Sk=r),pk(t,e)},n}function XD(t,e,n){n=zg(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){pk(t,e)}}var u=t.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(n.callback=function(){pk(t,e),typeof r!="function"&&(Ty===null?Ty=new Set([this]):Ty.add(this));var p=e.stack;this.componentDidCatch(e.value,{componentStack:p!==null?p:""})}),n}function QL(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new y$;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=L$.bind(null,t,e,n),e.then(t,t))}function eP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function tP(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zg(-1,1),e.tag=2,Sy(n,e,1))),n.lanes|=1),t)}var _$=s0.ReactCurrentOwner,hh=!1;function wc(t,e,n,r){e.child=t===null?MD(e,null,n,r):ab(e,t.child,n,r)}function nP(t,e,n,r,s){n=n.render;var u=e.ref;return Yx(e,s),r=X2(t,e,n,r,u,s),n=Z2(),t!==null&&!hh?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Wg(t,e,s)):(Ta&&n&&O2(e),e.flags|=1,wc(t,e,r,s),e.child)}function rP(t,e,n,r,s){if(t===null){var u=n.type;return typeof u=="function"&&!sC(u)&&u.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=u,ZD(t,e,u,r,s)):(t=wE(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(u=t.child,!(t.lanes&s)){var p=u.memoizedProps;if(n=n.compare,n=n!==null?n:w5,n(p,r)&&t.ref===e.ref)return Wg(t,e,s)}return e.flags|=1,t=ky(u,r),t.ref=e.ref,t.return=e,e.child=t}function ZD(t,e,n,r,s){if(t!==null){var u=t.memoizedProps;if(w5(u,r)&&t.ref===e.ref)if(hh=!1,e.pendingProps=r=u,(t.lanes&s)!==0)t.flags&131072&&(hh=!0);else return e.lanes=t.lanes,Wg(t,e,s)}return mk(t,e,n,r,s)}function YD(t,e,n){var r=e.pendingProps,s=r.children,u=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ko(Gx,Hh),Hh|=n;else{if(!(n&1073741824))return t=u!==null?u.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ko(Gx,Hh),Hh|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=u!==null?u.baseLanes:n,Ko(Gx,Hh),Hh|=r}else u!==null?(r=u.baseLanes|n,e.memoizedState=null):r=n,Ko(Gx,Hh),Hh|=r;return wc(t,e,s,n),e.child}function KD(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mk(t,e,n,r,s){var u=fh(n)?z1:oc.current;return u=sb(e,u),Yx(e,s),n=X2(t,e,n,r,u,s),r=Z2(),t!==null&&!hh?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Wg(t,e,s)):(Ta&&r&&O2(e),e.flags|=1,wc(t,e,n,s),e.child)}function iP(t,e,n,r,s){if(fh(n)){var u=!0;ZE(e)}else u=!1;if(Yx(e,s),e.stateNode===null)vE(t,e),SD(e,n,r),fk(e,n,r,s),r=!0;else if(t===null){var p=e.stateNode,g=e.memoizedProps;p.props=g;var l=p.context,E=n.contextType;typeof E=="object"&&E!==null?E=Qd(E):(E=fh(n)?z1:oc.current,E=sb(e,E));var P=n.getDerivedStateFromProps,O=typeof P=="function"||typeof p.getSnapshotBeforeUpdate=="function";O||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(g!==r||l!==E)&&ZL(e,p,r,E),hy=!1;var j=e.memoizedState;p.state=j,eS(e,r,p,s),l=e.memoizedState,g!==r||j!==l||dh.current||hy?(typeof P=="function"&&(dk(e,n,P,r),l=e.memoizedState),(g=hy||XL(e,n,g,r,j,l,E))?(O||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(e.flags|=4194308)):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),p.props=r,p.state=l,p.context=E,r=g):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{p=e.stateNode,wD(t,e),g=e.memoizedProps,E=e.type===e.elementType?g:Kf(e.type,g),p.props=E,O=e.pendingProps,j=p.context,l=n.contextType,typeof l=="object"&&l!==null?l=Qd(l):(l=fh(n)?z1:oc.current,l=sb(e,l));var $=n.getDerivedStateFromProps;(P=typeof $=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(g!==O||j!==l)&&ZL(e,p,r,l),hy=!1,j=e.memoizedState,p.state=j,eS(e,r,p,s);var Y=e.memoizedState;g!==O||j!==Y||dh.current||hy?(typeof $=="function"&&(dk(e,n,$,r),Y=e.memoizedState),(E=hy||XL(e,n,E,r,j,Y,l)||!1)?(P||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(r,Y,l),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(r,Y,l)),typeof p.componentDidUpdate=="function"&&(e.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof p.componentDidUpdate!="function"||g===t.memoizedProps&&j===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||g===t.memoizedProps&&j===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=Y),p.props=r,p.state=Y,p.context=l,r=E):(typeof p.componentDidUpdate!="function"||g===t.memoizedProps&&j===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||g===t.memoizedProps&&j===t.memoizedState||(e.flags|=1024),r=!1)}return gk(t,e,n,r,u,s)}function gk(t,e,n,r,s,u){KD(t,e);var p=(e.flags&128)!==0;if(!r&&!p)return s&&GL(e,n,!1),Wg(t,e,u);r=e.stateNode,_$.current=e;var g=p&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&p?(e.child=ab(e,t.child,null,u),e.child=ab(e,null,g,u)):wc(t,e,g,u),e.memoizedState=r.state,s&&GL(e,n,!0),e.child}function JD(t){var e=t.stateNode;e.pendingContext?VL(t,e.pendingContext,e.pendingContext!==e.context):e.context&&VL(t,e.context,!1),H2(t,e.containerInfo)}function sP(t,e,n,r,s){return ob(),z2(s),e.flags|=256,wc(t,e,n,r),e.child}var yk={dehydrated:null,treeContext:null,retryLane:0};function _k(t){return{baseLanes:t,cachePool:null,transitions:null}}function QD(t,e,n){var r=e.pendingProps,s=Ba.current,u=!1,p=(e.flags&128)!==0,g;if((g=p)||(g=t!==null&&t.memoizedState===null?!1:(s&2)!==0),g?(u=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ko(Ba,s&1),t===null)return ck(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(p=r.children,t=r.fallback,u?(r=e.mode,u=e.child,p={mode:"hidden",children:p},!(r&1)&&u!==null?(u.childLanes=0,u.pendingProps=p):u=nT(p,r,0,null),t=N1(t,r,n,null),u.return=e,t.return=e,u.sibling=t,e.child=u,e.child.memoizedState=_k(n),e.memoizedState=yk,t):J2(e,p));if(s=t.memoizedState,s!==null&&(g=s.dehydrated,g!==null))return v$(t,e,p,r,g,s,n);if(u){u=r.fallback,p=e.mode,s=t.child,g=s.sibling;var l={mode:"hidden",children:r.children};return!(p&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ky(s,l),r.subtreeFlags=s.subtreeFlags&14680064),g!==null?u=ky(g,u):(u=N1(u,p,n,null),u.flags|=2),u.return=e,r.return=e,r.sibling=u,e.child=r,r=u,u=e.child,p=t.child.memoizedState,p=p===null?_k(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},u.memoizedState=p,u.childLanes=t.childLanes&~n,e.memoizedState=yk,r}return u=t.child,t=u.sibling,r=ky(u,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function J2(t,e){return e=nT({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function V4(t,e,n,r){return r!==null&&z2(r),ab(e,t.child,null,n),t=J2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function v$(t,e,n,r,s,u,p){if(n)return e.flags&256?(e.flags&=-257,r=G6(Error(pr(422))),V4(t,e,p,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(u=r.fallback,s=e.mode,r=nT({mode:"visible",children:r.children},s,0,null),u=N1(u,s,p,null),u.flags|=2,r.return=e,u.return=e,r.sibling=u,e.child=r,e.mode&1&&ab(e,t.child,null,p),e.child.memoizedState=_k(p),e.memoizedState=yk,u);if(!(e.mode&1))return V4(t,e,p,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var g=r.dgst;return r=g,u=Error(pr(419)),r=G6(u,r,void 0),V4(t,e,p,r)}if(g=(p&t.childLanes)!==0,hh||g){if(r=du,r!==null){switch(p&-p){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|p)?0:s,s!==0&&s!==u.retryLane&&(u.retryLane=s,Hg(t,s),sp(r,t,s,-1))}return iC(),r=G6(Error(pr(421))),V4(t,e,p,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=P$.bind(null,t),s._reactRetry=e,null):(t=u.treeContext,Kh=Ey(s.nextSibling),Jh=e,Ta=!0,ep=null,t!==null&&(Wd[qd++]=Ng,Wd[qd++]=Dg,Wd[qd++]=B1,Ng=t.id,Dg=t.overflow,B1=e),e=J2(e,r.children),e.flags|=4096,e)}function oP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hk(t.return,e,n)}function H6(t,e,n,r,s){var u=t.memoizedState;u===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(u.isBackwards=e,u.rendering=null,u.renderingStartTime=0,u.last=r,u.tail=n,u.tailMode=s)}function eO(t,e,n){var r=e.pendingProps,s=r.revealOrder,u=r.tail;if(wc(t,e,r.children,n),r=Ba.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oP(t,n,e);else if(t.tag===19)oP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ko(Ba,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&tS(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),H6(e,!1,s,n,u);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&tS(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}H6(e,!0,n,null,u);break;case"together":H6(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vE(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wg(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),j1|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(pr(153));if(e.child!==null){for(t=e.child,n=ky(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ky(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function x$(t,e,n){switch(e.tag){case 3:JD(e),ob();break;case 5:kD(e);break;case 1:fh(e.type)&&ZE(e);break;case 4:H2(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ko(JE,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ko(Ba,Ba.current&1),e.flags|=128,null):n&e.child.childLanes?QD(t,e,n):(Ko(Ba,Ba.current&1),t=Wg(t,e,n),t!==null?t.sibling:null);Ko(Ba,Ba.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return eO(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ko(Ba,Ba.current),r)break;return null;case 22:case 23:return e.lanes=0,YD(t,e,n)}return Wg(t,e,n)}var tO,vk,nO,rO;tO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vk=function(){};nO=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,C1(km.current);var u=null;switch(n){case"input":s=j7(t,s),r=j7(t,r),u=[];break;case"select":s=Wa({},s,{value:void 0}),r=Wa({},r,{value:void 0}),u=[];break;case"textarea":s=H7(t,s),r=H7(t,r),u=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$E)}q7(n,r);var p;n=null;for(E in s)if(!r.hasOwnProperty(E)&&s.hasOwnProperty(E)&&s[E]!=null)if(E==="style"){var g=s[E];for(p in g)g.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(m5.hasOwnProperty(E)?u||(u=[]):(u=u||[]).push(E,null));for(E in r){var l=r[E];if(g=s!=null?s[E]:void 0,r.hasOwnProperty(E)&&l!==g&&(l!=null||g!=null))if(E==="style")if(g){for(p in g)!g.hasOwnProperty(p)||l&&l.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in l)l.hasOwnProperty(p)&&g[p]!==l[p]&&(n||(n={}),n[p]=l[p])}else n||(u||(u=[]),u.push(E,n)),n=l;else E==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,g=g?g.__html:void 0,l!=null&&g!==l&&(u=u||[]).push(E,l)):E==="children"?typeof l!="string"&&typeof l!="number"||(u=u||[]).push(E,""+l):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(m5.hasOwnProperty(E)?(l!=null&&E==="onScroll"&&oa("scroll",t),u||g===l||(u=[])):(u=u||[]).push(E,l))}n&&(u=u||[]).push("style",n);var E=u;(e.updateQueue=E)&&(e.flags|=4)}};rO=function(t,e,n,r){n!==r&&(e.flags|=4)};function yw(t,e){if(!Ta)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qu(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function b$(t,e,n){var r=e.pendingProps;switch(F2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qu(e),null;case 1:return fh(e.type)&&XE(),Qu(e),null;case 3:return r=e.stateNode,lb(),ua(dh),ua(oc),q2(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(U4(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ep!==null&&(kk(ep),ep=null))),vk(t,e),Qu(e),null;case 5:W2(e);var s=C1(k5.current);if(n=e.type,t!==null&&e.stateNode!=null)nO(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(pr(166));return Qu(e),null}if(t=C1(km.current),U4(e)){r=e.stateNode,n=e.type;var u=e.memoizedProps;switch(r[Em]=e,r[T5]=u,t=(e.mode&1)!==0,n){case"dialog":oa("cancel",r),oa("close",r);break;case"iframe":case"object":case"embed":oa("load",r);break;case"video":case"audio":for(s=0;s<jw.length;s++)oa(jw[s],r);break;case"source":oa("error",r);break;case"img":case"image":case"link":oa("error",r),oa("load",r);break;case"details":oa("toggle",r);break;case"input":mL(r,u),oa("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!u.multiple},oa("invalid",r);break;case"textarea":yL(r,u),oa("invalid",r)}q7(n,u),s=null;for(var p in u)if(u.hasOwnProperty(p)){var g=u[p];p==="children"?typeof g=="string"?r.textContent!==g&&(u.suppressHydrationWarning!==!0&&B4(r.textContent,g,t),s=["children",g]):typeof g=="number"&&r.textContent!==""+g&&(u.suppressHydrationWarning!==!0&&B4(r.textContent,g,t),s=["children",""+g]):m5.hasOwnProperty(p)&&g!=null&&p==="onScroll"&&oa("scroll",r)}switch(n){case"input":L4(r),gL(r,u,!0);break;case"textarea":L4(r),_L(r);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(r.onclick=$E)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{p=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=AN(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=p.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=p.createElement(n,{is:r.is}):(t=p.createElement(n),n==="select"&&(p=t,r.multiple?p.multiple=!0:r.size&&(p.size=r.size))):t=p.createElementNS(t,n),t[Em]=e,t[T5]=r,tO(t,e,!1,!1),e.stateNode=t;e:{switch(p=$7(n,r),n){case"dialog":oa("cancel",t),oa("close",t),s=r;break;case"iframe":case"object":case"embed":oa("load",t),s=r;break;case"video":case"audio":for(s=0;s<jw.length;s++)oa(jw[s],t);s=r;break;case"source":oa("error",t),s=r;break;case"img":case"image":case"link":oa("error",t),oa("load",t),s=r;break;case"details":oa("toggle",t),s=r;break;case"input":mL(t,r),s=j7(t,r),oa("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Wa({},r,{value:void 0}),oa("invalid",t);break;case"textarea":yL(t,r),s=H7(t,r),oa("invalid",t);break;default:s=r}q7(n,s),g=s;for(u in g)if(g.hasOwnProperty(u)){var l=g[u];u==="style"?RN(t,l):u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&LN(t,l)):u==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&g5(t,l):typeof l=="number"&&g5(t,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(m5.hasOwnProperty(u)?l!=null&&u==="onScroll"&&oa("scroll",t):l!=null&&w2(t,u,l,p))}switch(n){case"input":L4(t),gL(t,r,!1);break;case"textarea":L4(t),_L(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ry(r.value));break;case"select":t.multiple=!!r.multiple,u=r.value,u!=null?qx(t,!!r.multiple,u,!1):r.defaultValue!=null&&qx(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=$E)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qu(e),null;case 6:if(t&&e.stateNode!=null)rO(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(pr(166));if(n=C1(k5.current),C1(km.current),U4(e)){if(r=e.stateNode,n=e.memoizedProps,r[Em]=e,(u=r.nodeValue!==n)&&(t=Jh,t!==null))switch(t.tag){case 3:B4(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&B4(r.nodeValue,n,(t.mode&1)!==0)}u&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Em]=e,e.stateNode=r}return Qu(e),null;case 13:if(ua(Ba),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ta&&Kh!==null&&e.mode&1&&!(e.flags&128))xD(),ob(),e.flags|=98560,u=!1;else if(u=U4(e),r!==null&&r.dehydrated!==null){if(t===null){if(!u)throw Error(pr(318));if(u=e.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(pr(317));u[Em]=e}else ob(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qu(e),u=!1}else ep!==null&&(kk(ep),ep=null),u=!0;if(!u)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ba.current&1?Yl===0&&(Yl=3):iC())),e.updateQueue!==null&&(e.flags|=4),Qu(e),null);case 4:return lb(),vk(t,e),t===null&&E5(e.stateNode.containerInfo),Qu(e),null;case 10:return j2(e.type._context),Qu(e),null;case 17:return fh(e.type)&&XE(),Qu(e),null;case 19:if(ua(Ba),u=e.memoizedState,u===null)return Qu(e),null;if(r=(e.flags&128)!==0,p=u.rendering,p===null)if(r)yw(u,!1);else{if(Yl!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(p=tS(t),p!==null){for(e.flags|=128,yw(u,!1),r=p.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)u=n,t=r,u.flags&=14680066,p=u.alternate,p===null?(u.childLanes=0,u.lanes=t,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=p.childLanes,u.lanes=p.lanes,u.child=p.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=p.memoizedProps,u.memoizedState=p.memoizedState,u.updateQueue=p.updateQueue,u.type=p.type,t=p.dependencies,u.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ko(Ba,Ba.current&1|2),e.child}t=t.sibling}u.tail!==null&&dl()>cb&&(e.flags|=128,r=!0,yw(u,!1),e.lanes=4194304)}else{if(!r)if(t=tS(p),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),yw(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!Ta)return Qu(e),null}else 2*dl()-u.renderingStartTime>cb&&n!==1073741824&&(e.flags|=128,r=!0,yw(u,!1),e.lanes=4194304);u.isBackwards?(p.sibling=e.child,e.child=p):(n=u.last,n!==null?n.sibling=p:e.child=p,u.last=p)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=dl(),e.sibling=null,n=Ba.current,Ko(Ba,r?n&1|2:n&1),e):(Qu(e),null);case 22:case 23:return rC(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Hh&1073741824&&(Qu(e),e.subtreeFlags&6&&(e.flags|=8192)):Qu(e),null;case 24:return null;case 25:return null}throw Error(pr(156,e.tag))}function w$(t,e){switch(F2(e),e.tag){case 1:return fh(e.type)&&XE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return lb(),ua(dh),ua(oc),q2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return W2(e),null;case 13:if(ua(Ba),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(pr(340));ob()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ua(Ba),null;case 4:return lb(),null;case 10:return j2(e.type._context),null;case 22:case 23:return rC(),null;case 24:return null;default:return null}}var G4=!1,rc=!1,E$=typeof WeakSet=="function"?WeakSet:Set,ti=null;function Vx(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){el(t,e,r)}else n.current=null}function xk(t,e,n){try{n()}catch(r){el(t,e,r)}}var aP=!1;function S$(t,e){if(rk=HE,t=aD(),D2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,u=r.focusNode;r=r.focusOffset;try{n.nodeType,u.nodeType}catch{n=null;break e}var p=0,g=-1,l=-1,E=0,P=0,O=t,j=null;t:for(;;){for(var $;O!==n||s!==0&&O.nodeType!==3||(g=p+s),O!==u||r!==0&&O.nodeType!==3||(l=p+r),O.nodeType===3&&(p+=O.nodeValue.length),($=O.firstChild)!==null;)j=O,O=$;for(;;){if(O===t)break t;if(j===n&&++E===s&&(g=p),j===u&&++P===r&&(l=p),($=O.nextSibling)!==null)break;O=j,j=O.parentNode}O=$}n=g===-1||l===-1?null:{start:g,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ik={focusedElem:t,selectionRange:n},HE=!1,ti=e;ti!==null;)if(e=ti,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ti=t;else for(;ti!==null;){e=ti;try{var Y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(Y!==null){var re=Y.memoizedProps,_e=Y.memoizedState,J=e.stateNode,H=J.getSnapshotBeforeUpdate(e.elementType===e.type?re:Kf(e.type,re),_e);J.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var te=e.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pr(163))}}catch(ce){el(e,e.return,ce)}if(t=e.sibling,t!==null){t.return=e.return,ti=t;break}ti=e.return}return Y=aP,aP=!1,Y}function n5(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var u=s.destroy;s.destroy=void 0,u!==void 0&&xk(e,n,u)}s=s.next}while(s!==r)}}function eT(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function bk(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function iO(t){var e=t.alternate;e!==null&&(t.alternate=null,iO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Em],delete e[T5],delete e[ak],delete e[o$],delete e[a$])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sO(t){return t.tag===5||t.tag===3||t.tag===4}function lP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sO(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wk(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$E));else if(r!==4&&(t=t.child,t!==null))for(wk(t,e,n),t=t.sibling;t!==null;)wk(t,e,n),t=t.sibling}function Ek(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ek(t,e,n),t=t.sibling;t!==null;)Ek(t,e,n),t=t.sibling}var Mu=null,Jf=!1;function K0(t,e,n){for(n=n.child;n!==null;)oO(t,e,n),n=n.sibling}function oO(t,e,n){if(Mm&&typeof Mm.onCommitFiberUnmount=="function")try{Mm.onCommitFiberUnmount(qS,n)}catch{}switch(n.tag){case 5:rc||Vx(n,e);case 6:var r=Mu,s=Jf;Mu=null,K0(t,e,n),Mu=r,Jf=s,Mu!==null&&(Jf?(t=Mu,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mu.removeChild(n.stateNode));break;case 18:Mu!==null&&(Jf?(t=Mu,n=n.stateNode,t.nodeType===8?F6(t.parentNode,n):t.nodeType===1&&F6(t,n),x5(t)):F6(Mu,n.stateNode));break;case 4:r=Mu,s=Jf,Mu=n.stateNode.containerInfo,Jf=!0,K0(t,e,n),Mu=r,Jf=s;break;case 0:case 11:case 14:case 15:if(!rc&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var u=s,p=u.destroy;u=u.tag,p!==void 0&&(u&2||u&4)&&xk(n,e,p),s=s.next}while(s!==r)}K0(t,e,n);break;case 1:if(!rc&&(Vx(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(g){el(n,e,g)}K0(t,e,n);break;case 21:K0(t,e,n);break;case 22:n.mode&1?(rc=(r=rc)||n.memoizedState!==null,K0(t,e,n),rc=r):K0(t,e,n);break;default:K0(t,e,n)}}function uP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new E$),e.forEach(function(r){var s=R$.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Yf(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var u=t,p=e,g=p;e:for(;g!==null;){switch(g.tag){case 5:Mu=g.stateNode,Jf=!1;break e;case 3:Mu=g.stateNode.containerInfo,Jf=!0;break e;case 4:Mu=g.stateNode.containerInfo,Jf=!0;break e}g=g.return}if(Mu===null)throw Error(pr(160));oO(u,p,s),Mu=null,Jf=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(E){el(s,e,E)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)aO(e,t),e=e.sibling}function aO(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yf(e,t),am(t),r&4){try{n5(3,t,t.return),eT(3,t)}catch(re){el(t,t.return,re)}try{n5(5,t,t.return)}catch(re){el(t,t.return,re)}}break;case 1:Yf(e,t),am(t),r&512&&n!==null&&Vx(n,n.return);break;case 5:if(Yf(e,t),am(t),r&512&&n!==null&&Vx(n,n.return),t.flags&32){var s=t.stateNode;try{g5(s,"")}catch(re){el(t,t.return,re)}}if(r&4&&(s=t.stateNode,s!=null)){var u=t.memoizedProps,p=n!==null?n.memoizedProps:u,g=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{g==="input"&&u.type==="radio"&&u.name!=null&&CN(s,u),$7(g,p);var E=$7(g,u);for(p=0;p<l.length;p+=2){var P=l[p],O=l[p+1];P==="style"?RN(s,O):P==="dangerouslySetInnerHTML"?LN(s,O):P==="children"?g5(s,O):w2(s,P,O,E)}switch(g){case"input":V7(s,u);break;case"textarea":IN(s,u);break;case"select":var j=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!u.multiple;var $=u.value;$!=null?qx(s,!!u.multiple,$,!1):j!==!!u.multiple&&(u.defaultValue!=null?qx(s,!!u.multiple,u.defaultValue,!0):qx(s,!!u.multiple,u.multiple?[]:"",!1))}s[T5]=u}catch(re){el(t,t.return,re)}}break;case 6:if(Yf(e,t),am(t),r&4){if(t.stateNode===null)throw Error(pr(162));s=t.stateNode,u=t.memoizedProps;try{s.nodeValue=u}catch(re){el(t,t.return,re)}}break;case 3:if(Yf(e,t),am(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{x5(e.containerInfo)}catch(re){el(t,t.return,re)}break;case 4:Yf(e,t),am(t);break;case 13:Yf(e,t),am(t),s=t.child,s.flags&8192&&(u=s.memoizedState!==null,s.stateNode.isHidden=u,!u||s.alternate!==null&&s.alternate.memoizedState!==null||(tC=dl())),r&4&&uP(t);break;case 22:if(P=n!==null&&n.memoizedState!==null,t.mode&1?(rc=(E=rc)||P,Yf(e,t),rc=E):Yf(e,t),am(t),r&8192){if(E=t.memoizedState!==null,(t.stateNode.isHidden=E)&&!P&&t.mode&1)for(ti=t,P=t.child;P!==null;){for(O=ti=P;ti!==null;){switch(j=ti,$=j.child,j.tag){case 0:case 11:case 14:case 15:n5(4,j,j.return);break;case 1:Vx(j,j.return);var Y=j.stateNode;if(typeof Y.componentWillUnmount=="function"){r=j,n=j.return;try{e=r,Y.props=e.memoizedProps,Y.state=e.memoizedState,Y.componentWillUnmount()}catch(re){el(r,n,re)}}break;case 5:Vx(j,j.return);break;case 22:if(j.memoizedState!==null){hP(O);continue}}$!==null?($.return=j,ti=$):hP(O)}P=P.sibling}e:for(P=null,O=t;;){if(O.tag===5){if(P===null){P=O;try{s=O.stateNode,E?(u=s.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(g=O.stateNode,l=O.memoizedProps.style,p=l!=null&&l.hasOwnProperty("display")?l.display:null,g.style.display=PN("display",p))}catch(re){el(t,t.return,re)}}}else if(O.tag===6){if(P===null)try{O.stateNode.nodeValue=E?"":O.memoizedProps}catch(re){el(t,t.return,re)}}else if((O.tag!==22&&O.tag!==23||O.memoizedState===null||O===t)&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===t)break e;for(;O.sibling===null;){if(O.return===null||O.return===t)break e;P===O&&(P=null),O=O.return}P===O&&(P=null),O.sibling.return=O.return,O=O.sibling}}break;case 19:Yf(e,t),am(t),r&4&&uP(t);break;case 21:break;default:Yf(e,t),am(t)}}function am(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(sO(n)){var r=n;break e}n=n.return}throw Error(pr(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(g5(s,""),r.flags&=-33);var u=lP(t);Ek(t,u,s);break;case 3:case 4:var p=r.stateNode.containerInfo,g=lP(t);wk(t,g,p);break;default:throw Error(pr(161))}}catch(l){el(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function T$(t,e,n){ti=t,lO(t)}function lO(t,e,n){for(var r=(t.mode&1)!==0;ti!==null;){var s=ti,u=s.child;if(s.tag===22&&r){var p=s.memoizedState!==null||G4;if(!p){var g=s.alternate,l=g!==null&&g.memoizedState!==null||rc;g=G4;var E=rc;if(G4=p,(rc=l)&&!E)for(ti=s;ti!==null;)p=ti,l=p.child,p.tag===22&&p.memoizedState!==null?dP(s):l!==null?(l.return=p,ti=l):dP(s);for(;u!==null;)ti=u,lO(u),u=u.sibling;ti=s,G4=g,rc=E}cP(t)}else s.subtreeFlags&8772&&u!==null?(u.return=s,ti=u):cP(t)}}function cP(t){for(;ti!==null;){var e=ti;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rc||eT(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!rc)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Kf(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var u=e.updateQueue;u!==null&&$L(e,u,r);break;case 3:var p=e.updateQueue;if(p!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$L(e,p,n)}break;case 5:var g=e.stateNode;if(n===null&&e.flags&4){n=g;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var E=e.alternate;if(E!==null){var P=E.memoizedState;if(P!==null){var O=P.dehydrated;O!==null&&x5(O)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pr(163))}rc||e.flags&512&&bk(e)}catch(j){el(e,e.return,j)}}if(e===t){ti=null;break}if(n=e.sibling,n!==null){n.return=e.return,ti=n;break}ti=e.return}}function hP(t){for(;ti!==null;){var e=ti;if(e===t){ti=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ti=n;break}ti=e.return}}function dP(t){for(;ti!==null;){var e=ti;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{eT(4,e)}catch(l){el(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){el(e,s,l)}}var u=e.return;try{bk(e)}catch(l){el(e,u,l)}break;case 5:var p=e.return;try{bk(e)}catch(l){el(e,p,l)}}}catch(l){el(e,e.return,l)}if(e===t){ti=null;break}var g=e.sibling;if(g!==null){g.return=e.return,ti=g;break}ti=e.return}}var M$=Math.ceil,iS=s0.ReactCurrentDispatcher,Q2=s0.ReactCurrentOwner,Zd=s0.ReactCurrentBatchConfig,$s=0,du=null,Al=null,Ru=0,Hh=0,Gx=$y(0),Yl=0,L5=null,j1=0,tT=0,eC=0,r5=null,ch=null,tC=0,cb=1/0,Pg=null,sS=!1,Sk=null,Ty=null,H4=!1,gy=null,oS=0,i5=0,Tk=null,xE=-1,bE=0;function kc(){return $s&6?dl():xE!==-1?xE:xE=dl()}function My(t){return t.mode&1?$s&2&&Ru!==0?Ru&-Ru:u$.transition!==null?(bE===0&&(bE=WN()),bE):(t=So,t!==0||(t=window.event,t=t===void 0?16:JN(t.type)),t):1}function sp(t,e,n,r){if(50<i5)throw i5=0,Tk=null,Error(pr(185));u9(t,n,r),(!($s&2)||t!==du)&&(t===du&&(!($s&2)&&(tT|=n),Yl===4&&fy(t,Ru)),ph(t,r),n===1&&$s===0&&!(e.mode&1)&&(cb=dl()+500,KS&&Xy()))}function ph(t,e){var n=t.callbackNode;uq(t,e);var r=GE(t,t===du?Ru:0);if(r===0)n!==null&&bL(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&bL(n),e===1)t.tag===0?l$(fP.bind(null,t)):yD(fP.bind(null,t)),i$(function(){!($s&6)&&Xy()}),n=null;else{switch(qN(r)){case 1:n=k2;break;case 4:n=GN;break;case 16:n=VE;break;case 536870912:n=HN;break;default:n=VE}n=gO(n,uO.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function uO(t,e){if(xE=-1,bE=0,$s&6)throw Error(pr(327));var n=t.callbackNode;if(Kx()&&t.callbackNode!==n)return null;var r=GE(t,t===du?Ru:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=aS(t,r);else{e=r;var s=$s;$s|=2;var u=hO();(du!==t||Ru!==e)&&(Pg=null,cb=dl()+500,R1(t,e));do try{I$();break}catch(g){cO(t,g)}while(!0);U2(),iS.current=u,$s=s,Al!==null?e=0:(du=null,Ru=0,e=Yl)}if(e!==0){if(e===2&&(s=J7(t),s!==0&&(r=s,e=Mk(t,s))),e===1)throw n=L5,R1(t,0),fy(t,r),ph(t,dl()),n;if(e===6)fy(t,r);else{if(s=t.current.alternate,!(r&30)&&!k$(s)&&(e=aS(t,r),e===2&&(u=J7(t),u!==0&&(r=u,e=Mk(t,u))),e===1))throw n=L5,R1(t,0),fy(t,r),ph(t,dl()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(pr(345));case 2:y1(t,ch,Pg);break;case 3:if(fy(t,r),(r&130023424)===r&&(e=tC+500-dl(),10<e)){if(GE(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){kc(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ok(y1.bind(null,t,ch,Pg),e);break}y1(t,ch,Pg);break;case 4:if(fy(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var p=31-ip(r);u=1<<p,p=e[p],p>s&&(s=p),r&=~u}if(r=s,r=dl()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*M$(r/1960))-r,10<r){t.timeoutHandle=ok(y1.bind(null,t,ch,Pg),r);break}y1(t,ch,Pg);break;case 5:y1(t,ch,Pg);break;default:throw Error(pr(329))}}}return ph(t,dl()),t.callbackNode===n?uO.bind(null,t):null}function Mk(t,e){var n=r5;return t.current.memoizedState.isDehydrated&&(R1(t,e).flags|=256),t=aS(t,e),t!==2&&(e=ch,ch=n,e!==null&&kk(e)),t}function kk(t){ch===null?ch=t:ch.push.apply(ch,t)}function k$(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],u=s.getSnapshot;s=s.value;try{if(!up(u(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fy(t,e){for(e&=~eC,e&=~tT,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ip(e),r=1<<n;t[n]=-1,e&=~r}}function fP(t){if($s&6)throw Error(pr(327));Kx();var e=GE(t,0);if(!(e&1))return ph(t,dl()),null;var n=aS(t,e);if(t.tag!==0&&n===2){var r=J7(t);r!==0&&(e=r,n=Mk(t,r))}if(n===1)throw n=L5,R1(t,0),fy(t,e),ph(t,dl()),n;if(n===6)throw Error(pr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,y1(t,ch,Pg),ph(t,dl()),null}function nC(t,e){var n=$s;$s|=1;try{return t(e)}finally{$s=n,$s===0&&(cb=dl()+500,KS&&Xy())}}function V1(t){gy!==null&&gy.tag===0&&!($s&6)&&Kx();var e=$s;$s|=1;var n=Zd.transition,r=So;try{if(Zd.transition=null,So=1,t)return t()}finally{So=r,Zd.transition=n,$s=e,!($s&6)&&Xy()}}function rC(){Hh=Gx.current,ua(Gx)}function R1(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,r$(n)),Al!==null)for(n=Al.return;n!==null;){var r=n;switch(F2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&XE();break;case 3:lb(),ua(dh),ua(oc),q2();break;case 5:W2(r);break;case 4:lb();break;case 13:ua(Ba);break;case 19:ua(Ba);break;case 10:j2(r.type._context);break;case 22:case 23:rC()}n=n.return}if(du=t,Al=t=ky(t.current,null),Ru=Hh=e,Yl=0,L5=null,eC=tT=j1=0,ch=r5=null,k1!==null){for(e=0;e<k1.length;e++)if(n=k1[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,u=n.pending;if(u!==null){var p=u.next;u.next=s,r.next=p}n.pending=r}k1=null}return t}function cO(t,e){do{var n=Al;try{if(U2(),yE.current=rS,nS){for(var r=Ha.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}nS=!1}if(U1=0,au=Zl=Ha=null,t5=!1,C5=0,Q2.current=null,n===null||n.return===null){Yl=1,L5=e,Al=null;break}e:{var u=t,p=n.return,g=n,l=e;if(e=Ru,g.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var E=l,P=g,O=P.tag;if(!(P.mode&1)&&(O===0||O===11||O===15)){var j=P.alternate;j?(P.updateQueue=j.updateQueue,P.memoizedState=j.memoizedState,P.lanes=j.lanes):(P.updateQueue=null,P.memoizedState=null)}var $=eP(p);if($!==null){$.flags&=-257,tP($,p,g,u,e),$.mode&1&&QL(u,E,e),e=$,l=E;var Y=e.updateQueue;if(Y===null){var re=new Set;re.add(l),e.updateQueue=re}else Y.add(l);break e}else{if(!(e&1)){QL(u,E,e),iC();break e}l=Error(pr(426))}}else if(Ta&&g.mode&1){var _e=eP(p);if(_e!==null){!(_e.flags&65536)&&(_e.flags|=256),tP(_e,p,g,u,e),z2(ub(l,g));break e}}u=l=ub(l,g),Yl!==4&&(Yl=2),r5===null?r5=[u]:r5.push(u),u=p;do{switch(u.tag){case 3:u.flags|=65536,e&=-e,u.lanes|=e;var J=$D(u,l,e);qL(u,J);break e;case 1:g=l;var H=u.type,te=u.stateNode;if(!(u.flags&128)&&(typeof H.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(Ty===null||!Ty.has(te)))){u.flags|=65536,e&=-e,u.lanes|=e;var ce=XD(u,g,e);qL(u,ce);break e}}u=u.return}while(u!==null)}fO(n)}catch(Se){e=Se,Al===n&&n!==null&&(Al=n=n.return);continue}break}while(!0)}function hO(){var t=iS.current;return iS.current=rS,t===null?rS:t}function iC(){(Yl===0||Yl===3||Yl===2)&&(Yl=4),du===null||!(j1&268435455)&&!(tT&268435455)||fy(du,Ru)}function aS(t,e){var n=$s;$s|=2;var r=hO();(du!==t||Ru!==e)&&(Pg=null,R1(t,e));do try{C$();break}catch(s){cO(t,s)}while(!0);if(U2(),$s=n,iS.current=r,Al!==null)throw Error(pr(261));return du=null,Ru=0,Yl}function C$(){for(;Al!==null;)dO(Al)}function I$(){for(;Al!==null&&!eq();)dO(Al)}function dO(t){var e=mO(t.alternate,t,Hh);t.memoizedProps=t.pendingProps,e===null?fO(t):Al=e,Q2.current=null}function fO(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=w$(n,e),n!==null){n.flags&=32767,Al=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yl=6,Al=null;return}}else if(n=b$(n,e,Hh),n!==null){Al=n;return}if(e=e.sibling,e!==null){Al=e;return}Al=e=t}while(e!==null);Yl===0&&(Yl=5)}function y1(t,e,n){var r=So,s=Zd.transition;try{Zd.transition=null,So=1,A$(t,e,n,r)}finally{Zd.transition=s,So=r}return null}function A$(t,e,n,r){do Kx();while(gy!==null);if($s&6)throw Error(pr(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(pr(177));t.callbackNode=null,t.callbackPriority=0;var u=n.lanes|n.childLanes;if(cq(t,u),t===du&&(Al=du=null,Ru=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||H4||(H4=!0,gO(VE,function(){return Kx(),null})),u=(n.flags&15990)!==0,n.subtreeFlags&15990||u){u=Zd.transition,Zd.transition=null;var p=So;So=1;var g=$s;$s|=4,Q2.current=null,S$(t,n),aO(n,t),Yq(ik),HE=!!rk,ik=rk=null,t.current=n,T$(n),tq(),$s=g,So=p,Zd.transition=u}else t.current=n;if(H4&&(H4=!1,gy=t,oS=s),u=t.pendingLanes,u===0&&(Ty=null),iq(n.stateNode),ph(t,dl()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(sS)throw sS=!1,t=Sk,Sk=null,t;return oS&1&&t.tag!==0&&Kx(),u=t.pendingLanes,u&1?t===Tk?i5++:(i5=0,Tk=t):i5=0,Xy(),null}function Kx(){if(gy!==null){var t=qN(oS),e=Zd.transition,n=So;try{if(Zd.transition=null,So=16>t?16:t,gy===null)var r=!1;else{if(t=gy,gy=null,oS=0,$s&6)throw Error(pr(331));var s=$s;for($s|=4,ti=t.current;ti!==null;){var u=ti,p=u.child;if(ti.flags&16){var g=u.deletions;if(g!==null){for(var l=0;l<g.length;l++){var E=g[l];for(ti=E;ti!==null;){var P=ti;switch(P.tag){case 0:case 11:case 15:n5(8,P,u)}var O=P.child;if(O!==null)O.return=P,ti=O;else for(;ti!==null;){P=ti;var j=P.sibling,$=P.return;if(iO(P),P===E){ti=null;break}if(j!==null){j.return=$,ti=j;break}ti=$}}}var Y=u.alternate;if(Y!==null){var re=Y.child;if(re!==null){Y.child=null;do{var _e=re.sibling;re.sibling=null,re=_e}while(re!==null)}}ti=u}}if(u.subtreeFlags&2064&&p!==null)p.return=u,ti=p;else e:for(;ti!==null;){if(u=ti,u.flags&2048)switch(u.tag){case 0:case 11:case 15:n5(9,u,u.return)}var J=u.sibling;if(J!==null){J.return=u.return,ti=J;break e}ti=u.return}}var H=t.current;for(ti=H;ti!==null;){p=ti;var te=p.child;if(p.subtreeFlags&2064&&te!==null)te.return=p,ti=te;else e:for(p=H;ti!==null;){if(g=ti,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:eT(9,g)}}catch(Se){el(g,g.return,Se)}if(g===p){ti=null;break e}var ce=g.sibling;if(ce!==null){ce.return=g.return,ti=ce;break e}ti=g.return}}if($s=s,Xy(),Mm&&typeof Mm.onPostCommitFiberRoot=="function")try{Mm.onPostCommitFiberRoot(qS,t)}catch{}r=!0}return r}finally{So=n,Zd.transition=e}}return!1}function pP(t,e,n){e=ub(n,e),e=$D(t,e,1),t=Sy(t,e,1),e=kc(),t!==null&&(u9(t,1,e),ph(t,e))}function el(t,e,n){if(t.tag===3)pP(t,t,n);else for(;e!==null;){if(e.tag===3){pP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ty===null||!Ty.has(r))){t=ub(n,t),t=XD(e,t,1),e=Sy(e,t,1),t=kc(),e!==null&&(u9(e,1,t),ph(e,t));break}}e=e.return}}function L$(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=kc(),t.pingedLanes|=t.suspendedLanes&n,du===t&&(Ru&n)===n&&(Yl===4||Yl===3&&(Ru&130023424)===Ru&&500>dl()-tC?R1(t,0):eC|=n),ph(t,e)}function pO(t,e){e===0&&(t.mode&1?(e=N4,N4<<=1,!(N4&130023424)&&(N4=4194304)):e=1);var n=kc();t=Hg(t,e),t!==null&&(u9(t,e,n),ph(t,n))}function P$(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),pO(t,n)}function R$(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(pr(314))}r!==null&&r.delete(e),pO(t,n)}var mO;mO=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dh.current)hh=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return hh=!1,x$(t,e,n);hh=!!(t.flags&131072)}else hh=!1,Ta&&e.flags&1048576&&_D(e,KE,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vE(t,e),t=e.pendingProps;var s=sb(e,oc.current);Yx(e,n),s=X2(null,e,r,t,s,n);var u=Z2();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fh(r)?(u=!0,ZE(e)):u=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,G2(e),s.updater=JS,e.stateNode=s,s._reactInternals=e,fk(e,r,t,n),e=gk(null,e,r,!0,u,n)):(e.tag=0,Ta&&u&&O2(e),wc(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vE(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=D$(r),t=Kf(r,t),s){case 0:e=mk(null,e,r,t,n);break e;case 1:e=iP(null,e,r,t,n);break e;case 11:e=nP(null,e,r,t,n);break e;case 14:e=rP(null,e,r,Kf(r.type,t),n);break e}throw Error(pr(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kf(r,s),mk(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kf(r,s),iP(t,e,r,s,n);case 3:e:{if(JD(e),t===null)throw Error(pr(387));r=e.pendingProps,u=e.memoizedState,s=u.element,wD(t,e),eS(e,r,null,n);var p=e.memoizedState;if(r=p.element,u.isDehydrated)if(u={element:r,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},e.updateQueue.baseState=u,e.memoizedState=u,e.flags&256){s=ub(Error(pr(423)),e),e=sP(t,e,r,n,s);break e}else if(r!==s){s=ub(Error(pr(424)),e),e=sP(t,e,r,n,s);break e}else for(Kh=Ey(e.stateNode.containerInfo.firstChild),Jh=e,Ta=!0,ep=null,n=MD(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ob(),r===s){e=Wg(t,e,n);break e}wc(t,e,r,n)}e=e.child}return e;case 5:return kD(e),t===null&&ck(e),r=e.type,s=e.pendingProps,u=t!==null?t.memoizedProps:null,p=s.children,sk(r,s)?p=null:u!==null&&sk(r,u)&&(e.flags|=32),KD(t,e),wc(t,e,p,n),e.child;case 6:return t===null&&ck(e),null;case 13:return QD(t,e,n);case 4:return H2(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ab(e,null,r,n):wc(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kf(r,s),nP(t,e,r,s,n);case 7:return wc(t,e,e.pendingProps,n),e.child;case 8:return wc(t,e,e.pendingProps.children,n),e.child;case 12:return wc(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,u=e.memoizedProps,p=s.value,Ko(JE,r._currentValue),r._currentValue=p,u!==null)if(up(u.value,p)){if(u.children===s.children&&!dh.current){e=Wg(t,e,n);break e}}else for(u=e.child,u!==null&&(u.return=e);u!==null;){var g=u.dependencies;if(g!==null){p=u.child;for(var l=g.firstContext;l!==null;){if(l.context===r){if(u.tag===1){l=zg(-1,n&-n),l.tag=2;var E=u.updateQueue;if(E!==null){E=E.shared;var P=E.pending;P===null?l.next=l:(l.next=P.next,P.next=l),E.pending=l}}u.lanes|=n,l=u.alternate,l!==null&&(l.lanes|=n),hk(u.return,n,e),g.lanes|=n;break}l=l.next}}else if(u.tag===10)p=u.type===e.type?null:u.child;else if(u.tag===18){if(p=u.return,p===null)throw Error(pr(341));p.lanes|=n,g=p.alternate,g!==null&&(g.lanes|=n),hk(p,n,e),p=u.sibling}else p=u.child;if(p!==null)p.return=u;else for(p=u;p!==null;){if(p===e){p=null;break}if(u=p.sibling,u!==null){u.return=p.return,p=u;break}p=p.return}u=p}wc(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Yx(e,n),s=Qd(s),r=r(s),e.flags|=1,wc(t,e,r,n),e.child;case 14:return r=e.type,s=Kf(r,e.pendingProps),s=Kf(r.type,s),rP(t,e,r,s,n);case 15:return ZD(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kf(r,s),vE(t,e),e.tag=1,fh(r)?(t=!0,ZE(e)):t=!1,Yx(e,n),SD(e,r,s),fk(e,r,s,n),gk(null,e,r,!0,t,n);case 19:return eO(t,e,n);case 22:return YD(t,e,n)}throw Error(pr(156,e.tag))};function gO(t,e){return VN(t,e)}function N$(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xd(t,e,n,r){return new N$(t,e,n,r)}function sC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function D$(t){if(typeof t=="function")return sC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===S2)return 11;if(t===T2)return 14}return 2}function ky(t,e){var n=t.alternate;return n===null?(n=Xd(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wE(t,e,n,r,s,u){var p=2;if(r=t,typeof t=="function")sC(t)&&(p=1);else if(typeof t=="string")p=5;else e:switch(t){case Rx:return N1(n.children,s,u,e);case E2:p=8,s|=8;break;case F7:return t=Xd(12,n,e,s|2),t.elementType=F7,t.lanes=u,t;case z7:return t=Xd(13,n,e,s),t.elementType=z7,t.lanes=u,t;case B7:return t=Xd(19,n,e,s),t.elementType=B7,t.lanes=u,t;case TN:return nT(n,s,u,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case EN:p=10;break e;case SN:p=9;break e;case S2:p=11;break e;case T2:p=14;break e;case cy:p=16,r=null;break e}throw Error(pr(130,t==null?t:typeof t,""))}return e=Xd(p,n,e,s),e.elementType=t,e.type=r,e.lanes=u,e}function N1(t,e,n,r){return t=Xd(7,t,r,e),t.lanes=n,t}function nT(t,e,n,r){return t=Xd(22,t,r,e),t.elementType=TN,t.lanes=n,t.stateNode={isHidden:!1},t}function W6(t,e,n){return t=Xd(6,t,null,e),t.lanes=n,t}function q6(t,e,n){return e=Xd(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function O$(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=M6(0),this.expirationTimes=M6(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=M6(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function oC(t,e,n,r,s,u,p,g,l){return t=new O$(t,e,n,g,l),e===1?(e=1,u===!0&&(e|=8)):e=0,u=Xd(3,null,null,e),t.current=u,u.stateNode=t,u.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},G2(u),t}function F$(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Px,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function yO(t){if(!t)return Ny;t=t._reactInternals;e:{if(ov(t)!==t||t.tag!==1)throw Error(pr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fh(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(pr(171))}if(t.tag===1){var n=t.type;if(fh(n))return gD(t,n,e)}return e}function _O(t,e,n,r,s,u,p,g,l){return t=oC(n,r,!0,t,s,u,p,g,l),t.context=yO(null),n=t.current,r=kc(),s=My(n),u=zg(r,s),u.callback=e??null,Sy(n,u,s),t.current.lanes=s,u9(t,s,r),ph(t,r),t}function rT(t,e,n,r){var s=e.current,u=kc(),p=My(s);return n=yO(n),e.context===null?e.context=n:e.pendingContext=n,e=zg(u,p),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Sy(s,e,p),t!==null&&(sp(t,s,p,u),gE(t,s,p)),p}function lS(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function mP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function aC(t,e){mP(t,e),(t=t.alternate)&&mP(t,e)}function z$(){return null}var vO=typeof reportError=="function"?reportError:function(t){console.error(t)};function lC(t){this._internalRoot=t}iT.prototype.render=lC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(pr(409));rT(t,e,null,null)};iT.prototype.unmount=lC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;V1(function(){rT(null,t,null,null)}),e[Gg]=null}};function iT(t){this._internalRoot=t}iT.prototype.unstable_scheduleHydration=function(t){if(t){var e=ZN();t={blockedOn:null,target:t,priority:e};for(var n=0;n<dy.length&&e!==0&&e<dy[n].priority;n++);dy.splice(n,0,t),n===0&&KN(t)}};function uC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function gP(){}function B$(t,e,n,r,s){if(s){if(typeof r=="function"){var u=r;r=function(){var E=lS(p);u.call(E)}}var p=_O(e,r,t,0,null,!1,!1,"",gP);return t._reactRootContainer=p,t[Gg]=p.current,E5(t.nodeType===8?t.parentNode:t),V1(),p}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var g=r;r=function(){var E=lS(l);g.call(E)}}var l=oC(t,0,!1,null,null,!1,!1,"",gP);return t._reactRootContainer=l,t[Gg]=l.current,E5(t.nodeType===8?t.parentNode:t),V1(function(){rT(e,l,n,r)}),l}function oT(t,e,n,r,s){var u=n._reactRootContainer;if(u){var p=u;if(typeof s=="function"){var g=s;s=function(){var l=lS(p);g.call(l)}}rT(e,p,t,s)}else p=B$(n,e,t,s,r);return lS(p)}$N=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Uw(e.pendingLanes);n!==0&&(C2(e,n|1),ph(e,dl()),!($s&6)&&(cb=dl()+500,Xy()))}break;case 13:V1(function(){var r=Hg(t,1);if(r!==null){var s=kc();sp(r,t,1,s)}}),aC(t,1)}};I2=function(t){if(t.tag===13){var e=Hg(t,134217728);if(e!==null){var n=kc();sp(e,t,134217728,n)}aC(t,134217728)}};XN=function(t){if(t.tag===13){var e=My(t),n=Hg(t,e);if(n!==null){var r=kc();sp(n,t,e,r)}aC(t,e)}};ZN=function(){return So};YN=function(t,e){var n=So;try{return So=t,e()}finally{So=n}};Z7=function(t,e,n){switch(e){case"input":if(V7(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=YS(r);if(!s)throw Error(pr(90));kN(r),V7(r,s)}}}break;case"textarea":IN(t,n);break;case"select":e=n.value,e!=null&&qx(t,!!n.multiple,e,!1)}};ON=nC;FN=V1;var U$={usingClientEntryPoint:!1,Events:[h9,Fx,YS,NN,DN,nC]},_w={findFiberByHostInstance:M1,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},j$={bundleType:_w.bundleType,version:_w.version,rendererPackageName:_w.rendererPackageName,rendererConfig:_w.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:s0.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=UN(t),t===null?null:t.stateNode},findFiberByHostInstance:_w.findFiberByHostInstance||z$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var W4=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!W4.isDisabled&&W4.supportsFiber)try{qS=W4.inject(j$),Mm=W4}catch{}}dd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U$;dd.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uC(e))throw Error(pr(200));return F$(t,e,null,n)};dd.createRoot=function(t,e){if(!uC(t))throw Error(pr(299));var n=!1,r="",s=vO;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=oC(t,1,!1,null,null,n,!1,r,s),t[Gg]=e.current,E5(t.nodeType===8?t.parentNode:t),new lC(e)};dd.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(pr(188)):(t=Object.keys(t).join(","),Error(pr(268,t)));return t=UN(e),t=t===null?null:t.stateNode,t};dd.flushSync=function(t){return V1(t)};dd.hydrate=function(t,e,n){if(!sT(e))throw Error(pr(200));return oT(null,t,e,!0,n)};dd.hydrateRoot=function(t,e,n){if(!uC(t))throw Error(pr(405));var r=n!=null&&n.hydratedSources||null,s=!1,u="",p=vO;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),e=_O(e,null,t,1,n??null,s,!1,u,p),t[Gg]=e.current,E5(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new iT(e)};dd.render=function(t,e,n){if(!sT(e))throw Error(pr(200));return oT(null,t,e,!1,n)};dd.unmountComponentAtNode=function(t){if(!sT(t))throw Error(pr(40));return t._reactRootContainer?(V1(function(){oT(null,null,t,!1,function(){t._reactRootContainer=null,t[Gg]=null})}),!0):!1};dd.unstable_batchedUpdates=nC;dd.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!sT(n))throw Error(pr(200));if(t==null||t._reactInternals===void 0)throw Error(pr(38));return oT(t,e,n,!1,r)};dd.version="18.2.0-next-9e3b772b8-20220608";function xO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xO)}catch(t){console.error(t)}}xO(),_N.exports=dd;var aT=_N.exports;const V$=HS(aT),G$=oN({__proto__:null,default:V$},[aT]);var yP=aT;D7.createRoot=yP.createRoot,D7.hydrateRoot=yP.hydrateRoot;var bO={exports:{}},wO={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hb=Lt;function H$(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var W$=typeof Object.is=="function"?Object.is:H$,q$=hb.useState,$$=hb.useEffect,X$=hb.useLayoutEffect,Z$=hb.useDebugValue;function Y$(t,e){var n=e(),r=q$({inst:{value:n,getSnapshot:e}}),s=r[0].inst,u=r[1];return X$(function(){s.value=n,s.getSnapshot=e,$6(s)&&u({inst:s})},[t,n,e]),$$(function(){return $6(s)&&u({inst:s}),t(function(){$6(s)&&u({inst:s})})},[t]),Z$(n),n}function $6(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!W$(t,n)}catch{return!0}}function K$(t,e){return e()}var J$=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?K$:Y$;wO.useSyncExternalStore=hb.useSyncExternalStore!==void 0?hb.useSyncExternalStore:J$;bO.exports=wO;var Q$=bO.exports,EO={exports:{}},SO={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lT=Lt,eX=Q$;function tX(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var nX=typeof Object.is=="function"?Object.is:tX,rX=eX.useSyncExternalStore,iX=lT.useRef,sX=lT.useEffect,oX=lT.useMemo,aX=lT.useDebugValue;SO.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var u=iX(null);if(u.current===null){var p={hasValue:!1,value:null};u.current=p}else p=u.current;u=oX(function(){function l($){if(!E){if(E=!0,P=$,$=r($),s!==void 0&&p.hasValue){var Y=p.value;if(s(Y,$))return O=Y}return O=$}if(Y=O,nX(P,$))return Y;var re=r($);return s!==void 0&&s(Y,re)?Y:(P=$,O=re)}var E=!1,P,O,j=n===void 0?null:n;return[function(){return l(e())},j===null?void 0:function(){return l(j())}]},[e,n,r,s]);var g=rX(t,u[0],u[1]);return sX(function(){p.hasValue=!0,p.value=g},[g]),aX(g),g};EO.exports=SO;var lX=EO.exports;function uX(t){t()}let TO=uX;const cX=t=>TO=t,hX=()=>TO,_P=Symbol.for("react-redux-context"),vP=typeof globalThis<"u"?globalThis:{};function dX(){var t;if(!Lt.createContext)return{};const e=(t=vP[_P])!=null?t:vP[_P]=new Map;let n=e.get(Lt.createContext);return n||(n=Lt.createContext(null),e.set(Lt.createContext,n)),n}const uS=dX();function MO(t=uS){return function(){return Lt.useContext(t)}}const fX=MO(),pX=()=>{throw new Error("uSES not initialized!")};let kO=pX;const mX=t=>{kO=t},gX=(t,e)=>t===e;function yX(t=uS){const e=t===uS?fX:MO(t);return function(r,s={}){const{equalityFn:u=gX,stabilityCheck:p=void 0,noopCheck:g=void 0}=typeof s=="function"?{equalityFn:s}:s,{store:l,subscription:E,getServerState:P,stabilityCheck:O,noopCheck:j}=e();Lt.useRef(!0);const $=Lt.useCallback({[r.name](re){return r(re)}}[r.name],[r,O,p]),Y=kO(E.addNestedSub,l.getState,P||l.getState,$,u);return Lt.useDebugValue(Y),Y}}const CO=yX();var IO={exports:{}},Mo={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _u=typeof Symbol=="function"&&Symbol.for,cC=_u?Symbol.for("react.element"):60103,hC=_u?Symbol.for("react.portal"):60106,uT=_u?Symbol.for("react.fragment"):60107,cT=_u?Symbol.for("react.strict_mode"):60108,hT=_u?Symbol.for("react.profiler"):60114,dT=_u?Symbol.for("react.provider"):60109,fT=_u?Symbol.for("react.context"):60110,dC=_u?Symbol.for("react.async_mode"):60111,pT=_u?Symbol.for("react.concurrent_mode"):60111,mT=_u?Symbol.for("react.forward_ref"):60112,gT=_u?Symbol.for("react.suspense"):60113,_X=_u?Symbol.for("react.suspense_list"):60120,yT=_u?Symbol.for("react.memo"):60115,_T=_u?Symbol.for("react.lazy"):60116,vX=_u?Symbol.for("react.block"):60121,xX=_u?Symbol.for("react.fundamental"):60117,bX=_u?Symbol.for("react.responder"):60118,wX=_u?Symbol.for("react.scope"):60119;function pd(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case cC:switch(t=t.type,t){case dC:case pT:case uT:case hT:case cT:case gT:return t;default:switch(t=t&&t.$$typeof,t){case fT:case mT:case _T:case yT:case dT:return t;default:return e}}case hC:return e}}}function AO(t){return pd(t)===pT}Mo.AsyncMode=dC;Mo.ConcurrentMode=pT;Mo.ContextConsumer=fT;Mo.ContextProvider=dT;Mo.Element=cC;Mo.ForwardRef=mT;Mo.Fragment=uT;Mo.Lazy=_T;Mo.Memo=yT;Mo.Portal=hC;Mo.Profiler=hT;Mo.StrictMode=cT;Mo.Suspense=gT;Mo.isAsyncMode=function(t){return AO(t)||pd(t)===dC};Mo.isConcurrentMode=AO;Mo.isContextConsumer=function(t){return pd(t)===fT};Mo.isContextProvider=function(t){return pd(t)===dT};Mo.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===cC};Mo.isForwardRef=function(t){return pd(t)===mT};Mo.isFragment=function(t){return pd(t)===uT};Mo.isLazy=function(t){return pd(t)===_T};Mo.isMemo=function(t){return pd(t)===yT};Mo.isPortal=function(t){return pd(t)===hC};Mo.isProfiler=function(t){return pd(t)===hT};Mo.isStrictMode=function(t){return pd(t)===cT};Mo.isSuspense=function(t){return pd(t)===gT};Mo.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===uT||t===pT||t===hT||t===cT||t===gT||t===_X||typeof t=="object"&&t!==null&&(t.$$typeof===_T||t.$$typeof===yT||t.$$typeof===dT||t.$$typeof===fT||t.$$typeof===mT||t.$$typeof===xX||t.$$typeof===bX||t.$$typeof===wX||t.$$typeof===vX)};Mo.typeOf=pd;IO.exports=Mo;var EX=IO.exports,LO=EX,SX={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},TX={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},PO={};PO[LO.ForwardRef]=SX;PO[LO.Memo]=TX;var Ro={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fC=Symbol.for("react.element"),pC=Symbol.for("react.portal"),vT=Symbol.for("react.fragment"),xT=Symbol.for("react.strict_mode"),bT=Symbol.for("react.profiler"),wT=Symbol.for("react.provider"),ET=Symbol.for("react.context"),MX=Symbol.for("react.server_context"),ST=Symbol.for("react.forward_ref"),TT=Symbol.for("react.suspense"),MT=Symbol.for("react.suspense_list"),kT=Symbol.for("react.memo"),CT=Symbol.for("react.lazy"),kX=Symbol.for("react.offscreen"),RO;RO=Symbol.for("react.module.reference");function df(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case fC:switch(t=t.type,t){case vT:case bT:case xT:case TT:case MT:return t;default:switch(t=t&&t.$$typeof,t){case MX:case ET:case ST:case CT:case kT:case wT:return t;default:return e}}case pC:return e}}}Ro.ContextConsumer=ET;Ro.ContextProvider=wT;Ro.Element=fC;Ro.ForwardRef=ST;Ro.Fragment=vT;Ro.Lazy=CT;Ro.Memo=kT;Ro.Portal=pC;Ro.Profiler=bT;Ro.StrictMode=xT;Ro.Suspense=TT;Ro.SuspenseList=MT;Ro.isAsyncMode=function(){return!1};Ro.isConcurrentMode=function(){return!1};Ro.isContextConsumer=function(t){return df(t)===ET};Ro.isContextProvider=function(t){return df(t)===wT};Ro.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===fC};Ro.isForwardRef=function(t){return df(t)===ST};Ro.isFragment=function(t){return df(t)===vT};Ro.isLazy=function(t){return df(t)===CT};Ro.isMemo=function(t){return df(t)===kT};Ro.isPortal=function(t){return df(t)===pC};Ro.isProfiler=function(t){return df(t)===bT};Ro.isStrictMode=function(t){return df(t)===xT};Ro.isSuspense=function(t){return df(t)===TT};Ro.isSuspenseList=function(t){return df(t)===MT};Ro.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===vT||t===bT||t===xT||t===TT||t===MT||t===kX||typeof t=="object"&&t!==null&&(t.$$typeof===CT||t.$$typeof===kT||t.$$typeof===wT||t.$$typeof===ET||t.$$typeof===ST||t.$$typeof===RO||t.getModuleId!==void 0)};Ro.typeOf=df;function CX(){const t=hX();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0,u=n={callback:r,next:null,prev:n};return u.prev?u.prev.next=u:e=u,function(){!s||e===null||(s=!1,u.next?u.next.prev=u.prev:n=u.prev,u.prev?u.prev.next=u.next:e=u.next)}}}}const xP={notify(){},get:()=>[]};function IX(t,e){let n,r=xP,s=0,u=!1;function p(re){P();const _e=r.subscribe(re);let J=!1;return()=>{J||(J=!0,_e(),O())}}function g(){r.notify()}function l(){Y.onStateChange&&Y.onStateChange()}function E(){return u}function P(){s++,n||(n=e?e.addNestedSub(l):t.subscribe(l),r=CX())}function O(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=xP)}function j(){u||(u=!0,P())}function $(){u&&(u=!1,O())}const Y={addNestedSub:p,notifyNestedSubs:g,handleChangeWrapper:l,isSubscribed:E,trySubscribe:j,tryUnsubscribe:$,getListeners:()=>r};return Y}const AX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LX=AX?Lt.useLayoutEffect:Lt.useEffect;function PX({store:t,context:e,children:n,serverState:r,stabilityCheck:s="once",noopCheck:u="once"}){const p=Lt.useMemo(()=>{const E=IX(t);return{store:t,subscription:E,getServerState:r?()=>r:void 0,stabilityCheck:s,noopCheck:u}},[t,r,s,u]),g=Lt.useMemo(()=>t.getState(),[t]);LX(()=>{const{subscription:E}=p;return E.onStateChange=E.notifyNestedSubs,E.trySubscribe(),g!==t.getState()&&E.notifyNestedSubs(),()=>{E.tryUnsubscribe(),E.onStateChange=void 0}},[p,g]);const l=e||uS;return Lt.createElement(l.Provider,{value:p},n)}mX(lX.useSyncExternalStoreWithSelector);cX(aT.unstable_batchedUpdates);/**
 * @remix-run/router v1.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sa(){return Sa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sa.apply(this,arguments)}var $o;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})($o||($o={}));const bP="popstate";function NO(t){t===void 0&&(t={});let{initialEntries:e=["/"],initialIndex:n,v5Compat:r=!1}=t,s;s=e.map(($,Y)=>P($,typeof $=="string"?null:$.state,Y===0?"default":void 0));let u=l(n??s.length-1),p=$o.Pop,g=null;function l($){return Math.min(Math.max($,0),s.length-1)}function E(){return s[u]}function P($,Y,re){Y===void 0&&(Y=null);let _e=G1(s?E().pathname:"/",$,Y,re);return Rm(_e.pathname.charAt(0)==="/","relative pathnames are not supported in memory history: "+JSON.stringify($)),_e}function O($){return typeof $=="string"?$:cp($)}return{get index(){return u},get action(){return p},get location(){return E()},createHref:O,createURL($){return new URL(O($),"http://localhost")},encodeLocation($){let Y=typeof $=="string"?ff($):$;return{pathname:Y.pathname||"",search:Y.search||"",hash:Y.hash||""}},push($,Y){p=$o.Push;let re=P($,Y);u+=1,s.splice(u,s.length,re),r&&g&&g({action:p,location:re,delta:1})},replace($,Y){p=$o.Replace;let re=P($,Y);s[u]=re,r&&g&&g({action:p,location:re,delta:0})},go($){p=$o.Pop;let Y=l(u+$),re=s[Y];u=Y,g&&g({action:p,location:re,delta:$})},listen($){return g=$,()=>{g=null}}}}function DO(t){t===void 0&&(t={});function e(r,s){let{pathname:u,search:p,hash:g}=r.location;return G1("",{pathname:u,search:p,hash:g},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:cp(s)}return FO(e,n,null,t)}function OO(t){t===void 0&&(t={});function e(s,u){let{pathname:p="/",search:g="",hash:l=""}=ff(s.location.hash.substr(1));return!p.startsWith("/")&&!p.startsWith(".")&&(p="/"+p),G1("",{pathname:p,search:g,hash:l},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function n(s,u){let p=s.document.querySelector("base"),g="";if(p&&p.getAttribute("href")){let l=s.location.href,E=l.indexOf("#");g=E===-1?l:l.slice(0,E)}return g+"#"+(typeof u=="string"?u:cp(u))}function r(s,u){Rm(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(u)+")")}return FO(e,n,r,t)}function Ti(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Rm(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function RX(){return Math.random().toString(36).substr(2,8)}function wP(t,e){return{usr:t.state,key:t.key,idx:e}}function G1(t,e,n,r){return n===void 0&&(n=null),Sa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ff(e):e,{state:n,key:e&&e.key||r||RX()})}function cp(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ff(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function FO(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:u=!1}=r,p=s.history,g=$o.Pop,l=null,E=P();E==null&&(E=0,p.replaceState(Sa({},p.state,{idx:E}),""));function P(){return(p.state||{idx:null}).idx}function O(){g=$o.Pop;let _e=P(),J=_e==null?null:_e-E;E=_e,l&&l({action:g,location:re.location,delta:J})}function j(_e,J){g=$o.Push;let H=G1(re.location,_e,J);n&&n(H,_e),E=P()+1;let te=wP(H,E),ce=re.createHref(H);try{p.pushState(te,"",ce)}catch(Se){if(Se instanceof DOMException&&Se.name==="DataCloneError")throw Se;s.location.assign(ce)}u&&l&&l({action:g,location:re.location,delta:1})}function $(_e,J){g=$o.Replace;let H=G1(re.location,_e,J);n&&n(H,_e),E=P();let te=wP(H,E),ce=re.createHref(H);p.replaceState(te,"",ce),u&&l&&l({action:g,location:re.location,delta:0})}function Y(_e){let J=s.location.origin!=="null"?s.location.origin:s.location.href,H=typeof _e=="string"?_e:cp(_e);return Ti(J,"No window.location.(origin|href) available to create URL for href: "+H),new URL(H,J)}let re={get action(){return g},get location(){return t(s,p)},listen(_e){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(bP,O),l=_e,()=>{s.removeEventListener(bP,O),l=null}},createHref(_e){return e(s,_e)},createURL:Y,encodeLocation(_e){let J=Y(_e);return{pathname:J.pathname,search:J.search,hash:J.hash}},push:j,replace:$,go(_e){return p.go(_e)}};return re}var hl;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(hl||(hl={}));const NX=new Set(["lazy","caseSensitive","path","id","index","children"]);function DX(t){return t.index===!0}function Ck(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,u)=>{let p=[...n,u],g=typeof s.id=="string"?s.id:p.join("-");if(Ti(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ti(!r[g],'Found a route id collision on id "'+g+`".  Route id's must be globally unique within Data Router usages`),DX(s)){let l=Sa({},s,e(s),{id:g});return r[g]=l,l}else{let l=Sa({},s,e(s),{id:g,children:void 0});return r[g]=l,s.children&&(l.children=Ck(s.children,e,p,r)),l}})}function I1(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?ff(e):e,s=nd(r.pathname||"/",n);if(s==null)return null;let u=BO(t);OX(u);let p=null;for(let g=0;p==null&&g<u.length;++g)p=WX(u[g],XX(s));return p}function zO(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function BO(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(u,p,g)=>{let l={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:p,route:u};l.relativePath.startsWith("/")&&(Ti(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let E=Cm([r,l.relativePath]),P=n.concat(l);u.children&&u.children.length>0&&(Ti(u.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+E+'".')),BO(u.children,e,P,E)),!(u.path==null&&!u.index)&&e.push({path:E,score:GX(E,u.index),routesMeta:P})};return t.forEach((u,p)=>{var g;if(u.path===""||!((g=u.path)!=null&&g.includes("?")))s(u,p);else for(let l of UO(u.path))s(u,p,l)}),e}function UO(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),u=n.replace(/\?$/,"");if(r.length===0)return s?[u,""]:[u];let p=UO(r.join("/")),g=[];return g.push(...p.map(l=>l===""?u:[u,l].join("/"))),s&&g.push(...p),g.map(l=>t.startsWith("/")&&l===""?"/":l)}function OX(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:HX(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const FX=/^:\w+$/,zX=3,BX=2,UX=1,jX=10,VX=-2,EP=t=>t==="*";function GX(t,e){let n=t.split("/"),r=n.length;return n.some(EP)&&(r+=VX),e&&(r+=BX),n.filter(s=>!EP(s)).reduce((s,u)=>s+(FX.test(u)?zX:u===""?UX:jX),r)}function HX(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function WX(t,e){let{routesMeta:n}=t,r={},s="/",u=[];for(let p=0;p<n.length;++p){let g=n[p],l=p===n.length-1,E=s==="/"?e:e.slice(s.length)||"/",P=P5({path:g.relativePath,caseSensitive:g.caseSensitive,end:l},E);if(!P)return null;Object.assign(r,P.params);let O=g.route;u.push({params:r,pathname:Cm([s,P.pathname]),pathnameBase:KX(Cm([s,P.pathnameBase])),route:O}),P.pathnameBase!=="/"&&(s=Cm([s,P.pathnameBase]))}return u}function qX(t,e){e===void 0&&(e={});let n=t;n.endsWith("*")&&n!=="*"&&!n.endsWith("/*")&&(Rm(!1,'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".')),n=n.replace(/\*$/,"/*"));const r=n.startsWith("/")?"/":"",s=p=>p==null?"":typeof p=="string"?p:String(p),u=n.split(/\/+/).map((p,g,l)=>{if(g===l.length-1&&p==="*")return s(e["*"]);const P=p.match(/^:(\w+)(\??)$/);if(P){const[,O,j]=P;let $=e[O];return Ti(j==="?"||$!=null,'Missing ":'+O+'" param'),s($)}return p.replace(/\?$/g,"")}).filter(p=>!!p);return r+u.join("/")}function P5(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=$X(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let u=s[0],p=u.replace(/(.)\/+$/,"$1"),g=s.slice(1);return{params:r.reduce((E,P,O)=>{let{paramName:j,isOptional:$}=P;if(j==="*"){let re=g[O]||"";p=u.slice(0,u.length-re.length).replace(/(.)\/+$/,"$1")}const Y=g[O];return $&&!Y?E[j]=void 0:E[j]=ZX(Y||"",j),E},{}),pathname:u,pathnameBase:p,pattern:t}}function $X(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Rm(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(p,g,l)=>(r.push({paramName:g,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function XX(t){try{return decodeURI(t)}catch(e){return Rm(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ZX(t,e){try{return decodeURIComponent(t)}catch(n){return Rm(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function nd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function jO(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ff(t):t;return{pathname:n?n.startsWith("/")?n:YX(n,e):e,search:JX(r),hash:QX(s)}}function YX(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function X6(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function VO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function IT(t){return VO(t).map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function AT(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=ff(t):(s=Sa({},t),Ti(!s.pathname||!s.pathname.includes("?"),X6("?","pathname","search",s)),Ti(!s.pathname||!s.pathname.includes("#"),X6("#","pathname","hash",s)),Ti(!s.search||!s.search.includes("#"),X6("#","search","hash",s)));let u=t===""||s.pathname==="",p=u?"/":s.pathname,g;if(p==null)g=n;else if(r){let O=e[e.length-1].replace(/^\//,"").split("/");if(p.startsWith("..")){let j=p.split("/");for(;j[0]==="..";)j.shift(),O.pop();s.pathname=j.join("/")}g="/"+O.join("/")}else{let O=e.length-1;if(p.startsWith("..")){let j=p.split("/");for(;j[0]==="..";)j.shift(),O-=1;s.pathname=j.join("/")}g=O>=0?e[O]:"/"}let l=jO(s,g),E=p&&p!=="/"&&p.endsWith("/"),P=(u||p===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(E||P)&&(l.pathname+="/"),l}const Cm=t=>t.join("/").replace(/\/\/+/g,"/"),KX=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),JX=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,QX=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,eZ=function(e,n){n===void 0&&(n={});let r=typeof n=="number"?{status:n}:n,s=new Headers(r.headers);return s.has("Content-Type")||s.set("Content-Type","application/json; charset=utf-8"),new Response(JSON.stringify(e),Sa({},r,{headers:s}))};class cS extends Error{}class tZ{constructor(e,n){this.pendingKeysSet=new Set,this.subscribers=new Set,this.deferredKeys=[],Ti(e&&typeof e=="object"&&!Array.isArray(e),"defer() only accepts plain objects");let r;this.abortPromise=new Promise((u,p)=>r=p),this.controller=new AbortController;let s=()=>r(new cS("Deferred data aborted"));this.unlistenAbortSignal=()=>this.controller.signal.removeEventListener("abort",s),this.controller.signal.addEventListener("abort",s),this.data=Object.entries(e).reduce((u,p)=>{let[g,l]=p;return Object.assign(u,{[g]:this.trackPromise(g,l)})},{}),this.done&&this.unlistenAbortSignal(),this.init=n}trackPromise(e,n){if(!(n instanceof Promise))return n;this.deferredKeys.push(e),this.pendingKeysSet.add(e);let r=Promise.race([n,this.abortPromise]).then(s=>this.onSettle(r,e,void 0,s),s=>this.onSettle(r,e,s));return r.catch(()=>{}),Object.defineProperty(r,"_tracked",{get:()=>!0}),r}onSettle(e,n,r,s){if(this.controller.signal.aborted&&r instanceof cS)return this.unlistenAbortSignal(),Object.defineProperty(e,"_error",{get:()=>r}),Promise.reject(r);if(this.pendingKeysSet.delete(n),this.done&&this.unlistenAbortSignal(),r===void 0&&s===void 0){let u=new Error('Deferred data for key "'+n+'" resolved/rejected with `undefined`, you must resolve/reject with a value or `null`.');return Object.defineProperty(e,"_error",{get:()=>u}),this.emit(!1,n),Promise.reject(u)}return s===void 0?(Object.defineProperty(e,"_error",{get:()=>r}),this.emit(!1,n),Promise.reject(r)):(Object.defineProperty(e,"_data",{get:()=>s}),this.emit(!1,n),s)}emit(e,n){this.subscribers.forEach(r=>r(e,n))}subscribe(e){return this.subscribers.add(e),()=>this.subscribers.delete(e)}cancel(){this.controller.abort(),this.pendingKeysSet.forEach((e,n)=>this.pendingKeysSet.delete(n)),this.emit(!0)}async resolveData(e){let n=!1;if(!this.done){let r=()=>this.cancel();e.addEventListener("abort",r),n=await new Promise(s=>{this.subscribe(u=>{e.removeEventListener("abort",r),(u||this.done)&&s(u)})})}return n}get done(){return this.pendingKeysSet.size===0}get unwrappedData(){return Ti(this.data!==null&&this.done,"Can only unwrap data on initialized and settled deferreds"),Object.entries(this.data).reduce((e,n)=>{let[r,s]=n;return Object.assign(e,{[r]:rZ(s)})},{})}get pendingKeys(){return Array.from(this.pendingKeysSet)}}function nZ(t){return t instanceof Promise&&t._tracked===!0}function rZ(t){if(!nZ(t))return t;if(t._error)throw t._error;return t._data}const iZ=function(e,n){n===void 0&&(n={});let r=typeof n=="number"?{status:n}:n;return new tZ(e,r)},mC=function(e,n){n===void 0&&(n=302);let r=n;typeof r=="number"?r={status:r}:typeof r.status>"u"&&(r.status=302);let s=new Headers(r.headers);return s.set("Location",e),new Response(null,Sa({},r,{headers:s}))},sZ=(t,e)=>{let n=mC(t,e);return n.headers.set("X-Remix-Reload-Document","true"),n};class gC{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function yC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const GO=["post","put","patch","delete"],oZ=new Set(GO),aZ=["get",...GO],lZ=new Set(aZ),uZ=new Set([301,302,303,307,308]),cZ=new Set([307,308]),Z6={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},HO={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Ax={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},WO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hZ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),qO="remix-router-transitions";function _C(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Ti(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let se=t.detectErrorBoundary;s=le=>({hasErrorBoundary:se(le)})}else s=hZ;let u={},p=Ck(t.routes,s,void 0,u),g,l=t.basename||"/",E=Sa({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},t.future),P=null,O=new Set,j=null,$=null,Y=null,re=t.hydrationData!=null,_e=I1(p,t.history.location,l),J=null;if(_e==null){let se=Vd(404,{pathname:t.history.location.pathname}),{matches:le,route:Ae}=LP(p);_e=le,J={[Ae.id]:se}}let H=!_e.some(se=>se.route.lazy)&&(!_e.some(se=>se.route.loader)||t.hydrationData!=null),te,ce={historyAction:t.history.action,location:t.history.location,matches:_e,initialized:H,navigation:Z6,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||J,fetchers:new Map,blockers:new Map},Se=$o.Pop,Ie=!1,Ne,ut=!1,mt=new Map,We=null,Ot=!1,st=!1,qe=[],et=[],Q=new Map,ye=0,ge=-1,xe=new Map,Ce=new Set,tt=new Map,Je=new Map,rt=new Set,Ut=new Map,ht=new Map,Ft=!1;function Nn(){if(P=t.history.listen(se=>{let{action:le,location:Ae,delta:Fe}=se;if(Ft){Ft=!1;return}Rm(ht.size===0||Fe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let nt=$i({currentLocation:ce.location,nextLocation:Ae,historyAction:le});if(nt&&Fe!=null){Ft=!0,t.history.go(Fe*-1),is(nt,{state:"blocked",location:Ae,proceed(){is(nt,{state:"proceeding",proceed:void 0,reset:void 0,location:Ae}),t.history.go(Fe)},reset(){let kt=new Map(ce.blockers);kt.set(nt,Ax),Gr({blockers:kt})}});return}return fi(le,Ae)}),n){wZ(e,mt);let se=()=>EZ(e,mt);e.addEventListener("pagehide",se),We=()=>e.removeEventListener("pagehide",se)}return ce.initialized||fi($o.Pop,ce.location),te}function zn(){P&&P(),We&&We(),O.clear(),Ne&&Ne.abort(),ce.fetchers.forEach((se,le)=>On(le)),ce.blockers.forEach((se,le)=>Zr(le))}function rr(se){return O.add(se),()=>O.delete(se)}function Gr(se,le){le===void 0&&(le={}),ce=Sa({},ce,se);let Ae=[],Fe=[];E.v7_fetcherPersist&&ce.fetchers.forEach((nt,kt)=>{nt.state==="idle"&&(rt.has(kt)?Fe.push(kt):Ae.push(kt))}),[...O].forEach(nt=>nt(ce,{deletedFetchers:Fe,unstable_viewTransitionOpts:le.viewTransitionOpts,unstable_flushSync:le.flushSync===!0})),E.v7_fetcherPersist&&(Ae.forEach(nt=>ce.fetchers.delete(nt)),Fe.forEach(nt=>On(nt)))}function Li(se,le,Ae){var Fe,nt;let{flushSync:kt}=Ae===void 0?{}:Ae,Tt=ce.actionData!=null&&ce.navigation.formMethod!=null&&Qf(ce.navigation.formMethod)&&ce.navigation.state==="loading"&&((Fe=se.state)==null?void 0:Fe._isRedirect)!==!0,at;le.actionData?Object.keys(le.actionData).length>0?at=le.actionData:at=null:Tt?at=ce.actionData:at=null;let me=le.loaderData?AP(ce.loaderData,le.loaderData,le.matches||[],le.errors):ce.loaderData,fn=ce.blockers;fn.size>0&&(fn=new Map(fn),fn.forEach((mr,Cr)=>fn.set(Cr,Ax)));let Mn=Ie===!0||ce.navigation.formMethod!=null&&Qf(ce.navigation.formMethod)&&((nt=se.state)==null?void 0:nt._isRedirect)!==!0;g&&(p=g,g=void 0),Ot||Se===$o.Pop||(Se===$o.Push?t.history.push(se,se.state):Se===$o.Replace&&t.history.replace(se,se.state));let Jt;if(Se===$o.Pop){let mr=mt.get(ce.location.pathname);mr&&mr.has(se.pathname)?Jt={currentLocation:ce.location,nextLocation:se}:mt.has(se.pathname)&&(Jt={currentLocation:se,nextLocation:ce.location})}else if(ut){let mr=mt.get(ce.location.pathname);mr?mr.add(se.pathname):(mr=new Set([se.pathname]),mt.set(ce.location.pathname,mr)),Jt={currentLocation:ce.location,nextLocation:se}}Gr(Sa({},le,{actionData:at,loaderData:me,historyAction:Se,location:se,initialized:!0,navigation:Z6,revalidation:"idle",restoreScrollPosition:Ps(se,le.matches||ce.matches),preventScrollReset:Mn,blockers:fn}),{viewTransitionOpts:Jt,flushSync:kt===!0}),Se=$o.Pop,Ie=!1,ut=!1,Ot=!1,st=!1,qe=[],et=[]}async function wi(se,le){if(typeof se=="number"){t.history.go(se);return}let Ae=Ik(ce.location,ce.matches,l,E.v7_prependBasename,se,le==null?void 0:le.fromRouteId,le==null?void 0:le.relative),{path:Fe,submission:nt,error:kt}=SP(E.v7_normalizeFormMethod,!1,Ae,le),Tt=ce.location,at=G1(ce.location,Fe,le&&le.state);at=Sa({},at,t.history.encodeLocation(at));let me=le&&le.replace!=null?le.replace:void 0,fn=$o.Push;me===!0?fn=$o.Replace:me===!1||nt!=null&&Qf(nt.formMethod)&&nt.formAction===ce.location.pathname+ce.location.search&&(fn=$o.Replace);let Mn=le&&"preventScrollReset"in le?le.preventScrollReset===!0:void 0,Jt=(le&&le.unstable_flushSync)===!0,mr=$i({currentLocation:Tt,nextLocation:at,historyAction:fn});if(mr){is(mr,{state:"blocked",location:at,proceed(){is(mr,{state:"proceeding",proceed:void 0,reset:void 0,location:at}),wi(se,le)},reset(){let Cr=new Map(ce.blockers);Cr.set(mr,Ax),Gr({blockers:Cr})}});return}return await fi(fn,at,{submission:nt,pendingError:kt,preventScrollReset:Mn,replace:le&&le.replace,enableViewTransition:le&&le.unstable_viewTransition,flushSync:Jt})}function Nr(){if(St(),Gr({revalidation:"loading"}),ce.navigation.state!=="submitting"){if(ce.navigation.state==="idle"){fi(ce.historyAction,ce.location,{startUninterruptedRevalidation:!0});return}fi(Se||ce.historyAction,ce.navigation.location,{overrideNavigation:ce.navigation})}}async function fi(se,le,Ae){Ne&&Ne.abort(),Ne=null,Se=se,Ot=(Ae&&Ae.startUninterruptedRevalidation)===!0,Di(ce.location,ce.matches),Ie=(Ae&&Ae.preventScrollReset)===!0,ut=(Ae&&Ae.enableViewTransition)===!0;let Fe=g||p,nt=Ae&&Ae.overrideNavigation,kt=I1(Fe,le,l),Tt=(Ae&&Ae.flushSync)===!0;if(!kt){let Cr=Vd(404,{pathname:le.pathname}),{matches:zr,route:Kr}=LP(Fe);Xs(),Li(le,{matches:zr,loaderData:{},errors:{[Kr.id]:Cr}},{flushSync:Tt});return}if(ce.initialized&&!st&&gZ(ce.location,le)&&!(Ae&&Ae.submission&&Qf(Ae.submission.formMethod))){Li(le,{matches:kt},{flushSync:Tt});return}Ne=new AbortController;let at=xw(t.history,le,Ne.signal,Ae&&Ae.submission),me,fn;if(Ae&&Ae.pendingError)fn={[s5(kt).route.id]:Ae.pendingError};else if(Ae&&Ae.submission&&Qf(Ae.submission.formMethod)){let Cr=await Mi(at,le,Ae.submission,kt,{replace:Ae.replace,flushSync:Tt});if(Cr.shortCircuited)return;me=Cr.pendingActionData,fn=Cr.pendingActionError,nt=Y6(le,Ae.submission),Tt=!1,at=new Request(at.url,{signal:at.signal})}let{shortCircuited:Mn,loaderData:Jt,errors:mr}=await jn(at,le,kt,nt,Ae&&Ae.submission,Ae&&Ae.fetcherSubmission,Ae&&Ae.replace,Tt,me,fn);Mn||(Ne=null,Li(le,Sa({matches:kt},me?{actionData:me}:{},{loaderData:Jt,errors:mr})))}async function Mi(se,le,Ae,Fe,nt){nt===void 0&&(nt={}),St();let kt=xZ(le,Ae);Gr({navigation:kt},{flushSync:nt.flushSync===!0});let Tt,at=Lk(Fe,le);if(!at.route.action&&!at.route.lazy)Tt={type:hl.error,error:Vd(405,{method:se.method,pathname:le.pathname,routeId:at.route.id})};else if(Tt=await vw("action",se,at,Fe,u,s,l),se.signal.aborted)return{shortCircuited:!0};if(Jx(Tt)){let me;return nt&&nt.replace!=null?me=nt.replace:me=Tt.location===ce.location.pathname+ce.location.search,await Qe(ce,Tt,{submission:Ae,replace:me}),{shortCircuited:!0}}if(o5(Tt)){let me=s5(Fe,at.route.id);return(nt&&nt.replace)!==!0&&(Se=$o.Push),{pendingActionData:{},pendingActionError:{[me.route.id]:Tt.error}}}if(A1(Tt))throw Vd(400,{type:"defer-action"});return{pendingActionData:{[at.route.id]:Tt.data}}}async function jn(se,le,Ae,Fe,nt,kt,Tt,at,me,fn){let Mn=Fe||Y6(le,nt),Jt=nt||kt||NP(Mn),mr=g||p,[Cr,zr]=TP(t.history,ce,Ae,Jt,le,st,qe,et,rt,tt,Ce,mr,l,me,fn);if(Xs(xs=>!(Ae&&Ae.some(ea=>ea.route.id===xs))||Cr&&Cr.some(ea=>ea.route.id===xs)),ge=++ye,Cr.length===0&&zr.length===0){let xs=Dr();return Li(le,Sa({matches:Ae,loaderData:{},errors:fn||null},me?{actionData:me}:{},xs?{fetchers:new Map(ce.fetchers)}:{}),{flushSync:at}),{shortCircuited:!0}}if(!Ot){zr.forEach(ea=>{let ri=ce.fetchers.get(ea.key),Ia=bw(void 0,ri?ri.data:void 0);ce.fetchers.set(ea.key,Ia)});let xs=me||ce.actionData;Gr(Sa({navigation:Mn},xs?Object.keys(xs).length===0?{actionData:null}:{actionData:xs}:{},zr.length>0?{fetchers:new Map(ce.fetchers)}:{}),{flushSync:at})}zr.forEach(xs=>{Q.has(xs.key)&&Er(xs.key),xs.controller&&Q.set(xs.key,xs.controller)});let Kr=()=>zr.forEach(xs=>Er(xs.key));Ne&&Ne.signal.addEventListener("abort",Kr);let{results:pi,loaderResults:Xi,fetcherResults:Hi}=await gt(ce.matches,Ae,Cr,zr,se);if(se.signal.aborted)return{shortCircuited:!0};Ne&&Ne.signal.removeEventListener("abort",Kr),zr.forEach(xs=>Q.delete(xs.key));let Zi=PP(pi);if(Zi){if(Zi.idx>=Cr.length){let xs=zr[Zi.idx-Cr.length].key;Ce.add(xs)}return await Qe(ce,Zi.result,{replace:Tt}),{shortCircuited:!0}}let{loaderData:ss,errors:xo}=IP(ce,Ae,Cr,Xi,fn,zr,Hi,Ut);Ut.forEach((xs,ea)=>{xs.subscribe(ri=>{(ri||xs.done)&&Ut.delete(ea)})});let Us=Dr(),uo=Fr(ge),No=Us||uo||zr.length>0;return Sa({loaderData:ss,errors:xo},No?{fetchers:new Map(ce.fetchers)}:{})}function Be(se,le,Ae,Fe){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Q.has(se)&&Er(se);let nt=(Fe&&Fe.unstable_flushSync)===!0,kt=g||p,Tt=Ik(ce.location,ce.matches,l,E.v7_prependBasename,Ae,le,Fe==null?void 0:Fe.relative),at=I1(kt,Tt,l);if(!at){At(se,le,Vd(404,{pathname:Tt}),{flushSync:nt});return}let{path:me,submission:fn,error:Mn}=SP(E.v7_normalizeFormMethod,!0,Tt,Fe);if(Mn){At(se,le,Mn,{flushSync:nt});return}let Jt=Lk(at,me);if(Ie=(Fe&&Fe.preventScrollReset)===!0,fn&&Qf(fn.formMethod)){ze(se,le,me,Jt,at,nt,fn);return}tt.set(se,{routeId:le,path:me}),vt(se,le,me,Jt,at,nt,fn)}async function ze(se,le,Ae,Fe,nt,kt,Tt){if(St(),tt.delete(se),!Fe.route.action&&!Fe.route.lazy){let ri=Vd(405,{method:Tt.formMethod,pathname:Ae,routeId:le});At(se,le,ri,{flushSync:kt});return}let at=ce.fetchers.get(se);Rt(se,bZ(Tt,at),{flushSync:kt});let me=new AbortController,fn=xw(t.history,Ae,me.signal,Tt);Q.set(se,me);let Mn=ye,Jt=await vw("action",fn,Fe,nt,u,s,l);if(fn.signal.aborted){Q.get(se)===me&&Q.delete(se);return}if(rt.has(se)){Rt(se,ay(void 0));return}if(Jx(Jt))if(Q.delete(se),ge>Mn){Rt(se,ay(void 0));return}else return Ce.add(se),Rt(se,bw(Tt)),Qe(ce,Jt,{fetcherSubmission:Tt});if(o5(Jt)){At(se,le,Jt.error);return}if(A1(Jt))throw Vd(400,{type:"defer-action"});let mr=ce.navigation.location||ce.location,Cr=xw(t.history,mr,me.signal),zr=g||p,Kr=ce.navigation.state!=="idle"?I1(zr,ce.navigation.location,l):ce.matches;Ti(Kr,"Didn't find any matches after fetcher action");let pi=++ye;xe.set(se,pi);let Xi=bw(Tt,Jt.data);ce.fetchers.set(se,Xi);let[Hi,Zi]=TP(t.history,ce,Kr,Tt,mr,st,qe,et,rt,tt,Ce,zr,l,{[Fe.route.id]:Jt.data},void 0);Zi.filter(ri=>ri.key!==se).forEach(ri=>{let Ia=ri.key,zl=ce.fetchers.get(Ia),tl=bw(void 0,zl?zl.data:void 0);ce.fetchers.set(Ia,tl),Q.has(Ia)&&Er(Ia),ri.controller&&Q.set(Ia,ri.controller)}),Gr({fetchers:new Map(ce.fetchers)});let ss=()=>Zi.forEach(ri=>Er(ri.key));me.signal.addEventListener("abort",ss);let{results:xo,loaderResults:Us,fetcherResults:uo}=await gt(ce.matches,Kr,Hi,Zi,Cr);if(me.signal.aborted)return;me.signal.removeEventListener("abort",ss),xe.delete(se),Q.delete(se),Zi.forEach(ri=>Q.delete(ri.key));let No=PP(xo);if(No){if(No.idx>=Hi.length){let ri=Zi[No.idx-Hi.length].key;Ce.add(ri)}return Qe(ce,No.result)}let{loaderData:xs,errors:ea}=IP(ce,ce.matches,Hi,Us,void 0,Zi,uo,Ut);if(ce.fetchers.has(se)){let ri=ay(Jt.data);ce.fetchers.set(se,ri)}Fr(pi),ce.navigation.state==="loading"&&pi>ge?(Ti(Se,"Expected pending action"),Ne&&Ne.abort(),Li(ce.navigation.location,{matches:Kr,loaderData:xs,errors:ea,fetchers:new Map(ce.fetchers)})):(Gr({errors:ea,loaderData:AP(ce.loaderData,xs,Kr,ea),fetchers:new Map(ce.fetchers)}),st=!1)}async function vt(se,le,Ae,Fe,nt,kt,Tt){let at=ce.fetchers.get(se);Rt(se,bw(Tt,at?at.data:void 0),{flushSync:kt});let me=new AbortController,fn=xw(t.history,Ae,me.signal);Q.set(se,me);let Mn=ye,Jt=await vw("loader",fn,Fe,nt,u,s,l);if(A1(Jt)&&(Jt=await ZO(Jt,fn.signal,!0)||Jt),Q.get(se)===me&&Q.delete(se),!fn.signal.aborted){if(rt.has(se)){Rt(se,ay(void 0));return}if(Jx(Jt))if(ge>Mn){Rt(se,ay(void 0));return}else{Ce.add(se),await Qe(ce,Jt);return}if(o5(Jt)){At(se,le,Jt.error);return}Ti(!A1(Jt),"Unhandled fetcher deferred data"),Rt(se,ay(Jt.data))}}async function Qe(se,le,Ae){let{submission:Fe,fetcherSubmission:nt,replace:kt}=Ae===void 0?{}:Ae;le.revalidate&&(st=!0);let Tt=G1(se.location,le.location,{_isRedirect:!0});if(Ti(Tt,"Expected a location on the redirect navigation"),n){let mr=!1;if(le.reloadDocument)mr=!0;else if(WO.test(le.location)){const Cr=t.history.createURL(le.location);mr=Cr.origin!==e.location.origin||nd(Cr.pathname,l)==null}if(mr){kt?e.location.replace(le.location):e.location.assign(le.location);return}}Ne=null;let at=kt===!0?$o.Replace:$o.Push,{formMethod:me,formAction:fn,formEncType:Mn}=se.navigation;!Fe&&!nt&&me&&fn&&Mn&&(Fe=NP(se.navigation));let Jt=Fe||nt;if(cZ.has(le.status)&&Jt&&Qf(Jt.formMethod))await fi(at,Tt,{submission:Sa({},Jt,{formAction:le.location}),preventScrollReset:Ie});else{let mr=Y6(Tt,Fe);await fi(at,Tt,{overrideNavigation:mr,fetcherSubmission:nt,preventScrollReset:Ie})}}async function gt(se,le,Ae,Fe,nt){let kt=await Promise.all([...Ae.map(me=>vw("loader",nt,me,le,u,s,l)),...Fe.map(me=>me.matches&&me.match&&me.controller?vw("loader",xw(t.history,me.path,me.controller.signal),me.match,me.matches,u,s,l):{type:hl.error,error:Vd(404,{pathname:me.path})})]),Tt=kt.slice(0,Ae.length),at=kt.slice(Ae.length);return await Promise.all([RP(se,Ae,Tt,Tt.map(()=>nt.signal),!1,ce.loaderData),RP(se,Fe.map(me=>me.match),at,Fe.map(me=>me.controller?me.controller.signal:null),!0)]),{results:kt,loaderResults:Tt,fetcherResults:at}}function St(){st=!0,qe.push(...Xs()),tt.forEach((se,le)=>{Q.has(le)&&(et.push(le),Er(le))})}function Rt(se,le,Ae){Ae===void 0&&(Ae={}),ce.fetchers.set(se,le),Gr({fetchers:new Map(ce.fetchers)},{flushSync:(Ae&&Ae.flushSync)===!0})}function At(se,le,Ae,Fe){Fe===void 0&&(Fe={});let nt=s5(ce.matches,le);On(se),Gr({errors:{[nt.route.id]:Ae},fetchers:new Map(ce.fetchers)},{flushSync:(Fe&&Fe.flushSync)===!0})}function en(se){return E.v7_fetcherPersist&&(Je.set(se,(Je.get(se)||0)+1),rt.has(se)&&rt.delete(se)),ce.fetchers.get(se)||HO}function On(se){let le=ce.fetchers.get(se);Q.has(se)&&!(le&&le.state==="loading"&&xe.has(se))&&Er(se),tt.delete(se),xe.delete(se),Ce.delete(se),rt.delete(se),ce.fetchers.delete(se)}function qn(se){if(E.v7_fetcherPersist){let le=(Je.get(se)||0)-1;le<=0?(Je.delete(se),rt.add(se)):Je.set(se,le)}else On(se);Gr({fetchers:new Map(ce.fetchers)})}function Er(se){let le=Q.get(se);Ti(le,"Expected fetch controller: "+se),le.abort(),Q.delete(se)}function Sr(se){for(let le of se){let Ae=en(le),Fe=ay(Ae.data);ce.fetchers.set(le,Fe)}}function Dr(){let se=[],le=!1;for(let Ae of Ce){let Fe=ce.fetchers.get(Ae);Ti(Fe,"Expected fetcher: "+Ae),Fe.state==="loading"&&(Ce.delete(Ae),se.push(Ae),le=!0)}return Sr(se),le}function Fr(se){let le=[];for(let[Ae,Fe]of xe)if(Fe<se){let nt=ce.fetchers.get(Ae);Ti(nt,"Expected fetcher: "+Ae),nt.state==="loading"&&(Er(Ae),xe.delete(Ae),le.push(Ae))}return Sr(le),le.length>0}function Tr(se,le){let Ae=ce.blockers.get(se)||Ax;return ht.get(se)!==le&&ht.set(se,le),Ae}function Zr(se){ce.blockers.delete(se),ht.delete(se)}function is(se,le){let Ae=ce.blockers.get(se)||Ax;Ti(Ae.state==="unblocked"&&le.state==="blocked"||Ae.state==="blocked"&&le.state==="blocked"||Ae.state==="blocked"&&le.state==="proceeding"||Ae.state==="blocked"&&le.state==="unblocked"||Ae.state==="proceeding"&&le.state==="unblocked","Invalid blocker state transition: "+Ae.state+" -> "+le.state);let Fe=new Map(ce.blockers);Fe.set(se,le),Gr({blockers:Fe})}function $i(se){let{currentLocation:le,nextLocation:Ae,historyAction:Fe}=se;if(ht.size===0)return;ht.size>1&&Rm(!1,"A router only supports one blocker at a time");let nt=Array.from(ht.entries()),[kt,Tt]=nt[nt.length-1],at=ce.blockers.get(kt);if(!(at&&at.state==="proceeding")&&Tt({currentLocation:le,nextLocation:Ae,historyAction:Fe}))return kt}function Xs(se){let le=[];return Ut.forEach((Ae,Fe)=>{(!se||se(Fe))&&(Ae.cancel(),le.push(Fe),Ut.delete(Fe))}),le}function vo(se,le,Ae){if(j=se,Y=le,$=Ae||null,!re&&ce.navigation===Z6){re=!0;let Fe=Ps(ce.location,ce.matches);Fe!=null&&Gr({restoreScrollPosition:Fe})}return()=>{j=null,Y=null,$=null}}function Vn(se,le){return $&&$(se,le.map(Fe=>zO(Fe,ce.loaderData)))||se.key}function Di(se,le){if(j&&Y){let Ae=Vn(se,le);j[Ae]=Y()}}function Ps(se,le){if(j){let Ae=Vn(se,le),Fe=j[Ae];if(typeof Fe=="number")return Fe}return null}function ct(se){u={},g=Ck(se,s,void 0,u)}return te={get basename(){return l},get state(){return ce},get routes(){return p},get window(){return e},initialize:Nn,subscribe:rr,enableScrollRestoration:vo,navigate:wi,fetch:Be,revalidate:Nr,createHref:se=>t.history.createHref(se),encodeLocation:se=>t.history.encodeLocation(se),getFetcher:en,deleteFetcher:qn,dispose:zn,getBlocker:Tr,deleteBlocker:Zr,_internalFetchControllers:Q,_internalActiveDeferreds:Ut,_internalSetRoutes:ct},te}function dZ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Ik(t,e,n,r,s,u,p){let g,l;if(u){g=[];for(let P of e)if(g.push(P),P.route.id===u){l=P;break}}else g=e,l=e[e.length-1];let E=AT(s||".",IT(g),nd(t.pathname,n)||t.pathname,p==="path");return s==null&&(E.search=t.search,E.hash=t.hash),(s==null||s===""||s===".")&&l&&l.route.index&&!vC(E.search)&&(E.search=E.search?E.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(E.pathname=E.pathname==="/"?n:Cm([n,E.pathname])),cp(E)}function SP(t,e,n,r){if(!r||!dZ(r))return{path:n};if(r.formMethod&&!vZ(r.formMethod))return{path:n,error:Vd(405,{method:r.formMethod})};let s=()=>({path:n,error:Vd(400,{type:"invalid-body"})}),u=r.formMethod||"get",p=t?u.toUpperCase():u.toLowerCase(),g=XO(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Qf(p))return s();let j=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce(($,Y)=>{let[re,_e]=Y;return""+$+re+"="+_e+`
`},""):String(r.body);return{path:n,submission:{formMethod:p,formAction:g,formEncType:r.formEncType,formData:void 0,json:void 0,text:j}}}else if(r.formEncType==="application/json"){if(!Qf(p))return s();try{let j=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:p,formAction:g,formEncType:r.formEncType,formData:void 0,json:j,text:void 0}}}catch{return s()}}}Ti(typeof FormData=="function","FormData is not available in this environment");let l,E;if(r.formData)l=Ak(r.formData),E=r.formData;else if(r.body instanceof FormData)l=Ak(r.body),E=r.body;else if(r.body instanceof URLSearchParams)l=r.body,E=CP(l);else if(r.body==null)l=new URLSearchParams,E=new FormData;else try{l=new URLSearchParams(r.body),E=CP(l)}catch{return s()}let P={formMethod:p,formAction:g,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:E,json:void 0,text:void 0};if(Qf(P.formMethod))return{path:n,submission:P};let O=ff(n);return e&&O.search&&vC(O.search)&&l.append("index",""),O.search="?"+l,{path:cp(O),submission:P}}function fZ(t,e){let n=t;if(e){let r=t.findIndex(s=>s.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function TP(t,e,n,r,s,u,p,g,l,E,P,O,j,$,Y){let re=Y?Object.values(Y)[0]:$?Object.values($)[0]:void 0,_e=t.createURL(e.location),J=t.createURL(s),H=Y?Object.keys(Y)[0]:void 0,ce=fZ(n,H).filter((Ie,Ne)=>{if(Ie.route.lazy)return!0;if(Ie.route.loader==null)return!1;if(pZ(e.loaderData,e.matches[Ne],Ie)||p.some(We=>We===Ie.route.id))return!0;let ut=e.matches[Ne],mt=Ie;return MP(Ie,Sa({currentUrl:_e,currentParams:ut.params,nextUrl:J,nextParams:mt.params},r,{actionResult:re,defaultShouldRevalidate:u||_e.pathname+_e.search===J.pathname+J.search||_e.search!==J.search||$O(ut,mt)}))}),Se=[];return E.forEach((Ie,Ne)=>{if(!n.some(st=>st.route.id===Ie.routeId)||l.has(Ne))return;let ut=I1(O,Ie.path,j);if(!ut){Se.push({key:Ne,routeId:Ie.routeId,path:Ie.path,matches:null,match:null,controller:null});return}let mt=e.fetchers.get(Ne),We=Lk(ut,Ie.path),Ot=!1;P.has(Ne)?Ot=!1:g.includes(Ne)?Ot=!0:mt&&mt.state!=="idle"&&mt.data===void 0?Ot=u:Ot=MP(We,Sa({currentUrl:_e,currentParams:e.matches[e.matches.length-1].params,nextUrl:J,nextParams:n[n.length-1].params},r,{actionResult:re,defaultShouldRevalidate:u})),Ot&&Se.push({key:Ne,routeId:Ie.routeId,path:Ie.path,matches:ut,match:We,controller:new AbortController})}),[ce,Se]}function pZ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function $O(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function MP(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function kP(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Ti(s,"No route found in manifest");let u={};for(let p in r){let l=s[p]!==void 0&&p!=="hasErrorBoundary";Rm(!l,'Route "'+s.id+'" has a static property "'+p+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+p+'" will be ignored.')),!l&&!NX.has(p)&&(u[p]=r[p])}Object.assign(s,u),Object.assign(s,Sa({},e(s),{lazy:void 0}))}async function vw(t,e,n,r,s,u,p,g){g===void 0&&(g={});let l,E,P,O=Y=>{let re,_e=new Promise((J,H)=>re=H);return P=()=>re(),e.signal.addEventListener("abort",P),Promise.race([Y({request:e,params:n.params,context:g.requestContext}),_e])};try{let Y=n.route[t];if(n.route.lazy)if(Y){let re,_e=await Promise.all([O(Y).catch(J=>{re=J}),kP(n.route,u,s)]);if(re)throw re;E=_e[0]}else if(await kP(n.route,u,s),Y=n.route[t],Y)E=await O(Y);else if(t==="action"){let re=new URL(e.url),_e=re.pathname+re.search;throw Vd(405,{method:e.method,pathname:_e,routeId:n.route.id})}else return{type:hl.data,data:void 0};else if(Y)E=await O(Y);else{let re=new URL(e.url),_e=re.pathname+re.search;throw Vd(404,{pathname:_e})}Ti(E!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(Y){l=hl.error,E=Y}finally{P&&e.signal.removeEventListener("abort",P)}if(_Z(E)){let Y=E.status;if(uZ.has(Y)){let J=E.headers.get("Location");if(Ti(J,"Redirects returned/thrown from loaders/actions must have a Location header"),!WO.test(J))J=Ik(new URL(e.url),r.slice(0,r.indexOf(n)+1),p,!0,J);else if(!g.isStaticRequest){let H=new URL(e.url),te=J.startsWith("//")?new URL(H.protocol+J):new URL(J),ce=nd(te.pathname,p)!=null;te.origin===H.origin&&ce&&(J=te.pathname+te.search+te.hash)}if(g.isStaticRequest)throw E.headers.set("Location",J),E;return{type:hl.redirect,status:Y,location:J,revalidate:E.headers.get("X-Remix-Revalidate")!==null,reloadDocument:E.headers.get("X-Remix-Reload-Document")!==null}}if(g.isRouteRequest)throw{type:l===hl.error?hl.error:hl.data,response:E};let re,_e=E.headers.get("Content-Type");return _e&&/\bapplication\/json\b/.test(_e)?re=await E.json():re=await E.text(),l===hl.error?{type:l,error:new gC(Y,E.statusText,re),headers:E.headers}:{type:hl.data,data:re,statusCode:E.status,headers:E.headers}}if(l===hl.error)return{type:l,error:E};if(yZ(E)){var j,$;return{type:hl.deferred,deferredData:E,statusCode:(j=E.init)==null?void 0:j.status,headers:(($=E.init)==null?void 0:$.headers)&&new Headers(E.init.headers)}}return{type:hl.data,data:E}}function xw(t,e,n,r){let s=t.createURL(XO(e)).toString(),u={signal:n};if(r&&Qf(r.formMethod)){let{formMethod:p,formEncType:g}=r;u.method=p.toUpperCase(),g==="application/json"?(u.headers=new Headers({"Content-Type":g}),u.body=JSON.stringify(r.json)):g==="text/plain"?u.body=r.text:g==="application/x-www-form-urlencoded"&&r.formData?u.body=Ak(r.formData):u.body=r.formData}return new Request(s,u)}function Ak(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function CP(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function mZ(t,e,n,r,s){let u={},p=null,g,l=!1,E={};return n.forEach((P,O)=>{let j=e[O].route.id;if(Ti(!Jx(P),"Cannot handle redirect results in processLoaderData"),o5(P)){let $=s5(t,j),Y=P.error;r&&(Y=Object.values(r)[0],r=void 0),p=p||{},p[$.route.id]==null&&(p[$.route.id]=Y),u[j]=void 0,l||(l=!0,g=yC(P.error)?P.error.status:500),P.headers&&(E[j]=P.headers)}else A1(P)?(s.set(j,P.deferredData),u[j]=P.deferredData.data):u[j]=P.data,P.statusCode!=null&&P.statusCode!==200&&!l&&(g=P.statusCode),P.headers&&(E[j]=P.headers)}),r&&(p=r,u[Object.keys(r)[0]]=void 0),{loaderData:u,errors:p,statusCode:g||200,loaderHeaders:E}}function IP(t,e,n,r,s,u,p,g){let{loaderData:l,errors:E}=mZ(e,n,r,s,g);for(let P=0;P<u.length;P++){let{key:O,match:j,controller:$}=u[P];Ti(p!==void 0&&p[P]!==void 0,"Did not find corresponding fetcher result");let Y=p[P];if(!($&&$.signal.aborted))if(o5(Y)){let re=s5(t.matches,j==null?void 0:j.route.id);E&&E[re.route.id]||(E=Sa({},E,{[re.route.id]:Y.error})),t.fetchers.delete(O)}else if(Jx(Y))Ti(!1,"Unhandled fetcher revalidation redirect");else if(A1(Y))Ti(!1,"Unhandled fetcher deferred data");else{let re=ay(Y.data);t.fetchers.set(O,re)}}return{loaderData:l,errors:E}}function AP(t,e,n,r){let s=Sa({},e);for(let u of n){let p=u.route.id;if(e.hasOwnProperty(p)?e[p]!==void 0&&(s[p]=e[p]):t[p]!==void 0&&u.route.loader&&(s[p]=t[p]),r&&r.hasOwnProperty(p))break}return s}function s5(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function LP(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Vd(t,e){let{pathname:n,routeId:r,method:s,type:u}=e===void 0?{}:e,p="Unknown Server Error",g="Unknown @remix-run/router error";return t===400?(p="Bad Request",s&&n&&r?g="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":u==="defer-action"?g="defer() is not supported in actions":u==="invalid-body"&&(g="Unable to encode submission body")):t===403?(p="Forbidden",g='Route "'+r+'" does not match URL "'+n+'"'):t===404?(p="Not Found",g='No route matches URL "'+n+'"'):t===405&&(p="Method Not Allowed",s&&n&&r?g="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(g='Invalid request method "'+s.toUpperCase()+'"')),new gC(t||500,p,new Error(g),!0)}function PP(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Jx(n))return{result:n,idx:e}}}function XO(t){let e=typeof t=="string"?ff(t):t;return cp(Sa({},e,{hash:""}))}function gZ(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function A1(t){return t.type===hl.deferred}function o5(t){return t.type===hl.error}function Jx(t){return(t&&t.type)===hl.redirect}function yZ(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function _Z(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function vZ(t){return lZ.has(t.toLowerCase())}function Qf(t){return oZ.has(t.toLowerCase())}async function RP(t,e,n,r,s,u){for(let p=0;p<n.length;p++){let g=n[p],l=e[p];if(!l)continue;let E=t.find(O=>O.route.id===l.route.id),P=E!=null&&!$O(E,l)&&(u&&u[l.route.id])!==void 0;if(A1(g)&&(s||P)){let O=r[p];Ti(O,"Expected an AbortSignal for revalidating fetcher deferred result"),await ZO(g,O,s).then(j=>{j&&(n[p]=j||n[p])})}}}async function ZO(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:hl.data,data:t.deferredData.unwrappedData}}catch(s){return{type:hl.error,error:s}}return{type:hl.data,data:t.deferredData.data}}}function vC(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Lk(t,e){let n=typeof e=="string"?ff(e).search:e.search;if(t[t.length-1].route.index&&vC(n||""))return t[t.length-1];let r=VO(t);return r[r.length-1]}function NP(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:u,json:p}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(u!=null)return{formMethod:e,formAction:n,formEncType:r,formData:u,json:void 0,text:void 0};if(p!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:p,text:void 0}}}function Y6(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function xZ(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function bw(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function bZ(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ay(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function wZ(t,e){try{let n=t.sessionStorage.getItem(qO);if(n){let r=JSON.parse(n);for(let[s,u]of Object.entries(r||{}))u&&Array.isArray(u)&&e.set(s,new Set(u||[]))}}catch{}}function EZ(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(qO,JSON.stringify(n))}catch(r){Rm(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function H1(){return H1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},H1.apply(this,arguments)}const Zb=Lt.createContext(null),f9=Lt.createContext(null),hS=Lt.createContext(null),wp=Lt.createContext(null),Yb=Lt.createContext(null),md=Lt.createContext({outlet:null,matches:[],isDataRoute:!1}),YO=Lt.createContext(null);function KO(t,e){let{relative:n}=e===void 0?{}:e;Zy()||Ti(!1);let{basename:r,navigator:s}=Lt.useContext(wp),{hash:u,pathname:p,search:g}=Kb(t,{relative:n}),l=p;return r!=="/"&&(l=p==="/"?r:Cm([r,p])),s.createHref({pathname:l,search:g,hash:u})}function Zy(){return Lt.useContext(Yb)!=null}function Ep(){return Zy()||Ti(!1),Lt.useContext(Yb).location}function SZ(){return Lt.useContext(Yb).navigationType}function TZ(t){Zy()||Ti(!1);let{pathname:e}=Ep();return Lt.useMemo(()=>P5(t,e),[e,t])}function JO(t){Lt.useContext(wp).static||Lt.useLayoutEffect(t)}function LT(){let{isDataRoute:t}=Lt.useContext(md);return t?BZ():MZ()}function MZ(){Zy()||Ti(!1);let t=Lt.useContext(Zb),{basename:e,navigator:n}=Lt.useContext(wp),{matches:r}=Lt.useContext(md),{pathname:s}=Ep(),u=JSON.stringify(IT(r)),p=Lt.useRef(!1);return JO(()=>{p.current=!0}),Lt.useCallback(function(l,E){if(E===void 0&&(E={}),!p.current)return;if(typeof l=="number"){n.go(l);return}let P=AT(l,JSON.parse(u),s,E.relative==="path");t==null&&e!=="/"&&(P.pathname=P.pathname==="/"?e:Cm([e,P.pathname])),(E.replace?n.replace:n.push)(P,E.state,E)},[e,n,u,s,t])}const QO=Lt.createContext(null);function kZ(){return Lt.useContext(QO)}function eF(t){let e=Lt.useContext(md).outlet;return e&&Lt.createElement(QO.Provider,{value:t},e)}function PT(){let{matches:t}=Lt.useContext(md),e=t[t.length-1];return e?e.params:{}}function Kb(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=Lt.useContext(md),{pathname:s}=Ep(),u=JSON.stringify(IT(r));return Lt.useMemo(()=>AT(t,JSON.parse(u),s,n==="path"),[t,u,s,n])}function tF(t,e){return nF(t,e)}function nF(t,e,n){Zy()||Ti(!1);let{navigator:r}=Lt.useContext(wp),{matches:s}=Lt.useContext(md),u=s[s.length-1],p=u?u.params:{};u&&u.pathname;let g=u?u.pathnameBase:"/";u&&u.route;let l=Ep(),E;if(e){var P;let re=typeof e=="string"?ff(e):e;g==="/"||(P=re.pathname)!=null&&P.startsWith(g)||Ti(!1),E=re}else E=l;let O=E.pathname||"/",j=g==="/"?O:O.slice(g.length)||"/",$=I1(t,{pathname:j}),Y=rF($&&$.map(re=>Object.assign({},re,{params:Object.assign({},p,re.params),pathname:Cm([g,r.encodeLocation?r.encodeLocation(re.pathname).pathname:re.pathname]),pathnameBase:re.pathnameBase==="/"?g:Cm([g,r.encodeLocation?r.encodeLocation(re.pathnameBase).pathname:re.pathnameBase])})),s,n);return e&&Y?Lt.createElement(Yb.Provider,{value:{location:H1({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:$o.Pop}},Y):Y}function CZ(){let t=aF(),e=yC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},u=null;return Lt.createElement(Lt.Fragment,null,Lt.createElement("h2",null,"Unexpected Application Error!"),Lt.createElement("h3",{style:{fontStyle:"italic"}},e),n?Lt.createElement("pre",{style:s},n):null,u)}const IZ=Lt.createElement(CZ,null);class AZ extends Lt.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?Lt.createElement(md.Provider,{value:this.props.routeContext},Lt.createElement(YO.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LZ(t){let{routeContext:e,match:n,children:r}=t,s=Lt.useContext(Zb);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),Lt.createElement(md.Provider,{value:e},r)}function rF(t,e,n){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let u=t,p=(r=n)==null?void 0:r.errors;if(p!=null){let g=u.findIndex(l=>l.route.id&&(p==null?void 0:p[l.route.id]));g>=0||Ti(!1),u=u.slice(0,Math.min(u.length,g+1))}return u.reduceRight((g,l,E)=>{let P=l.route.id?p==null?void 0:p[l.route.id]:null,O=null;n&&(O=l.route.errorElement||IZ);let j=e.concat(u.slice(0,E+1)),$=()=>{let Y;return P?Y=O:l.route.Component?Y=Lt.createElement(l.route.Component,null):l.route.element?Y=l.route.element:Y=g,Lt.createElement(LZ,{match:l,routeContext:{outlet:g,matches:j,isDataRoute:n!=null},children:Y})};return n&&(l.route.ErrorBoundary||l.route.errorElement||E===0)?Lt.createElement(AZ,{location:n.location,revalidation:n.revalidation,component:O,error:P,children:$(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):$()},null)}var RT=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(RT||{}),vh=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(vh||{});function xC(t){let e=Lt.useContext(Zb);return e||Ti(!1),e}function Yy(t){let e=Lt.useContext(f9);return e||Ti(!1),e}function PZ(t){let e=Lt.useContext(md);return e||Ti(!1),e}function p9(t){let e=PZ(),n=e.matches[e.matches.length-1];return n.route.id||Ti(!1),n.route.id}function iF(){return p9(vh.UseRouteId)}function sF(){return Yy(vh.UseNavigation).navigation}function RZ(){let t=xC(RT.UseRevalidator),e=Yy(vh.UseRevalidator);return Lt.useMemo(()=>({revalidate:t.router.revalidate,state:e.revalidation}),[t.router.revalidate,e.revalidation])}function oF(){let{matches:t,loaderData:e}=Yy(vh.UseMatches);return Lt.useMemo(()=>t.map(n=>zO(n,e)),[t,e])}function NZ(){let t=Yy(vh.UseLoaderData),e=p9(vh.UseLoaderData);if(t.errors&&t.errors[e]!=null){console.error("You cannot `useLoaderData` in an errorElement (routeId: "+e+")");return}return t.loaderData[e]}function DZ(t){return Yy(vh.UseRouteLoaderData).loaderData[t]}function OZ(){let t=Yy(vh.UseActionData),e=p9(vh.UseLoaderData);return t.actionData?t.actionData[e]:void 0}function aF(){var t;let e=Lt.useContext(YO),n=Yy(vh.UseRouteError),r=p9(vh.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function lF(){let t=Lt.useContext(hS);return t==null?void 0:t._data}function FZ(){let t=Lt.useContext(hS);return t==null?void 0:t._error}let zZ=0;function uF(t){let{router:e,basename:n}=xC(RT.UseBlocker),r=Yy(vh.UseBlocker),[s,u]=Lt.useState(""),p=Lt.useCallback(g=>{if(typeof t!="function")return!!t;if(n==="/")return t(g);let{currentLocation:l,nextLocation:E,historyAction:P}=g;return t({currentLocation:H1({},l,{pathname:nd(l.pathname,n)||l.pathname}),nextLocation:H1({},E,{pathname:nd(E.pathname,n)||E.pathname}),historyAction:P})},[n,t]);return Lt.useEffect(()=>{let g=String(++zZ);return u(g),()=>e.deleteBlocker(g)},[e]),Lt.useEffect(()=>{s!==""&&e.getBlocker(s,p)},[e,s,p]),s&&r.blockers.has(s)?r.blockers.get(s):Ax}function BZ(){let{router:t}=xC(RT.UseNavigateStable),e=p9(vh.UseNavigateStable),n=Lt.useRef(!1);return JO(()=>{n.current=!0}),Lt.useCallback(function(s,u){u===void 0&&(u={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,H1({fromRouteId:e},u)))},[t,e])}const UZ="startTransition",DP=gN[UZ];function jZ(t){let{basename:e,children:n,initialEntries:r,initialIndex:s,future:u}=t,p=Lt.useRef();p.current==null&&(p.current=NO({initialEntries:r,initialIndex:s,v5Compat:!0}));let g=p.current,[l,E]=Lt.useState({action:g.action,location:g.location}),{v7_startTransition:P}=u||{},O=Lt.useCallback(j=>{P&&DP?DP(()=>E(j)):E(j)},[E,P]);return Lt.useLayoutEffect(()=>g.listen(O),[g,O]),Lt.createElement(Jb,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:g})}function VZ(t){let{to:e,replace:n,state:r,relative:s}=t;Zy()||Ti(!1);let{matches:u}=Lt.useContext(md),{pathname:p}=Ep(),g=LT(),l=AT(e,IT(u),p,s==="path"),E=JSON.stringify(l);return Lt.useEffect(()=>g(JSON.parse(E),{replace:n,state:r,relative:s}),[g,E,s,n,r]),null}function cF(t){return eF(t.context)}function hF(t){Ti(!1)}function Jb(t){let{basename:e="/",children:n=null,location:r,navigationType:s=$o.Pop,navigator:u,static:p=!1}=t;Zy()&&Ti(!1);let g=e.replace(/^\/*/,"/"),l=Lt.useMemo(()=>({basename:g,navigator:u,static:p}),[g,u,p]);typeof r=="string"&&(r=ff(r));let{pathname:E="/",search:P="",hash:O="",state:j=null,key:$="default"}=r,Y=Lt.useMemo(()=>{let re=nd(E,g);return re==null?null:{location:{pathname:re,search:P,hash:O,state:j,key:$},navigationType:s}},[g,E,P,O,j,$,s]);return Y==null?null:Lt.createElement(wp.Provider,{value:l},Lt.createElement(Yb.Provider,{children:n,value:Y}))}function GZ(t){let{children:e,location:n}=t;return tF(R5(e),n)}function HZ(t){let{children:e,errorElement:n,resolve:r}=t;return Lt.createElement(qZ,{resolve:r,errorElement:n},Lt.createElement($Z,null,e))}var zd=function(t){return t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error",t}(zd||{});const WZ=new Promise(()=>{});class qZ extends Lt.Component{constructor(e){super(e),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,n){console.error("<Await> caught the following error during render",e,n)}render(){let{children:e,errorElement:n,resolve:r}=this.props,s=null,u=zd.pending;if(!(r instanceof Promise))u=zd.success,s=Promise.resolve(),Object.defineProperty(s,"_tracked",{get:()=>!0}),Object.defineProperty(s,"_data",{get:()=>r});else if(this.state.error){u=zd.error;let p=this.state.error;s=Promise.reject().catch(()=>{}),Object.defineProperty(s,"_tracked",{get:()=>!0}),Object.defineProperty(s,"_error",{get:()=>p})}else r._tracked?(s=r,u=s._error!==void 0?zd.error:s._data!==void 0?zd.success:zd.pending):(u=zd.pending,Object.defineProperty(r,"_tracked",{get:()=>!0}),s=r.then(p=>Object.defineProperty(r,"_data",{get:()=>p}),p=>Object.defineProperty(r,"_error",{get:()=>p})));if(u===zd.error&&s._error instanceof cS)throw WZ;if(u===zd.error&&!n)throw s._error;if(u===zd.error)return Lt.createElement(hS.Provider,{value:s,children:n});if(u===zd.success)return Lt.createElement(hS.Provider,{value:s,children:e});throw s}}function $Z(t){let{children:e}=t,n=lF(),r=typeof e=="function"?e(n):e;return Lt.createElement(Lt.Fragment,null,r)}function R5(t,e){e===void 0&&(e=[]);let n=[];return Lt.Children.forEach(t,(r,s)=>{if(!Lt.isValidElement(r))return;let u=[...e,s];if(r.type===Lt.Fragment){n.push.apply(n,R5(r.props.children,u));return}r.type!==hF&&Ti(!1),!r.props.index||!r.props.children||Ti(!1);let p={id:r.props.id||u.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(p.children=R5(r.props.children,u)),n.push(p)}),n}function XZ(t){return rF(t)}function bC(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:Lt.createElement(t.Component),Component:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:Lt.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}function ZZ(t,e){return _C({basename:e==null?void 0:e.basename,future:H1({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:NO({initialEntries:e==null?void 0:e.initialEntries,initialIndex:e==null?void 0:e.initialIndex}),hydrationData:e==null?void 0:e.hydrationData,routes:t,mapRouteProperties:bC}).initialize()}/**
 * React Router DOM v6.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mh(){return mh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mh.apply(this,arguments)}function wC(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,u;for(u=0;u<r.length;u++)s=r[u],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}const EE="get",K6="application/x-www-form-urlencoded";function NT(t){return t!=null&&typeof t.tagName=="string"}function YZ(t){return NT(t)&&t.tagName.toLowerCase()==="button"}function KZ(t){return NT(t)&&t.tagName.toLowerCase()==="form"}function JZ(t){return NT(t)&&t.tagName.toLowerCase()==="input"}function QZ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function eY(t,e){return t.button===0&&(!e||e==="_self")&&!QZ(t)}function dS(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function tY(t,e){let n=dS(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(u=>{n.append(s,u)})}),n}let q4=null;function nY(){if(q4===null)try{new FormData(document.createElement("form"),0),q4=!1}catch{q4=!0}return q4}const rY=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function J6(t){return t!=null&&!rY.has(t)?null:t}function iY(t,e){let n,r,s,u,p;if(KZ(t)){let g=t.getAttribute("action");r=g?nd(g,e):null,n=t.getAttribute("method")||EE,s=J6(t.getAttribute("enctype"))||K6,u=new FormData(t)}else if(YZ(t)||JZ(t)&&(t.type==="submit"||t.type==="image")){let g=t.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||g.getAttribute("action");if(r=l?nd(l,e):null,n=t.getAttribute("formmethod")||g.getAttribute("method")||EE,s=J6(t.getAttribute("formenctype"))||J6(g.getAttribute("enctype"))||K6,u=new FormData(g,t),!nY()){let{name:E,type:P,value:O}=t;if(P==="image"){let j=E?E+".":"";u.append(j+"x","0"),u.append(j+"y","0")}else E&&u.append(E,O)}}else{if(NT(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=EE,r=null,s=K6,p=t}return u&&s==="text/plain"&&(p=u,u=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:u,body:p}}const sY=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],oY=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],aY=["fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","unstable_viewTransition"];function dF(t,e){return _C({basename:e==null?void 0:e.basename,future:mh({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:DO({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||fF(),routes:t,mapRouteProperties:bC,window:e==null?void 0:e.window}).initialize()}function lY(t,e){return _C({basename:e==null?void 0:e.basename,future:mh({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:OO({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||fF(),routes:t,mapRouteProperties:bC,window:e==null?void 0:e.window}).initialize()}function fF(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=mh({},e,{errors:uY(e.errors)})),e}function uY(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new gC(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let u=window[s.__subType];if(typeof u=="function")try{let p=new u(s.message);p.stack="",n[r]=p}catch{}}if(n[r]==null){let u=new Error(s.message);u.stack="",n[r]=u}}else n[r]=s;return n}const EC=Lt.createContext({isTransitioning:!1}),SC=Lt.createContext(new Map),cY="startTransition",Dy=gN[cY],hY="flushSync",OP=G$[hY];function dY(t){Dy?Dy(t):t()}function ww(t){OP?OP(t):t()}class fY{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function pF(t){let{fallbackElement:e,router:n,future:r}=t,[s,u]=Lt.useState(n.state),[p,g]=Lt.useState(),[l,E]=Lt.useState({isTransitioning:!1}),[P,O]=Lt.useState(),[j,$]=Lt.useState(),[Y,re]=Lt.useState(),_e=Lt.useRef(new Map),{v7_startTransition:J}=r||{},H=Lt.useCallback(Ne=>{J?dY(Ne):Ne()},[J]),te=Lt.useCallback((Ne,ut)=>{let{deletedFetchers:mt,unstable_flushSync:We,unstable_viewTransitionOpts:Ot}=ut;mt.forEach(qe=>_e.current.delete(qe)),Ne.fetchers.forEach((qe,et)=>{qe.data!==void 0&&_e.current.set(et,qe.data)});let st=n.window==null||typeof n.window.document.startViewTransition!="function";if(!Ot||st){We?ww(()=>u(Ne)):H(()=>u(Ne));return}if(We){ww(()=>{j&&(P&&P.resolve(),j.skipTransition()),E({isTransitioning:!0,flushSync:!0,currentLocation:Ot.currentLocation,nextLocation:Ot.nextLocation})});let qe=n.window.document.startViewTransition(()=>{ww(()=>u(Ne))});qe.finished.finally(()=>{ww(()=>{O(void 0),$(void 0),g(void 0),E({isTransitioning:!1})})}),ww(()=>$(qe));return}j?(P&&P.resolve(),j.skipTransition(),re({state:Ne,currentLocation:Ot.currentLocation,nextLocation:Ot.nextLocation})):(g(Ne),E({isTransitioning:!0,flushSync:!1,currentLocation:Ot.currentLocation,nextLocation:Ot.nextLocation}))},[n.window,j,P,_e,H]);Lt.useLayoutEffect(()=>n.subscribe(te),[n,te]),Lt.useEffect(()=>{l.isTransitioning&&!l.flushSync&&O(new fY)},[l]),Lt.useEffect(()=>{if(P&&p&&n.window){let Ne=p,ut=P.promise,mt=n.window.document.startViewTransition(async()=>{H(()=>u(Ne)),await ut});mt.finished.finally(()=>{O(void 0),$(void 0),g(void 0),E({isTransitioning:!1})}),$(mt)}},[H,p,P,n.window]),Lt.useEffect(()=>{P&&p&&s.location.key===p.location.key&&P.resolve()},[P,j,s.location,p]),Lt.useEffect(()=>{!l.isTransitioning&&Y&&(g(Y.state),E({isTransitioning:!0,flushSync:!1,currentLocation:Y.currentLocation,nextLocation:Y.nextLocation}),re(void 0))},[l.isTransitioning,Y]);let ce=Lt.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:Ne=>n.navigate(Ne),push:(Ne,ut,mt)=>n.navigate(Ne,{state:ut,preventScrollReset:mt==null?void 0:mt.preventScrollReset}),replace:(Ne,ut,mt)=>n.navigate(Ne,{replace:!0,state:ut,preventScrollReset:mt==null?void 0:mt.preventScrollReset})}),[n]),Se=n.basename||"/",Ie=Lt.useMemo(()=>({router:n,navigator:ce,static:!1,basename:Se}),[n,ce,Se]);return Lt.createElement(Lt.Fragment,null,Lt.createElement(Zb.Provider,{value:Ie},Lt.createElement(f9.Provider,{value:s},Lt.createElement(SC.Provider,{value:_e.current},Lt.createElement(EC.Provider,{value:l},Lt.createElement(Jb,{basename:Se,location:s.location,navigationType:s.historyAction,navigator:ce},s.initialized?Lt.createElement(pY,{routes:n.routes,state:s}):e))))),null)}function pY(t){let{routes:e,state:n}=t;return nF(e,void 0,n)}function mY(t){let{basename:e,children:n,future:r,window:s}=t,u=Lt.useRef();u.current==null&&(u.current=DO({window:s,v5Compat:!0}));let p=u.current,[g,l]=Lt.useState({action:p.action,location:p.location}),{v7_startTransition:E}=r||{},P=Lt.useCallback(O=>{E&&Dy?Dy(()=>l(O)):l(O)},[l,E]);return Lt.useLayoutEffect(()=>p.listen(P),[p,P]),Lt.createElement(Jb,{basename:e,children:n,location:g.location,navigationType:g.action,navigator:p})}function gY(t){let{basename:e,children:n,future:r,window:s}=t,u=Lt.useRef();u.current==null&&(u.current=OO({window:s,v5Compat:!0}));let p=u.current,[g,l]=Lt.useState({action:p.action,location:p.location}),{v7_startTransition:E}=r||{},P=Lt.useCallback(O=>{E&&Dy?Dy(()=>l(O)):l(O)},[l,E]);return Lt.useLayoutEffect(()=>p.listen(P),[p,P]),Lt.createElement(Jb,{basename:e,children:n,location:g.location,navigationType:g.action,navigator:p})}function yY(t){let{basename:e,children:n,future:r,history:s}=t,[u,p]=Lt.useState({action:s.action,location:s.location}),{v7_startTransition:g}=r||{},l=Lt.useCallback(E=>{g&&Dy?Dy(()=>p(E)):p(E)},[p,g]);return Lt.useLayoutEffect(()=>s.listen(l),[s,l]),Lt.createElement(Jb,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:s})}const _Y=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",vY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,TC=Lt.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:u,replace:p,state:g,target:l,to:E,preventScrollReset:P,unstable_viewTransition:O}=e,j=wC(e,sY),{basename:$}=Lt.useContext(wp),Y,re=!1;if(typeof E=="string"&&vY.test(E)&&(Y=E,_Y))try{let te=new URL(window.location.href),ce=E.startsWith("//")?new URL(te.protocol+E):new URL(E),Se=nd(ce.pathname,$);ce.origin===te.origin&&Se!=null?E=Se+ce.search+ce.hash:re=!0}catch{}let _e=KO(E,{relative:s}),J=gF(E,{replace:p,state:g,target:l,preventScrollReset:P,relative:s,unstable_viewTransition:O});function H(te){r&&r(te),te.defaultPrevented||J(te)}return Lt.createElement("a",mh({},j,{href:Y||_e,onClick:re||u?r:H,ref:n,target:l}))}),xY=Lt.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:u="",end:p=!1,style:g,to:l,unstable_viewTransition:E,children:P}=e,O=wC(e,oY),j=Kb(l,{relative:O.relative}),$=Ep(),Y=Lt.useContext(f9),{navigator:re}=Lt.useContext(wp),_e=Y!=null&&xF(j)&&E===!0,J=re.encodeLocation?re.encodeLocation(j).pathname:j.pathname,H=$.pathname,te=Y&&Y.navigation&&Y.navigation.location?Y.navigation.location.pathname:null;s||(H=H.toLowerCase(),te=te?te.toLowerCase():null,J=J.toLowerCase());const ce=J!=="/"&&J.endsWith("/")?J.length-1:J.length;let Se=H===J||!p&&H.startsWith(J)&&H.charAt(ce)==="/",Ie=te!=null&&(te===J||!p&&te.startsWith(J)&&te.charAt(J.length)==="/"),Ne={isActive:Se,isPending:Ie,isTransitioning:_e},ut=Se?r:void 0,mt;typeof u=="function"?mt=u(Ne):mt=[u,Se?"active":null,Ie?"pending":null,_e?"transitioning":null].filter(Boolean).join(" ");let We=typeof g=="function"?g(Ne):g;return Lt.createElement(TC,mh({},O,{"aria-current":ut,className:mt,ref:n,style:We,to:l,unstable_viewTransition:E}),typeof P=="function"?P(Ne):P)}),mF=Lt.forwardRef((t,e)=>{let{fetcherKey:n,navigate:r,reloadDocument:s,replace:u,state:p,method:g=EE,action:l,onSubmit:E,relative:P,preventScrollReset:O,unstable_viewTransition:j}=t,$=wC(t,aY),Y=kC(),re=_F(l,{relative:P}),_e=g.toLowerCase()==="get"?"get":"post",J=H=>{if(E&&E(H),H.defaultPrevented)return;H.preventDefault();let te=H.nativeEvent.submitter,ce=(te==null?void 0:te.getAttribute("formmethod"))||g;Y(te||H.currentTarget,{fetcherKey:n,method:ce,navigate:r,replace:u,state:p,relative:P,preventScrollReset:O,unstable_viewTransition:j})};return Lt.createElement("form",mh({ref:e,method:_e,action:re,onSubmit:s?E:J},$))});function bY(t){let{getKey:e,storageKey:n}=t;return vF({getKey:e,storageKey:n}),null}var db;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(db||(db={}));var N5;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(N5||(N5={}));function DT(t){let e=Lt.useContext(Zb);return e||Ti(!1),e}function MC(t){let e=Lt.useContext(f9);return e||Ti(!1),e}function gF(t,e){let{target:n,replace:r,state:s,preventScrollReset:u,relative:p,unstable_viewTransition:g}=e===void 0?{}:e,l=LT(),E=Ep(),P=Kb(t,{relative:p});return Lt.useCallback(O=>{if(eY(O,n)){O.preventDefault();let j=r!==void 0?r:cp(E)===cp(P);l(t,{replace:j,state:s,preventScrollReset:u,relative:p,unstable_viewTransition:g})}},[E,l,P,r,s,n,t,u,p,g])}function wY(t){let e=Lt.useRef(dS(t)),n=Lt.useRef(!1),r=Ep(),s=Lt.useMemo(()=>tY(r.search,n.current?null:e.current),[r.search]),u=LT(),p=Lt.useCallback((g,l)=>{const E=dS(typeof g=="function"?g(s):g);n.current=!0,u("?"+E,l)},[u,s]);return[s,p]}function EY(){if(typeof document>"u")throw new Error("You are calling submit during the server render. Try calling submit within a `useEffect` or callback instead.")}let SY=0,yF=()=>"__"+String(++SY)+"__";function kC(){let{router:t}=DT(db.UseSubmit),{basename:e}=Lt.useContext(wp),n=iF();return Lt.useCallback(function(r,s){s===void 0&&(s={}),EY();let{action:u,method:p,encType:g,formData:l,body:E}=iY(r,e);if(s.navigate===!1){let P=s.fetcherKey||yF();t.fetch(P,n,s.action||u,{preventScrollReset:s.preventScrollReset,formData:l,body:E,formMethod:s.method||p,formEncType:s.encType||g,unstable_flushSync:s.unstable_flushSync})}else t.navigate(s.action||u,{preventScrollReset:s.preventScrollReset,formData:l,body:E,formMethod:s.method||p,formEncType:s.encType||g,replace:s.replace,state:s.state,fromRouteId:n,unstable_flushSync:s.unstable_flushSync,unstable_viewTransition:s.unstable_viewTransition})},[t,e,n])}function _F(t,e){let{relative:n}=e===void 0?{}:e,{basename:r}=Lt.useContext(wp),s=Lt.useContext(md);s||Ti(!1);let[u]=s.matches.slice(-1),p=mh({},Kb(t||".",{relative:n})),g=Ep();if(t==null){p.search=g.search;let l=new URLSearchParams(p.search);l.has("index")&&l.get("index")===""&&(l.delete("index"),p.search=l.toString()?"?"+l.toString():"")}return(!t||t===".")&&u.route.index&&(p.search=p.search?p.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(p.pathname=p.pathname==="/"?r:Cm([r,p.pathname])),cp(p)}function TY(t){var e;let{key:n}=t===void 0?{}:t,{router:r}=DT(db.UseFetcher),s=MC(N5.UseFetcher),u=Lt.useContext(SC),p=Lt.useContext(md),g=(e=p.matches[p.matches.length-1])==null?void 0:e.route.id;u||Ti(!1),p||Ti(!1),g==null&&Ti(!1);let[l,E]=Lt.useState(n||"");n&&n!==l?E(n):l||E(yF()),Lt.useEffect(()=>(r.getFetcher(l),()=>{r.deleteFetcher(l)}),[r,l]);let P=Lt.useCallback((J,H)=>{g||Ti(!1),r.fetch(l,g,J,H)},[l,g,r]),O=kC(),j=Lt.useCallback((J,H)=>{O(J,mh({},H,{navigate:!1,fetcherKey:l}))},[l,O]),$=Lt.useMemo(()=>Lt.forwardRef((H,te)=>Lt.createElement(mF,mh({},H,{navigate:!1,fetcherKey:l,ref:te}))),[l]),Y=s.fetchers.get(l)||HO,re=u.get(l);return Lt.useMemo(()=>mh({Form:$,submit:j,load:P},Y,{data:re}),[$,j,P,Y,re])}function MY(){let t=MC(N5.UseFetchers);return Array.from(t.fetchers.entries()).map(e=>{let[n,r]=e;return mh({},r,{key:n})})}const FP="react-router-scroll-positions";let $4={};function vF(t){let{getKey:e,storageKey:n}=t===void 0?{}:t,{router:r}=DT(db.UseScrollRestoration),{restoreScrollPosition:s,preventScrollReset:u}=MC(N5.UseScrollRestoration),{basename:p}=Lt.useContext(wp),g=Ep(),l=oF(),E=sF();Lt.useEffect(()=>(window.history.scrollRestoration="manual",()=>{window.history.scrollRestoration="auto"}),[]),CY(Lt.useCallback(()=>{if(E.state==="idle"){let P=(e?e(g,l):null)||g.key;$4[P]=window.scrollY}try{sessionStorage.setItem(n||FP,JSON.stringify($4))}catch{}window.history.scrollRestoration="auto"},[n,e,E.state,g,l])),typeof document<"u"&&(Lt.useLayoutEffect(()=>{try{let P=sessionStorage.getItem(n||FP);P&&($4=JSON.parse(P))}catch{}},[n]),Lt.useLayoutEffect(()=>{let P=e&&p!=="/"?(j,$)=>e(mh({},j,{pathname:nd(j.pathname,p)||j.pathname}),$):e,O=r==null?void 0:r.enableScrollRestoration($4,()=>window.scrollY,P);return()=>O&&O()},[r,p,e]),Lt.useLayoutEffect(()=>{if(s!==!1){if(typeof s=="number"){window.scrollTo(0,s);return}if(g.hash){let P=document.getElementById(decodeURIComponent(g.hash.slice(1)));if(P){P.scrollIntoView();return}}u!==!0&&window.scrollTo(0,0)}},[g,s,u]))}function kY(t,e){let{capture:n}=e||{};Lt.useEffect(()=>{let r=n!=null?{capture:n}:void 0;return window.addEventListener("beforeunload",t,r),()=>{window.removeEventListener("beforeunload",t,r)}},[t,n])}function CY(t,e){let{capture:n}=e||{};Lt.useEffect(()=>{let r=n!=null?{capture:n}:void 0;return window.addEventListener("pagehide",t,r),()=>{window.removeEventListener("pagehide",t,r)}},[t,n])}function IY(t){let{when:e,message:n}=t,r=uF(e);Lt.useEffect(()=>{r.state==="blocked"&&(window.confirm(n)?setTimeout(r.proceed,0):r.reset())},[r,n]),Lt.useEffect(()=>{r.state==="blocked"&&!e&&r.reset()},[r,e])}function xF(t,e){e===void 0&&(e={});let n=Lt.useContext(EC);n==null&&Ti(!1);let{basename:r}=DT(db.useViewTransitionState),s=Kb(t,{relative:e.relative});if(!n.isTransitioning)return!1;let u=nd(n.currentLocation.pathname,r)||n.currentLocation.pathname,p=nd(n.nextLocation.pathname,r)||n.nextLocation.pathname;return P5(s.pathname,p)!=null||P5(s.pathname,u)!=null}const AY=Object.freeze(Object.defineProperty({__proto__:null,AbortedDeferredError:cS,Await:HZ,BrowserRouter:mY,Form:mF,HashRouter:gY,Link:TC,MemoryRouter:jZ,NavLink:xY,Navigate:VZ,get NavigationType(){return $o},Outlet:cF,Route:hF,Router:Jb,RouterProvider:pF,Routes:GZ,ScrollRestoration:bY,UNSAFE_DataRouterContext:Zb,UNSAFE_DataRouterStateContext:f9,UNSAFE_FetchersContext:SC,UNSAFE_LocationContext:Yb,UNSAFE_NavigationContext:wp,UNSAFE_RouteContext:md,UNSAFE_ViewTransitionContext:EC,UNSAFE_useRouteId:iF,UNSAFE_useScrollRestoration:vF,createBrowserRouter:dF,createHashRouter:lY,createMemoryRouter:ZZ,createPath:cp,createRoutesFromChildren:R5,createRoutesFromElements:R5,createSearchParams:dS,defer:iZ,generatePath:qX,isRouteErrorResponse:yC,json:eZ,matchPath:P5,matchRoutes:I1,parsePath:ff,redirect:mC,redirectDocument:sZ,renderMatches:XZ,resolvePath:jO,unstable_HistoryRouter:yY,unstable_usePrompt:IY,unstable_useViewTransitionState:xF,useActionData:OZ,useAsyncError:FZ,useAsyncValue:lF,useBeforeUnload:kY,useBlocker:uF,useFetcher:TY,useFetchers:MY,useFormAction:_F,useHref:KO,useInRouterContext:Zy,useLinkClickHandler:gF,useLoaderData:NZ,useLocation:Ep,useMatch:TZ,useMatches:oF,useNavigate:LT,useNavigation:sF,useNavigationType:SZ,useOutlet:eF,useOutletContext:kZ,useParams:PT,useResolvedPath:Kb,useRevalidator:RZ,useRouteError:aF,useRouteLoaderData:DZ,useRoutes:tF,useSearchParams:wY,useSubmit:kC},Symbol.toStringTag,{value:"Module"}));function np(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(s){return"'"+s+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Oy(t){return!!t&&!!t[Ea]}function qg(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var s=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return s===Object||typeof s=="function"&&Function.toString.call(s)===BY}(t)||Array.isArray(t)||!!t[HP]||!!(!((e=t.constructor)===null||e===void 0)&&e[HP])||CC(t)||IC(t))}function W1(t,e,n){n===void 0&&(n=!1),Qb(t)===0?(n?Object.keys:eb)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,s){return e(s,r,t)})}function Qb(t){var e=t[Ea];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:CC(t)?2:IC(t)?3:0}function Qx(t,e){return Qb(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function LY(t,e){return Qb(t)===2?t.get(e):t[e]}function bF(t,e,n){var r=Qb(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function wF(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function CC(t){return FY&&t instanceof Map}function IC(t){return zY&&t instanceof Set}function _1(t){return t.o||t.t}function AC(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=SF(t);delete e[Ea];for(var n=eb(e),r=0;r<n.length;r++){var s=n[r],u=e[s];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(e[s]={configurable:!0,writable:!0,enumerable:u.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function LC(t,e){return e===void 0&&(e=!1),PC(t)||Oy(t)||!qg(t)||(Qb(t)>1&&(t.set=t.add=t.clear=t.delete=PY),Object.freeze(t),e&&W1(t,function(n,r){return LC(r,!0)},!0)),t}function PY(){np(2)}function PC(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Im(t){var e=Dk[t];return e||np(18,t),e}function RY(t,e){Dk[t]||(Dk[t]=e)}function Pk(){return D5}function Q6(t,e){e&&(Im("Patches"),t.u=[],t.s=[],t.v=e)}function fS(t){Rk(t),t.p.forEach(NY),t.p=null}function Rk(t){t===D5&&(D5=t.l)}function zP(t){return D5={p:[],l:D5,h:t,m:!0,_:0}}function NY(t){var e=t[Ea];e.i===0||e.i===1?e.j():e.g=!0}function e7(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.O||Im("ES5").S(e,t,r),r?(n[Ea].P&&(fS(e),np(4)),qg(t)&&(t=pS(e,t),e.l||mS(e,t)),e.u&&Im("Patches").M(n[Ea].t,t,e.u,e.s)):t=pS(e,n,[]),fS(e),e.u&&e.v(e.u,e.s),t!==EF?t:void 0}function pS(t,e,n){if(PC(e))return e;var r=e[Ea];if(!r)return W1(e,function(g,l){return BP(t,r,e,g,l,n)},!0),e;if(r.A!==t)return e;if(!r.P)return mS(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var s=r.i===4||r.i===5?r.o=AC(r.k):r.o,u=s,p=!1;r.i===3&&(u=new Set(s),s.clear(),p=!0),W1(u,function(g,l){return BP(t,r,s,g,l,n,p)}),mS(t,s,!1),n&&t.u&&Im("Patches").N(r,n,t.u,t.s)}return r.o}function BP(t,e,n,r,s,u,p){if(Oy(s)){var g=pS(t,s,u&&e&&e.i!==3&&!Qx(e.R,r)?u.concat(r):void 0);if(bF(n,r,g),!Oy(g))return;t.m=!1}else p&&n.add(s);if(qg(s)&&!PC(s)){if(!t.h.D&&t._<1)return;pS(t,s),e&&e.A.l||mS(t,s)}}function mS(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&LC(e,n)}function t7(t,e){var n=t[Ea];return(n?_1(n):t)[e]}function UP(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function py(t){t.P||(t.P=!0,t.l&&py(t.l))}function n7(t){t.o||(t.o=AC(t.t))}function Nk(t,e,n){var r=CC(e)?Im("MapSet").F(e,n):IC(e)?Im("MapSet").T(e,n):t.O?function(s,u){var p=Array.isArray(s),g={i:p?1:0,A:u?u.A:Pk(),P:!1,I:!1,R:{},l:u,t:s,k:null,o:null,j:null,C:!1},l=g,E=O5;p&&(l=[g],E=Vw);var P=Proxy.revocable(l,E),O=P.revoke,j=P.proxy;return g.k=j,g.j=O,j}(e,n):Im("ES5").J(e,n);return(n?n.A:Pk()).p.push(r),r}function DY(t){return Oy(t)||np(22,t),function e(n){if(!qg(n))return n;var r,s=n[Ea],u=Qb(n);if(s){if(!s.P&&(s.i<4||!Im("ES5").K(s)))return s.t;s.I=!0,r=jP(n,u),s.I=!1}else r=jP(n,u);return W1(r,function(p,g){s&&LY(s.t,p)===g||bF(r,p,e(g))}),u===3?new Set(r):r}(t)}function jP(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return AC(t)}function OY(){function t(u,p){var g=s[u];return g?g.enumerable=p:s[u]=g={configurable:!0,enumerable:p,get:function(){var l=this[Ea];return O5.get(l,u)},set:function(l){var E=this[Ea];O5.set(E,u,l)}},g}function e(u){for(var p=u.length-1;p>=0;p--){var g=u[p][Ea];if(!g.P)switch(g.i){case 5:r(g)&&py(g);break;case 4:n(g)&&py(g)}}}function n(u){for(var p=u.t,g=u.k,l=eb(g),E=l.length-1;E>=0;E--){var P=l[E];if(P!==Ea){var O=p[P];if(O===void 0&&!Qx(p,P))return!0;var j=g[P],$=j&&j[Ea];if($?$.t!==O:!wF(j,O))return!0}}var Y=!!p[Ea];return l.length!==eb(p).length+(Y?0:1)}function r(u){var p=u.k;if(p.length!==u.t.length)return!0;var g=Object.getOwnPropertyDescriptor(p,p.length-1);if(g&&!g.get)return!0;for(var l=0;l<p.length;l++)if(!p.hasOwnProperty(l))return!0;return!1}var s={};RY("ES5",{J:function(u,p){var g=Array.isArray(u),l=function(P,O){if(P){for(var j=Array(O.length),$=0;$<O.length;$++)Object.defineProperty(j,""+$,t($,!0));return j}var Y=SF(O);delete Y[Ea];for(var re=eb(Y),_e=0;_e<re.length;_e++){var J=re[_e];Y[J]=t(J,P||!!Y[J].enumerable)}return Object.create(Object.getPrototypeOf(O),Y)}(g,u),E={i:g?5:4,A:p?p.A:Pk(),P:!1,I:!1,R:{},l:p,t:u,k:l,o:null,g:!1,C:!1};return Object.defineProperty(l,Ea,{value:E,writable:!0}),l},S:function(u,p,g){g?Oy(p)&&p[Ea].A===u&&e(u.p):(u.u&&function l(E){if(E&&typeof E=="object"){var P=E[Ea];if(P){var O=P.t,j=P.k,$=P.R,Y=P.i;if(Y===4)W1(j,function(te){te!==Ea&&(O[te]!==void 0||Qx(O,te)?$[te]||l(j[te]):($[te]=!0,py(P)))}),W1(O,function(te){j[te]!==void 0||Qx(j,te)||($[te]=!1,py(P))});else if(Y===5){if(r(P)&&(py(P),$.length=!0),j.length<O.length)for(var re=j.length;re<O.length;re++)$[re]=!1;else for(var _e=O.length;_e<j.length;_e++)$[_e]=!0;for(var J=Math.min(j.length,O.length),H=0;H<J;H++)j.hasOwnProperty(H)||($[H]=!0),$[H]===void 0&&l(j[H])}}}}(u.p[0]),e(u.p))},K:function(u){return u.i===4?n(u):r(u)}})}var VP,D5,RC=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",FY=typeof Map<"u",zY=typeof Set<"u",GP=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",EF=RC?Symbol.for("immer-nothing"):((VP={})["immer-nothing"]=!0,VP),HP=RC?Symbol.for("immer-draftable"):"__$immer_draftable",Ea=RC?Symbol.for("immer-state"):"__$immer_state",BY=""+Object.prototype.constructor,eb=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,SF=Object.getOwnPropertyDescriptors||function(t){var e={};return eb(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},Dk={},O5={get:function(t,e){if(e===Ea)return t;var n=_1(t);if(!Qx(n,e))return function(s,u,p){var g,l=UP(u,p);return l?"value"in l?l.value:(g=l.get)===null||g===void 0?void 0:g.call(s.k):void 0}(t,n,e);var r=n[e];return t.I||!qg(r)?r:r===t7(t.t,e)?(n7(t),t.o[e]=Nk(t.A.h,r,t)):r},has:function(t,e){return e in _1(t)},ownKeys:function(t){return Reflect.ownKeys(_1(t))},set:function(t,e,n){var r=UP(_1(t),e);if(r!=null&&r.set)return r.set.call(t.k,n),!0;if(!t.P){var s=t7(_1(t),e),u=s==null?void 0:s[Ea];if(u&&u.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(wF(n,s)&&(n!==void 0||Qx(t.t,e)))return!0;n7(t),py(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return t7(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,n7(t),py(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=_1(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){np(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){np(12)}},Vw={};W1(O5,function(t,e){Vw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Vw.deleteProperty=function(t,e){return Vw.set.call(this,t,e,void 0)},Vw.set=function(t,e,n){return O5.set.call(this,t[0],e,n,t[0])};var UY=function(){function t(n){var r=this;this.O=GP,this.D=!0,this.produce=function(s,u,p){if(typeof s=="function"&&typeof u!="function"){var g=u;u=s;var l=r;return function(re){var _e=this;re===void 0&&(re=g);for(var J=arguments.length,H=Array(J>1?J-1:0),te=1;te<J;te++)H[te-1]=arguments[te];return l.produce(re,function(ce){var Se;return(Se=u).call.apply(Se,[_e,ce].concat(H))})}}var E;if(typeof u!="function"&&np(6),p!==void 0&&typeof p!="function"&&np(7),qg(s)){var P=zP(r),O=Nk(r,s,void 0),j=!0;try{E=u(O),j=!1}finally{j?fS(P):Rk(P)}return typeof Promise<"u"&&E instanceof Promise?E.then(function(re){return Q6(P,p),e7(re,P)},function(re){throw fS(P),re}):(Q6(P,p),e7(E,P))}if(!s||typeof s!="object"){if((E=u(s))===void 0&&(E=s),E===EF&&(E=void 0),r.D&&LC(E,!0),p){var $=[],Y=[];Im("Patches").M(s,E,$,Y),p($,Y)}return E}np(21,s)},this.produceWithPatches=function(s,u){if(typeof s=="function")return function(E){for(var P=arguments.length,O=Array(P>1?P-1:0),j=1;j<P;j++)O[j-1]=arguments[j];return r.produceWithPatches(E,function($){return s.apply(void 0,[$].concat(O))})};var p,g,l=r.produce(s,u,function(E,P){p=E,g=P});return typeof Promise<"u"&&l instanceof Promise?l.then(function(E){return[E,p,g]}):[l,p,g]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){qg(n)||np(8),Oy(n)&&(n=DY(n));var r=zP(this),s=Nk(this,n,void 0);return s[Ea].C=!0,Rk(r),s},e.finishDraft=function(n,r){var s=n&&n[Ea],u=s.A;return Q6(u,r),e7(void 0,u)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!GP&&np(20),this.O=n},e.applyPatches=function(n,r){var s;for(s=r.length-1;s>=0;s--){var u=r[s];if(u.path.length===0&&u.op==="replace"){n=u.value;break}}s>-1&&(r=r.slice(s+1));var p=Im("Patches").$;return Oy(n)?p(n,r):this.produce(n,function(g){return p(g,r)})},t}(),rd=new UY,TF=rd.produce;rd.produceWithPatches.bind(rd);rd.setAutoFreeze.bind(rd);rd.setUseProxies.bind(rd);rd.applyPatches.bind(rd);rd.createDraft.bind(rd);rd.finishDraft.bind(rd);function F5(t){"@babel/helpers - typeof";return F5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F5(t)}function jY(t,e){if(F5(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(F5(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VY(t){var e=jY(t,"string");return F5(e)==="symbol"?e:String(e)}function GY(t,e,n){return e=VY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WP(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function qP(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WP(Object(n),!0).forEach(function(r){GY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WP(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nc(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var $P=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),r7=function(){return Math.random().toString(36).substring(7).split("").join(".")},gS={INIT:"@@redux/INIT"+r7(),REPLACE:"@@redux/REPLACE"+r7(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+r7()}};function HY(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function MF(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(nc(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(nc(1));return n(MF)(t,e)}if(typeof t!="function")throw new Error(nc(2));var s=t,u=e,p=[],g=p,l=!1;function E(){g===p&&(g=p.slice())}function P(){if(l)throw new Error(nc(3));return u}function O(re){if(typeof re!="function")throw new Error(nc(4));if(l)throw new Error(nc(5));var _e=!0;return E(),g.push(re),function(){if(_e){if(l)throw new Error(nc(6));_e=!1,E();var H=g.indexOf(re);g.splice(H,1),p=null}}}function j(re){if(!HY(re))throw new Error(nc(7));if(typeof re.type>"u")throw new Error(nc(8));if(l)throw new Error(nc(9));try{l=!0,u=s(u,re)}finally{l=!1}for(var _e=p=g,J=0;J<_e.length;J++){var H=_e[J];H()}return re}function $(re){if(typeof re!="function")throw new Error(nc(10));s=re,j({type:gS.REPLACE})}function Y(){var re,_e=O;return re={subscribe:function(H){if(typeof H!="object"||H===null)throw new Error(nc(11));function te(){H.next&&H.next(P())}te();var ce=_e(te);return{unsubscribe:ce}}},re[$P]=function(){return this},re}return j({type:gS.INIT}),r={dispatch:j,subscribe:O,getState:P,replaceReducer:$},r[$P]=Y,r}function WY(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:gS.INIT});if(typeof r>"u")throw new Error(nc(12));if(typeof n(void 0,{type:gS.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(nc(13))})}function qY(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var s=e[r];typeof t[s]=="function"&&(n[s]=t[s])}var u=Object.keys(n),p;try{WY(n)}catch(g){p=g}return function(l,E){if(l===void 0&&(l={}),p)throw p;for(var P=!1,O={},j=0;j<u.length;j++){var $=u[j],Y=n[$],re=l[$],_e=Y(re,E);if(typeof _e>"u")throw E&&E.type,new Error(nc(14));O[$]=_e,P=P||_e!==re}return P=P||u.length!==Object.keys(l).length,P?O:l}}function yS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,s){return function(){return r(s.apply(void 0,arguments))}})}function $Y(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var s=r.apply(void 0,arguments),u=function(){throw new Error(nc(15))},p={getState:s.getState,dispatch:function(){return u.apply(void 0,arguments)}},g=e.map(function(l){return l(p)});return u=yS.apply(void 0,g)(s.dispatch),qP(qP({},s),{},{dispatch:u})}}}function kF(t){var e=function(r){var s=r.dispatch,u=r.getState;return function(p){return function(g){return typeof g=="function"?g(s,u,t):p(g)}}};return e}var CF=kF();CF.withExtraArgument=kF;const XP=CF;var IF=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(r[u]=s[u])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),XY=function(t,e){var n={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},r,s,u,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(E){return function(P){return l([E,P])}}function l(E){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(u=E[0]&2?s.return:E[0]?s.throw||((u=s.return)&&u.call(s),0):s.next)&&!(u=u.call(s,E[1])).done)return u;switch(s=0,u&&(E=[E[0]&2,u.value]),E[0]){case 0:case 1:u=E;break;case 4:return n.label++,{value:E[1],done:!1};case 5:n.label++,s=E[1],E=[0];continue;case 7:E=n.ops.pop(),n.trys.pop();continue;default:if(u=n.trys,!(u=u.length>0&&u[u.length-1])&&(E[0]===6||E[0]===2)){n=0;continue}if(E[0]===3&&(!u||E[1]>u[0]&&E[1]<u[3])){n.label=E[1];break}if(E[0]===6&&n.label<u[1]){n.label=u[1],u=E;break}if(u&&n.label<u[2]){n.label=u[2],n.ops.push(E);break}u[2]&&n.ops.pop(),n.trys.pop();continue}E=e.call(t,n)}catch(P){E=[6,P],s=0}finally{r=u=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},fb=function(t,e){for(var n=0,r=e.length,s=t.length;n<r;n++,s++)t[s]=e[n];return t},ZY=Object.defineProperty,YY=Object.defineProperties,KY=Object.getOwnPropertyDescriptors,ZP=Object.getOwnPropertySymbols,JY=Object.prototype.hasOwnProperty,QY=Object.prototype.propertyIsEnumerable,YP=function(t,e,n){return e in t?ZY(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Cy=function(t,e){for(var n in e||(e={}))JY.call(e,n)&&YP(t,n,e[n]);if(ZP)for(var r=0,s=ZP(e);r<s.length;r++){var n=s[r];QY.call(e,n)&&YP(t,n,e[n])}return t},i7=function(t,e){return YY(t,KY(e))},eK=function(t,e,n){return new Promise(function(r,s){var u=function(l){try{g(n.next(l))}catch(E){s(E)}},p=function(l){try{g(n.throw(l))}catch(E){s(E)}},g=function(l){return l.done?r(l.value):Promise.resolve(l.value).then(u,p)};g((n=n.apply(t,e)).next())})},tK=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?yS:yS.apply(null,arguments)};function nK(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}function Iy(t,e){function n(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(e){var u=e.apply(void 0,r);if(!u)throw new Error("prepareAction did not return an object");return Cy(Cy({type:t,payload:u.payload},"meta"in u&&{meta:u.meta}),"error"in u&&{error:u.error})}return{type:t,payload:r[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(r){return r.type===t},n}var rK=function(t){IF(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=t.apply(this,n)||this;return Object.setPrototypeOf(s,e.prototype),s}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,fb([void 0],n[0].concat(this)))):new(e.bind.apply(e,fb([void 0],n.concat(this))))},e}(Array),iK=function(t){IF(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=t.apply(this,n)||this;return Object.setPrototypeOf(s,e.prototype),s}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,fb([void 0],n[0].concat(this)))):new(e.bind.apply(e,fb([void 0],n.concat(this))))},e}(Array);function Ok(t){return qg(t)?TF(t,function(){}):t}function sK(t){return typeof t=="boolean"}function oK(){return function(e){return aK(e)}}function aK(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck,t.actionCreatorCheck;var r=new rK;return n&&(sK(n)?r.push(XP):r.push(XP.withExtraArgument(n.extraArgument))),r}var lK=!0;function uK(t){var e=oK(),n=t||{},r=n.reducer,s=r===void 0?void 0:r,u=n.middleware,p=u===void 0?e():u,g=n.devTools,l=g===void 0?!0:g,E=n.preloadedState,P=E===void 0?void 0:E,O=n.enhancers,j=O===void 0?void 0:O,$;if(typeof s=="function")$=s;else if(nK(s))$=qY(s);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var Y=p;typeof Y=="function"&&(Y=Y(e));var re=$Y.apply(void 0,Y),_e=yS;l&&(_e=tK(Cy({trace:!lK},typeof l=="object"&&l)));var J=new iK(re),H=J;Array.isArray(j)?H=fb([re],j):typeof j=="function"&&(H=j(J));var te=_e.apply(void 0,H);return MF($,P,te)}function AF(t){var e={},n=[],r,s={addCase:function(u,p){var g=typeof u=="string"?u:u.type;if(!g)throw new Error("`builder.addCase` cannot be called with an empty action type");if(g in e)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return e[g]=p,s},addMatcher:function(u,p){return n.push({matcher:u,reducer:p}),s},addDefaultCase:function(u){return r=u,s}};return t(s),[e,n,r]}function cK(t){return typeof t=="function"}function hK(t,e,n,r){n===void 0&&(n=[]);var s=typeof e=="function"?AF(e):[e,n,r],u=s[0],p=s[1],g=s[2],l;if(cK(t))l=function(){return Ok(t())};else{var E=Ok(t);l=function(){return E}}function P(O,j){O===void 0&&(O=l());var $=fb([u[j.type]],p.filter(function(Y){var re=Y.matcher;return re(j)}).map(function(Y){var re=Y.reducer;return re}));return $.filter(function(Y){return!!Y}).length===0&&($=[g]),$.reduce(function(Y,re){if(re)if(Oy(Y)){var _e=Y,J=re(_e,j);return J===void 0?Y:J}else{if(qg(Y))return TF(Y,function(H){return re(H,j)});var J=re(Y,j);if(J===void 0){if(Y===null)return Y;throw Error("A case reducer on a non-draftable value must not return undefined")}return J}return Y},O)}return P.getInitialState=l,P}function dK(t,e){return t+"/"+e}function fK(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof t.initialState=="function"?t.initialState:Ok(t.initialState),r=t.reducers||{},s=Object.keys(r),u={},p={},g={};s.forEach(function(P){var O=r[P],j=dK(e,P),$,Y;"reducer"in O?($=O.reducer,Y=O.prepare):$=O,u[P]=$,p[j]=$,g[P]=Y?Iy(j,Y):Iy(j)});function l(){var P=typeof t.extraReducers=="function"?AF(t.extraReducers):[t.extraReducers],O=P[0],j=O===void 0?{}:O,$=P[1],Y=$===void 0?[]:$,re=P[2],_e=re===void 0?void 0:re,J=Cy(Cy({},j),p);return hK(n,function(H){for(var te in J)H.addCase(te,J[te]);for(var ce=0,Se=Y;ce<Se.length;ce++){var Ie=Se[ce];H.addMatcher(Ie.matcher,Ie.reducer)}_e&&H.addDefaultCase(_e)})}var E;return{name:e,reducer:function(P,O){return E||(E=l()),E(P,O)},actions:g,caseReducers:u,getInitialState:function(){return E||(E=l()),E.getInitialState()}}}var pK="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",mK=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=pK[Math.random()*64|0];return e},gK=["name","message","stack","code"],s7=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),KP=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),yK=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,r=gK;n<r.length;n++){var s=r[n];typeof t[s]=="string"&&(e[s]=t[s])}return e}return{message:String(t)}};(function(){function t(e,n,r){var s=Iy(e+"/fulfilled",function(E,P,O,j){return{payload:E,meta:i7(Cy({},j||{}),{arg:O,requestId:P,requestStatus:"fulfilled"})}}),u=Iy(e+"/pending",function(E,P,O){return{payload:void 0,meta:i7(Cy({},O||{}),{arg:P,requestId:E,requestStatus:"pending"})}}),p=Iy(e+"/rejected",function(E,P,O,j,$){return{payload:j,error:(r&&r.serializeError||yK)(E||"Rejected"),meta:i7(Cy({},$||{}),{arg:O,requestId:P,rejectedWithValue:!!j,requestStatus:"rejected",aborted:(E==null?void 0:E.name)==="AbortError",condition:(E==null?void 0:E.name)==="ConditionError"})}}),g=typeof AbortController<"u"?AbortController:function(){function E(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return E.prototype.abort=function(){},E}();function l(E){return function(P,O,j){var $=r!=null&&r.idGenerator?r.idGenerator(E):mK(),Y=new g,re;function _e(H){re=H,Y.abort()}var J=function(){return eK(this,null,function(){var H,te,ce,Se,Ie,Ne,ut;return XY(this,function(mt){switch(mt.label){case 0:return mt.trys.push([0,4,,5]),Se=(H=r==null?void 0:r.condition)==null?void 0:H.call(r,E,{getState:O,extra:j}),vK(Se)?[4,Se]:[3,2];case 1:Se=mt.sent(),mt.label=2;case 2:if(Se===!1||Y.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return Ie=new Promise(function(We,Ot){return Y.signal.addEventListener("abort",function(){return Ot({name:"AbortError",message:re||"Aborted"})})}),P(u($,E,(te=r==null?void 0:r.getPendingMeta)==null?void 0:te.call(r,{requestId:$,arg:E},{getState:O,extra:j}))),[4,Promise.race([Ie,Promise.resolve(n(E,{dispatch:P,getState:O,extra:j,requestId:$,signal:Y.signal,abort:_e,rejectWithValue:function(We,Ot){return new s7(We,Ot)},fulfillWithValue:function(We,Ot){return new KP(We,Ot)}})).then(function(We){if(We instanceof s7)throw We;return We instanceof KP?s(We.payload,$,E,We.meta):s(We,$,E)})])];case 3:return ce=mt.sent(),[3,5];case 4:return Ne=mt.sent(),ce=Ne instanceof s7?p(null,$,E,Ne.payload,Ne.meta):p(Ne,$,E),[3,5];case 5:return ut=r&&!r.dispatchConditionRejection&&p.match(ce)&&ce.meta.condition,ut||P(ce),[2,ce]}})})}();return Object.assign(J,{abort:_e,requestId:$,arg:E,unwrap:function(){return J.then(_K)}})}}return Object.assign(l,{pending:u,rejected:p,fulfilled:s,typePrefix:e})}return t.withTypes=function(){return t},t})();function _K(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function vK(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var NC="listenerMiddleware";Iy(NC+"/add");Iy(NC+"/removeAll");Iy(NC+"/remove");var JP;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);OY();const xK={intersection:null,dialog:null},LF=fK({name:"map",initialState:xK,reducers:{setIntersection:(t,e)=>({...t,intersection:e.payload}),toggleDialog:(t,e)=>({...t,dialog:e.payload})}}),{setIntersection:QP,toggleDialog:eR}=LF.actions,bK=LF.reducer,Gw=uK({reducer:{map:bK}}),wK="_app_1udmy_1",EK="_container_1udmy_7",SK="_banner_1udmy_12",TK={app:wK,container:EK,banner:SK};var wa={},OT={},PF={exports:{}},MK="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",kK=MK,CK=kK;function RF(){}function NF(){}NF.resetWarningCache=RF;var IK=function(){function t(r,s,u,p,g,l){if(l!==CK){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:NF,resetWarningCache:RF};return n.PropTypes=n,n};PF.exports=IK();var _o=PF.exports;const DF="_flex_1no6c_59",OF="_accordion_1no6c_164",FF="_panel_1no6c_173",zF="_content_1no6c_174",BF="_primary_1no6c_177",UF="_success_1no6c_185",jF="_warning_1no6c_193",VF="_info_1no6c_201",GF="_lightCyan_1no6c_208",HF="_orange_1no6c_215",WF="_lightOrange_1no6c_223",qF="_lime_1no6c_230",$F="_lightLime_1no6c_238",XF="_panelText_1no6c_276",ZF="_panelChevron_1no6c_282",YF="_expanded_1no6c_308",KF="_initialized_1no6c_324",JF="_hide_1no6c_1",QF="_show_1no6c_1",AK={flex:DF,"main-content":"_main-content_1no6c_86",accordion:OF,default:"_default_1no6c_170",panel:FF,content:zF,primary:BF,success:UF,warning:jF,info:VF,lightCyan:GF,orange:HF,lightOrange:WF,lime:qF,lightLime:$F,panelText:XF,panelChevron:ZF,expanded:YF,initialized:KF,hide:JF,show:QF},LK=Object.freeze(Object.defineProperty({__proto__:null,accordion:OF,content:zF,default:AK,expanded:YF,flex:DF,hide:JF,info:VF,initialized:KF,lightCyan:GF,lightLime:$F,lightOrange:WF,lime:qF,orange:HF,panel:FF,panelChevron:ZF,panelText:XF,primary:BF,show:QF,success:UF,warning:jF},Symbol.toStringTag,{value:"Module"})),PK=Ls(LK);Object.defineProperty(OT,"__esModule",{value:!0});OT.default=void 0;var J0=RK(Lt),wx=ez(_o),Cg=ez(PK);function ez(t){return t&&t.__esModule?t:{default:t}}function tz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(tz=function(r){return r?n:e})(t)}function RK(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=tz(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}const DC=t=>{const[e,n]=(0,J0.useState)(t.expanded),[r,s]=(0,J0.useState)(t.initialized),u=()=>{n(!e),s(!0),t.onToggleExpand&&t.onToggleExpand()};(0,J0.useEffect)(()=>{n(t.expanded)},[t.expanded]);const p=()=>J0.default.createElement("button",{className:Cg.default.panel,onClick:u,"aria-expanded":e?"true":"false"},J0.default.createElement("span",{className:Cg.default.panelText},t.title),J0.default.createElement("span",{className:"".concat(Cg.default.panelChevron," ").concat(e?Cg.default.expanded:"")})),g="".concat(Cg.default.accordion," ").concat(t.color?Cg.default[t.color]:"");return J0.default.createElement("div",{className:g},p(),J0.default.createElement("div",{className:"".concat(Cg.default.content," ").concat(r?Cg.default.initialized:""," ").concat(e?Cg.default.expanded:"")},t.children))};DC.propTypes={title:wx.default.string,titleSize:wx.default.oneOf(["regular","large"]),content:wx.default.string,color:wx.default.oneOf(["default","primary","success","warning","info","lightCyan","orange","lightOrange","lime","lightLime"]),expanded:wx.default.bool,onToggleExpand:wx.default.func};DC.defaultProps={title:null,titleSize:"regular",href:null,content:"",color:"default",expanded:!1};OT.default=DC;var e3={},ao={};Object.defineProperty(ao,"__esModule",{value:!0});ao.getThemeTextColor=ao.getThemePaletteTextColor=ao.getThemePaletteBorderColor=ao.getThemePaletteBackgroundColor=ao.getThemeNavigationBarTextColor=ao.getThemeNavigationBarBackgroundColor=ao.getThemeLogoPadding=ao.getThemeLogo=ao.getThemeLinkColor=ao.getThemeAppName=void 0;const NK=(t,e)=>{var n;return(t==null||(n=t.colors)===null||n===void 0||(n=n.palette)===null||n===void 0||(n=n[e])===null||n===void 0?void 0:n.background)||null};ao.getThemePaletteBackgroundColor=NK;const DK=(t,e)=>{var n;return(t==null||(n=t.colors)===null||n===void 0||(n=n.palette)===null||n===void 0||(n=n[e])===null||n===void 0?void 0:n.text)||null};ao.getThemePaletteTextColor=DK;const OK=(t,e)=>{var n;return(t==null||(n=t.colors)===null||n===void 0||(n=n.palette)===null||n===void 0||(n=n[e])===null||n===void 0?void 0:n.border)||null};ao.getThemePaletteBorderColor=OK;const FK=t=>{var e;return(t==null||(e=t.colors)===null||e===void 0||(e=e.navigationBar)===null||e===void 0?void 0:e.background)||null};ao.getThemeNavigationBarBackgroundColor=FK;const zK=t=>{var e;return(t==null||(e=t.colors)===null||e===void 0||(e=e.navigationBar)===null||e===void 0?void 0:e.text)||null};ao.getThemeNavigationBarTextColor=zK;const BK=t=>(t==null?void 0:t.logo)||null;ao.getThemeLogo=BK;const UK=t=>(t==null?void 0:t.logoPadding)||null;ao.getThemeLogoPadding=UK;const jK=t=>(t==null?void 0:t.appName)||null;ao.getThemeAppName=jK;const VK=t=>{var e;return(t==null||(e=t.colors)===null||e===void 0?void 0:e.text)||null};ao.getThemeTextColor=VK;const GK=t=>{var e;return(t==null||(e=t.colors)===null||e===void 0?void 0:e.link)||null};ao.getThemeLinkColor=GK;var fl={};Object.defineProperty(fl,"__esModule",{value:!0});fl.setFocusToElement=fl.getFocusableElementsInsideElement=fl.cloneThroughFragments=fl.classNameArrayToClassNameString=fl.addFocusTrapInsideElement=void 0;var X4=Lt;const HK=t=>{var e;return(t==null||(e=t.filter(n=>n))===null||e===void 0?void 0:e.join(" "))||""};fl.classNameArrayToClassNameString=HK;const nz=t=>X4.Children.map(t,e=>(0,X4.isValidElement)(e)?e.type===X4.Fragment?nz(e.props.children):(0,X4.cloneElement)(e,{...e.props}):e);fl.cloneThroughFragments=nz;const rz=t=>{const e=document.createElement("button");t.prepend(e),e.focus(),e.remove()};fl.setFocusToElement=rz;const iz=t=>Array.from(t.querySelectorAll('button, [href], input, [tabindex="0"]')).filter(e=>e);fl.getFocusableElementsInsideElement=iz;const WK=t=>{rz(t);const e=iz(t),n=e!=null&&e.length?e[0]:null,r=(e==null?void 0:e.length)>1?e[e.length-1]:n;n&&(n.onkeydown=s=>{s.keyCode===9&&s.shiftKey&&r.focus()}),r&&(r.onclick=()=>{n.focus()},r.onkeydown=s=>{s.keyCode===9&&!s.shiftKey&&(s.preventDefault(),n.focus())})};fl.addFocusTrapInsideElement=WK;const sz="_flex_dasn7_59",oz="_button_dasn7_258",az="_hasTheme_dasn7_288",lz="_regular_dasn7_300",uz="_small_dasn7_308",cz="_noHover_dasn7_323",hz="_primary_dasn7_330",dz="_disabled_dasn7_341",fz="_hasErrors_dasn7_381",pz="_rounded_dasn7_387",mz="_hasArrowLeft_dasn7_390",gz="_pushprev_dasn7_1",yz="_hasArrowRight_dasn7_424",_z="_pushnext_dasn7_1",qK={flex:sz,"main-content":"_main-content_dasn7_86",button:oz,hasTheme:az,regular:lz,small:uz,default:"_default_dasn7_319",noHover:cz,primary:hz,disabled:dz,hasErrors:fz,rounded:pz,hasArrowLeft:mz,pushprev:gz,hasArrowRight:yz,pushnext:_z},$K=Object.freeze(Object.defineProperty({__proto__:null,button:oz,default:qK,disabled:dz,flex:sz,hasArrowLeft:mz,hasArrowRight:yz,hasErrors:fz,hasTheme:az,noHover:cz,primary:hz,pushnext:_z,pushprev:gz,regular:lz,rounded:pz,small:uz},Symbol.toStringTag,{value:"Module"})),XK=Ls($K),vz=Ls(AY);Object.defineProperty(e3,"__esModule",{value:!0});e3.default=void 0;var lm=YK(Lt),ec=xz(_o),Z4=ao,tR=fl,um=xz(XK),ZK=vz;function xz(t){return t&&t.__esModule?t:{default:t}}function bz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(bz=function(r){return r?n:e})(t)}function YK(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=bz(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function x1(){return x1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},x1.apply(this,arguments)}const OC=t=>{var e,n,r;const s=O=>{switch(O){case"left":return um.default.hasArrowLeft;case"right":return um.default.hasArrowRight;default:return""}},u=(O,j)=>({backgroundColor:(0,Z4.getThemePaletteBackgroundColor)(O,j),color:(0,Z4.getThemePaletteTextColor)(O,j),borderColor:(0,Z4.getThemePaletteBorderColor)(O,j),borderWidth:(0,Z4.getThemePaletteBorderColor)(O,j)?"1px":"0"});let p={...t,"aria-invalid":t.hasErrors||null,href:!t.disabled&&(e=t.href)!==null&&e!==void 0&&e.length?t.href:null};delete p.noHover,delete p.hasErrors,delete p.rounded,delete p.inputType,delete p.color,delete p.content,delete p.arrow;const g=(t==null?void 0:t.inputType)==="radio"?t.defaultChecked?"primary":"default":t.color,l=t.theme?u(t.theme,g):null,E=(0,tR.classNameArrayToClassNameString)([um.default.button,um.default[g],um.default[t.size],s(t.arrow),t.theme&&um.default.hasTheme,t.noHover||(t==null?void 0:t.inputType)==="radio"?um.default.noHover:null,t.rounded&&um.default.rounded,t.hasErrors&&um.default.hasErrors,t.disabled&&um.default.disabled]),P=O=>(0,tR.cloneThroughFragments)(O).map(($,Y)=>{var re;if(!p.disabled&&($!=null&&(re=$.props)!==null&&re!==void 0&&re.to)){var _e,J;return lm.default.cloneElement($,{className:E,style:l,key:"button-".concat(Y),to:!p.disabled&&$!==null&&$!==void 0&&(_e=$.props)!==null&&_e!==void 0&&_e.to?$==null||(J=$.props)===null||J===void 0?void 0:J.to:null})}else return lm.default.createElement("button",x1({},p,{key:"button-".concat(Y),className:E,style:l}),t.content||$.props.children)});return t.inputType==="button"?lm.default.createElement("input",x1({},p,{className:E,style:l,type:"button",value:t.content})):t.inputType==="radio"?lm.default.createElement("label",{className:E},lm.default.createElement("input",x1({},p,{style:l,type:"radio"})),t.content):(n=t.href)!==null&&n!==void 0&&n.length&&!t.disabled?lm.default.createElement("a",x1({},p,{className:E,style:l}),t.content||t.children):(t==null||(r=t.children)===null||r===void 0?void 0:r.type)===ZK.Link?lm.default.createElement(lm.Fragment,null,P(lm.default.Children.toArray(t.children))):lm.default.createElement("button",x1({},p,{className:E,style:l}),t.content||t.children)};OC.propTypes={content:ec.default.string,color:ec.default.oneOf(["default","primary"]),size:ec.default.oneOf(["small","regular"]),arrow:ec.default.oneOf(["none","left","right"]),theme:ec.default.object,disabled:ec.default.bool,inputType:ec.default.oneOf(["button","radio"]),name:ec.default.string,defaultChecked:ec.default.bool,required:ec.default.bool,hasErrors:ec.default.bool,"aria-describedby":ec.default.string,noHover:ec.default.bool,rounded:ec.default.bool,href:ec.default.string,onClick:ec.default.func};OC.defaultProps={color:"default",size:"regular",disabled:!1,hasErrors:!1,noHover:!1,arrow:"none"};e3.default=OC;var m9={};const wz="_flex_1iwrx_59",Ez="_checkBoxIcon_1iwrx_98",Sz="_showBox_1iwrx_119",Tz="_hasErrors_1iwrx_124",Mz="_checked_1iwrx_134",kz="_disabled_1iwrx_150",Cz="_checkmark_1iwrx_155",KK={flex:wz,"main-content":"_main-content_1iwrx_86",checkBoxIcon:Ez,showBox:Sz,hasErrors:Tz,checked:Mz,disabled:kz,checkmark:Cz},JK=Object.freeze(Object.defineProperty({__proto__:null,checkBoxIcon:Ez,checked:Mz,checkmark:Cz,default:KK,disabled:kz,flex:wz,hasErrors:Tz,showBox:Sz},Symbol.toStringTag,{value:"Module"})),QK=Ls(JK);Object.defineProperty(m9,"__esModule",{value:!0});m9.default=void 0;var nR=FC(Lt),h1=FC(_o),rR=ao,Ex=FC(QK);function FC(t){return t&&t.__esModule?t:{default:t}}const zC=t=>{let e={height:t.size,width:t.size,fontSize:t.size};t.theme&&t.checked&&(e={...e,[!t.hasErrors&&"color"]:(0,rR.getThemePaletteBackgroundColor)(t.theme,"primary"),[!t.hasErrors&&t.showBox&&"boxShadow"]:"0 0 0 1px ".concat((0,rR.getThemePaletteBackgroundColor)(t.theme,"primary"))});const n={className:"".concat(Ex.default.checkBoxIcon," ").concat(t.checked?Ex.default.checked:""," ").concat(t.disabled?Ex.default.disabled:""," ").concat(t.showBox?Ex.default.showBox:""," ").concat(t.hasErrors?Ex.default.hasErrors:""),style:e};return nR.default.createElement("span",n,nR.default.createElement("span",{"aria-hidden":!0,className:Ex.default.checkmark},t.checked?t.checkmarkCharacter:""))};zC.propTypes={size:h1.default.string,checked:h1.default.bool,disabled:h1.default.bool,showBox:h1.default.bool,theme:h1.default.object,hasErrors:h1.default.bool,checkmarkCharacter:h1.default.string};zC.defaultProps={size:"20px",checked:!1,disabled:!1,showBox:!0,hasErrors:!1,checkmarkCharacter:""};m9.default=zC;var g9={};const eJ="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='32.275'%20height='30.469'%20focusable='false'%3e%3cpath%20fill='%239d2024'%20d='m0%2014.355%202.246-6.933c5.176%201.823%208.936%203.402%2011.28%204.736-.62-5.892-.945-9.944-.977-12.158h7.08c-.098%203.223-.472%207.26-1.123%2012.11%203.353-1.693%207.194-3.256%2011.523-4.688l2.246%206.933c-4.134%201.368-8.186%202.28-12.158%202.735%201.986%201.725%204.785%204.801%208.399%209.228l-5.86%204.15c-1.888-2.57-4.118-6.07-6.69-10.497-2.408%204.59-4.524%208.089-6.347%2010.498l-5.762-4.15c3.776-4.656%206.478-7.732%208.106-9.23-4.2-.813-8.187-1.724-11.963-2.734'/%3e%3c/svg%3e",tJ=Object.freeze(Object.defineProperty({__proto__:null,default:eJ},Symbol.toStringTag,{value:"Module"})),Ky=Ls(tJ),Iz="_flex_1qugv_59",Az="_checkBoxInput_1qugv_98",Lz="_requiredSymbol_1qugv_103",Pz="_contentOnly_1qugv_110",Rz="_disabled_1qugv_110",Nz="_hasErrors_1qugv_116",nJ={flex:Iz,"main-content":"_main-content_1qugv_86",checkBoxInput:Az,requiredSymbol:Lz,contentOnly:Pz,disabled:Rz,hasErrors:Nz},rJ=Object.freeze(Object.defineProperty({__proto__:null,checkBoxInput:Az,contentOnly:Pz,default:nJ,disabled:Rz,flex:Iz,hasErrors:Nz,requiredSymbol:Lz},Symbol.toStringTag,{value:"Module"})),iJ=Ls(rJ);Object.defineProperty(g9,"__esModule",{value:!0});g9.default=void 0;var Q0=y9(Lt),Uh=y9(_o),iR=y9(m9),sJ=y9(Ky),Ew=y9(iJ);function y9(t){return t&&t.__esModule?t:{default:t}}const BC=t=>{const e={className:"".concat(Ew.default.checkBoxInput," ").concat(t.contentOnly?Ew.default.contentOnly:""," ").concat(t.disabled?Ew.default.disabled:""," ").concat(t.hasErrors?Ew.default.hasErrors:""),htmlFor:t.id},n={checked:t.checked,disabled:t.disabled,theme:t.theme,showBox:!t.contentOnly,hasErrors:t.contentOnly&&t.hasErrors,checkmarkCharacter:t.checkmarkCharacter},r={id:t.id,name:t.name||null,type:"checkbox",checked:t.checked,disabled:t.disabled,required:t.required||t.requiredGroup,onChange:t.onChange,tabIndex:t.tabIndex||null,"aria-controls":t["aria-controls"],"aria-invalid":t.hasErrors?"true":null,"aria-describedby":t["aria-describedby"]};return Q0.default.createElement("label",e,t.contentOnly?Q0.default.createElement(iR.default,n):Q0.default.createElement(Q0.default.Fragment,null,Q0.default.createElement(iR.default,n),Q0.default.createElement("input",r)),Q0.default.createElement("span",null,t.children,t.required&&Q0.default.createElement("img",{src:sJ.default,alt:"",className:Ew.default.requiredSymbol})))};BC.propTypes={checked:Uh.default.bool,disabled:Uh.default.bool,required:Uh.default.bool,requiredGroup:Uh.default.bool,id:Uh.default.string.isRequired,name:Uh.default.string,onChange:Uh.default.func.isRequired,contentOnly:Uh.default.bool,hasErrors:Uh.default.bool,theme:Uh.default.object,checkmarkCharacter:Uh.default.string,"aria-controls":Uh.default.string,"aria-describedby":Uh.default.string};BC.defaultProps={checked:!1,disabled:!1,required:!1,requiredGroup:!1,name:"",contentOnly:!1,hasErrors:!1,checkmarkCharacter:""};g9.default=BC;var _9={};const Dz="_flex_146d3_59",Oz="_checkBoxList_146d3_98",Fz="_requiredSymbol_146d3_113",oJ={flex:Dz,"main-content":"_main-content_146d3_86",checkBoxList:Oz,requiredSymbol:Fz},aJ=Object.freeze(Object.defineProperty({__proto__:null,checkBoxList:Oz,default:oJ,flex:Dz,requiredSymbol:Fz},Symbol.toStringTag,{value:"Module"})),lJ=Ls(aJ);Object.defineProperty(_9,"__esModule",{value:!0});_9.default=void 0;var Sw=FT(Lt),o7=FT(_o),uJ=fl,cJ=FT(Ky),sR=FT(lJ);function FT(t){return t&&t.__esModule?t:{default:t}}const zz=t=>{var e;const n=r=>(0,uJ.cloneThroughFragments)(r).map((u,p)=>{var g;const E=(u==null||(g=u.type)===null||g===void 0?void 0:g.name)==="CheckBoxListItem"?{requiredGroup:t.required,compact:t.compact,key:"checkboxListItem-".concat(p)}:null;return Sw.default.cloneElement(u,E)});return Sw.default.createElement("fieldset",{className:sR.default.checkBoxList},(e=t.legend)!==null&&e!==void 0&&e.length?Sw.default.createElement("legend",null,t.legend,t.required&&Sw.default.createElement("img",{src:cJ.default,alt:"",className:sR.default.requiredSymbol})):null,n(Sw.default.Children.toArray(t.children)))};zz.propTypes={legend:o7.default.string,required:o7.default.bool,compact:o7.default.bool};_9.default=zz;var v9={};const Bz="_flex_1xhan_59",Uz="_checkBoxListItem_1xhan_98",jz="_contentOnly_1xhan_122",Vz="_compact_1xhan_122",Gz="_disabled_1xhan_136",Hz="_checked_1xhan_139",hJ={flex:Bz,"main-content":"_main-content_1xhan_86",checkBoxListItem:Uz,contentOnly:jz,compact:Vz,disabled:Gz,checked:Hz},dJ=Object.freeze(Object.defineProperty({__proto__:null,checkBoxListItem:Uz,checked:Hz,compact:Vz,contentOnly:jz,default:hJ,disabled:Gz,flex:Bz},Symbol.toStringTag,{value:"Module"})),fJ=Ls(dJ);Object.defineProperty(v9,"__esModule",{value:!0});v9.default=void 0;var oR=zT(Lt),ih=zT(_o),pJ=zT(g9),mJ=fl,Sx=zT(fJ);function zT(t){return t&&t.__esModule?t:{default:t}}const UC=t=>{const e=[Sx.default.checkBoxListItem,t.checked?Sx.default.checked:null,t.disabled?Sx.default.disabled:null,t.compact?Sx.default.compact:null,t.contentOnly?Sx.default.contentOnly:null,t.hasErrors?Sx.default.hasErrors:null],n=(0,mJ.classNameArrayToClassNameString)(e),r={onChange:t.onChange,checked:t.checked,disabled:t.disabled,required:t.required,requiredGroup:t.requiredGroup,contentOnly:t.contentOnly,hasErrors:t.hasErrors,"aria-controls":t["aria-controls"],"aria-describedby":t["aria-describedby"],id:t.id,theme:t.theme,checkmarkCharacter:t.checkmarkCharacter};return oR.default.createElement("div",{className:n},oR.default.createElement(pJ.default,r,t.children))};UC.propTypes={checked:ih.default.bool,disabled:ih.default.bool,required:ih.default.bool,requiredGroup:ih.default.bool,id:ih.default.string.isRequired,name:ih.default.string,onChange:ih.default.func.isRequired,contentOnly:ih.default.bool,theme:ih.default.object,compact:ih.default.bool,hasErrors:ih.default.bool,checkmarkCharacter:ih.default.string,"aria-controls":ih.default.string,"aria-describedby":ih.default.string};UC.defaultProps={checked:!1,disabled:!1,required:!1,requiredGroup:!1,id:"",name:"",contentOnly:!1,hasErrors:!1,checkmarkCharacter:""};v9.default=UC;var x9={};const Wz="_flex_5c5zx_59",qz="_container_5c5zx_98",gJ={flex:Wz,"main-content":"_main-content_5c5zx_86",container:qz},yJ=Object.freeze(Object.defineProperty({__proto__:null,container:qz,default:gJ,flex:Wz},Symbol.toStringTag,{value:"Module"})),_J=Ls(yJ);Object.defineProperty(x9,"__esModule",{value:!0});x9.default=void 0;var vJ=$z(Lt),xJ=$z(_J);function $z(t){return t&&t.__esModule?t:{default:t}}const bJ=t=>vJ.default.createElement("div",{className:xJ.default.container},t.children);x9.default=bJ;var BT={};const Xz="_flex_x69hc_59",Zz="_contentBox_x69hc_98",Yz="_link_x69hc_105",Kz="_content_x69hc_98",Jz="_title_x69hc_122",Qz="_primary_x69hc_125",eB="_success_x69hc_133",tB="_warning_x69hc_141",nB="_info_x69hc_149",rB="_lightCyan_x69hc_156",iB="_orange_x69hc_163",sB="_lightOrange_x69hc_171",oB="_lime_x69hc_178",aB="_lightLime_x69hc_186",lB="_regular_x69hc_193",uB="_large_x69hc_202",wJ={flex:Xz,"main-content":"_main-content_x69hc_86",contentBox:Zz,link:Yz,default:"_default_x69hc_118",content:Kz,title:Jz,primary:Qz,success:eB,warning:tB,info:nB,lightCyan:rB,orange:iB,lightOrange:sB,lime:oB,lightLime:aB,regular:lB,large:uB},EJ=Object.freeze(Object.defineProperty({__proto__:null,content:Kz,contentBox:Zz,default:wJ,flex:Xz,info:nB,large:uB,lightCyan:rB,lightLime:aB,lightOrange:sB,lime:oB,link:Yz,orange:iB,primary:Qz,regular:lB,success:eB,title:Jz,warning:tB},Symbol.toStringTag,{value:"Module"})),SJ=Ls(EJ);Object.defineProperty(BT,"__esModule",{value:!0});BT.default=void 0;var Tw=jC(Lt),Mw=jC(_o),d1=jC(SJ);function jC(t){return t&&t.__esModule?t:{default:t}}const VC=t=>{var e;const n=()=>{let g=d1.default.title+" "+d1.default[t.titleSize];if(t.title)return Tw.default.createElement("h2",{className:g},t.title)};let r=" "+d1.default[t.color],s=t.href?" "+d1.default.link:"",u=d1.default.contentBox+r+s;const p=(e=t.content)!==null&&e!==void 0&&e.length?t.content:t.children;return t.href?Tw.default.createElement("a",{href:t.href,className:u},n(),Tw.default.createElement("div",{className:d1.default.content},p)):Tw.default.createElement("div",{className:u},n(),Tw.default.createElement("div",{className:d1.default.content},p))};VC.propTypes={title:Mw.default.string,titleSize:Mw.default.oneOf(["regular","large"]),content:Mw.default.string,children:Mw.default.any,color:Mw.default.oneOf(["default","primary","success","warning","info","lightCyan","orange","lightOrange","lime","lightLime"])};VC.defaultProps={title:null,titleSize:"regular",href:null,content:"",color:"default"};BT.default=VC;var UT={};const TJ="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='25'%20height='25'%3e%3cpath%20fill='%23072938'%20stroke='%23072938'%20stroke-linecap='round'%20stroke-width='3.23'%20d='m3.97%203.57%2017.44%2018.2m-17.44.01L21.41%203.57'/%3e%3c/svg%3e",MJ=Object.freeze(Object.defineProperty({__proto__:null,default:TJ},Symbol.toStringTag,{value:"Module"})),kJ=Ls(MJ),cB="_flex_72i0z_59",hB="_dialogOverlay_72i0z_98",dB="_hidden_72i0z_117",fB="_dialogContent_72i0z_126",pB="_noPadding_72i0z_139",mB="_closeButton_72i0z_155",CJ={flex:cB,"main-content":"_main-content_72i0z_86",dialogOverlay:hB,hidden:dB,dialogContent:fB,noPadding:pB,closeButton:mB},IJ=Object.freeze(Object.defineProperty({__proto__:null,closeButton:mB,default:CJ,dialogContent:fB,dialogOverlay:hB,flex:cB,hidden:dB,noPadding:pB},Symbol.toStringTag,{value:"Module"})),AJ=Ls(IJ);Object.defineProperty(UT,"__esModule",{value:!0});UT.default=void 0;var ey=RJ(Lt),Y4=GC(_o),LJ=GC(kJ),kw=GC(AJ),PJ=fl;function GC(t){return t&&t.__esModule?t:{default:t}}function gB(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(gB=function(r){return r?n:e})(t)}function RJ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=gB(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}const HC=t=>{const e=(0,ey.useRef)(),n=(0,ey.useCallback)(r=>{r&&(0,PJ.addFocusTrapInsideElement)(r)},[]);return(0,ey.useEffect)(()=>{const r=u=>{switch(u.keyCode){case 27:t.onClickOutside&&t.onClickOutside();break;default:return null}},s=u=>{e!=null&&e.current&&!e.current.contains(u.target)&&t.onClickOutside()};document.addEventListener("mousedown",s),document.addEventListener("keydown",r,!1)},[t,n]),ey.default.createElement("div",{className:"".concat(kw.default.dialogOverlay," ").concat(t.hidden&&kw.default.hidden),ref:n},ey.default.createElement("div",{ref:e,className:"".concat(kw.default.dialogContent," ").concat(t.noPadding?kw.default.noPadding:""),style:{maxWidth:t.maxWidth}},t.closeButton?ey.default.createElement("button",{"aria-label":"Lukk dialog",onClick:t.onClickOutside,className:kw.default.closeButton},ey.default.createElement("img",{src:LJ.default,alt:""})):null,ey.default.createElement("div",{"aria-live":"assertive",role:"dialog"},t.children)))};HC.propTypes={maxWidth:Y4.default.string,noPadding:Y4.default.bool,closeButton:Y4.default.bool,onClickOutside:Y4.default.func.isRequired};HC.defaultProps={maxWidth:"none"};UT.default=HC;var jT={},Jy={};const yB="_flex_1amyi_59",_B="_errorMessage_1amyi_98",NJ={flex:yB,"main-content":"_main-content_1amyi_86",errorMessage:_B},DJ=Object.freeze(Object.defineProperty({__proto__:null,default:NJ,errorMessage:_B,flex:yB},Symbol.toStringTag,{value:"Module"})),OJ=Ls(DJ);Object.defineProperty(Jy,"__esModule",{value:!0});Jy.default=void 0;var FJ=WC(Lt),ty=WC(_o),zJ=ao,BJ=WC(OJ);function WC(t){return t&&t.__esModule?t:{default:t}}function Fk(){return Fk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fk.apply(this,arguments)}const qC=t=>{const e=r=>({color:(0,zJ.getThemePaletteBackgroundColor)(r,"warning")}),n=()=>{var r;return{id:(r=t.id)!==null&&r!==void 0&&r.length?t.id:null,className:BJ.default.errorMessage,style:e(t.theme)}};return FJ.default.createElement("span",Fk({"aria-live":"polite"},n()),t.content?t.content:"")};qC.propTypes={id:ty.default.string,content:ty.default.oneOfType([ty.default.string,ty.default.arrayOf(ty.default.oneOfType([ty.default.string,ty.default.object]))]),theme:ty.default.object};qC.defaultProps={content:""};Jy.default=qC;var Qy={};const vB="_flex_ulg9f_59",xB="_label_ulg9f_98",bB="_inline_ulg9f_108",wB="_normalCursor_ulg9f_111",UJ={flex:vB,"main-content":"_main-content_ulg9f_86",label:xB,inline:bB,normalCursor:wB},jJ=Object.freeze(Object.defineProperty({__proto__:null,default:UJ,flex:vB,inline:bB,label:xB,normalCursor:wB},Symbol.toStringTag,{value:"Module"})),VJ=Ls(jJ);Object.defineProperty(Qy,"__esModule",{value:!0});Qy.default=void 0;var GJ=$C(Lt),a7=$C(_o),l7=$C(VJ);function $C(t){return t&&t.__esModule?t:{default:t}}const XC=t=>{var e;let n={...t};const r=(e=t.htmlTag)!==null&&e!==void 0&&e.length?t.htmlTag:"label";delete n.inline,delete n.normalCursor,delete n.htmlTag;const s="".concat(l7.default.label," ").concat(t.inline?l7.default.inline:""," ").concat(t.normalCursor?l7.default.normalCursor:"");return GJ.default.createElement(r,{...n,className:s,id:t.id||null},t.children)};XC.propTypes={inline:a7.default.bool,normalCursor:a7.default.bool,htmlTag:a7.default.string};XC.defaultProps={inline:!1,normalCursor:!1,htmlTag:"label"};Qy.default=XC;const EB="_flex_1wkap_59",SB="_dragAndDropFileInput_1wkap_98",TB="_requiredSymbol_1wkap_98",MB="_dragAndDropContainer_1wkap_105",kB="_highlighted_1wkap_122",HJ={flex:EB,"main-content":"_main-content_1wkap_86",dragAndDropFileInput:SB,requiredSymbol:TB,dragAndDropContainer:MB,highlighted:kB},WJ=Object.freeze(Object.defineProperty({__proto__:null,default:HJ,dragAndDropContainer:MB,dragAndDropFileInput:SB,flex:EB,highlighted:kB,requiredSymbol:TB},Symbol.toStringTag,{value:"Module"})),qJ=Ls(WJ);Object.defineProperty(jT,"__esModule",{value:!0});jT.default=void 0;var Cl=KJ(Lt),ba=t3(_o),$J=t3(e3),XJ=t3(Jy),ZJ=t3(Qy),YJ=t3(Ky),K4=t3(qJ);function t3(t){return t&&t.__esModule?t:{default:t}}function CB(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(CB=function(r){return r?n:e})(t)}function KJ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=CB(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function zk(){return zk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zk.apply(this,arguments)}const ZC=t=>{var e,n;const[r,s]=(0,Cl.useState)(!1),u=(0,Cl.useRef)(),p=(0,Cl.useRef)(),g=$=>{$.preventDefault(),$.stopPropagation()},l=($,Y)=>$||Y,E=()=>{p.current.click()},P=()=>"".concat(t.id,"-errorMessage"),O={"aria-describedby":t.hasErrors&&((e=t.errorMessage)!==null&&e!==void 0&&e.length)?P():(n=t["aria-describedby"])!==null&&n!==void 0&&n.length?t["aria-describedby"]:null,"aria-invalid":t.hasErrors?"true":null,required:t.required};let j;return t.selectedFileName?j=t.buttonContentWhenSelectedFile?t.buttonContentWhenSelectedFile:t.buttonContent:j=t.buttonContent,(0,Cl.useEffect)(()=>{const $=re=>{t.onDragAndDropChange(re)},Y=re=>{const _e=re.dataTransfer.files;$(_e)};u!=null&&u.current&&(u.current.addEventListener("dragenter",g,!1),u.current.addEventListener("dragover",g,!1),u.current.addEventListener("dragleave",g,!1),u.current.addEventListener("drop",g,!1),u.current.addEventListener("dragenter",()=>{s(!0)},!1),u.current.addEventListener("dragover",()=>{s(!0)},!1),u.current.addEventListener("dragleave",()=>{s(!1)},!1),u.current.addEventListener("drop",()=>{s(!1)},!1),u.current.addEventListener("drop",Y,!1))},[t]),Cl.default.createElement("div",{className:K4.default.dragAndDropFileInput},Cl.default.createElement(ZJ.default,{htmlFor:t.id},t.label,t.required&&Cl.default.createElement("img",{src:YJ.default,alt:"",className:K4.default.requiredSymbol})),Cl.default.createElement("div",null,t.children),t.contentOnly?null:Cl.default.createElement("div",{ref:u,className:"".concat(K4.default.dragAndDropContainer," ").concat(r?K4.default.highlighted:"")},t.selectedFileName?Cl.default.createElement("div",null,Cl.default.createElement("span",null,Cl.default.createElement("b",null,"Valgt fil:")," ",t.selectedFileName)):Cl.default.createElement("div",null,"Slipp fil her"),Cl.default.createElement("input",zk({},O,{ref:p,type:"file",onChange:t.onSelectChange})),t.buttonContent?Cl.default.createElement(Cl.default.Fragment,null,Cl.default.createElement("div",null,t.selectedFileName?"":"eller klikk p knappen for  velge fil"),Cl.default.createElement($J.default,{size:"small",type:"button",color:t.buttonColor,onClick:()=>E(),content:j,hasErrors:t.hasErrors})):null),t.contentOnly?Cl.default.createElement("span",null,l(t.selectedFileName,t.defaultContent)):"",Cl.default.createElement(XJ.default,{id:P(),content:t.errorMessage,theme:t.theme}))};ZC.propTypes={id:ba.default.string.isRequired,onSelectChange:ba.default.func.isRequired,onDragAndDropChange:ba.default.func.isRequired,label:ba.default.oneOfType([ba.default.string,ba.default.arrayOf(ba.default.oneOfType([ba.default.string,ba.default.object]))]),contentOnly:ba.default.bool,buttonColor:ba.default.string,buttonContent:ba.default.string,buttonContentWhenSelectedFile:ba.default.string,selectedFileName:ba.default.string,defaultContent:ba.default.string,hasErrors:ba.default.bool,errorMessage:ba.default.oneOfType([ba.default.string,ba.default.arrayOf(ba.default.oneOfType([ba.default.string,ba.default.object]))]),required:ba.default.bool,theme:ba.default.object};ZC.defaultProps={label:"",contentOnly:!1,buttonColor:"default",defaultContent:"",hasErrors:!1,errorMessage:"",required:!1};jT.default=ZC;var VT={};const IB="_flex_11fmk_59",AB="_errorBox_11fmk_98",JJ={flex:IB,"main-content":"_main-content_11fmk_86",errorBox:AB},QJ=Object.freeze(Object.defineProperty({__proto__:null,default:JJ,errorBox:AB,flex:IB},Symbol.toStringTag,{value:"Module"})),eQ=Ls(QJ);Object.defineProperty(VT,"__esModule",{value:!0});VT.default=void 0;var tQ=YC(Lt),nQ=YC(_o),rQ=ao,iQ=YC(eQ);function YC(t){return t&&t.__esModule?t:{default:t}}const KC=t=>{const e=()=>({borderColor:(0,rQ.getThemePaletteBackgroundColor)(t.theme,"warning")});return tQ.default.createElement("div",{className:iQ.default.errorBox,style:e()},t.children)};KC.propTypes={theme:nQ.default.object};KC.defaultProps={children:""};VT.default=KC;var GT={};const LB="_flex_1qm7d_59",PB="_footer_1qm7d_98",RB="_link_1qm7d_107",sQ={flex:LB,"main-content":"_main-content_1qm7d_86",footer:PB,link:RB},oQ=Object.freeze(Object.defineProperty({__proto__:null,default:sQ,flex:LB,footer:PB,link:RB},Symbol.toStringTag,{value:"Module"})),aQ=Ls(oQ);Object.defineProperty(GT,"__esModule",{value:!0});GT.default=void 0;var aR=JC(Lt),lQ=JC(x9),uQ=JC(aQ);function JC(t){return t&&t.__esModule?t:{default:t}}const cQ=t=>aR.default.createElement("footer",{className:uQ.default.footer},aR.default.createElement(lQ.default,null,t.children));GT.default=cQ;var HT={};const NB="_flex_1dt1e_59",DB="_headerContainer_1dt1e_98",OB="_header_1dt1e_98",FB="_hasTheme_1dt1e_107",zB="_bigHeader_1dt1e_122",hQ={flex:NB,"main-content":"_main-content_1dt1e_86",headerContainer:DB,header:OB,hasTheme:FB,"size-1":"_size-1_1dt1e_110",bigHeader:zB,"size-2":"_size-2_1dt1e_134","size-3":"_size-3_1dt1e_146","size-4":"_size-4_1dt1e_158","size-5":"_size-5_1dt1e_170"},dQ=Object.freeze(Object.defineProperty({__proto__:null,bigHeader:zB,default:hQ,flex:NB,hasTheme:FB,header:OB,headerContainer:DB},Symbol.toStringTag,{value:"Module"})),fQ=Ls(dQ);Object.defineProperty(HT,"__esModule",{value:!0});HT.default=void 0;var lR=QC(Lt),f1=QC(_o),Cw=QC(fQ),pQ=fl;function QC(t){return t&&t.__esModule?t:{default:t}}const eI=t=>{var e,n;const r=t.big?Cw.default.bigHeader:"",s=t.theme?Cw.default.hasTheme:"",u=(e=t.htmlTag)!==null&&e!==void 0&&e.length?t.htmlTag:"h".concat(t.size),p=Cw.default.header,g=Cw.default["size-".concat(t.size)];let l=lR.default.createElement(u,{className:(0,pQ.classNameArrayToClassNameString)([p,g,r,s]),id:t.id||null,htmlFor:t.htmlFor||null},(n=t.content)!==null&&n!==void 0&&n.length?t.content:t.children);return lR.default.createElement("div",{className:Cw.default.headerContainer}," ",l," ")};eI.propTypes={id:f1.default.string,content:f1.default.string,size:f1.default.oneOf([1,2,3,4,5]),big:f1.default.bool,htmlTag:f1.default.string,theme:f1.default.object,htmlFor:f1.default.string};eI.defaultProps={size:1};HT.default=eI;var WT={},n3={};Object.defineProperty(n3,"__esModule",{value:!0});n3.generateRandomString=void 0;const mQ=t=>{let e="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length;for(let s=0;s<t;s++)e+=n.charAt(Math.floor(Math.random()*r));return e};n3.generateRandomString=mQ;const BB="_flex_3rjp7_59",UB="_inputField_3rjp7_98",jB="_requiredSymbol_3rjp7_109",VB="_file_3rjp7_116",GB="_input_3rjp7_98",HB="_hasErrors_3rjp7_160",WB="_fileInputContainer_3rjp7_172",gQ={flex:BB,"main-content":"_main-content_3rjp7_86",inputField:UB,requiredSymbol:jB,file:VB,input:GB,hasErrors:HB,fileInputContainer:WB},yQ=Object.freeze(Object.defineProperty({__proto__:null,default:gQ,file:VB,fileInputContainer:WB,flex:BB,hasErrors:HB,input:GB,inputField:UB,requiredSymbol:jB},Symbol.toStringTag,{value:"Module"})),_Q=Ls(yQ);Object.defineProperty(WT,"__esModule",{value:!0});WT.default=void 0;var Ig=av(Lt),Ws=av(_o),vQ=av(e3),xQ=av(Qy),bQ=av(Jy),uR=ao,wQ=n3,EQ=av(Ky),Tx=av(_Q);function av(t){return t&&t.__esModule?t:{default:t}}const tI=t=>{var e;const n=P=>({boxShadow:"0 0 3px ".concat((0,uR.getThemePaletteBackgroundColor)(P,"warning")),borderColor:(0,uR.getThemePaletteBackgroundColor)(P,"warning")}),r=P=>{if(!P)return null;const O=new Date(P),j=O.getFullYear(),$=O.getMonth()+1<10?"0".concat(O.getMonth()+1):O.getMonth()+1,Y=O.getDate()<10?"0".concat(O.getDate()):O.getDate();return"".concat(Y,".").concat($,".").concat(j)},s=(P,O)=>t.type==="date"?P?r(P):O:P||O,u=()=>"".concat(t.id,"-errorMessage"),p=(P,O,j)=>{var $,Y;return{name:t.name,readOnly:t.readOnly,disabled:t.disabled,required:t.required,type:t.type,role:t.role,id:t.id,key:O||"".concat(t.id,"-").concat((0,wQ.generateRandomString)(6)),min:t.min||null,max:t.max||null,onChange:t.onChange,onBlur:t.onBlur,[P?"defaultValue":"value"]:P||t.value,placeholder:t.placeholder||null,className:t.hasErrors?Tx.default.hasErrors:null,"aria-describedby":t.hasErrors&&(($=t.errorMessage)!==null&&$!==void 0&&$.length)?u():(Y=t["aria-describedby"])!==null&&Y!==void 0&&Y.length?t["aria-describedby"]:null,"aria-invalid":t.hasErrors?"true":null,"aria-autocomplete":t["aria-autocomplete"]||null,style:j}},g=t.defaultValue?t.defaultValue:t.value||null,l=t.elementKey||null,E={...t.hasErrors?n(t.theme):null,...((e=t.width)===null||e===void 0?void 0:e.length)&&{maxWidth:t.width}};return Ig.default.createElement("div",{className:"".concat(Tx.default.inputField," ").concat(Tx.default[t.type])},Ig.default.createElement(xQ.default,{htmlFor:t.id},t.label,t.required&&Ig.default.createElement("img",{src:EQ.default,alt:"",className:Tx.default.requiredSymbol}),t.type==="file"?Ig.default.createElement("div",{className:Tx.default.fileInputContainer},Ig.default.createElement("span",{className:Tx.default.input},t.selectedFileName),t.buttonContent?Ig.default.createElement(vQ.default,{color:t.buttonColor,onClick:()=>{document.getElementById(t.id).click()},content:t.buttonContent,type:"button",theme:t.theme}):null):null),t.contentOnly?Ig.default.createElement("span",null,s(t.value||t.defaultValue,t.defaultContent)):Ig.default.createElement("input",p(g,l,E)),Ig.default.createElement(bQ.default,{id:u(),content:t.errorMessage,theme:t.theme}))};tI.propTypes={id:Ws.default.string.isRequired,onChange:Ws.default.func.isRequired,onBlur:Ws.default.func,name:Ws.default.string,type:Ws.default.string,required:Ws.default.bool,width:Ws.default.string,value:Ws.default.any,defaultValue:Ws.default.any,elementKey:Ws.default.string,label:Ws.default.oneOfType([Ws.default.string,Ws.default.arrayOf(Ws.default.oneOfType([Ws.default.string,Ws.default.object]))]),contentOnly:Ws.default.bool,buttonColor:Ws.default.oneOf(["default","primary"]),buttonContent:Ws.default.string,selectedFileName:Ws.default.string,dateFormat:Ws.default.string,placeholder:Ws.default.string,defaultContent:Ws.default.string,"aria-describedby":Ws.default.string,"aria-autocomplete":Ws.default.oneOf(["none","inline","list","both"]),hasErrors:Ws.default.bool,errorMessage:Ws.default.oneOfType([Ws.default.string,Ws.default.arrayOf(Ws.default.oneOfType([Ws.default.string,Ws.default.object]))]),theme:Ws.default.object};tI.defaultProps={onChange:()=>!1,name:"",type:"text",required:!1,label:"",contentOnly:!1,buttonColor:"default",dateFormat:"d. MMMM, yyyy",placeholder:"",defaultContent:"",hasErrors:!1,errorMessage:""};WT.default=tI;var qT={};const qB="_list_1g9rf_1",$B="_compact_1g9rf_13",SQ={list:qB,compact:$B},TQ=Object.freeze(Object.defineProperty({__proto__:null,compact:$B,default:SQ,list:qB},Symbol.toStringTag,{value:"Module"})),MQ=Ls(TQ);Object.defineProperty(qT,"__esModule",{value:!0});qT.default=void 0;var kQ=nI(Lt),u7=nI(_o),cR=nI(MQ);function nI(t){return t&&t.__esModule?t:{default:t}}const rI=t=>(()=>{let n=t.ordered?"ol":"ul";const r=t.ordered?"decimal":"disc",s="--listStyle";return kQ.default.createElement(n,{className:"".concat(cR.default.list," ").concat(t.compact?cR.default.compact:""),style:{[s]:t.listStyle||r}},t.children)})();rI.propTypes={listStyle:u7.default.string,compact:u7.default.bool,ordered:u7.default.bool};rI.defaultProps={ordered:!1,compact:!1};qT.default=rI;var $T={};Object.defineProperty($T,"__esModule",{value:!0});$T.default=void 0;var CQ=XB(Lt),IQ=XB(_o);function XB(t){return t&&t.__esModule?t:{default:t}}const ZB=t=>{const e={key:t.elementKey||null};return CQ.default.createElement("li",e,t.children,t.elementKey)};ZB.propTypes={elementKey:IQ.default.string};$T.default=ZB;var XT={};const YB="_flex_uw2n0_59",KB="_loadingAnimation_uw2n0_98",JB="_fixed_uw2n0_114",AQ={flex:YB,"main-content":"_main-content_uw2n0_86",loadingAnimation:KB,fixed:JB},LQ=Object.freeze(Object.defineProperty({__proto__:null,default:AQ,fixed:JB,flex:YB,loadingAnimation:KB},Symbol.toStringTag,{value:"Module"})),PQ=Ls(LQ);Object.defineProperty(XT,"__esModule",{value:!0});XT.default=void 0;var RQ=iI(Lt),c7=iI(_o),h7=iI(PQ);function iI(t){return t&&t.__esModule?t:{default:t}}const sI=t=>RQ.default.createElement("div",{className:t.fixed?h7.default.loadingAnimation+" "+h7.default.fixed:h7.default.loadingAnimation},t.message);sI.propTypes={fixed:c7.default.bool,active:c7.default.bool,message:c7.default.string};sI.defaultProps={fixed:!1,active:!0,message:""};XT.default=sI;var ZT={},b9={};Object.defineProperty(b9,"__esModule",{value:!0});b9.default=void 0;var J4=QB(Lt),Q4=QB(_o),hR=ao;function QB(t){return t&&t.__esModule?t:{default:t}}const eU=t=>{const n={color:(0,hR.getThemeNavigationBarTextColor)(t.theme),borderBottomColor:(0,hR.getThemeNavigationBarTextColor)(t.theme)};return typeof t.listItem=="string"?J4.default.createElement("li",null,J4.default.createElement("span",{style:n},t.listItem)):typeof t.listItem=="object"?J4.default.createElement("li",null,J4.default.createElement("a",{href:t.listItem.href,style:n},t.listItem.name)):null};eU.propTypes={listItem:Q4.default.oneOfType([Q4.default.string,Q4.default.object]),theme:Q4.default.object};b9.default=eU;const NQ="/bygglett-3.0-mapbox/assets/dibk-logo-mobile-JmdfDvEe.svg",DQ=Object.freeze(Object.defineProperty({__proto__:null,default:NQ},Symbol.toStringTag,{value:"Module"})),OQ=Ls(DQ),tU="_flex_mlm00_59",nU="_navigationBarContainer_mlm00_98",rU="_mainContentLink_mlm00_105",iU="_navigationBar_mlm00_98",sU="_logoContainer_mlm00_146",oU="_childElements_mlm00_164",aU="_menuToggle_mlm00_169",lU="_hamburgerIcon_mlm00_184",uU="_line_mlm00_188",cU="_dropdownContainer_mlm00_199",hU="_active_mlm00_207",dU="_dropdown_mlm00_199",fU="_primaryList_mlm00_221",pU="_secondaryList_mlm00_255",FQ={flex:tU,"main-content":"_main-content_mlm00_86",navigationBarContainer:nU,mainContentLink:rU,navigationBar:iU,logoContainer:sU,childElements:oU,menuToggle:aU,hamburgerIcon:lU,line:uU,dropdownContainer:cU,active:hU,dropdown:dU,primaryList:fU,secondaryList:pU},zQ=Object.freeze(Object.defineProperty({__proto__:null,active:hU,childElements:oU,default:FQ,dropdown:dU,dropdownContainer:cU,flex:tU,hamburgerIcon:lU,line:uU,logoContainer:sU,mainContentLink:rU,menuToggle:aU,navigationBar:iU,navigationBarContainer:nU,primaryList:fU,secondaryList:pU},Symbol.toStringTag,{value:"Module"})),BQ=Ls(zQ);Object.defineProperty(ZT,"__esModule",{value:!0});ZT.default=void 0;var sa=jQ(Lt),Mx=YT(_o),dR=YT(b9),ny=ao,UQ=YT(OQ),tc=YT(BQ);function YT(t){return t&&t.__esModule?t:{default:t}}function mU(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(mU=function(r){return r?n:e})(t)}function jQ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=mU(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function Bk(){return Bk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bk.apply(this,arguments)}const oI=t=>{var e,n,r;const[s,u]=(0,sa.useState)(!1),p=()=>{u(!s)},g=_e=>({backgroundColor:(0,ny.getThemeNavigationBarBackgroundColor)(_e),color:(0,ny.getThemeNavigationBarTextColor)(_e)}),l=_e=>({color:(0,ny.getThemeNavigationBarTextColor)(_e),borderBottomColor:(0,ny.getThemeNavigationBarTextColor)(_e)}),E=_e=>({padding:(0,ny.getThemeLogoPadding)(_e)}),P=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.primaryListItems,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const H=l(t.theme);let te=_e.map((ce,Se)=>{let Ie=J+"-"+Se;return ce.listItems!==void 0?sa.default.createElement("li",{key:Ie},sa.default.createElement("span",{style:H},ce.name),P(ce.listItems,J+1)):sa.default.createElement(dR.default,{listItem:ce,key:Ie,theme:t.theme})});return!!(te!=null&&te.length)&&sa.default.createElement("ul",{className:tc.default.primaryList},te)},O=()=>{let _e=t.secondaryListItems.map((J,H)=>sa.default.createElement(dR.default,{listItem:J,key:H,theme:t.theme}));return!!(_e!=null&&_e.length)&&sa.default.createElement("ul",{className:tc.default.secondaryList},_e)},j=(_e,J)=>{const H=(0,ny.getThemeLogo)(t.theme),te=(0,ny.getThemeAppName)(t.theme),ce=()=>_e&&J?"":H&&te?"".concat(te," logo"):"DIBK logo",Se=()=>{const Ne=ce();return H?sa.default.createElement("img",{alt:Ne,src:H,style:E(t.theme)}):sa.default.createElement("img",{alt:Ne,src:UQ.default})},Ie={target:t.openLogoLinkInNewTab?"_blank":null,rel:t.openLogoLinkInNewTab?"noopener noreferrer":null};return _e&&_e.length?sa.default.createElement("a",Bk({},Ie,{href:_e,title:J}),Se()):Se()},$=g(t.theme),Y={backgroundColor:(0,ny.getThemeNavigationBarTextColor)(t.theme)},re=!!((e=t.primaryListItems)!==null&&e!==void 0&&e.length)||!!((n=t.secondaryListItems)!==null&&n!==void 0&&n.length);return sa.default.createElement("div",{className:tc.default.navigationBarContainer},((r=t.mainContentId)===null||r===void 0?void 0:r.length)&&sa.default.createElement("a",{id:"main-content-link",href:"#".concat(t.mainContentId),className:tc.default.mainContentLink},sa.default.createElement("span",{id:"main-content-link-text"},"Hopp til hovedinnhold")),sa.default.createElement("div",{className:tc.default.navigationBar,style:$},sa.default.createElement("div",{className:tc.default.logoContainer},j(t.logoLink,t.logoLinkTitle)),!!t.children&&sa.default.createElement("div",{className:tc.default.childElements},t.children),re&&sa.default.createElement("button",{type:"button",className:"".concat(tc.default.menuToggle," ").concat(s?tc.default.active:""),onClick:()=>p(),"aria-expanded":s?"true":"false","aria-controls":"main-menu-dropdown"},sa.default.createElement("span",{className:tc.default.hamburgerIcon},sa.default.createElement("span",{className:tc.default.line,style:Y}),sa.default.createElement("span",{className:tc.default.line,style:Y}),sa.default.createElement("span",{className:tc.default.line,style:Y})))),re&&sa.default.createElement(sa.Fragment,null,sa.default.createElement("div",{className:"".concat(tc.default.dropdownContainer," ").concat(s?tc.default.active:"")},sa.default.createElement("div",{id:"main-menu-dropdown",className:tc.default.dropdown,style:$},P(),O()))))};oI.propTypes={primaryListItems:Mx.default.array,secondaryListItems:Mx.default.array,logoLink:Mx.default.string,logoLinkTitle:Mx.default.string,openLogoLinkInNewTab:Mx.default.bool,theme:Mx.default.object};oI.defaultProps={primaryListItems:[],secondaryListItems:[],logoLink:null};ZT.default=oI;var KT={};const gU="_flex_1n7vp_59",yU="_paper_1n7vp_98",_U="_noMargin_1n7vp_105",vU="_noPadding_1n7vp_108",VQ={flex:gU,"main-content":"_main-content_1n7vp_86",paper:yU,noMargin:_U,noPadding:vU},GQ=Object.freeze(Object.defineProperty({__proto__:null,default:VQ,flex:gU,noMargin:_U,noPadding:vU,paper:yU},Symbol.toStringTag,{value:"Module"})),HQ=Ls(GQ);Object.defineProperty(KT,"__esModule",{value:!0});KT.default=void 0;var WQ=aI(Lt),fR=aI(_o),d7=aI(HQ);function aI(t){return t&&t.__esModule?t:{default:t}}const lI=t=>WQ.default.createElement("div",{className:"".concat(d7.default.paper," ").concat(t.noMargin?d7.default.noMargin:""," ").concat(t.noPadding?d7.default.noPadding:"")},t.children);lI.propTypes={noMargin:fR.default.bool,noPadding:fR.default.bool};lI.defaultProps={noMargin:!1,noPadding:!1};KT.default=lI;var JT={};const xU="_flex_16ztd_59",bU="_progressBar_16ztd_98",wU="_hasErrors_16ztd_118",qQ={flex:xU,"main-content":"_main-content_16ztd_86",progressBar:bU,hasErrors:wU},$Q=Object.freeze(Object.defineProperty({__proto__:null,default:qQ,flex:xU,hasErrors:wU,progressBar:bU},Symbol.toStringTag,{value:"Module"})),XQ=Ls($Q);Object.defineProperty(JT,"__esModule",{value:!0});JT.default=void 0;var ZQ=uI(Lt),pR=uI(_o),mR=uI(XQ);function uI(t){return t&&t.__esModule?t:{default:t}}const cI=t=>{const e="--value";return ZQ.default.createElement("div",{className:"".concat(mR.default.progressBar," ").concat(t.hasErrors?mR.default.hasErrors:""),role:"progressbar","aria-valuenow":t.progress||0,"aria-valuemin":"0","aria-valuemax":"100",style:{[e]:t.progress||0}})};cI.propTypes={progress:pR.default.number,hasErrors:pR.default.bool};cI.defaultProps={progress:0,hasErrors:!1};JT.default=cI;var w9={};const EU="_flex_19hvs_59",SU="_radioButtonIcon_19hvs_98",TU="_hasErrors_19hvs_119",MU="_checked_19hvs_129",kU="_disabled_19hvs_145",YQ={flex:EU,"main-content":"_main-content_19hvs_86",radioButtonIcon:SU,hasErrors:TU,checked:MU,disabled:kU},KQ=Object.freeze(Object.defineProperty({__proto__:null,checked:MU,default:YQ,disabled:kU,flex:EU,hasErrors:TU,radioButtonIcon:SU},Symbol.toStringTag,{value:"Module"})),JQ=Ls(KQ);Object.defineProperty(w9,"__esModule",{value:!0});w9.default=void 0;var QQ=hI(Lt),Iw=hI(_o),gR=ao,eE=hI(JQ);function hI(t){return t&&t.__esModule?t:{default:t}}const dI=t=>{let e={height:t.size,width:t.size};t.theme&&t.checked&&(e={...e,[!t.hasErrors&&"background"]:(0,gR.getThemePaletteBackgroundColor)(t.theme,"primary"),[!t.hasErrors&&"boxShadow"]:"0 0 0 1px ".concat((0,gR.getThemePaletteBackgroundColor)(t.theme,"primary"))});const n={className:"".concat(eE.default.radioButtonIcon," ").concat(t.checked?eE.default.checked:""," ").concat(t.disabled?eE.default.disabled:""," ").concat(t.hasErrors?eE.default.hasErrors:""),style:e};return QQ.default.createElement("span",n)};dI.propTypes={size:Iw.default.string,checked:Iw.default.bool,disabled:Iw.default.bool,theme:Iw.default.object,hasErrors:Iw.default.bool};dI.defaultProps={size:"10px",checked:!1,disabled:!1,hasErrors:!1};w9.default=dI;var E9={};const CU="_flex_ut0wl_59",IU="_radioButtonInput_ut0wl_98",AU="_requiredSymbol_ut0wl_103",LU="_contentOnly_ut0wl_110",PU="_disabled_ut0wl_110",RU="_hasErrors_ut0wl_116",eee={flex:CU,"main-content":"_main-content_ut0wl_86",radioButtonInput:IU,requiredSymbol:AU,contentOnly:LU,disabled:PU,hasErrors:RU},tee=Object.freeze(Object.defineProperty({__proto__:null,contentOnly:LU,default:eee,disabled:PU,flex:CU,hasErrors:RU,radioButtonInput:IU,requiredSymbol:AU},Symbol.toStringTag,{value:"Module"})),nee=Ls(tee);Object.defineProperty(E9,"__esModule",{value:!0});E9.default=void 0;var p1=S9(Lt),jh=S9(_o),ree=S9(w9),iee=S9(Ky),Aw=S9(nee);function S9(t){return t&&t.__esModule?t:{default:t}}const fI=t=>{const e={className:"".concat(Aw.default.radioButtonInput," ").concat(t.checked?Aw.default.checked:""," ").concat(t.disabled?Aw.default.disabled:""," ").concat(t.hasErrors?Aw.default.hasErrors:""),htmlFor:t.id},n={checked:t.checked,disabled:t.disabled,theme:t.theme,hasErrors:!t.contentOnly&&t.hasErrors},r={id:t.id,name:t.name||null,type:"radio",value:t.inputValue,checked:t.checked,disabled:t.disabled,required:t.required||t.requiredGroup,onChange:t.onChange,tabIndex:t.tabIndex||null,"aria-controls":t["aria-controls"],"aria-invalid":t.hasErrors?"true":null,"aria-describedby":t["aria-describedby"]};return p1.default.createElement("label",e,t.contentOnly?null:p1.default.createElement(p1.default.Fragment,null,p1.default.createElement(ree.default,n),p1.default.createElement("input",r)),p1.default.createElement("span",null,t.children,t.required&&p1.default.createElement("img",{src:iee.default,alt:"",className:Aw.default.requiredSymbol})))};fI.propTypes={checked:jh.default.bool,disabled:jh.default.bool,required:jh.default.bool,requiredGroup:jh.default.bool,id:jh.default.string.isRequired,name:jh.default.string,onChange:jh.default.func,contentOnly:jh.default.bool,hasErrors:jh.default.bool,theme:jh.default.object,inputValue:jh.default.string.isRequired,"aria-controls":jh.default.string,"aria-describedby":jh.default.string};fI.defaultProps={name:"",checked:!1,disabled:!1,required:!1,requiredGroup:!1,contentOnly:!1,hasErrors:!1};E9.default=fI;var QT={};const NU="_flex_a59pe_59",DU="_radioButtonList_a59pe_98",OU="_requiredSymbol_a59pe_113",see={flex:NU,"main-content":"_main-content_a59pe_86",radioButtonList:DU,requiredSymbol:OU},oee=Object.freeze(Object.defineProperty({__proto__:null,default:see,flex:NU,radioButtonList:DU,requiredSymbol:OU},Symbol.toStringTag,{value:"Module"})),aee=Ls(oee);Object.defineProperty(QT,"__esModule",{value:!0});QT.default=void 0;var Lw=eM(Lt),f7=eM(_o),lee=fl,uee=eM(Ky),yR=eM(aee);function eM(t){return t&&t.__esModule?t:{default:t}}const FU=t=>{var e;const n=r=>(0,lee.cloneThroughFragments)(r).map((u,p)=>{var g;const E=(u==null||(g=u.type)===null||g===void 0?void 0:g.name)==="RadioButtonListItem"?{requiredGroup:t.required,compact:t.compact,key:"radioButtonListItem-".concat(p)}:null;return Lw.default.cloneElement(u,E)});return Lw.default.createElement("fieldset",{className:yR.default.radioButtonList},(e=t.legend)!==null&&e!==void 0&&e.length?Lw.default.createElement("legend",null,t.legend,t.required&&Lw.default.createElement("img",{src:uee.default,alt:"",className:yR.default.requiredSymbol})):null,n(Lw.default.Children.toArray(t.children)))};FU.propTypes={legend:f7.default.string,required:f7.default.bool,compact:f7.default.bool};QT.default=FU;var tM={};const zU="_flex_or6d0_59",BU="_radioButtonListItem_or6d0_98",UU="_contentOnly_or6d0_122",jU="_compact_or6d0_122",VU="_disabled_or6d0_136",GU="_checked_or6d0_139",cee={flex:zU,"main-content":"_main-content_or6d0_86",radioButtonListItem:BU,contentOnly:UU,compact:jU,disabled:VU,checked:GU},hee=Object.freeze(Object.defineProperty({__proto__:null,checked:GU,compact:jU,contentOnly:UU,default:cee,disabled:VU,flex:zU,radioButtonListItem:BU},Symbol.toStringTag,{value:"Module"})),dee=Ls(hee);Object.defineProperty(tM,"__esModule",{value:!0});tM.default=void 0;var _R=nM(Lt),sh=nM(_o),fee=nM(E9),pee=fl,Pw=nM(dee);function nM(t){return t&&t.__esModule?t:{default:t}}const pI=t=>{const e=[Pw.default.radioButtonListItem,t.disabled?Pw.default.disabled:null,t.compact?Pw.default.compact:null,t.contentOnly?Pw.default.contentOnly:null,t.hasErrors?Pw.default.hasErrors:null],n=(0,pee.classNameArrayToClassNameString)(e),r={onChange:t.onChange,inputValue:t.inputValue,checked:t.checked,disabled:t.disabled,required:t.required,requiredGroup:t.requiredGroup,contentOnly:t.contentOnly,hasErrors:t.hasErrors,"aria-controls":t["aria-controls"],"aria-describedby":t["aria-describedby"],id:t.id,name:t.name,theme:t.theme};return _R.default.createElement("div",{className:n},_R.default.createElement(fee.default,r,t.children))};pI.propTypes={inputValue:sh.default.string.isRequired,checked:sh.default.bool,disabled:sh.default.bool,required:sh.default.bool,requiredGroup:sh.default.bool,name:sh.default.string,id:sh.default.string.isRequired,onChange:sh.default.func,contentOnly:sh.default.bool,compact:sh.default.bool,theme:sh.default.object,hasErrors:sh.default.bool,"aria-controls":sh.default.string,"aria-describedby":sh.default.string};pI.defaultProps={name:"",checked:!1,required:!1,requiredGroup:!1,disabled:!1,contentOnly:!1,hasErrors:!1};tM.default=pI;var rM={};const HU="_flex_a1wt4_59",WU="_select_a1wt4_98",qU="_requiredSymbol_a1wt4_98",$U="_selectContainer_a1wt4_105",XU="_selectListArrow_a1wt4_108",ZU="_multipleSelectDropdown_a1wt4_136",YU="_multipleSelectElement_a1wt4_148",KU="_multiple_a1wt4_136",JU="_hasErrors_a1wt4_209",mee={flex:HU,"main-content":"_main-content_a1wt4_86",select:WU,requiredSymbol:qU,selectContainer:$U,selectListArrow:XU,multipleSelectDropdown:ZU,multipleSelectElement:YU,multiple:KU,hasErrors:JU},gee=Object.freeze(Object.defineProperty({__proto__:null,default:mee,flex:HU,hasErrors:JU,multiple:KU,multipleSelectDropdown:ZU,multipleSelectElement:YU,requiredSymbol:qU,select:WU,selectContainer:$U,selectListArrow:XU},Symbol.toStringTag,{value:"Module"})),yee=Ls(gee);Object.defineProperty(rM,"__esModule",{value:!0});rM.default=void 0;var ul=Eee(Lt),ls=lv(_o),vR=lv(Qy),_ee=lv(Jy),vee=lv(_9),xee=lv(v9),p7=ao,bee=n3,xR=fl,wee=lv(Ky),Ag=lv(yee);function lv(t){return t&&t.__esModule?t:{default:t}}function QU(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(QU=function(r){return r?n:e})(t)}function Eee(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=QU(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}const mI=t=>{const[e,n]=(0,ul.useState)(!1),r=(0,ul.useRef)(),s=(0,ul.useCallback)(te=>{te&&(0,xR.addFocusTrapInsideElement)(te)},[]),u=()=>{n(!1)};(0,ul.useEffect)(()=>{const te=Se=>{switch(Se.keyCode){case 27:u();break;default:return null}},ce=Se=>{r!=null&&r.current&&!r.current.contains(Se.target)&&u()};document.addEventListener("mousedown",ce),document.addEventListener("keydown",te,!1)},[t,s]);const p=te=>({boxShadow:"0 0 3px ".concat((0,p7.getThemePaletteBackgroundColor)(te,"warning")),borderColor:(0,p7.getThemePaletteBackgroundColor)(te,"warning")}),g=te=>({borderTopColor:(0,p7.getThemePaletteBackgroundColor)(te,"primary")}),l=(te,ce)=>{const Se=ce&&ce.length?ce.find(Ie=>typeof Ie=="object"?Ie.value===te:Ie===te):null;return Se&&Se.key?Se.key:Se&&Se.value?Se.value:Se},E=te=>typeof te=="object"?{key:te.key?te.key:"",value:te.value?te.value:""}:{key:te,value:te},P=(te,ce)=>{const Se=ce.defaultValue||ce.value;return Se!=null&&Se.length?Se.map(Ie=>l(Ie,te)).join(", "):null},O=(te,ce)=>te.map((Se,Ie)=>{let Ne=E(Se);const ut=ce.defaultValue||ce.value,mt=ut&&ut.length&&ut.includes(Ne.value);return ul.default.createElement(xee.default,{key:Ie,id:"".concat(t.id,"-").concat(Ie),value:Ne.value,checked:mt,onChange:()=>ce.onChange(Ne.value),theme:t.theme},Ne.key)}),j=te=>te.map((ce,Se)=>{let Ie=E(ce);return ul.default.createElement("option",{value:Ie.value,key:Se},Ie.key)}),$=(te,ce)=>te?ul.default.createElement("option",{value:ce||"",disabled:!0},te):"",Y=()=>"".concat(t.id,"-errorMessage");if(t.contentOnly){const te=t.defaultValue?t.defaultValue:t.value||null;return ul.default.createElement("div",{className:Ag.default.select},ul.default.createElement(vR.default,{htmlFor:t.id},t.label),ul.default.createElement("span",null,te?t.keyAsContent?l(te,t.options):te:t.defaultContent))}else{var re,_e,J,H;const te=!t.value&&t.defaultValue?t.defaultValue:!1,ce={...t.hasErrors?p(t.theme):null,...((re=t.width)===null||re===void 0?void 0:re.length)&&{maxWidth:t.width}},Se=(0,xR.classNameArrayToClassNameString)([t.hasErrors&&Ag.default.hasErrors,t.multiple&&Ag.default.multiple]),Ie={name:t.name,multiple:t.multiple,required:t.required,disabled:t.disabled,[te?"defaultValue":"value"]:te||t.value||"",onChange:t.onChange,id:t.id,role:t.role,key:"".concat(t.id,"-").concat((0,bee.generateRandomString)(6)),className:Se,"aria-describedby":t.hasErrors&&((_e=t.errorMessage)!==null&&_e!==void 0&&_e.length)?Y():(J=t["aria-describedby"])!==null&&J!==void 0&&J.length?t["aria-describedby"]:null,"aria-invalid":t.hasErrors?"true":null,style:ce};return ul.default.createElement("div",{className:Ag.default.select},ul.default.createElement(vR.default,{htmlFor:t.id},t.label,t.required&&ul.default.createElement("img",{src:wee.default,alt:"",className:Ag.default.requiredSymbol})),ul.default.createElement("div",{className:Ag.default.selectContainer,style:{...((H=t.width)===null||H===void 0?void 0:H.length)&&{maxWidth:t.width}}},ul.default.createElement("span",{className:Ag.default.selectListArrow,style:g(t.theme)}),t.multiple?ul.default.createElement("div",{ref:r},ul.default.createElement("div",{onClick:()=>{n(!e)},className:Ag.default.multipleSelectElement},P(t.options,Ie)),e?ul.default.createElement("div",{className:Ag.default.multipleSelectDropdown},ul.default.createElement(vee.default,{compact:!0},O(t.options,Ie))):null):ul.default.createElement("select",Ie,$(t.placeholder,t.placeholderValue),j(t.options))),ul.default.createElement(_ee.default,{id:Y(),content:t.errorMessage,theme:t.theme}))}};mI.propTypes={id:ls.default.string.isRequired,onChange:ls.default.func.isRequired,name:ls.default.string,required:ls.default.bool,disabled:ls.default.bool,multiple:ls.default.bool,options:ls.default.arrayOf(ls.default.oneOfType([ls.default.oneOfType([ls.default.string,ls.default.number]),ls.default.shape({key:ls.default.oneOfType([ls.default.string,ls.default.number]),value:ls.default.oneOfType([ls.default.string,ls.default.number])})])),width:ls.default.string,value:ls.default.any,defaultValue:ls.default.any,label:ls.default.oneOfType([ls.default.string,ls.default.arrayOf(ls.default.oneOfType([ls.default.string,ls.default.object]))]),contentOnly:ls.default.bool,keyAsContent:ls.default.bool,placeholder:ls.default.string,placeholderValue:ls.default.string,defaultContent:ls.default.string,"aria-describedby":ls.default.string,hasErrors:ls.default.bool,errorMessage:ls.default.oneOfType([ls.default.string,ls.default.arrayOf(ls.default.oneOfType([ls.default.string,ls.default.object]))]),theme:ls.default.object};mI.defaultProps={onChange:()=>!1,name:"",required:!1,disabled:!1,options:[],label:"",contentOnly:!1,keyAsContent:!1,placeholder:null,placeholderValue:"",defaultContent:null,hasErrors:!1,errorMessage:""};rM.default=mI;var iM={};const ej="_flex_1ietc_59",tj="_table_1ietc_98",See={flex:ej,"main-content":"_main-content_1ietc_86",table:tj,"captionSide-top":"_captionSide-top_1ietc_111","captionSide-bottom":"_captionSide-bottom_1ietc_115","captionAlign-left":"_captionAlign-left_1ietc_119","captionAlign-center":"_captionAlign-center_1ietc_122","captionAlign-right":"_captionAlign-right_1ietc_125"},Tee=Object.freeze(Object.defineProperty({__proto__:null,default:See,flex:ej,table:tj},Symbol.toStringTag,{value:"Module"})),Mee=Ls(Tee);Object.defineProperty(iM,"__esModule",{value:!0});iM.default=void 0;var kee=gI(Lt),bR=gI(_o),Cee=fl,z5=gI(Mee);function gI(t){return t&&t.__esModule?t:{default:t}}const Iee=t=>{const e="left",n=["left","center","right"];return t!=null&&t.length&&n.includes(t)?z5.default["captionAlign-".concat(t)]:z5.default["captionAlign-".concat(e)]},Aee=t=>{const e="top",n=["top","bottom"];return t!=null&&t.length&&n.includes(t)?z5.default["captionSide-".concat(t)]:z5.default["captionSide-".concat(e)]},nj=t=>kee.default.createElement("table",{className:(0,Cee.classNameArrayToClassNameString)([z5.default.table,Iee(t.captionAlign),Aee(t.captionSide)])},t.children);nj.propTypes={captionAlign:bR.default.oneOf(["left","center","right"]),captionSide:bR.default.oneOf(["top","bottom"])};iM.default=nj;var sM={};const rj="_flex_1uino_59",ij="_textarea_1uino_98",sj="_requiredSymbol_1uino_101",oj="_hasErrors_1uino_151",Lee={flex:rj,"main-content":"_main-content_1uino_86",textarea:ij,requiredSymbol:sj,hasErrors:oj},Pee=Object.freeze(Object.defineProperty({__proto__:null,default:Lee,flex:rj,hasErrors:oj,requiredSymbol:sj,textarea:ij},Symbol.toStringTag,{value:"Module"})),Ree=Ls(Pee);Object.defineProperty(sM,"__esModule",{value:!0});sM.default=void 0;var kx=r3(Lt),po=r3(_o),Nee=r3(Qy),Dee=r3(Jy),wR=ao,Oee=n3,Fee=r3(Ky),m7=r3(Ree);function r3(t){return t&&t.__esModule?t:{default:t}}const yI=t=>{const e=u=>({boxShadow:"0 0 3px ".concat((0,wR.getThemePaletteBackgroundColor)(u,"warning")),borderColor:(0,wR.getThemePaletteBackgroundColor)(u,"warning")}),n=(u,p)=>u||p,r=()=>"".concat(t.id,"-errorMessage"),s=()=>{var u,p,g,l,E,P;const O=!((u=t.value)!==null&&u!==void 0&&u.length)&&(p=t.defaultValue)!==null&&p!==void 0&&p.length?t.defaultValue:!1,j=t.elementKey||null,$={...t.hasErrors?e(t.theme):null,...((g=t.width)===null||g===void 0?void 0:g.length)&&{maxWidth:t.width},...((l=t.resize)===null||l===void 0?void 0:l.length)&&{resize:t.resize}},Y={name:t.name,readOnly:t.readOnly,disabled:t.disabled,required:t.required,type:t.type,id:t.id,key:j||"".concat(t.id,"-").concat((0,Oee.generateRandomString)(6)),onChange:t.onChange,onBlur:t.onBlur,[O?"defaultValue":"value"]:O||t.value,placeholder:t.placeholder,rows:t.rows,className:t.hasErrors?m7.default.hasErrors:"","aria-describedby":t.hasErrors&&((E=t.errorMessage)!==null&&E!==void 0&&E.length)?r():(P=t["aria-describedby"])!==null&&P!==void 0&&P.length?t["aria-describedby"]:null,"aria-invalid":t.hasErrors?"true":null,style:$};return kx.default.createElement("textarea",Y)};return kx.default.createElement("div",{className:m7.default.textarea},kx.default.createElement(Nee.default,{htmlFor:t.id},t.label,t.required&&kx.default.createElement("img",{src:Fee.default,alt:"",className:m7.default.requiredSymbol})),t.contentOnly?kx.default.createElement("span",null,n(t.value||t.defaultValue,t.defaultContent)):s(),kx.default.createElement(Dee.default,{id:r(),content:t.errorMessage,theme:t.theme}))};yI.propTypes={id:po.default.string.isRequired,onChange:po.default.func.isRequired,onBlur:po.default.func,name:po.default.string,type:po.default.string,required:po.default.bool,width:po.default.string,resize:po.default.oneOf(["both","horizontal","vertical","none"]),value:po.default.string,defaultValue:po.default.string,elementKey:po.default.string,rows:po.default.string,label:po.default.oneOfType([po.default.string,po.default.arrayOf(po.default.oneOfType([po.default.string,po.default.object]))]),contentOnly:po.default.bool,placeholder:po.default.string,defaultContent:po.default.string,"aria-describedby":po.default.string,hasErrors:po.default.bool,errorMessage:po.default.oneOfType([po.default.string,po.default.arrayOf(po.default.oneOfType([po.default.string,po.default.object]))]),theme:po.default.object};yI.defaultProps={onChange:()=>!1,name:"",type:"text",required:!1,label:"",contentOnly:!1,resize:"both",placeholder:"",defaultContent:"",hasErrors:!1,errorMessage:""};sM.default=yI;var oM={},T9={};const aj="_flex_efxir_59",lj="_finished_efxir_98",uj="_wizardTopnavItem_efxir_102",cj="_wizardTopnavItemContent_efxir_108",hj="_stepNumber_efxir_146",dj="_stepName_efxir_165",fj="_active_efxir_178",pj="_hasErrors_efxir_189",zee={flex:aj,"main-content":"_main-content_efxir_86","wizard-topnav":"_wizard-topnav_efxir_98","wizard-topnav-item":"_wizard-topnav-item_efxir_98",finished:lj,"wizard-topnav-item-content":"_wizard-topnav-item-content_efxir_98",wizardTopnavItem:uj,wizardTopnavItemContent:cj,stepNumber:hj,stepName:dj,active:fj,hasErrors:pj},Bee=Object.freeze(Object.defineProperty({__proto__:null,active:fj,default:zee,finished:lj,flex:aj,hasErrors:pj,stepName:dj,stepNumber:hj,wizardTopnavItem:uj,wizardTopnavItemContent:cj},Symbol.toStringTag,{value:"Module"})),Uee=Ls(Bee);Object.defineProperty(T9,"__esModule",{value:!0});T9.default=void 0;var m1=Gee(Lt),Rw=mj(_o),jee=vz,Vee=fl,ry=mj(Uee);function mj(t){return t&&t.__esModule?t:{default:t}}function gj(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(gj=function(r){return r?n:e})(t)}function Gee(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=gj(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var p=s?Object.getOwnPropertyDescriptor(t,u):null;p&&(p.get||p.set)?Object.defineProperty(r,u,p):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}const yj=t=>{const e=l=>t.activeStepId===l.id?ry.default.active:"",n=l=>l.finished?ry.default.finished:"",r=l=>l.hasErrors?ry.default.hasErrors:"",s=(l,E)=>m1.default.createElement(m1.Fragment,null,m1.default.createElement("span",{className:ry.default.stepNumber},E+1),m1.default.createElement("span",{className:ry.default.stepName},l.name)),{step:u,index:p,activeStepId:g}=t;return m1.default.createElement("li",{className:(0,Vee.classNameArrayToClassNameString)([ry.default.wizardTopnavItem,e(u),n(u),r(u)])},u.link&&Object.keys(u.link).length?m1.default.createElement(jee.Link,{to:u.link,"aria-current":g===u.id?"step":null,className:ry.default.wizardTopnavItemContent},s(u,p)):m1.default.createElement("span",{"aria-current":g===u.id?"step":null,className:ry.default.wizardTopnavItemContent},s(u,p)))};yj.propTypes={step:Rw.default.object.isRequired,activeStepId:Rw.default.oneOfType([Rw.default.string,Rw.default.number]).isRequired,index:Rw.default.number.isRequired};T9.default=yj;const _j="_flex_1gj4h_59",vj="_wizardTopnav_1gj4h_98",Hee={flex:_j,"main-content":"_main-content_1gj4h_86",wizardTopnav:vj},Wee=Object.freeze(Object.defineProperty({__proto__:null,default:Hee,flex:_j,wizardTopnav:vj},Symbol.toStringTag,{value:"Module"})),qee=Ls(Wee);Object.defineProperty(oM,"__esModule",{value:!0});oM.default=void 0;var g7=aM(Lt),oh=aM(_o),$ee=aM(T9),Xee=aM(qee);function aM(t){return t&&t.__esModule?t:{default:t}}const xj=t=>{var e,n;const r=(g,l)=>g&&Object.keys(g).length?Object.keys(g).map((P,O)=>{const j=g[P];return g7.default.createElement($ee.default,{step:j,activeStepId:l,index:O,key:P})}):null,s=t.steps&&(e=Object.keys(t.steps))!==null&&e!==void 0&&e.length?Object.keys(t.steps).length:0,u="I dette skjemaet er det totalt ".concat(s," steg som du skal g igjennom"),p=(n=t["aria-label"])!==null&&n!==void 0&&n.length?t["aria-label"]:u;return g7.default.createElement("nav",{"aria-label":p},g7.default.createElement("ol",{className:Xee.default.wizardTopnav},r(t.steps,t.activeStepId)))};xj.propTypes={steps:oh.default.shape({id:oh.default.oneOfType([oh.default.string,oh.default.number]),name:oh.default.string,finished:oh.default.bool,hasErrors:oh.default.bool,link:oh.default.shape({to:oh.default.object,reactLink:oh.default.bool})}).isRequired,activeStepId:oh.default.oneOfType([oh.default.string,oh.default.number]).isRequired,"aria-label":oh.default.string};oM.default=xj;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Accordion",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"Button",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"CheckBoxIcon",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"CheckBoxInput",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"CheckBoxList",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"CheckBoxListItem",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"Container",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"ContentBox",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Dialog",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"DragAndDropFileInput",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(t,"ErrorBox",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"ErrorMessage",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(t,"Footer",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(t,"InputField",{enumerable:!0,get:function(){return re.default}}),Object.defineProperty(t,"Label",{enumerable:!0,get:function(){return _e.default}}),Object.defineProperty(t,"List",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(t,"ListItem",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(t,"LoadingAnimation",{enumerable:!0,get:function(){return te.default}}),Object.defineProperty(t,"NavigationBar",{enumerable:!0,get:function(){return ce.default}}),Object.defineProperty(t,"NavigationBarListItem",{enumerable:!0,get:function(){return Se.default}}),Object.defineProperty(t,"Paper",{enumerable:!0,get:function(){return Ie.default}}),Object.defineProperty(t,"ProgressBar",{enumerable:!0,get:function(){return Ne.default}}),Object.defineProperty(t,"RadioButtonIcon",{enumerable:!0,get:function(){return ut.default}}),Object.defineProperty(t,"RadioButtonInput",{enumerable:!0,get:function(){return mt.default}}),Object.defineProperty(t,"RadioButtonList",{enumerable:!0,get:function(){return We.default}}),Object.defineProperty(t,"RadioButtonListItem",{enumerable:!0,get:function(){return Ot.default}}),Object.defineProperty(t,"Select",{enumerable:!0,get:function(){return st.default}}),Object.defineProperty(t,"Table",{enumerable:!0,get:function(){return qe.default}}),Object.defineProperty(t,"Textarea",{enumerable:!0,get:function(){return et.default}}),Object.defineProperty(t,"WizardNavigation",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(t,"WizardNavigationStep",{enumerable:!0,get:function(){return ye.default}});var e=ge(OT),n=ge(e3),r=ge(m9),s=ge(g9),u=ge(_9),p=ge(v9),g=ge(x9),l=ge(BT),E=ge(UT),P=ge(jT),O=ge(VT),j=ge(Jy),$=ge(GT),Y=ge(HT),re=ge(WT),_e=ge(Qy),J=ge(qT),H=ge($T),te=ge(XT),ce=ge(ZT),Se=ge(b9),Ie=ge(KT),Ne=ge(JT),ut=ge(w9),mt=ge(E9),We=ge(QT),Ot=ge(tM),st=ge(rM),qe=ge(iM),et=ge(sM),Q=ge(oM),ye=ge(T9);function ge(xe){return xe&&xe.__esModule?xe:{default:xe}}})(wa);function Zee(){return xn.jsxs("div",{className:TK.app,children:[xn.jsx(wa.NavigationBar,{logoLink:"/",logoLinkTitle:"G til forside",primaryListItems:[],secondaryListItems:[],children:xn.jsx("span",{children:"NB! Betaversjon av demonstrator - kun ment for test av funksjonalitet og ulike scenario"})}),xn.jsx(cF,{}),xn.jsx(wa.Footer,{children:xn.jsx("span",{children:xn.jsx("a",{href:"/Disclaimer",children:"Disclaimer"})})})]})}const bj="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20fill='%2383bf4f'%3e%3cellipse%20cx='17.8'%20cy='38.3'%20rx='15.8'%20ry='15.2'/%3e%3cellipse%20cx='17.8'%20cy='21.4'%20rx='15'%20ry='14.4'/%3e%3cellipse%20cx='34.2'%20cy='16.9'%20rx='15.5'%20ry='14.9'/%3e%3cellipse%20cx='49'%20cy='28.5'%20rx='13'%20ry='12.5'/%3e%3cellipse%20cx='39.5'%20cy='40.2'%20rx='13'%20ry='12.5'/%3e%3c/g%3e%3cg%20fill='%23947151'%3e%3cpath%20d='M28.9%2064c.3-4-.3-8.2-.9-12.6c-.6-4.4-1.4-8.9-1.4-13.5c-.1-4.6.5-9.3%202.1-13.6c1.5-4.3%203.8-8.2%206.5-11.7c-2.3%203.8-4%207.9-4.9%2012.2c-.9%204.2-.9%208.6-.3%2012.8c.6%204.2%201.8%208.4%203.1%2012.7c1.2%204.3%202.5%208.8%202.8%2013.7h-7'/%3e%3cpath%20d='M28.4%2036.2c2%20.2%204.2.1%206.3-.1c2.1-.2%204.2-.7%206.2-1.4s3.9-1.7%205.6-3c1.7-1.3%203.2-2.9%204.3-4.8c-1%201.9-2.3%203.7-4%205.2c-1.6%201.5-3.5%202.6-5.6%203.5c-2%20.9-4.2%201.5-6.3%202c-2.2.4-4.4.7-6.7.6l.2-2m-.6-1.4c-1.5-.9-2.8-1.9-4-2.9c-1.2-1.1-2.4-2.3-3.4-3.5c-2-2.6-3.5-5.7-3.7-8.9c.5%203.2%202.3%206%204.5%208.2c1.1%201.1%202.3%202.1%203.6%203c1.3.9%202.7%201.7%204%202.3l-1%201.8m1.6%2011.4c-1.7-.1-3.3-.4-4.9-.8c-1.6-.4-3.1-1-4.6-1.8c-2.9-1.6-5.4-3.9-6.9-6.8c1.8%202.7%204.4%204.7%207.3%205.8c1.4.6%203%201%204.5%201.3c1.5.3%203.1.4%204.6.3v2'/%3e%3c/g%3e%3cpath%20fill='%2375a843'%20d='M9.8%2041.9c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m46.3-8.6c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204M14.8%2047c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m-5-26.1c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m5-5.8c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204M40.5%2018c0%202.2-1.8%204-1.8%204S37%2020.2%2037%2018s1.8-4%201.8-4s1.7%201.8%201.7%204m5-5.4c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204M22.2%2035.8c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m-5.6-5.1c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m9.5-9.8c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204M30%2014c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m5.4%2016.7c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204M49%2039.8c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m-3.5-16.7c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m-6%2019.9c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204m4.7%204.5c0%202.2-1.8%204-1.8%204s-1.8-1.8-1.8-4s1.8-4%201.8-4s1.8%201.8%201.8%204'/%3e%3c/svg%3e";function Yee(){return xn.jsxs(wa.Container,{children:[xn.jsx(wa.Header,{big:!0,children:xn.jsx(bm.Fragment,{children:"Hva kan jeg bygge?"},".0")}),xn.jsx(wa.Paper,{children:xn.jsx("p",{children:"Det finnes i alt 15 sektormyndigheter som kan ha uttalelser i en byggesak. Miljdirektoratet er en av dem. Ofte vet ikke skerne om disse forholdene p forhnd og det er utfordrende for dem  forst hva de betyr for sknaden. De dukker gjerne opp sent i prosessen, etter at skeren har investert mye i prosjektet, bde emosjonelt, i tid brukt til planlegging og kanskje ogs kostnader, for eksempel til arkitekthjelp. Denne demonstratoren har til hensikt  vise hvordan tilgjengeliggjring av temadata kan forenkle byggesknadsprosessen for alle involverte parter. Den viser et tenkt framtidig scenario, med fokus p skerens opplevelse av prosessen."})}),xn.jsx(wa.ContentBox,{color:"lightCyan",title:"Brukerhistorier",children:xn.jsx(bm.Fragment,{children:"I samarbeid med flere etater har vi utarbeidet ulike brukerhistorier for  illustrere hvordan bruk av kartlsninger, datasett fra offentlige registre og veiledningstekster kan hjelpe innbyggere til  se muligheter og eventuelle begrensninger p sine eiendommer. Dette er en demonstrator som ikke kan benyttes som kilde til en eventuell byggesknad."},".0")}),xn.jsx(wa.Accordion,{color:"lightCyan",onToggleExpand:function(){},title:"Hul Eik",children:xn.jsxs(bm.Fragment,{children:[xn.jsx("img",{src:bj}),xn.jsx("p",{children:"Synnve ( 65) tannlege"}),xn.jsx("p",{children:"Hun tok over barndomshjemmet p Ullevl for noen r siden. Vedlikehold av huset og stell av den store hagen ble for mye for foreldrene hennes."}),xn.jsx("p",{children:"Synnves datter har n stiftet familie, og sammen planlegger de  bygge en ny bolig p den store tomta."}),xn.jsx("p",{children:"Synnve har ikke behov for s mye plass og vil bo i den nye enheten, mens datteren og familien hennes vil ta over det gamle huset."}),xn.jsx("p",{children:"Vil det vre plass til  bygge et lite hus p tomta?"}),xn.jsx("a",{href:"/kart/oslo/garasje",children:"Sjekk kartet og utforsk mulighetene!"}),xn.jsx(TC,{to:"/kart/oslo/garasje",children:"Sjekk kartet og utforsk mulighetene! "})]},".0")}),xn.jsx(wa.Accordion,{color:"lightCyan",onToggleExpand:function(){},title:"Stormflo",children:xn.jsxs(bm.Fragment,{children:[xn.jsx("p",{children:"Gudrun og Arne vil bygge hytte"}),xn.jsx("p",{children:"Eiendommen de vil bygge p kan vre berrt av flere ulike typer farer."}),xn.jsx("a",{href:"/kart",children:" Se hytta i kartet her"})]},".2")}),xn.jsx(wa.Accordion,{color:"lightCyan",onToggleExpand:function(){},title:"Slttemark",children:xn.jsx(bm.Fragment,{children:xn.jsx("a",{href:"/kart",children:" TBA "})},".1")}),xn.jsx(wa.Accordion,{color:"lightCyan",onToggleExpand:function(){},title:"Innkjrsel - fri sikt og sikkerhetssoner",children:xn.jsx(bm.Fragment,{children:xn.jsx("a",{href:"/kart",children:" TBA "})},".1")})]})}function Kee({location:t,building:e,children:n}){const[r,s]=Lt.useState(null),u=Lt.useRef(null);function p(){return u.current}function g(l){u.current=l}return xn.jsx(wj.Provider,{value:{map:r,setMap:s,getBuilding:p,setBuilding:g,location:t,building:e},children:n})}const wj=Lt.createContext({}),Ej=()=>Lt.useContext(wj);var i3={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sj=Lt;function rs(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lh=Object.prototype.hasOwnProperty,Jee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ER={},SR={};function Tj(t){return lh.call(SR,t)?!0:lh.call(ER,t)?!1:Jee.test(t)?SR[t]=!0:(ER[t]=!0,!1)}function Fc(t,e,n,r,s,u,p){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=u,this.removeEmptyString=p}var Ou={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ou[t]=new Fc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ou[e]=new Fc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ou[t]=new Fc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ou[t]=new Fc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ou[t]=new Fc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ou[t]=new Fc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ou[t]=new Fc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ou[t]=new Fc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ou[t]=new Fc(t,5,!1,t.toLowerCase(),null,!1,!1)});var _I=/[\-:]([a-z])/g;function vI(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(_I,vI);Ou[e]=new Fc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(_I,vI);Ou[e]=new Fc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(_I,vI);Ou[e]=new Fc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ou[t]=new Fc(t,1,!1,t.toLowerCase(),null,!1,!1)});Ou.xlinkHref=new Fc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ou[t]=new Fc(t,1,!1,t.toLowerCase(),null,!0,!0)});var SE={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qee=["Webkit","ms","Moz","O"];Object.keys(SE).forEach(function(t){Qee.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),SE[e]=SE[t]})});var ete=/["'&<>]/;function Mc(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=ete.exec(t);if(e){var n="",r,s=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==r&&(n+=t.substring(s,r)),s=r+1,n+=e}t=s!==r?n+t.substring(s,r):n}return t}var tte=/([A-Z])/g,nte=/^ms-/,Uk=Array.isArray;function Lg(t,e){return{insertionMode:t,selectedValue:e}}function rte(t,e,n){switch(e){case"select":return Lg(1,n.value!=null?n.value:n.defaultValue);case"svg":return Lg(2,null);case"math":return Lg(3,null);case"foreignObject":return Lg(1,null);case"table":return Lg(4,null);case"thead":case"tbody":case"tfoot":return Lg(5,null);case"colgroup":return Lg(7,null);case"tr":return Lg(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Lg(1,null):t}var TR=new Map;function Mj(t,e,n){if(typeof n!="object")throw Error(rs(62));e=!0;for(var r in n)if(lh.call(n,r)){var s=n[r];if(s!=null&&typeof s!="boolean"&&s!==""){if(r.indexOf("--")===0){var u=Mc(r);s=Mc((""+s).trim())}else{u=r;var p=TR.get(u);p!==void 0||(p=Mc(u.replace(tte,"-$1").toLowerCase().replace(nte,"-ms-")),TR.set(u,p)),u=p,s=typeof s=="number"?s===0||lh.call(SE,r)?""+s:s+"px":Mc((""+s).trim())}e?(e=!1,t.push(' style="',u,":",s)):t.push(";",u,":",s)}}e||t.push('"')}function Vh(t,e,n,r){switch(n){case"style":Mj(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Ou.hasOwnProperty(n)?Ou[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=e.attributeName,e.type){case 3:r&&t.push(" ",n,'=""');break;case 4:r===!0?t.push(" ",n,'=""'):r!==!1&&t.push(" ",n,'="',Mc(r),'"');break;case 5:isNaN(r)||t.push(" ",n,'="',Mc(r),'"');break;case 6:!isNaN(r)&&1<=r&&t.push(" ",n,'="',Mc(r),'"');break;default:e.sanitizeURL&&(r=""+r),t.push(" ",n,'="',Mc(r),'"')}}else if(Tj(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",n,'="',Mc(r),'"')}}}function TE(t,e,n){if(e!=null){if(n!=null)throw Error(rs(60));if(typeof e!="object"||!("__html"in e))throw Error(rs(61));e=e.__html,e!=null&&t.push(""+e)}}function ite(t){var e="";return Sj.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}function y7(t,e,n,r){t.push(dm(n));var s=n=null,u;for(u in e)if(lh.call(e,u)){var p=e[u];if(p!=null)switch(u){case"children":n=p;break;case"dangerouslySetInnerHTML":s=p;break;default:Vh(t,r,u,p)}}return t.push(">"),TE(t,s,n),typeof n=="string"?(t.push(Mc(n)),null):n}var ste=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,MR=new Map;function dm(t){var e=MR.get(t);if(e===void 0){if(!ste.test(t))throw Error(rs(65,t));e="<"+t,MR.set(t,e)}return e}function ote(t,e,n,r,s){switch(e){case"select":t.push(dm("select"));var u=null,p=null;for(P in n)if(lh.call(n,P)){var g=n[P];if(g!=null)switch(P){case"children":u=g;break;case"dangerouslySetInnerHTML":p=g;break;case"defaultValue":case"value":break;default:Vh(t,r,P,g)}}return t.push(">"),TE(t,p,u),u;case"option":p=s.selectedValue,t.push(dm("option"));var l=g=null,E=null,P=null;for(u in n)if(lh.call(n,u)){var O=n[u];if(O!=null)switch(u){case"children":g=O;break;case"selected":E=O;break;case"dangerouslySetInnerHTML":P=O;break;case"value":l=O;default:Vh(t,r,u,O)}}if(p!=null)if(n=l!==null?""+l:ite(g),Uk(p)){for(r=0;r<p.length;r++)if(""+p[r]===n){t.push(' selected=""');break}}else""+p===n&&t.push(' selected=""');else E&&t.push(' selected=""');return t.push(">"),TE(t,P,g),g;case"textarea":t.push(dm("textarea")),P=p=u=null;for(g in n)if(lh.call(n,g)&&(l=n[g],l!=null))switch(g){case"children":P=l;break;case"value":u=l;break;case"defaultValue":p=l;break;case"dangerouslySetInnerHTML":throw Error(rs(91));default:Vh(t,r,g,l)}if(u===null&&p!==null&&(u=p),t.push(">"),P!=null){if(u!=null)throw Error(rs(92));if(Uk(P)&&1<P.length)throw Error(rs(93));u=""+P}return typeof u=="string"&&u[0]===`
`&&t.push(`
`),u!==null&&t.push(Mc(""+u)),null;case"input":t.push(dm("input")),l=P=g=u=null;for(p in n)if(lh.call(n,p)&&(E=n[p],E!=null))switch(p){case"children":case"dangerouslySetInnerHTML":throw Error(rs(399,"input"));case"defaultChecked":l=E;break;case"defaultValue":g=E;break;case"checked":P=E;break;case"value":u=E;break;default:Vh(t,r,p,E)}return P!==null?Vh(t,r,"checked",P):l!==null&&Vh(t,r,"checked",l),u!==null?Vh(t,r,"value",u):g!==null&&Vh(t,r,"value",g),t.push("/>"),null;case"menuitem":t.push(dm("menuitem"));for(var j in n)if(lh.call(n,j)&&(u=n[j],u!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(rs(400));default:Vh(t,r,j,u)}return t.push(">"),null;case"title":t.push(dm("title")),u=null;for(O in n)if(lh.call(n,O)&&(p=n[O],p!=null))switch(O){case"children":u=p;break;case"dangerouslySetInnerHTML":throw Error(rs(434));default:Vh(t,r,O,p)}return t.push(">"),u;case"listing":case"pre":t.push(dm(e)),p=u=null;for(l in n)if(lh.call(n,l)&&(g=n[l],g!=null))switch(l){case"children":u=g;break;case"dangerouslySetInnerHTML":p=g;break;default:Vh(t,r,l,g)}if(t.push(">"),p!=null){if(u!=null)throw Error(rs(60));if(typeof p!="object"||!("__html"in p))throw Error(rs(61));n=p.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(`
`,n):t.push(""+n))}return typeof u=="string"&&u[0]===`
`&&t.push(`
`),u;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(dm(e));for(var $ in n)if(lh.call(n,$)&&(u=n[$],u!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(rs(399,e));default:Vh(t,r,$,u)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return y7(t,n,e,r);case"html":return s.insertionMode===0&&t.push("<!DOCTYPE html>"),y7(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return y7(t,n,e,r);t.push(dm(e)),p=u=null;for(E in n)if(lh.call(n,E)&&(g=n[E],g!=null))switch(E){case"children":u=g;break;case"dangerouslySetInnerHTML":p=g;break;case"style":Mj(t,r,g);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:Tj(E)&&typeof g!="function"&&typeof g!="symbol"&&t.push(" ",E,'="',Mc(g),'"')}return t.push(">"),TE(t,p,u),u}}function kR(t,e,n){if(t.push('<!--$?--><template id="'),n===null)throw Error(rs(395));return t.push(n),t.push('"></template>')}function ate(t,e,n,r){switch(n.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=r.toString(16),t.push(e),t.push('">');default:throw Error(rs(397))}}function lte(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(rs(397))}}var ute=/[<\u2028\u2029]/g;function _7(t){return JSON.stringify(t).replace(ute,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function cte(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function CR(t,e,n,r){return n.generateStaticMarkup?(t.push(Mc(e)),!1):(e===""?t=r:(r&&t.push("<!-- -->"),t.push(Mc(e)),t=!0),t)}var a5=Object.assign,hte=Symbol.for("react.element"),kj=Symbol.for("react.portal"),Cj=Symbol.for("react.fragment"),Ij=Symbol.for("react.strict_mode"),Aj=Symbol.for("react.profiler"),Lj=Symbol.for("react.provider"),Pj=Symbol.for("react.context"),Rj=Symbol.for("react.forward_ref"),Nj=Symbol.for("react.suspense"),Dj=Symbol.for("react.suspense_list"),Oj=Symbol.for("react.memo"),xI=Symbol.for("react.lazy"),dte=Symbol.for("react.scope"),fte=Symbol.for("react.debug_trace_mode"),pte=Symbol.for("react.legacy_hidden"),mte=Symbol.for("react.default_value"),IR=Symbol.iterator;function jk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cj:return"Fragment";case kj:return"Portal";case Aj:return"Profiler";case Ij:return"StrictMode";case Nj:return"Suspense";case Dj:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Pj:return(t.displayName||"Context")+".Consumer";case Lj:return(t._context.displayName||"Context")+".Provider";case Rj:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Oj:return e=t.displayName||null,e!==null?e:jk(t.type)||"Memo";case xI:e=t._payload,t=t._init;try{return jk(t(e))}catch{}}return null}var Fj={};function AR(t,e){if(t=t.contextTypes,!t)return Fj;var n={},r;for(r in t)n[r]=e[r];return n}var L1=null;function lM(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(rs(401))}else{if(n===null)throw Error(rs(401));lM(t,n)}e.context._currentValue2=e.value}}function zj(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&zj(t)}function Bj(t){var e=t.parent;e!==null&&Bj(e),t.context._currentValue2=t.value}function Uj(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(rs(402));t.depth===e.depth?lM(t,e):Uj(t,e)}function jj(t,e){var n=e.parent;if(n===null)throw Error(rs(402));t.depth===n.depth?lM(t,n):jj(t,n),e.context._currentValue2=e.value}function _S(t){var e=L1;e!==t&&(e===null?Bj(t):t===null?zj(e):e.depth===t.depth?lM(e,t):e.depth>t.depth?Uj(e,t):jj(e,t),L1=t)}var LR={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function PR(t,e,n,r){var s=t.state!==void 0?t.state:null;t.updater=LR,t.props=n,t.state=s;var u={queue:[],replace:!1};t._reactInternals=u;var p=e.contextType;if(t.context=typeof p=="object"&&p!==null?p._currentValue2:r,p=e.getDerivedStateFromProps,typeof p=="function"&&(p=p(n,s),s=p==null?s:a5({},s,p),t.state=s),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&LR.enqueueReplaceState(t,t.state,null),u.queue!==null&&0<u.queue.length)if(e=u.queue,p=u.replace,u.queue=null,u.replace=!1,p&&e.length===1)t.state=e[0];else{for(u=p?e[0]:t.state,s=!0,p=p?1:0;p<e.length;p++){var g=e[p];g=typeof g=="function"?g.call(t,u,n,r):g,g!=null&&(s?(s=!1,u=a5({},u,g)):a5(u,g))}t.state=u}else u.queue=null}var gte={id:1,overflow:""};function Vk(t,e,n){var r=t.id;t=t.overflow;var s=32-ME(r)-1;r&=~(1<<s),n+=1;var u=32-ME(e)+s;if(30<u){var p=s-s%5;return u=(r&(1<<p)-1).toString(32),r>>=p,s-=p,{id:1<<32-ME(e)+s|n<<s|r,overflow:u+t}}return{id:1<<u|n<<s|r,overflow:t}}var ME=Math.clz32?Math.clz32:vte,yte=Math.log,_te=Math.LN2;function vte(t){return t>>>=0,t===0?32:31-(yte(t)/_te|0)|0}function xte(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bte=typeof Object.is=="function"?Object.is:xte,$g=null,bI=null,kE=null,Xo=null,Hw=!1,vS=!1,B5=0,yy=null,uM=0;function b1(){if($g===null)throw Error(rs(321));return $g}function RR(){if(0<uM)throw Error(rs(312));return{memoizedState:null,queue:null,next:null}}function wI(){return Xo===null?kE===null?(Hw=!1,kE=Xo=RR()):(Hw=!0,Xo=kE):Xo.next===null?(Hw=!1,Xo=Xo.next=RR()):(Hw=!0,Xo=Xo.next),Xo}function EI(){bI=$g=null,vS=!1,kE=null,uM=0,Xo=yy=null}function Vj(t,e){return typeof e=="function"?e(t):e}function NR(t,e,n){if($g=b1(),Xo=wI(),Hw){var r=Xo.queue;if(e=r.dispatch,yy!==null&&(n=yy.get(r),n!==void 0)){yy.delete(r),r=Xo.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Xo.memoizedState=r,[r,e]}return[Xo.memoizedState,e]}return t=t===Vj?typeof e=="function"?e():e:n!==void 0?n(e):e,Xo.memoizedState=t,t=Xo.queue={last:null,dispatch:null},t=t.dispatch=wte.bind(null,$g,t),[Xo.memoizedState,t]}function DR(t,e){if($g=b1(),Xo=wI(),e=e===void 0?null:e,Xo!==null){var n=Xo.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var s=0;s<r.length&&s<e.length;s++)if(!bte(e[s],r[s])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Xo.memoizedState=[t,e],t}function wte(t,e,n){if(25<=uM)throw Error(rs(301));if(t===$g)if(vS=!0,t={action:n,next:null},yy===null&&(yy=new Map),n=yy.get(e),n===void 0)yy.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function Ete(){throw Error(rs(394))}function tE(){}var OR={readContext:function(t){return t._currentValue2},useContext:function(t){return b1(),t._currentValue2},useMemo:DR,useReducer:NR,useRef:function(t){$g=b1(),Xo=wI();var e=Xo.memoizedState;return e===null?(t={current:t},Xo.memoizedState=t):e},useState:function(t){return NR(Vj,t)},useInsertionEffect:tE,useLayoutEffect:function(){},useCallback:function(t,e){return DR(function(){return t},e)},useImperativeHandle:tE,useEffect:tE,useDebugValue:tE,useDeferredValue:function(t){return b1(),t},useTransition:function(){return b1(),[!1,Ete]},useId:function(){var t=bI.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-ME(t)-1)).toString(32)+e;var n=CE;if(n===null)throw Error(rs(404));return e=B5++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return b1(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(rs(407));return n()}},CE=null,v7=Sj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Ste(t){return console.error(t),null}function Ww(){}function Tte(t,e,n,r,s,u,p,g,l){var E=[],P=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:P,pingedTasks:E,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:s===void 0?Ste:s,onAllReady:u===void 0?Ww:u,onShellReady:p===void 0?Ww:p,onShellError:g===void 0?Ww:g,onFatalError:l===void 0?Ww:l},n=xS(e,0,null,n,!1,!1),n.parentFlushed=!0,t=SI(e,t,null,n,P,Fj,null,gte),E.push(t),e}function SI(t,e,n,r,s,u,p,g){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var E=t.pingedTasks;E.push(l),E.length===1&&Wj(t)},blockedBoundary:n,blockedSegment:r,abortSet:s,legacyContext:u,context:p,treeContext:g};return s.add(l),l}function xS(t,e,n,r,s,u){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:s,textEmbedded:u}}function U5(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function bS(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function FR(t,e,n,r,s){for($g={},bI=e,B5=0,t=n(r,s);vS;)vS=!1,B5=0,uM+=1,Xo=null,t=n(r,s);return EI(),t}function zR(t,e,n,r){var s=n.render(),u=r.childContextTypes;if(u!=null){var p=e.legacyContext;if(typeof n.getChildContext!="function")r=p;else{n=n.getChildContext();for(var g in n)if(!(g in u))throw Error(rs(108,jk(r)||"Unknown",g));r=a5({},p,n)}e.legacyContext=r,Wh(t,e,s),e.legacyContext=p}else Wh(t,e,s)}function BR(t,e){if(t&&t.defaultProps){e=a5({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gk(t,e,n,r,s){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){s=AR(n,e.legacyContext);var u=n.contextType;u=new n(r,typeof u=="object"&&u!==null?u._currentValue2:s),PR(u,n,r,s),zR(t,e,u,n)}else{u=AR(n,e.legacyContext),s=FR(t,e,n,r,u);var p=B5!==0;if(typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0)PR(s,n,r,u),zR(t,e,s,n);else if(p){r=e.treeContext,e.treeContext=Vk(r,1,0);try{Wh(t,e,s)}finally{e.treeContext=r}}else Wh(t,e,s)}else if(typeof n=="string"){switch(s=e.blockedSegment,u=ote(s.chunks,n,r,t.responseState,s.formatContext),s.lastPushedText=!1,p=s.formatContext,s.formatContext=rte(p,n,r),Hk(t,e,u),s.formatContext=p,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:s.chunks.push("</",n,">")}s.lastPushedText=!1}else{switch(n){case pte:case fte:case Ij:case Aj:case Cj:Wh(t,e,r.children);return;case Dj:Wh(t,e,r.children);return;case dte:throw Error(rs(343));case Nj:e:{n=e.blockedBoundary,s=e.blockedSegment,u=r.fallback,r=r.children,p=new Set;var g={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:p,errorDigest:null},l=xS(t,s.chunks.length,g,s.formatContext,!1,!1);s.children.push(l),s.lastPushedText=!1;var E=xS(t,0,null,s.formatContext,!1,!1);E.parentFlushed=!0,e.blockedBoundary=g,e.blockedSegment=E;try{if(Hk(t,e,r),t.responseState.generateStaticMarkup||E.lastPushedText&&E.textEmbedded&&E.chunks.push("<!-- -->"),E.status=1,wS(g,E),g.pendingTasks===0)break e}catch(P){E.status=4,g.forceClientRender=!0,g.errorDigest=U5(t,P)}finally{e.blockedBoundary=n,e.blockedSegment=s}e=SI(t,u,n,l,p,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Rj:if(r=FR(t,e,n.render,r,s),B5!==0){n=e.treeContext,e.treeContext=Vk(n,1,0);try{Wh(t,e,r)}finally{e.treeContext=n}}else Wh(t,e,r);return;case Oj:n=n.type,r=BR(n,r),Gk(t,e,n,r,s);return;case Lj:if(s=r.children,n=n._context,r=r.value,u=n._currentValue2,n._currentValue2=r,p=L1,L1=r={parent:p,depth:p===null?0:p.depth+1,context:n,parentValue:u,value:r},e.context=r,Wh(t,e,s),t=L1,t===null)throw Error(rs(403));r=t.parentValue,t.context._currentValue2=r===mte?t.context._defaultValue:r,t=L1=t.parent,e.context=t;return;case Pj:r=r.children,r=r(n._currentValue2),Wh(t,e,r);return;case xI:s=n._init,n=s(n._payload),r=BR(n,r),Gk(t,e,n,r,void 0);return}throw Error(rs(130,n==null?n:typeof n,""))}}function Wh(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case hte:Gk(t,e,n.type,n.props,n.ref);return;case kj:throw Error(rs(257));case xI:var r=n._init;n=r(n._payload),Wh(t,e,n);return}if(Uk(n)){UR(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=IR&&n[IR]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var s=[];do s.push(n.value),n=r.next();while(!n.done);UR(t,e,s)}return}throw t=Object.prototype.toString.call(n),Error(rs(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=CR(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=CR(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function UR(t,e,n){for(var r=n.length,s=0;s<r;s++){var u=e.treeContext;e.treeContext=Vk(u,r,s);try{Hk(t,e,n[s])}finally{e.treeContext=u}}}function Hk(t,e,n){var r=e.blockedSegment.formatContext,s=e.legacyContext,u=e.context;try{return Wh(t,e,n)}catch(l){if(EI(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var p=e.blockedSegment,g=xS(t,p.chunks.length,null,p.formatContext,p.lastPushedText,!0);p.children.push(g),p.lastPushedText=!1,t=SI(t,e.node,e.blockedBoundary,g,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=s,e.context=u,_S(u)}else throw e.blockedSegment.formatContext=r,e.legacyContext=s,e.context=u,_S(u),l}}function Mte(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,Hj(this,e,t)}function Gj(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(rs(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(s){return Gj(s,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function wS(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&wS(t,n)}else t.completedSegments.push(e)}function Hj(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(rs(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=Ww,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&wS(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(Mte,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(wS(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function Wj(t){if(t.status!==2){var e=L1,n=v7.current;v7.current=OR;var r=CE;CE=t.responseState;try{var s=t.pingedTasks,u;for(u=0;u<s.length;u++){var p=s[u],g=t,l=p.blockedSegment;if(l.status===0){_S(p.context);try{Wh(g,p,p.node),g.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),p.abortSet.delete(p),l.status=1,Hj(g,p.blockedBoundary,l)}catch(Y){if(EI(),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"){var E=p.ping;Y.then(E,E)}else{p.abortSet.delete(p),l.status=4;var P=p.blockedBoundary,O=Y,j=U5(g,O);if(P===null?bS(g,O):(P.pendingTasks--,P.forceClientRender||(P.forceClientRender=!0,P.errorDigest=j,P.parentFlushed&&g.clientRenderedBoundaries.push(P))),g.allPendingTasks--,g.allPendingTasks===0){var $=g.onAllReady;$()}}}finally{}}}s.splice(0,u),t.destination!==null&&TI(t,t.destination)}catch(Y){U5(t,Y),bS(t,Y)}finally{CE=r,v7.current=n,n===OR&&_S(e)}}}function nE(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=r.toString(16),e.push(t),e.push('"></template>');case 1:n.status=2;var s=!0;r=n.chunks;var u=0;n=n.children;for(var p=0;p<n.length;p++){for(s=n[p];u<s.index;u++)e.push(r[u]);s=cM(t,e,s)}for(;u<r.length-1;u++)e.push(r[u]);return u<r.length&&(s=e.push(r[u])),s;default:throw Error(rs(390))}}function cM(t,e,n){var r=n.boundary;if(r===null)return nE(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)return t.responseState.generateStaticMarkup||(r=r.errorDigest,e.push("<!--$!-->"),e.push("<template"),r&&(e.push(' data-dgst="'),r=Mc(r),e.push(r),e.push('"')),e.push("></template>")),nE(t,e,n),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var s=t.responseState,u=s.nextSuspenseID++;return s=s.boundaryPrefix+u.toString(16),r=r.id=s,kR(e,t.responseState,r),nE(t,e,n),e.push("<!--/$-->")}if(r.byteSize>t.progressiveChunkSize)return r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),kR(e,t.responseState,r.id),nE(t,e,n),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),n=r.completedSegments,n.length!==1)throw Error(rs(391));return cM(t,e,n[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function jR(t,e,n){return ate(e,t.responseState,n.formatContext,n.id),cM(t,e,n),lte(e,n.formatContext)}function VR(t,e,n){for(var r=n.completedSegments,s=0;s<r.length;s++)qj(t,e,n,r[s]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),r===null)throw Error(rs(395));return n=n.toString(16),e.push(r),e.push('","'),e.push(t.segmentPrefix),e.push(n),e.push('")<\/script>')}function qj(t,e,n,r){if(r.status===2)return!0;var s=r.id;if(s===-1){if((r.id=n.rootSegmentID)===-1)throw Error(rs(392));return jR(t,e,r)}return jR(t,e,r),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),s=s.toString(16),e.push(s),e.push('","'),e.push(t.placeholderPrefix),e.push(s),e.push('")<\/script>')}function TI(t,e){try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){cM(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)e.push(r[n]);n<r.length&&e.push(r[n])}var s=t.clientRenderedBoundaries,u;for(u=0;u<s.length;u++){var p=s[u];r=e;var g=t.responseState,l=p.id,E=p.errorDigest,P=p.errorMessage,O=p.errorComponentStack;if(r.push(g.startInlineScript),g.sentClientRenderFunction?r.push('$RX("'):(g.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(rs(395));if(r.push(l),r.push('"'),E||P||O){r.push(",");var j=_7(E||"");r.push(j)}if(P||O){r.push(",");var $=_7(P||"");r.push($)}if(O){r.push(",");var Y=_7(O);r.push(Y)}if(!r.push(")<\/script>")){t.destination=null,u++,s.splice(0,u);return}}s.splice(0,u);var re=t.completedBoundaries;for(u=0;u<re.length;u++)if(!VR(t,e,re[u])){t.destination=null,u++,re.splice(0,u);return}re.splice(0,u);var _e=t.partialBoundaries;for(u=0;u<_e.length;u++){var J=_e[u];e:{s=t,p=e;var H=J.completedSegments;for(g=0;g<H.length;g++)if(!qj(s,p,J,H[g])){g++,H.splice(0,g);var te=!1;break e}H.splice(0,g),te=!0}if(!te){t.destination=null,u++,_e.splice(0,u);return}}_e.splice(0,u);var ce=t.completedBoundaries;for(u=0;u<ce.length;u++)if(!VR(t,e,ce[u])){t.destination=null,u++,ce.splice(0,u);return}ce.splice(0,u)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function kte(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return Gj(r,t,e)}),n.clear(),t.destination!==null&&TI(t,t.destination)}catch(r){U5(t,r),bS(t,r)}}function Cte(){}function $j(t,e,n,r){var s=!1,u=null,p="",g={push:function(E){return E!==null&&(p+=E),!0},destroy:function(E){s=!0,u=E}},l=!1;if(t=Tte(t,cte(n,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,Cte,void 0,function(){l=!0},void 0,void 0),Wj(t),kte(t,r),t.status===1)t.status=2,g.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=g;try{TI(t,g)}catch(E){U5(t,E),bS(t,E)}}if(s)throw u;if(!l)throw Error(rs(426));return p}i3.renderToNodeStream=function(){throw Error(rs(207))};i3.renderToStaticMarkup=function(t,e){return $j(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};i3.renderToStaticNodeStream=function(){throw Error(rs(208))};i3.renderToString=function(t,e){return $j(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};i3.version="18.2.0";var MI={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xj=Lt;function vs(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qh=null,$h=0;function di(t,e){if(e.length!==0)if(512<e.length)0<$h&&(t.enqueue(new Uint8Array(qh.buffer,0,$h)),qh=new Uint8Array(512),$h=0),t.enqueue(e);else{var n=qh.length-$h;n<e.length&&(n===0?t.enqueue(qh):(qh.set(e.subarray(0,n),$h),t.enqueue(qh),e=e.subarray(n)),qh=new Uint8Array(512),$h=0),qh.set(e,$h),$h+=e.length}}function aa(t,e){return di(t,e),!0}function GR(t){qh&&0<$h&&(t.enqueue(new Uint8Array(qh.buffer,0,$h)),qh=null,$h=0)}var Zj=new TextEncoder;function Ss(t){return Zj.encode(t)}function qr(t){return Zj.encode(t)}function Yj(t,e){typeof t.error=="function"?t.error(e):t.close()}var uh=Object.prototype.hasOwnProperty,Ite=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HR={},WR={};function Kj(t){return uh.call(WR,t)?!0:uh.call(HR,t)?!1:Ite.test(t)?WR[t]=!0:(HR[t]=!0,!1)}function zc(t,e,n,r,s,u,p){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=u,this.removeEmptyString=p}var Fu={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fu[t]=new zc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Fu[e]=new zc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fu[t]=new zc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fu[t]=new zc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fu[t]=new zc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fu[t]=new zc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fu[t]=new zc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fu[t]=new zc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fu[t]=new zc(t,5,!1,t.toLowerCase(),null,!1,!1)});var kI=/[\-:]([a-z])/g;function CI(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(kI,CI);Fu[e]=new zc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(kI,CI);Fu[e]=new zc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(kI,CI);Fu[e]=new zc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fu[t]=new zc(t,1,!1,t.toLowerCase(),null,!1,!1)});Fu.xlinkHref=new zc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fu[t]=new zc(t,1,!1,t.toLowerCase(),null,!0,!0)});var IE={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ate=["Webkit","ms","Moz","O"];Object.keys(IE).forEach(function(t){Ate.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),IE[e]=IE[t]})});var Lte=/["'&<>]/;function Lu(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=Lte.exec(t);if(e){var n="",r,s=0;for(r=e.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==r&&(n+=t.substring(s,r)),s=r+1,n+=e}t=s!==r?n+t.substring(s,r):n}return t}var Pte=/([A-Z])/g,Rte=/^ms-/,Wk=Array.isArray,Nte=qr("<script>"),Dte=qr("<\/script>"),Ote=qr('<script src="'),Fte=qr('<script type="module" src="'),qR=qr('" async=""><\/script>'),zte=/(<\/|<)(s)(cript)/gi;function Bte(t,e,n,r){return""+e+(n==="s"?"\\u0073":"\\u0053")+r}function Ute(t,e,n,r,s){t=t===void 0?"":t,e=e===void 0?Nte:qr('<script nonce="'+Lu(e)+'">');var u=[];if(n!==void 0&&u.push(e,Ss((""+n).replace(zte,Bte)),Dte),r!==void 0)for(n=0;n<r.length;n++)u.push(Ote,Ss(Lu(r[n])),qR);if(s!==void 0)for(r=0;r<s.length;r++)u.push(Fte,Ss(Lu(s[r])),qR);return{bootstrapChunks:u,startInlineScript:e,placeholderPrefix:qr(t+"P:"),segmentPrefix:qr(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function fm(t,e){return{insertionMode:t,selectedValue:e}}function jte(t){return fm(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Vte(t,e,n){switch(e){case"select":return fm(1,n.value!=null?n.value:n.defaultValue);case"svg":return fm(2,null);case"math":return fm(3,null);case"foreignObject":return fm(1,null);case"table":return fm(4,null);case"thead":case"tbody":case"tfoot":return fm(5,null);case"colgroup":return fm(7,null);case"tr":return fm(6,null)}return 4<=t.insertionMode||t.insertionMode===0?fm(1,null):t}var II=qr("<!-- -->");function $R(t,e,n,r){return e===""?r:(r&&t.push(II),t.push(Ss(Lu(e))),!0)}var XR=new Map,Gte=qr(' style="'),ZR=qr(":"),Hte=qr(";");function Jj(t,e,n){if(typeof n!="object")throw Error(vs(62));e=!0;for(var r in n)if(uh.call(n,r)){var s=n[r];if(s!=null&&typeof s!="boolean"&&s!==""){if(r.indexOf("--")===0){var u=Ss(Lu(r));s=Ss(Lu((""+s).trim()))}else{u=r;var p=XR.get(u);p!==void 0||(p=qr(Lu(u.replace(Pte,"-$1").toLowerCase().replace(Rte,"-ms-"))),XR.set(u,p)),u=p,s=typeof s=="number"?s===0||uh.call(IE,r)?Ss(""+s):Ss(s+"px"):Ss(Lu((""+s).trim()))}e?(e=!1,t.push(Gte,u,ZR,s)):t.push(Hte,u,ZR,s)}}e||t.push(w1)}var ly=qr(" "),Lx=qr('="'),w1=qr('"'),YR=qr('=""');function Gh(t,e,n,r){switch(n){case"style":Jj(t,e,r);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N"){if(e=Fu.hasOwnProperty(n)?Fu[n]:null,e!==null){switch(typeof r){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(n=Ss(e.attributeName),e.type){case 3:r&&t.push(ly,n,YR);break;case 4:r===!0?t.push(ly,n,YR):r!==!1&&t.push(ly,n,Lx,Ss(Lu(r)),w1);break;case 5:isNaN(r)||t.push(ly,n,Lx,Ss(Lu(r)),w1);break;case 6:!isNaN(r)&&1<=r&&t.push(ly,n,Lx,Ss(Lu(r)),w1);break;default:e.sanitizeURL&&(r=""+r),t.push(ly,n,Lx,Ss(Lu(r)),w1)}}else if(Kj(n)){switch(typeof r){case"function":case"symbol":return;case"boolean":if(e=n.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(ly,Ss(n),Lx,Ss(Lu(r)),w1)}}}var uy=qr(">"),KR=qr("/>");function AE(t,e,n){if(e!=null){if(n!=null)throw Error(vs(60));if(typeof e!="object"||!("__html"in e))throw Error(vs(61));e=e.__html,e!=null&&t.push(Ss(""+e))}}function Wte(t){var e="";return Xj.Children.forEach(t,function(n){n!=null&&(e+=n)}),e}var x7=qr(' selected=""');function b7(t,e,n,r){t.push(pm(n));var s=n=null,u;for(u in e)if(uh.call(e,u)){var p=e[u];if(p!=null)switch(u){case"children":n=p;break;case"dangerouslySetInnerHTML":s=p;break;default:Gh(t,r,u,p)}}return t.push(uy),AE(t,s,n),typeof n=="string"?(t.push(Ss(Lu(n))),null):n}var w7=qr(`
`),qte=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,JR=new Map;function pm(t){var e=JR.get(t);if(e===void 0){if(!qte.test(t))throw Error(vs(65,t));e=qr("<"+t),JR.set(t,e)}return e}var $te=qr("<!DOCTYPE html>");function Xte(t,e,n,r,s){switch(e){case"select":t.push(pm("select"));var u=null,p=null;for(P in n)if(uh.call(n,P)){var g=n[P];if(g!=null)switch(P){case"children":u=g;break;case"dangerouslySetInnerHTML":p=g;break;case"defaultValue":case"value":break;default:Gh(t,r,P,g)}}return t.push(uy),AE(t,p,u),u;case"option":p=s.selectedValue,t.push(pm("option"));var l=g=null,E=null,P=null;for(u in n)if(uh.call(n,u)){var O=n[u];if(O!=null)switch(u){case"children":g=O;break;case"selected":E=O;break;case"dangerouslySetInnerHTML":P=O;break;case"value":l=O;default:Gh(t,r,u,O)}}if(p!=null)if(n=l!==null?""+l:Wte(g),Wk(p)){for(r=0;r<p.length;r++)if(""+p[r]===n){t.push(x7);break}}else""+p===n&&t.push(x7);else E&&t.push(x7);return t.push(uy),AE(t,P,g),g;case"textarea":t.push(pm("textarea")),P=p=u=null;for(g in n)if(uh.call(n,g)&&(l=n[g],l!=null))switch(g){case"children":P=l;break;case"value":u=l;break;case"defaultValue":p=l;break;case"dangerouslySetInnerHTML":throw Error(vs(91));default:Gh(t,r,g,l)}if(u===null&&p!==null&&(u=p),t.push(uy),P!=null){if(u!=null)throw Error(vs(92));if(Wk(P)&&1<P.length)throw Error(vs(93));u=""+P}return typeof u=="string"&&u[0]===`
`&&t.push(w7),u!==null&&t.push(Ss(Lu(""+u))),null;case"input":t.push(pm("input")),l=P=g=u=null;for(p in n)if(uh.call(n,p)&&(E=n[p],E!=null))switch(p){case"children":case"dangerouslySetInnerHTML":throw Error(vs(399,"input"));case"defaultChecked":l=E;break;case"defaultValue":g=E;break;case"checked":P=E;break;case"value":u=E;break;default:Gh(t,r,p,E)}return P!==null?Gh(t,r,"checked",P):l!==null&&Gh(t,r,"checked",l),u!==null?Gh(t,r,"value",u):g!==null&&Gh(t,r,"value",g),t.push(KR),null;case"menuitem":t.push(pm("menuitem"));for(var j in n)if(uh.call(n,j)&&(u=n[j],u!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(vs(400));default:Gh(t,r,j,u)}return t.push(uy),null;case"title":t.push(pm("title")),u=null;for(O in n)if(uh.call(n,O)&&(p=n[O],p!=null))switch(O){case"children":u=p;break;case"dangerouslySetInnerHTML":throw Error(vs(434));default:Gh(t,r,O,p)}return t.push(uy),u;case"listing":case"pre":t.push(pm(e)),p=u=null;for(l in n)if(uh.call(n,l)&&(g=n[l],g!=null))switch(l){case"children":u=g;break;case"dangerouslySetInnerHTML":p=g;break;default:Gh(t,r,l,g)}if(t.push(uy),p!=null){if(u!=null)throw Error(vs(60));if(typeof p!="object"||!("__html"in p))throw Error(vs(61));n=p.__html,n!=null&&(typeof n=="string"&&0<n.length&&n[0]===`
`?t.push(w7,Ss(n)):t.push(Ss(""+n)))}return typeof u=="string"&&u[0]===`
`&&t.push(w7),u;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(pm(e));for(var $ in n)if(uh.call(n,$)&&(u=n[$],u!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(vs(399,e));default:Gh(t,r,$,u)}return t.push(KR),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return b7(t,n,e,r);case"html":return s.insertionMode===0&&t.push($te),b7(t,n,e,r);default:if(e.indexOf("-")===-1&&typeof n.is!="string")return b7(t,n,e,r);t.push(pm(e)),p=u=null;for(E in n)if(uh.call(n,E)&&(g=n[E],g!=null))switch(E){case"children":u=g;break;case"dangerouslySetInnerHTML":p=g;break;case"style":Jj(t,r,g);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:Kj(E)&&typeof g!="function"&&typeof g!="symbol"&&t.push(ly,Ss(E),Lx,Ss(Lu(g)),w1)}return t.push(uy),AE(t,p,u),u}}var Zte=qr("</"),Yte=qr(">"),Kte=qr('<template id="'),Jte=qr('"></template>'),Qte=qr("<!--$-->"),ene=qr('<!--$?--><template id="'),tne=qr('"></template>'),nne=qr("<!--$!-->"),rne=qr("<!--/$-->"),ine=qr("<template"),sne=qr('"'),one=qr(' data-dgst="');qr(' data-msg="');qr(' data-stck="');var ane=qr("></template>");function QR(t,e,n){if(di(t,ene),n===null)throw Error(vs(395));return di(t,n),aa(t,tne)}var lne=qr('<div hidden id="'),une=qr('">'),cne=qr("</div>"),hne=qr('<svg aria-hidden="true" style="display:none" id="'),dne=qr('">'),fne=qr("</svg>"),pne=qr('<math aria-hidden="true" style="display:none" id="'),mne=qr('">'),gne=qr("</math>"),yne=qr('<table hidden id="'),_ne=qr('">'),vne=qr("</table>"),xne=qr('<table hidden><tbody id="'),bne=qr('">'),wne=qr("</tbody></table>"),Ene=qr('<table hidden><tr id="'),Sne=qr('">'),Tne=qr("</tr></table>"),Mne=qr('<table hidden><colgroup id="'),kne=qr('">'),Cne=qr("</colgroup></table>");function Ine(t,e,n,r){switch(n.insertionMode){case 0:case 1:return di(t,lne),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,une);case 2:return di(t,hne),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,dne);case 3:return di(t,pne),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,mne);case 4:return di(t,yne),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,_ne);case 5:return di(t,xne),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,bne);case 6:return di(t,Ene),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,Sne);case 7:return di(t,Mne),di(t,e.segmentPrefix),di(t,Ss(r.toString(16))),aa(t,kne);default:throw Error(vs(397))}}function Ane(t,e){switch(e.insertionMode){case 0:case 1:return aa(t,cne);case 2:return aa(t,fne);case 3:return aa(t,gne);case 4:return aa(t,vne);case 5:return aa(t,wne);case 6:return aa(t,Tne);case 7:return aa(t,Cne);default:throw Error(vs(397))}}var Lne=qr('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Pne=qr('$RS("'),Rne=qr('","'),Nne=qr('")<\/script>'),Dne=qr('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),One=qr('$RC("'),Fne=qr('","'),zne=qr('")<\/script>'),Bne=qr('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Une=qr('$RX("'),jne=qr('"'),Vne=qr(")<\/script>"),E7=qr(","),Gne=/[<\u2028\u2029]/g;function S7(t){return JSON.stringify(t).replace(Gne,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var l5=Object.assign,Hne=Symbol.for("react.element"),Qj=Symbol.for("react.portal"),eV=Symbol.for("react.fragment"),tV=Symbol.for("react.strict_mode"),nV=Symbol.for("react.profiler"),rV=Symbol.for("react.provider"),iV=Symbol.for("react.context"),sV=Symbol.for("react.forward_ref"),oV=Symbol.for("react.suspense"),aV=Symbol.for("react.suspense_list"),lV=Symbol.for("react.memo"),AI=Symbol.for("react.lazy"),Wne=Symbol.for("react.scope"),qne=Symbol.for("react.debug_trace_mode"),$ne=Symbol.for("react.legacy_hidden"),Xne=Symbol.for("react.default_value"),e8=Symbol.iterator;function qk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case eV:return"Fragment";case Qj:return"Portal";case nV:return"Profiler";case tV:return"StrictMode";case oV:return"Suspense";case aV:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case iV:return(t.displayName||"Context")+".Consumer";case rV:return(t._context.displayName||"Context")+".Provider";case sV:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case lV:return e=t.displayName||null,e!==null?e:qk(t.type)||"Memo";case AI:e=t._payload,t=t._init;try{return qk(t(e))}catch{}}return null}var uV={};function t8(t,e){if(t=t.contextTypes,!t)return uV;var n={},r;for(r in t)n[r]=e[r];return n}var P1=null;function hM(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var n=e.parent;if(t===null){if(n!==null)throw Error(vs(401))}else{if(n===null)throw Error(vs(401));hM(t,n)}e.context._currentValue=e.value}}function cV(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&cV(t)}function hV(t){var e=t.parent;e!==null&&hV(e),t.context._currentValue=t.value}function dV(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(vs(402));t.depth===e.depth?hM(t,e):dV(t,e)}function fV(t,e){var n=e.parent;if(n===null)throw Error(vs(402));t.depth===n.depth?hM(t,n):fV(t,n),e.context._currentValue=e.value}function ES(t){var e=P1;e!==t&&(e===null?hV(t):t===null?cV(e):e.depth===t.depth?hM(e,t):e.depth>t.depth?dV(e,t):fV(e,t),P1=t)}var n8={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function r8(t,e,n,r){var s=t.state!==void 0?t.state:null;t.updater=n8,t.props=n,t.state=s;var u={queue:[],replace:!1};t._reactInternals=u;var p=e.contextType;if(t.context=typeof p=="object"&&p!==null?p._currentValue:r,p=e.getDerivedStateFromProps,typeof p=="function"&&(p=p(n,s),s=p==null?s:l5({},s,p),t.state=s),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&n8.enqueueReplaceState(t,t.state,null),u.queue!==null&&0<u.queue.length)if(e=u.queue,p=u.replace,u.queue=null,u.replace=!1,p&&e.length===1)t.state=e[0];else{for(u=p?e[0]:t.state,s=!0,p=p?1:0;p<e.length;p++){var g=e[p];g=typeof g=="function"?g.call(t,u,n,r):g,g!=null&&(s?(s=!1,u=l5({},u,g)):l5(u,g))}t.state=u}else u.queue=null}var Zne={id:1,overflow:""};function $k(t,e,n){var r=t.id;t=t.overflow;var s=32-LE(r)-1;r&=~(1<<s),n+=1;var u=32-LE(e)+s;if(30<u){var p=s-s%5;return u=(r&(1<<p)-1).toString(32),r>>=p,s-=p,{id:1<<32-LE(e)+s|n<<s|r,overflow:u+t}}return{id:1<<u|n<<s|r,overflow:t}}var LE=Math.clz32?Math.clz32:Jne,Yne=Math.log,Kne=Math.LN2;function Jne(t){return t>>>=0,t===0?32:31-(Yne(t)/Kne|0)|0}function Qne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ere=typeof Object.is=="function"?Object.is:Qne,Xg=null,LI=null,PE=null,Zo=null,qw=!1,SS=!1,j5=0,_y=null,dM=0;function E1(){if(Xg===null)throw Error(vs(321));return Xg}function i8(){if(0<dM)throw Error(vs(312));return{memoizedState:null,queue:null,next:null}}function PI(){return Zo===null?PE===null?(qw=!1,PE=Zo=i8()):(qw=!0,Zo=PE):Zo.next===null?(qw=!1,Zo=Zo.next=i8()):(qw=!0,Zo=Zo.next),Zo}function RI(){LI=Xg=null,SS=!1,PE=null,dM=0,Zo=_y=null}function pV(t,e){return typeof e=="function"?e(t):e}function s8(t,e,n){if(Xg=E1(),Zo=PI(),qw){var r=Zo.queue;if(e=r.dispatch,_y!==null&&(n=_y.get(r),n!==void 0)){_y.delete(r),r=Zo.memoizedState;do r=t(r,n.action),n=n.next;while(n!==null);return Zo.memoizedState=r,[r,e]}return[Zo.memoizedState,e]}return t=t===pV?typeof e=="function"?e():e:n!==void 0?n(e):e,Zo.memoizedState=t,t=Zo.queue={last:null,dispatch:null},t=t.dispatch=tre.bind(null,Xg,t),[Zo.memoizedState,t]}function o8(t,e){if(Xg=E1(),Zo=PI(),e=e===void 0?null:e,Zo!==null){var n=Zo.memoizedState;if(n!==null&&e!==null){var r=n[1];e:if(r===null)r=!1;else{for(var s=0;s<r.length&&s<e.length;s++)if(!ere(e[s],r[s])){r=!1;break e}r=!0}if(r)return n[0]}}return t=t(),Zo.memoizedState=[t,e],t}function tre(t,e,n){if(25<=dM)throw Error(vs(301));if(t===Xg)if(SS=!0,t={action:n,next:null},_y===null&&(_y=new Map),n=_y.get(e),n===void 0)_y.set(e,t);else{for(e=n;e.next!==null;)e=e.next;e.next=t}}function nre(){throw Error(vs(394))}function rE(){}var a8={readContext:function(t){return t._currentValue},useContext:function(t){return E1(),t._currentValue},useMemo:o8,useReducer:s8,useRef:function(t){Xg=E1(),Zo=PI();var e=Zo.memoizedState;return e===null?(t={current:t},Zo.memoizedState=t):e},useState:function(t){return s8(pV,t)},useInsertionEffect:rE,useLayoutEffect:function(){},useCallback:function(t,e){return o8(function(){return t},e)},useImperativeHandle:rE,useEffect:rE,useDebugValue:rE,useDeferredValue:function(t){return E1(),t},useTransition:function(){return E1(),[!1,nre]},useId:function(){var t=LI.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-LE(t)-1)).toString(32)+e;var n=RE;if(n===null)throw Error(vs(404));return e=j5++,t=":"+n.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return E1(),e(t._source)},useSyncExternalStore:function(t,e,n){if(n===void 0)throw Error(vs(407));return n()}},RE=null,T7=Xj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function rre(t){return console.error(t),null}function $w(){}function ire(t,e,n,r,s,u,p,g,l){var E=[],P=new Set;return e={destination:null,responseState:e,progressiveChunkSize:r===void 0?12800:r,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:P,pingedTasks:E,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:s===void 0?rre:s,onAllReady:u===void 0?$w:u,onShellReady:p===void 0?$w:p,onShellError:g===void 0?$w:g,onFatalError:l===void 0?$w:l},n=TS(e,0,null,n,!1,!1),n.parentFlushed=!0,t=NI(e,t,null,n,P,uV,null,Zne),E.push(t),e}function NI(t,e,n,r,s,u,p,g){t.allPendingTasks++,n===null?t.pendingRootTasks++:n.pendingTasks++;var l={node:e,ping:function(){var E=t.pingedTasks;E.push(l),E.length===1&&yV(t)},blockedBoundary:n,blockedSegment:r,abortSet:s,legacyContext:u,context:p,treeContext:g};return s.add(l),l}function TS(t,e,n,r,s,u){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:r,boundary:n,lastPushedText:s,textEmbedded:u}}function V5(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function MS(t,e){var n=t.onShellError;n(e),n=t.onFatalError,n(e),t.destination!==null?(t.status=2,Yj(t.destination,e)):(t.status=1,t.fatalError=e)}function l8(t,e,n,r,s){for(Xg={},LI=e,j5=0,t=n(r,s);SS;)SS=!1,j5=0,dM+=1,Zo=null,t=n(r,s);return RI(),t}function u8(t,e,n,r){var s=n.render(),u=r.childContextTypes;if(u!=null){var p=e.legacyContext;if(typeof n.getChildContext!="function")r=p;else{n=n.getChildContext();for(var g in n)if(!(g in u))throw Error(vs(108,qk(r)||"Unknown",g));r=l5({},p,n)}e.legacyContext=r,Xh(t,e,s),e.legacyContext=p}else Xh(t,e,s)}function c8(t,e){if(t&&t.defaultProps){e=l5({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Xk(t,e,n,r,s){if(typeof n=="function")if(n.prototype&&n.prototype.isReactComponent){s=t8(n,e.legacyContext);var u=n.contextType;u=new n(r,typeof u=="object"&&u!==null?u._currentValue:s),r8(u,n,r,s),u8(t,e,u,n)}else{u=t8(n,e.legacyContext),s=l8(t,e,n,r,u);var p=j5!==0;if(typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0)r8(s,n,r,u),u8(t,e,s,n);else if(p){r=e.treeContext,e.treeContext=$k(r,1,0);try{Xh(t,e,s)}finally{e.treeContext=r}}else Xh(t,e,s)}else if(typeof n=="string"){switch(s=e.blockedSegment,u=Xte(s.chunks,n,r,t.responseState,s.formatContext),s.lastPushedText=!1,p=s.formatContext,s.formatContext=Vte(p,n,r),Zk(t,e,u),s.formatContext=p,n){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:s.chunks.push(Zte,Ss(n),Yte)}s.lastPushedText=!1}else{switch(n){case $ne:case qne:case tV:case nV:case eV:Xh(t,e,r.children);return;case aV:Xh(t,e,r.children);return;case Wne:throw Error(vs(343));case oV:e:{n=e.blockedBoundary,s=e.blockedSegment,u=r.fallback,r=r.children,p=new Set;var g={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:p,errorDigest:null},l=TS(t,s.chunks.length,g,s.formatContext,!1,!1);s.children.push(l),s.lastPushedText=!1;var E=TS(t,0,null,s.formatContext,!1,!1);E.parentFlushed=!0,e.blockedBoundary=g,e.blockedSegment=E;try{if(Zk(t,e,r),E.lastPushedText&&E.textEmbedded&&E.chunks.push(II),E.status=1,kS(g,E),g.pendingTasks===0)break e}catch(P){E.status=4,g.forceClientRender=!0,g.errorDigest=V5(t,P)}finally{e.blockedBoundary=n,e.blockedSegment=s}e=NI(t,u,n,l,p,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof n=="object"&&n!==null)switch(n.$$typeof){case sV:if(r=l8(t,e,n.render,r,s),j5!==0){n=e.treeContext,e.treeContext=$k(n,1,0);try{Xh(t,e,r)}finally{e.treeContext=n}}else Xh(t,e,r);return;case lV:n=n.type,r=c8(n,r),Xk(t,e,n,r,s);return;case rV:if(s=r.children,n=n._context,r=r.value,u=n._currentValue,n._currentValue=r,p=P1,P1=r={parent:p,depth:p===null?0:p.depth+1,context:n,parentValue:u,value:r},e.context=r,Xh(t,e,s),t=P1,t===null)throw Error(vs(403));r=t.parentValue,t.context._currentValue=r===Xne?t.context._defaultValue:r,t=P1=t.parent,e.context=t;return;case iV:r=r.children,r=r(n._currentValue),Xh(t,e,r);return;case AI:s=n._init,n=s(n._payload),r=c8(n,r),Xk(t,e,n,r,void 0);return}throw Error(vs(130,n==null?n:typeof n,""))}}function Xh(t,e,n){if(e.node=n,typeof n=="object"&&n!==null){switch(n.$$typeof){case Hne:Xk(t,e,n.type,n.props,n.ref);return;case Qj:throw Error(vs(257));case AI:var r=n._init;n=r(n._payload),Xh(t,e,n);return}if(Wk(n)){h8(t,e,n);return}if(n===null||typeof n!="object"?r=null:(r=e8&&n[e8]||n["@@iterator"],r=typeof r=="function"?r:null),r&&(r=r.call(n))){if(n=r.next(),!n.done){var s=[];do s.push(n.value),n=r.next();while(!n.done);h8(t,e,s)}return}throw t=Object.prototype.toString.call(n),Error(vs(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}typeof n=="string"?(r=e.blockedSegment,r.lastPushedText=$R(e.blockedSegment.chunks,n,t.responseState,r.lastPushedText)):typeof n=="number"&&(r=e.blockedSegment,r.lastPushedText=$R(e.blockedSegment.chunks,""+n,t.responseState,r.lastPushedText))}function h8(t,e,n){for(var r=n.length,s=0;s<r;s++){var u=e.treeContext;e.treeContext=$k(u,r,s);try{Zk(t,e,n[s])}finally{e.treeContext=u}}}function Zk(t,e,n){var r=e.blockedSegment.formatContext,s=e.legacyContext,u=e.context;try{return Xh(t,e,n)}catch(l){if(RI(),typeof l=="object"&&l!==null&&typeof l.then=="function"){n=l;var p=e.blockedSegment,g=TS(t,p.chunks.length,null,p.formatContext,p.lastPushedText,!0);p.children.push(g),p.lastPushedText=!1,t=NI(t,e.node,e.blockedBoundary,g,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,n.then(t,t),e.blockedSegment.formatContext=r,e.legacyContext=s,e.context=u,ES(u)}else throw e.blockedSegment.formatContext=r,e.legacyContext=s,e.context=u,ES(u),l}}function sre(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,gV(this,e,t)}function mV(t,e,n){var r=t.blockedBoundary;t.blockedSegment.status=3,r===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,t=n===void 0?Error(vs(432)):n,r.errorDigest=e.onError(t),r.parentFlushed&&e.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(s){return mV(s,e,n)}),r.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(r=e.onAllReady,r()))}function kS(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var n=e.children[0];n.id=e.id,n.parentFlushed=!0,n.status===1&&kS(t,n)}else t.completedSegments.push(e)}function gV(t,e,n){if(e===null){if(n.parentFlushed){if(t.completedRootSegment!==null)throw Error(vs(389));t.completedRootSegment=n}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=$w,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(n.parentFlushed&&n.status===1&&kS(e,n),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(sre,t),e.fallbackAbortableTasks.clear()):n.parentFlushed&&n.status===1&&(kS(e,n),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function yV(t){if(t.status!==2){var e=P1,n=T7.current;T7.current=a8;var r=RE;RE=t.responseState;try{var s=t.pingedTasks,u;for(u=0;u<s.length;u++){var p=s[u],g=t,l=p.blockedSegment;if(l.status===0){ES(p.context);try{Xh(g,p,p.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(II),p.abortSet.delete(p),l.status=1,gV(g,p.blockedBoundary,l)}catch(Y){if(RI(),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"){var E=p.ping;Y.then(E,E)}else{p.abortSet.delete(p),l.status=4;var P=p.blockedBoundary,O=Y,j=V5(g,O);if(P===null?MS(g,O):(P.pendingTasks--,P.forceClientRender||(P.forceClientRender=!0,P.errorDigest=j,P.parentFlushed&&g.clientRenderedBoundaries.push(P))),g.allPendingTasks--,g.allPendingTasks===0){var $=g.onAllReady;$()}}}finally{}}}s.splice(0,u),t.destination!==null&&DI(t,t.destination)}catch(Y){V5(t,Y),MS(t,Y)}finally{RE=r,T7.current=n,n===a8&&ES(e)}}}function iE(t,e,n){switch(n.parentFlushed=!0,n.status){case 0:var r=n.id=t.nextSegmentId++;return n.lastPushedText=!1,n.textEmbedded=!1,t=t.responseState,di(e,Kte),di(e,t.placeholderPrefix),t=Ss(r.toString(16)),di(e,t),aa(e,Jte);case 1:n.status=2;var s=!0;r=n.chunks;var u=0;n=n.children;for(var p=0;p<n.length;p++){for(s=n[p];u<s.index;u++)di(e,r[u]);s=fM(t,e,s)}for(;u<r.length-1;u++)di(e,r[u]);return u<r.length&&(s=aa(e,r[u])),s;default:throw Error(vs(390))}}function fM(t,e,n){var r=n.boundary;if(r===null)return iE(t,e,n);if(r.parentFlushed=!0,r.forceClientRender)r=r.errorDigest,aa(e,nne),di(e,ine),r&&(di(e,one),di(e,Ss(Lu(r))),di(e,sne)),aa(e,ane),iE(t,e,n);else if(0<r.pendingTasks){r.rootSegmentID=t.nextSegmentId++,0<r.completedSegments.length&&t.partialBoundaries.push(r);var s=t.responseState,u=s.nextSuspenseID++;s=qr(s.boundaryPrefix+u.toString(16)),r=r.id=s,QR(e,t.responseState,r),iE(t,e,n)}else if(r.byteSize>t.progressiveChunkSize)r.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(r),QR(e,t.responseState,r.id),iE(t,e,n);else{if(aa(e,Qte),n=r.completedSegments,n.length!==1)throw Error(vs(391));fM(t,e,n[0])}return aa(e,rne)}function d8(t,e,n){return Ine(e,t.responseState,n.formatContext,n.id),fM(t,e,n),Ane(e,n.formatContext)}function f8(t,e,n){for(var r=n.completedSegments,s=0;s<r.length;s++)_V(t,e,n,r[s]);if(r.length=0,t=t.responseState,r=n.id,n=n.rootSegmentID,di(e,t.startInlineScript),t.sentCompleteBoundaryFunction?di(e,One):(t.sentCompleteBoundaryFunction=!0,di(e,Dne)),r===null)throw Error(vs(395));return n=Ss(n.toString(16)),di(e,r),di(e,Fne),di(e,t.segmentPrefix),di(e,n),aa(e,zne)}function _V(t,e,n,r){if(r.status===2)return!0;var s=r.id;if(s===-1){if((r.id=n.rootSegmentID)===-1)throw Error(vs(392));return d8(t,e,r)}return d8(t,e,r),t=t.responseState,di(e,t.startInlineScript),t.sentCompleteSegmentFunction?di(e,Pne):(t.sentCompleteSegmentFunction=!0,di(e,Lne)),di(e,t.segmentPrefix),s=Ss(s.toString(16)),di(e,s),di(e,Rne),di(e,t.placeholderPrefix),di(e,s),aa(e,Nne)}function DI(t,e){qh=new Uint8Array(512),$h=0;try{var n=t.completedRootSegment;if(n!==null&&t.pendingRootTasks===0){fM(t,e,n),t.completedRootSegment=null;var r=t.responseState.bootstrapChunks;for(n=0;n<r.length-1;n++)di(e,r[n]);n<r.length&&aa(e,r[n])}var s=t.clientRenderedBoundaries,u;for(u=0;u<s.length;u++){var p=s[u];r=e;var g=t.responseState,l=p.id,E=p.errorDigest,P=p.errorMessage,O=p.errorComponentStack;if(di(r,g.startInlineScript),g.sentClientRenderFunction?di(r,Une):(g.sentClientRenderFunction=!0,di(r,Bne)),l===null)throw Error(vs(395));di(r,l),di(r,jne),(E||P||O)&&(di(r,E7),di(r,Ss(S7(E||"")))),(P||O)&&(di(r,E7),di(r,Ss(S7(P||"")))),O&&(di(r,E7),di(r,Ss(S7(O)))),aa(r,Vne)}s.splice(0,u);var j=t.completedBoundaries;for(u=0;u<j.length;u++)f8(t,e,j[u]);j.splice(0,u),GR(e),qh=new Uint8Array(512),$h=0;var $=t.partialBoundaries;for(u=0;u<$.length;u++){var Y=$[u];e:{s=t,p=e;var re=Y.completedSegments;for(g=0;g<re.length;g++)if(!_V(s,p,Y,re[g])){g++,re.splice(0,g);var _e=!1;break e}re.splice(0,g),_e=!0}if(!_e){t.destination=null,u++,$.splice(0,u);return}}$.splice(0,u);var J=t.completedBoundaries;for(u=0;u<J.length;u++)f8(t,e,J[u]);J.splice(0,u)}finally{GR(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function p8(t,e){try{var n=t.abortableTasks;n.forEach(function(r){return mV(r,t,e)}),n.clear(),t.destination!==null&&DI(t,t.destination)}catch(r){V5(t,r),MS(t,r)}}MI.renderToReadableStream=function(t,e){return new Promise(function(n,r){var s,u,p=new Promise(function(P,O){u=P,s=O}),g=ire(t,Ute(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),jte(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,u,function(){var P=new ReadableStream({type:"bytes",pull:function(O){if(g.status===1)g.status=2,Yj(O,g.fatalError);else if(g.status!==2&&g.destination===null){g.destination=O;try{DI(g,O)}catch(j){V5(g,j),MS(g,j)}}},cancel:function(){p8(g)}},{highWaterMark:0});P.allReady=p,n(P)},function(P){p.catch(function(){}),r(P)},s);if(e&&e.signal){var l=e.signal,E=function(){p8(g,l.reason),l.removeEventListener("abort",E)};l.addEventListener("abort",E)}yV(g)})};MI.version="18.2.0";var s3,vV;s3=i3,vV=MI;s3.version;s3.renderToString;var ore=s3.renderToStaticMarkup;s3.renderToNodeStream;s3.renderToStaticNodeStream;vV.renderToReadableStream;var xV={exports:{}};(function(t,e){var n={};(function(r,s){t.exports=s()})(m2,function(){var r,s,u;function p(l,E){if(!r)r=E;else if(!s)s=E;else{var P="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",O={};r(O),u=E(O),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(u.workerUrl=window.URL.createObjectURL(new Blob([P],{type:"text/javascript"})))}}p(["exports"],function(l){var E=typeof self<"u"?self:{},P="2.15.0";let O;const j={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(O==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{O=n.API_URL_REGEX!=null?new RegExp(n.API_URL_REGEX):c}catch{O=c}}return O},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!j.API_URL)return null;try{const c=new URL(j.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},$={supported:!1,testSupport:function(c){!_e&&re&&(J?H(c):Y=c)}};let Y,re,_e=!1,J=!1;function H(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,re),c.isContextLost())return;$.supported=!0}catch{}c.deleteTexture(a),_e=!0}E.document&&(re=E.document.createElement("img"),re.onload=function(){Y&&H(Y),Y=null,J=!0},re.onerror=function(){_e=!0,Y=null},re.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const te="01";function ce(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Se=Ie;function Ie(c,a,h,m){this.cx=3*c,this.bx=3*(h-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=a,this.p2x=h,this.p2y=m}Ie.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,a){if(a===void 0&&(a=1e-6),c<0)return 0;if(c>1)return 1;for(var h=c,m=0;m<8;m++){var x=this.sampleCurveX(h)-c;if(Math.abs(x)<a)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=x/w}var k=0,A=1;for(h=c,m=0;m<20&&(x=this.sampleCurveX(h),!(Math.abs(x-c)<a));m++)c>x?k=h:A=h,h=.5*(A-k)+k;return h},solve:function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))}};var Ne=ce(Se),ut=mt;function mt(c,a){this.x=c,this.y=a}mt.prototype={clone:function(){return new mt(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x,h=c.y-this.y;return a*a+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var a=Math.cos(c),h=Math.sin(c),m=h*this.x+a*this.y;return this.x=a*this.x-h*this.y,this.y=m,this},_rotateAround:function(c,a){var h=Math.cos(c),m=Math.sin(c),x=a.y+m*(this.x-a.x)+h*(this.y-a.y);return this.x=a.x+h*(this.x-a.x)-m*(this.y-a.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},mt.convert=function(c){return c instanceof mt?c:Array.isArray(c)?new mt(c[0],c[1]):c};var We=ce(ut);const Ot=Math.PI/180,st=180/Math.PI;function qe(c){return c*Ot}function et(c){return c*st}const Q=[[0,0],[1,0],[1,1],[0,1]];function ye(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,h=a*c;return 4*(c<.5?h:3*(c-a)+h-.75)}function ge(c,a,h,m){const x=new Ne(c,a,h,m);return function(w){return x.solve(w)}}const xe=ge(.25,.1,.25,1);function Ce(c,a,h){return Math.min(h,Math.max(a,c))}function tt(c,a,h){return(h=Ce((h-c)/(a-c),0,1))*h*(3-2*h)}function Je(c,a,h){const m=h-a,x=((c-a)%m+m)%m+a;return x===a?h:x}function rt(c,a,h){if(!c.length)return h(null,[]);let m=c.length;const x=new Array(c.length);let w=null;c.forEach((k,A)=>{a(k,(N,z)=>{N&&(w=N),x[A]=z,--m==0&&h(w,x)})})}function Ut(c){const a=[];for(const h in c)a.push(c[h]);return a}function ht(c,...a){for(const h of a)for(const m in h)c[m]=h[m];return c}let Ft=1;function Nn(){return Ft++}function zn(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function rr(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Gr(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Li(c,a){c.forEach(h=>{a[h]&&(a[h]=a[h].bind(a))})}function wi(c,a){return c.indexOf(a,c.length-a.length)!==-1}function Nr(c,a,h){const m={};for(const x in c)m[x]=a.call(h||this,c[x],x,c);return m}function fi(c,a,h){const m={};for(const x in c)a.call(h||this,c[x],x,c)&&(m[x]=c[x]);return m}function Mi(c){return Array.isArray(c)?c.map(Mi):typeof c=="object"&&c?Nr(c,Mi):c}const jn={};function Be(c){jn[c]||(typeof console<"u"&&console.warn(c),jn[c]=!0)}function ze(c,a,h){return(h.y-c.y)*(a.x-c.x)>(a.y-c.y)*(h.x-c.x)}function vt(c){let a=0;for(let h,m,x=0,w=c.length,k=w-1;x<w;k=x++)h=c[x],m=c[k],a+=(m.x-h.x)*(h.y+m.y);return a}function Qe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function gt(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,m,x,w)=>{const k=x||w;return a[m]=!k||k.toLowerCase(),""}),a["max-age"]){const h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a}let St=null;function Rt(c){if(St==null){const a=c.navigator?c.navigator.userAgent:null;St=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return St}function At(c){try{const a=E[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function en(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}const On="mapbox-tiles";let qn=500,Er=50,Sr,Dr;function Fr(){try{return E.caches}catch{}}function Tr(){Fr()&&!Sr&&(Sr=E.caches.open(On))}function Zr(c){const a=c.indexOf("?");if(a<0)return c;const h=function(x){const w=x.indexOf("?");return w>0?x.slice(w+1).split("&"):[]}(c),m=h.filter(x=>{const w=x.split("=");return w[0]==="language"||w[0]==="worldview"});return m.length?`${c.slice(0,a)}?${m.join("&")}`:c.slice(0,a)}let is=1/0;const $i={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze($i);class Xs extends Error{constructor(a,h,m){h===401&&kt(m)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=h,this.url=m}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const vo=Qe()?()=>self.worker&&self.worker.referrer:()=>(E.location.protocol==="blob:"?E.parent:E).location.href,Vn=function(c,a){if(!(/^file:/.test(h=c.url)||/^file:/.test(vo())&&!/^\w+:/.test(h))){if(E.fetch&&E.Request&&E.AbortController&&E.Request.prototype.hasOwnProperty("signal"))return function(m,x){const w=new E.AbortController,k=new E.Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,referrer:vo(),referrerPolicy:m.referrerPolicy,signal:w.signal});let A=!1,N=!1;const z=(V=k.url).indexOf("sku=")>0&&kt(V);var V;m.type==="json"&&k.headers.set("Accept","application/json");const X=(ae,he,Te)=>{if(N)return;if(ae&&ae.message!=="SecurityError"&&Be(ae.toString()),he&&Te)return ee(he);const Oe=Date.now();E.fetch(k).then(Ze=>{if(Ze.ok){const yt=z?Ze.clone():null;return ee(Ze,yt,Oe)}return x(new Xs(Ze.statusText,Ze.status,m.url))}).catch(Ze=>{Ze.name!=="AbortError"&&x(new Error(`${Ze.message} ${m.url}`))})},ee=(ae,he,Te)=>{(m.type==="arrayBuffer"?ae.arrayBuffer():m.type==="json"?ae.json():ae.text()).then(Oe=>{N||(he&&Te&&function(Ze,yt,Ke){if(Tr(),!Sr)return;const pt={status:yt.status,statusText:yt.statusText,headers:new E.Headers};yt.headers.forEach((Kt,Xt)=>pt.headers.set(Xt,Kt));const Et=gt(yt.headers.get("Cache-Control")||"");if(Et["no-store"])return;Et["max-age"]&&pt.headers.set("Expires",new Date(Ke+1e3*Et["max-age"]).toUTCString());const wt=pt.headers.get("Expires");wt&&(new Date(wt).getTime()-Ke<42e4||function(Kt,Xt){if(Dr===void 0)try{new Response(new ReadableStream),Dr=!0}catch{Dr=!1}Dr?Xt(Kt.body):Kt.blob().then(Xt)}(yt,Kt=>{const Xt=new E.Response(Kt,pt);Tr(),Sr&&Sr.then(bn=>bn.put(Zr(Ze.url),Xt)).catch(bn=>Be(bn.message))}))}(k,he,Te),A=!0,x(null,Oe,ae.headers.get("Cache-Control"),ae.headers.get("Expires")))}).catch(Oe=>{N||x(new Error(Oe.message))})};return z?function(ae,he){if(Tr(),!Sr)return he(null);const Te=Zr(ae.url);Sr.then(Oe=>{Oe.match(Te).then(Ze=>{const yt=function(Ke){if(!Ke)return!1;const pt=new Date(Ke.headers.get("Expires")||0),Et=gt(Ke.headers.get("Cache-Control")||"");return pt>Date.now()&&!Et["no-cache"]}(Ze);Oe.delete(Te),yt&&Oe.put(Te,Ze.clone()),he(null,Ze,yt)}).catch(he)}).catch(he)}(k,X):X(null,null),{cancel:()=>{N=!0,A||w.abort()}}}(c,a);if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var h;return function(m,x){const w=new E.XMLHttpRequest;w.open(m.method||"GET",m.url,!0),m.type==="arrayBuffer"&&(w.responseType="arraybuffer");for(const k in m.headers)w.setRequestHeader(k,m.headers[k]);return m.type==="json"&&(w.responseType="text",w.setRequestHeader("Accept","application/json")),w.withCredentials=m.credentials==="include",w.onerror=()=>{x(new Error(w.statusText))},w.onload=()=>{if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let k=w.response;if(m.type==="json")try{k=JSON.parse(w.response)}catch(A){return x(A)}x(null,k,w.getResponseHeader("Cache-Control"),w.getResponseHeader("Expires"))}else x(new Xs(w.statusText,w.status,m.url))},w.send(m.body),{cancel:()=>w.abort()}}(c,a)},Di=function(c,a){return Vn(ht(c,{type:"arrayBuffer"}),a)};function Ps(c){const a=E.document.createElement("a");return a.href=c,a.protocol===E.document.location.protocol&&a.host===E.document.location.host}const ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let se,le;se=[],le=0;const Ae=function(c,a){if($.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),le>=j.MAX_PARALLEL_IMAGE_REQUESTS){const w={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return se.push(w),w}le++;let h=!1;const m=()=>{if(!h)for(h=!0,le--;se.length&&le<j.MAX_PARALLEL_IMAGE_REQUESTS;){const w=se.shift(),{requestParameters:k,callback:A,cancelled:N}=w;N||(w.cancel=Ae(k,A).cancel)}},x=Di(c,(w,k,A,N)=>{m(),w?a(w):k&&(E.createImageBitmap?function(z,V){const X=new E.Blob([new Uint8Array(z)],{type:"image/png"});E.createImageBitmap(X).then(ee=>{V(null,ee)}).catch(ee=>{V(new Error(`Could not load image because of ${ee.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(k,(z,V)=>a(z,V,A,N)):function(z,V){const X=new E.Image,ee=E.URL;X.onload=()=>{V(null,X),ee.revokeObjectURL(X.src),X.onload=null,E.requestAnimationFrame(()=>{X.src=ct})},X.onerror=()=>V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ae=new E.Blob([new Uint8Array(z)],{type:"image/png"});X.src=z.byteLength?ee.createObjectURL(ae):ct}(k,(z,V)=>a(z,V,A,N)))});return{cancel:()=>{x.cancel(),m()}}},Fe="NO_ACCESS_TOKEN";function nt(c){return c.indexOf("mapbox:")===0}function kt(c){return j.API_URL_REGEX.test(c)}function Tt(c){return j.API_CDN_URL_REGEX.test(c)}function at(c){return j.API_STYLE_REGEX.test(c)&&!me(c)}function me(c){return j.API_SPRITE_REGEX.test(c)}const fn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Mn(c){const a=c.match(fn);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Jt(c){const a=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${a}`}const mr="mapbox.eventData";function Cr(c){if(!c)return null;const a=c.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(E.atob(a[1]).split("").map(h=>"%"+("00"+h.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class zr{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const h=Cr(j.ACCESS_TOKEN);let m="";return m=h&&h.u?E.btoa(encodeURIComponent(h.u).replace(/%([0-9A-F]{2})/g,(x,w)=>String.fromCharCode(+("0x"+w)))):j.ACCESS_TOKEN||"",a?`${mr}.${a}:${m}`:`${mr}:${m}`}fetchEventData(){const a=At("localStorage"),h=this.getStorageKey(),m=this.getStorageKey("uuid");if(a)try{const x=E.localStorage.getItem(h);x&&(this.eventData=JSON.parse(x));const w=E.localStorage.getItem(m);w&&(this.anonId=w)}catch{Be("Unable to read from LocalStorage")}}saveEventData(){const a=At("localStorage"),h=this.getStorageKey(),m=this.getStorageKey("uuid");if(a)try{E.localStorage.setItem(m,this.anonId),Object.keys(this.eventData).length>=1&&E.localStorage.setItem(h,JSON.stringify(this.eventData))}catch{Be("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,h,m,x){if(!j.EVENTS_URL)return;const w=Mn(j.EVENTS_URL);w.params.push(`access_token=${x||j.ACCESS_TOKEN||""}`);const k={event:this.type,created:new Date(a).toISOString()},A=h?ht(k,h):k,N={url:Jt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=function(z,V){return Vn(ht(z,{method:"POST"}),V)}(N,z=>{this.pendingRequest=null,m(z),this.saveEventData(),this.processRequests(x)})}queueRequest(a,h){this.queue.push(a),this.processRequests(h)}}const Kr=new class extends zr{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,a){j.EVENTS_URL&&j.ACCESS_TOKEN&&Array.isArray(c)&&c.some(h=>nt(h)||kt(h))&&this.queueRequest(Date.now(),a)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=Cr(j.ACCESS_TOKEN),h=a?a.u:j.ACCESS_TOKEN;let m=h!==this.eventData.tokenU;Gr(this.anonId)||(this.anonId=zn(),m=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),k=new Date(x),A=(x-this.eventData.lastSuccess)/864e5;m=m||A>=1||A<-1||w.getDate()!==k.getDate()}else m=!0;m?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:te,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=x,this.eventData.tokenU=h)},c):this.processRequests()}},pi=Kr.postTurnstileEvent.bind(Kr),Xi=new class extends zr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,a,h,m){this.skuToken=a,this.errorCb=m,j.EVENTS_URL&&(h||j.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},h):this.errorCb(new Error(Fe)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:h}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),Gr(this.anonId)||(this.anonId=zn()),this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:te,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):a&&(this.success[a]=!0)},c))}},Hi=Xi.postMapLoadEvent.bind(Xi),Zi=new class extends zr{constructor(){super("gljs.performance")}postPerformanceEvent(c,a){j.EVENTS_URL&&(c||j.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},c)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:h}=this.queue.shift(),m=function(x){const w=E.performance.getEntriesByType("resource"),k=E.performance.getEntriesByType("mark"),A=function(ee){const ae={};if(ee){for(const he in ee)if(he!=="other")for(const Te of ee[he]){const Oe=`${he}ResolveRangeMin`,Ze=`${he}ResolveRangeMax`,yt=`${he}RequestCount`,Ke=`${he}RequestCachedCount`;ae[Oe]=Math.min(ae[Oe]||1/0,Te.startTime),ae[Ze]=Math.max(ae[Ze]||-1/0,Te.responseEnd);const pt=Et=>{ae[Et]===void 0&&(ae[Et]=0),++ae[Et]};Te.transferSize!==void 0&&Te.transferSize===0&&pt(Ke),pt(yt)}}return ae}(function(ee,ae){const he={};if(ee)for(const Te of ee){const Oe=ae(Te);he[Oe]===void 0&&(he[Oe]=[]),he[Oe].push(Te)}return he}(w,ea)),N=E.devicePixelRatio,z=E.navigator.connection||E.navigator.mozConnection||E.navigator.webkitConnection,V={counters:[],metadata:[],attributes:[]},X=(ee,ae,he)=>{he!=null&&ee.push({name:ae,value:he.toString()})};for(const ee in A)X(V.counters,ee,A[ee]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(X(V.counters,"interactionRangeMin",x.interactionRange[0]),X(V.counters,"interactionRangeMax",x.interactionRange[1])),k)for(const ee of Object.keys(No)){const ae=No[ee],he=k.find(Te=>Te.name===ae);he&&X(V.counters,ae,he.startTime)}return X(V.counters,"visibilityHidden",x.visibilityHidden),X(V.attributes,"style",function(ee){if(ee)for(const ae of ee){const he=ae.name.split("?")[0];if(at(he)){const Te=he.split("/").slice(-2);if(Te.length===2)return`mapbox://styles/${Te[0]}/${Te[1]}`}}}(w)),X(V.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),X(V.attributes,"fogEnabled",x.fogEnabled?"true":"false"),X(V.attributes,"projection",x.projection),X(V.attributes,"zoom",x.zoom),X(V.metadata,"devicePixelRatio",N),X(V.metadata,"connectionEffectiveType",z?z.effectiveType:void 0),X(V.metadata,"navigatorUserAgent",E.navigator.userAgent),X(V.metadata,"screenWidth",E.screen.width),X(V.metadata,"screenHeight",E.screen.height),X(V.metadata,"windowWidth",E.innerWidth),X(V.metadata,"windowHeight",E.innerHeight),X(V.metadata,"mapWidth",x.width/N),X(V.metadata,"mapHeight",x.height/N),X(V.metadata,"webglRenderer",x.renderer),X(V.metadata,"webglVendor",x.vendor),X(V.metadata,"sdkVersion",P),X(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(h);for(const x of m.metadata);for(const x of m.counters);for(const x of m.attributes);this.postEvent(a,m,()=>{},c)}},ss=Zi.postPerformanceEvent.bind(Zi),xo=new class extends zr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,a,h,m){if(!j.API_URL||!j.SESSION_PATH)return;const x=Mn(j.API_URL+j.SESSION_PATH);x.params.push(`sku=${a||""}`),x.params.push(`access_token=${m||j.ACCESS_TOKEN||""}`);const w={url:Jt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(k,A){return Vn(ht(k,{method:"GET"}),A)}(w,k=>{this.pendingRequest=null,h(k),this.saveEventData(),this.processRequests(m)})}getSessionAPI(c,a,h,m){this.skuToken=a,this.errorCb=m,j.SESSION_PATH&&j.API_URL&&(h||j.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},h):this.errorCb(new Error(Fe)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:h}=this.queue.shift();a&&this.success[a]||this.getSession(h,this.skuToken,m=>{m?this.errorCb(m):a&&(this.success[a]=!0)},c)}},Us=xo.getSessionAPI.bind(xo),uo=new Set,No={create:"create",load:"load",fullLoad:"fullLoad"},xs={mark(c){E.performance.mark(c)},measure(c,a,h){E.performance.measure(c,a,h)}};function ea(c){const a=c.name.split("?")[0];return Tt(a)&&a.includes("mapbox-gl.js")?"javascript":Tt(a)&&a.includes("mapbox-gl.css")?"css":function(h){return j.API_FONTS_REGEX.test(h)}(a)?"fontRange":me(a)?"sprite":at(a)?"style":function(h){return j.API_TILEJSON_REGEX.test(h)}(a)?"tilejson":"other"}const ri=E.performance;function Ia(c){const a=c?c.url.toString():void 0;return ri.getEntriesByName(a)}let zl,tl,Zs,ta;const bo={now:()=>Zs!==void 0?Zs:E.performance.now(),setNow(c){Zs=c},restoreNow(){Zs=void 0},frame(c){const a=E.requestAnimationFrame(c);return{cancel:()=>E.cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:h,height:m}=c;ta||(ta=E.document.createElement("canvas"));const x=ta.getContext("2d",{willReadFrequently:!0});if(!x)throw new Error("failed to create canvas 2d context");return(h>ta.width||m>ta.height)&&(ta.width=h,ta.height=m),x.clearRect(-a,-a,h+2*a,m+2*a),x.drawImage(c,0,0,h,m),x.getImageData(-a,-a,h+2*a,m+2*a)},resolveURL:c=>(zl||(zl=E.document.createElement("a")),zl.href=c,zl.href),get devicePixelRatio(){return E.devicePixelRatio},get prefersReducedMotion(){return!!E.matchMedia&&(tl==null&&(tl=E.matchMedia("(prefers-reduced-motion: reduce)")),tl.matches)}};function nl(c,a,h){h[c]&&h[c].indexOf(a)!==-1||(h[c]=h[c]||[],h[c].push(a))}function Bc(c,a,h){if(h&&h[c]){const m=h[c].indexOf(a);m!==-1&&h[c].splice(m,1)}}class yl{constructor(a,h={}){ht(this,h),this.type=a}}class _l extends yl{constructor(a,h={}){super("error",ht({error:a},h))}}class rl{on(a,h){return this._listeners=this._listeners||{},nl(a,h,this._listeners),this}off(a,h){return Bc(a,h,this._listeners),Bc(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},nl(a,h,this._oneTimeListeners),this):new Promise(m=>this.once(a,m))}fire(a,h){typeof a=="string"&&(a=new yl(a,h||{}));const m=a.type;if(this.listens(m)){a.target=this;const x=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const A of x)A.call(this,a);const w=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const A of w)Bc(m,A,this._oneTimeListeners),A.call(this,a);const k=this._eventedParent;k&&(ht(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(a))}else a instanceof _l&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var Nt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ko(c,...a){for(const h of a)for(const m in h)c[m]=h[m];return c}function ns(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Ds(c){if(Array.isArray(c))return c.map(Ds);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const h in c)a[h]=Ds(c[h]);return a}return ns(c)}class Tp extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}var Uo=Tp;class Uc{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[m,x]of h)this.bindings[m]=x}concat(a){return new Uc(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var Aa=Uc;const hc={kind:"null"},ur={kind:"number"},Ei={kind:"string"},Si={kind:"boolean"},ys={kind:"color"},$a={kind:"object"},vi={kind:"value"},we={kind:"collator"},ve={kind:"formatted"},Le={kind:"resolvedImage"};function ot(c,a){return{kind:"array",itemType:c,N:a}}function Gt(c){if(c.kind==="array"){const a=Gt(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}return c.kind}const yn=[hc,ur,Ei,Si,ys,ve,$a,ot(vi),Le];function Ht(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!Ht(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const h of yn)if(!Ht(h,a))return null}}return`Expected ${Gt(c)} but found ${Gt(a)} instead.`}function En(c,a){return a.some(h=>h.kind===c.kind)}function fe(c,a){return a.some(h=>h==="null"?c===null:h==="array"?Array.isArray(c):h==="object"?c&&!Array.isArray(c)&&typeof c=="object":h===typeof c)}var ue,Me={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function De(c){return(c=Math.round(c))<0?0:c>255?255:c}function Pe(c){return De(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function Dt(c){return(a=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:a>1?1:a;var a}function Zt(c,a,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?c+(a-c)*h*6:2*h<1?a:3*h<2?c+(a-c)*(2/3-h)*6:c}try{ue={}.parseCSSColor=function(c){var a,h=c.replace(/ /g,"").toLowerCase();if(h in Me)return Me[h].slice();if(h[0]==="#")return h.length===4?(a=parseInt(h.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:h.length===7&&(a=parseInt(h.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var m=h.indexOf("("),x=h.indexOf(")");if(m!==-1&&x+1===h.length){var w=h.substr(0,m),k=h.substr(m+1,x-(m+1)).split(","),A=1;switch(w){case"rgba":if(k.length!==4)return null;A=Dt(k.pop());case"rgb":return k.length!==3?null:[Pe(k[0]),Pe(k[1]),Pe(k[2]),A];case"hsla":if(k.length!==4)return null;A=Dt(k.pop());case"hsl":if(k.length!==3)return null;var N=(parseFloat(k[0])%360+360)%360/360,z=Dt(k[1]),V=Dt(k[2]),X=V<=.5?V*(z+1):V+z-V*z,ee=2*V-X;return[De(255*Zt(ee,X,N+1/3)),De(255*Zt(ee,X,N)),De(255*Zt(ee,X,N-1/3)),A];default:return null}}return null}}catch{}class pn{constructor(a,h,m,x=1){this.r=a,this.g=h,this.b=m,this.a=x}static parse(a){if(!a)return;if(a instanceof pn)return a;if(typeof a!="string")return;const h=ue(a);return h?new pn(h[0]/255*h[3],h[1]/255*h[3],h[2]/255*h[3],h[3]):void 0}toString(){const[a,h,m,x]=this.toArray();return`rgba(${Math.round(a)},${Math.round(h)},${Math.round(m)},${x})`}toArray(){const{r:a,g:h,b:m,a:x}=this;return x===0?[0,0,0,0]:[255*a/x,255*h/x,255*m/x,x]}toArray01(){const{r:a,g:h,b:m,a:x}=this;return x===0?[0,0,0,0]:[a/x,h/x,m/x,x]}toArray01PremultipliedAlpha(){const{r:a,g:h,b:m,a:x}=this;return[a,h,m,x]}}pn.black=new pn(0,0,0,1),pn.white=new pn(1,1,1,1),pn.transparent=new pn(0,0,0,0),pn.red=new pn(1,0,0,1),pn.blue=new pn(0,0,1,1);var Sn=pn;class lr{constructor(a,h,m){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class In{constructor(a,h,m,x,w){this.text=a.normalize?a.normalize():a,this.image=h,this.scale=m,this.fontStack=x,this.textColor=w}}class un{constructor(a){this.sections=a}static fromString(a){return new un([new In(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof un?a:un.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const h of this.sections){if(h.image){a.push(["image",h.image.name]);continue}a.push(h.text);const m={};h.fontStack&&(m["text-font"]=["literal",h.fontStack.split(",")]),h.scale&&(m["font-scale"]=h.scale),h.textColor&&(m["text-color"]=["rgba"].concat(h.textColor.toArray())),a.push(m)}return a}}class cr{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new cr({name:a,available:!1}):null}serialize(){return["image",this.name]}}function Bn(c,a,h,m){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[c,a,h,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[c,a,h,m]:[c,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fr(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Sn||c instanceof lr||c instanceof un||c instanceof cr)return!0;if(Array.isArray(c)){for(const a of c)if(!fr(a))return!1;return!0}if(typeof c=="object"){for(const a in c)if(!fr(c[a]))return!1;return!0}return!1}function cn(c){if(c===null)return hc;if(typeof c=="string")return Ei;if(typeof c=="boolean")return Si;if(typeof c=="number")return ur;if(c instanceof Sn)return ys;if(c instanceof lr)return we;if(c instanceof un)return ve;if(c instanceof cr)return Le;if(Array.isArray(c)){const a=c.length;let h;for(const m of c){const x=cn(m);if(h){if(h===x)continue;h=vi;break}h=x}return ot(h||vi,a)}return $a}function Ar(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof Sn||c instanceof un||c instanceof cr?c.toString():JSON.stringify(c)}class $r{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!fr(a[1]))return h.error("invalid value");const m=a[1];let x=cn(m);const w=h.expectedType;return x.kind!=="array"||x.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(x=w),new $r(x,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Sn?["rgba"].concat(this.value.toArray()):this.value instanceof un?this.value.serialize():this.value}}var ei=$r,Br=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const qi={string:Ei,number:ur,boolean:Si,object:$a};class Oi{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let m,x=1;const w=a[0];if(w==="array"){let A,N;if(a.length>2){const z=a[1];if(typeof z!="string"||!(z in qi)||z==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);A=qi[z],x++}else A=vi;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);N=a[2],x++}m=ot(A,N)}else m=qi[w];const k=[];for(;x<a.length;x++){const A=h.parse(a[x],x,vi);if(!A)return null;k.push(A)}return new Oi(m,k)}evaluate(a){for(let h=0;h<this.args.length;h++){const m=this.args[h].evaluate(a);if(!Ht(this.type,cn(m)))return m;if(h===this.args.length-1)throw new Br(`Expected value to be of type ${Gt(this.type)}, but found ${Gt(cn(m))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,h=[a.kind];if(a.kind==="array"){const m=a.itemType;if(m.kind==="string"||m.kind==="number"||m.kind==="boolean"){h.push(m.kind);const x=a.N;(typeof x=="number"||this.args.length>1)&&h.push(x)}}return h.concat(this.args.map(m=>m.serialize()))}}var Xn=Oi;class es{constructor(a){this.type=ve,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const m=a[1];if(!Array.isArray(m)&&typeof m=="object")return h.error("First argument must be an image or text section.");const x=[];let w=!1;for(let k=1;k<=a.length-1;++k){const A=a[k];if(w&&typeof A=="object"&&!Array.isArray(A)){w=!1;let N=null;if(A["font-scale"]&&(N=h.parse(A["font-scale"],1,ur),!N))return null;let z=null;if(A["text-font"]&&(z=h.parse(A["text-font"],1,ot(Ei)),!z))return null;let V=null;if(A["text-color"]&&(V=h.parse(A["text-color"],1,ys),!V))return null;const X=x[x.length-1];X.scale=N,X.font=z,X.textColor=V}else{const N=h.parse(a[k],1,vi);if(!N)return null;const z=N.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,x.push({content:N,scale:null,font:null,textColor:null})}}return new es(x)}evaluate(a){return new un(this.sections.map(h=>{const m=h.content.evaluate(a);return cn(m)===Le?new In("",m,null,null,null):new In(Ar(m),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null)}))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const h of this.sections){a.push(h.content.serialize());const m={};h.scale&&(m["font-scale"]=h.scale.serialize()),h.font&&(m["text-font"]=h.font.serialize()),h.textColor&&(m["text-color"]=h.textColor.serialize()),a.push(m)}return a}}class li{constructor(a){this.type=Le,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const m=h.parse(a[1],1,Ei);return m?new li(m):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),m=cr.fromString(h);return m&&a.availableImages&&(m.available=a.availableImages.indexOf(h)>-1),m}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Do={"to-boolean":Si,"to-color":ys,"to-number":ur,"to-string":Ei};class xi{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const m=a[0];if((m==="to-boolean"||m==="to-string")&&a.length!==2)return h.error("Expected one argument.");const x=Do[m],w=[];for(let k=1;k<a.length;k++){const A=h.parse(a[k],k,vi);if(!A)return null;w.push(A)}return new xi(x,w)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let h,m;for(const x of this.args){if(h=x.evaluate(a),m=null,h instanceof Sn)return h;if(typeof h=="string"){const w=a.parseColor(h);if(w)return w}else if(Array.isArray(h)&&(m=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Bn(h[0],h[1],h[2],h[3]),!m))return new Sn(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Br(m||`Could not parse color from value '${typeof h=="string"?h:String(JSON.stringify(h))}'`)}if(this.type.kind==="number"){let h=null;for(const m of this.args){if(h=m.evaluate(a),h===null)return 0;const x=Number(h);if(!isNaN(x))return x}throw new Br(`Could not convert ${JSON.stringify(h)} to number.`)}return this.type.kind==="formatted"?un.fromString(Ar(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?cr.fromString(Ar(this.args[0].evaluate(a))):Ar(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new es([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new li(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(h=>{a.push(h.serialize())}),a}}var pa=xi;const jo=["Unknown","Point","LineString","Polygon"];var Xa=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:h,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*a-c[0])+this.featureDistanceData.bearing[1]*(m*a-c[1])}return 0}parseColor(c){let a=this._parseColorCache[c];return a||(a=this._parseColorCache[c]=Sn.parse(c)),a}};class Za{constructor(a,h,m,x){this.name=a,this.type=h,this._evaluate=m,this.args=x}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,h){const m=a[0],x=Za.definitions[m];if(!x)return h.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(x)?x[0]:x.type,k=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,A=k.filter(([z])=>!Array.isArray(z)||z.length===a.length-1);let N=null;for(const[z,V]of A){N=new Lp(h.registry,h.path,null,h.scope);const X=[];let ee=!1;for(let ae=1;ae<a.length;ae++){const he=a[ae],Te=Array.isArray(z)?z[ae-1]:z.type,Oe=N.parse(he,1+X.length,Te);if(!Oe){ee=!0;break}X.push(Oe)}if(!ee)if(Array.isArray(z)&&z.length!==X.length)N.error(`Expected ${z.length} arguments, but found ${X.length} instead.`);else{for(let ae=0;ae<X.length;ae++){const he=Array.isArray(z)?z[ae]:z.type,Te=X[ae];N.concat(ae+1).checkSubtype(he,Te.type)}if(N.errors.length===0)return new Za(m,w,V,X)}}if(A.length===1)h.errors.push(...N.errors);else{const z=(A.length?A:k).map(([X])=>{return ee=X,Array.isArray(ee)?`(${ee.map(Gt).join(", ")})`:`(${Gt(ee.type)}...)`;var ee}).join(" | "),V=[];for(let X=1;X<a.length;X++){const ee=h.parse(a[X],1+V.length);if(!ee)return null;V.push(Gt(ee.type))}h.error(`Expected arguments of type ${z}, but found (${V.join(", ")}) instead.`)}return null}static register(a,h){Za.definitions=h;for(const m in h)a[m]=Za}}var Oo=Za;class na{constructor(a,h,m){this.type=we,this.locale=m,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const m=a[1];if(typeof m!="object"||Array.isArray(m))return h.error("Collator options argument must be an object.");const x=h.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,Si);if(!x)return null;const w=h.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,Si);if(!w)return null;let k=null;return m.locale&&(k=h.parse(m.locale,1,Ei),!k)?null:new na(x,w,k)}evaluate(a){return new lr(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const Gs=8192;function jc(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function Pr(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function vu(c,a){const h=(180+c[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,x=Math.pow(2,a.z);return[Math.round(h*x*Gs),Math.round(m*x*Gs)]}function Mp(c,a,h){const m=c[0]-a[0],x=c[1]-a[1],w=c[0]-h[0],k=c[1]-h[1];return m*k-w*x==0&&m*w<=0&&x*k<=0}function gf(c,a){let h=!1;for(let k=0,A=a.length;k<A;k++){const N=a[k];for(let z=0,V=N.length;z<V-1;z++){if(Mp(c,N[z],N[z+1]))return!1;(x=N[z])[1]>(m=c)[1]!=(w=N[z+1])[1]>m[1]&&m[0]<(w[0]-x[0])*(m[1]-x[1])/(w[1]-x[1])+x[0]&&(h=!h)}}var m,x,w;return h}function dc(c,a){for(let h=0;h<a.length;h++)if(gf(c,a[h]))return!0;return!1}function yf(c,a,h,m){const x=m[0]-h[0],w=m[1]-h[1],k=(c[0]-h[0])*w-x*(c[1]-h[1]),A=(a[0]-h[0])*w-x*(a[1]-h[1]);return k>0&&A<0||k<0&&A>0}function il(c,a,h){for(const z of h)for(let V=0;V<z.length-1;++V)if((A=[(k=z[V+1])[0]-(w=z[V])[0],k[1]-w[1]])[0]*(N=[(x=a)[0]-(m=c)[0],x[1]-m[1]])[1]-A[1]*N[0]!=0&&yf(m,x,w,k)&&yf(w,k,m,x))return!0;var m,x,w,k,A,N;return!1}function hs(c,a){for(let h=0;h<c.length;++h)if(!gf(c[h],a))return!1;for(let h=0;h<c.length-1;++h)if(il(c[h],c[h+1],a))return!1;return!0}function kp(c,a){for(let h=0;h<a.length;h++)if(hs(c,a[h]))return!0;return!1}function Bl(c,a,h){const m=[];for(let x=0;x<c.length;x++){const w=[];for(let k=0;k<c[x].length;k++){const A=vu(c[x][k],h);jc(a,A),w.push(A)}m.push(w)}return m}function Cp(c,a,h){const m=[];for(let x=0;x<c.length;x++){const w=Bl(c[x],a,h);m.push(w)}return m}function ma(c,a,h,m){if(c[0]<h[0]||c[0]>h[2]){const x=.5*m;let w=c[0]-h[0]>x?-m:h[0]-c[0]>x?m:0;w===0&&(w=c[0]-h[2]>x?-m:h[2]-c[0]>x?m:0),c[0]+=w}jc(a,c)}function bi(c,a,h,m){const x=Math.pow(2,m.z)*Gs,w=[m.x*Gs,m.y*Gs],k=[];if(!c)return k;for(const A of c)for(const N of A){const z=[N.x+w[0],N.y+w[1]];ma(z,a,h,x),k.push(z)}return k}function l0(c,a,h,m){const x=Math.pow(2,m.z)*Gs,w=[m.x*Gs,m.y*Gs],k=[];if(!c)return k;for(const N of c){const z=[];for(const V of N){const X=[V.x+w[0],V.y+w[1]];jc(a,X),z.push(X)}k.push(z)}if(a[2]-a[0]<=x/2){(A=a)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const N of k)for(const z of N)ma(z,a,h,x)}var A;return k}class fc{constructor(a,h){this.type=Si,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(fr(a[1])){const m=a[1];if(m.type==="FeatureCollection")for(let x=0;x<m.features.length;++x){const w=m.features[x].geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new fc(m,m.features[x].geometry)}else if(m.type==="Feature"){const x=m.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new fc(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new fc(m,m)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,m){const x=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(!k)return!1;if(m.type==="Polygon"){const A=Bl(m.coordinates,w,k),N=bi(h.geometry(),x,w,k);if(!Pr(x,w))return!1;for(const z of N)if(!gf(z,A))return!1}if(m.type==="MultiPolygon"){const A=Cp(m.coordinates,w,k),N=bi(h.geometry(),x,w,k);if(!Pr(x,w))return!1;for(const z of N)if(!dc(z,A))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,m){const x=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(!k)return!1;if(m.type==="Polygon"){const A=Bl(m.coordinates,w,k),N=l0(h.geometry(),x,w,k);if(!Pr(x,w))return!1;for(const z of N)if(!hs(z,A))return!1}if(m.type==="MultiPolygon"){const A=Cp(m.coordinates,w,k),N=l0(h.geometry(),x,w,k);if(!Pr(x,w))return!1;for(const z of N)if(!kp(z,A))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ip=fc;function xu(c){if(c instanceof Oo&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Ip)return!1;let a=!0;return c.eachChild(h=>{a&&!xu(h)&&(a=!1)}),a}function vl(c){if(c instanceof Oo&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(h=>{a&&!vl(h)&&(a=!1)}),a}function tu(c,a){if(c instanceof Oo&&a.indexOf(c.name)>=0)return!1;let h=!0;return c.eachChild(m=>{h&&!tu(m,a)&&(h=!1)}),h}class Ap{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const m=a[1];return h.scope.has(m)?new Ap(m,h.scope.get(m)):h.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var u0=Ap;class _f{constructor(a,h=[],m,x=new Aa,w=[]){this.registry=a,this.path=h,this.key=h.map(k=>`[${k}]`).join(""),this.scope=x,this.errors=w,this.expectedType=m}parse(a,h,m,x,w={}){return h?this.concat(h,m,x)._parse(a,w):this._parse(a,w)}_parse(a,h){function m(x,w,k){return k==="assert"?new Xn(w,[x]):k==="coerce"?new pa(w,[x]):x}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const x=a[0];if(typeof x!="string")return this.error(`Expression name must be a string, but found ${typeof x} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[x];if(w){let k=w.parse(a,this);if(!k)return null;if(this.expectedType){const A=this.expectedType,N=k.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||N.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||N.kind!=="value"&&N.kind!=="string"){if(this.checkSubtype(A,N))return null}else k=m(k,A,h.typeAnnotation||"coerce");else k=m(k,A,h.typeAnnotation||"assert")}if(!(k instanceof ei)&&k.type.kind!=="resolvedImage"&&Pp(k)){const A=new Xa;try{k=new ei(k.type,k.evaluate(A))}catch(N){return this.error(N.message),null}}return k}return this.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,m){const x=typeof a=="number"?this.path.concat(a):this.path,w=m?this.scope.concat(m):this.scope;return new _f(this.registry,x,h||null,w,this.errors)}error(a,...h){const m=`${this.key}${h.map(x=>`[${x}]`).join("")}`;this.errors.push(new Uo(m,a))}checkSubtype(a,h){const m=Ht(a,h);return m&&this.error(m),m}}var Lp=_f;function Pp(c){if(c instanceof u0)return Pp(c.boundExpression);if(c instanceof Oo&&c.name==="error"||c instanceof na||c instanceof Ip)return!1;const a=c instanceof pa||c instanceof Xn;let h=!0;return c.eachChild(m=>{h=a?h&&Pp(m):h&&m instanceof ei}),!!h&&xu(c)&&tu(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function vf(c,a){const h=c.length-1;let m,x,w=0,k=h,A=0;for(;w<=k;)if(A=Math.floor((w+k)/2),m=c[A],x=c[A+1],m<=a){if(A===h||a<x)return A;w=A+1}else{if(!(m>a))throw new Br("Input is not a number.");k=A-1}return 0}class xf{constructor(a,h,m){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[x,w]of m)this.labels.push(x),this.outputs.push(w)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");const m=h.parse(a[1],1,ur);if(!m)return null;const x=[];let w=null;h.expectedType&&h.expectedType.kind!=="value"&&(w=h.expectedType);for(let k=1;k<a.length;k+=2){const A=k===1?-1/0:a[k],N=a[k+1],z=k,V=k+1;if(typeof A!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(x.length&&x[x.length-1][0]>=A)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const X=h.parse(N,V,w);if(!X)return null;w=w||X.type,x.push([A,X])}return new xf(w,m,x)}evaluate(a){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(a);const x=this.input.evaluate(a);if(x<=h[0])return m[0].evaluate(a);const w=h.length;return x>=h[w-1]?m[w-1].evaluate(a):m[vf(h,x)].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let h=0;h<this.labels.length;h++)h>0&&a.push(this.labels[h]),a.push(this.outputs[h].serialize());return a}}var Rp=xf;function Yi(c,a,h){return c*(1-h)+a*h}var bf=Object.freeze({__proto__:null,array:function(c,a,h){return c.map((m,x)=>Yi(m,a[x],h))},color:function(c,a,h){return new Sn(Yi(c.r,a.r,h),Yi(c.g,a.g,h),Yi(c.b,a.b,h),Yi(c.a,a.a,h))},number:Yi});const Wm=.95047,Vo=1.08883,qm=4/29,Ul=6/29,vd=3*Ul*Ul,xl=Ul*Ul*Ul,mv=Math.PI/180,Th=180/Math.PI;function wf(c){return c>xl?Math.pow(c,1/3):c/vd+qm}function ga(c){return c>Ul?c*c*c:vd*(c-qm)}function xd(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Ef(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Sf(c){const a=Ef(c.r),h=Ef(c.g),m=Ef(c.b),x=wf((.4124564*a+.3575761*h+.1804375*m)/Wm),w=wf((.2126729*a+.7151522*h+.072175*m)/1);return{l:116*w-16,a:500*(x-w),b:200*(w-wf((.0193339*a+.119192*h+.9503041*m)/Vo)),alpha:c.a}}function $m(c){let a=(c.l+16)/116,h=isNaN(c.a)?a:a+c.a/500,m=isNaN(c.b)?a:a-c.b/200;return a=1*ga(a),h=Wm*ga(h),m=Vo*ga(m),new Sn(xd(3.2404542*h-1.5371385*a-.4985314*m),xd(-.969266*h+1.8760108*a+.041556*m),xd(.0556434*h-.2040259*a+1.0572252*m),c.alpha)}function i_(c,a,h){const m=a-c;return c+h*(m>180||m<-180?m-360*Math.round(m/360):m)}const Xm={forward:Sf,reverse:$m,interpolate:function(c,a,h){return{l:Yi(c.l,a.l,h),a:Yi(c.a,a.a,h),b:Yi(c.b,a.b,h),alpha:Yi(c.alpha,a.alpha,h)}}},Np={forward:function(c){const{l:a,a:h,b:m}=Sf(c),x=Math.atan2(m,h)*Th;return{h:x<0?x+360:x,c:Math.sqrt(h*h+m*m),l:a,alpha:c.a}},reverse:function(c){const a=c.h*mv,h=c.c;return $m({l:c.l,a:Math.cos(a)*h,b:Math.sin(a)*h,alpha:c.alpha})},interpolate:function(c,a,h){return{h:i_(c.h,a.h,h),c:Yi(c.c,a.c,h),l:Yi(c.l,a.l,h),alpha:Yi(c.alpha,a.alpha,h)}}};var Vu=Object.freeze({__proto__:null,hcl:Np,lab:Xm});class Vc{constructor(a,h,m,x,w){this.type=a,this.operator=h,this.interpolation=m,this.input=x,this.labels=[],this.outputs=[];for(const[k,A]of w)this.labels.push(k),this.outputs.push(A)}static interpolationFactor(a,h,m,x){let w=0;if(a.name==="exponential")w=Dp(h,a.base,m,x);else if(a.name==="linear")w=Dp(h,1,m,x);else if(a.name==="cubic-bezier"){const k=a.controlPoints;w=new Ne(k[0],k[1],k[2],k[3]).solve(Dp(h,1,m,x))}return w}static parse(a,h){let[m,x,w,...k]=a;if(!Array.isArray(x)||x.length===0)return h.error("Expected an interpolation type expression.",1);if(x[0]==="linear")x={name:"linear"};else if(x[0]==="exponential"){const z=x[1];if(typeof z!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);x={name:"exponential",base:z}}else{if(x[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(x[0])}`,1,0);{const z=x.slice(1);if(z.length!==4||z.some(V=>typeof V!="number"||V<0||V>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);x={name:"cubic-bezier",controlPoints:z}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(w=h.parse(w,2,ur),!w)return null;const A=[];let N=null;m==="interpolate-hcl"||m==="interpolate-lab"?N=ys:h.expectedType&&h.expectedType.kind!=="value"&&(N=h.expectedType);for(let z=0;z<k.length;z+=2){const V=k[z],X=k[z+1],ee=z+3,ae=z+4;if(typeof V!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(A.length&&A[A.length-1][0]>=V)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const he=h.parse(X,ae,N);if(!he)return null;N=N||he.type,A.push([V,he])}return N.kind==="number"||N.kind==="color"||N.kind==="array"&&N.itemType.kind==="number"&&typeof N.N=="number"?new Vc(N,m,x,w,A):h.error(`Type ${Gt(N)} is not interpolatable.`)}evaluate(a){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(a);const x=this.input.evaluate(a);if(x<=h[0])return m[0].evaluate(a);const w=h.length;if(x>=h[w-1])return m[w-1].evaluate(a);const k=vf(h,x),A=Vc.interpolationFactor(this.interpolation,x,h[k],h[k+1]),N=m[k].evaluate(a),z=m[k+1].evaluate(a);return this.operator==="interpolate"?bf[this.type.kind.toLowerCase()](N,z,A):this.operator==="interpolate-hcl"?Np.reverse(Np.interpolate(Np.forward(N),Np.forward(z),A)):Xm.reverse(Xm.interpolate(Xm.forward(N),Xm.forward(z),A))}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const h=[this.operator,a,this.input.serialize()];for(let m=0;m<this.labels.length;m++)h.push(this.labels[m],this.outputs[m].serialize());return h}}function Dp(c,a,h,m){const x=m-h,w=c-h;return x===0?0:a===1?w/x:(Math.pow(a,w)-1)/(Math.pow(a,x)-1)}var nu=Vc;class Zm{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expectected at least one argument.");let m=null;const x=h.expectedType;x&&x.kind!=="value"&&(m=x);const w=[];for(const A of a.slice(1)){const N=h.parse(A,1+w.length,m,void 0,{typeAnnotation:"omit"});if(!N)return null;m=m||N.type,w.push(N)}const k=x&&w.some(A=>Ht(x,A.type));return new Zm(k?vi:m,w)}evaluate(a){let h,m=null,x=0;for(const w of this.args){if(x++,m=w.evaluate(a),m&&m instanceof cr&&!m.available&&(h||(h=m),m=null,x===this.args.length))return h;if(m!==null)break}return m}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(h=>{a.push(h.serialize())}),a}}var s_=Zm;class Gc{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const m=[];for(let w=1;w<a.length-1;w+=2){const k=a[w];if(typeof k!="string")return h.error(`Expected string, but found ${typeof k} instead.`,w);if(/[^a-zA-Z0-9_]/.test(k))return h.error("Variable names must contain only alphanumeric characters or '_'.",w);const A=h.parse(a[w+1],w+1);if(!A)return null;m.push([k,A])}const x=h.parse(a[a.length-1],a.length-1,h.expectedType,m);return x?new Gc(m,x):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[h,m]of this.bindings)a.push(h,m.serialize());return a.push(this.result.serialize()),a}}var ts=Gc;class Lr{constructor(a,h,m){this.type=a,this.index=h,this.input=m}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,ur),x=h.parse(a[2],2,ot(h.expectedType||vi));return m&&x?new Lr(x.type.itemType,m,x):null}evaluate(a){const h=this.index.evaluate(a),m=this.input.evaluate(a);if(h<0)throw new Br(`Array index out of bounds: ${h} < 0.`);if(h>=m.length)throw new Br(`Array index out of bounds: ${h} > ${m.length-1}.`);if(h!==Math.floor(h))throw new Br(`Array index must be an integer, but found ${h} instead.`);return m[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var pc=Lr;class o_{constructor(a,h){this.type=Si,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,vi),x=h.parse(a[2],2,vi);return m&&x?En(m.type,[Si,Ei,ur,hc,vi])?new o_(m,x):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Gt(m.type)} instead`):null}evaluate(a){const h=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(m==null)return!1;if(!fe(h,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${Gt(cn(h))} instead.`);if(!fe(m,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${Gt(cn(m))} instead.`);return m.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var c0=o_;class Ym{constructor(a,h,m){this.type=ur,this.needle=a,this.haystack=h,this.fromIndex=m}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,vi),x=h.parse(a[2],2,vi);if(!m||!x)return null;if(!En(m.type,[Si,Ei,ur,hc,vi]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Gt(m.type)} instead`);if(a.length===4){const w=h.parse(a[3],3,ur);return w?new Ym(m,x,w):null}return new Ym(m,x)}evaluate(a){const h=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!fe(h,["boolean","string","number","null"]))throw new Br(`Expected first argument to be of type boolean, string, number or null, but found ${Gt(cn(h))} instead.`);if(!fe(m,["string","array"]))throw new Br(`Expected second argument to be of type array or string, but found ${Gt(cn(m))} instead.`);if(this.fromIndex){const x=this.fromIndex.evaluate(a);return m.indexOf(h,x)}return m.indexOf(h)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var gv=Ym;class a_{constructor(a,h,m,x,w,k){this.inputType=a,this.type=h,this.input=m,this.cases=x,this.outputs=w,this.otherwise=k}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let m,x;h.expectedType&&h.expectedType.kind!=="value"&&(x=h.expectedType);const w={},k=[];for(let z=2;z<a.length-1;z+=2){let V=a[z];const X=a[z+1];Array.isArray(V)||(V=[V]);const ee=h.concat(z);if(V.length===0)return ee.error("Expected at least one branch label.");for(const he of V){if(typeof he!="number"&&typeof he!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof he=="number"&&Math.abs(he)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof he=="number"&&Math.floor(he)!==he)return ee.error("Numeric branch labels must be integer values.");if(m){if(ee.checkSubtype(m,cn(he)))return null}else m=cn(he);if(w[String(he)]!==void 0)return ee.error("Branch labels must be unique.");w[String(he)]=k.length}const ae=h.parse(X,z,x);if(!ae)return null;x=x||ae.type,k.push(ae)}const A=h.parse(a[1],1,vi);if(!A)return null;const N=h.parse(a[a.length-1],a.length-1,x);return N?A.type.kind!=="value"&&h.concat(1).checkSubtype(m,A.type)?null:new a_(m,x,A,w,k,N):null}evaluate(a){const h=this.input.evaluate(a);return(cn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],h=Object.keys(this.cases).sort(),m=[],x={};for(const k of h){const A=x[this.cases[k]];A===void 0?(x[this.cases[k]]=m.length,m.push([this.cases[k],[k]])):m[A][1].push(k)}const w=k=>this.inputType.kind==="number"?Number(k):k;for(const[k,A]of m)a.push(A.length===1?w(A[0]):A.map(w)),a.push(this.outputs[k].serialize());return a.push(this.otherwise.serialize()),a}}var m3=a_;class Tf{constructor(a,h,m){this.type=a,this.branches=h,this.otherwise=m}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let m;h.expectedType&&h.expectedType.kind!=="value"&&(m=h.expectedType);const x=[];for(let k=1;k<a.length-1;k+=2){const A=h.parse(a[k],k,Si);if(!A)return null;const N=h.parse(a[k+1],k+1,m);if(!N)return null;x.push([A,N]),m=m||N.type}const w=h.parse(a[a.length-1],a.length-1,m);return w?new Tf(m,x,w):null}evaluate(a){for(const[h,m]of this.branches)if(h.evaluate(a))return m.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,m]of this.branches)a(h),a(m);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(h=>{a.push(h.serialize())}),a}}var Mf=Tf;class ru{constructor(a,h,m,x){this.type=a,this.input=h,this.beginIndex=m,this.endIndex=x}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,vi),x=h.parse(a[2],2,ur);if(!m||!x)return null;if(!En(m.type,[ot(vi),Ei,vi]))return h.error(`Expected first argument to be of type array or string, but found ${Gt(m.type)} instead`);if(a.length===4){const w=h.parse(a[3],3,ur);return w?new ru(m.type,m,x,w):null}return new ru(m.type,m,x)}evaluate(a){const h=this.input.evaluate(a),m=this.beginIndex.evaluate(a);if(!fe(h,["string","array"]))throw new Br(`Expected first argument to be of type array or string, but found ${Gt(cn(h))} instead.`);if(this.endIndex){const x=this.endIndex.evaluate(a);return h.slice(m,x)}return h.slice(m)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var l_=ru;function Km(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Jm(c,a,h,m){return m.compare(a,h)===0}function jl(c,a,h){const m=c!=="=="&&c!=="!=";return class bV{constructor(w,k,A){this.type=Si,this.lhs=w,this.rhs=k,this.collator=A,this.hasUntypedArgument=w.type.kind==="value"||k.type.kind==="value"}static parse(w,k){if(w.length!==3&&w.length!==4)return k.error("Expected two or three arguments.");const A=w[0];let N=k.parse(w[1],1,vi);if(!N)return null;if(!Km(A,N.type))return k.concat(1).error(`"${A}" comparisons are not supported for type '${Gt(N.type)}'.`);let z=k.parse(w[2],2,vi);if(!z)return null;if(!Km(A,z.type))return k.concat(2).error(`"${A}" comparisons are not supported for type '${Gt(z.type)}'.`);if(N.type.kind!==z.type.kind&&N.type.kind!=="value"&&z.type.kind!=="value")return k.error(`Cannot compare types '${Gt(N.type)}' and '${Gt(z.type)}'.`);m&&(N.type.kind==="value"&&z.type.kind!=="value"?N=new Xn(z.type,[N]):N.type.kind!=="value"&&z.type.kind==="value"&&(z=new Xn(N.type,[z])));let V=null;if(w.length===4){if(N.type.kind!=="string"&&z.type.kind!=="string"&&N.type.kind!=="value"&&z.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(V=k.parse(w[3],3,we),!V)return null}return new bV(N,z,V)}evaluate(w){const k=this.lhs.evaluate(w),A=this.rhs.evaluate(w);if(m&&this.hasUntypedArgument){const N=cn(k),z=cn(A);if(N.kind!==z.kind||N.kind!=="string"&&N.kind!=="number")throw new Br(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${N.kind}, ${z.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const N=cn(k),z=cn(A);if(N.kind!=="string"||z.kind!=="string")return a(w,k,A)}return this.collator?h(w,k,A,this.collator.evaluate(w)):a(w,k,A)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}serialize(){const w=[c];return this.eachChild(k=>{w.push(k.serialize())}),w}}}const u_=jl("==",function(c,a,h){return a===h},Jm),Qm=jl("!=",function(c,a,h){return a!==h},function(c,a,h,m){return!Jm(0,a,h,m)}),yv=jl("<",function(c,a,h){return a<h},function(c,a,h,m){return m.compare(a,h)<0}),h0=jl(">",function(c,a,h){return a>h},function(c,a,h,m){return m.compare(a,h)>0}),_v=jl("<=",function(c,a,h){return a<=h},function(c,a,h,m){return m.compare(a,h)<=0}),d0=jl(">=",function(c,a,h){return a>=h},function(c,a,h,m){return m.compare(a,h)>=0});class Hc{constructor(a,h,m,x,w,k){this.type=Ei,this.number=a,this.locale=h,this.currency=m,this.unit=x,this.minFractionDigits=w,this.maxFractionDigits=k}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const m=h.parse(a[1],1,ur);if(!m)return null;const x=a[2];if(typeof x!="object"||Array.isArray(x))return h.error("NumberFormat options argument must be an object.");let w=null;if(x.locale&&(w=h.parse(x.locale,1,Ei),!w))return null;let k=null;if(x.currency&&(k=h.parse(x.currency,1,Ei),!k))return null;let A=null;if(x.unit&&(A=h.parse(x.unit,1,Ei),!A))return null;let N=null;if(x["min-fraction-digits"]&&(N=h.parse(x["min-fraction-digits"],1,ur),!N))return null;let z=null;return x["max-fraction-digits"]&&(z=h.parse(x["max-fraction-digits"],1,ur),!z)?null:new Hc(m,w,k,A,N,z)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class mc{constructor(a){this.type=ur,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const m=h.parse(a[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Gt(m.type)} instead.`):new mc(m):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Br(`Expected value to be of type string or array, but found ${Gt(cn(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(h=>{a.push(h.serialize())}),a}}const c_={"==":u_,"!=":Qm,">":h0,"<":yv,">=":d0,"<=":_v,array:Xn,at:pc,boolean:Xn,case:Mf,coalesce:s_,collator:na,format:es,image:li,in:c0,"index-of":gv,interpolate:nu,"interpolate-hcl":nu,"interpolate-lab":nu,length:mc,let:ts,literal:ei,match:m3,number:Xn,"number-format":Hc,object:Xn,slice:l_,step:Rp,string:Xn,"to-boolean":pa,"to-color":pa,"to-number":pa,"to-string":pa,var:u0,within:Ip};function h_(c,[a,h,m,x]){a=a.evaluate(c),h=h.evaluate(c),m=m.evaluate(c);const w=x?x.evaluate(c):1,k=Bn(a,h,m,w);if(k)throw new Br(k);return new Sn(a/255*w,h/255*w,m/255*w,w)}function Mh(c,a){return c in a}function f0(c,a){const h=a[c];return h===void 0?null:h}function bu(c){return{type:c}}Oo.register(c_,{error:[{kind:"error"},[Ei],(c,[a])=>{throw new Br(a.evaluate(c))}],typeof:[Ei,[vi],(c,[a])=>Gt(cn(a.evaluate(c)))],"to-rgba":[ot(ur,4),[ys],(c,[a])=>a.evaluate(c).toArray()],rgb:[ys,[ur,ur,ur],h_],rgba:[ys,[ur,ur,ur,ur],h_],has:{type:Si,overloads:[[[Ei],(c,[a])=>Mh(a.evaluate(c),c.properties())],[[Ei,$a],(c,[a,h])=>Mh(a.evaluate(c),h.evaluate(c))]]},get:{type:vi,overloads:[[[Ei],(c,[a])=>f0(a.evaluate(c),c.properties())],[[Ei,$a],(c,[a,h])=>f0(a.evaluate(c),h.evaluate(c))]]},"feature-state":[vi,[Ei],(c,[a])=>f0(a.evaluate(c),c.featureState||{})],properties:[$a,[],c=>c.properties()],"geometry-type":[Ei,[],c=>c.geometryType()],id:[vi,[],c=>c.id()],zoom:[ur,[],c=>c.globals.zoom],pitch:[ur,[],c=>c.globals.pitch||0],"distance-from-center":[ur,[],c=>c.distanceFromCenter()],"heatmap-density":[ur,[],c=>c.globals.heatmapDensity||0],"line-progress":[ur,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[ur,[],c=>c.globals.skyRadialProgress||0],accumulated:[vi,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[ur,bu(ur),(c,a)=>{let h=0;for(const m of a)h+=m.evaluate(c);return h}],"*":[ur,bu(ur),(c,a)=>{let h=1;for(const m of a)h*=m.evaluate(c);return h}],"-":{type:ur,overloads:[[[ur,ur],(c,[a,h])=>a.evaluate(c)-h.evaluate(c)],[[ur],(c,[a])=>-a.evaluate(c)]]},"/":[ur,[ur,ur],(c,[a,h])=>a.evaluate(c)/h.evaluate(c)],"%":[ur,[ur,ur],(c,[a,h])=>a.evaluate(c)%h.evaluate(c)],ln2:[ur,[],()=>Math.LN2],pi:[ur,[],()=>Math.PI],e:[ur,[],()=>Math.E],"^":[ur,[ur,ur],(c,[a,h])=>Math.pow(a.evaluate(c),h.evaluate(c))],sqrt:[ur,[ur],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[ur,[ur],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[ur,[ur],(c,[a])=>Math.log(a.evaluate(c))],log2:[ur,[ur],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[ur,[ur],(c,[a])=>Math.sin(a.evaluate(c))],cos:[ur,[ur],(c,[a])=>Math.cos(a.evaluate(c))],tan:[ur,[ur],(c,[a])=>Math.tan(a.evaluate(c))],asin:[ur,[ur],(c,[a])=>Math.asin(a.evaluate(c))],acos:[ur,[ur],(c,[a])=>Math.acos(a.evaluate(c))],atan:[ur,[ur],(c,[a])=>Math.atan(a.evaluate(c))],min:[ur,bu(ur),(c,a)=>Math.min(...a.map(h=>h.evaluate(c)))],max:[ur,bu(ur),(c,a)=>Math.max(...a.map(h=>h.evaluate(c)))],abs:[ur,[ur],(c,[a])=>Math.abs(a.evaluate(c))],round:[ur,[ur],(c,[a])=>{const h=a.evaluate(c);return h<0?-Math.round(-h):Math.round(h)}],floor:[ur,[ur],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[ur,[ur],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Si,[Ei,vi],(c,[a,h])=>c.properties()[a.value]===h.value],"filter-id-==":[Si,[vi],(c,[a])=>c.id()===a.value],"filter-type-==":[Si,[Ei],(c,[a])=>c.geometryType()===a.value],"filter-<":[Si,[Ei,vi],(c,[a,h])=>{const m=c.properties()[a.value],x=h.value;return typeof m==typeof x&&m<x}],"filter-id-<":[Si,[vi],(c,[a])=>{const h=c.id(),m=a.value;return typeof h==typeof m&&h<m}],"filter->":[Si,[Ei,vi],(c,[a,h])=>{const m=c.properties()[a.value],x=h.value;return typeof m==typeof x&&m>x}],"filter-id->":[Si,[vi],(c,[a])=>{const h=c.id(),m=a.value;return typeof h==typeof m&&h>m}],"filter-<=":[Si,[Ei,vi],(c,[a,h])=>{const m=c.properties()[a.value],x=h.value;return typeof m==typeof x&&m<=x}],"filter-id-<=":[Si,[vi],(c,[a])=>{const h=c.id(),m=a.value;return typeof h==typeof m&&h<=m}],"filter->=":[Si,[Ei,vi],(c,[a,h])=>{const m=c.properties()[a.value],x=h.value;return typeof m==typeof x&&m>=x}],"filter-id->=":[Si,[vi],(c,[a])=>{const h=c.id(),m=a.value;return typeof h==typeof m&&h>=m}],"filter-has":[Si,[vi],(c,[a])=>a.value in c.properties()],"filter-has-id":[Si,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Si,[ot(Ei)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Si,[ot(vi)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Si,[Ei,ot(vi)],(c,[a,h])=>h.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Si,[Ei,ot(vi)],(c,[a,h])=>function(m,x,w,k){for(;w<=k;){const A=w+k>>1;if(x[A]===m)return!0;x[A]>m?k=A-1:w=A+1}return!1}(c.properties()[a.value],h.value,0,h.value.length-1)],all:{type:Si,overloads:[[[Si,Si],(c,[a,h])=>a.evaluate(c)&&h.evaluate(c)],[bu(Si),(c,a)=>{for(const h of a)if(!h.evaluate(c))return!1;return!0}]]},any:{type:Si,overloads:[[[Si,Si],(c,[a,h])=>a.evaluate(c)||h.evaluate(c)],[bu(Si),(c,a)=>{for(const h of a)if(h.evaluate(c))return!0;return!1}]]},"!":[Si,[Si],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Si,[Ei],(c,[a])=>{const h=c.globals&&c.globals.isSupportedScript;return!h||h(a.evaluate(c))}],upcase:[Ei,[Ei],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[Ei,[Ei],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[Ei,bu(vi),(c,a)=>a.map(h=>Ar(h.evaluate(c))).join("")],"resolved-locale":[Ei,[we],(c,[a])=>a.evaluate(c).resolvedLocale()]});var bd=c_;function d_(c){return{result:"success",value:c}}function wd(c){return{result:"error",value:c}}function Ed(c){return c["property-type"]==="data-driven"}function Op(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function p0(c){return!!c.expression&&c.expression.interpolated}function ds(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function eg(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function vv(c){return c}function m0(c,a){const h=a.type==="color",m=c.stops&&typeof c.stops[0][0]=="object",x=m||!(m||c.property!==void 0),w=c.type||(p0(a)?"exponential":"interval");if(h&&((c=ko({},c)).stops&&(c.stops=c.stops.map(z=>[z[0],Sn.parse(z[1])])),c.default=Sn.parse(c.default?c.default:a.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Vu[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let k,A,N;if(w==="exponential")k=kh;else if(w==="interval")k=g0;else if(w==="categorical"){k=xv,A=Object.create(null);for(const z of c.stops)A[z[0]]=z[1];N=typeof c.stops[0][0]}else{if(w!=="identity")throw new Error(`Unknown function type "${w}"`);k=y0}if(m){const z={},V=[];for(let ae=0;ae<c.stops.length;ae++){const he=c.stops[ae],Te=he[0].zoom;z[Te]===void 0&&(z[Te]={zoom:Te,type:c.type,property:c.property,default:c.default,stops:[]},V.push(Te)),z[Te].stops.push([he[0].value,he[1]])}const X=[];for(const ae of V)X.push([z[ae].zoom,m0(z[ae],a)]);const ee={name:"linear"};return{kind:"composite",interpolationType:ee,interpolationFactor:nu.interpolationFactor.bind(void 0,ee),zoomStops:X.map(ae=>ae[0]),evaluate:({zoom:ae},he)=>kh({stops:X,base:c.base},a,ae).evaluate(ae,he)}}if(x){const z=w==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:nu.interpolationFactor.bind(void 0,z),zoomStops:c.stops.map(V=>V[0]),evaluate:({zoom:V})=>k(c,a,V,A,N)}}return{kind:"source",evaluate(z,V){const X=V&&V.properties?V.properties[c.property]:void 0;return X===void 0?Fp(c.default,a.default):k(c,a,X,A,N)}}}function Fp(c,a,h){return c!==void 0?c:a!==void 0?a:h!==void 0?h:void 0}function xv(c,a,h,m,x){return Fp(typeof h===x?m[h]:void 0,c.default,a.default)}function g0(c,a,h){if(ds(h)!=="number")return Fp(c.default,a.default);const m=c.stops.length;if(m===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[m-1][0])return c.stops[m-1][1];const x=vf(c.stops.map(w=>w[0]),h);return c.stops[x][1]}function kh(c,a,h){const m=c.base!==void 0?c.base:1;if(ds(h)!=="number")return Fp(c.default,a.default);const x=c.stops.length;if(x===1||h<=c.stops[0][0])return c.stops[0][1];if(h>=c.stops[x-1][0])return c.stops[x-1][1];const w=vf(c.stops.map(V=>V[0]),h),k=function(V,X,ee,ae){const he=ae-ee,Te=V-ee;return he===0?0:X===1?Te/he:(Math.pow(X,Te)-1)/(Math.pow(X,he)-1)}(h,m,c.stops[w][0],c.stops[w+1][0]),A=c.stops[w][1],N=c.stops[w+1][1];let z=bf[a.type]||vv;if(c.colorSpace&&c.colorSpace!=="rgb"){const V=Vu[c.colorSpace];z=(X,ee)=>V.reverse(V.interpolate(V.forward(X),V.forward(ee),k))}return typeof A.evaluate=="function"?{evaluate(...V){const X=A.evaluate.apply(void 0,V),ee=N.evaluate.apply(void 0,V);if(X!==void 0&&ee!==void 0)return z(X,ee,k)}}:z(A,N,k)}function y0(c,a,h){return a.type==="color"?h=Sn.parse(h):a.type==="formatted"?h=un.fromString(h.toString()):a.type==="resolvedImage"?h=cr.fromString(h.toString()):ds(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0),Fp(h,c.default,a.default)}class zp{constructor(a,h){this.expression=a,this._warningHistory={},this._evaluator=new Xa,this._defaultValue=h?function(m){return m.type==="color"&&(eg(m.default)||Array.isArray(m.default))?new Sn(0,0,0,0):m.type==="color"?Sn.parse(m.default)||null:m.default===void 0?null:m.default}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,m,x,w,k,A,N){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=m,this._evaluator.canonical=x||null,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=k,this._evaluator.featureTileCoord=A||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(a,h,m,x,w,k,A,N){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=m||null,this._evaluator.canonical=x||null,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=k||null,this._evaluator.featureTileCoord=A||null,this._evaluator.featureDistanceData=N||null;try{const z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new Br(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(z.message)),this._defaultValue}}}function kf(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in bd}function Bp(c,a){const h=new Lp(bd,[],a?function(x){const w={color:ys,string:Ei,number:ur,enum:Ei,boolean:Si,formatted:ve,resolvedImage:Le};return x.type==="array"?ot(w[x.value]||vi,x.length):w[x.type]}(a):void 0),m=h.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?d_(new zp(m,a)):wd(h.errors)}class f_{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!vl(h.expression)}evaluateWithoutErrorHandling(a,h,m,x,w,k){return this._styleExpression.evaluateWithoutErrorHandling(a,h,m,x,w,k)}evaluate(a,h,m,x,w,k){return this._styleExpression.evaluate(a,h,m,x,w,k)}}class Up{constructor(a,h,m,x){this.kind=a,this.zoomStops=m,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!vl(h.expression),this.interpolationType=x}evaluateWithoutErrorHandling(a,h,m,x,w,k){return this._styleExpression.evaluateWithoutErrorHandling(a,h,m,x,w,k)}evaluate(a,h,m,x,w,k){return this._styleExpression.evaluate(a,h,m,x,w,k)}interpolationFactor(a,h,m){return this.interpolationType?nu.interpolationFactor(this.interpolationType,a,h,m):0}}function jp(c,a){if((c=Bp(c,a)).result==="error")return c;const h=c.value.expression,m=xu(h);if(!m&&!Ed(a))return wd([new Uo("","data expressions not supported")]);const x=tu(h,["zoom","pitch","distance-from-center"]);if(!x&&!Op(a))return wd([new Uo("","zoom expressions not supported")]);const w=ng(h);return w||x?w instanceof Uo?wd([w]):w instanceof nu&&!p0(a)?wd([new Uo("",'"interpolate" expressions cannot be used with this property')]):d_(w?new Up(m?"camera":"composite",c.value,w.labels,w instanceof nu?w.interpolation:void 0):new f_(m?"constant":"source",c.value)):wd([new Uo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class tg{constructor(a,h){this._parameters=a,this._specification=h,ko(this,m0(this._parameters,this._specification))}static deserialize(a){return new tg(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function ng(c){let a=null;if(c instanceof ts)a=ng(c.result);else if(c instanceof s_){for(const h of c.args)if(a=ng(h),a)break}else(c instanceof Rp||c instanceof nu)&&c.input instanceof Oo&&c.input.name==="zoom"&&(a=c);return a instanceof Uo||c.eachChild(h=>{const m=ng(h);m instanceof Uo?a=m:!a&&m?a=new Uo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&m&&a!==m&&(a=new Uo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class br{constructor(a,h,m,x){this.message=(a?`${a}: `:"")+m,x&&(this.identifier=x),h!=null&&h.__line__&&(this.line=h.__line__)}}function Gu(c){const a=c.key,h=c.value,m=c.valueSpec||{},x=c.objectElementValidators||{},w=c.style,k=c.styleSpec;let A=[];const N=ds(h);if(N!=="object")return[new br(a,h,`object expected, ${N} found`)];for(const z in h){const V=z.split(".")[0];let X;x[V]?X=x[V]:m[V]?X=bl:x["*"]?X=x["*"]:m["*"]&&(X=bl),X?A=A.concat(X({key:(a&&`${a}.`)+z,value:h[z],valueSpec:m[V]||m["*"],style:w,styleSpec:k,object:h,objectKey:z},h)):A.push(new br(a,h[z],`unknown property "${z}"`))}for(const z in m)x[z]||m[z].required&&m[z].default===void 0&&h[z]===void 0&&A.push(new br(a,h,`missing required property "${z}"`));return A}function Cf(c){const a=c.value,h=c.valueSpec,m=c.style,x=c.styleSpec,w=c.key,k=c.arrayElementValidator||bl;if(ds(a)!=="array")return[new br(w,a,`array expected, ${ds(a)} found`)];if(h.length&&a.length!==h.length)return[new br(w,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new br(w,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let A={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};x.$version<7&&(A.function=h.function),ds(h.value)==="object"&&(A=h.value);let N=[];for(let z=0;z<a.length;z++)N=N.concat(k({array:a,arrayIndex:z,value:a[z],valueSpec:A,style:m,styleSpec:x,key:`${w}[${z}]`}));return N}function La(c){const a=c.key,h=c.value,m=c.valueSpec;let x=ds(h);if(x==="number"&&h!=h&&(x="NaN"),x!=="number")return[new br(a,h,`number expected, ${x} found`)];if("minimum"in m){let w=m.minimum;if(ds(m.minimum)==="array"&&(w=m.minimum[c.arrayIndex]),h<w)return[new br(a,h,`${h} is less than the minimum value ${w}`)]}if("maximum"in m){let w=m.maximum;if(ds(m.maximum)==="array"&&(w=m.maximum[c.arrayIndex]),h>w)return[new br(a,h,`${h} is greater than the maximum value ${w}`)]}return[]}function ya(c){const a=c.valueSpec,h=ns(c.value.type);let m,x,w,k={};const A=h!=="categorical"&&c.value.property===void 0,N=!A,z=ds(c.value.stops)==="array"&&ds(c.value.stops[0])==="array"&&ds(c.value.stops[0][0])==="object",V=Gu({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(ae){if(h==="identity")return[new br(ae.key,ae.value,'identity function may not have a "stops" property')];let he=[];const Te=ae.value;return he=he.concat(Cf({key:ae.key,value:Te,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),ds(Te)==="array"&&Te.length===0&&he.push(new br(ae.key,Te,"array must have at least one stop")),he},default:function(ae){return bl({key:ae.key,value:ae.value,valueSpec:a,style:ae.style,styleSpec:ae.styleSpec})}}});return h==="identity"&&A&&V.push(new br(c.key,c.value,'missing required property "property"')),h==="identity"||c.value.stops||V.push(new br(c.key,c.value,'missing required property "stops"')),h==="exponential"&&c.valueSpec.expression&&!p0(c.valueSpec)&&V.push(new br(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(N&&!Ed(c.valueSpec)?V.push(new br(c.key,c.value,"property functions not supported")):A&&!Op(c.valueSpec)&&V.push(new br(c.key,c.value,"zoom functions not supported"))),h!=="categorical"&&!z||c.value.property!==void 0||V.push(new br(c.key,c.value,'"property" property is required')),V;function X(ae){let he=[];const Te=ae.value,Oe=ae.key;if(ds(Te)!=="array")return[new br(Oe,Te,`array expected, ${ds(Te)} found`)];if(Te.length!==2)return[new br(Oe,Te,`array length 2 expected, length ${Te.length} found`)];if(z){if(ds(Te[0])!=="object")return[new br(Oe,Te,`object expected, ${ds(Te[0])} found`)];if(Te[0].zoom===void 0)return[new br(Oe,Te,"object stop key must have zoom")];if(Te[0].value===void 0)return[new br(Oe,Te,"object stop key must have value")];const Ze=ns(Te[0].zoom);if(typeof Ze!="number")return[new br(Oe,Te[0].zoom,"stop zoom values must be numbers")];if(w&&w>Ze)return[new br(Oe,Te[0].zoom,"stop zoom values must appear in ascending order")];Ze!==w&&(w=Ze,x=void 0,k={}),he=he.concat(Gu({key:`${Oe}[0]`,value:Te[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:La,value:ee}}))}else he=he.concat(ee({key:`${Oe}[0]`,value:Te[0],valueSpec:{},style:ae.style,styleSpec:ae.styleSpec},Te));return kf(Ds(Te[1]))?he.concat([new br(`${Oe}[1]`,Te[1],"expressions are not allowed in function stops.")]):he.concat(bl({key:`${Oe}[1]`,value:Te[1],valueSpec:a,style:ae.style,styleSpec:ae.styleSpec}))}function ee(ae,he){const Te=ds(ae.value),Oe=ns(ae.value),Ze=ae.value!==null?ae.value:he;if(m){if(Te!==m)return[new br(ae.key,Ze,`${Te} stop domain type must match previous stop domain type ${m}`)]}else m=Te;if(Te!=="number"&&Te!=="string"&&Te!=="boolean"&&typeof Oe!="number"&&typeof Oe!="string"&&typeof Oe!="boolean")return[new br(ae.key,Ze,"stop domain value must be a number, string, or boolean")];if(Te!=="number"&&h!=="categorical"){let yt=`number expected, ${Te} found`;return Ed(a)&&h===void 0&&(yt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new br(ae.key,Ze,yt)]}return h!=="categorical"||Te!=="number"||typeof Oe=="number"&&isFinite(Oe)&&Math.floor(Oe)===Oe?h!=="categorical"&&Te==="number"&&typeof Oe=="number"&&typeof x=="number"&&x!==void 0&&Oe<x?[new br(ae.key,Ze,"stop domain values must appear in ascending order")]:(x=Oe,h==="categorical"&&Oe in k?[new br(ae.key,Ze,"stop domain values must be unique")]:(k[Oe]=!0,[])):[new br(ae.key,Ze,`integer expected, found ${String(Oe)}`)]}}function Pa(c){const a=(c.expressionContext==="property"?jp:Bp)(Ds(c.value),c.valueSpec);if(a.result==="error")return a.value.map(m=>new br(`${c.key}${m.key}`,c.value,m.message));const h=a.value.expression||a.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!h.outputDefined())return[new br(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!vl(h))return[new br(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return rg(h,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!tu(h,["zoom","feature-state"]))return[new br(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!xu(h))return[new br(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rg(c,a){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const x of a.valueSpec.expression.parameters)h.delete(x);if(h.size===0)return[];const m=[];return c instanceof Oo&&h.has(c.name)?[new br(a.key,a.value,`["${c.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(c.eachChild(x=>{m.push(...rg(x,a))}),m)}function _0(c){const a=c.key,h=c.value,m=c.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(ns(h))===-1&&x.push(new br(a,h,`expected one of [${m.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(m.values).indexOf(ns(h))===-1&&x.push(new br(a,h,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(h)} found`)),x}function p_(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!p_(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function v0(c,a="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};p_(c)||(c=Gp(c));const h=c;let m=!0;try{m=function(z){if(!Vp(z))return z;let V=Ds(z);return x0(V),V=bv(V),V}(h)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(h,null,2)}
        `)}const x=Nt[`filter_${a}`],w=Bp(m,x);let k=null;if(w.result==="error")throw new Error(w.value.map(z=>`${z.key}: ${z.message}`).join(", "));k=(z,V,X)=>w.value.evaluate(z,V,{},X);let A=null,N=null;if(m!==h){const z=Bp(h,x);if(z.result==="error")throw new Error(z.value.map(V=>`${V.key}: ${V.message}`).join(", "));A=(V,X,ee,ae,he)=>z.value.evaluate(V,X,{},ee,void 0,void 0,ae,he),N=!xu(z.value.expression)}return{filter:k,dynamicFilter:A||void 0,needGeometry:wv(m),needFeature:!!N}}function bv(c){if(!Array.isArray(c))return c;const a=function(h){if(m_.has(h[0])){for(let m=1;m<h.length;m++)if(Vp(h[m]))return!0}return h}(c);return a===!0?a:a.map(h=>bv(h))}function x0(c){let a=!1;const h=[];if(c[0]==="case"){for(let m=1;m<c.length-1;m+=2)a=a||Vp(c[m]),h.push(c[m+1]);h.push(c[c.length-1])}else if(c[0]==="match"){a=a||Vp(c[1]);for(let m=2;m<c.length-1;m+=2)h.push(c[m+1]);h.push(c[c.length-1])}else if(c[0]==="step"){a=a||Vp(c[1]);for(let m=1;m<c.length-1;m+=2)h.push(c[m+1])}a&&(c.length=0,c.push("any",...h));for(let m=1;m<c.length;m++)x0(c[m])}function Vp(c){if(!Array.isArray(c))return!1;if((a=c[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let h=1;h<c.length;h++)if(Vp(c[h]))return!0;return!1}const m_=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function g3(c,a){return c<a?-1:c>a?1:0}function wv(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let a=1;a<c.length;a++)if(wv(c[a]))return!0;return!1}function Gp(c){if(!c)return!0;const a=c[0];return c.length<=1?a!=="any":a==="=="?g_(c[1],c[2],"=="):a==="!="?b0(g_(c[1],c[2],"==")):a==="<"||a===">"||a==="<="||a===">="?g_(c[1],c[2],a):a==="any"?(h=c.slice(1),["any"].concat(h.map(Gp))):a==="all"?["all"].concat(c.slice(1).map(Gp)):a==="none"?["all"].concat(c.slice(1).map(Gp).map(b0)):a==="in"?y_(c[1],c.slice(2)):a==="!in"?b0(y_(c[1],c.slice(2))):a==="has"?__(c[1]):a==="!has"?b0(__(c[1])):a!=="within"||c;var h}function g_(c,a,h){switch(c){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,c,a]}}function y_(c,a){if(a.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",c,["literal",a.sort(g3)]]:["filter-in-small",c,["literal",a]]}}function __(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function b0(c){return["!",c]}function ig(c){return p_(Ds(c.value))?Pa(ko({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):sg(c)}function sg(c){const a=c.value,h=c.key;if(ds(a)!=="array")return[new br(h,a,`array expected, ${ds(a)} found`)];const m=c.styleSpec;let x,w=[];if(a.length<1)return[new br(h,a,"filter array must have at least 1 element")];switch(w=w.concat(_0({key:`${h}[0]`,value:a[0],valueSpec:m.filter_operator,style:c.style,styleSpec:c.styleSpec})),ns(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&ns(a[1])==="$type"&&w.push(new br(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&w.push(new br(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(x=ds(a[1]),x!=="string"&&w.push(new br(`${h}[1]`,a[1],`string expected, ${x} found`)));for(let k=2;k<a.length;k++)x=ds(a[k]),ns(a[1])==="$type"?w=w.concat(_0({key:`${h}[${k}]`,value:a[k],valueSpec:m.geometry_type,style:c.style,styleSpec:c.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&w.push(new br(`${h}[${k}]`,a[k],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let k=1;k<a.length;k++)w=w.concat(sg({key:`${h}[${k}]`,value:a[k],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":x=ds(a[1]),a.length!==2?w.push(new br(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):x!=="string"&&w.push(new br(`${h}[1]`,a[1],`string expected, ${x} found`));break;case"within":x=ds(a[1]),a.length!==2?w.push(new br(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):x!=="object"&&w.push(new br(`${h}[1]`,a[1],`object expected, ${x} found`))}return w}function v_(c,a){const h=c.key,m=c.style,x=c.styleSpec,w=c.value,k=c.objectKey,A=x[`${a}_${c.layerType}`];if(!A)return[];const N=k.match(/^(.*)-transition$/);if(a==="paint"&&N&&A[N[1]]&&A[N[1]].transition)return bl({key:h,value:w,valueSpec:x.transition,style:m,styleSpec:x});const z=c.valueSpec||A[k];if(!z)return[new br(h,w,`unknown property "${k}"`)];let V;if(ds(w)==="string"&&Ed(z)&&!z.tokens&&(V=/^{([^}]+)}$/.exec(w))){const ee=`\`{ "type": "identity", "property": ${V?JSON.stringify(V[1]):'"_"'} }\``;return[new br(h,w,`"${k}" does not support interpolation syntax
Use an identity property function instead: ${ee}.`)]}const X=[];return c.layerType==="symbol"&&(k==="text-field"&&m&&!m.glyphs&&X.push(new br(h,w,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&eg(Ds(w))&&ns(w.type)==="identity"&&X.push(new br(h,w,'"text-font" does not support identity functions'))),X.concat(bl({key:c.key,value:w,valueSpec:z,style:m,styleSpec:x,expressionContext:"property",propertyType:a,propertyKey:k}))}function Ev(c){return v_(c,"paint")}function x_(c){return v_(c,"layout")}function Sv(c){let a=[];const h=c.value,m=c.key,x=c.style,w=c.styleSpec;h.type||h.ref||a.push(new br(m,h,'either "type" or "ref" is required'));let k=ns(h.type);const A=ns(h.ref);if(h.id){const N=ns(h.id);for(let z=0;z<c.arrayIndex;z++){const V=x.layers[z];ns(V.id)===N&&a.push(new br(m,h.id,`duplicate layer id "${h.id}", previously used at line ${V.id.__line__}`))}}if("ref"in h){let N;["type","source","source-layer","filter","layout"].forEach(z=>{z in h&&a.push(new br(m,h[z],`"${z}" is prohibited for ref layers`))}),x.layers.forEach(z=>{ns(z.id)===A&&(N=z)}),N?N.ref?a.push(new br(m,h.ref,"ref cannot reference another ref layer")):k=ns(N.type):typeof A=="string"&&a.push(new br(m,h.ref,`ref layer "${A}" not found`))}else if(k!=="background"&&k!=="sky")if(h.source){const N=x.sources&&x.sources[h.source],z=N&&ns(N.type);N?z==="vector"&&k==="raster"?a.push(new br(m,h.source,`layer "${h.id}" requires a raster source`)):z==="raster"&&k!=="raster"?a.push(new br(m,h.source,`layer "${h.id}" requires a vector source`)):z!=="vector"||h["source-layer"]?z==="raster-dem"&&k!=="hillshade"?a.push(new br(m,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!h.paint||!h.paint["line-gradient"]&&!h.paint["line-trim-offset"]||z==="geojson"&&N.lineMetrics||a.push(new br(m,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new br(m,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new br(m,h.source,`source "${h.source}" not found`))}else a.push(new br(m,h,'missing required property "source"'));return a=a.concat(Gu({key:m,value:h,valueSpec:w.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>bl({key:`${m}.type`,value:h.type,valueSpec:w.layer.type,style:c.style,styleSpec:c.styleSpec,object:h,objectKey:"type"}),filter:N=>ig(ko({layerType:k},N)),layout:N=>Gu({layer:h,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":z=>x_(ko({layerType:k},z))}}),paint:N=>Gu({layer:h,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":z=>Ev(ko({layerType:k},z))}})}})),a}function Sd(c){const a=c.value,h=c.key,m=ds(a);return m!=="string"?[new br(h,a,`string expected, ${m} found`)]:[]}const Tv={promoteId:function({key:c,value:a}){if(ds(a)==="string")return Sd({key:c,value:a});{const h=[];for(const m in a)h.push(...Sd({key:`${c}.${m}`,value:a[m]}));return h}}};function Mv(c){const a=c.value,h=c.key,m=c.styleSpec,x=c.style;if(!a.type)return[new br(h,a,'"type" is required')];const w=ns(a.type);let k;switch(w){case"vector":case"raster":case"raster-dem":return k=Gu({key:h,value:a,valueSpec:m[`source_${w.replace("-","_")}`],style:c.style,styleSpec:m,objectElementValidators:Tv}),k;case"geojson":if(k=Gu({key:h,value:a,valueSpec:m.source_geojson,style:x,styleSpec:m,objectElementValidators:Tv}),a.cluster)for(const A in a.clusterProperties){const[N,z]=a.clusterProperties[A],V=typeof N=="string"?[N,["accumulated"],["get",A]]:N;k.push(...Pa({key:`${h}.${A}.map`,value:z,expressionContext:"cluster-map"})),k.push(...Pa({key:`${h}.${A}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return k;case"video":return Gu({key:h,value:a,valueSpec:m.source_video,style:x,styleSpec:m});case"image":return Gu({key:h,value:a,valueSpec:m.source_image,style:x,styleSpec:m});case"canvas":return[new br(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _0({key:`${h}.type`,value:a.type,valueSpec:{values:y3(m)},style:x,styleSpec:m})}}function y3(c){return c.source.reduce((a,h)=>{const m=c[h];return m.type.type==="enum"&&(a=a.concat(Object.keys(m.type.values))),a},[])}function kv(c){const a=c.value,h=c.styleSpec,m=h.light,x=c.style;let w=[];const k=ds(a);if(a===void 0)return w;if(k!=="object")return w=w.concat([new br("light",a,`object expected, ${k} found`)]),w;for(const A in a){const N=A.match(/^(.*)-transition$/);w=w.concat(N&&m[N[1]]&&m[N[1]].transition?bl({key:A,value:a[A],valueSpec:h.transition,style:x,styleSpec:h}):m[A]?bl({key:A,value:a[A],valueSpec:m[A],style:x,styleSpec:h}):[new br(A,a[A],`unknown property "${A}"`)])}return w}function b_(c){const a=c.value,h=c.key,m=c.style,x=c.styleSpec,w=x.terrain;let k=[];const A=ds(a);if(a===void 0)return k;if(A!=="object")return k=k.concat([new br("terrain",a,`object expected, ${A} found`)]),k;for(const N in a){const z=N.match(/^(.*)-transition$/);k=k.concat(z&&w[z[1]]&&w[z[1]].transition?bl({key:N,value:a[N],valueSpec:x.transition,style:m,styleSpec:x}):w[N]?bl({key:N,value:a[N],valueSpec:w[N],style:m,styleSpec:x}):[new br(N,a[N],`unknown property "${N}"`)])}if(a.source){const N=m.sources&&m.sources[a.source],z=N&&ns(N.type);N?z!=="raster-dem"&&k.push(new br(h,a.source,`terrain cannot be used with a source of type ${String(z)}, it only be used with a "raster-dem" source type`)):k.push(new br(h,a.source,`source "${a.source}" not found`))}else k.push(new br(h,a,'terrain is missing required property "source"'));return k}function Cv(c){const a=c.value,h=c.style,m=c.styleSpec,x=m.fog;let w=[];const k=ds(a);if(a===void 0)return w;if(k!=="object")return w=w.concat([new br("fog",a,`object expected, ${k} found`)]),w;for(const A in a){const N=A.match(/^(.*)-transition$/);w=w.concat(N&&x[N[1]]&&x[N[1]].transition?bl({key:A,value:a[A],valueSpec:m.transition,style:h,styleSpec:m}):x[A]?bl({key:A,value:a[A],valueSpec:x[A],style:h,styleSpec:m}):[new br(A,a[A],`unknown property "${A}"`)])}return w}const Iv={"*":()=>[],array:Cf,boolean:function(c){const a=c.value,h=c.key,m=ds(a);return m!=="boolean"?[new br(h,a,`boolean expected, ${m} found`)]:[]},number:La,color:function(c){const a=c.key,h=c.value,m=ds(h);return m!=="string"?[new br(a,h,`color expected, ${m} found`)]:ue(h)===null?[new br(a,h,`color expected, "${h}" found`)]:[]},enum:_0,filter:ig,function:ya,layer:Sv,object:Gu,source:Mv,light:kv,terrain:b_,fog:Cv,string:Sd,formatted:function(c){return Sd(c).length===0?[]:Pa(c)},resolvedImage:function(c){return Sd(c).length===0?[]:Pa(c)},projection:function(c){const a=c.value,h=c.styleSpec,m=h.projection,x=c.style;let w=[];const k=ds(a);if(k==="object")for(const A in a)w=w.concat(bl({key:A,value:a[A],valueSpec:m[A],style:x,styleSpec:h}));else k!=="string"&&(w=w.concat([new br("projection",a,`object or string expected, ${k} found`)]));return w}};function bl(c){const a=c.value,h=c.valueSpec,m=c.styleSpec;return h.expression&&eg(ns(a))?ya(c):h.expression&&kf(Ds(a))?Pa(c):h.type&&Iv[h.type]?Iv[h.type](c):Gu(ko({},c,{valueSpec:h.type?m[h.type]:h}))}function _3(c){const a=c.value,h=c.key,m=Sd(c);return m.length||(a.indexOf("{fontstack}")===-1&&m.push(new br(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&m.push(new br(h,a,'"glyphs" url must include a "{range}" token'))),m}function Av(c,a=Nt){return Hu(bl({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,objectElementValidators:{glyphs:_3,"*":()=>[]}}))}const v3=c=>Hu(Ev(c)),x3=c=>Hu(x_(c));function Hu(c){return c.slice().sort((a,h)=>a.line&&h.line?a.line-h.line:0)}function Lv(c,a){let h=!1;if(a&&a.length)for(const m of a)c.fire(new _l(new Error(m.message))),h=!0;return h}var b3=gc,Wu=3;function gc(c,a,h){var m=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var x=new Int32Array(this.arrayBuffer);c=x[0],this.d=(a=x[1])+2*(h=x[2]);for(var w=0;w<this.d*this.d;w++){var k=x[Wu+w],A=x[Wu+w+1];m.push(k===A?null:x.subarray(k,A))}var N=x[Wu+m.length+1];this.keys=x.subarray(x[Wu+m.length],N),this.bboxes=x.subarray(N),this.insert=this._insertReadonly}else{this.d=a+2*h;for(var z=0;z<this.d*this.d;z++)m.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=c,this.padding=h,this.scale=a/c,this.uid=0;var V=h/a*c;this.min=-V,this.max=c+V}gc.prototype.insert=function(c,a,h,m,x){this._forEachCell(a,h,m,x,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(x)},gc.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},gc.prototype._insertCell=function(c,a,h,m,x,w){this.cells[x].push(w)},gc.prototype.query=function(c,a,h,m,x){var w=this.min,k=this.max;if(c<=w&&a<=w&&k<=h&&k<=m&&!x)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(c,a,h,m,this._queryCell,A,{},x),A},gc.prototype._queryCell=function(c,a,h,m,x,w,k,A){var N=this.cells[x];if(N!==null)for(var z=this.keys,V=this.bboxes,X=0;X<N.length;X++){var ee=N[X];if(k[ee]===void 0){var ae=4*ee;(A?A(V[ae+0],V[ae+1],V[ae+2],V[ae+3]):c<=V[ae+2]&&a<=V[ae+3]&&h>=V[ae+0]&&m>=V[ae+1])?(k[ee]=!0,w.push(z[ee])):k[ee]=!1}}},gc.prototype._forEachCell=function(c,a,h,m,x,w,k,A){for(var N=this._convertToCellCoord(c),z=this._convertToCellCoord(a),V=this._convertToCellCoord(h),X=this._convertToCellCoord(m),ee=N;ee<=V;ee++)for(var ae=z;ae<=X;ae++){var he=this.d*ae+ee;if((!A||A(this._convertFromCellCoord(ee),this._convertFromCellCoord(ae),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(ae+1)))&&x.call(this,c,a,h,m,he,w,k,A))return}},gc.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},gc.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},gc.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,a=Wu+this.cells.length+1+1,h=0,m=0;m<this.cells.length;m++)h+=this.cells[m].length;var x=new Int32Array(a+h+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var w=a,k=0;k<c.length;k++){var A=c[k];x[Wu+k]=w,x.set(A,w),w+=A.length}return x[Wu+c.length]=w,x.set(this.keys,w),x[Wu+c.length+1]=w+=this.keys.length,x.set(this.bboxes,w),w+=this.bboxes.length,x.buffer};var Ch=ce(b3);const og={};function Ir(c,a,h={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writeable:!1}),og[a]={klass:c,omit:h.omit||[]}}Ir(Object,"Object"),Ch.serialize=function(c,a){const h=c.toArrayBuffer();return a&&a.push(h),{buffer:h}},Ch.deserialize=function(c){return new Ch(c.buffer)},Object.defineProperty(Ch,"name",{value:"Grid"}),Ir(Ch,"Grid"),Ir(Sn,"Color"),Ir(Error,"Error"),Ir(Xs,"AJAXError"),Ir(cr,"ResolvedImage"),Ir(tg,"StylePropertyFunction"),Ir(zp,"StyleExpression",{omit:["_evaluator"]}),Ir(Up,"ZoomDependentExpression"),Ir(f_,"ZoomConstantExpression"),Ir(Oo,"CompoundExpression",{omit:["_evaluate"]});for(const c in bd)og[bd[c]._classRegistryKey]||Ir(bd[c],`Expression${c}`);function Wc(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function w0(c){return E.ImageBitmap&&c instanceof E.ImageBitmap}function Hp(c,a){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Wc(c)||w0(c))return a&&a.push(c),c;if(ArrayBuffer.isView(c)){const h=c;return a&&a.push(h.buffer),h}if(c instanceof E.ImageData)return a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const h=[];for(const m of c)h.push(Hp(m,a));return h}if(typeof c=="object"){const h=c.constructor,m=h._classRegistryKey;if(!m)throw new Error(`can't serialize object of unregistered class ${m}`);const x=h.serialize?h.serialize(c,a):{};if(!h.serialize){for(const w in c)c.hasOwnProperty(w)&&(og[m].omit.indexOf(w)>=0||(x[w]=Hp(c[w],a)));c instanceof Error&&(x.message=c.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return m!=="Object"&&(x.$name=m),x}throw new Error("can't serialize object of type "+typeof c)}function Td(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Wc(c)||w0(c)||ArrayBuffer.isView(c)||c instanceof E.ImageData)return c;if(Array.isArray(c))return c.map(Td);if(typeof c=="object"){const a=c.$name||"Object",{klass:h}=og[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(c);const m=Object.create(h.prototype);for(const x of Object.keys(c))x!=="$name"&&(m[x]=Td(c[x]));return m}throw new Error("can't deserialize object of type "+typeof c)}const gr={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function Md(c){for(const a of c)if(If(a.charCodeAt(0)))return!0;return!1}function w3(c){for(const a of c)if(!Pv(a.charCodeAt(0)))return!1;return!0}function Pv(c){return!(gr.Arabic(c)||gr["Arabic Supplement"](c)||gr["Arabic Extended-A"](c)||gr["Arabic Presentation Forms-A"](c)||gr["Arabic Presentation Forms-B"](c))}function If(c){return!(c!==746&&c!==747&&(c<4352||!(gr["Bopomofo Extended"](c)||gr.Bopomofo(c)||gr["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||gr["CJK Compatibility Ideographs"](c)||gr["CJK Compatibility"](c)||gr["CJK Radicals Supplement"](c)||gr["CJK Strokes"](c)||!(!gr["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||gr["CJK Unified Ideographs Extension A"](c)||gr["CJK Unified Ideographs"](c)||gr["Enclosed CJK Letters and Months"](c)||gr["Hangul Compatibility Jamo"](c)||gr["Hangul Jamo Extended-A"](c)||gr["Hangul Jamo Extended-B"](c)||gr["Hangul Jamo"](c)||gr["Hangul Syllables"](c)||gr.Hiragana(c)||gr["Ideographic Description Characters"](c)||gr.Kanbun(c)||gr["Kangxi Radicals"](c)||gr["Katakana Phonetic Extensions"](c)||gr.Katakana(c)&&c!==12540||!(!gr["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!gr["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||gr["Unified Canadian Aboriginal Syllabics"](c)||gr["Unified Canadian Aboriginal Syllabics Extended"](c)||gr["Vertical Forms"](c)||gr["Yijing Hexagram Symbols"](c)||gr["Yi Syllables"](c)||gr["Yi Radicals"](c))))}function w_(c){return!(If(c)||function(a){return!!(gr["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||gr["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||gr["Letterlike Symbols"](a)||gr["Number Forms"](a)||gr["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||gr["Control Pictures"](a)&&a!==9251||gr["Optical Character Recognition"](a)||gr["Enclosed Alphanumerics"](a)||gr["Geometric Shapes"](a)||gr["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||gr["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||gr["CJK Symbols and Punctuation"](a)||gr.Katakana(a)||gr["Private Use Area"](a)||gr["CJK Compatibility Forms"](a)||gr["Small Form Variants"](a)||gr["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(c))}function E_(c){return c>=1424&&c<=2303||gr["Arabic Presentation Forms-A"](c)||gr["Arabic Presentation Forms-B"](c)}function E3(c,a){return!(!a&&E_(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||gr.Khmer(c))}function S_(c){for(const a of c)if(E_(a.charCodeAt(0)))return!0;return!1}const T_="deferred",M_="loading",k_="loaded";let Af=null,b="unavailable",d=null;const v=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(b="error"),Af&&Af(c)};function T(){C.fire(new yl("pluginStateChange",{pluginStatus:b,pluginURL:d}))}const C=new rl,L=function(){return b},B=function(){if(b!==T_||!d)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");b=M_,T(),d&&Di({url:d},c=>{c?v(c):(b=k_,T())})},U={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>b===k_||U.applyArabicShaping!=null,isLoading:()=>b===M_,setState(c){b=c.pluginStatus,d=c.pluginURL},isParsed:()=>U.applyArabicShaping!=null&&U.processBidirectionalText!=null&&U.processStyledBidirectionalText!=null,getPluginURL:()=>d};class q{constructor(a,h){this.zoom=a,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.transition=h.transition,this.pitch=h.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(h,m){for(const x of h)if(!E3(x.charCodeAt(0),m))return!1;return!0}(a,U.isLoaded())}}class ie{constructor(a,h){this.property=a,this.value=h,this.expression=function(m,x){if(eg(m))return new tg(m,x);if(kf(m)){const w=jp(m,x);if(w.result==="error")throw new Error(w.value.map(k=>`${k.key}: ${k.message}`).join(", "));return w.value}{let w=m;return typeof m=="string"&&x.type==="color"&&(w=Sn.parse(m)),{kind:"constant",evaluate:()=>w}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,h,m){return this.property.possiblyEvaluate(this,a,h,m)}}class ne{constructor(a){this.property=a,this.value=new ie(a,void 0)}transitioned(a,h){return new Re(this.property,this.value,h,ht({},a.transition,this.transition),a.now)}untransitioned(){return new Re(this.property,this.value,null,{},0)}}class be{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Mi(this._values[a].value.value)}setValue(a,h){this._values.hasOwnProperty(a)||(this._values[a]=new ne(this._values[a].property)),this._values[a].value=new ie(this._values[a].property,h===null?void 0:Mi(h))}getTransition(a){return Mi(this._values[a].transition)}setTransition(a,h){this._values.hasOwnProperty(a)||(this._values[a]=new ne(this._values[a].property)),this._values[a].transition=Mi(h)||void 0}serialize(){const a={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(a[h]=m);const x=this.getTransition(h);x!==void 0&&(a[`${h}-transition`]=x)}return a}transitioned(a,h){const m=new je(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].transitioned(a,h._values[x]);return m}untransitioned(){const a=new je(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class Re{constructor(a,h,m,x,w){const k=x.delay||0,A=x.duration||0;w=w||0,this.property=a,this.value=h,this.begin=w+k,this.end=this.begin+A,a.specification.transition&&(x.delay||x.duration)&&(this.prior=m)}possiblyEvaluate(a,h,m){const x=a.now||0,w=this.value.possiblyEvaluate(a,h,m),k=this.prior;if(k){if(x>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(x<this.begin)return k.possiblyEvaluate(a,h,m);{const A=(x-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(a,h,m),w,ye(A))}}return w}}class je{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,m){const x=new Xe(this._properties);for(const w of Object.keys(this._values))x._values[w]=this._values[w].possiblyEvaluate(a,h,m);return x}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class He{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return Mi(this._values[a].value)}setValue(a,h){this._values[a]=new ie(this._values[a].property,h===null?void 0:Mi(h))}serialize(){const a={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(a[h]=m)}return a}possiblyEvaluate(a,h,m){const x=new Xe(this._properties);for(const w of Object.keys(this._values))x._values[w]=this._values[w].possiblyEvaluate(a,h,m);return x}}class Ge{constructor(a,h,m){this.property=a,this.value=h,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,m,x){return this.property.evaluate(this.value,this.parameters,a,h,m,x)}}class Xe{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Ee{constructor(a){this.specification=a}possiblyEvaluate(a,h){return a.expression.evaluate(h)}interpolate(a,h,m){const x=bf[this.specification.type];return x?x(a,h,m):a}}class Ue{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,m,x){return new Ge(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},m,x)}:a.expression,h)}interpolate(a,h,m){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new Ge(this,{kind:"constant",value:void 0},a.parameters);const x=bf[this.specification.type];return x?new Ge(this,{kind:"constant",value:x(a.value.value,h.value.value,m)},a.parameters):a}evaluate(a,h,m,x,w,k){return a.kind==="constant"?a.value:a.evaluate(h,m,x,w,k)}}class it{constructor(a){this.specification=a}possiblyEvaluate(a,h,m,x){return!!a.expression.evaluate(h,null,{},m,x)}interpolate(){return!1}}class lt{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const h=new q(0,{});for(const m in a){const x=a[m];x.specification.overridable&&this.overridableProperties.push(m);const w=this.defaultPropertyValues[m]=new ie(x,void 0),k=this.defaultTransitionablePropertyValues[m]=new ne(x);this.defaultTransitioningPropertyValues[m]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[m]=w.possiblyEvaluate(h)}}}function Ct(c,a){return 256*(c=Ce(Math.floor(c),0,255))+Ce(Math.floor(a),0,255)}Ir(Ue,"DataDrivenProperty"),Ir(Ee,"DataConstantProperty"),Ir(it,"ColorRampProperty");const It={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Mt{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class jt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Bt(c,a=1){let h=0,m=0;return{members:c.map(x=>{const w=It[x.type].BYTES_PER_ELEMENT,k=h=Yt(h,Math.max(a,w)),A=x.components||1;return m=Math.max(m,w),h+=w*A,{name:x.name,type:x.type,components:A,offset:k}}),size:Yt(h,Math.max(m,a)),alignment:a}}function Yt(c,a){return Math.ceil(c/a)*a}class Zn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){const m=this.length;return this.resize(m+1),this.emplace(m,a,h)}emplace(a,h,m){const x=2*a;return this.int16[x+0]=h,this.int16[x+1]=m,a}}Zn.prototype.bytesPerElement=4,Ir(Zn,"StructArrayLayout2i4");class zt extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,m)}emplace(a,h,m,x){const w=3*a;return this.int16[w+0]=h,this.int16[w+1]=m,this.int16[w+2]=x,a}}zt.prototype.bytesPerElement=6,Ir(zt,"StructArrayLayout3i6");class wn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,m,x)}emplace(a,h,m,x,w){const k=4*a;return this.int16[k+0]=h,this.int16[k+1]=m,this.int16[k+2]=x,this.int16[k+3]=w,a}}wn.prototype.bytesPerElement=8,Ir(wn,"StructArrayLayout4i8");class Qt extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k,A){const N=this.length;return this.resize(N+1),this.emplace(N,a,h,m,x,w,k,A)}emplace(a,h,m,x,w,k,A,N){const z=6*a,V=12*a,X=3*a;return this.int16[z+0]=h,this.int16[z+1]=m,this.uint8[V+4]=x,this.uint8[V+5]=w,this.uint8[V+6]=k,this.uint8[V+7]=A,this.float32[X+2]=N,a}}Qt.prototype.bytesPerElement=12,Ir(Qt,"StructArrayLayout2i4ub1f12");class Gn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,m,x)}emplace(a,h,m,x,w){const k=4*a;return this.float32[k+0]=h,this.float32[k+1]=m,this.float32[k+2]=x,this.float32[k+3]=w,a}}Gn.prototype.bytesPerElement=16,Ir(Gn,"StructArrayLayout4f16");class $t extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,m,x,w)}emplace(a,h,m,x,w,k){const A=6*a,N=3*a;return this.uint16[A+0]=h,this.uint16[A+1]=m,this.uint16[A+2]=x,this.uint16[A+3]=w,this.float32[N+2]=k,a}}$t.prototype.bytesPerElement=12,Ir($t,"StructArrayLayout4ui1f12");class vn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,m,x)}emplace(a,h,m,x,w){const k=4*a;return this.uint16[k+0]=h,this.uint16[k+1]=m,this.uint16[k+2]=x,this.uint16[k+3]=w,a}}vn.prototype.bytesPerElement=8,Ir(vn,"StructArrayLayout4ui8");class Tn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k){const A=this.length;return this.resize(A+1),this.emplace(A,a,h,m,x,w,k)}emplace(a,h,m,x,w,k,A){const N=6*a;return this.int16[N+0]=h,this.int16[N+1]=m,this.int16[N+2]=x,this.int16[N+3]=w,this.int16[N+4]=k,this.int16[N+5]=A,a}}Tn.prototype.bytesPerElement=12,Ir(Tn,"StructArrayLayout6i12");class kn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k,A,N,z,V,X,ee){const ae=this.length;return this.resize(ae+1),this.emplace(ae,a,h,m,x,w,k,A,N,z,V,X,ee)}emplace(a,h,m,x,w,k,A,N,z,V,X,ee,ae){const he=12*a;return this.int16[he+0]=h,this.int16[he+1]=m,this.int16[he+2]=x,this.int16[he+3]=w,this.uint16[he+4]=k,this.uint16[he+5]=A,this.uint16[he+6]=N,this.uint16[he+7]=z,this.int16[he+8]=V,this.int16[he+9]=X,this.int16[he+10]=ee,this.int16[he+11]=ae,a}}kn.prototype.bytesPerElement=24,Ir(kn,"StructArrayLayout4i4ui4i24");class Yn extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k){const A=this.length;return this.resize(A+1),this.emplace(A,a,h,m,x,w,k)}emplace(a,h,m,x,w,k,A){const N=10*a,z=5*a;return this.int16[N+0]=h,this.int16[N+1]=m,this.int16[N+2]=x,this.float32[z+2]=w,this.float32[z+3]=k,this.float32[z+4]=A,a}}Yn.prototype.bytesPerElement=20,Ir(Yn,"StructArrayLayout3i3f20");class Ur extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}Ur.prototype.bytesPerElement=4,Ir(Ur,"StructArrayLayout1ul4");class ui extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k,A,N,z,V,X,ee,ae){const he=this.length;return this.resize(he+1),this.emplace(he,a,h,m,x,w,k,A,N,z,V,X,ee,ae)}emplace(a,h,m,x,w,k,A,N,z,V,X,ee,ae,he){const Te=20*a,Oe=10*a;return this.int16[Te+0]=h,this.int16[Te+1]=m,this.int16[Te+2]=x,this.int16[Te+3]=w,this.int16[Te+4]=k,this.float32[Oe+3]=A,this.float32[Oe+4]=N,this.float32[Oe+5]=z,this.float32[Oe+6]=V,this.int16[Te+14]=X,this.uint32[Oe+8]=ee,this.uint16[Te+18]=ae,this.uint16[Te+19]=he,a}}ui.prototype.bytesPerElement=40,Ir(ui,"StructArrayLayout5i4f1i1ul2ui40");class Mr extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k,A){const N=this.length;return this.resize(N+1),this.emplace(N,a,h,m,x,w,k,A)}emplace(a,h,m,x,w,k,A,N){const z=8*a;return this.int16[z+0]=h,this.int16[z+1]=m,this.int16[z+2]=x,this.int16[z+4]=w,this.int16[z+5]=k,this.int16[z+6]=A,this.int16[z+7]=N,a}}Mr.prototype.bytesPerElement=16,Ir(Mr,"StructArrayLayout3i2i2i16");class Xr extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,m,x,w)}emplace(a,h,m,x,w,k){const A=4*a,N=8*a;return this.float32[A+0]=h,this.float32[A+1]=m,this.float32[A+2]=x,this.int16[N+6]=w,this.int16[N+7]=k,a}}Xr.prototype.bytesPerElement=16,Ir(Xr,"StructArrayLayout2f1f2i16");class ki extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,m,x)}emplace(a,h,m,x,w){const k=12*a,A=3*a;return this.uint8[k+0]=h,this.uint8[k+1]=m,this.float32[A+1]=x,this.float32[A+2]=w,a}}ki.prototype.bytesPerElement=12,Ir(ki,"StructArrayLayout2ub2f12");class Ci extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,m)}emplace(a,h,m,x){const w=3*a;return this.float32[w+0]=h,this.float32[w+1]=m,this.float32[w+2]=x,a}}Ci.prototype.bytesPerElement=12,Ir(Ci,"StructArrayLayout3f12");class Hr extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,m)}emplace(a,h,m,x){const w=3*a;return this.uint16[w+0]=h,this.uint16[w+1]=m,this.uint16[w+2]=x,a}}Hr.prototype.bytesPerElement=6,Ir(Hr,"StructArrayLayout3ui6");class fs extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe,Ze,yt,Ke,pt,Et){const wt=this.length;return this.resize(wt+1),this.emplace(wt,a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe,Ze,yt,Ke,pt,Et)}emplace(a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe,Ze,yt,Ke,pt,Et,wt){const Kt=30*a,Xt=15*a,bn=60*a;return this.int16[Kt+0]=h,this.int16[Kt+1]=m,this.int16[Kt+2]=x,this.float32[Xt+2]=w,this.float32[Xt+3]=k,this.uint16[Kt+8]=A,this.uint16[Kt+9]=N,this.uint32[Xt+5]=z,this.uint32[Xt+6]=V,this.uint32[Xt+7]=X,this.uint16[Kt+16]=ee,this.uint16[Kt+17]=ae,this.uint16[Kt+18]=he,this.float32[Xt+10]=Te,this.float32[Xt+11]=Oe,this.uint8[bn+48]=Ze,this.uint8[bn+49]=yt,this.uint8[bn+50]=Ke,this.uint32[Xt+13]=pt,this.int16[Kt+28]=Et,this.uint8[bn+58]=wt,a}}fs.prototype.bytesPerElement=60,Ir(fs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class bs extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe,Ze,yt,Ke,pt,Et,wt,Kt,Xt,bn,Jn,on,An,Ln,$n){const tr=this.length;return this.resize(tr+1),this.emplace(tr,a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe,Ze,yt,Ke,pt,Et,wt,Kt,Xt,bn,Jn,on,An,Ln,$n)}emplace(a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe,Ze,yt,Ke,pt,Et,wt,Kt,Xt,bn,Jn,on,An,Ln,$n,tr){const _n=38*a,_r=19*a;return this.int16[_n+0]=h,this.int16[_n+1]=m,this.int16[_n+2]=x,this.float32[_r+2]=w,this.float32[_r+3]=k,this.int16[_n+8]=A,this.int16[_n+9]=N,this.int16[_n+10]=z,this.int16[_n+11]=V,this.int16[_n+12]=X,this.int16[_n+13]=ee,this.uint16[_n+14]=ae,this.uint16[_n+15]=he,this.uint16[_n+16]=Te,this.uint16[_n+17]=Oe,this.uint16[_n+18]=Ze,this.uint16[_n+19]=yt,this.uint16[_n+20]=Ke,this.uint16[_n+21]=pt,this.uint16[_n+22]=Et,this.uint16[_n+23]=wt,this.uint16[_n+24]=Kt,this.uint16[_n+25]=Xt,this.uint16[_n+26]=bn,this.uint16[_n+27]=Jn,this.uint16[_n+28]=on,this.uint32[_r+15]=An,this.float32[_r+16]=Ln,this.float32[_r+17]=$n,this.float32[_r+18]=tr,a}}bs.prototype.bytesPerElement=76,Ir(bs,"StructArrayLayout3i2f6i15ui1ul3f76");class Ts extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}Ts.prototype.bytesPerElement=4,Ir(Ts,"StructArrayLayout1f4");class Os extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,x,w){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,m,x,w)}emplace(a,h,m,x,w,k){const A=5*a;return this.float32[A+0]=h,this.float32[A+1]=m,this.float32[A+2]=x,this.float32[A+3]=w,this.float32[A+4]=k,a}}Os.prototype.bytesPerElement=20,Ir(Os,"StructArrayLayout5f20");class Ya extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,a,h,m,x)}emplace(a,h,m,x,w){const k=6*a;return this.uint32[3*a+0]=h,this.uint16[k+2]=m,this.uint16[k+3]=x,this.uint16[k+4]=w,a}}Ya.prototype.bytesPerElement=12,Ir(Ya,"StructArrayLayout1ul3ui12");class Ra extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){const m=this.length;return this.resize(m+1),this.emplace(m,a,h)}emplace(a,h,m){const x=2*a;return this.uint16[x+0]=h,this.uint16[x+1]=m,a}}Ra.prototype.bytesPerElement=4,Ir(Ra,"StructArrayLayout2ui4");class Vl extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}Vl.prototype.bytesPerElement=2,Ir(Vl,"StructArrayLayout1ui2");class wu extends jt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){const m=this.length;return this.resize(m+1),this.emplace(m,a,h)}emplace(a,h,m){const x=2*a;return this.float32[x+0]=h,this.float32[x+1]=m,a}}wu.prototype.bytesPerElement=8,Ir(wu,"StructArrayLayout2f8");class Hs extends Mt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Hs.prototype.size=40;class Fs extends ui{get(a){return new Hs(this,a)}}Ir(Fs,"CollisionBoxArray");class ps extends Mt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}ps.prototype.size=60;class Go extends fs{get(a){return new ps(this,a)}}Ir(Go,"PlacedSymbolArray");class wl extends Mt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}wl.prototype.size=76;class Ys extends bs{get(a){return new wl(this,a)}}Ir(Ys,"SymbolInstanceArray");class iu extends Ts{getoffsetX(a){return this.float32[1*a+0]}}Ir(iu,"GlyphOffsetArray");class ag extends Zn{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}Ir(ag,"SymbolLineVertexArray");class qc extends Mt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}qc.prototype.size=12;class kd extends Ya{get(a){return new qc(this,a)}}Ir(kd,"FeatureIndexArray");class Gl extends Ra{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}Ir(Gl,"FillExtrusionCentroidArray");const Ih=Bt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Lf=Bt([{name:"a_dash",components:4,type:"Uint16"}]);var Pf={exports:{}},yc={exports:{}};yc.exports=function(c,a){var h,m,x,w,k,A,N,z;for(m=c.length-(h=3&c.length),x=a,k=3432918353,A=461845907,z=0;z<m;)N=255&c.charCodeAt(z)|(255&c.charCodeAt(++z))<<8|(255&c.charCodeAt(++z))<<16|(255&c.charCodeAt(++z))<<24,++z,x=27492+(65535&(w=5*(65535&(x=(x^=N=(65535&(N=(N=(65535&N)*k+(((N>>>16)*k&65535)<<16)&4294967295)<<15|N>>>17))*A+(((N>>>16)*A&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(N=0,h){case 3:N^=(255&c.charCodeAt(z+2))<<16;case 2:N^=(255&c.charCodeAt(z+1))<<8;case 1:x^=N=(65535&(N=(N=(65535&(N^=255&c.charCodeAt(z)))*k+(((N>>>16)*k&65535)<<16)&4294967295)<<15|N>>>17))*A+(((N>>>16)*A&65535)<<16)&4294967295}return x^=c.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0};var E0=yc.exports,S3={exports:{}};S3.exports=function(c,a){for(var h,m=c.length,x=a^m,w=0;m>=4;)h=1540483477*(65535&(h=255&c.charCodeAt(w)|(255&c.charCodeAt(++w))<<8|(255&c.charCodeAt(++w))<<16|(255&c.charCodeAt(++w))<<24))+((1540483477*(h>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++w;switch(m){case 3:x^=(255&c.charCodeAt(w+2))<<16;case 2:x^=(255&c.charCodeAt(w+1))<<8;case 1:x=1540483477*(65535&(x^=255&c.charCodeAt(w)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0};var C_=E0,I_=S3.exports;Pf.exports=C_,Pf.exports.murmur3=C_,Pf.exports.murmur2=I_;var A_=ce(Pf.exports);class Na{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,m,x){this.ids.push(T3(a)),this.positions.push(h,m,x)}getPositions(a){const h=T3(a);let m=0,x=this.ids.length-1;for(;m<x;){const k=m+x>>1;this.ids[k]>=h?x=k:m=k+1}const w=[];for(;this.ids[m]===h;)w.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return w}static serialize(a,h){const m=new Float64Array(a.ids),x=new Uint32Array(a.positions);return Rv(m,x,0,m.length-1),h&&h.push(m.buffer,x.buffer),{ids:m,positions:x}}static deserialize(a){const h=new Na;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function T3(c){const a=+c;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:A_(String(c))}function Rv(c,a,h,m){for(;h<m;){const x=c[h+m>>1];let w=h-1,k=m+1;for(;;){do w++;while(c[w]<x);do k--;while(c[k]>x);if(w>=k)break;L_(c,w,k),L_(a,3*w,3*k),L_(a,3*w+1,3*k+1),L_(a,3*w+2,3*k+2)}k-h<m-k?(Rv(c,a,h,k),h=k+1):(Rv(c,a,k+1,m),m=k)}}function L_(c,a,h){const m=c[a];c[a]=c[h],c[h]=m}Ir(Na,"FeaturePositionMap");class Ah{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,h){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,h),this.initialized=!0),!!this.location}}class lg extends Ah{constructor(a){super(a),this.current=0}set(a,h,m){this.fetchUniformLocation(a,h)&&this.current!==m&&(this.current=m,this.gl.uniform1f(this.location,m))}}class Cd extends Ah{constructor(a){super(a),this.current=[0,0,0,0]}set(a,h,m){this.fetchUniformLocation(a,h)&&(m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]&&m[3]===this.current[3]||(this.current=m,this.gl.uniform4f(this.location,m[0],m[1],m[2],m[3])))}}class M3 extends Ah{constructor(a){super(a),this.current=Sn.transparent}set(a,h,m){this.fetchUniformLocation(a,h)&&(m.r===this.current.r&&m.g===this.current.g&&m.b===this.current.b&&m.a===this.current.a||(this.current=m,this.gl.uniform4f(this.location,m.r,m.g,m.b,m.a)))}}const O9=new Float32Array(16),qu=new Float32Array(9),k3=new Float32Array(4);function Rf(c){return[Ct(255*c.r,255*c.g),Ct(255*c.b,255*c.a)]}class S0{constructor(a,h,m){this.value=a,this.uniformNames=h.map(x=>`u_${x}`),this.type=m}setUniform(a,h,m,x,w){h.set(a,w,x.constantOr(this.value))}getBinding(a,h){return this.type==="color"?new M3(a):new lg(a)}}class Wp{constructor(a,h){this.uniformNames=h.map(m=>`u_${m}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,h,m,x,w){const k=w==="u_pattern"||w==="u_dash"?this.pattern:w==="u_pixel_ratio"?this.pixelRatio:null;k&&h.set(a,w,k)}getBinding(a,h){return h==="u_pattern"||h==="u_dash"?new Cd(a):new lg(a)}}class $c{constructor(a,h,m,x){this.expression=a,this.type=m,this.maxValue=0,this.paintVertexAttributes=h.map(w=>({name:`a_${w}`,type:"Float32",components:m==="color"?2:1,offset:0})),this.paintVertexArray=new x}populatePaintArray(a,h,m,x,w,k){const A=this.paintVertexArray.length,N=this.expression.evaluate(new q(0),h,{},w,x,k);this.paintVertexArray.resize(a),this._setPaintValue(A,a,N)}updatePaintArray(a,h,m,x,w){const k=this.expression.evaluate({zoom:0},m,x,void 0,w);this._setPaintValue(a,h,k)}_setPaintValue(a,h,m){if(this.type==="color"){const x=Rf(m);for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,x[0],x[1])}else{for(let x=a;x<h;x++)this.paintVertexArray.emplace(x,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $u{constructor(a,h,m,x,w,k){this.expression=a,this.uniformNames=h.map(A=>`u_${A}_t`),this.type=m,this.useIntegerZoom=x,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=h.map(A=>({name:`a_${A}`,type:"Float32",components:m==="color"?4:2,offset:0})),this.paintVertexArray=new k}populatePaintArray(a,h,m,x,w,k){const A=this.expression.evaluate(new q(this.zoom),h,{},w,x,k),N=this.expression.evaluate(new q(this.zoom+1),h,{},w,x,k),z=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(z,a,A,N)}updatePaintArray(a,h,m,x,w){const k=this.expression.evaluate({zoom:this.zoom},m,x,void 0,w),A=this.expression.evaluate({zoom:this.zoom+1},m,x,void 0,w);this._setPaintValue(a,h,k,A)}_setPaintValue(a,h,m,x){if(this.type==="color"){const w=Rf(m),k=Rf(x);for(let A=a;A<h;A++)this.paintVertexArray.emplace(A,w[0],w[1],k[0],k[1])}else{for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,m,x);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(x))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h,m,x,w){const k=this.useIntegerZoom?Math.floor(m.zoom):m.zoom,A=Ce(this.expression.interpolationFactor(k,this.zoom,this.zoom+1),0,1);h.set(a,w,A)}getBinding(a,h){return new lg(a)}}class Xc{constructor(a,h,m,x,w){this.expression=a,this.layerId=w,this.paintVertexAttributes=(m==="array"?Lf:Ih).members;for(let k=0;k<h.length;++k);this.paintVertexArray=new x}populatePaintArray(a,h,m){const x=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(x,a,h.patterns&&h.patterns[this.layerId],m)}updatePaintArray(a,h,m,x,w,k){this._setPaintValues(a,h,m.patterns&&m.patterns[this.layerId],k)}_setPaintValues(a,h,m,x){if(!x||!m)return;const w=x[m];if(!w)return;const{tl:k,br:A,pixelRatio:N}=w;for(let z=a;z<h;z++)this.paintVertexArray.emplace(z,k[0],k[1],A[0],A[1],N)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Nf{constructor(a,h,m=()=>!0){this.binders={},this._buffers=[];const x=[];for(const w in a.paint._values){if(!m(w))continue;const k=a.paint.get(w);if(!(k instanceof Ge&&Ed(k.property.specification)))continue;const A=F9(w,a.type),N=k.value,z=k.property.specification.type,V=!!k.property.useIntegerZoom,X=w==="line-dasharray"||w.endsWith("pattern"),ee=w==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant";if(N.kind!=="constant"||ee)if(N.kind==="source"||ee||X){const ae=Df(w,z,"source");this.binders[w]=X?new Xc(N,A,z,ae,a.id):new $c(N,A,z,ae),x.push(`/a_${w}`)}else{const ae=Df(w,z,"composite");this.binders[w]=new $u(N,A,z,V,h,ae),x.push(`/z_${w}`)}else this.binders[w]=X?new Wp(N.value,A):new S0(N.value,A,z),x.push(`/u_${w}`)}this.cacheKey=x.sort().join("")}getMaxValue(a){const h=this.binders[a];return h instanceof $c||h instanceof $u?h.maxValue:0}populatePaintArrays(a,h,m,x,w,k){for(const A in this.binders){const N=this.binders[A];(N instanceof $c||N instanceof $u||N instanceof Xc)&&N.populatePaintArray(a,h,m,x,w,k)}}setConstantPatternPositions(a){for(const h in this.binders){const m=this.binders[h];m instanceof Wp&&m.setConstantPatternPositions(a)}}updatePaintArrays(a,h,m,x,w,k){let A=!1;for(const N in a){const z=h.getPositions(N);for(const V of z){const X=m.feature(V.index);for(const ee in this.binders){const ae=this.binders[ee];if((ae instanceof $c||ae instanceof $u||ae instanceof Xc)&&ae.expression.isStateDependent===!0){const he=x.paint.get(ee);ae.expression=he.value,ae.updatePaintArray(V.start,V.end,X,a[N],w,k),A=!0}}}}return A}defines(){const a=[];for(const h in this.binders){const m=this.binders[h];(m instanceof S0||m instanceof Wp)&&a.push(...m.uniformNames.map(x=>`#define HAS_UNIFORM_${x}`))}return a}getBinderAttributes(){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof $c||m instanceof $u||m instanceof Xc)for(let x=0;x<m.paintVertexAttributes.length;x++)a.push(m.paintVertexAttributes[x].name)}return a}getBinderUniforms(){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof S0||m instanceof Wp||m instanceof $u)for(const x of m.uniformNames)a.push(x)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const h=[];for(const m in this.binders){const x=this.binders[m];if(x instanceof S0||x instanceof Wp||x instanceof $u)for(const w of x.uniformNames)h.push({name:w,property:m,binding:x.getBinding(a,w)})}return h}setUniforms(a,h,m,x,w){for(const{name:k,property:A,binding:N}of m)this.binders[A].setUniform(a,N,w,x.get(A),k)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const h=this.binders[a];(h instanceof $c||h instanceof $u||h instanceof Xc)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(a){for(const h in this.binders){const m=this.binders[h];(m instanceof $c||m instanceof $u||m instanceof Xc)&&m.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const h=this.binders[a];(h instanceof $c||h instanceof $u||h instanceof Xc)&&h.destroy()}}}class qp{constructor(a,h,m=()=>!0){this.programConfigurations={};for(const x of a)this.programConfigurations[x.id]=new Nf(x,h,m);this.needsUpload=!1,this._featureMap=new Na,this._bufferOffset=0}populatePaintArrays(a,h,m,x,w,k,A){for(const N in this.programConfigurations)this.programConfigurations[N].populatePaintArrays(a,h,x,w,k,A);h.id!==void 0&&this._featureMap.add(h.id,m,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,m,x,w){for(const k of m)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(a,this._featureMap,h,k,x,w)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const C3={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function F9(c,a){return C3[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const z9={"line-pattern":{source:$t,composite:$t},"fill-pattern":{source:$t,composite:$t},"fill-extrusion-pattern":{source:$t,composite:$t},"line-dasharray":{source:vn,composite:vn}},T0={color:{source:wu,composite:Gn},number:{source:Ts,composite:wu}};function Df(c,a,h){const m=z9[c];return m&&m[h]||T0[a][h]}Ir(S0,"ConstantBinder"),Ir(Wp,"PatternConstantBinder"),Ir($c,"SourceExpressionBinder"),Ir(Xc,"PatternCompositeBinder"),Ir($u,"CompositeExpressionBinder"),Ir(Nf,"ProgramConfiguration",{omit:["_buffers"]}),Ir(qp,"ProgramConfigurationSet");const ug="-transition";class Ka extends rl{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&a.type!=="sky"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),h.layout&&(this._unevaluatedLayout=new He(h.layout)),h.paint)){this._transitionablePaint=new be(h.paint);for(const m in a.paint)this.setPaintProperty(m,a.paint[m],{validate:!1});for(const m in a.layout)this.setLayoutProperty(m,a.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Xe(h.paint)}}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,h,m={}){h!=null&&this._validate(x3,`layers.${this.id}.layout.${a}`,a,h,m)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return wi(a,ug)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,m={}){if(h!=null&&this._validate(v3,`layers.${this.id}.paint.${a}`,a,h,m))return!1;if(wi(a,ug))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{const x=this._transitionablePaint._values[a],w=x.value.isDataDriven(),k=x.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);const A=this._transitionablePaint._values[a].value,N=A.isDataDriven(),z=wi(a,"pattern")||a==="line-dasharray";return N||w||z||this._handleOverridablePaintPropertyUpdate(a,k,A)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,h,m){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),fi(a,(h,m)=>!(h===void 0||m==="layout"&&!Object.keys(h).length||m==="paint"&&!Object.keys(h).length))}_validate(a,h,m,x,w={}){return(!w||w.validate!==!1)&&Lv(this,a.call(Av,{key:h,layerType:this.type,objectKey:m,value:x,styleSpec:Nt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const h=this.paint.get(a);if(h instanceof Ge&&Ed(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=v0(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const M0=Bt([{name:"a_pos",components:2,type:"Int16"}],4),Nv=Bt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Co{constructor(a=[]){this.segments=a}prepareSegment(a,h,m,x){let w=this.segments[this.segments.length-1];return a>Co.MAX_VERTEX_ARRAY_LENGTH&&Be(`Max vertices per segment is ${Co.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!w||w.vertexLength+a>Co.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==x)&&(w={vertexOffset:h.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},x!==void 0&&(w.sortKey=x),this.segments.push(w)),w}get(){return this.segments}destroy(){for(const a of this.segments)for(const h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,m,x){return new Co([{vertexOffset:a,primitiveOffset:h,vertexLength:m,primitiveLength:x,vaos:{},sortKey:0}])}}Co.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ir(Co,"SegmentVector");var Yr=8192;class Lh{constructor(a,h){a&&(h?this.setSouthWest(a).setNorthEast(h):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof ms?new ms(a.lng,a.lat):ms.convert(a),this}setSouthWest(a){return this._sw=a instanceof ms?new ms(a.lng,a.lat):ms.convert(a),this}extend(a){const h=this._sw,m=this._ne;let x,w;if(a instanceof ms)x=a,w=a;else{if(!(a instanceof Lh))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Lh.convert(a)):this.extend(ms.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&(a.hasOwnProperty("lon")||a.hasOwnProperty("lng"))?this.extend(ms.convert(a)):this;if(x=a._sw,w=a._ne,!x||!w)return this}return h||m?(h.lng=Math.min(x.lng,h.lng),h.lat=Math.min(x.lat,h.lat),m.lng=Math.max(w.lng,m.lng),m.lat=Math.max(w.lat,m.lat)):(this._sw=new ms(x.lng,x.lat),this._ne=new ms(w.lng,w.lat)),this}getCenter(){return new ms((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ms(this.getWest(),this.getNorth())}getSouthEast(){return new ms(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:h,lat:m}=ms.convert(a);let x=this._sw.lng<=h&&h<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=h&&h>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&x}static convert(a){return!a||a instanceof Lh?a:new Lh(a)}}var k0=1e-6,Io=typeof Float32Array<"u"?Float32Array:Array;function C0(){var c=new Io(9);return Io!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function Dv(c,a,h){var m=a[0],x=a[1],w=a[2],k=a[3],A=a[4],N=a[5],z=a[6],V=a[7],X=a[8],ee=h[0],ae=h[1],he=h[2],Te=h[3],Oe=h[4],Ze=h[5],yt=h[6],Ke=h[7],pt=h[8];return c[0]=ee*m+ae*k+he*z,c[1]=ee*x+ae*A+he*V,c[2]=ee*w+ae*N+he*X,c[3]=Te*m+Oe*k+Ze*z,c[4]=Te*x+Oe*A+Ze*V,c[5]=Te*w+Oe*N+Ze*X,c[6]=yt*m+Ke*k+pt*z,c[7]=yt*x+Ke*A+pt*V,c[8]=yt*w+Ke*N+pt*X,c}function _c(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function I0(c,a){var h=a[0],m=a[1],x=a[2],w=a[3],k=a[4],A=a[5],N=a[6],z=a[7],V=a[8],X=a[9],ee=a[10],ae=a[11],he=a[12],Te=a[13],Oe=a[14],Ze=a[15],yt=h*A-m*k,Ke=h*N-x*k,pt=h*z-w*k,Et=m*N-x*A,wt=m*z-w*A,Kt=x*z-w*N,Xt=V*Te-X*he,bn=V*Oe-ee*he,Jn=V*Ze-ae*he,on=X*Oe-ee*Te,An=X*Ze-ae*Te,Ln=ee*Ze-ae*Oe,$n=yt*Ln-Ke*An+pt*on+Et*Jn-wt*bn+Kt*Xt;return $n?(c[0]=(A*Ln-N*An+z*on)*($n=1/$n),c[1]=(x*An-m*Ln-w*on)*$n,c[2]=(Te*Kt-Oe*wt+Ze*Et)*$n,c[3]=(ee*wt-X*Kt-ae*Et)*$n,c[4]=(N*Jn-k*Ln-z*bn)*$n,c[5]=(h*Ln-x*Jn+w*bn)*$n,c[6]=(Oe*pt-he*Kt-Ze*Ke)*$n,c[7]=(V*Kt-ee*pt+ae*Ke)*$n,c[8]=(k*An-A*Jn+z*Xt)*$n,c[9]=(m*Jn-h*An-w*Xt)*$n,c[10]=(he*wt-Te*pt+Ze*yt)*$n,c[11]=(X*pt-V*wt-ae*yt)*$n,c[12]=(A*bn-k*on-N*Xt)*$n,c[13]=(h*on-m*bn+x*Xt)*$n,c[14]=(Te*Ke-he*Et-Oe*yt)*$n,c[15]=(V*Et-X*Ke+ee*yt)*$n,c):null}function Of(c,a,h){var m=a[0],x=a[1],w=a[2],k=a[3],A=a[4],N=a[5],z=a[6],V=a[7],X=a[8],ee=a[9],ae=a[10],he=a[11],Te=a[12],Oe=a[13],Ze=a[14],yt=a[15],Ke=h[0],pt=h[1],Et=h[2],wt=h[3];return c[0]=Ke*m+pt*A+Et*X+wt*Te,c[1]=Ke*x+pt*N+Et*ee+wt*Oe,c[2]=Ke*w+pt*z+Et*ae+wt*Ze,c[3]=Ke*k+pt*V+Et*he+wt*yt,c[4]=(Ke=h[4])*m+(pt=h[5])*A+(Et=h[6])*X+(wt=h[7])*Te,c[5]=Ke*x+pt*N+Et*ee+wt*Oe,c[6]=Ke*w+pt*z+Et*ae+wt*Ze,c[7]=Ke*k+pt*V+Et*he+wt*yt,c[8]=(Ke=h[8])*m+(pt=h[9])*A+(Et=h[10])*X+(wt=h[11])*Te,c[9]=Ke*x+pt*N+Et*ee+wt*Oe,c[10]=Ke*w+pt*z+Et*ae+wt*Ze,c[11]=Ke*k+pt*V+Et*he+wt*yt,c[12]=(Ke=h[12])*m+(pt=h[13])*A+(Et=h[14])*X+(wt=h[15])*Te,c[13]=Ke*x+pt*N+Et*ee+wt*Oe,c[14]=Ke*w+pt*z+Et*ae+wt*Ze,c[15]=Ke*k+pt*V+Et*he+wt*yt,c}function cg(c,a,h){var m,x,w,k,A,N,z,V,X,ee,ae,he,Te=h[0],Oe=h[1],Ze=h[2];return a===c?(c[12]=a[0]*Te+a[4]*Oe+a[8]*Ze+a[12],c[13]=a[1]*Te+a[5]*Oe+a[9]*Ze+a[13],c[14]=a[2]*Te+a[6]*Oe+a[10]*Ze+a[14],c[15]=a[3]*Te+a[7]*Oe+a[11]*Ze+a[15]):(x=a[1],w=a[2],k=a[3],A=a[4],N=a[5],z=a[6],V=a[7],X=a[8],ee=a[9],ae=a[10],he=a[11],c[0]=m=a[0],c[1]=x,c[2]=w,c[3]=k,c[4]=A,c[5]=N,c[6]=z,c[7]=V,c[8]=X,c[9]=ee,c[10]=ae,c[11]=he,c[12]=m*Te+A*Oe+X*Ze+a[12],c[13]=x*Te+N*Oe+ee*Ze+a[13],c[14]=w*Te+z*Oe+ae*Ze+a[14],c[15]=k*Te+V*Oe+he*Ze+a[15]),c}function Ff(c,a,h){var m=h[0],x=h[1],w=h[2];return c[0]=a[0]*m,c[1]=a[1]*m,c[2]=a[2]*m,c[3]=a[3]*m,c[4]=a[4]*x,c[5]=a[5]*x,c[6]=a[6]*x,c[7]=a[7]*x,c[8]=a[8]*w,c[9]=a[9]*w,c[10]=a[10]*w,c[11]=a[11]*w,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function P_(c,a,h){var m=Math.sin(h),x=Math.cos(h),w=a[4],k=a[5],A=a[6],N=a[7],z=a[8],V=a[9],X=a[10],ee=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=w*x+z*m,c[5]=k*x+V*m,c[6]=A*x+X*m,c[7]=N*x+ee*m,c[8]=z*x-w*m,c[9]=V*x-k*m,c[10]=X*x-A*m,c[11]=ee*x-N*m,c}function R_(c,a,h){var m=Math.sin(h),x=Math.cos(h),w=a[0],k=a[1],A=a[2],N=a[3],z=a[8],V=a[9],X=a[10],ee=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=w*x-z*m,c[1]=k*x-V*m,c[2]=A*x-X*m,c[3]=N*x-ee*m,c[8]=w*m+z*x,c[9]=k*m+V*x,c[10]=A*m+X*x,c[11]=N*m+ee*x,c}function A0(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function L0(c,a,h){var m,x,w,k=h[0],A=h[1],N=h[2],z=Math.hypot(k,A,N);return z<k0?null:(k*=z=1/z,A*=z,N*=z,m=Math.sin(a),x=Math.cos(a),c[0]=k*k*(w=1-x)+x,c[1]=A*k*w+N*m,c[2]=N*k*w-A*m,c[3]=0,c[4]=k*A*w-N*m,c[5]=A*A*w+x,c[6]=N*A*w+k*m,c[7]=0,c[8]=k*N*w+A*m,c[9]=A*N*w-k*m,c[10]=N*N*w+x,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,a=arguments.length;a--;)c+=arguments[a]*arguments[a];return Math.sqrt(c)});var Ov=Of;function N_(){var c=new Io(3);return Io!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function P0(c){var a=new Io(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function R0(c){return Math.hypot(c[0],c[1],c[2])}function zf(c,a,h){var m=new Io(3);return m[0]=c,m[1]=a,m[2]=h,m}function Ph(c,a,h){return c[0]=a[0]+h[0],c[1]=a[1]+h[1],c[2]=a[2]+h[2],c}function N0(c,a,h){return c[0]=a[0]-h[0],c[1]=a[1]-h[1],c[2]=a[2]-h[2],c}function Fv(c,a,h){return c[0]=a[0]*h[0],c[1]=a[1]*h[1],c[2]=a[2]*h[2],c}function D_(c,a,h){return c[0]=Math.min(a[0],h[0]),c[1]=Math.min(a[1],h[1]),c[2]=Math.min(a[2],h[2]),c}function D0(c,a,h){return c[0]=Math.max(a[0],h[0]),c[1]=Math.max(a[1],h[1]),c[2]=Math.max(a[2],h[2]),c}function Ja(c,a,h){return c[0]=a[0]*h,c[1]=a[1]*h,c[2]=a[2]*h,c}function Bf(c,a,h,m){return c[0]=a[0]+h[0]*m,c[1]=a[1]+h[1]*m,c[2]=a[2]+h[2]*m,c}function su(c,a){var h=a[0],m=a[1],x=a[2],w=h*h+m*m+x*x;return w>0&&(w=1/Math.sqrt(w)),c[0]=a[0]*w,c[1]=a[1]*w,c[2]=a[2]*w,c}function Zc(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function I3(c,a,h){var m=a[0],x=a[1],w=a[2],k=h[0],A=h[1],N=h[2];return c[0]=x*N-w*A,c[1]=w*k-m*N,c[2]=m*A-x*k,c}function Ho(c,a,h){var m=a[0],x=a[1],w=a[2],k=h[3]*m+h[7]*x+h[11]*w+h[15];return c[0]=(h[0]*m+h[4]*x+h[8]*w+h[12])/(k=k||1),c[1]=(h[1]*m+h[5]*x+h[9]*w+h[13])/k,c[2]=(h[2]*m+h[6]*x+h[10]*w+h[14])/k,c}function B9(c,a,h){var m=h[0],x=h[1],w=h[2],k=a[0],A=a[1],N=a[2],z=x*N-w*A,V=w*k-m*N,X=m*A-x*k,ee=x*X-w*V,ae=w*z-m*X,he=m*V-x*z,Te=2*h[3];return V*=Te,X*=Te,ae*=2,he*=2,c[0]=k+(z*=Te)+(ee*=2),c[1]=A+V+ae,c[2]=N+X+he,c}var O_,Rh=N0,A3=Fv,VM=R0;function hg(c,a,h){return c[0]=a[0]*h,c[1]=a[1]*h,c[2]=a[2]*h,c[3]=a[3]*h,c}function U9(c,a){var h=a[0],m=a[1],x=a[2],w=a[3],k=h*h+m*m+x*x+w*w;return k>0&&(k=1/Math.sqrt(k)),c[0]=h*k,c[1]=m*k,c[2]=x*k,c[3]=w*k,c}function no(c,a,h){var m=a[0],x=a[1],w=a[2],k=a[3];return c[0]=h[0]*m+h[4]*x+h[8]*w+h[12]*k,c[1]=h[1]*m+h[5]*x+h[9]*w+h[13]*k,c[2]=h[2]*m+h[6]*x+h[10]*w+h[14]*k,c[3]=h[3]*m+h[7]*x+h[11]*w+h[15]*k,c}function F_(){var c=new Io(4);return Io!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function L3(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function z_(c,a,h){h*=.5;var m=a[0],x=a[1],w=a[2],k=a[3],A=Math.sin(h),N=Math.cos(h);return c[0]=m*N+k*A,c[1]=x*N+w*A,c[2]=w*N-x*A,c[3]=k*N-m*A,c}function B_(c,a,h){h*=.5;var m=a[0],x=a[1],w=a[2],k=a[3],A=Math.sin(h),N=Math.cos(h);return c[0]=m*N-w*A,c[1]=x*N+k*A,c[2]=w*N+m*A,c[3]=k*N-x*A,c}N_(),O_=new Io(4),Io!=Float32Array&&(O_[0]=0,O_[1]=0,O_[2]=0,O_[3]=0);var U_=U9;N_(),zf(1,0,0),zf(0,1,0),F_(),F_(),C0();const j9=Bt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:P3}=j9,O0=Bt([{name:"a_pos_3",components:3,type:"Int16"}]);var dg=Bt([{name:"a_pos",type:"Int16",components:2}]);class Yc{constructor(a,h){this.pos=a,this.dir=h}intersectsPlane(a,h,m){const x=Zc(h,this.dir);if(Math.abs(x)<1e-6)return!1;const w=((a[0]-this.pos[0])*h[0]+(a[1]-this.pos[1])*h[1]+(a[2]-this.pos[2])*h[2])/x;return m[0]=this.pos[0]+this.dir[0]*w,m[1]=this.pos[1]+this.dir[1]*w,m[2]=this.pos[2]+this.dir[2]*w,!0}closestPointOnSphere(a,h,m){if(function(ae,he){var Te=ae[0],Oe=ae[1],Ze=ae[2],yt=he[0],Ke=he[1],pt=he[2];return Math.abs(Te-yt)<=k0*Math.max(1,Math.abs(Te),Math.abs(yt))&&Math.abs(Oe-Ke)<=k0*Math.max(1,Math.abs(Oe),Math.abs(Ke))&&Math.abs(Ze-pt)<=k0*Math.max(1,Math.abs(Ze),Math.abs(pt))}(this.pos,a)||h===0)return m[0]=m[1]=m[2]=0,!1;const[x,w,k]=this.dir,A=this.pos[0]-a[0],N=this.pos[1]-a[1],z=this.pos[2]-a[2],V=x*x+w*w+k*k,X=2*(A*x+N*w+z*k),ee=X*X-4*V*(A*A+N*N+z*z-h*h);if(ee<0){const ae=Math.max(-X/2,0),he=A+x*ae,Te=N+w*ae,Oe=z+k*ae,Ze=Math.hypot(he,Te,Oe);return m[0]=he*h/Ze,m[1]=Te*h/Ze,m[2]=Oe*h/Ze,!1}{const ae=(-X-Math.sqrt(ee))/(2*V);if(ae<0){const he=Math.hypot(A,N,z);return m[0]=A*h/he,m[1]=N*h/he,m[2]=z*h/he,!1}return m[0]=A+x*ae,m[1]=N+w*ae,m[2]=z+k*ae,!0}}}class zv{constructor(a,h,m,x,w){this.TL=a,this.TR=h,this.BR=m,this.BL=x,this.horizon=w}static fromInvProjectionMatrix(a,h,m){const x=[-1,1,1],w=[1,1,1],k=[1,-1,1],A=[-1,-1,1],N=Ho(x,x,a),z=Ho(w,w,a),V=Ho(k,k,a),X=Ho(A,A,a);return new zv(N,z,V,X,h/m)}}class Bv{constructor(a,h){this.points=a,this.planes=h}static fromInvProjectionMatrix(a,h,m,x){const w=Math.pow(2,m),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const z=no([],N,a),V=1/z[3]/h*w;return function(X,ee,ae){return X[0]=ee[0]*ae[0],X[1]=ee[1]*ae[1],X[2]=ee[2]*ae[2],X[3]=ee[3]*ae[3],X}(z,z,[V,V,x?1/z[3]:V,V])}),A=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const z=su([],I3([],Rh([],k[N[0]],k[N[1]]),Rh([],k[N[2]],k[N[1]]))),V=-Zc(z,k[N[1]]);return z.concat(V)});return new Bv(k,A)}}class Ao{static fromPoints(a){const h=[1/0,1/0,1/0],m=[-1/0,-1/0,-1/0];for(const x of a)D_(h,h,x),D0(m,m,x);return new Ao(h,m)}static applyTransform(a,h){const m=a.getCorners();for(let x=0;x<m.length;++x)Ho(m[x],m[x],h);return Ao.fromPoints(m)}constructor(a,h){this.min=a,this.max=h,this.center=Ja([],Ph([],this.min,this.max),.5)}quadrant(a){const h=[a%2==0,a<2],m=P0(this.min),x=P0(this.max);for(let w=0;w<h.length;w++)m[w]=h[w]?this.min[w]:this.center[w],x[w]=h[w]?this.center[w]:this.max[w];return x[2]=this.max[2],new Ao(m,x)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,h=this.max;return[[a[0],a[1],a[2]],[h[0],a[1],a[2]],[h[0],h[1],a[2]],[a[0],h[1],a[2]],[a[0],a[1],h[2]],[h[0],a[1],h[2]],[h[0],h[1],h[2]],[a[0],h[1],h[2]]]}intersects(a){const h=this.getCorners();let m=!0;for(let x=0;x<a.planes.length;x++){const w=a.planes[x];let k=0;for(let A=0;A<h.length;A++)k+=Zc(w,h[A])+w[3]>=0;if(k===0)return 0;k!==h.length&&(m=!1)}if(m)return 2;for(let x=0;x<3;x++){let w=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(let A=0;A<a.points.length;A++){const N=a.points[A][x]-this.min[x];w=Math.min(w,N),k=Math.max(k,N)}if(k<0||w>this.max[x]-this.min[x])return 0}return 1}}const R3=5,fg=6,Eu=Yr/Math.PI/2,pg=16383,Id=64,Ad=[Id,32,16],El=-Eu,Sl=Eu,F0=[new Ao([El,El,El],[Sl,Sl,Sl]),new Ao([El,El,El],[0,0,Sl]),new Ao([0,El,El],[Sl,0,Sl]),new Ao([El,0,El],[0,Sl,Sl]),new Ao([0,0,El],[Sl,Sl,Sl])];function mg(c){return c*Eu/Uf}function gg(c,a,h,m=!0){const x=Ja([],c._camera.position,c.worldSize),w=[a,h,1,1];no(w,w,c.pixelMatrixInverse),hg(w,w,1/w[3]);const k=su([],Rh([],w,x)),A=c.globeMatrix,N=[A[12],A[13],A[14]],z=Rh([],N,x),V=R0(z),X=su([],z),ee=c.worldSize/(2*Math.PI),ae=Zc(X,k),he=Math.asin(ee/V);if(he<Math.acos(ae)){if(!m)return null;const Jn=[],on=[];Ja(Jn,k,V/ae),su(on,Rh(on,Jn,z)),su(k,Ph(k,z,Ja(k,on,Math.tan(he)*V)))}const Te=[];new Yc(x,k).closestPointOnSphere(N,ee,Te);const Oe=su([],en(A,0)),Ze=su([],en(A,1)),yt=su([],en(A,2)),Ke=Zc(Oe,Te),pt=Zc(Ze,Te),Et=Zc(yt,Te),wt=et(Math.asin(-pt/ee));let Kt=et(Math.atan2(Ke,Et));Kt=c.center.lng+function(Jn,on){const An=(on-Jn+180)%360-180;return An<-180?An+360:An}(c.center.lng,Kt);const Xt=Xu(Kt),bn=Ce(Pd(wt),0,1);return new Rd(Xt,bn)}class z0{constructor(a,h,m){this.a=Rh([],a,m),this.b=Rh([],h,m),this.center=m;const x=su([],this.a),w=su([],this.b);this.angle=Math.acos(Zc(x,w))}}function $p(c,a){if(c.angle===0)return null;let h;return h=c.a[a]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),h<0||h>1?null:function(m,x,w,k){const A=Math.sin(w);return m*(Math.sin((1-k)*w)/A)+x*(Math.sin(k*w)/A)}(c.a[a],c.b[a],c.angle,Ce(h,0,1))+c.center[a]}function Kc(c){if(c.z<=1)return F0[c.z+2*c.y+c.x];const a=j_(B0(c));return Ao.fromPoints(a)}function Xp(c,a,h){return Ja(c,c,1-h),Bf(c,c,a,h)}function N3(c,a){const h=_g(a.zoom);if(h===0)return Kc(c);const m=B0(c),x=j_(m),w=Xu(m.getWest())*a.worldSize,k=Xu(m.getEast())*a.worldSize,A=Pd(m.getNorth())*a.worldSize,N=Pd(m.getSouth())*a.worldSize,z=[w,A,0],V=[k,A,0],X=[w,N,0],ee=[k,N,0],ae=I0([],a.globeMatrix);return Ho(z,z,ae),Ho(V,V,ae),Ho(X,X,ae),Ho(ee,ee,ae),x[0]=Xp(x[0],X,h),x[1]=Xp(x[1],ee,h),x[2]=Xp(x[2],V,h),x[3]=Xp(x[3],z,h),Ao.fromPoints(x)}function Uv(c,a,h){for(const m of c)Ho(m,m,a),Ja(m,m,h)}function jv(c,a,h){const m=a/c.worldSize,x=c.globeMatrix;if(h.z<=1){const Xt=Kc(h).getCorners();return Uv(Xt,x,m),Ao.fromPoints(Xt)}const w=B0(h),k=j_(w);Uv(k,x,m);const A=Number.MAX_VALUE,N=[-A,-A,-A],z=[A,A,A];if(w.contains(c.center)){for(const Jn of k)D_(z,z,Jn),D0(N,N,Jn);N[2]=0;const Xt=c.point,bn=[Xt.x*m,Xt.y*m,0];return D_(z,z,bn),D0(N,N,bn),new Ao(z,N)}const V=[x[12]*m,x[13]*m,x[14]*m],X=w.getCenter(),ee=Ce(c.center.lat,-co,co),ae=Ce(X.lat,-co,co),he=Xu(c.center.lng),Te=Pd(ee);let Oe=he-Xu(X.lng);const Ze=Te-Pd(ae);Oe>.5?Oe-=1:Oe<-.5&&(Oe+=1);let yt=0;Math.abs(Oe)>Math.abs(Ze)?yt=Oe>=0?1:3:(yt=Ze>=0?0:2,Bf(V,V,[x[4]*m,x[5]*m,x[6]*m],-Math.sin(qe(Ze>=0?w.getSouth():w.getNorth()))*Eu));const Ke=k[yt],pt=k[(yt+1)%4],Et=new z0(Ke,pt,V),wt=[$p(Et,0)||Ke[0],$p(Et,1)||Ke[1],$p(Et,2)||Ke[2]],Kt=_g(c.zoom);if(Kt>0){const Xt=function({x:Jn,y:on,z:An},Ln,$n,tr,_n){const _r=1/(1<<An);let Rr=Jn*_r,xr=Rr+_r,Pi=on*_r,nr=Pi+_r,Qr=0;const Ri=(Rr+xr)/2-tr;return Ri>.5?Qr=-1:Ri<-.5&&(Qr=1),Rr=((Rr+Qr)*Ln-(tr*=Ln))*$n+tr,xr=((xr+Qr)*Ln-tr)*$n+tr,Pi=(Pi*Ln-(_n*=Ln))*$n+_n,nr=(nr*Ln-_n)*$n+_n,[[Rr,nr,0],[xr,nr,0],[xr,Pi,0],[Rr,Pi,0]]}(h,a,c._pixelsPerMercatorPixel,he,Te);for(let Jn=0;Jn<k.length;Jn++)Xp(k[Jn],Xt[Jn],Kt);const bn=Ph([],Xt[yt],Xt[(yt+1)%4]);Ja(bn,bn,.5),Xp(wt,bn,Kt)}for(const Xt of k)D_(z,z,Xt),D0(N,N,Xt);return z[2]=Math.min(Ke[2],pt[2]),D_(z,z,wt),D0(N,N,wt),new Ao(z,N)}function B0({x:c,y:a,z:h}){const m=1/(1<<h),x=new ms(Su(c*m),sl((a+1)*m)),w=new ms(Su((c+1)*m),sl(a*m));return new Lh(x,w)}function j_(c){const a=qe(c.getNorth()),h=qe(c.getSouth()),m=Math.cos(a),x=Math.cos(h),w=Math.sin(a),k=Math.sin(h),A=c.getWest(),N=c.getEast();return[Zp(x,k,A),Zp(x,k,N),Zp(m,w,N),Zp(m,w,A)]}function Zp(c,a,h,m=Eu){return h=qe(h),[c*Math.sin(h)*m,-a*m,c*Math.cos(h)*m]}function Yp(c,a,h){return Zp(Math.cos(qe(c)),Math.sin(qe(c)),a,h)}function yg(c,a,h,m){const x=1<<h.z,w=(c/Yr+h.x)/x;return Yp(sl((a/Yr+h.y)/x),Su(w),m)}function U0({min:c,max:a}){return pg/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const Vv=new Float64Array(16);function V_(c){const a=U0(c),h=A0(Vv,[a,a,a]);return cg(h,h,((m=[])[0]=-(x=c.min)[0],m[1]=-x[1],m[2]=-x[2],m));var m,x}function wo(c){const a=(m=c.min,(h=Vv)[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=m[0],h[13]=m[1],h[14]=m[2],h[15]=1,h);var h,m;const x=1/U0(c);return Ff(a,a,[x,x,x])}function Ld(c,a,h,m,x){const w=function(N){const z=Yr/(2*Math.PI);return N/(2*Math.PI)/z}(h),k=[c,a,-h/(2*Math.PI)],A=_c(new Float64Array(16));return cg(A,A,k),Ff(A,A,[w,w,w]),P_(A,A,qe(-x)),R_(A,A,qe(-m)),A}function _g(c){return tt(R3,fg,c)}function Gv(c,a){const h=Yp(a.lat,a.lng),m=function(he){const Te=Yp(he._center.lat,he._center.lng);let Oe=I3([],zf(0,1,0),Te);const Ze=L0([],-he.angle,Te);Oe=Ho(Oe,Oe,Ze),L0(Ze,-he._pitch,Oe);const yt=su([],Te);return Ja(yt,yt,mg(he.cameraToCenterDistance/he.pixelsPerMeter)),Ho(yt,yt,Ze),Ph([],Te,yt)}(c);return k=(x=N0([],m,h))[0],A=x[1],N=x[2],z=(w=h)[0],V=w[1],X=w[2],ae=(ee=Math.sqrt(k*k+A*A+N*N)*Math.sqrt(z*z+V*V+X*X))&&Zc(x,w)/ee,Math.acos(Math.min(Math.max(ae,-1),1));var x,w,k,A,N,z,V,X,ee,ae}function Hv(c,a){return Gv(c,a)>Math.PI/2*1.01}const Jc=qe(85),vg=Math.cos(Jc),D3=Math.sin(Jc),Uf=63710088e-1,O3=2*Math.PI*Uf;class vc{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vc(Je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const h=Math.PI/180,m=this.lat*h,x=a.lat*h,w=Math.sin(m)*Math.sin(x)+Math.cos(m)*Math.cos(x)*Math.cos((a.lng-this.lng)*h);return Uf*Math.acos(Math.min(w,1))}toBounds(a=0){const h=360*a/40075017,m=h/Math.cos(Math.PI/180*this.lat);return new Lh(new vc(this.lng-m,this.lat-h),new vc(this.lng+m,this.lat+h))}toEcef(a){const h=mg(a);return Yp(this.lat,this.lng,Eu+h)}static convert(a){if(a instanceof vc)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new vc(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new vc(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var ms=vc;function xg(c){return O3*Math.cos(c*Math.PI/180)}function Xu(c){return(180+c)/360}function Pd(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Hl(c,a){return c/xg(a)}function Su(c){return 360*c-180}function sl(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Wl(c,a){return c*xg(sl(a))}const co=85.051129;function Qc(c){return 1/Math.cos(c*Math.PI/180)}class Rd{constructor(a,h,m=0){this.x=+a,this.y=+h,this.z=+m}static fromLngLat(a,h=0){const m=ms.convert(a);return new Rd(Xu(m.lng),Pd(m.lat),Hl(h,m.lat))}toLngLat(){return new ms(Su(this.x),sl(this.y))}toAltitude(){return Wl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/O3*Qc(sl(this.y))}}function Wv(c,a,h,m,x,w,k,A,N){const z=(a+m)/2,V=(h+x)/2,X=new We(z,V);A(X),function(ee,ae,he,Te,Oe,Ze){const yt=he-Oe,Ke=Te-Ze;return Math.abs((Te-ae)*yt-(he-ee)*Ke)/Math.hypot(yt,Ke)}(X.x,X.y,w.x,w.y,k.x,k.y)>=N?(Wv(c,a,h,z,V,w,X,A,N),Wv(c,z,V,m,x,X,k,A,N)):c.push(k)}function F3(c,a,h){let m=c[0],x=m.x,w=m.y;a(m);const k=[m];for(let A=1;A<c.length;A++){const N=c[A],{x:z,y:V}=N;a(N),Wv(k,x,w,z,V,m,N,a,h),x=z,w=V,m=N}return k}function qv(c,a,h,m){if(m(a,h)){const x=a.add(h)._mult(.5);qv(c,a,x,m),qv(c,x,h,m)}else c.push(h)}function V9(c,a){let h=c[0];const m=[h];for(let x=1;x<c.length;x++){const w=c[x];qv(m,h,w,a),h=w}return m}const bg=Math.pow(2,14)-1,jf=-bg-1;function Nh(c,a){const h=Math.round(c.x*a),m=Math.round(c.y*a);return c.x=Ce(h,jf,bg),c.y=Ce(m,jf,bg),(h<c.x||h>c.x+1||m<c.y||m>c.y+1)&&Be("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function Dh(c,a,h){const m=c.loadGeometry(),x=c.extent,w=Yr/x;if(a&&h&&h.projection.isReprojectedInTileSpace){const k=1<<a.z,{scale:A,x:N,y:z,projection:V}=h,X=ee=>{const ae=Su((a.x+ee.x/x)/k),he=sl((a.y+ee.y/x)/k),Te=V.project(ae,he);ee.x=(Te.x*A-N)*x,ee.y=(Te.y*A-z)*x};for(let ee=0;ee<m.length;ee++)if(c.type!==1)m[ee]=F3(m[ee],X,1);else{const ae=[];for(const he of m[ee])he.x<0||he.x>=x||he.y<0||he.y>=x||(X(he),ae.push(he));m[ee]=ae}}for(const k of m)for(const A of k)Nh(A,w);return m}function Kp(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?Dh(c):[]}}function G_(c,a,h,m,x){c.emplaceBack(2*a+(m+1)/2,2*h+(x+1)/2)}function H_(c,a,h){c.emplaceBack(a.x,a.y,a.z,h[0]*16384,h[1]*16384,h[2]*16384)}class W_{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new Zn,this.indexArray=new Hr,this.segments=new Co,this.programConfigurations=new qp(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,m,x){const w=this.layers[0],k=[];let A=null;w.type==="circle"&&(A=w.layout.get("circle-sort-key"));for(const{feature:z,id:V,index:X,sourceLayerIndex:ee}of a){const ae=this.layers[0]._featureFilter.needGeometry,he=Kp(z,ae);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),he,m))continue;const Te=A?A.evaluate(he,{},m):void 0,Oe={id:V,properties:z.properties,type:z.type,sourceLayerIndex:ee,index:X,geometry:ae?he.geometry:Dh(z,m,x),patterns:{},sortKey:Te};k.push(Oe)}A&&k.sort((z,V)=>z.sortKey-V.sortKey);let N=null;x.projection.name==="globe"&&(this.globeExtVertexArray=new Tn,N=x.projection);for(const z of k){const{geometry:V,index:X,sourceLayerIndex:ee}=z,ae=a[X].feature;this.addFeature(z,V,X,h.availableImages,m,N),h.featureIndex.insert(ae,V,X,ee,this.index)}}update(a,h,m,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,M0.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,Nv.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,h,m,x,w,k){for(const A of h)for(const N of A){const z=N.x,V=N.y;if(z<0||z>=Yr||V<0||V>=Yr)continue;if(k){const ae=k.projectTilePoint(z,V,w),he=k.upVector(w,z,V),Te=this.globeExtVertexArray;H_(Te,ae,he),H_(Te,ae,he),H_(Te,ae,he),H_(Te,ae,he)}const X=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),ee=X.vertexLength;G_(this.layoutVertexArray,z,V,-1,-1),G_(this.layoutVertexArray,z,V,1,-1),G_(this.layoutVertexArray,z,V,1,1),G_(this.layoutVertexArray,z,V,-1,1),this.indexArray.emplaceBack(ee,ee+1,ee+2),this.indexArray.emplaceBack(ee,ee+2,ee+3),X.vertexLength+=4,X.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,{},x,w)}}function z3(c,a){for(let h=0;h<c.length;h++)if(Vf(a,c[h]))return!0;for(let h=0;h<a.length;h++)if(Vf(c,a[h]))return!0;return!!$_(c,a)}function B3(c,a,h){return!!Vf(c,a)||!!X_(a,c,h)}function U3(c,a){if(c.length===1)return $v(a,c[0]);for(let h=0;h<a.length;h++){const m=a[h];for(let x=0;x<m.length;x++)if(Vf(c,m[x]))return!0}for(let h=0;h<c.length;h++)if($v(a,c[h]))return!0;for(let h=0;h<a.length;h++)if($_(c,a[h]))return!0;return!1}function q_(c,a,h){if(c.length>1){if($_(c,a))return!0;for(let m=0;m<a.length;m++)if(X_(a[m],c,h))return!0}for(let m=0;m<c.length;m++)if(X_(c[m],a,h))return!0;return!1}function $_(c,a){if(c.length===0||a.length===0)return!1;for(let h=0;h<c.length-1;h++){const m=c[h],x=c[h+1];for(let w=0;w<a.length-1;w++)if(G9(m,x,a[w],a[w+1]))return!0}return!1}function G9(c,a,h,m){return ze(c,h,m)!==ze(a,h,m)&&ze(c,a,h)!==ze(c,a,m)}function X_(c,a,h){const m=h*h;if(a.length===1)return c.distSqr(a[0])<m;for(let x=1;x<a.length;x++)if(j3(c,a[x-1],a[x])<m)return!0;return!1}function j3(c,a,h){const m=a.distSqr(h);if(m===0)return c.distSqr(a);const x=((c.x-a.x)*(h.x-a.x)+(c.y-a.y)*(h.y-a.y))/m;return c.distSqr(x<0?a:x>1?h:h.sub(a)._mult(x)._add(a))}function $v(c,a){let h,m,x,w=!1;for(let k=0;k<c.length;k++){h=c[k];for(let A=0,N=h.length-1;A<h.length;N=A++)m=h[A],x=h[N],m.y>a.y!=x.y>a.y&&a.x<(x.x-m.x)*(a.y-m.y)/(x.y-m.y)+m.x&&(w=!w)}return w}function Vf(c,a){let h=!1;for(let m=0,x=c.length-1;m<c.length;x=m++){const w=c[m],k=c[x];w.y>a.y!=k.y>a.y&&a.x<(k.x-w.x)*(a.y-w.y)/(k.y-w.y)+w.x&&(h=!h)}return h}function Xv(c,a,h,m,x){for(const k of c)if(a<=k.x&&h<=k.y&&m>=k.x&&x>=k.y)return!0;const w=[new We(a,h),new We(a,x),new We(m,x),new We(m,h)];if(c.length>2){for(const k of w)if(Vf(c,k))return!0}for(let k=0;k<c.length-1;k++)if(V3(c[k],c[k+1],w))return!0;return!1}function V3(c,a,h){const m=h[0],x=h[2];if(c.x<m.x&&a.x<m.x||c.x>x.x&&a.x>x.x||c.y<m.y&&a.y<m.y||c.y>x.y&&a.y>x.y)return!1;const w=ze(c,a,h[0]);return w!==ze(c,a,h[1])||w!==ze(c,a,h[2])||w!==ze(c,a,h[3])}function Nd(c,a,h){const m=a.paint.get(c).value;return m.kind==="constant"?m.value:h.programConfigurations.get(a.id).getMaxValue(c)}function Z_(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Y_(c,a,h,m,x){if(!a[0]&&!a[1])return c;const w=We.convert(a)._mult(x);h==="viewport"&&w._rotate(-m);const k=[];for(let A=0;A<c.length;A++)k.push(c[A].sub(w));return k}function Zv(c,a,h,m){const x=We.convert(c)._mult(m);return a==="viewport"&&x._rotate(-h),x}Ir(W_,"CircleBucket",{omit:["layers"]});const H9=new lt({"circle-sort-key":new Ue(Nt.layout_circle["circle-sort-key"])});var GM={paint:new lt({"circle-radius":new Ue(Nt.paint_circle["circle-radius"]),"circle-color":new Ue(Nt.paint_circle["circle-color"]),"circle-blur":new Ue(Nt.paint_circle["circle-blur"]),"circle-opacity":new Ue(Nt.paint_circle["circle-opacity"]),"circle-translate":new Ee(Nt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ee(Nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ee(Nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ee(Nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ue(Nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ue(Nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ue(Nt.paint_circle["circle-stroke-opacity"])}),layout:H9};function G3(c,a,h,m,x,w,k,A,N){if(w&&c.queryGeometry.isAboveHorizon)return!1;w&&(N*=c.pixelToTileUnitsFactor);const z=c.tileID.canonical,V=h.projection.upVectorScale(z,h.center.lat,h.worldSize).metersToTile;for(const X of a)for(const ee of X){const ae=ee.add(A),he=x&&h.elevation?h.elevation.exaggeration()*x.getElevationAt(ae.x,ae.y,!0):0,Te=h.projection.projectTilePoint(ae.x,ae.y,z);if(he>0){const Ke=h.projection.upVector(z,ae.x,ae.y);Te.x+=Ke[0]*V*he,Te.y+=Ke[1]*V*he,Te.z+=Ke[2]*V*he}const Oe=w?ae:W9(Te.x,Te.y,Te.z,m),Ze=w?c.tilespaceRays.map(Ke=>W3(Ke,he)):c.queryGeometry.screenGeometry,yt=no([],[Te.x,Te.y,Te.z,1],m);if(!k&&w?N*=yt[3]/h.cameraToCenterDistance:k&&!w&&(N*=h.cameraToCenterDistance/yt[3]),w){const Ke=sl((ee.y/Yr+z.y)/(1<<z.z));N/=h.projection.pixelsPerMeter(Ke,1)/Hl(1,Ke)}if(B3(Ze,Oe,N))return!0}return!1}function W9(c,a,h,m){const x=no([],[c,a,h,1],m);return new We(x[0]/x[3],x[1]/x[3])}const H3=zf(0,0,0),q9=zf(0,0,1);function W3(c,a){const h=N_();return H3[2]=a,c.intersectsPlane(H3,q9,h),new We(h[0],h[1])}class $9 extends W_{}function K_(c,{width:a,height:h},m,x){if(x){if(x instanceof Uint8ClampedArray)x=new Uint8Array(x.buffer);else if(x.length!==a*h*m)throw new RangeError("mismatched image size")}else x=new Uint8Array(a*h*m);return c.width=a,c.height=h,c.data=x,c}function Yv(c,a,h){const{width:m,height:x}=a;m===c.width&&x===c.height||(Kv(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,m),height:Math.min(c.height,x)},h),c.width=m,c.height=x,c.data=a.data)}function Kv(c,a,h,m,x,w){if(x.width===0||x.height===0)return a;if(x.width>c.width||x.height>c.height||h.x>c.width-x.width||h.y>c.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>a.width||x.height>a.height||m.x>a.width-x.width||m.y>a.height-x.height)throw new RangeError("out of range destination coordinates for image copy");const k=c.data,A=a.data;for(let N=0;N<x.height;N++){const z=((h.y+N)*c.width+h.x)*w,V=((m.y+N)*a.width+m.x)*w;for(let X=0;X<x.width*w;X++)A[V+X]=k[z+X]}return a}Ir($9,"HeatmapBucket",{omit:["layers"]});class Dd{constructor(a,h){K_(this,a,1,h)}resize(a){Yv(this,new Dd(a),1)}clone(){return new Dd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,m,x,w){Kv(a,h,m,x,w,1)}}class Tu{constructor(a,h){K_(this,a,4,h)}resize(a){Yv(this,new Tu(a),4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Tu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,m,x,w){Kv(a,h,m,x,w,4)}}Ir(Dd,"AlphaImage"),Ir(Tu,"RGBAImage");var X9={paint:new lt({"heatmap-radius":new Ue(Nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ue(Nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ee(Nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new it(Nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ee(Nt.paint_heatmap["heatmap-opacity"])})};function Jv(c){const a={},h=c.resolution||256,m=c.clips?c.clips.length:1,x=c.image||new Tu({width:h,height:m}),w=(k,A,N)=>{a[c.evaluationKey]=N;const z=c.expression.evaluate(a);x.data[k+A+0]=Math.floor(255*z.r/z.a),x.data[k+A+1]=Math.floor(255*z.g/z.a),x.data[k+A+2]=Math.floor(255*z.b/z.a),x.data[k+A+3]=Math.floor(255*z.a)};if(c.clips)for(let k=0,A=0;k<m;++k,A+=4*h)for(let N=0,z=0;N<h;N++,z+=4){const V=N/(h-1),{start:X,end:ee}=c.clips[k];w(A,z,X*(1-V)+ee*V)}else for(let k=0,A=0;k<h;k++,A+=4)w(0,A,k/(h-1));return x}var Z9={paint:new lt({"hillshade-illumination-direction":new Ee(Nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ee(Nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ee(Nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ee(Nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ee(Nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ee(Nt.paint_hillshade["hillshade-accent-color"])})};const Y9=Bt([{name:"a_pos",components:2,type:"Int16"}],4),{members:wg}=Y9;var Qv={exports:{}};function ex(c,a,h){h=h||2;var m,x,w,k,A,N,z,V=a&&a.length,X=V?a[0]*h:c.length,ee=Jp(c,0,X,h,!0),ae=[];if(!ee||ee.next===ee.prev)return ae;if(V&&(ee=function(Te,Oe,Ze,yt){var Ke,pt,Et,wt=[];for(Ke=0,pt=Oe.length;Ke<pt;Ke++)(Et=Jp(Te,Oe[Ke]*yt,Ke<pt-1?Oe[Ke+1]*yt:Te.length,yt,!1))===Et.next&&(Et.steiner=!0),wt.push($M(Et));for(wt.sort(Q9),Ke=0;Ke<wt.length;Ke++)Ze=WM(wt[Ke],Ze);return Ze}(c,a,ee,h)),c.length>80*h){m=w=c[0],x=k=c[1];for(var he=h;he<X;he+=h)(A=c[he])<m&&(m=A),(N=c[he+1])<x&&(x=N),A>w&&(w=A),N>k&&(k=N);z=(z=Math.max(w-m,k-x))!==0?32767/z:0}return Oh(ee,ae,h,m,x,z,0),ae}function Jp(c,a,h,m,x){var w,k;if(x===ix(c,a,h,m)>0)for(w=a;w<h;w+=m)k=q3(w,c[w],c[w+1],k);else for(w=h-m;w>=a;w-=m)k=q3(w,c[w],c[w+1],k);return k&&tx(k,k.next)&&(Qp(k),k=k.next),k}function Gf(c,a){if(!c)return c;a||(a=c);var h,m=c;do if(h=!1,m.steiner||!tx(m,m.next)&&ra(m.prev,m,m.next)!==0)m=m.next;else{if(Qp(m),(m=a=m.prev)===m.next)break;h=!0}while(h||m!==a);return a}function Oh(c,a,h,m,x,w,k){if(c){!k&&w&&function(V,X,ee,ae){var he=V;do he.z===0&&(he.z=J_(he.x,he.y,X,ee,ae)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==V);he.prevZ.nextZ=null,he.prevZ=null,function(Te){var Oe,Ze,yt,Ke,pt,Et,wt,Kt,Xt=1;do{for(Ze=Te,Te=null,pt=null,Et=0;Ze;){for(Et++,yt=Ze,wt=0,Oe=0;Oe<Xt&&(wt++,yt=yt.nextZ);Oe++);for(Kt=Xt;wt>0||Kt>0&&yt;)wt!==0&&(Kt===0||!yt||Ze.z<=yt.z)?(Ke=Ze,Ze=Ze.nextZ,wt--):(Ke=yt,yt=yt.nextZ,Kt--),pt?pt.nextZ=Ke:Te=Ke,Ke.prevZ=pt,pt=Ke;Ze=yt}pt.nextZ=null,Xt*=2}while(Et>1)}(he)}(c,m,x,w);for(var A,N,z=c;c.prev!==c.next;)if(A=c.prev,N=c.next,w?HM(c,m,x,w):K9(c))a.push(A.i/h|0),a.push(c.i/h|0),a.push(N.i/h|0),Qp(c),c=N.next,z=N.next;else if((c=N)===z){k?k===1?Oh(c=Eg(Gf(c),a,h),a,h,m,x,w,2):k===2&&J9(c,a,h,m,x,w):Oh(Gf(c),a,h,m,x,w,1);break}}}function K9(c){var a=c.prev,h=c,m=c.next;if(ra(a,h,m)>=0)return!1;for(var x=a.x,w=h.x,k=m.x,A=a.y,N=h.y,z=m.y,V=x<w?x<k?x:k:w<k?w:k,X=A<N?A<z?A:z:N<z?N:z,ee=x>w?x>k?x:k:w>k?w:k,ae=A>N?A>z?A:z:N>z?N:z,he=m.next;he!==a;){if(he.x>=V&&he.x<=ee&&he.y>=X&&he.y<=ae&&j0(x,A,w,N,k,z,he.x,he.y)&&ra(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function HM(c,a,h,m){var x=c.prev,w=c,k=c.next;if(ra(x,w,k)>=0)return!1;for(var A=x.x,N=w.x,z=k.x,V=x.y,X=w.y,ee=k.y,ae=A<N?A<z?A:z:N<z?N:z,he=V<X?V<ee?V:ee:X<ee?X:ee,Te=A>N?A>z?A:z:N>z?N:z,Oe=V>X?V>ee?V:ee:X>ee?X:ee,Ze=J_(ae,he,a,h,m),yt=J_(Te,Oe,a,h,m),Ke=c.prevZ,pt=c.nextZ;Ke&&Ke.z>=Ze&&pt&&pt.z<=yt;){if(Ke.x>=ae&&Ke.x<=Te&&Ke.y>=he&&Ke.y<=Oe&&Ke!==x&&Ke!==k&&j0(A,V,N,X,z,ee,Ke.x,Ke.y)&&ra(Ke.prev,Ke,Ke.next)>=0||(Ke=Ke.prevZ,pt.x>=ae&&pt.x<=Te&&pt.y>=he&&pt.y<=Oe&&pt!==x&&pt!==k&&j0(A,V,N,X,z,ee,pt.x,pt.y)&&ra(pt.prev,pt,pt.next)>=0))return!1;pt=pt.nextZ}for(;Ke&&Ke.z>=Ze;){if(Ke.x>=ae&&Ke.x<=Te&&Ke.y>=he&&Ke.y<=Oe&&Ke!==x&&Ke!==k&&j0(A,V,N,X,z,ee,Ke.x,Ke.y)&&ra(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.prevZ}for(;pt&&pt.z<=yt;){if(pt.x>=ae&&pt.x<=Te&&pt.y>=he&&pt.y<=Oe&&pt!==x&&pt!==k&&j0(A,V,N,X,z,ee,pt.x,pt.y)&&ra(pt.prev,pt,pt.next)>=0)return!1;pt=pt.nextZ}return!0}function Eg(c,a,h){var m=c;do{var x=m.prev,w=m.next.next;!tx(x,w)&&e4(x,m,m.next,w)&&V0(x,w)&&V0(w,x)&&(a.push(x.i/h|0),a.push(m.i/h|0),a.push(w.i/h|0),Qp(m),Qp(m.next),m=c=w),m=m.next}while(m!==c);return Gf(m)}function J9(c,a,h,m,x,w){var k=c;do{for(var A=k.next.next;A!==k.prev;){if(k.i!==A.i&&XM(k,A)){var N=t4(k,A);return k=Gf(k,k.next),N=Gf(N,N.next),Oh(k,a,h,m,x,w,0),void Oh(N,a,h,m,x,w,0)}A=A.next}k=k.next}while(k!==c)}function Q9(c,a){return c.x-a.x}function WM(c,a){var h=function(x,w){var k,A=w,N=x.x,z=x.y,V=-1/0;do{if(z<=A.y&&z>=A.next.y&&A.next.y!==A.y){var X=A.x+(z-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(X<=N&&X>V&&(V=X,k=A.x<A.next.x?A:A.next,X===N))return k}A=A.next}while(A!==w);if(!k)return null;var ee,ae=k,he=k.x,Te=k.y,Oe=1/0;A=k;do N>=A.x&&A.x>=he&&N!==A.x&&j0(z<Te?N:V,z,he,Te,z<Te?V:N,z,A.x,A.y)&&(ee=Math.abs(z-A.y)/(N-A.x),V0(A,x)&&(ee<Oe||ee===Oe&&(A.x>k.x||A.x===k.x&&qM(k,A)))&&(k=A,Oe=ee)),A=A.next;while(A!==ae);return k}(c,a);if(!h)return a;var m=t4(h,c);return Gf(m,m.next),Gf(h,h.next)}function qM(c,a){return ra(c.prev,c,a.prev)<0&&ra(a.next,c,c.next)<0}function J_(c,a,h,m,x){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-h)*x|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-m)*x|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function $M(c){var a=c,h=c;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==c);return h}function j0(c,a,h,m,x,w,k,A){return(x-k)*(a-A)>=(c-k)*(w-A)&&(c-k)*(m-A)>=(h-k)*(a-A)&&(h-k)*(w-A)>=(x-k)*(m-A)}function XM(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(h,m){var x=h;do{if(x.i!==h.i&&x.next.i!==h.i&&x.i!==m.i&&x.next.i!==m.i&&e4(x,x.next,h,m))return!0;x=x.next}while(x!==h);return!1}(c,a)&&(V0(c,a)&&V0(a,c)&&function(h,m){var x=h,w=!1,k=(h.x+m.x)/2,A=(h.y+m.y)/2;do x.y>A!=x.next.y>A&&x.next.y!==x.y&&k<(x.next.x-x.x)*(A-x.y)/(x.next.y-x.y)+x.x&&(w=!w),x=x.next;while(x!==h);return w}(c,a)&&(ra(c.prev,c,a.prev)||ra(c,a.prev,a))||tx(c,a)&&ra(c.prev,c,c.next)>0&&ra(a.prev,a,a.next)>0)}function ra(c,a,h){return(a.y-c.y)*(h.x-a.x)-(a.x-c.x)*(h.y-a.y)}function tx(c,a){return c.x===a.x&&c.y===a.y}function e4(c,a,h,m){var x=ws(ra(c,a,h)),w=ws(ra(c,a,m)),k=ws(ra(h,m,c)),A=ws(ra(h,m,a));return x!==w&&k!==A||!(x!==0||!nx(c,h,a))||!(w!==0||!nx(c,m,a))||!(k!==0||!nx(h,c,m))||!(A!==0||!nx(h,a,m))}function nx(c,a,h){return a.x<=Math.max(c.x,h.x)&&a.x>=Math.min(c.x,h.x)&&a.y<=Math.max(c.y,h.y)&&a.y>=Math.min(c.y,h.y)}function ws(c){return c>0?1:c<0?-1:0}function V0(c,a){return ra(c.prev,c,c.next)<0?ra(c,a,c.next)>=0&&ra(c,c.prev,a)>=0:ra(c,a,c.prev)<0||ra(c,c.next,a)<0}function t4(c,a){var h=new rx(c.i,c.x,c.y),m=new rx(a.i,a.x,a.y),x=c.next,w=a.prev;return c.next=a,a.prev=c,h.next=x,x.prev=h,m.next=h,h.prev=m,w.next=m,m.prev=w,m}function q3(c,a,h,m){var x=new rx(c,a,h);return m?(x.next=m.next,x.prev=m,m.next.prev=x,m.next=x):(x.prev=x,x.next=x),x}function Qp(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function rx(c,a,h){this.i=c,this.x=a,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ix(c,a,h,m){for(var x=0,w=a,k=h-m;w<h;w+=m)x+=(c[k]-c[w])*(c[w+1]+c[k+1]),k=w;return x}Qv.exports=ex,Qv.exports.default=ex,ex.deviation=function(c,a,h,m){var x=a&&a.length,w=Math.abs(ix(c,0,x?a[0]*h:c.length,h));if(x)for(var k=0,A=a.length;k<A;k++)w-=Math.abs(ix(c,a[k]*h,k<A-1?a[k+1]*h:c.length,h));var N=0;for(k=0;k<m.length;k+=3){var z=m[k]*h,V=m[k+1]*h,X=m[k+2]*h;N+=Math.abs((c[z]-c[X])*(c[V+1]-c[z+1])-(c[z]-c[V])*(c[X+1]-c[z+1]))}return w===0&&N===0?0:Math.abs((N-w)/w)},ex.flatten=function(c){for(var a=c[0][0].length,h={vertices:[],holes:[],dimensions:a},m=0,x=0;x<c.length;x++){for(var w=0;w<c[x].length;w++)for(var k=0;k<a;k++)h.vertices.push(c[x][w][k]);x>0&&h.holes.push(m+=c[x-1].length)}return h};var sx=ce(Qv.exports);function $3(c,a,h,m,x){X3(c,a,h||0,m||c.length-1,x||n4)}function X3(c,a,h,m,x){for(;m>h;){if(m-h>600){var w=m-h+1,k=a-h+1,A=Math.log(w),N=.5*Math.exp(2*A/3),z=.5*Math.sqrt(A*N*(w-N)/w)*(k-w/2<0?-1:1);X3(c,a,Math.max(h,Math.floor(a-k*N/w+z)),Math.min(m,Math.floor(a+(w-k)*N/w+z)),x)}var V=c[a],X=h,ee=m;for(Od(c,h,a),x(c[m],V)>0&&Od(c,h,m);X<ee;){for(Od(c,X,ee),X++,ee--;x(c[X],V)<0;)X++;for(;x(c[ee],V)>0;)ee--}x(c[h],V)===0?Od(c,h,ee):Od(c,++ee,m),ee<=a&&(h=ee+1),a<=ee&&(m=ee-1)}}function Od(c,a,h){var m=c[a];c[a]=c[h],c[h]=m}function n4(c,a){return c<a?-1:c>a?1:0}function G0(c,a){const h=c.length;if(h<=1)return[c];const m=[];let x,w;for(let k=0;k<h;k++){const A=vt(c[k]);A!==0&&(c[k].area=Math.abs(A),w===void 0&&(w=A<0),w===A<0?(x&&m.push(x),x=[c[k]]):x.push(c[k]))}if(x&&m.push(x),a>1)for(let k=0;k<m.length;k++)m[k].length<=a||($3(m[k],a,1,m[k].length-1,r4),m[k]=m[k].slice(0,a));return m}function r4(c,a){return a.area-c.area}function ox(c,a,h){const m=h.patternDependencies;let x=!1;for(const w of a){const k=w.paint.get(`${c}-pattern`);k.isConstant()||(x=!0);const A=k.constantOr(null);A&&(x=!0,m[A]=!0)}return x}function ax(c,a,h,m,x){const w=x.patternDependencies;for(const k of a){const A=k.paint.get(`${c}-pattern`).value;if(A.kind!=="constant"){let N=A.evaluate({zoom:m},h,{},x.availableImages);N=N&&N.name?N.name:N,w[N]=!0,h.patterns[k.id]=N}}return h}class Fh{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Zn,this.indexArray=new Hr,this.indexArray2=new Ra,this.programConfigurations=new qp(a.layers,a.zoom),this.segments=new Co,this.segments2=new Co,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.projection=a.projection}populate(a,h,m,x){this.hasPattern=ox("fill",this.layers,h);const w=this.layers[0].layout.get("fill-sort-key"),k=[];for(const{feature:A,id:N,index:z,sourceLayerIndex:V}of a){const X=this.layers[0]._featureFilter.needGeometry,ee=Kp(A,X);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),ee,m))continue;const ae=w?w.evaluate(ee,{},m,h.availableImages):void 0,he={id:N,properties:A.properties,type:A.type,sourceLayerIndex:V,index:z,geometry:X?ee.geometry:Dh(A,m,x),patterns:{},sortKey:ae};k.push(he)}w&&k.sort((A,N)=>A.sortKey-N.sortKey);for(const A of k){const{geometry:N,index:z,sourceLayerIndex:V}=A;if(this.hasPattern){const X=ax("fill",this.layers,A,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(A,N,z,m,{},h.availableImages);h.featureIndex.insert(a[z].feature,N,z,V,this.index)}}update(a,h,m,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m,x)}addFeatures(a,h,m,x,w){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,h,m,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,wg),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,m,x,w,k=[]){for(const A of G0(h,500)){let N=0;for(const he of A)N+=he.length;const z=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray),V=z.vertexLength,X=[],ee=[];for(const he of A){if(he.length===0)continue;he!==A[0]&&ee.push(X.length/2);const Te=this.segments2.prepareSegment(he.length,this.layoutVertexArray,this.indexArray2),Oe=Te.vertexLength;this.layoutVertexArray.emplaceBack(he[0].x,he[0].y),this.indexArray2.emplaceBack(Oe+he.length-1,Oe),X.push(he[0].x),X.push(he[0].y);for(let Ze=1;Ze<he.length;Ze++)this.layoutVertexArray.emplaceBack(he[Ze].x,he[Ze].y),this.indexArray2.emplaceBack(Oe+Ze-1,Oe+Ze),X.push(he[Ze].x),X.push(he[Ze].y);Te.vertexLength+=he.length,Te.primitiveLength+=he.length}const ae=sx(X,ee);for(let he=0;he<ae.length;he+=3)this.indexArray.emplaceBack(V+ae[he],V+ae[he+1],V+ae[he+2]);z.vertexLength+=N,z.primitiveLength+=ae.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,w,k,x)}}Ir(Fh,"FillBucket",{omit:["layers","patternFeatures"]});const lx=new lt({"fill-sort-key":new Ue(Nt.layout_fill["fill-sort-key"])});var Z3={paint:new lt({"fill-antialias":new Ee(Nt.paint_fill["fill-antialias"]),"fill-opacity":new Ue(Nt.paint_fill["fill-opacity"]),"fill-color":new Ue(Nt.paint_fill["fill-color"]),"fill-outline-color":new Ue(Nt.paint_fill["fill-outline-color"]),"fill-translate":new Ee(Nt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ee(Nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ue(Nt.paint_fill["fill-pattern"])}),layout:lx};const i4=Bt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),s4=Bt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),ZM=Bt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:o4}=i4;var Q_={},a4=ut,Y3=Hf;function Hf(c,a,h,m,x){this.properties={},this.extent=h,this.type=0,this._pbf=c,this._geometry=-1,this._keys=m,this._values=x,c.readFields(l4,this,a)}function l4(c,a,h){c==1?a.id=h.readVarint():c==2?function(m,x){for(var w=m.readVarint()+m.pos;m.pos<w;){var k=x._keys[m.readVarint()],A=x._values[m.readVarint()];x.properties[k]=A}}(h,a):c==3?a.type=h.readVarint():c==4&&(a._geometry=h.pos)}function ux(c){for(var a,h,m=0,x=0,w=c.length,k=w-1;x<w;k=x++)m+=((h=c[k]).x-(a=c[x]).x)*(a.y+h.y);return m}Hf.types=["Unknown","Point","LineString","Polygon"],Hf.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a,h=c.readVarint()+c.pos,m=1,x=0,w=0,k=0,A=[];c.pos<h;){if(x<=0){var N=c.readVarint();m=7&N,x=N>>3}if(x--,m===1||m===2)w+=c.readSVarint(),k+=c.readSVarint(),m===1&&(a&&A.push(a),a=[]),a.push(new a4(w,k));else{if(m!==7)throw new Error("unknown command "+m);a&&a.push(a[0].clone())}}return a&&A.push(a),A},Hf.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,h=1,m=0,x=0,w=0,k=1/0,A=-1/0,N=1/0,z=-1/0;c.pos<a;){if(m<=0){var V=c.readVarint();h=7&V,m=V>>3}if(m--,h===1||h===2)(x+=c.readSVarint())<k&&(k=x),x>A&&(A=x),(w+=c.readSVarint())<N&&(N=w),w>z&&(z=w);else if(h!==7)throw new Error("unknown command "+h)}return[k,N,A,z]},Hf.prototype.toGeoJSON=function(c,a,h){var m,x,w=this.extent*Math.pow(2,h),k=this.extent*c,A=this.extent*a,N=this.loadGeometry(),z=Hf.types[this.type];function V(ae){for(var he=0;he<ae.length;he++){var Te=ae[he];ae[he]=[360*(Te.x+k)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(Te.y+A)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var X=[];for(m=0;m<N.length;m++)X[m]=N[m][0];V(N=X);break;case 2:for(m=0;m<N.length;m++)V(N[m]);break;case 3:for(N=function(ae){var he=ae.length;if(he<=1)return[ae];for(var Te,Oe,Ze=[],yt=0;yt<he;yt++){var Ke=ux(ae[yt]);Ke!==0&&(Oe===void 0&&(Oe=Ke<0),Oe===Ke<0?(Te&&Ze.push(Te),Te=[ae[yt]]):Te.push(ae[yt]))}return Te&&Ze.push(Te),Ze}(N),m=0;m<N.length;m++)for(x=0;x<N[m].length;x++)V(N[m][x])}N.length===1?N=N[0]:z="Multi"+z;var ee={type:"Feature",geometry:{type:z,coordinates:N},properties:this.properties};return"id"in this&&(ee.id=this.id),ee};var _a=Y3,va=e1;function e1(c,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(u4,this,a),this.length=this._features.length}function u4(c,a,h){c===15?a.version=h.readVarint():c===1?a.name=h.readString():c===5?a.extent=h.readVarint():c===2?a._features.push(h.pos):c===3?a._keys.push(h.readString()):c===4&&a._values.push(function(m){for(var x=null,w=m.readVarint()+m.pos;m.pos<w;){var k=m.readVarint()>>3;x=k===1?m.readString():k===2?m.readFloat():k===3?m.readDouble():k===4?m.readVarint64():k===5?m.readVarint():k===6?m.readSVarint():k===7?m.readBoolean():null}return x}(h))}e1.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var a=this._pbf.readVarint()+this._pbf.pos;return new _a(this._pbf,a,this.extent,this._keys,this._values)};var c4=va;function cx(c,a,h){if(c===3){var m=new c4(h,h.readVarint()+h.pos);m.length&&(a[m.name]=m)}}var t1=Q_.VectorTile=function(c,a){this.layers=c.readFields(cx,{},a)},n1=Q_.VectorTileFeature=Y3;function r1(c,a,h,m){const x=[],w=m===0?(k,A,N,z,V,X)=>{k.push(new We(X,N+(X-A)/(z-A)*(V-N)))}:(k,A,N,z,V,X)=>{k.push(new We(A+(X-N)/(V-N)*(z-A),X))};for(const k of c){const A=[];for(const N of k){if(N.length<=2)continue;const z=[];for(let ee=0;ee<N.length-1;ee++){const ae=N[ee].x,he=N[ee].y,Te=N[ee+1].x,Oe=N[ee+1].y,Ze=m===0?ae:he,yt=m===0?Te:Oe;Ze<a?yt>a&&w(z,ae,he,Te,Oe,a):Ze>h?yt<h&&w(z,ae,he,Te,Oe,h):z.push(N[ee]),yt<a&&Ze>=a&&w(z,ae,he,Te,Oe,a),yt>h&&Ze<=h&&w(z,ae,he,Te,Oe,h)}let V=N[N.length-1];const X=m===0?V.x:V.y;X>=a&&X<=h&&z.push(V),z.length&&(V=z[z.length-1],z[0].x===V.x&&z[0].y===V.y||z.push(z[0]),A.push(z))}A.length&&x.push(A)}return x}Q_.VectorTileLayer=va;const YM=n1.types,KM=Math.pow(2,13);function M(c,a,h,m,x,w,k,A){c.emplaceBack((a<<1)+k,(h<<1)+w,(Math.floor(m*KM)<<1)+x,Math.round(A))}function i(c,a,h){c.emplaceBack(a.x,a.y,a.z,h[0]*16384,h[1]*16384,h[2]*16384)}class f{constructor(){this.acc=new We(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new We(a.x,a.y),this.max=new We(a.x,a.y))}append(a,h){this.currentPolyCount.edges++,this.acc._add(a);const m=this.min,x=this.max;a.x<m.x?m.x=a.x:a.x>x.x&&(x.x=a.x),a.y<m.y?m.y=a.y:a.y>x.y&&(x.y=a.y),((a.x===0||a.x===Yr)&&a.x===h.x)!=((a.y===0||a.y===Yr)&&a.y===h.y)&&this.processBorderOverlap(a,h),h.x<0!=a.x<0&&this.addBorderIntersection(0,Yi(h.y,a.y,(0-h.x)/(a.x-h.x))),h.x>Yr!=a.x>Yr&&this.addBorderIntersection(1,Yi(h.y,a.y,(Yr-h.x)/(a.x-h.x))),h.y<0!=a.y<0&&this.addBorderIntersection(2,Yi(h.x,a.x,(0-h.y)/(a.y-h.y))),h.y>Yr!=a.y>Yr&&this.addBorderIntersection(3,Yi(h.x,a.x,(Yr-h.y)/(a.y-h.y)))}addBorderIntersection(a,h){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const m=this.borders[a];h<m[0]&&(m[0]=h),h>m[1]&&(m[1]=h)}processBorderOverlap(a,h){if(a.x===h.x){if(a.y===h.y)return;const m=a.x===0?0:1;this.addBorderIntersection(m,h.y),this.addBorderIntersection(m,a.y)}else{const m=a.y===0?2:3;this.addBorderIntersection(m,h.x),this.addBorderIntersection(m,a.x)}}centroid(){const a=this.polyCount.reduce((h,m)=>h+m.edges,0);return a!==0?this.acc.div(a)._round():new We(0,0)}span(){return new We(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,h)=>a+ +(h[0]!==Number.MAX_VALUE),0)}}class y{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new wn,this.centroidVertexArray=new Gl,this.indexArray=new Hr,this.programConfigurations=new qp(a.layers,a.zoom),this.segments=new Co,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id),this.enableTerrain=a.enableTerrain}populate(a,h,m,x){this.features=[],this.hasPattern=ox("fill-extrusion",this.layers,h),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(w){const k=Math.exp(Math.PI*(1-w.y/(1<<w.z)*2));return 80150034*k/(k*k+1)/Yr/(1<<w.z)}(m),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:w,id:k,index:A,sourceLayerIndex:N}of a){const z=this.layers[0]._featureFilter.needGeometry,V=Kp(w,z);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),V,m))continue;const X={id:k,sourceLayerIndex:N,index:A,geometry:z?V.geometry:Dh(w,m,x),properties:w.properties,type:w.type,patterns:{}},ee=this.layoutVertexArray.length;this.hasPattern?this.features.push(ax("fill-extrusion",this.layers,X,this.zoom,h)):this.addFeature(X,X.geometry,A,m,{},h.availableImages,x),h.featureIndex.insert(w,X.geometry,A,N,this.index,ee)}this.sortBorders()}addFeatures(a,h,m,x,w){for(const k of this.features){const{geometry:A}=k;this.addFeature(k,A,k.index,h,m,x,w)}this.sortBorders()}update(a,h,m,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,o4),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,ZM.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,s4.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,m,x,w,k,A){const N=[new We(0,0),new We(Yr,Yr)],z=A.projection,V=z.name==="globe",X=this.enableTerrain&&!V?new f:null,ee=YM[a.type]==="Polygon";V&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Tn);const ae=G0(h,500);for(let Ze=ae.length-1;Ze>=0;Ze--){const yt=ae[Ze];(yt.length===0||(he=yt[0]).every(Ke=>Ke.x<=0)||he.every(Ke=>Ke.x>=Yr)||he.every(Ke=>Ke.y<=0)||he.every(Ke=>Ke.y>=Yr))&&ae.splice(Ze,1)}var he;let Te;if(V)Te=W(ae,N,x);else{Te=[];for(const Ze of ae)Te.push({polygon:Ze,bounds:N})}const Oe=ee?this.edgeRadius:0;for(const{polygon:Ze,bounds:yt}of Te){let Ke=0,pt=0;for(const wt of Ze)ee&&!wt[0].equals(wt[wt.length-1])&&wt.push(wt[0]),pt+=ee?wt.length-1:wt.length;const Et=this.segments.prepareSegment((ee?5:4)*pt,this.layoutVertexArray,this.indexArray);if(ee){const wt=[],Kt=[];Ke=Et.vertexLength;for(const bn of Ze){let Jn,on;bn.length&&bn!==Ze[0]&&Kt.push(wt.length/2),Jn=bn[1].sub(bn[0])._perp()._unit();for(let An=1;An<bn.length;An++){const Ln=bn[An],$n=bn[An===bn.length-1?1:An+1];let{x:tr,y:_n}=Ln;if(Oe){on=$n.sub(Ln)._perp()._unit();const _r=Jn.add(on)._unit(),Rr=Oe*Math.min(4,1/(Jn.x*_r.x+Jn.y*_r.y));tr+=Rr*_r.x,_n+=Rr*_r.y,Jn=on}M(this.layoutVertexArray,tr,_n,0,0,1,1,0),Et.vertexLength++,wt.push(Ln.x,Ln.y),V&&i(this.layoutVertexExtArray,z.projectTilePoint(tr,_n,x),z.upVector(x,tr,_n))}}const Xt=sx(wt,Kt);for(let bn=0;bn<Xt.length;bn+=3)this.indexArray.emplaceBack(Ke+Xt[bn],Ke+Xt[bn+2],Ke+Xt[bn+1]),Et.primitiveLength++}for(const wt of Ze){X&&wt.length&&X.startRing(wt[0]);let Kt,Xt,bn,Jn=wt.length>4&&D(wt[wt.length-2],wt[0],wt[1]),on=Oe?S(wt[wt.length-2],wt[0],wt[1],Oe):0;Xt=wt[1].sub(wt[0])._perp()._unit();let An=!0;for(let Ln=1,$n=0;Ln<wt.length;Ln++){let tr=wt[Ln-1],_n=wt[Ln];const _r=wt[Ln===wt.length-1?1:Ln+1];if(X&&ee&&X.currentPolyCount.top++,R(_n,tr,yt)){Oe&&(Xt=_r.sub(_n)._perp()._unit(),An=!An);continue}X&&X.append(_n,tr);const Rr=_n.sub(tr)._perp(),xr=Rr.x/(Math.abs(Rr.x)+Math.abs(Rr.y)),Pi=Rr.y>0?1:0,nr=tr.dist(_n);if($n+nr>32768&&($n=0),Oe){bn=_r.sub(_n)._perp()._unit();let Ni=I(tr,_n,_r,_(Xt,bn),Oe);isNaN(Ni)&&(Ni=0);const ai=_n.sub(tr)._unit();tr=tr.add(ai.mult(on))._round(),_n=_n.add(ai.mult(-Ni))._round(),on=Ni,Xt=bn}const Qr=Et.vertexLength,Ri=wt.length>4&&D(tr,_n,_r);let Es=F($n,Jn,An);if(M(this.layoutVertexArray,tr.x,tr.y,xr,Pi,0,0,Es),M(this.layoutVertexArray,tr.x,tr.y,xr,Pi,0,1,Es),$n+=nr,Es=F($n,Ri,!An),Jn=Ri,M(this.layoutVertexArray,_n.x,_n.y,xr,Pi,0,0,Es),M(this.layoutVertexArray,_n.x,_n.y,xr,Pi,0,1,Es),Et.vertexLength+=4,this.indexArray.emplaceBack(Qr+0,Qr+1,Qr+2),this.indexArray.emplaceBack(Qr+1,Qr+3,Qr+2),Et.primitiveLength+=2,Oe){const Ni=Ke+(Ln===1?wt.length-2:Ln-2),ai=Ln===1?Ke:Ni+1;if(this.indexArray.emplaceBack(Qr+1,Ni,Qr+3),this.indexArray.emplaceBack(Ni,ai,Qr+3),Et.primitiveLength+=2,Kt===void 0&&(Kt=Qr),!R(_r,wt[Ln],yt)){const fo=Ln===wt.length-1?Kt:Et.vertexLength;this.indexArray.emplaceBack(Qr+2,Qr+3,fo),this.indexArray.emplaceBack(Qr+3,fo+1,fo),this.indexArray.emplaceBack(Qr+3,ai,fo+1),Et.primitiveLength+=3}An=!An}if(V){const Ni=this.layoutVertexExtArray,ai=z.projectTilePoint(tr.x,tr.y,x),fo=z.projectTilePoint(_n.x,_n.y,x),zi=z.upVector(x,tr.x,tr.y),Bi=z.upVector(x,_n.x,_n.y);i(Ni,ai,zi),i(Ni,ai,zi),i(Ni,fo,Bi),i(Ni,fo,Bi)}}ee&&(Ke+=wt.length-1)}}if(X&&X.polyCount.length>0){if(X.borders){X.vertexArrayOffset=this.centroidVertexArray.length;const Ze=X.borders,yt=this.featuresOnBorder.push(X)-1;for(let Ke=0;Ke<4;Ke++)Ze[Ke][0]!==Number.MAX_VALUE&&this.borders[Ke].push(yt)}this.encodeCentroid(X.borders?void 0:X.centroid(),X)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,w,k,x)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((h,m)=>this.featuresOnBorder[h].borders[a][0]-this.featuresOnBorder[m].borders[a][0])}encodeCentroid(a,h,m=!0){let x,w;if(a)if(a.y!==0){const A=h.span()._mult(this.tileToMeter);x=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(A.x/10)),w=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(A.y/10))}else x=Math.ceil(7*(a.x+450)),w=0;else x=0,w=+m;let k=m?this.centroidVertexArray.length:h.vertexArrayOffset;for(const A of h.polyCount){m&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*A.edges+A.top);for(let N=0;N<A.top;N++)this.centroidVertexArray.emplace(k++,x,w);for(let N=0;N<2*A.edges;N++)this.centroidVertexArray.emplace(k++,0,w),this.centroidVertexArray.emplace(k++,x,w)}}}function _(c,a){const h=c.add(a)._unit();return c.x*h.x+c.y*h.y}function S(c,a,h,m){const x=a.sub(c)._perp()._unit(),w=h.sub(a)._perp()._unit();return I(c,a,h,_(x,w),m)}function I(c,a,h,m,x){const w=Math.sqrt(1-m*m);return Math.min(c.dist(a)/3,a.dist(h)/3,x*w/m)}function R(c,a,h){return c.x<h[0].x&&a.x<h[0].x||c.x>h[1].x&&a.x>h[1].x||c.y<h[0].y&&a.y<h[0].y||c.y>h[1].y&&a.y>h[1].y}function D(c,a,h){if(c.x<0||c.x>=Yr||a.x<0||a.x>=Yr||h.x<0||h.x>=Yr)return!1;const m=h.sub(a),x=m.perp(),w=c.sub(a);return(m.x*w.x+m.y*w.y)/Math.sqrt((m.x*m.x+m.y*m.y)*(w.x*w.x+w.y*w.y))>-.866&&x.x*w.x+x.y*w.y<0}function F(c,a,h){const m=a?2|c:-3&c;return h?1|m:-2&m}function G(){const c=Math.PI/32,a=Math.tan(c),h=Uf;return h*Math.sqrt(1+2*a*a)-h}function W(c,a,h){const m=1<<h.z,x=Su(h.x/m),w=Su((h.x+1)/m),k=sl(h.y/m),A=sl((h.y+1)/m);return function(N,z,V,X,ee=0,ae){const he=[];if(!N.length||!V||!X)return he;const Te=(wt,Kt)=>{for(const Xt of wt)he.push({polygon:Xt,bounds:Kt})},Oe=Math.ceil(Math.log2(V)),Ze=Math.ceil(Math.log2(X)),yt=Oe-Ze,Ke=[];for(let wt=0;wt<Math.abs(yt);wt++)Ke.push(yt>0?0:1);for(let wt=0;wt<Math.min(Oe,Ze);wt++)Ke.push(0),Ke.push(1);let pt=N;if(pt=r1(pt,z[0].y-ee,z[1].y+ee,1),pt=r1(pt,z[0].x-ee,z[1].x+ee,0),!pt.length)return he;const Et=[];for(Ke.length?Et.push({polygons:pt,bounds:z,depth:0}):Te(pt,z);Et.length;){const wt=Et.pop(),Kt=wt.depth,Xt=Ke[Kt],bn=wt.bounds[0],Jn=wt.bounds[1],on=Xt===0?bn.x:bn.y,An=Xt===0?Jn.x:Jn.y,Ln=ae?ae(Xt,on,An):.5*(on+An),$n=r1(wt.polygons,on-ee,Ln+ee,Xt),tr=r1(wt.polygons,Ln-ee,An+ee,Xt);if($n.length){const _n=[bn,new We(Xt===0?Ln:Jn.x,Xt===1?Ln:Jn.y)];Ke.length>Kt+1?Et.push({polygons:$n,bounds:_n,depth:Kt+1}):Te($n,_n)}if(tr.length){const _n=[new We(Xt===0?Ln:bn.x,Xt===1?Ln:bn.y),Jn];Ke.length>Kt+1?Et.push({polygons:tr,bounds:_n,depth:Kt+1}):Te(tr,_n)}}return he}(c,a,Math.ceil((w-x)/11.25),Math.ceil((k-A)/11.25),1,(N,z,V)=>{if(N===0)return .5*(z+V);{const X=sl((h.y+z/Yr)/m);return(Pd(.5*(sl((h.y+V/Yr)/m)+X))*m-h.y)*Yr}})}Ir(y,"FillExtrusionBucket",{omit:["layers","features"]}),Ir(f,"PartMetadata");const Z=new lt({"fill-extrusion-edge-radius":new Ee(Nt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var K={paint:new lt({"fill-extrusion-opacity":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ue(Nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ue(Nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ue(Nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ue(Nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Z};function oe(c,a,h){var m=2*Math.PI*6378137/256/Math.pow(2,h);return[c*m-2*Math.PI*6378137/2,a*m-2*Math.PI*6378137/2]}class de{constructor(a,h,m){this.z=a,this.x=h,this.y=m,this.key=Ve(0,a,a,h,m)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h){const m=function(w,k,A){var N=oe(256*w,256*(k=Math.pow(2,A)-k-1),A),z=oe(256*(w+1),256*(k+1),A);return N[0]+","+N[1]+","+z[0]+","+z[1]}(this.x,this.y,this.z),x=function(w,k,A){let N,z="";for(let V=w;V>0;V--)N=1<<V-1,z+=(k&N?1:0)+(A&N?2:0);return z}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",x).replace("{bbox-epsg-3857}",m)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ke{constructor(a,h){this.wrap=a,this.canonical=h,this.key=Ve(a,h.z,h.z,h.x,h.y)}}class pe{constructor(a,h,m,x,w){this.overscaledZ=a,this.wrap=h,this.canonical=new de(m,+x,+w),this.key=h===0&&a===m?this.canonical.key:Ve(h,a,m,x,w)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const h=this.canonical.z-a;return a>this.canonical.z?new pe(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pe(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h=!0){if(this.overscaledZ===a&&h)return this.key;if(a>this.canonical.z)return Ve(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y);{const m=this.canonical.z-a;return Ve(this.wrap*+h,a,a,this.canonical.x>>m,this.canonical.y>>m)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new pe(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,m=2*this.canonical.x,x=2*this.canonical.y;return[new pe(h,this.wrap,h,m,x),new pe(h,this.wrap,h,m+1,x),new pe(h,this.wrap,h,m,x+1),new pe(h,this.wrap,h,m+1,x+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new pe(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new pe(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ke(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ve(c,a,h,m,x){const w=1<<Math.min(h,22);let k=w*(x%w)+m%w;return c&&h<22&&(k+=w*w*((c<0?-2*c-1:2*c)%(1<<2*(22-h)))),16*(32*k+h)+(a-h)}Ir(de,"CanonicalTileID"),Ir(pe,"OverscaledTileID",{omit:["projMatrix"]});class Ye extends We{constructor(a,h,m){super(a,h),this.z=m}}function $e(c,a){return c.x*a.x+c.y*a.y}function _t(c,a){if(c.length===1){let h=0;const m=a[h++];let x;for(;!x||m.equals(x);)if(x=a[h++],!x)return 1/0;for(;h<a.length;h++){const w=a[h],k=c[0],A=x.sub(m),N=w.sub(m),z=k.sub(m),V=$e(A,A),X=$e(A,N),ee=$e(N,N),ae=$e(z,A),he=$e(z,N),Te=V*ee-X*X,Oe=(ee*ae-X*he)/Te,Ze=(V*he-X*ae)/Te,yt=m.z*(1-Oe-Ze)+x.z*Oe+w.z*Ze;if(isFinite(yt))return yt}return 1/0}{let h=1/0;for(const m of a)h=Math.min(h,m.z);return h}}function bt(c,a,h,m,x,w,k,A){const N=k*x.getElevationAt(c,a,!0,!0),z=w[0]!==0,V=z?w[1]===0?k*(w[0]/7-450):k*function(X,ee,ae){const he=Math.floor(ee[0]/8),Te=Math.floor(ee[1]/8),Oe=10*(ee[0]-8*he),Ze=10*(ee[1]-8*Te),yt=X.getElevationAt(he,Te,!0,!0),Ke=X.getMeterToDEM(ae),pt=Math.floor(.5*(Oe*Ke-1)),Et=Math.floor(.5*(Ze*Ke-1)),wt=X.tileCoordToPixel(he,Te),Kt=2*pt+1,Xt=2*Et+1,bn=function(tr,_n,_r,Rr,xr){return[tr.getElevationAtPixel(_n,_r,!0),tr.getElevationAtPixel(_n+xr,_r,!0),tr.getElevationAtPixel(_n,_r+xr,!0),tr.getElevationAtPixel(_n+Rr,_r+xr,!0)]}(X,wt.x-pt,wt.y-Et,Kt,Xt),Jn=Math.abs(bn[0]-bn[1]),on=Math.abs(bn[2]-bn[3]),An=Math.abs(bn[0]-bn[2])+Math.abs(bn[1]-bn[3]),Ln=Math.min(.25,.5*Ke*(Jn+on)/Kt),$n=Math.min(.25,.5*Ke*An/Xt);return yt+Math.max(Ln*Oe,$n*Ze)}(x,w,A):N;return{base:N+(h===0)?-1:h,top:z?Math.max(V+m,N+h+2):N+m}}const Vt=Bt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:qt}=Vt,mn=Bt([{name:"a_packed",components:4,type:"Float32"}]),{members:sn}=mn,dn=n1.types,wr=Math.cos(Math.PI/180*37.5);class er{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Qt,this.layoutVertexArray2=new Gn,this.indexArray=new Hr,this.programConfigurations=new qp(a.layers,a.zoom),this.segments=new Co,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,m,x){this.hasPattern=ox("line",this.layers,h);const w=this.layers[0].layout.get("line-sort-key"),k=[];for(const{feature:V,id:X,index:ee,sourceLayerIndex:ae}of a){const he=this.layers[0]._featureFilter.needGeometry,Te=Kp(V,he);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),Te,m))continue;const Oe=w?w.evaluate(Te,{},m):void 0,Ze={id:X,properties:V.properties,type:V.type,sourceLayerIndex:ae,index:ee,geometry:he?Te.geometry:Dh(V,m,x),patterns:{},sortKey:Oe};k.push(Ze)}w&&k.sort((V,X)=>V.sortKey-X.sortKey);const{lineAtlas:A,featureIndex:N}=h,z=this.addConstantDashes(A);for(const V of k){const{geometry:X,index:ee,sourceLayerIndex:ae}=V;if(z&&this.addFeatureDashes(V,A),this.hasPattern){const he=ax("line",this.layers,V,this.zoom,h);this.patternFeatures.push(he)}else this.addFeature(V,X,ee,m,A.positions,h.availableImages);N.insert(a[ee].feature,X,ee,ae,this.index)}}addConstantDashes(a){let h=!1;for(const m of this.layers){const x=m.paint.get("line-dasharray").value,w=m.layout.get("line-cap").value;if(x.kind!=="constant"||w.kind!=="constant")h=!0;else{const k=w.value,A=x.value;if(!A)continue;a.addDash(A,k)}}return h}addFeatureDashes(a,h){const m=this.zoom;for(const x of this.layers){const w=x.paint.get("line-dasharray").value,k=x.layout.get("line-cap").value;if(w.kind==="constant"&&k.kind==="constant")continue;let A,N;if(w.kind==="constant"){if(A=w.value,!A)continue}else A=w.evaluate({zoom:m},a);N=k.kind==="constant"?k.value:k.evaluate({zoom:m},a),h.addDash(A,N),a.patterns[x.id]=h.getKey(A,N)}}update(a,h,m,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m,x)}addFeatures(a,h,m,x,w){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,h,m,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,sn)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,qt),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,m,x,w,k){const A=this.layers[0].layout,N=A.get("line-join").evaluate(a,{}),z=A.get("line-cap").evaluate(a,{}),V=A.get("line-miter-limit"),X=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const ee of h)this.addLine(ee,a,N,z,V,X);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,w,k,x)}addLine(a,h,m,x,w,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ze=0;Ze<a.length-1;Ze++)this.totalDistance+=a[Ze].dist(a[Ze+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=dn[h.type]==="Polygon";let N=a.length;for(;N>=2&&a[N-1].equals(a[N-2]);)N--;let z=0;for(;z<N-1&&a[z].equals(a[z+1]);)z++;if(N<(A?3:2))return;m==="bevel"&&(w=1.05);const V=this.overscaling<=16?15*Yr/(512*this.overscaling):0,X=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let ee,ae,he,Te,Oe;this.e1=this.e2=-1,A&&(ee=a[N-2],Oe=a[z].sub(ee)._unit()._perp());for(let Ze=z;Ze<N;Ze++){if(he=Ze===N-1?A?a[z+1]:void 0:a[Ze+1],he&&a[Ze].equals(he))continue;Oe&&(Te=Oe),ee&&(ae=ee),ee=a[Ze],Oe=he?he.sub(ee)._unit()._perp():Te,Te=Te||Oe;let yt=Te.add(Oe);yt.x===0&&yt.y===0||yt._unit();const Ke=Te.x*Oe.x+Te.y*Oe.y,pt=yt.x*Oe.x+yt.y*Oe.y,Et=pt!==0?1/pt:1/0,wt=2*Math.sqrt(2-2*pt),Kt=pt<wr&&ae&&he,Xt=Te.x*Oe.y-Te.y*Oe.x>0;if(Kt&&Ze>z){const on=ee.dist(ae);if(on>2*V){const An=ee.sub(ee.sub(ae)._mult(V/on)._round());this.updateDistance(ae,An),this.addCurrentVertex(An,Te,0,0,X),ae=An}}const bn=ae&&he;let Jn=bn?m:A?"butt":x;if(bn&&Jn==="round"&&(Et<k?Jn="miter":Et<=2&&(Jn="fakeround")),Jn==="miter"&&Et>w&&(Jn="bevel"),Jn==="bevel"&&(Et>2&&(Jn="flipbevel"),Et<w&&(Jn="miter")),ae&&this.updateDistance(ae,ee),Jn==="miter")yt._mult(Et),this.addCurrentVertex(ee,yt,0,0,X);else if(Jn==="flipbevel"){if(Et>100)yt=Oe.mult(-1);else{const on=Et*Te.add(Oe).mag()/Te.sub(Oe).mag();yt._perp()._mult(on*(Xt?-1:1))}this.addCurrentVertex(ee,yt,0,0,X),this.addCurrentVertex(ee,yt.mult(-1),0,0,X)}else if(Jn==="bevel"||Jn==="fakeround"){const on=-Math.sqrt(Et*Et-1),An=Xt?on:0,Ln=Xt?0:on;if(ae&&this.addCurrentVertex(ee,Te,An,Ln,X),Jn==="fakeround"){const $n=Math.round(180*wt/Math.PI/20);for(let tr=1;tr<$n;tr++){let _n=tr/$n;if(_n!==.5){const Rr=_n-.5;_n+=_n*Rr*(_n-1)*((1.0904+Ke*(Ke*(3.55645-1.43519*Ke)-3.2452))*Rr*Rr+(.848013+Ke*(.215638*Ke-1.06021)))}const _r=Oe.sub(Te)._mult(_n)._add(Te)._unit()._mult(Xt?-1:1);this.addHalfVertex(ee,_r.x,_r.y,!1,Xt,0,X)}}he&&this.addCurrentVertex(ee,Oe,-An,-Ln,X)}else if(Jn==="butt")this.addCurrentVertex(ee,yt,0,0,X);else if(Jn==="square"){const on=ae?1:-1;ae||this.addCurrentVertex(ee,yt,on,on,X),this.addCurrentVertex(ee,yt,0,0,X),ae&&this.addCurrentVertex(ee,yt,on,on,X)}else Jn==="round"&&(ae&&(this.addCurrentVertex(ee,Te,0,0,X),this.addCurrentVertex(ee,Te,1,1,X,!0)),he&&(this.addCurrentVertex(ee,Oe,-1,-1,X,!0),this.addCurrentVertex(ee,Oe,0,0,X)));if(Kt&&Ze<N-1){const on=ee.dist(he);if(on>2*V){const An=ee.add(he.sub(ee)._mult(V/on)._round());this.updateDistance(ee,An),this.addCurrentVertex(An,Oe,0,0,X),ee=An}}}}addCurrentVertex(a,h,m,x,w,k=!1){const A=h.y*x-h.x,N=-h.y-h.x*x;this.addHalfVertex(a,h.x+h.y*m,h.y-h.x*m,k,!1,m,w),this.addHalfVertex(a,A,N,k,!0,-x,w)}addHalfVertex({x:a,y:h},m,x,w,k,A,N){this.layoutVertexArray.emplaceBack((a<<1)+(w?1:0),(h<<1)+(k?1:0),Math.round(63*m)+128,Math.round(63*x)+128,1+(A===0?0:A<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const z=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),N.primitiveLength++),k?this.e2=z:this.e1=z}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}Ir(er,"LineBucket",{omit:["layers","patternFeatures"]});const Pn=new lt({"line-cap":new Ue(Nt.layout_line["line-cap"]),"line-join":new Ue(Nt.layout_line["line-join"]),"line-miter-limit":new Ee(Nt.layout_line["line-miter-limit"]),"line-round-limit":new Ee(Nt.layout_line["line-round-limit"]),"line-sort-key":new Ue(Nt.layout_line["line-sort-key"])});var ir={paint:new lt({"line-opacity":new Ue(Nt.paint_line["line-opacity"]),"line-color":new Ue(Nt.paint_line["line-color"]),"line-translate":new Ee(Nt.paint_line["line-translate"]),"line-translate-anchor":new Ee(Nt.paint_line["line-translate-anchor"]),"line-width":new Ue(Nt.paint_line["line-width"]),"line-gap-width":new Ue(Nt.paint_line["line-gap-width"]),"line-offset":new Ue(Nt.paint_line["line-offset"]),"line-blur":new Ue(Nt.paint_line["line-blur"]),"line-dasharray":new Ue(Nt.paint_line["line-dasharray"]),"line-pattern":new Ue(Nt.paint_line["line-pattern"]),"line-gradient":new it(Nt.paint_line["line-gradient"]),"line-trim-offset":new Ee(Nt.paint_line["line-trim-offset"])}),layout:Pn};const Or=new class extends Ue{possiblyEvaluate(c,a){return a=new q(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(c,a)}evaluate(c,a,h,m){return a=ht({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(c,a,h,m)}}(ir.paint.properties["line-width"].specification);function jr(c,a){return a>0?a+2*c:c}Or.useIntegerZoom=!0;const si=Bt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gi=Bt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),yi=Bt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Bt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const sr=Bt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),xt=Bt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Bt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Pt=Bt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Fn=Bt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Bt([{name:"triangle",components:3,type:"Uint16"}]),Bt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Bt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Bt([{type:"Float32",name:"offsetX"}]),Bt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ln=24;const rn=128;function yr(c,a){const{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new q(c+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:x}=h;let w=0;for(;w<m.length&&m[w]<=c;)w++;w=Math.max(0,w-1);let k=w;for(;k<m.length&&m[k]<c+1;)k++;k=Math.min(m.length-1,k);const A=m[w],N=m[k];return h.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:N,interpolationType:x}:{kind:"camera",minZoom:A,maxZoom:N,minSize:h.evaluate(new q(A)),maxSize:h.evaluate(new q(N)),interpolationType:x}}}function dr(c,{uSize:a,uSizeT:h},{lowerSize:m,upperSize:x}){return c.kind==="source"?m/rn:c.kind==="composite"?Yi(m/rn,x/rn,h):a}function hn(c,a){let h=0,m=0;if(c.kind==="constant")m=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:x,minZoom:w,maxZoom:k}=c,A=x?Ce(nu.interpolationFactor(x,a,w,k),0,1):0;c.kind==="camera"?m=Yi(c.minSize,c.maxSize,A):h=A}return{uSizeT:h,uSize:m}}var dt=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:rn,evaluateSizeForFeature:dr,evaluateSizeForZoom:hn,getSizeData:yr});function an(c,a,h){return c.sections.forEach(m=>{m.text=function(x,w,k){const A=w.layout.get("text-transform").evaluate(k,{});return A==="uppercase"?x=x.toLocaleUpperCase():A==="lowercase"&&(x=x.toLocaleLowerCase()),U.applyArabicShaping&&(x=U.applyArabicShaping(x)),x}(m.text,a,h)}),c}const Un={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Kn(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function Hn(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var Wr=Vr,ci=function(c,a,h,m,x){var w,k,A=8*x-m-1,N=(1<<A)-1,z=N>>1,V=-7,X=h?x-1:0,ee=h?-1:1,ae=c[a+X];for(X+=ee,w=ae&(1<<-V)-1,ae>>=-V,V+=A;V>0;w=256*w+c[a+X],X+=ee,V-=8);for(k=w&(1<<-V)-1,w>>=-V,V+=m;V>0;k=256*k+c[a+X],X+=ee,V-=8);if(w===0)w=1-z;else{if(w===N)return k?NaN:1/0*(ae?-1:1);k+=Math.pow(2,m),w-=z}return(ae?-1:1)*k*Math.pow(2,w-m)},Jr=function(c,a,h,m,x,w){var k,A,N,z=8*w-x-1,V=(1<<z)-1,X=V>>1,ee=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,ae=m?0:w-1,he=m?1:-1,Te=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(A=isNaN(a)?1:0,k=V):(k=Math.floor(Math.log(a)/Math.LN2),a*(N=Math.pow(2,-k))<1&&(k--,N*=2),(a+=k+X>=1?ee/N:ee*Math.pow(2,1-X))*N>=2&&(k++,N/=2),k+X>=V?(A=0,k=V):k+X>=1?(A=(a*N-1)*Math.pow(2,x),k+=X):(A=a*Math.pow(2,X-1)*Math.pow(2,x),k=0));x>=8;c[h+ae]=255&A,ae+=he,A/=256,x-=8);for(k=k<<x|A,z+=x;z>0;c[h+ae]=255&k,ae+=he,k/=256,z-=8);c[h+ae-he]|=128*Te};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Vr(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Vr.Varint=0,Vr.Fixed64=1,Vr.Bytes=2,Vr.Fixed32=5;var Fi=4294967296,ol=1/Fi,Ks=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Lo(c){return c.type===Vr.Bytes?c.readVarint()+c.pos:c.pos+1}function Tl(c,a,h){return h?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}function em(c,a,h){var m=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));h.realloc(m);for(var x=h.pos-1;x>=c;x--)h.buf[x+m]=h.buf[x]}function Sg(c,a){for(var h=0;h<c.length;h++)a.writeVarint(c[h])}function Tg(c,a){for(var h=0;h<c.length;h++)a.writeSVarint(c[h])}function eh(c,a){for(var h=0;h<c.length;h++)a.writeFloat(c[h])}function Zu(c,a){for(var h=0;h<c.length;h++)a.writeDouble(c[h])}function hr(c,a){for(var h=0;h<c.length;h++)a.writeBoolean(c[h])}function h4(c,a){for(var h=0;h<c.length;h++)a.writeFixed32(c[h])}function d4(c,a){for(var h=0;h<c.length;h++)a.writeSFixed32(c[h])}function xc(c,a){for(var h=0;h<c.length;h++)a.writeFixed64(c[h])}function f4(c,a){for(var h=0;h<c.length;h++)a.writeSFixed64(c[h])}function i1(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+16777216*c[a+3]}function Mg(c,a,h){c[h]=a,c[h+1]=a>>>8,c[h+2]=a>>>16,c[h+3]=a>>>24}function hx(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+(c[a+3]<<24)}Vr.prototype={destroy:function(){this.buf=null},readFields:function(c,a,h){for(h=h||this.length;this.pos<h;){var m=this.readVarint(),x=m>>3,w=this.pos;this.type=7&m,c(x,a,this),this.pos===w&&this.skip(m)}return a},readMessage:function(c,a){return this.readFields(c,a,this.readVarint()+this.pos)},readFixed32:function(){var c=i1(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=hx(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=i1(this.buf,this.pos)+i1(this.buf,this.pos+4)*Fi;return this.pos+=8,c},readSFixed64:function(){var c=i1(this.buf,this.pos)+hx(this.buf,this.pos+4)*Fi;return this.pos+=8,c},readFloat:function(){var c=ci(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=ci(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var a,h,m=this.buf;return a=127&(h=m[this.pos++]),h<128?a:(a|=(127&(h=m[this.pos++]))<<7,h<128?a:(a|=(127&(h=m[this.pos++]))<<14,h<128?a:(a|=(127&(h=m[this.pos++]))<<21,h<128?a:function(x,w,k){var A,N,z=k.buf;if(A=(112&(N=z[k.pos++]))>>4,N<128||(A|=(127&(N=z[k.pos++]))<<3,N<128)||(A|=(127&(N=z[k.pos++]))<<10,N<128)||(A|=(127&(N=z[k.pos++]))<<17,N<128)||(A|=(127&(N=z[k.pos++]))<<24,N<128)||(A|=(1&(N=z[k.pos++]))<<31,N<128))return Tl(x,A,w);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(h=m[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&Ks?function(h,m,x){return Ks.decode(h.subarray(m,x))}(this.buf,a,c):function(h,m,x){for(var w="",k=m;k<x;){var A,N,z,V=h[k],X=null,ee=V>239?4:V>223?3:V>191?2:1;if(k+ee>x)break;ee===1?V<128&&(X=V):ee===2?(192&(A=h[k+1]))==128&&(X=(31&V)<<6|63&A)<=127&&(X=null):ee===3?(N=h[k+2],(192&(A=h[k+1]))==128&&(192&N)==128&&((X=(15&V)<<12|(63&A)<<6|63&N)<=2047||X>=55296&&X<=57343)&&(X=null)):ee===4&&(N=h[k+2],z=h[k+3],(192&(A=h[k+1]))==128&&(192&N)==128&&(192&z)==128&&((X=(15&V)<<18|(63&A)<<12|(63&N)<<6|63&z)<=65535||X>=1114112)&&(X=null)),X===null?(X=65533,ee=1):X>65535&&(X-=65536,w+=String.fromCharCode(X>>>10&1023|55296),X=56320|1023&X),w+=String.fromCharCode(X),k+=ee}return w}(this.buf,a,c)},readBytes:function(){var c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a},readPackedVarint:function(c,a){if(this.type!==Vr.Bytes)return c.push(this.readVarint(a));var h=Lo(this);for(c=c||[];this.pos<h;)c.push(this.readVarint(a));return c},readPackedSVarint:function(c){if(this.type!==Vr.Bytes)return c.push(this.readSVarint());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Vr.Bytes)return c.push(this.readBoolean());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Vr.Bytes)return c.push(this.readFloat());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Vr.Bytes)return c.push(this.readDouble());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Vr.Bytes)return c.push(this.readFixed32());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Vr.Bytes)return c.push(this.readSFixed32());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Vr.Bytes)return c.push(this.readFixed64());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Vr.Bytes)return c.push(this.readSFixed64());var a=Lo(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed64());return c},skip:function(c){var a=7&c;if(a===Vr.Varint)for(;this.buf[this.pos++]>127;);else if(a===Vr.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Vr.Fixed32)this.pos+=4;else{if(a!==Vr.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(c,a){this.writeVarint(c<<3|a)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),Mg(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),Mg(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),Mg(this.buf,-1&c,this.pos),Mg(this.buf,Math.floor(c*ol),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),Mg(this.buf,-1&c,this.pos),Mg(this.buf,Math.floor(c*ol),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(a,h){var m,x;if(a>=0?(m=a%4294967296|0,x=a/4294967296|0):(x=~(-a/4294967296),4294967295^(m=~(-a%4294967296))?m=m+1|0:(m=0,x=x+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(w,k,A){A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,w>>>=7,A.buf[A.pos++]=127&w|128,A.buf[A.pos]=127&(w>>>=7)}(m,0,h),function(w,k){var A=(7&w)<<4;k.buf[k.pos++]|=A|((w>>>=3)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w|((w>>>=7)?128:0),w&&(k.buf[k.pos++]=127&w)))))}(x,h)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var a=this.pos;this.pos=function(m,x,w){for(var k,A,N=0;N<x.length;N++){if((k=x.charCodeAt(N))>55295&&k<57344){if(!A){k>56319||N+1===x.length?(m[w++]=239,m[w++]=191,m[w++]=189):A=k;continue}if(k<56320){m[w++]=239,m[w++]=191,m[w++]=189,A=k;continue}k=A-55296<<10|k-56320|65536,A=null}else A&&(m[w++]=239,m[w++]=191,m[w++]=189,A=null);k<128?m[w++]=k:(k<2048?m[w++]=k>>6|192:(k<65536?m[w++]=k>>12|224:(m[w++]=k>>18|240,m[w++]=k>>12&63|128),m[w++]=k>>6&63|128),m[w++]=63&k|128)}return w}(this.buf,c,this.pos);var h=this.pos-a;h>=128&&em(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeFloat:function(c){this.realloc(4),Jr(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),Jr(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var h=0;h<a;h++)this.buf[this.pos++]=c[h]},writeRawMessage:function(c,a){this.pos++;var h=this.pos;c(a,this);var m=this.pos-h;m>=128&&em(h,m,this),this.pos=h-1,this.writeVarint(m),this.pos+=m},writeMessage:function(c,a,h){this.writeTag(c,Vr.Bytes),this.writeRawMessage(a,h)},writePackedVarint:function(c,a){a.length&&this.writeMessage(c,Sg,a)},writePackedSVarint:function(c,a){a.length&&this.writeMessage(c,Tg,a)},writePackedBoolean:function(c,a){a.length&&this.writeMessage(c,hr,a)},writePackedFloat:function(c,a){a.length&&this.writeMessage(c,eh,a)},writePackedDouble:function(c,a){a.length&&this.writeMessage(c,Zu,a)},writePackedFixed32:function(c,a){a.length&&this.writeMessage(c,h4,a)},writePackedSFixed32:function(c,a){a.length&&this.writeMessage(c,d4,a)},writePackedFixed64:function(c,a){a.length&&this.writeMessage(c,xc,a)},writePackedSFixed64:function(c,a){a.length&&this.writeMessage(c,f4,a)},writeBytesField:function(c,a){this.writeTag(c,Vr.Bytes),this.writeBytes(a)},writeFixed32Field:function(c,a){this.writeTag(c,Vr.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(c,a){this.writeTag(c,Vr.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(c,a){this.writeTag(c,Vr.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(c,a){this.writeTag(c,Vr.Fixed64),this.writeSFixed64(a)},writeVarintField:function(c,a){this.writeTag(c,Vr.Varint),this.writeVarint(a)},writeSVarintField:function(c,a){this.writeTag(c,Vr.Varint),this.writeSVarint(a)},writeStringField:function(c,a){this.writeTag(c,Vr.Bytes),this.writeString(a)},writeFloatField:function(c,a){this.writeTag(c,Vr.Fixed32),this.writeFloat(a)},writeDoubleField:function(c,a){this.writeTag(c,Vr.Fixed64),this.writeDouble(a)},writeBooleanField:function(c,a){this.writeVarintField(c,!!a)}};var s1=ce(Wr);const dx=3;function kg(c,a,h){a.glyphs=[],c===1&&h.readMessage(p4,a)}function p4(c,a,h){if(c===3){const{id:m,bitmap:x,width:w,height:k,left:A,top:N,advance:z}=h.readMessage(m4,{});a.glyphs.push({id:m,bitmap:new Dd({width:w+2*dx,height:k+2*dx},x),metrics:{width:w,height:k,left:A,top:N,advance:z}})}else c===4?a.ascender=h.readSVarint():c===5&&(a.descender=h.readSVarint())}function m4(c,a,h){c===1?a.id=h.readVarint():c===2?a.bitmap=h.readBytes():c===3?a.width=h.readVarint():c===4?a.height=h.readVarint():c===5?a.left=h.readSVarint():c===6?a.top=h.readSVarint():c===7&&(a.advance=h.readVarint())}const o1=dx;function K3(c){let a=0,h=0;for(const k of c)a+=k.w*k.h,h=Math.max(h,k.w);c.sort((k,A)=>A.h-k.h);const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}];let x=0,w=0;for(const k of c)for(let A=m.length-1;A>=0;A--){const N=m[A];if(!(k.w>N.w||k.h>N.h)){if(k.x=N.x,k.y=N.y,w=Math.max(w,k.y+k.h),x=Math.max(x,k.x+k.w),k.w===N.w&&k.h===N.h){const z=m.pop();A<m.length&&(m[A]=z)}else k.h===N.h?(N.x+=k.w,N.w-=k.w):k.w===N.w?(N.y+=k.h,N.h-=k.h):(m.push({x:N.x+k.w,y:N.y,w:N.w-k.w,h:k.h}),N.y+=k.h,N.h-=k.h);break}}return{w:x,h:w,fill:a/(x*w)||0}}const ql=1;class fx{constructor(a,{pixelRatio:h,version:m,stretchX:x,stretchY:w,content:k}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=x,this.stretchY=w,this.content=k,this.version=m}get tl(){return[this.paddedRect.x+ql,this.paddedRect.y+ql]}get br(){return[this.paddedRect.x+this.paddedRect.w-ql,this.paddedRect.y+this.paddedRect.h-ql]}get displaySize(){return[(this.paddedRect.w-2*ql)/this.pixelRatio,(this.paddedRect.h-2*ql)/this.pixelRatio]}}class J3{constructor(a,h){const m={},x={};this.haveRenderCallbacks=[];const w=[];this.addImages(a,m,w),this.addImages(h,x,w);const{w:k,h:A}=K3(w),N=new Tu({width:k||1,height:A||1});for(const z in a){const V=a[z],X=m[z].paddedRect;Tu.copy(V.data,N,{x:0,y:0},{x:X.x+ql,y:X.y+ql},V.data)}for(const z in h){const V=h[z],X=x[z].paddedRect,ee=X.x+ql,ae=X.y+ql,he=V.data.width,Te=V.data.height;Tu.copy(V.data,N,{x:0,y:0},{x:ee,y:ae},V.data),Tu.copy(V.data,N,{x:0,y:Te-1},{x:ee,y:ae-1},{width:he,height:1}),Tu.copy(V.data,N,{x:0,y:0},{x:ee,y:ae+Te},{width:he,height:1}),Tu.copy(V.data,N,{x:he-1,y:0},{x:ee-1,y:ae},{width:1,height:Te}),Tu.copy(V.data,N,{x:0,y:0},{x:ee+he,y:ae},{width:1,height:Te})}this.image=N,this.iconPositions=m,this.patternPositions=x}addImages(a,h,m){for(const x in a){const w=a[x],k={x:0,y:0,w:w.data.width+2*ql,h:w.data.height+2*ql};m.push(k),h[x]=new fx(k,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(a,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>a.hasImage(m)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in a.updatedImages)this.patchUpdatedImage(this.iconPositions[m],a.getImage(m),h),this.patchUpdatedImage(this.patternPositions[m],a.getImage(m),h)}patchUpdatedImage(a,h,m){if(!a||!h||a.version===h.version)return;a.version=h.version;const[x,w]=a.tl;m.update(h.data,void 0,{x,y:w})}}Ir(fx,"ImagePosition"),Ir(J3,"ImageAtlas");const ft={horizontal:1,vertical:2,horizontalOnly:3},Rn=-17;class nn{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,h){const m=new nn;return m.scale=a||1,m.fontStack=h,m}static forImage(a){const h=new nn;return h.imageName=a,h}}class Cn{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){const m=new Cn;for(let x=0;x<a.sections.length;x++){const w=a.sections[x];w.image?m.addImageSection(w):m.addTextSection(w,h)}return m}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(h,m){let x="";for(let w=0;w<h.length;w++){const k=h.charCodeAt(w+1)||null,A=h.charCodeAt(w-1)||null;x+=!m&&(k&&w_(k)&&!Un[h[w+1]]||A&&w_(A)&&!Un[h[w-1]])||!Un[h[w]]?h[w]:Un[h[w]]}return x}(this.text,a)}trim(){let a=0;for(let m=0;m<this.text.length&&Ii[this.text.charCodeAt(m)];m++)a++;let h=this.text.length;for(let m=this.text.length-1;m>=0&&m>=a&&Ii[this.text.charCodeAt(m)];m--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){const m=new Cn;return m.text=this.text.substring(a,h),m.sectionIndex=this.sectionIndex.slice(a,h),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}addTextSection(a,h){this.text+=a.text,this.sections.push(nn.forText(a.scale,a.fontStack||h));const m=this.sections.length-1;for(let x=0;x<a.text.length;++x)this.sectionIndex.push(m)}addImageSection(a){const h=a.image?a.image.name:"";if(h.length===0)return void Be("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(nn.forImage(h)),this.sectionIndex.push(this.sections.length-1)):Be("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ar(c,a,h,m,x,w,k,A,N,z,V,X,ee,ae,he){const Te=Cn.fromFeature(c,x);X===ft.vertical&&Te.verticalizePunctuation(ee);let Oe=[];const Ze=function(wt,Kt,Xt,bn,Jn,on){if(!wt)return[];const An=[],Ln=function(_r,Rr,xr,Pi,nr,Qr){let Ri=0;for(let Es=0;Es<_r.length();Es++){const Ni=_r.getSection(Es);Ri+=Wi(_r.getCharCode(Es),Ni,Pi,nr,Rr,Qr)}return Ri/Math.max(1,Math.ceil(Ri/xr))}(wt,Kt,Xt,bn,Jn,on),$n=wt.text.indexOf("")>=0;let tr=0;for(let _r=0;_r<wt.length();_r++){const Rr=wt.getSection(_r),xr=wt.getCharCode(_r);if(Ii[xr]||(tr+=Wi(xr,Rr,bn,Jn,Kt,on)),_r<wt.length()-1){const Pi=!((_n=xr)<11904||!(gr["Bopomofo Extended"](_n)||gr.Bopomofo(_n)||gr["CJK Compatibility Forms"](_n)||gr["CJK Compatibility Ideographs"](_n)||gr["CJK Compatibility"](_n)||gr["CJK Radicals Supplement"](_n)||gr["CJK Strokes"](_n)||gr["CJK Symbols and Punctuation"](_n)||gr["CJK Unified Ideographs Extension A"](_n)||gr["CJK Unified Ideographs"](_n)||gr["Enclosed CJK Letters and Months"](_n)||gr["Halfwidth and Fullwidth Forms"](_n)||gr.Hiragana(_n)||gr["Ideographic Description Characters"](_n)||gr["Kangxi Radicals"](_n)||gr["Katakana Phonetic Extensions"](_n)||gr.Katakana(_n)||gr["Vertical Forms"](_n)||gr["Yi Radicals"](_n)||gr["Yi Syllables"](_n)));(hi[xr]||Pi||Rr.imageName)&&An.push(Rs(_r+1,tr,Ln,An,ho(xr,wt.getCharCode(_r+1),Pi&&$n),!1))}}var _n;return as(Rs(wt.length(),tr,Ln,An,0,!0))}(Te,z,w,a,m,ae),{processBidirectionalText:yt,processStyledBidirectionalText:Ke}=U;if(yt&&Te.sections.length===1){const wt=yt(Te.toString(),Ze);for(const Kt of wt){const Xt=new Cn;Xt.text=Kt,Xt.sections=Te.sections;for(let bn=0;bn<Kt.length;bn++)Xt.sectionIndex.push(0);Oe.push(Xt)}}else if(Ke){const wt=Ke(Te.text,Te.sectionIndex,Ze);for(const Kt of wt){const Xt=new Cn;Xt.text=Kt[0],Xt.sectionIndex=Kt[1],Xt.sections=Te.sections,Oe.push(Xt)}}else Oe=function(wt,Kt){const Xt=[],bn=wt.text;let Jn=0;for(const on of Kt)Xt.push(wt.substring(Jn,on)),Jn=on;return Jn<bn.length&&Xt.push(wt.substring(Jn,bn.length)),Xt}(Te,Ze);const pt=[],Et={positionedLines:pt,text:Te.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:X,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(wt,Kt,Xt,bn,Jn,on,An,Ln,$n,tr,_n,_r){let Rr=0,xr=0,Pi=0;const nr=Ln==="right"?1:Ln==="left"?0:.5;let Qr=!1;for(const zi of Jn){const Bi=zi.getSections();for(const Js of Bi){if(Js.imageName)continue;const ro=Kt[Js.fontStack];if(ro&&(Qr=ro.ascender!==void 0&&ro.descender!==void 0,!Qr))break}if(!Qr)break}let Ri=0;for(const zi of Jn){zi.trim();const Bi=zi.getMaxScale(),Js=(Bi-1)*ln,ro={positionedGlyphs:[],lineOffset:0};wt.positionedLines[Ri]=ro;const io=ro.positionedGlyphs;let Qs=0;if(!zi.length()){xr+=on,++Ri;continue}let Fo=0,ia=0;for(let eo=0;eo<zi.length();eo++){const Qa=zi.getSection(eo),Oa=zi.getSectionIndex(eo),Wo=zi.getCharCode(eo);let Ms=Qa.scale,Fa=null,so=null,Yu=null,za=ln,$l=0;const Ml=!($n===ft.horizontal||!_n&&!If(Wo)||_n&&(Ii[Wo]||(Es=Wo,gr.Arabic(Es)||gr["Arabic Supplement"](Es)||gr["Arabic Extended-A"](Es)||gr["Arabic Presentation Forms-A"](Es)||gr["Arabic Presentation Forms-B"](Es))));if(Qa.imageName){const Ku=bn[Qa.imageName];if(!Ku)continue;Yu=Qa.imageName,wt.iconsInText=wt.iconsInText||!0,so=Ku.paddedRect;const kl=Ku.displaySize;Ms=Ms*ln/_r,Fa={width:kl[0],height:kl[1],left:ql,top:-o1,advance:Ml?kl[1]:kl[0],localGlyph:!1},$l=Qr?-Fa.height*Ms:Rn+Bi*ln-kl[1]*Ms,za=Fa.advance;const Zf=(Ml?kl[0]:kl[1])*Ms-ln*Bi;Zf>0&&Zf>Qs&&(Qs=Zf)}else{const Ku=Xt[Qa.fontStack];if(!Ku)continue;Ku[Wo]&&(so=Ku[Wo]);const kl=Kt[Qa.fontStack];if(!kl)continue;const Zf=kl.glyphs[Wo];if(!Zf)continue;if(Fa=Zf.metrics,za=Wo!==8203?ln:0,Qr){const xx=kl.ascender!==void 0?Math.abs(kl.ascender):0,lw=kl.descender!==void 0?Math.abs(kl.descender):0,uw=(xx+lw)*Ms;Fo<uw&&(Fo=uw,ia=(xx-lw)/2*Ms),$l=-xx*Ms}else $l=Rn+(Bi-Ms)*ln}Ml?(wt.verticalizable=!0,io.push({glyph:Wo,imageName:Yu,x:Rr,y:xr+$l,vertical:Ml,scale:Ms,localGlyph:Fa.localGlyph,fontStack:Qa.fontStack,sectionIndex:Oa,metrics:Fa,rect:so}),Rr+=za*Ms+tr):(io.push({glyph:Wo,imageName:Yu,x:Rr,y:xr+$l,vertical:Ml,scale:Ms,localGlyph:Fa.localGlyph,fontStack:Qa.fontStack,sectionIndex:Oa,metrics:Fa,rect:so}),Rr+=Fa.advance*Ms+tr)}io.length!==0&&(Pi=Math.max(Rr-tr,Pi),Qr?tm(io,nr,Qs,ia,on*Bi/2):tm(io,nr,Qs,0,on/2)),Rr=0;const Da=on*Bi+Qs;ro.lineOffset=Math.max(Qs,Js),xr+=Da,++Ri}var Es;const Ni=xr,{horizontalAlign:ai,verticalAlign:fo}=Gi(An);(function(zi,Bi,Js,ro,io,Qs){const Fo=(Bi-Js)*io,ia=-Qs*ro;for(const Da of zi)for(const eo of Da.positionedGlyphs)eo.x+=Fo,eo.y+=ia})(wt.positionedLines,nr,ai,fo,Pi,Ni),wt.top+=-fo*Ni,wt.bottom=wt.top+Ni,wt.left+=-ai*Pi,wt.right=wt.left+Pi,wt.hasBaseline=Qr}(Et,a,h,m,Oe,k,A,N,X,z,ee,he),!function(wt){for(const Kt of wt)if(Kt.positionedGlyphs.length!==0)return!1;return!0}(pt)&&Et}const Ii={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hi={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Wi(c,a,h,m,x,w){if(a.imageName){const k=m[a.imageName];return k?k.displaySize[0]*a.scale*ln/w+x:0}{const k=h[a.fontStack],A=k&&k.glyphs[c];return A?A.metrics.advance*a.scale+x:0}}function os(c,a,h,m){const x=Math.pow(c-a,2);return m?c<a?x/2:2*x:x+Math.abs(h)*h}function ho(c,a,h){let m=0;return c===10&&(m-=1e4),h&&(m+=150),c!==40&&c!==65288||(m+=50),a!==41&&a!==65289||(m+=50),m}function Rs(c,a,h,m,x,w){let k=null,A=os(a,h,x,w);for(const N of m){const z=os(a-N.x,h,x,w)+N.badness;z<=A&&(k=N,A=z)}return{index:c,x:a,priorBreak:k,badness:A}}function as(c){return c?as(c.priorBreak).concat(c.index):[]}function Gi(c){let a=.5,h=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function tm(c,a,h,m,x){if(!(a||h||m||x))return;const w=c.length-1,k=c[w],A=(k.x+k.metrics.advance*k.scale)*a;for(let N=0;N<=w;N++)c[N].x-=A,c[N].y+=h+m+x}function xa(c,a,h){const{horizontalAlign:m,verticalAlign:x}=Gi(h),w=a[0]-c.displaySize[0]*m,k=a[1]-c.displaySize[1]*x;return{image:c,top:k,bottom:k+c.displaySize[1],left:w,right:w+c.displaySize[0]}}function Wf(c,a,h,m,x,w){const k=c.image;let A;if(k.content){const Oe=k.content,Ze=k.pixelRatio||1;A=[Oe[0]/Ze,Oe[1]/Ze,k.displaySize[0]-Oe[2]/Ze,k.displaySize[1]-Oe[3]/Ze]}const N=a.left*w,z=a.right*w;let V,X,ee,ae;h==="width"||h==="both"?(ae=x[0]+N-m[3],X=x[0]+z+m[1]):(ae=x[0]+(N+z-k.displaySize[0])/2,X=ae+k.displaySize[0]);const he=a.top*w,Te=a.bottom*w;return h==="height"||h==="both"?(V=x[1]+he-m[0],ee=x[1]+Te+m[2]):(V=x[1]+(he+Te-k.displaySize[1])/2,ee=V+k.displaySize[1]),{image:k,top:V,right:X,bottom:ee,left:ae,collisionPadding:A}}class al extends We{constructor(a,h,m,x,w){super(a,h),this.angle=x,this.z=m,w!==void 0&&(this.segment=w)}clone(){return new al(this.x,this.y,this.z,this.angle,this.segment)}}function nm(c,a,h,m,x){if(a.segment===void 0)return!0;let w=a,k=a.segment+1,A=0;for(;A>-h/2;){if(k--,k<0)return!1;A-=c[k].dist(w),w=c[k]}A+=c[k].dist(c[k+1]),k++;const N=[];let z=0;for(;A<h/2;){const V=c[k],X=c[k+1];if(!X)return!1;let ee=c[k-1].angleTo(V)-V.angleTo(X);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:A,angleDelta:ee}),z+=ee;A-N[0].distance>m;)z-=N.shift().angleDelta;if(z>x)return!1;k++,A+=V.dist(X)}return!0}function qf(c){let a=0;for(let h=0;h<c.length-1;h++)a+=c[h].dist(c[h+1]);return a}function ll(c,a,h){return c?.6*a*h:0}function zh(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function ou(c,a,h,m,x,w){const k=ll(h,x,w),A=zh(h,m)*w;let N=0;const z=qf(c)/2;for(let V=0;V<c.length-1;V++){const X=c[V],ee=c[V+1],ae=X.dist(ee);if(N+ae>z){const he=(z-N)/ae,Te=Yi(X.x,ee.x,he),Oe=Yi(X.y,ee.y,he),Ze=new al(Te,Oe,0,ee.angleTo(X),V);return!k||nm(c,Ze,A,k,a)?Ze:void 0}N+=ae}}function Bh(c,a,h,m,x,w,k,A,N){const z=ll(m,w,k),V=zh(m,x),X=V*k,ee=c[0].x===0||c[0].x===N||c[0].y===0||c[0].y===N;return a-X<a/4&&(a=X+a/4),th(c,ee?a/2*A%a:(V/2+2*w)*k*A%a,a,z,h,X,ee,!1,N)}function th(c,a,h,m,x,w,k,A,N){const z=w/2,V=qf(c);let X=0,ee=a-h,ae=[];for(let he=0;he<c.length-1;he++){const Te=c[he],Oe=c[he+1],Ze=Te.dist(Oe),yt=Oe.angleTo(Te);for(;ee+h<X+Ze;){ee+=h;const Ke=(ee-X)/Ze,pt=Yi(Te.x,Oe.x,Ke),Et=Yi(Te.y,Oe.y,Ke);if(pt>=0&&pt<N&&Et>=0&&Et<N&&ee-z>=0&&ee+z<=V){const wt=new al(pt,Et,0,yt,he);wt._round(),m&&!nm(c,wt,w,m,x)||ae.push(wt)}}X+=Ze}return A||ae.length||k||(ae=th(c,X/2,h,m,x,w,k,!0,N)),ae}function yA(c,a,h,m,x){const w=[];for(let k=0;k<c.length;k++){const A=c[k];let N;for(let z=0;z<A.length-1;z++){let V=A[z],X=A[z+1];V.x<a&&X.x<a||(V.x<a?V=new We(a,V.y+(a-V.x)/(X.x-V.x)*(X.y-V.y))._round():X.x<a&&(X=new We(a,V.y+(a-V.x)/(X.x-V.x)*(X.y-V.y))._round()),V.y<h&&X.y<h||(V.y<h?V=new We(V.x+(h-V.y)/(X.y-V.y)*(X.x-V.x),h)._round():X.y<h&&(X=new We(V.x+(h-V.y)/(X.y-V.y)*(X.x-V.x),h)._round()),V.x>=m&&X.x>=m||(V.x>=m?V=new We(m,V.y+(m-V.x)/(X.x-V.x)*(X.y-V.y))._round():X.x>=m&&(X=new We(m,V.y+(m-V.x)/(X.x-V.x)*(X.y-V.y))._round()),V.y>=x&&X.y>=x||(V.y>=x?V=new We(V.x+(x-V.y)/(X.y-V.y)*(X.x-V.x),x)._round():X.y>=x&&(X=new We(V.x+(x-V.y)/(X.y-V.y)*(X.x-V.x),x)._round()),N&&V.equals(N[N.length-1])||(N=[V],w.push(N)),N.push(X)))))}}return w}Ir(al,"Anchor");const Q3=1e20;function _A(c,a,h,m,x,w,k,A,N){for(let z=a;z<a+m;z++)vA(c,h*w+z,w,x,k,A,N);for(let z=h;z<h+x;z++)vA(c,z*w+a,1,m,k,A,N)}function vA(c,a,h,m,x,w,k){w[0]=0,k[0]=-Q3,k[1]=Q3,x[0]=c[a];for(let A=1,N=0,z=0;A<m;A++){x[A]=c[a+A*h];const V=A*A;do{const X=w[N];z=(x[A]-x[X]+V-X*X)/(A-X)/2}while(z<=k[N]&&--N>-1);N++,w[N]=A,k[N]=z,k[N+1]=Q3}for(let A=0,N=0;A<m;A++){for(;k[N+1]<A;)N++;const z=w[N],V=A-z;c[a+A*h]=x[z]+V*V}}const $f=2,JM={none:0,ideographs:1,all:2};class px{constructor(a,h,m){this.requestManager=a,this.localGlyphMode=h,this.localFontFamily=m,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,h){const m=[];for(const x in a)for(const w of a[x])m.push({stack:x,id:w});rt(m,({stack:x,id:w},k)=>{let A=this.entries[x];A||(A=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let N=A.glyphs[w];if(N!==void 0)return void k(null,{stack:x,id:w,glyph:N});if(N=this._tinySDF(A,x,w),N)return A.glyphs[w]=N,void k(null,{stack:x,id:w,glyph:N});const z=Math.floor(w/256);if(256*z>65535)return void k(new Error("glyphs > 65535 not supported"));if(A.ranges[z])return void k(null,{stack:x,id:w,glyph:N});let V=A.requests[z];V||(V=A.requests[z]=[],px.loadGlyphRange(x,z,this.url,this.requestManager,(X,ee)=>{if(ee){A.ascender=ee.ascender,A.descender=ee.descender;for(const ae in ee.glyphs)this._doesCharSupportLocalGlyph(+ae)||(A.glyphs[+ae]=ee.glyphs[+ae]);A.ranges[z]=!0}for(const ae of V)ae(X,ee);delete A.requests[z]})),V.push((X,ee)=>{X?k(X):ee&&k(null,{stack:x,id:w,glyph:ee.glyphs[w]||null})})},(x,w)=>{if(x)h(x);else if(w){const k={};for(const{stack:A,id:N,glyph:z}of w)k[A]===void 0&&(k[A]={}),k[A].glyphs===void 0&&(k[A].glyphs={}),k[A].glyphs[N]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},k[A].ascender=this.entries[A].ascender,k[A].descender=this.entries[A].descender;h(null,k)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==JM.none&&(this.localGlyphMode===JM.all?!!this.localFontFamily:!!this.localFontFamily&&(gr["CJK Unified Ideographs"](a)||gr["Hangul Syllables"](a)||gr.Hiragana(a)||gr.Katakana(a)||gr["CJK Symbols and Punctuation"](a)))}_tinySDF(a,h,m){const x=this.localFontFamily;if(!x||!this._doesCharSupportLocalGlyph(m))return;let w=a.tinySDF;if(!w){let Te="400";/bold/i.test(h)?Te="900":/medium/i.test(h)?Te="500":/light/i.test(h)&&(Te="200"),w=a.tinySDF=new px.TinySDF({fontFamily:x,fontWeight:Te,fontSize:24*$f,buffer:3*$f,radius:8*$f}),w.fontWeight=Te}if(this.localGlyphs[w.fontWeight][m])return this.localGlyphs[w.fontWeight][m];const k=String.fromCharCode(m),{data:A,width:N,height:z,glyphWidth:V,glyphHeight:X,glyphLeft:ee,glyphTop:ae,glyphAdvance:he}=w.draw(k);return this.localGlyphs[w.fontWeight][m]={id:m,bitmap:new Dd({width:N,height:z},A),metrics:{width:V/$f,height:X/$f,left:ee/$f,top:ae/$f-27,advance:he/$f,localGlyph:!0}}}}px.loadGlyphRange=function(c,a,h,m,x){const w=256*a,k=w+255,A=m.transformRequest(m.normalizeGlyphsURL(h).replace("{fontstack}",c).replace("{range}",`${w}-${k}`),$i.Glyphs);Di(A,(N,z)=>{if(N)x(N);else if(z){const V={},X=function(ee){return new s1(ee).readFields(kg,{})}(z);for(const ee of X.glyphs)V[ee.id]=ee;x(null,{glyphs:V,ascender:X.ascender,descender:X.descender})}})},px.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:h=8,cutoff:m=.25,fontFamily:x="sans-serif",fontWeight:w="normal",fontStyle:k="normal"}={}){this.buffer=a,this.cutoff=m,this.radius=h;const A=this.size=c+4*a,N=this._createCanvas(A),z=this.ctx=N.getContext("2d",{willReadFrequently:!0});z.font=`${k} ${w} ${c}px ${x}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:h,actualBoundingBoxDescent:m,actualBoundingBoxLeft:x,actualBoundingBoxRight:w}=this.ctx.measureText(c),k=Math.ceil(h),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-x))),N=Math.min(this.size-this.buffer,k+Math.ceil(m)),z=A+2*this.buffer,V=N+2*this.buffer,X=Math.max(z*V,0),ee=new Uint8ClampedArray(X),ae={data:ee,width:z,height:V,glyphWidth:A,glyphHeight:N,glyphTop:k,glyphLeft:0,glyphAdvance:a};if(A===0||N===0)return ae;const{ctx:he,buffer:Te,gridInner:Oe,gridOuter:Ze}=this;he.clearRect(Te,Te,A,N),he.fillText(c,Te,Te+k);const yt=he.getImageData(Te,Te,A,N);Ze.fill(Q3,0,X),Oe.fill(0,0,X);for(let Ke=0;Ke<N;Ke++)for(let pt=0;pt<A;pt++){const Et=yt.data[4*(Ke*A+pt)+3]/255;if(Et===0)continue;const wt=(Ke+Te)*z+pt+Te;if(Et===1)Ze[wt]=0,Oe[wt]=Q3;else{const Kt=.5-Et;Ze[wt]=Kt>0?Kt*Kt:0,Oe[wt]=Kt<0?Kt*Kt:0}}_A(Ze,0,0,z,V,z,this.f,this.v,this.z),_A(Oe,Te,Te,A,N,z,this.f,this.v,this.z);for(let Ke=0;Ke<X;Ke++){const pt=Math.sqrt(Ze[Ke])-Math.sqrt(Oe[Ke]);ee[Ke]=Math.round(255-255*(pt/this.radius+this.cutoff))}return ae}};const mx=ql;function xA(c,a,h,m){const x=[],w=c.image,k=w.pixelRatio,A=w.paddedRect.w-2*mx,N=w.paddedRect.h-2*mx,z=c.right-c.left,V=c.bottom-c.top,X=w.stretchX||[[0,A]],ee=w.stretchY||[[0,N]],ae=(on,An)=>on+An[1]-An[0],he=X.reduce(ae,0),Te=ee.reduce(ae,0),Oe=A-he,Ze=N-Te;let yt=0,Ke=he,pt=0,Et=Te,wt=0,Kt=Oe,Xt=0,bn=Ze;if(w.content&&m){const on=w.content;yt=g4(X,0,on[0]),pt=g4(ee,0,on[1]),Ke=g4(X,on[0],on[2]),Et=g4(ee,on[1],on[3]),wt=on[0]-yt,Xt=on[1]-pt,Kt=on[2]-on[0]-Ke,bn=on[3]-on[1]-Et}const Jn=(on,An,Ln,$n)=>{const tr=y4(on.stretch-yt,Ke,z,c.left),_n=_4(on.fixed-wt,Kt,on.stretch,he),_r=y4(An.stretch-pt,Et,V,c.top),Rr=_4(An.fixed-Xt,bn,An.stretch,Te),xr=y4(Ln.stretch-yt,Ke,z,c.left),Pi=_4(Ln.fixed-wt,Kt,Ln.stretch,he),nr=y4($n.stretch-pt,Et,V,c.top),Qr=_4($n.fixed-Xt,bn,$n.stretch,Te),Ri=new We(tr,_r),Es=new We(xr,_r),Ni=new We(xr,nr),ai=new We(tr,nr),fo=new We(_n/k,Rr/k),zi=new We(Pi/k,Qr/k),Bi=a*Math.PI/180;if(Bi){const io=Math.sin(Bi),Qs=Math.cos(Bi),Fo=[Qs,-io,io,Qs];Ri._matMult(Fo),Es._matMult(Fo),ai._matMult(Fo),Ni._matMult(Fo)}const Js=on.stretch+on.fixed,ro=An.stretch+An.fixed;return{tl:Ri,tr:Es,bl:ai,br:Ni,tex:{x:w.paddedRect.x+mx+Js,y:w.paddedRect.y+mx+ro,w:Ln.stretch+Ln.fixed-Js,h:$n.stretch+$n.fixed-ro},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fo,pixelOffsetBR:zi,minFontScaleX:Kt/k/z,minFontScaleY:bn/k/V,isSDF:h}};if(m&&(w.stretchX||w.stretchY)){const on=bA(X,Oe,he),An=bA(ee,Ze,Te);for(let Ln=0;Ln<on.length-1;Ln++){const $n=on[Ln],tr=on[Ln+1];for(let _n=0;_n<An.length-1;_n++)x.push(Jn($n,An[_n],tr,An[_n+1]))}}else x.push(Jn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:N+1}));return x}function g4(c,a,h){let m=0;for(const x of c)m+=Math.max(a,Math.min(h,x[1]))-Math.max(a,Math.min(h,x[0]));return m}function bA(c,a,h){const m=[{fixed:-mx,stretch:0}];for(const[x,w]of c){const k=m[m.length-1];m.push({fixed:x-k.stretch,stretch:k.stretch}),m.push({fixed:x-k.stretch,stretch:k.stretch+(w-x)})}return m.push({fixed:a+mx,stretch:h}),m}function y4(c,a,h,m){return c/a*h+m}function _4(c,a,h,m){return c-a*h/m}function OH(c,a,h,m){const x=a+c.positionedLines[m].lineOffset;return m===0?h+x/2:h+(x+(a+c.positionedLines[m-1].lineOffset))/2}class FH{constructor(a=[],h=zH){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:m}=this,x=h[a];for(;a>0;){const w=a-1>>1,k=h[w];if(m(x,k)>=0)break;h[a]=k,a=w}h[a]=x}_down(a){const{data:h,compare:m}=this,x=this.length>>1,w=h[a];for(;a<x;){let k=1+(a<<1),A=h[k];const N=k+1;if(N<this.length&&m(h[N],A)<0&&(k=N,A=h[N]),m(A,w)>=0)break;h[a]=A,a=k}h[a]=w}}function zH(c,a){return c<a?-1:c>a?1:0}function BH(c,a=1,h=!1){let m=1/0,x=1/0,w=-1/0,k=-1/0;const A=c[0];for(let ae=0;ae<A.length;ae++){const he=A[ae];(!ae||he.x<m)&&(m=he.x),(!ae||he.y<x)&&(x=he.y),(!ae||he.x>w)&&(w=he.x),(!ae||he.y>k)&&(k=he.y)}const N=Math.min(w-m,k-x);let z=N/2;const V=new FH([],UH);if(N===0)return new We(m,x);for(let ae=m;ae<w;ae+=N)for(let he=x;he<k;he+=N)V.push(new gx(ae+z,he+z,z,c));let X=function(ae){let he=0,Te=0,Oe=0;const Ze=ae[0];for(let yt=0,Ke=Ze.length,pt=Ke-1;yt<Ke;pt=yt++){const Et=Ze[yt],wt=Ze[pt],Kt=Et.x*wt.y-wt.x*Et.y;Te+=(Et.x+wt.x)*Kt,Oe+=(Et.y+wt.y)*Kt,he+=3*Kt}return new gx(Te/he,Oe/he,0,ae)}(c),ee=V.length;for(;V.length;){const ae=V.pop();(ae.d>X.d||!X.d)&&(X=ae,h&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,ee)),ae.max-X.d<=a||(z=ae.h/2,V.push(new gx(ae.p.x-z,ae.p.y-z,z,c)),V.push(new gx(ae.p.x+z,ae.p.y-z,z,c)),V.push(new gx(ae.p.x-z,ae.p.y+z,z,c)),V.push(new gx(ae.p.x+z,ae.p.y+z,z,c)),ee+=4)}return h&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${X.d}`)),X.p}function UH(c,a){return a.max-c.max}class gx{constructor(a,h,m,x){this.p=new We(a,h),this.h=m,this.d=function(w,k){let A=!1,N=1/0;for(let z=0;z<k.length;z++){const V=k[z];for(let X=0,ee=V.length,ae=ee-1;X<ee;ae=X++){const he=V[X],Te=V[ae];he.y>w.y!=Te.y>w.y&&w.x<(Te.x-he.x)*(w.y-he.y)/(Te.y-he.y)+he.x&&(A=!A),N=Math.min(N,j3(w,he,Te))}}return(A?1:-1)*Math.sqrt(N)}(this.p,x),this.max=this.d+this.h*Math.SQRT2}}const yx=7,QM=Number.POSITIVE_INFINITY,jH=Math.sqrt(2);function wA(c,[a,h]){let m=0,x=0;if(h===QM){a<0&&(a=0);const w=a/jH;switch(c){case"top-right":case"top-left":x=w-yx;break;case"bottom-right":case"bottom-left":x=-w+yx;break;case"bottom":x=-a+yx;break;case"top":x=a-yx}switch(c){case"top-right":case"bottom-right":m=-w;break;case"top-left":case"bottom-left":m=w;break;case"left":m=a;break;case"right":m=-a}}else{switch(a=Math.abs(a),h=Math.abs(h),c){case"top-right":case"top-left":case"top":x=h-yx;break;case"bottom-right":case"bottom-left":case"bottom":x=-h+yx}switch(c){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}}return[m,x]}function VH(c,a,h,m,x,w,k,A,N,z){c.createArrays(),c.tilePixelRatio=Yr/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const V=c.layers[0].layout,X=c.layers[0]._unevaluatedLayout._values,ee={};if(c.textSizeData.kind==="composite"){const{minZoom:Te,maxZoom:Oe}=c.textSizeData;ee.compositeTextSizes=[X["text-size"].possiblyEvaluate(new q(Te),A),X["text-size"].possiblyEvaluate(new q(Oe),A)]}if(c.iconSizeData.kind==="composite"){const{minZoom:Te,maxZoom:Oe}=c.iconSizeData;ee.compositeIconSizes=[X["icon-size"].possiblyEvaluate(new q(Te),A),X["icon-size"].possiblyEvaluate(new q(Oe),A)]}ee.layoutTextSize=X["text-size"].possiblyEvaluate(new q(N+1),A),ee.layoutIconSize=X["icon-size"].possiblyEvaluate(new q(N+1),A),ee.textMaxSize=X["text-size"].possiblyEvaluate(new q(18),A);const ae=V.get("text-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",he=V.get("text-size");for(const Te of c.features){const Oe=V.get("text-font").evaluate(Te,{},A).join(","),Ze=he.evaluate(Te,{},A),yt=ee.layoutTextSize.evaluate(Te,{},A),Ke=(ee.layoutIconSize.evaluate(Te,{},A),{horizontal:{},vertical:void 0}),pt=Te.text;let Et,wt=[0,0];if(pt){const bn=pt.toString(),Jn=V.get("text-letter-spacing").evaluate(Te,{},A)*ln,on=V.get("text-line-height").evaluate(Te,{},A)*ln,An=w3(bn)?Jn:0,Ln=V.get("text-anchor").evaluate(Te,{},A),$n=V.get("text-variable-anchor");if(!$n){const xr=V.get("text-radial-offset").evaluate(Te,{},A);wt=xr?wA(Ln,[xr*ln,QM]):V.get("text-offset").evaluate(Te,{},A).map(Pi=>Pi*ln)}let tr=ae?"center":V.get("text-justify").evaluate(Te,{},A);const _n=V.get("symbol-placement")==="point",_r=_n?V.get("text-max-width").evaluate(Te,{},A)*ln:1/0,Rr=xr=>{c.allowVerticalPlacement&&Md(bn)&&(Ke.vertical=ar(pt,a,h,x,Oe,_r,on,Ln,xr,An,wt,ft.vertical,!0,yt,Ze))};if(!ae&&$n){const xr=tr==="auto"?$n.map(nr=>e6(nr)):[tr];let Pi=!1;for(let nr=0;nr<xr.length;nr++){const Qr=xr[nr];if(!Ke.horizontal[Qr])if(Pi)Ke.horizontal[Qr]=Ke.horizontal[0];else{const Ri=ar(pt,a,h,x,Oe,_r,on,"center",Qr,An,wt,ft.horizontal,!1,yt,Ze);Ri&&(Ke.horizontal[Qr]=Ri,Pi=Ri.positionedLines.length===1)}}Rr("left")}else{if(tr==="auto"&&(tr=e6(Ln)),_n||V.get("text-writing-mode").indexOf("horizontal")>=0||!Md(bn)){const xr=ar(pt,a,h,x,Oe,_r,on,Ln,tr,An,wt,ft.horizontal,!1,yt,Ze);xr&&(Ke.horizontal[tr]=xr)}Rr(_n?"left":tr)}}let Kt=!1;if(Te.icon&&Te.icon.name){const bn=m[Te.icon.name];bn&&(Et=xa(x[Te.icon.name],V.get("icon-offset").evaluate(Te,{},A),V.get("icon-anchor").evaluate(Te,{},A)),Kt=bn.sdf,c.sdfIcons===void 0?c.sdfIcons=bn.sdf:c.sdfIcons!==bn.sdf&&Be("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(bn.pixelRatio!==c.pixelRatio||V.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const Xt=SA(Ke.horizontal)||Ke.vertical;c.iconsInText||(c.iconsInText=!!Xt&&Xt.iconsInText),(Xt||Et)&&GH(c,Te,Ke,Et,m,ee,yt,0,wt,Kt,k,A,z)}w&&c.generateCollisionDebugBuffers(N,c.collisionBoxArray)}function e6(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function GH(c,a,h,m,x,w,k,A,N,z,V,X,ee){let ae=w.textMaxSize.evaluate(a,{},X);ae===void 0&&(ae=k);const he=c.layers[0].layout,Te=he.get("icon-offset").evaluate(a,{},X),Oe=SA(h.horizontal)||h.vertical,Ze=ee.name==="globe",yt=ln,Ke=k/yt,pt=c.tilePixelRatio*ae/yt,Et=(Ln=c.overscaling,c.zoom>18&&Ln>2&&(Ln>>=1),Math.max(Yr/(512*Ln),1)*he.get("symbol-spacing")),wt=he.get("text-padding")*c.tilePixelRatio,Kt=he.get("icon-padding")*c.tilePixelRatio,Xt=qe(he.get("text-max-angle")),bn=he.get("text-rotation-alignment")==="map"&&he.get("symbol-placement")!=="point",Jn=he.get("icon-rotation-alignment")==="map"&&he.get("symbol-placement")!=="point",on=he.get("symbol-placement"),An=Et/2;var Ln;const $n=he.get("icon-text-fit");let tr;m&&$n!=="none"&&(c.allowVerticalPlacement&&h.vertical&&(tr=Wf(m,h.vertical,$n,he.get("icon-text-fit-padding"),Te,Ke)),Oe&&(m=Wf(m,Oe,$n,he.get("icon-text-fit-padding"),Te,Ke)));const _n=(_r,Rr,xr)=>{if(Rr.x<0||Rr.x>=Yr||Rr.y<0||Rr.y>=Yr)return;let Pi=null;if(Ze){const{x:nr,y:Qr,z:Ri}=ee.projectTilePoint(Rr.x,Rr.y,xr);Pi={anchor:new al(nr,Qr,Ri,0,void 0),up:ee.upVector(xr,Rr.x,Rr.y)}}(function(nr,Qr,Ri,Es,Ni,ai,fo,zi,Bi,Js,ro,io,Qs,Fo,ia,Da,eo,Qa,Oa,Wo,Ms,Fa,so,Yu,za){const $l=nr.addToLineVertexArray(Qr,Es);let Ml,Ku,kl,Zf,xx,lw,uw,rL=0,iL=0,sL=0,oL=0,m6=-1,g6=-1;const om={};let aL=A_("");const u1=Ri?Ri.anchor:Qr;let y6=0,_6=0;if(Bi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[y6,_6]=Bi.layout.get("text-offset").evaluate(Ms,{},za).map(nh=>nh*ln):(y6=Bi.layout.get("text-radial-offset").evaluate(Ms,{},za)*ln,_6=QM),nr.allowVerticalPlacement&&Ni.vertical){const nh=Ni.vertical;if(ia)lw=t6(nh),zi&&(uw=t6(zi));else{const rh=Bi.layout.get("text-rotate").evaluate(Ms,{},za)+90;kl=v4(Js,u1,Qr,ro,io,Qs,nh,Fo,rh,Da),zi&&(Zf=v4(Js,u1,Qr,ro,io,Qs,zi,Qa,rh))}}if(ai){const nh=Bi.layout.get("icon-rotate").evaluate(Ms,{},za),rh=Bi.layout.get("icon-text-fit")!=="none",cw=xA(ai,nh,so,rh),x6=zi?xA(zi,nh,so,rh):void 0;Ku=v4(Js,u1,Qr,ro,io,Qs,ai,Qa,nh),rL=4*cw.length;const lL=nr.iconSizeData;let c1=null;lL.kind==="source"?(c1=[rn*Bi.layout.get("icon-size").evaluate(Ms,{},za)],c1[0]>H0&&Be(`${nr.layerIds[0]}: Value for "icon-size" is >= ${ew}. Reduce your "icon-size".`)):lL.kind==="composite"&&(c1=[rn*Fa.compositeIconSizes[0].evaluate(Ms,{},za),rn*Fa.compositeIconSizes[1].evaluate(Ms,{},za)],(c1[0]>H0||c1[1]>H0)&&Be(`${nr.layerIds[0]}: Value for "icon-size" is >= ${ew}. Reduce your "icon-size".`)),nr.addSymbols(nr.icon,cw,c1,Wo,Oa,Ms,!1,Ri,Qr,$l.lineStartIndex,$l.lineLength,-1,Yu,za),m6=nr.icon.placedSymbolArray.length-1,x6&&(iL=4*x6.length,nr.addSymbols(nr.icon,x6,c1,Wo,Oa,Ms,ft.vertical,Ri,Qr,$l.lineStartIndex,$l.lineLength,-1,Yu,za),g6=nr.icon.placedSymbolArray.length-1)}for(const nh in Ni.horizontal){const rh=Ni.horizontal[nh];Ml||(aL=A_(rh.text),ia?xx=t6(rh):Ml=v4(Js,u1,Qr,ro,io,Qs,rh,Fo,Bi.layout.get("text-rotate").evaluate(Ms,{},za),Da));const cw=rh.positionedLines.length===1;if(sL+=EA(nr,Ri,Qr,rh,fo,Bi,ia,Ms,Da,$l,Ni.vertical?ft.horizontal:ft.horizontalOnly,cw?Object.keys(Ni.horizontal):[nh],om,m6,Fa,Yu,za),cw)break}Ni.vertical&&(oL+=EA(nr,Ri,Qr,Ni.vertical,fo,Bi,ia,Ms,Da,$l,ft.vertical,["vertical"],om,g6,Fa,Yu,za));let Y0=-1;const v6=(nh,rh)=>nh?Math.max(nh,rh):rh;Y0=v6(xx,Y0),Y0=v6(lw,Y0),Y0=v6(uw,Y0);const yW=Y0>-1?1:0;nr.glyphOffsetArray.length>=q0.MAX_GLYPHS&&Be("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ms.sortKey!==void 0&&nr.addToSortKeyRanges(nr.symbolInstances.length,Ms.sortKey),nr.symbolInstances.emplaceBack(u1.x,u1.y,u1.z,Qr.x,Qr.y,om.right>=0?om.right:-1,om.center>=0?om.center:-1,om.left>=0?om.left:-1,om.vertical>=0?om.vertical:-1,m6,g6,aL,Ml!==void 0?Ml:nr.collisionBoxArray.length,Ml!==void 0?Ml+1:nr.collisionBoxArray.length,kl!==void 0?kl:nr.collisionBoxArray.length,kl!==void 0?kl+1:nr.collisionBoxArray.length,Ku!==void 0?Ku:nr.collisionBoxArray.length,Ku!==void 0?Ku+1:nr.collisionBoxArray.length,Zf||nr.collisionBoxArray.length,Zf?Zf+1:nr.collisionBoxArray.length,ro,sL,oL,rL,iL,yW,0,y6,_6,Y0)})(c,Rr,Pi,_r,h,m,x,tr,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,wt,bn,N,0,Kt,Jn,Te,a,w,z,V,X)};if(on==="line")for(const _r of yA(a.geometry,0,0,Yr,Yr)){const Rr=Bh(_r,Et,Xt,h.vertical||Oe,m,yt,pt,c.overscaling,Yr);for(const xr of Rr)Oe&&HH(c,Oe.text,An,xr)||_n(_r,xr,X)}else if(on==="line-center"){for(const _r of a.geometry)if(_r.length>1){const Rr=ou(_r,Xt,h.vertical||Oe,m,yt,pt);Rr&&_n(_r,Rr,X)}}else if(a.type==="Polygon")for(const _r of G0(a.geometry,0)){const Rr=BH(_r,16);_n(_r[0],new al(Rr.x,Rr.y,0,0,void 0),X)}else if(a.type==="LineString")for(const _r of a.geometry)_n(_r,new al(_r[0].x,_r[0].y,0,0,void 0),X);else if(a.type==="Point")for(const _r of a.geometry)for(const Rr of _r)_n([Rr],new al(Rr.x,Rr.y,0,0,void 0),X)}const ew=255,H0=ew*rn;function EA(c,a,h,m,x,w,k,A,N,z,V,X,ee,ae,he,Te,Oe){const Ze=function(pt,Et,wt,Kt,Xt,bn,Jn,on){const An=[];if(Et.positionedLines.length===0)return An;const Ln=Kt.layout.get("text-rotate").evaluate(bn,{})*Math.PI/180,$n=function(xr){const Pi=xr[0],nr=xr[1],Qr=Pi*nr;return Qr>0?[Pi,-nr]:Qr<0?[-Pi,nr]:Pi===0?[nr,Pi]:[nr,-Pi]}(wt);let tr=Math.abs(Et.top-Et.bottom);for(const xr of Et.positionedLines)tr-=xr.lineOffset;const _n=Et.positionedLines.length,_r=tr/_n;let Rr=Et.top-wt[1];for(let xr=0;xr<_n;++xr){const Pi=Et.positionedLines[xr];Rr=OH(Et,_r,Rr,xr);for(const nr of Pi.positionedGlyphs){if(!nr.rect)continue;const Qr=nr.rect||{};let Ri=o1+1,Es=!0,Ni=1,ai=0;if(nr.imageName){const so=Jn[nr.imageName];if(!so)continue;if(so.sdf){Be("SDF images are not supported in formatted text and will be ignored.");continue}Es=!1,Ni=so.pixelRatio,Ri=ql/Ni}const fo=(Xt||on)&&nr.vertical,zi=nr.metrics.advance*nr.scale/2,Bi=nr.metrics,Js=nr.rect;if(Js===null)continue;on&&Et.verticalizable&&(ai=nr.imageName?zi-nr.metrics.width*nr.scale/2:0);const ro=Xt?[nr.x+zi,nr.y]:[0,0];let io=[0,0],Qs=[0,0],Fo=!1;Xt||(fo?(Qs=[nr.x+zi+$n[0],nr.y+$n[1]-ai],Fo=!0):io=[nr.x+zi+wt[0],nr.y+wt[1]-ai]);const ia=Js.w*nr.scale/(Ni*(nr.localGlyph?$f:1)),Da=Js.h*nr.scale/(Ni*(nr.localGlyph?$f:1));let eo,Qa,Oa,Wo;if(fo){const so=nr.y-Rr,Yu=new We(-zi,zi-so),za=-Math.PI/2,$l=new We(...Qs);eo=new We(-zi+io[0],io[1]),eo._rotateAround(za,Yu)._add($l),eo.x+=-so+zi,eo.y-=(Bi.left-Ri)*nr.scale;const Ml=nr.imageName?Bi.advance*nr.scale:ln*nr.scale,Ku=String.fromCharCode(nr.glyph);Kn(Ku)?eo.x+=(1-Ri)*nr.scale:Hn(Ku)?eo.x+=Ml-Bi.height*nr.scale+(-Ri-1)*nr.scale:eo.x+=nr.imageName||Bi.width+2*Ri===Js.w&&Bi.height+2*Ri===Js.h?(Ml-Da)/2:(Ml-(Bi.height+2*Ri)*nr.scale)/2,Qa=new We(eo.x,eo.y-ia),Oa=new We(eo.x+Da,eo.y),Wo=new We(eo.x+Da,eo.y-ia)}else{const so=(Bi.left-Ri)*nr.scale-zi+io[0],Yu=(-Bi.top-Ri)*nr.scale+io[1],za=so+ia,$l=Yu+Da;eo=new We(so,Yu),Qa=new We(za,Yu),Oa=new We(so,$l),Wo=new We(za,$l)}if(Ln){let so;so=Xt?new We(0,0):Fo?new We($n[0],$n[1]):new We(wt[0],wt[1]),eo._rotateAround(Ln,so),Qa._rotateAround(Ln,so),Oa._rotateAround(Ln,so),Wo._rotateAround(Ln,so)}const Ms=new We(0,0),Fa=new We(0,0);An.push({tl:eo,tr:Qa,bl:Oa,br:Wo,tex:Qr,writingMode:Et.writingMode,glyphOffset:ro,sectionIndex:nr.sectionIndex,isSDF:Es,pixelOffsetTL:Ms,pixelOffsetBR:Fa,minFontScaleX:0,minFontScaleY:0})}}return An}(0,m,N,w,k,A,x,c.allowVerticalPlacement),yt=c.textSizeData;let Ke=null;yt.kind==="source"?(Ke=[rn*w.layout.get("text-size").evaluate(A,{},Oe)],Ke[0]>H0&&Be(`${c.layerIds[0]}: Value for "text-size" is >= ${ew}. Reduce your "text-size".`)):yt.kind==="composite"&&(Ke=[rn*he.compositeTextSizes[0].evaluate(A,{},Oe),rn*he.compositeTextSizes[1].evaluate(A,{},Oe)],(Ke[0]>H0||Ke[1]>H0)&&Be(`${c.layerIds[0]}: Value for "text-size" is >= ${ew}. Reduce your "text-size".`)),c.addSymbols(c.text,Ze,Ke,N,k,A,V,a,h,z.lineStartIndex,z.lineLength,ae,Te,Oe);for(const pt of X)ee[pt]=c.text.placedSymbolArray.length-1;return 4*Ze.length}function SA(c){for(const a in c)return c[a];return null}function v4(c,a,h,m,x,w,k,A,N,z){let V=k.top,X=k.bottom,ee=k.left,ae=k.right;const he=k.collisionPadding;if(he&&(ee-=he[0],V-=he[1],ae+=he[2],X+=he[3]),N){const Te=new We(ee,V),Oe=new We(ae,V),Ze=new We(ee,X),yt=new We(ae,X),Ke=qe(N);let pt=new We(0,0);z&&(pt=new We(z[0],z[1])),Te._rotateAround(Ke,pt),Oe._rotateAround(Ke,pt),Ze._rotateAround(Ke,pt),yt._rotateAround(Ke,pt),ee=Math.min(Te.x,Oe.x,Ze.x,yt.x),ae=Math.max(Te.x,Oe.x,Ze.x,yt.x),V=Math.min(Te.y,Oe.y,Ze.y,yt.y),X=Math.max(Te.y,Oe.y,Ze.y,yt.y)}return c.emplaceBack(a.x,a.y,a.z,h.x,h.y,ee,V,ae,X,A,m,x,w),c.length-1}function t6(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function HH(c,a,h,m){const x=c.compareText;if(a in x){const w=x[a];for(let k=w.length-1;k>=0;k--)if(m.dist(w[k])<h)return!0}else x[a]=[];return x[a].push(m),!1}function TA(c,a){const h=c.fovAboveCenter,m=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,x=(c._camera.position[2]*c.worldSize-m)/Math.cos(c._pitch),w=Math.sin(h)*x/Math.sin(Math.max(Math.PI/2-c._pitch-h,.01)),k=Math.sin(c._pitch)*w+x;return Math.min(1.01*k,x*(1/c._horizonShift))}function a1(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const h=Math.pow(2,-c.z),m=c.x*h,x=(c.x+1)*h,w=c.y*h,k=(c.y+1)*h,A=Su(m),N=Su(x),z=sl(w),V=sl(k),X=a.project(A,z),ee=a.project(N,z),ae=a.project(N,V),he=a.project(A,V);let Te=Math.min(X.x,ee.x,ae.x,he.x),Oe=Math.min(X.y,ee.y,ae.y,he.y),Ze=Math.max(X.x,ee.x,ae.x,he.x),yt=Math.max(X.y,ee.y,ae.y,he.y);const Ke=h/16;function pt(wt,Kt,Xt,bn,Jn,on){const An=(Xt+Jn)/2,Ln=(bn+on)/2,$n=a.project(Su(An),sl(Ln)),tr=Math.max(0,Te-$n.x,Oe-$n.y,$n.x-Ze,$n.y-yt);Te=Math.min(Te,$n.x),Ze=Math.max(Ze,$n.x),Oe=Math.min(Oe,$n.y),yt=Math.max(yt,$n.y),tr>Ke&&(pt(wt,$n,Xt,bn,An,Ln),pt($n,Kt,An,Ln,Jn,on))}pt(X,ee,m,w,x,w),pt(ee,ae,x,w,x,k),pt(ae,he,x,k,m,k),pt(he,X,m,k,m,w),Te-=Ke,Oe-=Ke,Ze+=Ke,yt+=Ke;const Et=1/Math.max(Ze-Te,yt-Oe);return{scale:Et,x:Te*Et,y:Oe*Et,x2:Ze*Et,y2:yt*Et,projection:a}}const WH=_c(new Float32Array(16));class W0{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,h){return{x:0,y:0,z:0}}unproject(a,h){return new ms(0,0)}projectTilePoint(a,h,m){return{x:a,y:h,z:0}}locationPoint(a,h,m=!0){return a._coordinatePoint(a.locationCoordinate(h),m)}pixelsPerMeter(a,h){return Hl(1,a)*h}pixelSpaceConversion(a,h,m){return 1}farthestPixelDistance(a){return TA(a,a.pixelsPerMeter)}pointCoordinate(a,h,m,x){const w=a.horizonLineFromTop(!1),k=new We(h,Math.max(w,m));return a.rayIntersectionCoordinate(a.pointRayIntersection(k,x))}pointCoordinate3D(a,h,m){const x=new We(h,m);if(a.elevation)return a.elevation.pointCoordinate(x);{const w=this.pointCoordinate(a,x.x,x.y,0);return[w.x,w.y,w.z]}}isPointAboveHorizon(a,h){if(a.elevation)return!this.pointCoordinate3D(a,h.x,h.y);const m=a.horizonLineFromTop();return h.y<m}createInversionMatrix(a,h){return WH}createTileMatrix(a,h,m){let x,w,k;const A=m.canonical,N=_c(new Float64Array(16));if(this.isReprojectedInTileSpace){const z=a1(A,this);x=1,w=z.x+m.wrap*z.scale,k=z.y,Ff(N,N,[x/z.scale,x/z.scale,a.pixelsPerMeter/h])}else x=h/a.zoomScale(A.z),w=(A.x+Math.pow(2,A.z)*m.wrap)*x,k=A.y*x;return cg(N,N,[w,k,0]),Ff(N,N,[x/Yr,x/Yr,1]),N}upVector(a,h,m){return[0,0,1]}upVectorScale(a,h,m){return{metersToTile:1}}}class qH extends W0{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[h,m]=this.parallels=a.parallels||[29.5,45.5],x=Math.sin(qe(h));this.n=(x+Math.sin(qe(m)))/2,this.c=1+x*(2*this.n-x),this.r0=Math.sqrt(this.c)/this.n}project(a,h){const{n:m,c:x,r0:w}=this,k=qe(a-this.center[0]),A=qe(h),N=Math.sqrt(x-2*m*Math.sin(A))/m;return{x:N*Math.sin(k*m),y:N*Math.cos(k*m)-w,z:0}}unproject(a,h){const{n:m,c:x,r0:w}=this,k=w+h;let A=Math.atan2(a,Math.abs(k))*Math.sign(k);k*m<0&&(A-=Math.PI*Math.sign(a)*Math.sign(k));const N=qe(this.center[0])*m;A=Je(A,-Math.PI-N,Math.PI-N);const z=Ce(et(A/m)+this.center[0],-180,180),V=Math.asin(Ce((x-(a*a+k*k)*m*m)/(2*m),-1,1)),X=Ce(et(V),-co,co);return new ms(z,X)}}const tw=1.340264,nw=-.081106,rw=893e-6,iw=.003796,x4=Math.sqrt(3)/2;class $H extends W0{project(a,h){h=h/180*Math.PI,a=a/180*Math.PI;const m=Math.asin(x4*Math.sin(h)),x=m*m,w=x*x*x;return{x:.5*(a*Math.cos(m)/(x4*(tw+3*nw*x+w*(7*rw+9*iw*x)))/Math.PI+.5),y:1-.5*(m*(tw+nw*x+w*(rw+iw*x))/Math.PI+1),z:0}}unproject(a,h){a=(2*a-.5)*Math.PI;let m=h=(2*(1-h)-1)*Math.PI,x=m*m,w=x*x*x;for(let V,X,ee,ae=0;ae<12&&(X=m*(tw+nw*x+w*(rw+iw*x))-h,ee=tw+3*nw*x+w*(7*rw+9*iw*x),V=X/ee,m=Ce(m-V,-Math.PI/3,Math.PI/3),x=m*m,w=x*x*x,!(Math.abs(V)<1e-12));++ae);const k=x4*a*(tw+3*nw*x+w*(7*rw+9*iw*x))/Math.cos(m),A=Math.asin(Math.sin(m)/x4),N=Ce(180*k/Math.PI,-180,180),z=Ce(180*A/Math.PI,-co,co);return new ms(N,z)}}class XH extends W0{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,h){return{x:.5+a/360,y:.5-h/360,z:0}}unproject(a,h){const m=360*(a-.5),x=Ce(360*(.5-h),-co,co);return new ms(m,x)}}const _x=Math.PI/2;function b4(c){return Math.tan((_x+c)/2)}class ZH extends W0{constructor(a){super(a),this.center=a.center||[0,30];const[h,m]=this.parallels=a.parallels||[30,30];let x=qe(h),w=qe(m);this.southernCenter=x+w<0,this.southernCenter&&(x=-x,w=-w);const k=Math.cos(x),A=b4(x);this.n=x===w?Math.sin(x):Math.log(k/Math.cos(w))/Math.log(b4(w)/A),this.f=k*Math.pow(b4(x),this.n)/this.n}project(a,h){h=qe(h),this.southernCenter&&(h=-h),a=qe(a-this.center[0]);const m=1e-6,{n:x,f:w}=this;w>0?h<-_x+m&&(h=-_x+m):h>_x-m&&(h=_x-m);const k=w/Math.pow(b4(h),x);let A=k*Math.sin(x*a),N=w-k*Math.cos(x*a);return A=.5*(A/Math.PI+.5),N=.5*(N/Math.PI+.5),{x:A,y:this.southernCenter?N:1-N,z:0}}unproject(a,h){a=(2*a-.5)*Math.PI,this.southernCenter&&(h=1-h),h=(2*(1-h)-.5)*Math.PI;const{n:m,f:x}=this,w=x-h,k=Math.sign(w),A=Math.sign(m)*Math.sqrt(a*a+w*w);let N=Math.atan2(a,Math.abs(w))*k;w*m<0&&(N-=Math.PI*Math.sign(a)*k);const z=Ce(et(N/m)+this.center[0],-180,180),V=Ce(et(2*Math.atan(Math.pow(x/A,1/m))-_x),-co,co);return new ms(z,this.southernCenter?-V:V)}}class MA extends W0{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,h){return{x:Xu(a),y:Pd(h),z:0}}unproject(a,h){const m=Su(a),x=sl(h);return new ms(m,x)}}const kA=qe(co);class YH extends W0{project(a,h){const m=(h=qe(h))*h,x=m*m;return{x:.5*((a=qe(a))*(.8707-.131979*m+x*(x*(.003971*m-.001529*x)-.013791))/Math.PI+.5),y:1-.5*(h*(1.007226+m*(.015085+x*(.028874*m-.044475-.005916*x)))/Math.PI+1),z:0}}unproject(a,h){a=(2*a-.5)*Math.PI;let m=h=(2*(1-h)-1)*Math.PI,x=25,w=0,k=m*m;do{k=m*m;const z=k*k;w=(m*(1.007226+k*(.015085+z*(.028874*k-.044475-.005916*z)))-h)/(1.007226+k*(.045255+z*(.259866*k-.311325-.005916*11*z))),m=Ce(m-w,-kA,kA)}while(Math.abs(w)>1e-6&&--x>0);k=m*m;const A=Ce(et(a/(.8707+k*(k*(k*k*k*(.003971-.001529*k)-.013791)-.131979))),-180,180),N=et(m);return new ms(A,N)}}const CA=qe(co);class KH extends W0{project(a,h){h=qe(h),a=qe(a);const m=Math.cos(h),x=2/Math.PI,w=Math.acos(m*Math.cos(a/2)),k=Math.sin(w)/w,A=.5*(a*x+2*m*Math.sin(a/2)/k)||0,N=.5*(h+Math.sin(h)/k)||0;return{x:.5*(A/Math.PI+.5),y:1-.5*(N/Math.PI+1),z:0}}unproject(a,h){let m=a=(2*a-.5)*Math.PI,x=h=(2*(1-h)-1)*Math.PI,w=25;const k=1e-6;let A=0,N=0;do{const z=Math.cos(x),V=Math.sin(x),X=2*V*z,ee=V*V,ae=z*z,he=Math.cos(m/2),Te=Math.sin(m/2),Oe=2*he*Te,Ze=Te*Te,yt=1-ae*he*he,Ke=yt?1/yt:0,pt=yt?Math.acos(z*he)*Math.sqrt(1/yt):0,Et=.5*(2*pt*z*Te+2*m/Math.PI)-a,wt=.5*(pt*V+x)-h,Kt=.5*Ke*(ae*Ze+pt*z*he*ee)+1/Math.PI,Xt=Ke*(Oe*X/4-pt*V*Te),bn=.125*Ke*(X*Te-pt*V*ae*Oe),Jn=.5*Ke*(ee*he+pt*Ze*z)+.5,on=Xt*bn-Jn*Kt;A=(wt*Xt-Et*Jn)/on,N=(Et*bn-wt*Kt)/on,m=Ce(m-A,-Math.PI,Math.PI),x=Ce(x-N,-CA,CA)}while((Math.abs(A)>k||Math.abs(N)>k)&&--w>0);return new ms(et(m),et(x))}}class IA extends W0{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(qe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,h){const{scale:m,cosPhi:x}=this;return{x:qe(a)*x*m+.5,y:-Math.sin(qe(h))/x*m+.5,z:0}}unproject(a,h){const{scale:m,cosPhi:x}=this,w=-(h-.5)/m,k=Ce(et((a-.5)/m)/x,-180,180),A=Math.asin(Ce(w*x,-1,1)),N=Ce(et(A),-co,co);return new ms(k,N)}}class JH extends MA{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,h,m){const x=yg(a,h,m);return Ho(x,x,V_(Kc(m))),{x:x[0],y:x[1],z:x[2]}}locationPoint(a,h){const m=Yp(h.lat,h.lng),x=su([],m),w=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(h),a._centerAltitude):a._centerAltitude;Bf(m,m,x,Hl(1,0)*Yr*w);const k=_c(new Float64Array(16));return Of(k,a.pixelMatrix,a.globeMatrix),Ho(m,m,k),new We(m[0],m[1])}pixelsPerMeter(a,h){return Hl(1,0)*h}pixelSpaceConversion(a,h,m){const x=Hl(1,a)*h,w=Yi(Hl(1,45)*h,x,m);return this.pixelsPerMeter(a,h)/w}createTileMatrix(a,h,m){const x=wo(Kc(m.canonical));return Of(new Float64Array(16),a.globeMatrix,x)}createInversionMatrix(a,h){const{center:m}=a,x=V_(Kc(h));return R_(x,x,qe(m.lng)),P_(x,x,qe(m.lat)),Ff(x,x,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(x)}pointCoordinate(a,h,m,x){return gg(a,h,m,!0)||new Rd(0,0)}pointCoordinate3D(a,h,m){const x=this.pointCoordinate(a,h,m,0);return[x.x,x.y,x.z]}isPointAboveHorizon(a,h){return!gg(a,h.x,h.y,!1)}farthestPixelDistance(a){const h=function(x,w){const k=x.cameraToCenterDistance,A=x._centerAltitude*w,N=x._camera,z=x._camera.forward(),V=Ph([],Ja([],z,-k),[0,0,A]),X=x.worldSize/(2*Math.PI),ee=[0,0,-X],ae=x.width/x.height,he=Math.tan(x.fovAboveCenter),Te=Ja([],N.up(),he),Oe=Ja([],N.right(),he*ae),Ze=su([],Ph([],Ph([],z,Te),Oe)),yt=[];let Ke;if(new Yc(V,Ze).closestPointOnSphere(ee,X,yt)){const pt=Ph([],yt,ee),Et=Rh([],pt,V);Ke=Math.cos(x.fovAboveCenter)*R0(Et)}else{const pt=Rh([],V,ee),Et=Rh([],ee,V);su(Et,Et);const wt=R0(pt)-X;Ke=Math.sqrt(wt*(wt+2*X));const Kt=Math.acos(Ke/(X+wt))-Math.acos(Zc(z,Et));Ke*=Math.cos(Kt)}return 1.01*Ke}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),m=_g(a.zoom);if(m>0){const x=TA(a,Hl(1,a.center.lat)*a.worldSize),w=a.worldSize/(2*Math.PI),k=Math.max(a.width,a.height)/a.worldSize*Math.PI;return Yi(h,x+w*(1-Math.cos(k)),Math.pow(m,10))}return h}upVector(a,h,m){return yg(h,m,a,1)}upVectorScale(a){return{metersToTile:mg(U0(Kc(a)))}}}function AA(c){const a=c.parallels,h=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new MA(c);case"equirectangular":return new XH(c);case"naturalEarth":return new YH(c);case"equalEarth":return new $H(c);case"winkelTripel":return new KH(c);case"albers":return h?new IA(c):new qH(c);case"lambertConformalConic":return h?new IA(c):new ZH(c);case"globe":return new JH(c)}throw new Error(`Invalid projection name: ${c.name}`)}const QH=n1.types,eW=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w4(c,a,h,m,x,w,k,A,N,z,V,X,ee){const ae=A?Math.min(H0,Math.round(A[0])):0,he=A?Math.min(H0,Math.round(A[1])):0;c.emplaceBack(a,h,Math.round(32*m),Math.round(32*x),w,k,(ae<<1)+(N?1:0),he,16*z,16*V,256*X,256*ee)}function E4(c,a,h,m,x,w,k){c.emplaceBack(a,h,m,x,w,k)}function S4(c,a,h,m,x){c.emplaceBack(a,h,m,x),c.emplaceBack(a,h,m,x),c.emplaceBack(a,h,m,x),c.emplaceBack(a,h,m,x)}function tW(c){for(const a of c.sections)if(S_(a.text))return!0;return!1}class n6{constructor(a){this.layoutVertexArray=new kn,this.indexArray=new Hr,this.programConfigurations=a,this.segments=new Co,this.dynamicLayoutVertexArray=new Gn,this.opacityVertexArray=new Ur,this.placedSymbolArray=new Go,this.globeExtVertexArray=new Yn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,m,x){this.isEmpty()||(m&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,si.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,yi.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,eW,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,gi.members,!0)),this.opacityVertexBuffer.itemSize=1),(m||x)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ir(n6,"SymbolBuffers");class r6{constructor(a,h,m){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new m,this.segments=new Co,this.collisionVertexArray=new ki,this.collisionVertexArrayExt=new Ci}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,sr.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,xt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ir(r6,"CollisionBuffers");class q0{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(k=>k.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_c([]),this.placementViewportMatrix=_c([]);const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yr(this.zoom,h["text-size"]),this.iconSizeData=yr(this.zoom,h["icon-size"]);const m=this.layers[0].layout,x=m.get("symbol-sort-key"),w=m.get("symbol-z-order");this.canOverlap=m.get("text-allow-overlap")||m.get("icon-allow-overlap")||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&x.constantOr(1)!==void 0,this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=m.get("text-writing-mode").map(k=>ft[k]),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new n6(new qp(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new n6(new qp(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new iu,this.lineVertexArray=new ag,this.symbolInstances=new Ys}calculateGlyphDependencies(a,h,m,x,w){for(let k=0;k<a.length;k++)if(h[a.charCodeAt(k)]=!0,x&&w){const A=Un[a.charAt(k)];A&&(h[A.charCodeAt(0)]=!0)}}populate(a,h,m,x){const w=this.layers[0],k=w.layout,A=this.projection.name==="globe",N=k.get("text-font"),z=k.get("text-field"),V=k.get("icon-image"),X=(z.value.kind!=="constant"||z.value.value instanceof un&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),ee=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,ae=k.get("symbol-sort-key");if(this.features=[],!X&&!ee)return;const he=h.iconDependencies,Te=h.glyphDependencies,Oe=h.availableImages,Ze=new q(this.zoom);for(const{feature:yt,id:Ke,index:pt,sourceLayerIndex:Et}of a){const wt=w._featureFilter.needGeometry,Kt=Kp(yt,wt);if(!w._featureFilter.filter(Ze,Kt,m))continue;if(wt||(Kt.geometry=Dh(yt,m,x)),A&&yt.type!==1&&m.z<=5){const on=Kt.geometry,An=.98078528056,Ln=($n,tr)=>Zc(yg($n.x,$n.y,m,1),yg(tr.x,tr.y,m,1))<An;for(let $n=0;$n<on.length;$n++)on[$n]=V9(on[$n],Ln)}let Xt,bn;if(X){const on=w.getValueAndResolveTokens("text-field",Kt,m,Oe),An=un.factory(on);tW(An)&&(this.hasRTLText=!0),(!this.hasRTLText||L()==="unavailable"||this.hasRTLText&&U.isParsed())&&(Xt=an(An,w,Kt))}if(ee){const on=w.getValueAndResolveTokens("icon-image",Kt,m,Oe);bn=on instanceof cr?on:cr.fromString(on)}if(!Xt&&!bn)continue;const Jn=this.sortFeaturesByKey?ae.evaluate(Kt,{},m):void 0;if(this.features.push({id:Ke,text:Xt,icon:bn,index:pt,sourceLayerIndex:Et,geometry:Kt.geometry,properties:yt.properties,type:QH[yt.type],sortKey:Jn}),bn&&(he[bn.name]=!0),Xt){const on=N.evaluate(Kt,{},m).join(","),An=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ft.vertical)>=0;for(const Ln of Xt.sections)if(Ln.image)he[Ln.image.name]=!0;else{const $n=Md(Xt.toString()),tr=Ln.fontStack||on,_n=Te[tr]=Te[tr]||{};this.calculateGlyphDependencies(Ln.text,_n,An,this.allowVerticalPlacement,$n)}}}k.get("symbol-placement")==="line"&&(this.features=function(yt){const Ke={},pt={},Et=[];let wt=0;function Kt(on){Et.push(yt[on]),wt++}function Xt(on,An,Ln){const $n=pt[on];return delete pt[on],pt[An]=$n,Et[$n].geometry[0].pop(),Et[$n].geometry[0]=Et[$n].geometry[0].concat(Ln[0]),$n}function bn(on,An,Ln){const $n=Ke[An];return delete Ke[An],Ke[on]=$n,Et[$n].geometry[0].shift(),Et[$n].geometry[0]=Ln[0].concat(Et[$n].geometry[0]),$n}function Jn(on,An,Ln){const $n=Ln?An[0][An[0].length-1]:An[0][0];return`${on}:${$n.x}:${$n.y}`}for(let on=0;on<yt.length;on++){const An=yt[on],Ln=An.geometry,$n=An.text?An.text.toString():null;if(!$n){Kt(on);continue}const tr=Jn($n,Ln),_n=Jn($n,Ln,!0);if(tr in pt&&_n in Ke&&pt[tr]!==Ke[_n]){const _r=bn(tr,_n,Ln),Rr=Xt(tr,_n,Et[_r].geometry);delete Ke[tr],delete pt[_n],pt[Jn($n,Et[Rr].geometry,!0)]=Rr,Et[_r].geometry=null}else tr in pt?Xt(tr,_n,Ln):_n in Ke?bn(tr,_n,Ln):(Kt(on),Ke[tr]=wt-1,pt[_n]=wt-1)}return Et.filter(on=>on.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((yt,Ke)=>yt.sortKey-Ke.sortKey)}update(a,h,m,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,m,x),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,m,x))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=AA(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){const m=this.lineVertexArray.length;if(a.segment!==void 0)for(const{x,y:w}of h)this.lineVertexArray.emplaceBack(x,w);return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(a,h,m,x,w,k,A,N,z,V,X,ee,ae,he){const Te=a.indexArray,Oe=a.layoutVertexArray,Ze=a.globeExtVertexArray,yt=a.segments.prepareSegment(4*h.length,Oe,Te,this.canOverlap?k.sortKey:void 0),Ke=this.glyphOffsetArray.length,pt=yt.vertexLength,Et=this.allowVerticalPlacement&&A===ft.vertical?Math.PI/2:0,wt=k.text&&k.text.sections;for(let Xt=0;Xt<h.length;Xt++){const{tl:bn,tr:Jn,bl:on,br:An,tex:Ln,pixelOffsetTL:$n,pixelOffsetBR:tr,minFontScaleX:_n,minFontScaleY:_r,glyphOffset:Rr,isSDF:xr,sectionIndex:Pi}=h[Xt],nr=yt.vertexLength,Qr=Rr[1];if(w4(Oe,z.x,z.y,bn.x,Qr+bn.y,Ln.x,Ln.y,m,xr,$n.x,$n.y,_n,_r),w4(Oe,z.x,z.y,Jn.x,Qr+Jn.y,Ln.x+Ln.w,Ln.y,m,xr,tr.x,$n.y,_n,_r),w4(Oe,z.x,z.y,on.x,Qr+on.y,Ln.x,Ln.y+Ln.h,m,xr,$n.x,tr.y,_n,_r),w4(Oe,z.x,z.y,An.x,Qr+An.y,Ln.x+Ln.w,Ln.y+Ln.h,m,xr,tr.x,tr.y,_n,_r),N){const{x:Ri,y:Es,z:Ni}=N.anchor,[ai,fo,zi]=N.up;E4(Ze,Ri,Es,Ni,ai,fo,zi),E4(Ze,Ri,Es,Ni,ai,fo,zi),E4(Ze,Ri,Es,Ni,ai,fo,zi),E4(Ze,Ri,Es,Ni,ai,fo,zi),S4(a.dynamicLayoutVertexArray,Ri,Es,Ni,Et)}else S4(a.dynamicLayoutVertexArray,z.x,z.y,z.z,Et);Te.emplaceBack(nr,nr+1,nr+2),Te.emplaceBack(nr+1,nr+2,nr+3),yt.vertexLength+=4,yt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rr[0]),Xt!==h.length-1&&Pi===h[Xt+1].sectionIndex||a.programConfigurations.populatePaintArrays(Oe.length,k,k.index,{},ae,he,wt&&wt[Pi])}const Kt=N?N.anchor:z;a.placedSymbolArray.emplaceBack(Kt.x,Kt.y,Kt.z,z.x,z.y,Ke,this.glyphOffsetArray.length-Ke,pt,V,X,z.segment,m?m[0]:0,m?m[1]:0,x[0],x[1],A,0,!1,0,ee,0)}_commitLayoutVertex(a,h,m,x,w,k,A){a.emplaceBack(h,m,x,w,k,Math.round(A.x),Math.round(A.y))}_addCollisionDebugVertices(a,h,m,x,w,k,A){const N=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),z=N.vertexLength,V=A.tileAnchorX,X=A.tileAnchorY;for(let ae=0;ae<4;ae++)m.collisionVertexArray.emplaceBack(0,0,0,0);m.collisionVertexArrayExt.emplaceBack(h,-a.padding,-a.padding),m.collisionVertexArrayExt.emplaceBack(h,a.padding,-a.padding),m.collisionVertexArrayExt.emplaceBack(h,a.padding,a.padding),m.collisionVertexArrayExt.emplaceBack(h,-a.padding,a.padding),this._commitLayoutVertex(m.layoutVertexArray,x,w,k,V,X,new We(a.x1,a.y1)),this._commitLayoutVertex(m.layoutVertexArray,x,w,k,V,X,new We(a.x2,a.y1)),this._commitLayoutVertex(m.layoutVertexArray,x,w,k,V,X,new We(a.x2,a.y2)),this._commitLayoutVertex(m.layoutVertexArray,x,w,k,V,X,new We(a.x1,a.y2)),N.vertexLength+=4;const ee=m.indexArray;ee.emplaceBack(z,z+1),ee.emplaceBack(z+1,z+2),ee.emplaceBack(z+2,z+3),ee.emplaceBack(z+3,z),N.primitiveLength+=4}_addTextDebugCollisionBoxes(a,h,m,x,w,k){for(let A=x;A<w;A++){const N=m.get(A),z=this.getSymbolInstanceTextSize(a,k,h,A);this._addCollisionDebugVertices(N,z,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,k)}}_addIconDebugCollisionBoxes(a,h,m,x,w,k){for(let A=x;A<w;A++){const N=m.get(A),z=this.getSymbolInstanceIconSize(a,h,k.placedIconSymbolIndex);this._addCollisionDebugVertices(N,z,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,k)}}generateCollisionDebugBuffers(a,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new r6(Mr,Pt.members,Ra),this.iconCollisionBox=new r6(Mr,Pt.members,Ra);const m=hn(this.iconSizeData,a),x=hn(this.textSizeData,a);for(let w=0;w<this.symbolInstances.length;w++){const k=this.symbolInstances.get(w);this._addTextDebugCollisionBoxes(x,a,h,k.textBoxStartIndex,k.textBoxEndIndex,k),this._addTextDebugCollisionBoxes(x,a,h,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k),this._addIconDebugCollisionBoxes(m,a,h,k.iconBoxStartIndex,k.iconBoxEndIndex,k),this._addIconDebugCollisionBoxes(m,a,h,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k)}}getSymbolInstanceTextSize(a,h,m,x){const w=this.text.placedSymbolArray.get(h.rightJustifiedTextSymbolIndex>=0?h.rightJustifiedTextSymbolIndex:h.centerJustifiedTextSymbolIndex>=0?h.centerJustifiedTextSymbolIndex:h.leftJustifiedTextSymbolIndex>=0?h.leftJustifiedTextSymbolIndex:h.verticalPlacedTextSymbolIndex>=0?h.verticalPlacedTextSymbolIndex:x),k=dr(this.textSizeData,a,w)/ln;return this.tilePixelRatio*k}getSymbolInstanceIconSize(a,h,m){const x=this.icon.placedSymbolArray.get(m),w=dr(this.iconSizeData,a,x);return this.tilePixelRatio*w}_commitDebugCollisionVertexUpdate(a,h,m){a.emplaceBack(h,-m,-m),a.emplaceBack(h,m,-m),a.emplaceBack(h,m,m),a.emplaceBack(h,-m,m)}_updateTextDebugCollisionBoxes(a,h,m,x,w,k){for(let A=x;A<w;A++){const N=m.get(A),z=this.getSymbolInstanceTextSize(a,k,h,A);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,z,N.padding)}}_updateIconDebugCollisionBoxes(a,h,m,x,w,k){for(let A=x;A<w;A++){const N=m.get(A),z=this.getSymbolInstanceIconSize(a,h,k);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,z,N.padding)}}updateCollisionDebugBuffers(a,h){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=hn(this.iconSizeData,a),x=hn(this.textSizeData,a);for(let w=0;w<this.symbolInstances.length;w++){const k=this.symbolInstances.get(w);this._updateTextDebugCollisionBoxes(x,a,h,k.textBoxStartIndex,k.textBoxEndIndex,k),this._updateTextDebugCollisionBoxes(x,a,h,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k),this._updateIconDebugCollisionBoxes(m,a,h,k.iconBoxStartIndex,k.iconBoxEndIndex,k.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(m,a,h,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,h,m,x,w,k,A,N,z){const V={};if(h<m){const{x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt,featureIndex:Et}=a.get(h);V.textBox={x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt},V.textFeatureIndex=Et}if(x<w){const{x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt,featureIndex:Et}=a.get(x);V.verticalTextBox={x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt},V.verticalTextFeatureIndex=Et}if(k<A){const{x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt,featureIndex:Et}=a.get(k);V.iconBox={x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt},V.iconFeatureIndex=Et}if(N<z){const{x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt,featureIndex:Et}=a.get(N);V.verticalIconBox={x1:X,y1:ee,x2:ae,y2:he,padding:Te,projectedAnchorX:Oe,projectedAnchorY:Ze,projectedAnchorZ:yt,tileAnchorX:Ke,tileAnchorY:pt},V.verticalIconFeatureIndex=Et}return V}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){const m=a.placedSymbolArray.get(h),x=m.vertexStartIndex+4*m.numGlyphs;for(let w=m.vertexStartIndex;w<x;w+=4)a.indexArray.emplaceBack(w,w+1,w+2),a.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(a),m=Math.cos(a),x=[],w=[],k=[];for(let A=0;A<this.symbolInstances.length;++A){k.push(A);const N=this.symbolInstances.get(A);x.push(0|Math.round(h*N.tileAnchorX+m*N.tileAnchorY)),w.push(N.featureIndex)}return k.sort((A,N)=>x[A]-x[N]||w[N]-w[A]),k}addToSortKeyRanges(a,h){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===h?m.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const m=this.symbolInstances.get(h);this.featureSortOrder.push(m.featureIndex);const{rightJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:w,leftJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:A,placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:z}=m;x>=0&&this.addIndicesForPlacedSymbol(this.text,x),w>=0&&w!==x&&this.addIndicesForPlacedSymbol(this.text,w),k>=0&&k!==w&&k!==x&&this.addIndicesForPlacedSymbol(this.text,k),A>=0&&this.addIndicesForPlacedSymbol(this.text,A),N>=0&&this.addIndicesForPlacedSymbol(this.icon,N),z>=0&&this.addIndicesForPlacedSymbol(this.icon,z)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ir(q0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),q0.MAX_GLYPHS=65535,q0.addDynamicAttributes=S4;const nW=new lt({"symbol-placement":new Ee(Nt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ee(Nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ee(Nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ue(Nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ee(Nt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ee(Nt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ee(Nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ee(Nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ee(Nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ue(Nt.layout_symbol["icon-size"]),"icon-text-fit":new Ee(Nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ee(Nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ue(Nt.layout_symbol["icon-image"]),"icon-rotate":new Ue(Nt.layout_symbol["icon-rotate"]),"icon-padding":new Ee(Nt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ee(Nt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ue(Nt.layout_symbol["icon-offset"]),"icon-anchor":new Ue(Nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ee(Nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ee(Nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ee(Nt.layout_symbol["text-rotation-alignment"]),"text-field":new Ue(Nt.layout_symbol["text-field"]),"text-font":new Ue(Nt.layout_symbol["text-font"]),"text-size":new Ue(Nt.layout_symbol["text-size"]),"text-max-width":new Ue(Nt.layout_symbol["text-max-width"]),"text-line-height":new Ue(Nt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ue(Nt.layout_symbol["text-letter-spacing"]),"text-justify":new Ue(Nt.layout_symbol["text-justify"]),"text-radial-offset":new Ue(Nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ee(Nt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ue(Nt.layout_symbol["text-anchor"]),"text-max-angle":new Ee(Nt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ee(Nt.layout_symbol["text-writing-mode"]),"text-rotate":new Ue(Nt.layout_symbol["text-rotate"]),"text-padding":new Ee(Nt.layout_symbol["text-padding"]),"text-keep-upright":new Ee(Nt.layout_symbol["text-keep-upright"]),"text-transform":new Ue(Nt.layout_symbol["text-transform"]),"text-offset":new Ue(Nt.layout_symbol["text-offset"]),"text-allow-overlap":new Ee(Nt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ee(Nt.layout_symbol["text-ignore-placement"]),"text-optional":new Ee(Nt.layout_symbol["text-optional"])});var i6={paint:new lt({"icon-opacity":new Ue(Nt.paint_symbol["icon-opacity"]),"icon-color":new Ue(Nt.paint_symbol["icon-color"]),"icon-halo-color":new Ue(Nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ue(Nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ue(Nt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ee(Nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ee(Nt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ue(Nt.paint_symbol["text-opacity"]),"text-color":new Ue(Nt.paint_symbol["text-color"],{runtimeType:ys,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Ue(Nt.paint_symbol["text-halo-color"]),"text-halo-width":new Ue(Nt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ue(Nt.paint_symbol["text-halo-blur"]),"text-translate":new Ee(Nt.paint_symbol["text-translate"]),"text-translate-anchor":new Ee(Nt.paint_symbol["text-translate-anchor"])}),layout:nW};class LA{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:hc,this.defaultValue=a}evaluate(a){if(a.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ir(LA,"FormatSectionOverride",{omit:["defaultValue"]});class T4 extends Ka{constructor(a){super(a,i6)}recalculate(a,h){super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const m=this.layout.get("text-writing-mode");if(m){const x=[];for(const w of m)x.indexOf(w)<0&&x.push(w);this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,h,m,x){const w=this.layout.get(a).evaluate(h,{},m,x),k=this._unevaluatedLayout._values[a];return k.isDataDriven()||kf(k.value)||!w?w:function(A,N){return N.replace(/{([^{}]+)}/g,(z,V)=>V in A?String(A[V]):"")}(h.properties,w)}createBucket(a){return new q0(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of i6.paint.overridableProperties){if(!T4.hasPaintOverride(this.layout,a))continue;const h=this.paint.get(a),m=new LA(h),x=new zp(m,h.property.specification);let w=null;w=h.value.kind==="constant"||h.value.kind==="source"?new f_("source",x):new Up("composite",x,h.value.zoomStops,h.value._interpolationType),this.paint._values[a]=new Ge(h.property,w,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,m){return!(!this.layout||h.isDataDriven()||m.isDataDriven())&&T4.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){const m=a.get("text-field"),x=i6.paint.properties[h];let w=!1;const k=A=>{for(const N of A)if(x.overrides&&x.overrides.hasOverride(N))return void(w=!0)};if(m.value.kind==="constant"&&m.value.value instanceof un)k(m.value.value.sections);else if(m.value.kind==="source"){const A=z=>{w||(z instanceof ei&&cn(z.value)===ve?k(z.value.sections):z instanceof es?k(z.sections):z.eachChild(A))},N=m.value;N._styleExpression&&A(N._styleExpression.expression)}return w}getProgramConfiguration(a){return new Nf(this,a)}}var rW={paint:new lt({"background-color":new Ee(Nt.paint_background["background-color"]),"background-pattern":new Ee(Nt.paint_background["background-pattern"]),"background-opacity":new Ee(Nt.paint_background["background-opacity"])})},iW={paint:new lt({"raster-opacity":new Ee(Nt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ee(Nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ee(Nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ee(Nt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ee(Nt.paint_raster["raster-saturation"]),"raster-contrast":new Ee(Nt.paint_raster["raster-contrast"]),"raster-resampling":new Ee(Nt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ee(Nt.paint_raster["raster-fade-duration"])})};class sW extends Ka{constructor(a){super(a,{}),this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var oW={paint:new lt({"sky-type":new Ee(Nt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ee(Nt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ee(Nt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ee(Nt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ee(Nt.paint_sky["sky-gradient-radius"]),"sky-gradient":new it(Nt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ee(Nt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ee(Nt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ee(Nt.paint_sky["sky-opacity"])})};function s6(c,a,h){const m=[0,0,1],x=L3([]);return B_(x,x,h?-qe(c)+Math.PI:qe(c)),z_(x,x,-qe(a)),B9(m,m,x),su(m,m)}const aW={circle:class extends Ka{constructor(c){super(c,GM)}createBucket(c){return new W_(c)}queryRadius(c){const a=c;return Nd("circle-radius",this,a)+Nd("circle-stroke-width",this,a)+Z_(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,h,m,x,w,k,A){const N=Zv(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,c.pixelToTileUnitsFactor),z=this.paint.get("circle-radius").evaluate(a,h)+this.paint.get("circle-stroke-width").evaluate(a,h);return G3(c,m,w,k,A,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",N,z)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new Nf(this,c)}},heatmap:class extends Ka{createBucket(c){return new $9(c)}constructor(c){super(c,X9),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Nd("heatmap-radius",this,c)}queryIntersectsFeature(c,a,h,m,x,w,k,A){const N=this.paint.get("heatmap-radius").evaluate(a,h);return G3(c,m,w,k,A,!0,!0,new We(0,0),N)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new Nf(this,c)}},hillshade:class extends Ka{constructor(c){super(c,Z9)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ka{constructor(c){super(c,Z3)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),h=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&h.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),h}getProgramConfiguration(c){return new Nf(this,c)}recalculate(c,a){super.recalculate(c,a);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new Fh(c)}queryRadius(){return Z_(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,h,m,x,w){return!c.queryGeometry.isAboveHorizon&&U3(Y_(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,c.pixelToTileUnitsFactor),m)}isTileClipped(){return!0}},"fill-extrusion":class extends Ka{constructor(c){super(c,K)}createBucket(c){return new y(c)}queryRadius(){return Z_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new Nf(this,c)}queryIntersectsFeature(c,a,h,m,x,w,k,A,N){const z=Zv(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,c.pixelToTileUnitsFactor),V=this.paint.get("fill-extrusion-height").evaluate(a,h),X=this.paint.get("fill-extrusion-base").evaluate(a,h),ee=[0,0],ae=A&&w.elevation,he=w.elevation?w.elevation.exaggeration():1,Te=c.tile.getBucket(this);if(ae&&Te instanceof y){const pt=Te.centroidVertexArray,Et=N+1;Et<pt.length&&(ee[0]=pt.geta_centroid_pos0(Et),ee[1]=pt.geta_centroid_pos1(Et))}if(ee[0]===0&&ee[1]===1)return!1;w.projection.name==="globe"&&(m=W([m],[new We(0,0),new We(Yr,Yr)],c.tileID.canonical).map(pt=>pt.polygon).flat());const Oe=ae?A:null,[Ze,yt]=function(pt,Et,wt,Kt,Xt,bn,Jn,on,An,Ln,$n){return pt.projection.name==="globe"?function(tr,_n,_r,Rr,xr,Pi,nr,Qr,Ri,Es,Ni){const ai=[],fo=[],zi=tr.projection.upVectorScale(Ni,tr.center.lat,tr.worldSize).metersToTile,Bi=[0,0,0,1],Js=[0,0,0,1],ro=(Qs,Fo,ia,Da)=>{Qs[0]=Fo,Qs[1]=ia,Qs[2]=Da,Qs[3]=1},io=G();_r>0&&(_r+=io),Rr+=io;for(const Qs of _n){const Fo=[],ia=[];for(const Da of Qs){const eo=Da.x+xr.x,Qa=Da.y+xr.y,Oa=tr.projection.projectTilePoint(eo,Qa,Ni),Wo=tr.projection.upVector(Ni,Da.x,Da.y);let Ms=_r,Fa=Rr;if(nr){const so=bt(eo,Qa,_r,Rr,nr,Qr,Ri,Es);Ms+=so.base,Fa+=so.top}_r!==0?ro(Bi,Oa.x+Wo[0]*zi*Ms,Oa.y+Wo[1]*zi*Ms,Oa.z+Wo[2]*zi*Ms):ro(Bi,Oa.x,Oa.y,Oa.z),ro(Js,Oa.x+Wo[0]*zi*Fa,Oa.y+Wo[1]*zi*Fa,Oa.z+Wo[2]*zi*Fa),Ho(Bi,Bi,Pi),Ho(Js,Js,Pi),Fo.push(new Ye(Bi[0],Bi[1],Bi[2])),ia.push(new Ye(Js[0],Js[1],Js[2]))}ai.push(Fo),fo.push(ia)}return[ai,fo]}(pt,Et,wt,Kt,Xt,bn,Jn,on,An,Ln,$n):Jn?function(tr,_n,_r,Rr,xr,Pi,nr,Qr,Ri){const Es=[],Ni=[],ai=[0,0,0,1];for(const fo of tr){const zi=[],Bi=[];for(const Js of fo){const ro=Js.x+Rr.x,io=Js.y+Rr.y,Qs=bt(ro,io,_n,_r,Pi,nr,Qr,Ri);ai[0]=ro,ai[1]=io,ai[2]=Qs.base,ai[3]=1,no(ai,ai,xr),ai[3]=Math.max(ai[3],1e-5);const Fo=new Ye(ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]);ai[0]=ro,ai[1]=io,ai[2]=Qs.top,ai[3]=1,no(ai,ai,xr),ai[3]=Math.max(ai[3],1e-5);const ia=new Ye(ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]);zi.push(Fo),Bi.push(ia)}Es.push(zi),Ni.push(Bi)}return[Es,Ni]}(Et,wt,Kt,Xt,bn,Jn,on,An,Ln):function(tr,_n,_r,Rr,xr){const Pi=[],nr=[],Qr=xr[8]*_n,Ri=xr[9]*_n,Es=xr[10]*_n,Ni=xr[11]*_n,ai=xr[8]*_r,fo=xr[9]*_r,zi=xr[10]*_r,Bi=xr[11]*_r;for(const Js of tr){const ro=[],io=[];for(const Qs of Js){const Fo=Qs.x+Rr.x,ia=Qs.y+Rr.y,Da=xr[0]*Fo+xr[4]*ia+xr[12],eo=xr[1]*Fo+xr[5]*ia+xr[13],Qa=xr[2]*Fo+xr[6]*ia+xr[14],Oa=xr[3]*Fo+xr[7]*ia+xr[15],Wo=Da+Qr,Ms=eo+Ri,Fa=Qa+Es,so=Math.max(Oa+Ni,1e-5),Yu=Da+ai,za=eo+fo,$l=Qa+zi,Ml=Math.max(Oa+Bi,1e-5);ro.push(new Ye(Wo/so,Ms/so,Fa/so)),io.push(new Ye(Yu/Ml,za/Ml,$l/Ml))}Pi.push(ro),nr.push(io)}return[Pi,nr]}(Et,wt,Kt,Xt,bn)}(w,m,X,V,z,k,Oe,ee,he,w.center.lat,c.tileID.canonical),Ke=c.queryGeometry;return function(pt,Et,wt){let Kt=1/0;U3(wt,Et)&&(Kt=_t(wt,Et[0]));for(let Xt=0;Xt<Et.length;Xt++){const bn=Et[Xt],Jn=pt[Xt];for(let on=0;on<bn.length-1;on++){const An=bn[on],Ln=[An,bn[on+1],Jn[on+1],Jn[on],An];z3(wt,Ln)&&(Kt=Math.min(Kt,_t(wt,Ln)))}}return Kt!==1/0&&Kt}(Ze,yt,Ke.isPointQuery()?Ke.screenBounds:Ke.screenGeometry)}},line:class extends Ka{constructor(c){super(c,ir),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof Rp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=Or.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new er(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new Nf(this,c)}queryRadius(c){const a=c,h=jr(Nd("line-width",this,a),Nd("line-gap-width",this,a)),m=Nd("line-offset",this,a);return h/2+Math.abs(m)+Z_(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,h,m,x,w){if(c.queryGeometry.isAboveHorizon)return!1;const k=Y_(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,c.pixelToTileUnitsFactor),A=c.pixelToTileUnitsFactor/2*jr(this.paint.get("line-width").evaluate(a,h),this.paint.get("line-gap-width").evaluate(a,h)),N=this.paint.get("line-offset").evaluate(a,h);return N&&(m=function(z,V){const X=[],ee=new We(0,0);for(let ae=0;ae<z.length;ae++){const he=z[ae],Te=[];for(let Oe=0;Oe<he.length;Oe++){const Ze=he[Oe],yt=he[Oe+1],Ke=Oe===0?ee:Ze.sub(he[Oe-1])._unit()._perp(),pt=Oe===he.length-1?ee:yt.sub(Ze)._unit()._perp(),Et=Ke._add(pt)._unit();Et._mult(1/(Et.x*pt.x+Et.y*pt.y)),Te.push(Et._mult(V)._add(Ze))}X.push(Te)}return X}(m,N*c.pixelToTileUnitsFactor)),function(z,V,X){for(let ee=0;ee<V.length;ee++){const ae=V[ee];if(z.length>=3){for(let he=0;he<ae.length;he++)if(Vf(z,ae[he]))return!0}if(q_(z,ae,X))return!0}return!1}(k,m,A)}isTileClipped(){return!0}},symbol:T4,background:class extends Ka{constructor(c){super(c,rW)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ka{constructor(c){super(c,iW)}getProgramIds(){return["raster"]}},sky:class extends Ka{constructor(c){super(c,oW),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Jv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if(this.paint.get("sky-type")==="atmosphere"){const m=this.paint.get("sky-atmosphere-sun"),x=!m,w=c.style.light,k=w.properties.get("position");return x&&w.properties.get("anchor")==="viewport"&&Be("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),x?s6(k.azimuthal,90-k.polar,a):s6(m[0],90-m[1],a)}const h=this.paint.get("sky-gradient-center");return s6(h[0],90-h[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}}};class sw{constructor(a,h,m,x){this.context=a,this.format=m,this.texture=a.gl.createTexture(),this.update(h,x)}update(a,h,m){const{width:x,height:w}=a,{context:k}=this,{gl:A}=k,{HTMLImageElement:N,HTMLCanvasElement:z,HTMLVideoElement:V,ImageData:X,ImageBitmap:ee}=E;if(A.bindTexture(A.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!h||h.premultiply!==!1)),m||this.size&&this.size[0]===x&&this.size[1]===w){const{x:ae,y:he}=m||{x:0,y:0};a instanceof N||a instanceof z||a instanceof V||a instanceof X||ee&&a instanceof ee?A.texSubImage2D(A.TEXTURE_2D,0,ae,he,A.RGBA,A.UNSIGNED_BYTE,a):A.texSubImage2D(A.TEXTURE_2D,0,ae,he,x,w,A.RGBA,A.UNSIGNED_BYTE,a.data)}else this.size=[x,w],a instanceof N||a instanceof z||a instanceof V||a instanceof X||ee&&a instanceof ee?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,a):A.texImage2D(A.TEXTURE_2D,0,this.format,x,w,0,this.format,A.UNSIGNED_BYTE,a.data);this.useMipmap=!!(h&&h.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&A.generateMipmap(A.TEXTURE_2D)}bind(a,h){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),a!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,a),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap?a===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_NEAREST:a),this.filter=a),h!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,h),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class lW{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class uW{constructor(){this.tasks={},this.taskQueue=[],Li(["process"],this),this.invoker=new lW(this.process),this.nextId=0}add(a,h){const m=this.nextId++,x=function({type:w,isSymbolTile:k,zoom:A}){return A=A||0,w==="message"?0:w!=="maybePrepare"||k?w!=="parseTile"||k?w==="parseTile"&&k?300-A:w==="maybePrepare"&&k?400-A:500:200-A:100-A}(h);if(x===0){Qe();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[m]={fn:a,metadata:h,priority:x,id:m},this.taskQueue.push(m),this.invoker.trigger(),{cancel:()=>{delete this.tasks[m]}}}process(){Qe();try{if(this.taskQueue=this.taskQueue.filter(m=>!!this.tasks[m]),!this.taskQueue.length)return;const a=this.pick();if(a===null)return;const h=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!h)return;h.fn()}finally{}}pick(){let a=null,h=1/0;for(let x=0;x<this.taskQueue.length;x++){const w=this.tasks[this.taskQueue[x]];w.priority<h&&(h=w.priority,a=x)}if(a===null)return null;const m=this.taskQueue[a];return this.taskQueue.splice(a,1),m}remove(){this.invoker.remove()}}class PA{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){const m=a[h];this._stringToNumber[m]=h,this._numberToString[h]=m}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const cW=["tile","layer","source","sourceLayer","state"];class RA{constructor(a,h,m,x,w){this.type="Feature",this._vectorTileFeature=a,this._z=h,this._x=m,this._y=x,this.properties=a.properties,this.id=w}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(a.id=this.id);for(const h of cW)this[h]!==void 0&&(a[h]=this[h]);return a}}const Fd=32,rm=33,$0=new Uint16Array(8184);for(let c=0;c<2046;c++){let a=c+2,h=0,m=0,x=0,w=0,k=0,A=0;for(1&a?x=w=k=Fd:h=m=A=Fd;(a>>=1)>1;){const z=h+x>>1,V=m+w>>1;1&a?(x=h,w=m,h=k,m=A):(h=x,m=w,x=k,w=A),k=z,A=V}const N=4*c;$0[N+0]=h,$0[N+1]=m,$0[N+2]=x,$0[N+3]=w}const im=new Uint16Array(2178),X0=new Uint8Array(1089),M4=new Uint16Array(1089);function NA(c){return c===0?-.03125:c===32?.03125:0}var DA=Bt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const OA={type:2,extent:Yr,loadGeometry:()=>[[new We(0,0),new We(Yr+1,0),new We(Yr+1,Yr+1),new We(0,Yr+1),new We(0,0)]]};class o6{constructor(a,h,m,x,w){this.tileID=a,this.uid=Nn(),this.uses=0,this.tileSize=h,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(a){const h=a+this.timeAdded;h<bo.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a1(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,h,m){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(x,w){const k={};if(!w)return k;for(const A of x){const N=A.layerIds.map(z=>w.getLayer(z)).filter(Boolean);if(N.length!==0){A.layers=N,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(z=>N.filter(V=>V.id===z)[0]));for(const z of N)k[z.id]=A}}return k}(a.buckets,h.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const w=this.buckets[x];if(w instanceof q0){if(this.hasSymbolBuckets=!0,!m)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const w=this.buckets[x];if(w instanceof q0&&w.hasRTLText){this.hasRTLText=!0,U.isLoading()||U.isLoaded()||L()!=="deferred"||B();break}}this.queryPadding=0;for(const x in this.buckets){const w=this.buckets[x];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(x).queryRadius(w))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new Fs}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const m in this.buckets){const x=this.buckets[m];x.uploadPending()&&x.upload(a)}const h=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new sw(a,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new sw(a,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new sw(a,this.lineAtlas.image,h.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,h,m,x,w,k,A,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:x,pixelPosMatrix:A,transform:k,params:w,tileTransform:this.tileTransform},a,h,m):{}}querySourceFeatures(a,h){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const x=m.loadVTLayers(),w=h?h.sourceLayer:"",k=x._geojsonTileLayer||x[w];if(!k)return;const A=v0(h&&h.filter),{z:N,x:z,y:V}=this.tileID.canonical,X={z:N,x:z,y:V};for(let ee=0;ee<k.length;ee++){const ae=k.feature(ee);if(A.needGeometry){const Oe=Kp(ae,!0);if(!A.filter(new q(this.tileID.overscaledZ),Oe,this.tileID.canonical))continue}else if(!A.filter(new q(this.tileID.overscaledZ),ae))continue;const he=m.getId(ae,w),Te=new RA(ae,N,z,V,he);Te.tile=X,a.push(Te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const h=this.expirationTime;if(a.cacheControl){const m=gt(a.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const m=Date.now();let x=!1;if(this.expirationTime>m)x=!1;else if(h)if(this.expirationTime<h)x=!0;else{const w=this.expirationTime-h;w?this.expirationTime=m+Math.max(w,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0||!h)return;const m=this.latestFeatureIndex.loadVTLayers(),x=h.style.listImages();for(const w in this.buckets){if(!h.style.hasLayer(w))continue;const k=this.buckets[w],A=k.layers[0].sourceLayer||"_geojsonTileLayer",N=m[A],z=a[A];if(!N||!z||Object.keys(z).length===0)continue;if(k.update(z,N,x,this.imageAtlas&&this.imageAtlas.patternPositions||{}),k instanceof er||k instanceof Fh){const X=h.style._getSourceCache(k.layers[0].source);h._terrain&&h._terrain.enabled&&X&&k.programConfigurations.needsUpload&&h._terrain._clearRenderCacheForTile(X.id,this.tileID)}const V=h&&h.style&&h.style.getLayer(w);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(k)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<bo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=bo.now()+a}setTexture(a,h){const m=h.context,x=m.gl;this.texture=this.texture||h.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new sw(m,a,x.RGBA,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(a,h){const m={};for(const x of h)m[x]=!0;this.dependencies[a]=m}hasDependency(a,h){for(const m of a){const x=this.dependencies[m];if(x){for(const w of h)if(x[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const m=Dh(OA,this.tileID.canonical,this.tileTransform)[0],x=new Zn,w=new Vl;for(let k=0;k<m.length;k++){const{x:A,y:N}=m[k];x.emplaceBack(A,N),w.emplaceBack(k)}w.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(w),this._tileDebugBuffer=a.createVertexBuffer(x,dg.members),this._tileDebugSegments=Co.simpleSegment(0,0,x.length,w.length)}_makeTileBoundsBuffers(a,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const m=Dh(OA,this.tileID.canonical,this.tileTransform)[0];let x,w;if(this.isRaster){const k=function(A,N){const z=a1(A,N),V=Math.pow(2,A.z);for(let Oe=0;Oe<rm;Oe++)for(let Ze=0;Ze<rm;Ze++){const yt=Su((A.x+(Ze+NA(Ze))/Fd)/V),Ke=sl((A.y+(Oe+NA(Oe))/Fd)/V),pt=N.project(yt,Ke),Et=Oe*rm+Ze;im[2*Et+0]=Math.round((pt.x*z.scale-z.x)*Yr),im[2*Et+1]=Math.round((pt.y*z.scale-z.y)*Yr)}X0.fill(0),M4.fill(0);for(let Oe=2045;Oe>=0;Oe--){const Ze=4*Oe,yt=$0[Ze+0],Ke=$0[Ze+1],pt=$0[Ze+2],Et=$0[Ze+3],wt=yt+pt>>1,Kt=Ke+Et>>1,Xt=wt+Kt-Ke,bn=Kt+yt-wt,Jn=Ke*rm+yt,on=Et*rm+pt,An=Kt*rm+wt,Ln=Math.hypot((im[2*Jn+0]+im[2*on+0])/2-im[2*An+0],(im[2*Jn+1]+im[2*on+1])/2-im[2*An+1])>=16;X0[An]=X0[An]||(Ln?1:0),Oe<1022&&(X0[An]=X0[An]||X0[(Ke+bn>>1)*rm+(yt+Xt>>1)]||X0[(Et+bn>>1)*rm+(pt+Xt>>1)])}const X=new wn,ee=new Hr;let ae=0;function he(Oe,Ze){const yt=Ze*rm+Oe;return M4[yt]===0&&(X.emplaceBack(im[2*yt+0],im[2*yt+1],Oe*Yr/Fd,Ze*Yr/Fd),M4[yt]=++ae),M4[yt]-1}function Te(Oe,Ze,yt,Ke,pt,Et){const wt=Oe+yt>>1,Kt=Ze+Ke>>1;if(Math.abs(Oe-pt)+Math.abs(Ze-Et)>1&&X0[Kt*rm+wt])Te(pt,Et,Oe,Ze,wt,Kt),Te(yt,Ke,pt,Et,wt,Kt);else{const Xt=he(Oe,Ze),bn=he(yt,Ke),Jn=he(pt,Et);ee.emplaceBack(Xt,bn,Jn)}}return Te(0,0,Fd,Fd,Fd,0),Te(Fd,Fd,0,0,0,Fd),{vertices:X,indices:ee}}(this.tileID.canonical,h);x=k.vertices,w=k.indices}else{x=new wn,w=new Hr;for(const{x:A,y:N}of m)x.emplaceBack(A,N,0,0);const k=sx(x.int16,void 0,4);for(let A=0;A<k.length;A+=3)w.emplaceBack(k[A],k[A+1],k[A+2])}this._tileBoundsBuffer=a.createVertexBuffer(x,DA.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(w),this._tileBoundsSegments=Co.simpleSegment(0,0,x.length,w.length)}_makeGlobeTileDebugBuffers(a,h){const m=h.projection;if(!m||m.name!=="globe"||h.freezeTileCoverage)return;const x=this.tileID.canonical,w=V_(N3(x,h)),k=_g(h.zoom);let A;k>0&&(A=I0(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,x,h,w,A,k),this._makeGlobeTileDebugTextBuffer(a,x,h,w,A,k)}_globePoint(a,h,m,x,w,k,A){let N=yg(a,h,m);if(k){const z=1<<m.z,V=Xu(x.center.lng),X=Pd(x.center.lat),ee=(m.x+.5)/z-V;let ae=0;ee>.5?ae=-1:ee<-.5&&(ae=1);let he=(a/Yr+m.x)/z+ae,Te=(h/Yr+m.y)/z;he=(he-V)*x._pixelsPerMercatorPixel+V,Te=(Te-X)*x._pixelsPerMercatorPixel+X;const Oe=[he*x.worldSize,Te*x.worldSize,0];Ho(Oe,Oe,k),N=Xp(N,Oe,A)}return Ho(N,N,w)}_makeGlobeTileDebugBorderBuffer(a,h,m,x,w,k){const A=new Zn,N=new Vl,z=new zt,V=(ee,ae,he,Te,Oe)=>{const Ze=(he-ee)/(Oe-1),yt=(Te-ae)/(Oe-1),Ke=A.length;for(let pt=0;pt<Oe;pt++){const Et=ee+pt*Ze,wt=ae+pt*yt;A.emplaceBack(Et,wt);const Kt=this._globePoint(Et,wt,h,m,x,w,k);z.emplaceBack(Kt[0],Kt[1],Kt[2]),N.emplaceBack(Ke+pt)}},X=Yr;V(0,0,X,0,16),V(X,0,X,X,16),V(X,X,0,X,16),V(0,X,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(N),this._tileDebugBuffer=a.createVertexBuffer(A,dg.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(z,O0.members),this._tileDebugSegments=Co.simpleSegment(0,0,A.length,N.length)}_makeGlobeTileDebugTextBuffer(a,h,m,x,w,k){const A=Yr/4,N=new Zn,z=new Hr,V=new zt,X=25;z.reserve(32),N.reserve(X),V.reserve(X);const ee=(ae,he)=>X*ae+he;for(let ae=0;ae<X;ae++){const he=ae*A;for(let Te=0;Te<X;Te++){const Oe=Te*A;N.emplaceBack(Oe,he);const Ze=this._globePoint(Oe,he,h,m,x,w,k);V.emplaceBack(Ze[0],Ze[1],Ze[2])}}for(let ae=0;ae<4;ae++)for(let he=0;he<4;he++){const Te=ee(ae,he),Oe=ee(ae,he+1),Ze=ee(ae+1,he),yt=ee(ae+1,he+1);z.emplaceBack(Te,Oe,Ze),z.emplaceBack(Ze,Oe,yt)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(z),this._tileDebugTextBuffer=a.createVertexBuffer(N,dg.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(V,O0.members),this._tileDebugTextSegments=Co.simpleSegment(0,0,X,32)}}class hW{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,h,m){const x=String(h);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][x]=this.stateChanges[a][x]||{},ht(this.stateChanges[a][x],m),this.deletedStates[a]===null){this.deletedStates[a]={};for(const w in this.state[a])w!==x&&(this.deletedStates[a][w]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][x]===null){this.deletedStates[a][x]={};for(const w in this.state[a][x])m[w]||(this.deletedStates[a][x][w]=null)}else for(const w in m)this.deletedStates[a]&&this.deletedStates[a][x]&&this.deletedStates[a][x][w]===null&&delete this.deletedStates[a][x][w]}removeFeatureState(a,h,m){if(this.deletedStates[a]===null)return;const x=String(h);if(this.deletedStates[a]=this.deletedStates[a]||{},m&&h!==void 0)this.deletedStates[a][x]!==null&&(this.deletedStates[a][x]=this.deletedStates[a][x]||{},this.deletedStates[a][x][m]=null);else if(h!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][x])for(m in this.deletedStates[a][x]={},this.stateChanges[a][x])this.deletedStates[a][x][m]=null;else this.deletedStates[a][x]=null;else this.deletedStates[a]=null}getState(a,h){const m=String(h),x=ht({},(this.state[a]||{})[m],(this.stateChanges[a]||{})[m]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const w=this.deletedStates[a][h];if(w===null)return{};for(const k in w)delete x[k]}return x}initializeTileState(a,h){a.setFeatureState(this.state,h)}coalesceChanges(a,h){const m={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const w={};for(const k in this.stateChanges[x])this.state[x][k]||(this.state[x][k]={}),ht(this.state[x][k],this.stateChanges[x][k]),w[k]=this.state[x][k];m[x]=w}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const w={};if(this.deletedStates[x]===null)for(const k in this.state[x])w[k]={},this.state[x][k]={};else for(const k in this.deletedStates[x]){if(this.deletedStates[x][k]===null)this.state[x][k]={};else if(this.state[x][k])for(const A of Object.keys(this.deletedStates[x][k]))delete this.state[x][k][A];w[k]=this.state[x][k]}m[x]=m[x]||{},ht(m[x],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const x in a)a[x].setFeatureState(m,h)}}class FA{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,h){const m=this.toIdx(a,h);return{min:this.minimums[m],max:this.maximums[m]}}isLeaf(a,h){return this.leaves[this.toIdx(a,h)]}toIdx(a,h){return h*this.size+a}}function zA(c,a,h,m){let x=0,w=Number.MAX_VALUE;for(let k=0;k<3;k++)if(Math.abs(m[k])<1e-15){if(h[k]<c[k]||h[k]>a[k])return null}else{const A=1/m[k];let N=(c[k]-h[k])*A,z=(a[k]-h[k])*A;if(N>z){const V=N;N=z,z=V}if(N>x&&(x=N),z<w&&(w=z),x>w)return null}return x}function BA(c,a,h,m,x,w,k,A,N,z,V){const X=m-c,ee=x-a,ae=w-h,he=k-c,Te=A-a,Oe=N-h,Ze=V[1]*Oe-V[2]*Te,yt=V[2]*he-V[0]*Oe,Ke=V[0]*Te-V[1]*he,pt=X*Ze+ee*yt+ae*Ke;if(Math.abs(pt)<1e-15)return null;const Et=1/pt,wt=z[0]-c,Kt=z[1]-a,Xt=z[2]-h,bn=(wt*Ze+Kt*yt+Xt*Ke)*Et;if(bn<0||bn>1)return null;const Jn=Kt*ae-Xt*ee,on=Xt*X-wt*ae,An=wt*ee-Kt*X,Ln=(V[0]*Jn+V[1]*on+V[2]*An)*Et;return Ln<0||bn+Ln>1?null:(he*Jn+Te*on+Oe*An)*Et}function UA(c,a,h){return(c-a)/(h-a)}function jA(c,a,h,m,x,w,k,A,N){const z=1<<h,V=w-m,X=k-x,ee=(c+1)/z*V+m,ae=(a+0)/z*X+x,he=(a+1)/z*X+x;A[0]=(c+0)/z*V+m,A[1]=ae,N[0]=ee,N[1]=he}class VA{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const h=function(w){const k=Math.ceil(Math.log2(w.dim/8)),A=[];let N=Math.ceil(Math.pow(2,k));const z=1/N,V=(ae,he,Te,Oe,Ze)=>{const yt=Oe?1:0,Ke=(ae+1)*Te-yt,pt=he*Te,Et=(he+1)*Te-yt;Ze[0]=ae*Te,Ze[1]=pt,Ze[2]=Ke,Ze[3]=Et};let X=new FA(N);const ee=[];for(let ae=0;ae<N*N;ae++){V(ae%N,Math.floor(ae/N),z,!1,ee);const he=Z0(ee[0],ee[1],w),Te=Z0(ee[2],ee[1],w),Oe=Z0(ee[2],ee[3],w),Ze=Z0(ee[0],ee[3],w);X.minimums.push(Math.min(he,Te,Oe,Ze)),X.maximums.push(Math.max(he,Te,Oe,Ze)),X.leaves.push(1)}for(A.push(X),N/=2;N>=1;N/=2){const ae=A[A.length-1];X=new FA(N);for(let he=0;he<N*N;he++){V(he%N,Math.floor(he/N),2,!0,ee);const Te=ae.getElevation(ee[0],ee[1]),Oe=ae.getElevation(ee[2],ee[1]),Ze=ae.getElevation(ee[2],ee[3]),yt=ae.getElevation(ee[0],ee[3]),Ke=ae.isLeaf(ee[0],ee[1]),pt=ae.isLeaf(ee[2],ee[1]),Et=ae.isLeaf(ee[2],ee[3]),wt=ae.isLeaf(ee[0],ee[3]),Kt=Math.min(Te.min,Oe.min,Ze.min,yt.min),Xt=Math.max(Te.max,Oe.max,Ze.max,yt.max),bn=Ke&&pt&&Et&&wt;X.maximums.push(Xt),X.minimums.push(Kt),X.leaves.push(Xt-Kt<=5&&bn?1:0)}A.push(X)}return A}(this.dem),m=h.length-1,x=h[m];this._addNode(x.minimums[0],x.maximums[0],x.leaves[0]),this._construct(h,0,0,m,0)}raycastRoot(a,h,m,x,w,k,A=1){return zA([a,h,-100],[m,x,this.maximums[0]*A],w,k)}raycast(a,h,m,x,w,k,A=1){if(!this.nodeCount)return null;const N=this.raycastRoot(a,h,m,x,w,k,A);if(N==null)return null;const z=[],V=[],X=[],ee=[],ae=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;ae.length>0;){const{idx:he,t:Te,nodex:Oe,nodey:Ze,depth:yt}=ae.pop();if(this.leaves[he]){jA(Oe,Ze,yt,a,h,m,x,X,ee);const pt=1<<yt,Et=(Oe+0)/pt,wt=(Oe+1)/pt,Kt=(Ze+0)/pt,Xt=(Ze+1)/pt,bn=Z0(Et,Kt,this.dem)*A,Jn=Z0(wt,Kt,this.dem)*A,on=Z0(wt,Xt,this.dem)*A,An=Z0(Et,Xt,this.dem)*A,Ln=BA(X[0],X[1],bn,ee[0],X[1],Jn,ee[0],ee[1],on,w,k),$n=BA(ee[0],ee[1],on,X[0],ee[1],An,X[0],X[1],bn,w,k),tr=Math.min(Ln!==null?Ln:Number.MAX_VALUE,$n!==null?$n:Number.MAX_VALUE);if(tr!==Number.MAX_VALUE)return tr;{const _n=Bf([],w,k,Te);if(GA(bn,Jn,An,on,UA(_n[0],X[0],ee[0]),UA(_n[1],X[1],ee[1]))>=_n[2])return Te}continue}let Ke=0;for(let pt=0;pt<this._siblingOffset.length;pt++){jA((Oe<<1)+this._siblingOffset[pt][0],(Ze<<1)+this._siblingOffset[pt][1],yt+1,a,h,m,x,X,ee),X[2]=-100,ee[2]=this.maximums[this.childOffsets[he]+pt]*A;const Et=zA(X,ee,w,k);if(Et!=null){const wt=Et;z[pt]=wt;let Kt=!1;for(let Xt=0;Xt<Ke&&!Kt;Xt++)wt>=z[V[Xt]]&&(V.splice(Xt,0,pt),Kt=!0);Kt||(V[Ke]=pt),Ke++}}for(let pt=0;pt<Ke;pt++){const Et=V[pt];ae.push({idx:this.childOffsets[he]+Et,t:z[Et],nodex:(Oe<<1)+this._siblingOffset[Et][0],nodey:(Ze<<1)+this._siblingOffset[Et][1],depth:yt+1})}}return null}_addNode(a,h,m){return this.minimums.push(a),this.maximums.push(h),this.leaves.push(m),this.childOffsets.push(0),this.nodeCount++}_construct(a,h,m,x,w){if(a[x].isLeaf(h,m)===1)return;this.childOffsets[w]||(this.childOffsets[w]=this.nodeCount);const k=x-1,A=a[k];let N=0,z=0;for(let V=0;V<this._siblingOffset.length;V++){const X=2*h+this._siblingOffset[V][0],ee=2*m+this._siblingOffset[V][1],ae=A.getElevation(X,ee),he=A.isLeaf(X,ee),Te=this._addNode(ae.min,ae.max,he);he&&(N|=1<<V),z||(z=Te)}for(let V=0;V<this._siblingOffset.length;V++)N&1<<V||this._construct(a,2*h+this._siblingOffset[V][0],2*m+this._siblingOffset[V][1],k,z+V)}}function GA(c,a,h,m,x,w){return Yi(Yi(c,h,w),Yi(a,m,w),x)}function Z0(c,a,h){const m=h.dim,x=Ce(c*m-.5,0,m-1),w=Ce(a*m-.5,0,m-1),k=Math.floor(x),A=Math.floor(w),N=Math.min(k+1,m-1),z=Math.min(A+1,m-1);return GA(h.get(k,A),h.get(N,A),h.get(k,z),h.get(N,z),x-k,w-A)}const HA={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function dW(c,a,h){return(256*c*256+256*a+h)/10-1e4}function fW(c,a,h){return 256*c+a+h/256-32768}class k4{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,h,m,x=!1,w=!1){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(m&&m!=="mapbox"&&m!=="terrarium")return Be(`"${m}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=h.height;const k=this.dim=h.height-2,A=new Uint32Array(h.data.buffer);if(this.pixels=new Uint8Array(h.data.buffer),this.encoding=m||"mapbox",this.borderReady=x,!x){for(let N=0;N<k;N++)A[this._idx(-1,N)]=A[this._idx(0,N)],A[this._idx(k,N)]=A[this._idx(k-1,N)],A[this._idx(N,-1)]=A[this._idx(N,0)],A[this._idx(N,k)]=A[this._idx(N,k-1)];A[this._idx(-1,-1)]=A[this._idx(0,0)],A[this._idx(k,-1)]=A[this._idx(k-1,0)],A[this._idx(-1,k)]=A[this._idx(0,k-1)],A[this._idx(k,k)]=A[this._idx(k-1,k-1)],w&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new VA(this)}get(a,h,m=!1){m&&(a=Ce(a,-1,this.dim),h=Ce(h,-1,this.dim));const x=4*this._idx(a,h);return(this.encoding==="terrarium"?fW:dW)(this.pixels[x],this.pixels[x+1],this.pixels[x+2])}static getUnpackVector(a){return HA[a]}get unpackVector(){return HA[this.encoding]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}static pack(a,h){const m=[0,0,0,0],x=k4.getUnpackVector(h);let w=Math.floor((a+x[3])/x[2]);return m[2]=w%256,w=Math.floor(w/256),m[1]=w%256,w=Math.floor(w/256),m[0]=w,m}getPixels(){return new Tu({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,h,m){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let x=h*this.dim,w=h*this.dim+this.dim,k=m*this.dim,A=m*this.dim+this.dim;switch(h){case-1:x=w-1;break;case 1:w=x+1}switch(m){case-1:k=A-1;break;case 1:A=k+1}const N=-h*this.dim,z=-m*this.dim;for(let V=k;V<A;V++)for(let X=x;X<w;X++){const ee=4*this._idx(X,V),ae=4*this._idx(X+N,V+z);this.pixels[ee+0]=a.pixels[ae+0],this.pixels[ee+1]=a.pixels[ae+1],this.pixels[ee+2]=a.pixels[ae+2],this.pixels[ee+3]=a.pixels[ae+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ir(k4,"DEMData"),Ir(VA,"DemMinMaxQuadTree",{omit:["dem"]});class pW{constructor(a,h){this.max=a,this.onRemove=h,this.reset()}reset(){for(const a in this.data)for(const h of this.data[a])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(a,h,m){const x=a.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const w={value:h,timeout:void 0};if(m!==void 0&&(w.timeout=setTimeout(()=>{this.remove(a,w)},m)),this.data[x].push(w),this.order.push(x),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const h=this.data[a].shift();return h.timeout&&clearTimeout(h.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),h.value}getByKey(a){const h=this.data[a];return h?h[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,h){if(!this.has(a))return this;const m=a.wrapped().key,x=h===void 0?0:this.data[m].indexOf(h),w=this.data[m][x];return this.data[m].splice(x,1),w.timeout&&clearTimeout(w.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(w.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(a){const h=[];for(const m in this.data)for(const x of this.data[m])a(x.value)||h.push(x);for(const m of h)this.remove(m.value.tileID,m)}}class vx{constructor(a,h,m){this.func=a,this.mask=h,this.range=m}}vx.ReadOnly=!1,vx.ReadWrite=!0,vx.disabled=new vx(519,vx.ReadOnly,[0,1]);const a6=7680;class l6{constructor(a,h,m,x,w,k){this.test=a,this.ref=h,this.mask=m,this.fail=x,this.depthFail=w,this.pass=k}}l6.disabled=new l6({func:519,mask:0},0,0,a6,a6,a6);class sm{constructor(a,h,m){this.blendFunction=a,this.blendColor=h,this.mask=m}}sm.Replace=[1,0],sm.disabled=new sm(sm.Replace,Sn.transparent,[!1,!1,!1,!1]),sm.unblended=new sm(sm.Replace,Sn.transparent,[!0,!0,!0,!0]),sm.alphaBlended=new sm([1,771],Sn.transparent,[!0,!0,!0,!0]);const u6=1029,c6=2305;class Xf{constructor(a,h,m){this.enable=a,this.mode=h,this.frontFace=m}}Xf.disabled=new Xf(!1,u6,c6),Xf.backCCW=new Xf(!0,u6,c6),Xf.backCW=new Xf(!0,u6,2304),Xf.frontCW=new Xf(!0,1028,2304),Xf.frontCCW=new Xf(!0,1028,c6);class l1 extends rl{constructor(a,h,m){super(),this.id=a,this._onlySymbols=m,h.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new pW(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new hW,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const h=this._tiles[a];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,h){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,h)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const m=this._tiles[h];m.upload(a),m.prepare(this.map.style.imageManager)}}getIds(){return Ut(this._tiles).map(a=>a.tileID).sort(WA).map(a=>a.key)}getRenderableIds(a){const h=[];for(const m in this._tiles)this._isIdRenderable(+m,a)&&h.push(this._tiles[m]);return a?h.sort((m,x)=>{const w=m.tileID,k=x.tileID,A=new We(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),N=new We(k.canonical.x,k.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-k.overscaledZ||N.y-A.y||N.x-A.x}).map(m=>m.tileID.key):h.map(m=>m.tileID).sort(WA).map(m=>m.key)}hasRenderableParent(a){const h=this.findLoadedParent(a,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(a,h){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(h||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,h){const m=this._tiles[a];m&&(m.state!=="loading"&&(m.state=h),this._loadTile(m,this._tileLoaded.bind(this,m,a,h)))}_tileLoaded(a,h,m,x){if(x)if(a.state="errored",x.status!==404)this._source.fire(new _l(x,{tile:a}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=bo.now(),m==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(h,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new yl("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const h=this.getRenderableIds();for(let x=0;x<h.length;x++){const w=h[x];if(a.neighboringTiles&&a.neighboringTiles[w]){const k=this.getTileByID(w);m(a,k),m(k,a)}}function m(x,w){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let k=w.tileID.canonical.x-x.tileID.canonical.x;const A=w.tileID.canonical.y-x.tileID.canonical.y,N=Math.pow(2,x.tileID.canonical.z),z=w.tileID.key;k===0&&A===0||Math.abs(A)>1||(Math.abs(k)>1&&(Math.abs(k+N)===1?k+=N:Math.abs(k-N)===1&&(k-=N)),w.dem&&x.dem&&(x.dem.backfillBorder(w.dem,k,A),x.neighboringTiles&&x.neighboringTiles[z]&&(x.neighboringTiles[z].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,h,m,x){for(const w in this._tiles){let k=this._tiles[w];if(x[w]||!k.hasData()||k.tileID.overscaledZ<=h||k.tileID.overscaledZ>m)continue;let A=k.tileID;for(;k&&k.tileID.overscaledZ>h+1;){const z=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[z.key],k&&k.hasData()&&(A=z)}let N=A;for(;N.overscaledZ>h;)if(N=N.scaledTo(N.overscaledZ-1),a[N.key]){x[A.key]=A;break}}}findLoadedParent(a,h){if(a.key in this._loadedParentTiles){const m=this._loadedParentTiles[a.key];return m&&m.tileID.overscaledZ>=h?m:null}for(let m=a.overscaledZ-1;m>=h;m--){const x=a.scaledTo(m),w=this._getLoadedTile(x);if(w)return w}}_getLoadedTile(a){const h=this._tiles[a.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,h){h=h||this._source.tileSize;const m=Math.ceil(a.width/h)+1,x=Math.ceil(a.height/h)+1,w=Math.floor(m*x*5),k=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,A=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,k):k;this._cache.setMaxSize(A)}handleWrapJump(a){const h=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,h){const m={};for(const x in this._tiles){const w=this._tiles[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+h),m[w.tileID.key]=w}this._tiles=m;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(a,h,m){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;let x;this.updateCacheSize(a,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?x=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(A=>new pe(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y)):(x=a.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(x=x.filter(A=>this._source.hasTile(A)))):x=[];const w=this._updateRetainedTiles(x);if(qA(this._source.type)&&x.length!==0){const A={},N={},z=Object.keys(w);for(const X of z){const ee=w[X],ae=this._tiles[X];if(!ae||ae.fadeEndTime&&ae.fadeEndTime<=bo.now())continue;const he=this.findLoadedParent(ee,Math.max(ee.overscaledZ-l1.maxOverzooming,this._source.minzoom));he&&(this._addTile(he.tileID),A[he.tileID.key]=he.tileID),N[X]=ee}const V=x[x.length-1].overscaledZ;for(const X in this._tiles){const ee=this._tiles[X];if(w[X]||!ee.hasData())continue;let ae=ee.tileID;for(;ae.overscaledZ>V;){ae=ae.scaledTo(ae.overscaledZ-1);const he=this._tiles[ae.key];if(he&&he.hasData()&&N[ae.key]){w[X]=ee.tileID;break}}}for(const X in A)w[X]||(this._coveredTiles[X]=!0,w[X]=A[X])}for(const A in w)this._tiles[A].clearFadeHold();const k=function(A,N){const z=[];for(const V in A)V in N||z.push(V);return z}(this._tiles,w);for(const A of k){const N=this._tiles[A];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(+A)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const h={};if(a.length===0)return h;const m={},x=a.reduce((z,V)=>Math.min(z,V.overscaledZ),1/0),w=a[0].overscaledZ,k=Math.max(w-l1.maxOverzooming,this._source.minzoom),A=Math.max(w+l1.maxUnderzooming,this._source.minzoom),N={};for(const z of a){const V=this._addTile(z);h[z.key]=z,V.hasData()||x<this._source.maxzoom&&(N[z.key]=z)}this._retainLoadedChildren(N,x,A,h);for(const z of a){let V=this._tiles[z.key];if(V.hasData())continue;if(z.canonical.z>=this._source.maxzoom){const ee=z.children(this._source.maxzoom)[0],ae=this.getTile(ee);if(ae&&ae.hasData()){h[ee.key]=ee;continue}}else{const ee=z.children(this._source.maxzoom);if(h[ee[0].key]&&h[ee[1].key]&&h[ee[2].key]&&h[ee[3].key])continue}let X=V.wasRequested();for(let ee=z.overscaledZ-1;ee>=k;--ee){const ae=z.scaledTo(ee);if(m[ae.key]||(m[ae.key]=!0,V=this.getTile(ae),!V&&X&&(V=this._addTile(ae)),V&&(h[ae.key]=ae,X=V.wasRequested(),V.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const h=[];let m,x=this._tiles[a].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){m=this._loadedParentTiles[x.key];break}h.push(x.key);const w=x.scaledTo(x.overscaledZ-1);if(m=this._getLoadedTile(w),m)break;x=w}for(const w of h)this._loadedParentTiles[w]=m}}_addTile(a){let h=this._tiles[a.key];if(h)return h;h=this._cache.getAndRemove(a),h&&(this._setTileReloadTimer(a.key,h),h.tileID=a,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,h)));const m=!!h;if(!m){const x=this.map?this.map.painter:null;h=new o6(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,x,this._isRaster),this._loadTile(h,this._tileLoaded.bind(this,h,a.key,h.state))}return h?(h.uses++,this._tiles[a.key]=h,m||this._source.fire(new yl("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h):null}_setTileReloadTimer(a,h){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const m=h.getExpiryTimeout();m&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},m))}_removeTile(a){const h=this._tiles[a];h&&(h.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,h,m){const x=[],w=this.transform;if(!w)return x;const k=w.projection.name==="globe",A=Xu(w.center.lng);for(const N in this._tiles){const z=this._tiles[N];if(m&&z.clearQueryDebugViz(),z.holdingForFade())continue;let V;if(k){const X=z.tileID.canonical;if(X.z===0){const ee=[Math.abs(Ce(A,...ow(X,-1))-A),Math.abs(Ce(A,...ow(X,1))-A)];V=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(Ce(A,...ow(X,-1))-A),Math.abs(Ce(A,...ow(X,0))-A),Math.abs(Ce(A,...ow(X,1))-A)];V=[ee.indexOf(Math.min(...ee))-1]}}else V=[0];for(const X of V){const ee=a.containsTile(z,w,h,X);ee&&x.push(ee)}}return x}getVisibleCoordinates(a){const h=this.getRenderableIds(a).map(m=>this._tiles[m].tileID);for(const m of h)m.projMatrix=this.transform.calculateProjMatrix(m.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(qA(this._source.type))for(const a in this._tiles){const h=this._tiles[a];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=bo.now())return!0}return!1}setFeatureState(a,h,m){this._state.updateState(a=a||"_geojsonTileLayer",h,m)}removeFeatureState(a,h,m){this._state.removeFeatureState(a=a||"_geojsonTileLayer",h,m)}getFeatureState(a,h){return this._state.getState(a=a||"_geojsonTileLayer",h)}setDependencies(a,h,m){const x=this._tiles[a];x&&x.setDependencies(h,m)}reloadTilesForDependencies(a,h){for(const m in this._tiles)this._tiles[m].hasDependency(a,h)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(a,h))}_preloadTiles(a,h){if(!this._sourceLoaded){const A=()=>{this._sourceLoaded&&(this._source.off("data",A),this._preloadTiles(a,h))};return void this._source.on("data",A)}const m=new Map,x=Array.isArray(a)?a:[a],w=this.map.painter.terrain,k=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const A of x){const N=A.coveringTiles({tileSize:k,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const z of N)m.set(z.key,z);this.usedForTerrain&&A.updateElevation(!1)}rt(Array.from(m.values()),(A,N)=>{const z=new o6(A,this._source.tileSize*A.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(z,V=>{this._source.type==="raster-dem"&&z.dem&&this._backfillDEM(z),N(V,z)})},h)}}function WA(c,a){const h=Math.abs(2*c.wrap)-+(c.wrap<0),m=Math.abs(2*a.wrap)-+(a.wrap<0);return c.overscaledZ-a.overscaledZ||m-h||a.canonical.y-c.canonical.y||a.canonical.x-c.canonical.x}function qA(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function ow(c,a){const h=1<<c.z;return[c.x/h+a,(c.x+1)/h+a]}l1.maxOverzooming=10,l1.maxUnderzooming=3;class C4{constructor(a,h,m){this._demTile=a,this._dem=this._demTile.dem,this._scale=h,this._offset=m}static create(a,h,m){const x=m||a.findDEMTileFor(h);if(!x||!x.dem)return;const w=x.dem,k=x.tileID,A=1<<h.canonical.z-k.canonical.z;return new C4(x,x.tileSize/Yr/A,[(h.canonical.x/A-k.canonical.x)*w.dim,(h.canonical.y/A-k.canonical.y)*w.dim])}tileCoordToPixel(a,h){const m=h*this._scale+this._offset[1],x=Math.floor(a*this._scale+this._offset[0]),w=Math.floor(m);return new We(x,w)}getElevationAt(a,h,m,x){const w=a*this._scale+this._offset[0],k=h*this._scale+this._offset[1],A=Math.floor(w),N=Math.floor(k),z=this._dem;return x=!!x,m?Yi(Yi(z.get(A,N,x),z.get(A,N+1,x),k-N),Yi(z.get(A+1,N,x),z.get(A+1,N+1,x),k-N),w-A):z.get(A,N,x)}getElevationAtPixel(a,h,m){return this._dem.get(a,h,!!m)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Hl(1,a)*this._dem.stride}}class $A{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Ch(Yr,16,0),this.featureIndexArray=new kd,this.promoteId=h}insert(a,h,m,x,w,k=0){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,x,w,k);const N=this.grid;for(let z=0;z<h.length;z++){const V=h[z],X=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<V.length;ee++){const ae=V[ee];X[0]=Math.min(X[0],ae.x),X[1]=Math.min(X[1],ae.y),X[2]=Math.max(X[2],ae.x),X[3]=Math.max(X[3],ae.y)}X[0]<Yr&&X[1]<Yr&&X[2]>=0&&X[3]>=0&&N.insert(A,X[0],X[1],X[2],X[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new t1(new s1(this.rawTileData)).layers,this.sourceLayerCoder=new PA(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,h,m,x){this.loadVTLayers();const w=a.params||{},k=v0(w.filter),A=a.tileResult,N=a.transform,z=A.bufferedTilespaceBounds,V=this.grid.query(z.min.x,z.min.y,z.max.x,z.max.y,(he,Te,Oe,Ze)=>Xv(A.bufferedTilespaceGeometry,he,Te,Oe,Ze));V.sort(mW);let X=null;N.elevation&&V.length>0&&(X=C4.create(N.elevation,this.tileID));const ee={};let ae;for(let he=0;he<V.length;he++){const Te=V[he];if(Te===ae)continue;ae=Te;const Oe=this.featureIndexArray.get(Te);let Ze=null;this.loadMatchingFeature(ee,Oe,k,w.layers,w.availableImages,h,m,x,(yt,Ke,pt,Et=0)=>(Ze||(Ze=Dh(yt,this.tileID.canonical,a.tileTransform)),Ke.queryIntersectsFeature(A,yt,pt,Ze,this.z,a.transform,a.pixelPosMatrix,X,Et)))}return ee}loadMatchingFeature(a,h,m,x,w,k,A,N,z){const{featureIndex:V,bucketIndex:X,sourceLayerIndex:ee,layoutVertexArrayOffset:ae}=h,he=this.bucketLayerIDs[X];if(x&&!function(yt,Ke){for(let pt=0;pt<yt.length;pt++)if(Ke.indexOf(yt[pt])>=0)return!0;return!1}(x,he))return;const Te=this.sourceLayerCoder.decode(ee),Oe=this.vtLayers[Te].feature(V);if(m.needGeometry){const yt=Kp(Oe,!0);if(!m.filter(new q(this.tileID.overscaledZ),yt,this.tileID.canonical))return}else if(!m.filter(new q(this.tileID.overscaledZ),Oe))return;const Ze=this.getId(Oe,Te);for(let yt=0;yt<he.length;yt++){const Ke=he[yt];if(x&&x.indexOf(Ke)<0)continue;const pt=k[Ke];if(!pt)continue;let Et={};Ze!==void 0&&N&&(Et=N.getState(pt.sourceLayer||"_geojsonTileLayer",Ze));const wt=ht({},A[Ke]);wt.paint=XA(wt.paint,pt.paint,Oe,Et,w),wt.layout=XA(wt.layout,pt.layout,Oe,Et,w);const Kt=!z||z(Oe,pt,Et,ae);if(!Kt)continue;const Xt=new RA(Oe,this.z,this.x,this.y,Ze);Xt.layer=wt;let bn=a[Ke];bn===void 0&&(bn=a[Ke]=[]),bn.push({featureIndex:V,feature:Xt,intersectionZ:Kt})}}lookupSymbolFeatures(a,h,m,x,w,k,A,N){const z={};this.loadVTLayers();const V=v0(w);for(const X of a)this.loadMatchingFeature(z,{bucketIndex:m,sourceLayerIndex:x,featureIndex:X,layoutVertexArrayOffset:0},V,k,A,N,h);return z}loadFeature(a){const{featureIndex:h,sourceLayerIndex:m}=a;this.loadVTLayers();const x=this.sourceLayerCoder.decode(m),w=this.vtFeatures[x];if(w[h])return w[h];const k=this.vtLayers[x].feature(h);return w[h]=k,k}hasLayer(a){for(const h of this.bucketLayerIDs)for(const m of h)if(a===m)return!0;return!1}getId(a,h){let m=a.id;if(this.promoteId){const x=typeof this.promoteId=="string"?this.promoteId:this.promoteId[h];x!=null&&(m=a.properties[x]),typeof m=="boolean"&&(m=Number(m))}return m}}function XA(c,a,h,m,x){return Nr(c,(w,k)=>{const A=a instanceof Xe?a.get(k):null;return A&&A.evaluate?A.evaluate(h,m,x):A})}function mW(c,a){return a-c}Ir($A,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class ZA{constructor(a,h){this.width=a,this.height=h,this.nextRow=0,this.image=new Dd({width:a,height:h}),this.positions={},this.uploaded=!1}getDash(a,h){const m=this.getKey(a,h);return this.positions[m]}trim(){const a=this.width,h=this.height=rr(this.nextRow);this.image.resize({width:a,height:h})}getKey(a,h){return a.join(",")+h}getDashRanges(a,h,m){const x=[];let w=a.length%2==1?-a[a.length-1]*m:0,k=a[0]*m,A=!0;x.push({left:w,right:k,isDash:A,zeroLength:a[0]===0});let N=a[0];for(let z=1;z<a.length;z++){A=!A;const V=a[z];w=N*m,N+=V,k=N*m,x.push({left:w,right:k,isDash:A,zeroLength:V===0})}return x}addRoundDash(a,h,m){const x=h/2;for(let w=-m;w<=m;w++){const k=this.width*(this.nextRow+m+w);let A=0,N=a[A];for(let z=0;z<this.width;z++){z/N.right>1&&(N=a[++A]);const V=Math.abs(z-N.left),X=Math.abs(z-N.right),ee=Math.min(V,X);let ae;const he=w/m*(x+1);if(N.isDash){const Te=x-Math.abs(he);ae=Math.sqrt(ee*ee+Te*Te)}else ae=x-Math.sqrt(ee*ee+he*he);this.image.data[k+z]=Math.max(0,Math.min(255,ae+128))}}}addRegularDash(a,h){for(let N=a.length-1;N>=0;--N){const z=a[N],V=a[N+1];z.zeroLength?a.splice(N,1):V&&V.isDash===z.isDash&&(V.left=z.left,a.splice(N,1))}const m=a[0],x=a[a.length-1];m.isDash===x.isDash&&(m.left=x.left-this.width,x.right=m.right+this.width);const w=this.width*this.nextRow;let k=0,A=a[k];for(let N=0;N<this.width;N++){N/A.right>1&&(A=a[++k]);const z=Math.abs(N-A.left),V=Math.abs(N-A.right),X=Math.min(z,V);this.image.data[w+N]=Math.max(0,Math.min(255,(A.isDash?X:-X)+h+128))}}addDash(a,h){const m=this.getKey(a,h);if(this.positions[m])return this.positions[m];const x=h==="round",w=x?7:0,k=2*w+1;if(this.nextRow+k>this.height)return Be("LineAtlas out of space"),null;a.length===0&&a.push(1);let A=0;for(let V=0;V<a.length;V++)a[V]<0&&(Be("Negative value is found in line dasharray, replacing values with 0"),a[V]=0),A+=a[V];if(A!==0){const V=this.width/A,X=this.getDashRanges(a,this.width,V);x?this.addRoundDash(X,V,w):this.addRegularDash(X,h==="square"?.5*V:0)}const N=this.nextRow+w;this.nextRow+=k;const z={tl:[N,w],br:[A,0]};return this.positions[m]=z,z}}Ir(ZA,"LineAtlas");const YA=1*$f;class KA{constructor(a){const h={},m=[];for(const A in a){const N=a[A],z=h[A]={};for(const V in N.glyphs){const X=N.glyphs[+V];if(!X||X.bitmap.width===0||X.bitmap.height===0)continue;const ee=X.metrics.localGlyph?YA:1,ae={x:0,y:0,w:X.bitmap.width+2*ee,h:X.bitmap.height+2*ee};m.push(ae),z[V]=ae}}const{w:x,h:w}=K3(m),k=new Dd({width:x||1,height:w||1});for(const A in a){const N=a[A];for(const z in N.glyphs){const V=N.glyphs[+z];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const X=h[A][z],ee=V.metrics.localGlyph?YA:1;Dd.copy(V.bitmap,k,{x:0,y:0},{x:X.x+ee,y:X.y+ee},V.bitmap)}}this.image=k,this.positions=h}}Ir(KA,"GlyphAtlas");class gW{constructor(a){this.tileID=new pe(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=a1(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,h,m,x,w){this.status="parsing",this.data=a,this.collisionBoxArray=new Fs;const k=new PA(Object.keys(a.layers).sort()),A=new $A(this.tileID,this.promoteId);A.bucketLayerIDs=[];const N={},z=new ZA(256,256),V={featureIndex:A,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:z,availableImages:m},X=h.familiesBySource[this.source];for(const Et in X){const wt=a.layers[Et];if(!wt)continue;let Kt=!1,Xt=!1;for(const on of X[Et])on[0].type==="symbol"?Kt=!0:Xt=!0;if(this.isSymbolTile===!0&&!Kt||this.isSymbolTile===!1&&!Xt)continue;wt.version===1&&Be(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bn=k.encode(Et),Jn=[];for(let on=0;on<wt.length;on++){const An=wt.feature(on),Ln=A.getId(An,Et);Jn.push({feature:An,id:Ln,index:on,sourceLayerIndex:bn})}for(const on of X[Et]){const An=on[0];this.isSymbolTile!==void 0&&An.type==="symbol"!==this.isSymbolTile||An.minzoom&&this.zoom<Math.floor(An.minzoom)||An.maxzoom&&this.zoom>=An.maxzoom||An.visibility!=="none"&&(h6(on,this.zoom,m),(N[An.id]=An.createBucket({index:A.bucketLayerIDs.length,layers:on,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:m})).populate(Jn,V,this.tileID.canonical,this.tileTransform),A.bucketLayerIDs.push(on.map(Ln=>Ln.id)))}}let ee,ae,he,Te;z.trim();const Oe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ze=()=>{if(ee)return w(ee);if(ae&&he&&Te){const Et=new KA(ae),wt=new J3(he,Te);for(const Kt in N){const Xt=N[Kt];Xt instanceof q0?(h6(Xt.layers,this.zoom,m),VH(Xt,ae,Et.positions,he,wt.iconPositions,this.showCollisionBoxes,m,this.tileID.canonical,this.tileZoom,this.projection)):Xt.hasPattern&&(Xt instanceof er||Xt instanceof Fh||Xt instanceof y)&&(h6(Xt.layers,this.zoom,m),Xt.addFeatures(V,this.tileID.canonical,wt.patternPositions,m,this.tileTransform))}this.status="done",w(null,{buckets:Ut(N).filter(Kt=>!Kt.isEmpty()),featureIndex:A,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,lineAtlas:z,imageAtlas:wt,glyphMap:this.returnDependencies?ae:null,iconMap:this.returnDependencies?he:null,glyphPositions:this.returnDependencies?Et.positions:null})}},yt=Nr(V.glyphDependencies,Et=>Object.keys(Et).map(Number));Object.keys(yt).length?x.send("getGlyphs",{uid:this.uid,stacks:yt},(Et,wt)=>{ee||(ee=Et,ae=wt,Ze())},void 0,!1,Oe):ae={};const Ke=Object.keys(V.iconDependencies);Ke.length?x.send("getImages",{icons:Ke,source:this.source,tileID:this.tileID,type:"icons"},(Et,wt)=>{ee||(ee=Et,he=wt,Ze())},void 0,!1,Oe):he={};const pt=Object.keys(V.patternDependencies);pt.length?x.send("getImages",{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"},(Et,wt)=>{ee||(ee=Et,Te=wt,Ze())},void 0,!1,Oe):Te={},Ze()}}function h6(c,a,h){const m=new q(a);for(const x of c)x.recalculate(m,h)}class JA{constructor(a){this.entries={},this.scheduler=a}request(a,h,m,x){const w=this.entries[a]=this.entries[a]||{callbacks:[]};if(w.result){const[k,A]=w.result;return this.scheduler?this.scheduler.add(()=>{x(k,A)},h):x(k,A),()=>{}}return w.callbacks.push(x),w.cancel||(w.cancel=m((k,A)=>{w.result=[k,A];for(const N of w.callbacks)this.scheduler?this.scheduler.add(()=>{N(k,A)},h):N(k,A);setTimeout(()=>delete this.entries[a],3e3)})),()=>{w.result||(w.callbacks=w.callbacks.filter(k=>k!==x),w.callbacks.length||(w.cancel(),delete this.entries[a]))}}}function QA(c,a,h){const m=JSON.stringify(c.request);return c.data&&(this.deduped.entries[m]={result:[null,c.data]}),this.deduped.request(m,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},x=>{const w=Di(c.request,(k,A,N,z)=>{k?x(k):A&&x(null,{vectorTile:h?void 0:new t1(new s1(A)),rawData:A,cacheControl:N,expires:z})});return()=>{w.cancel(),x()}},a)}const eL=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class d6{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,m]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const x=m>>4;if(x!==1)throw new Error(`Got v${x} data when expected v1.`);const w=eL[15&m];if(!w)throw new Error("Unrecognized array type.");const[k]=new Uint16Array(a,2,1),[A]=new Uint32Array(a,4,1);return new d6(A,k,w,a)}constructor(a,h=64,m=Float64Array,x){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=m,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const w=eL.indexOf(this.ArrayType),k=2*a*this.ArrayType.BYTES_PER_ELEMENT,A=a*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-A%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${m}.`);x&&x instanceof ArrayBuffer?(this.data=x,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+A+N,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+k+A+N),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+A+N,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=a,this.coords[this._pos++]=h,m}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return f6(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,m,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:w,coords:k,nodeSize:A}=this,N=[0,w.length-1,0],z=[];for(;N.length;){const V=N.pop()||0,X=N.pop()||0,ee=N.pop()||0;if(X-ee<=A){for(let Oe=ee;Oe<=X;Oe++){const Ze=k[2*Oe],yt=k[2*Oe+1];Ze>=a&&Ze<=m&&yt>=h&&yt<=x&&z.push(w[Oe])}continue}const ae=ee+X>>1,he=k[2*ae],Te=k[2*ae+1];he>=a&&he<=m&&Te>=h&&Te<=x&&z.push(w[ae]),(V===0?a<=he:h<=Te)&&(N.push(ee),N.push(ae-1),N.push(1-V)),(V===0?m>=he:x>=Te)&&(N.push(ae+1),N.push(X),N.push(1-V))}return z}within(a,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:k}=this,A=[0,x.length-1,0],N=[],z=m*m;for(;A.length;){const V=A.pop()||0,X=A.pop()||0,ee=A.pop()||0;if(X-ee<=k){for(let Oe=ee;Oe<=X;Oe++)nL(w[2*Oe],w[2*Oe+1],a,h)<=z&&N.push(x[Oe]);continue}const ae=ee+X>>1,he=w[2*ae],Te=w[2*ae+1];nL(he,Te,a,h)<=z&&N.push(x[ae]),(V===0?a-m<=he:h-m<=Te)&&(A.push(ee),A.push(ae-1),A.push(1-V)),(V===0?a+m>=he:h+m>=Te)&&(A.push(ae+1),A.push(X),A.push(1-V))}return N}}function f6(c,a,h,m,x,w){if(x-m<=h)return;const k=m+x>>1;tL(c,a,k,m,x,w),f6(c,a,h,m,k-1,1-w),f6(c,a,h,k+1,x,1-w)}function tL(c,a,h,m,x,w){for(;x>m;){if(x-m>600){const z=x-m+1,V=h-m+1,X=Math.log(z),ee=.5*Math.exp(2*X/3),ae=.5*Math.sqrt(X*ee*(z-ee)/z)*(V-z/2<0?-1:1);tL(c,a,h,Math.max(m,Math.floor(h-V*ee/z+ae)),Math.min(x,Math.floor(h+(z-V)*ee/z+ae)),w)}const k=a[2*h+w];let A=m,N=x;for(aw(c,a,m,h),a[2*x+w]>k&&aw(c,a,m,x);A<N;){for(aw(c,a,A,N),A++,N--;a[2*A+w]<k;)A++;for(;a[2*N+w]>k;)N--}a[2*m+w]===k?aw(c,a,m,N):(N++,aw(c,a,N,x)),N<=h&&(m=N+1),h<=N&&(x=N-1)}}function aw(c,a,h,m){p6(c,h,m),p6(a,2*h,2*m),p6(a,2*h+1,2*m+1)}function p6(c,a,h){const m=c[a];c[a]=c[h],c[h]=m}function nL(c,a,h,m){const x=c-h,w=a-m;return x*x+w*w}l.ARRAY_TYPE=Io,l.AUTH_ERR_MSG=Fe,l.Aabb=Ao,l.Actor=class{constructor(c,a,h){this.target=c,this.parent=a,this.mapId=h,this.callbacks={},this.cancelCallbacks={},Li(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qe()?c:E,this.scheduler=new uW}send(c,a,h,m,x=!1,w){const k=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=w,this.callbacks[k]=h);const A=Rt(this.globalScope)?void 0:[];return this.target.postMessage({id:k,type:c,hasCallback:!!h,targetMapId:m,mustQueue:x,sourceMapId:this.mapId,data:Hp(a,A)},A),{cancel:()=>{h&&delete this.callbacks[k],this.target.postMessage({id:k,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(c){const a=c.data,h=a.id;if(h&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const m=this.cancelCallbacks[h];delete this.cancelCallbacks[h],m&&m.cancel()}else if(a.mustQueue||Qe()){const m=this.callbacks[h];this.cancelCallbacks[h]=this.scheduler.add(()=>this.processTask(h,a),m&&m.metadata||{type:"message"})}else this.processTask(h,a)}processTask(c,a){if(a.type==="<response>"){const h=this.callbacks[c];delete this.callbacks[c],h&&(a.error?h(Td(a.error)):h(null,Td(a.data)))}else{const h=Rt(this.globalScope)?void 0:[],m=a.hasCallback?(w,k)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:w?Hp(w):null,data:Hp(k,h)},h)}:w=>{},x=Td(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,x,m);else if(this.parent.getWorkerSource){const w=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,w[0],x.source)[w[1]](x,m)}else m(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=de,l.Color=Sn,l.ColorMode=sm,l.CullFaceMode=Xf,l.DEMData=k4,l.DataConstantProperty=Ee,l.DedupedRequest=JA,l.DepthMode=vx,l.EXTENT=Yr,l.Elevation=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const h=a.getSource().maxzoom,m=1<<h,x=Math.floor(c.x),w=Math.floor((c.x-x)*m),k=Math.floor(c.y*m),A=this.findDEMTileFor(new pe(h,x,h,w,k));return!(!A||!A.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,h=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);const m=this._source();if(!m||c.y<0||c.y>1)return a;const x=m.getSource().maxzoom,w=1<<x,k=Math.floor(c.x),A=c.x-k,N=new pe(x,k,x,Math.floor(A*w),Math.floor(c.y*w)),z=this.findDEMTileFor(N);if(!z||!z.dem)return a;const V=z.dem,X=1<<z.tileID.canonical.z,ee=(A*X-z.tileID.canonical.x)*V.dim,ae=(c.y*X-z.tileID.canonical.y)*V.dim,he=Math.floor(ee),Te=Math.floor(ae);return(h?this.exaggeration():1)*Yi(Yi(V.get(he,Te),V.get(he,Te+1),ae-Te),Yi(V.get(he+1,Te),V.get(he+1,Te+1),ae-Te),ee-he)}getAtTileOffset(c,a,h){const m=1<<c.canonical.z;return this.getAtPointOrZero(new Rd(c.wrap+(c.canonical.x+a/Yr)/m,(c.canonical.y+h/Yr)/m))}getAtTileOffsetFunc(c,a,h,m){return x=>{const w=this.getAtTileOffset(c,x.x,x.y),k=m.upVector(c.canonical,x.x,x.y);return Ja(k,k,w*m.upVectorScale(c.canonical,a,h).metersToTile),k}}getForTilePoints(c,a,h,m){if(this.isUsingMockSource())return!1;const x=C4.create(this,c,m);return!!x&&(a.forEach(w=>{w[2]=this.exaggeration()*x.getElevationAt(w[0],w[1],h)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const h=a.dem.tree,m=a.tileID,x=1<<c.canonical.z-m.canonical.z;let w=c.canonical.x/x-m.canonical.x,k=c.canonical.y/x-m.canonical.y,A=0;for(let N=0;N<c.canonical.z-m.canonical.z&&!h.leaves[A];N++){w*=2,k*=2;const z=2*Math.floor(k)+Math.floor(w);A=h.childOffsets[A]+z,w%=1,k%=1}return{min:this.exaggeration()*h.minimums[A],max:this.exaggeration()*h.maximums[A]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,h){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=_l,l.EvaluationParameters=q,l.Event=yl,l.Evented=rl,l.FillExtrusionBucket=y,l.Frustum=Bv,l.FrustumCorners=zv,l.GLOBE_RADIUS=Eu,l.GLOBE_SCALE_MATCH_LATITUDE=45,l.GLOBE_ZOOM_THRESHOLD_MAX=fg,l.GLOBE_ZOOM_THRESHOLD_MIN=R3,l.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,a){const h=new Zn,m=new Hr,x=[],w=c+1+2,k=a[0]+1,A=a[0]+1+(1+a.length),N=(z,V,X)=>{let ee=z===w-1?z-2:z===0?z:z-1;return ee+=X?24575:0,[ee,V]};for(let z=0;z<w;++z)h.emplaceBack(...N(z,0,!0));for(let z=0;z<k;++z)for(let V=0;V<w;++V)h.emplaceBack(...N(V,z,(V===0||V===w-1)&&!0));for(let z=0;z<a.length;++z){const V=a[z];for(let X=0;X<w;++X)h.emplaceBack(...N(X,V,!0))}for(let z=0;z<a.length;++z){const V=m.length,X=a[z]+1+2,ee=new Hr;for(let Te=0;Te<X-1;Te++){const Oe=Te===X-2,Ze=Oe?w*(A-a.length+z-Te):w;for(let yt=0;yt<w-1;yt++){const Ke=Te*w+yt;Te===0||Oe||yt===0||yt===w-2?(ee.emplaceBack(Ke+1,Ke,Ke+Ze),ee.emplaceBack(Ke+Ze,Ke+Ze+1,Ke+1)):(m.emplaceBack(Ke+1,Ke,Ke+Ze),m.emplaceBack(Ke+Ze,Ke+Ze+1,Ke+1))}}const ae=Co.simpleSegment(0,V,h.length,m.length-V);for(let Te=0;Te<ee.uint16.length;Te+=3)m.emplaceBack(ee.uint16[Te],ee.uint16[Te+1],ee.uint16[Te+2]);const he=Co.simpleSegment(0,V,h.length,m.length-V);x.push({withoutSkirts:ae,withSkirts:he})}return{vertices:h,indices:m,segments:x}}_createGrid(c){const a=this._fillGridMeshWithLods(Id,Ad);this._gridSegments=a.segments,this._gridBuffer=c.createVertexBuffer(a.vertices,dg.members),this._gridIndexBuffer=c.createIndexBuffer(a.indices,!0)}_createPoles(c){const a=new Hr;for(let x=0;x<=Id;x++)a.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const h=new Os,m=new Os;this._poleSegments=[];for(let x=0,w=0;x<R3;x++){const k=360/(1<<x);h.emplaceBack(0,-Eu,0,.5,0),m.emplaceBack(0,-Eu,0,.5,1);for(let A=0;A<=Id;A++){const N=A/Id,z=Yi(0,k,N),[V,X,ee]=Zp(vg,D3,z,Eu);h.emplaceBack(V,X,ee,N,0),m.emplaceBack(V,X,ee,N,1)}this._poleSegments.push(Co.simpleSegment(w,0,66,64)),w+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(h,P3,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(m,P3,!1)}getGridBuffers(c,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,a){if(!this._wireframeSegments){const h=new Ra,m=Id,x=m+1+2,w=1;this._wireframeSegments=[];for(let k=0,A=0;k<Ad.length;k++){const N=Ad[k];for(let V=w;V<N+w;V++)for(let X=w;X<m+w;X++){const ee=V*x+X;h.emplaceBack(ee,ee+1),h.emplaceBack(ee,ee+x),h.emplaceBack(ee,ee+x+1)}const z=N*m*3;this._wireframeSegments.push(Co.simpleSegment(0,A,(N+1)*x,z)),A+=z}this._wireframeIndexBuffer=c.createIndexBuffer(h)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},l.GlyphManager=px,l.ImagePosition=fx,l.KDBush=d6,l.LivePerformanceUtils=xs,l.LngLat=ms,l.LngLatBounds=Lh,l.LocalGlyphMode=JM,l.MAX_MERCATOR_LATITUDE=co,l.MercatorCoordinate=Rd,l.ONE_EM=ln,l.OverscaledTileID=pe,l.PerformanceMarkers=No,l.Point=We,l.Properties=lt,l.RGBAImage=Tu,l.Ray=Yc,l.RequestManager=class{constructor(c,a,h){this._transformRequestFn=c,this._customAccessToken=a,this._silenceAuthErrors=!!h,this._createSkuToken()}_createSkuToken(){const c=function(){let a="";for(let h=0;h<10;h++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",te,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,a){return this._transformRequestFn&&this._transformRequestFn(c,a)||{url:c}}normalizeStyleURL(c,a){if(!nt(c))return c;const h=Mn(c);return h.path=`/styles/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||a)}normalizeGlyphsURL(c,a){if(!nt(c))return c;const h=Mn(c);return h.path=`/fonts/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||a)}normalizeSourceURL(c,a,h,m){if(!nt(c))return c;const x=Mn(c);return x.path=`/v4/${x.authority}.json`,x.params.push("secure"),h&&x.params.push(`language=${h}`),m&&x.params.push(`worldview=${m}`),this._makeAPIURL(x,this._customAccessToken||a)}normalizeSpriteURL(c,a,h,m){const x=Mn(c);return nt(c)?(x.path=`/styles/v1${x.path}/sprite${a}${h}`,this._makeAPIURL(x,this._customAccessToken||m)):(x.path+=`${a}${h}`,Jt(x))}normalizeTileURL(c,a,h){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!nt(c))return c;const m=Mn(c);m.path=m.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||h&&m.authority!=="raster"&&h===512?"@2x":""}${$.supported?".webp":"$1"}`),m.authority==="raster"?m.path=`/${j.RASTER_URL_PREFIX}${m.path}`:(m.path=m.path.replace(/^.+\/v4\//,"/"),m.path=`/${j.TILE_URL_VERSION}${m.path}`);const x=this._customAccessToken||function(w){for(const k of w){const A=k.match(/^access_token=(.*)$/);if(A)return A[1]}return null}(m.params)||j.ACCESS_TOKEN;return j.REQUIRE_ACCESS_TOKEN&&x&&this._skuToken&&m.params.push(`sku=${this._skuToken}`),this._makeAPIURL(m,x)}canonicalizeTileURL(c,a){const h=Mn(c);if(!h.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!h.path.match(/\.[\w]+$/))return c;let m="mapbox://";h.path.match(/^\/raster\/v1\//)?m+=`raster/${h.path.replace(`/${j.RASTER_URL_PREFIX}/`,"")}`:m+=`tiles/${h.path.replace(`/${j.TILE_URL_VERSION}/`,"")}`;let x=h.params;return a&&(x=x.filter(w=>!w.match(/^access_token=/))),x.length&&(m+=`?${x.join("&")}`),m}canonicalizeTileset(c,a){const h=!!a&&nt(a),m=[];for(const x of c.tiles||[])kt(x)?m.push(this.canonicalizeTileURL(x,h)):m.push(x);return m}_makeAPIURL(c,a){const h="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",m=Mn(j.API_URL);if(c.protocol=m.protocol,c.authority=m.authority,c.protocol==="http"){const x=c.params.indexOf("secure");x>=0&&c.params.splice(x,1)}if(m.path!=="/"&&(c.path=`${m.path}${c.path}`),!j.REQUIRE_ACCESS_TOKEN)return Jt(c);if(a=a||j.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${h}`);if(a[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${h}`)}return c.params=c.params.filter(x=>x.indexOf("access_token")===-1),c.params.push(`access_token=${a||""}`),Jt(c)}},l.ResourceType=$i,l.SegmentVector=Co,l.SourceCache=l1,l.StencilMode=l6,l.StructArrayLayout1ui2=Vl,l.StructArrayLayout2f1f2i16=Xr,l.StructArrayLayout2i4=Zn,l.StructArrayLayout2ui4=Ra,l.StructArrayLayout3f12=Ci,l.StructArrayLayout3ui6=Hr,l.StructArrayLayout4i8=wn,l.StructArrayLayout5f20=Os,l.Texture=sw,l.Tile=o6,l.Transitionable=be,l.Uniform1f=lg,l.Uniform1i=class extends Ah{constructor(c){super(c),this.current=0}set(c,a,h){this.fetchUniformLocation(c,a)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},l.Uniform2f=class extends Ah{constructor(c){super(c),this.current=[0,0]}set(c,a,h){this.fetchUniformLocation(c,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}},l.Uniform3f=class extends Ah{constructor(c){super(c),this.current=[0,0,0]}set(c,a,h){this.fetchUniformLocation(c,a)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}},l.Uniform4f=Cd,l.UniformColor=M3,l.UniformMatrix2f=class extends Ah{constructor(c){super(c),this.current=k3}set(c,a,h){if(this.fetchUniformLocation(c,a)){for(let m=0;m<4;m++)if(h[m]!==this.current[m]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}},l.UniformMatrix3f=class extends Ah{constructor(c){super(c),this.current=qu}set(c,a,h){if(this.fetchUniformLocation(c,a)){for(let m=0;m<9;m++)if(h[m]!==this.current[m]){this.current=h,this.gl.uniformMatrix3fv(this.location,!1,h);break}}}},l.UniformMatrix4f=class extends Ah{constructor(c){super(c),this.current=O9}set(c,a,h){if(this.fetchUniformLocation(c,a)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let m=1;m<16;m++)if(h[m]!==this.current[m]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}},l.UnwrappedTileID=ke,l.ValidationError=br,l.VectorTileFeature=n1,l.VectorTileWorkerSource=class extends rl{constructor(c,a,h,m,x){super(),this.actor=c,this.layerIndex=a,this.availableImages=h,this.loadVectorData=x||QA,this.loading={},this.loaded={},this.deduped=new JA(c.scheduler),this.isSpriteLoaded=m,this.scheduler=c.scheduler}loadTile(c,a){const h=c.uid,m=c&&c.request,x=m&&m.collectResourceTiming,w=this.loading[h]=new gW(c);w.abort=this.loadVectorData(c,(k,A)=>{const N=!this.loading[h];if(delete this.loading[h],N||k||!A)return w.status="done",N||(this.loaded[h]=w),a(k);const z=A.rawData,V={};A.expires&&(V.expires=A.expires),A.cacheControl&&(V.cacheControl=A.cacheControl),w.vectorTile=A.vectorTile||new t1(new s1(z));const X=()=>{w.parse(w.vectorTile,this.layerIndex,this.availableImages,this.actor,(ee,ae)=>{if(ee||!ae)return a(ee);const he={};if(x){const Te=Ia(m);Te.length>0&&(he.resourceTiming=JSON.parse(JSON.stringify(Te)))}a(null,ht({rawTileData:z.slice(0)},ae,V,he))})};this.isSpriteLoaded?X():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(X,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):X()}),this.loaded=this.loaded||{},this.loaded[h]=w})}reloadTile(c,a){const h=this.loaded,m=c.uid,x=this;if(h&&h[m]){const w=h[m];w.showCollisionBoxes=c.showCollisionBoxes,w.enableTerrain=!!c.enableTerrain,w.projection=c.projection,w.tileTransform=a1(c.tileID.canonical,c.projection);const k=(A,N)=>{const z=w.reloadCallback;z&&(delete w.reloadCallback,w.parse(w.vectorTile,x.layerIndex,this.availableImages,x.actor,z)),a(A,N)};w.status==="parsing"?w.reloadCallback=k:w.status==="done"&&(w.vectorTile?w.parse(w.vectorTile,this.layerIndex,this.availableImages,this.actor,k):k())}}abortTile(c,a){const h=c.uid,m=this.loading[h];m&&(m.abort&&m.abort(),delete this.loading[h]),a()}removeTile(c,a){const h=this.loaded,m=c.uid;h&&h[m]&&delete h[m],a()}},l.WritingMode=ft,l.ZoomDependentExpression=Up,l.add=Ph,l.addDynamicAttributes=S4,l.adjoint=function(c,a){var h=a[0],m=a[1],x=a[2],w=a[3],k=a[4],A=a[5],N=a[6],z=a[7],V=a[8];return c[0]=k*V-A*z,c[1]=x*z-m*V,c[2]=m*A-x*k,c[3]=A*N-w*V,c[4]=h*V-x*N,c[5]=x*w-h*A,c[6]=w*z-k*N,c[7]=m*N-h*z,c[8]=h*k-m*w,c},l.asyncAll=rt,l.bezier=ge,l.bindAll=Li,l.boundsAttributes=DA,l.bufferConvexPolygon=function(c,a){const h=[];for(let m=0;m<c.length;m++){const x=Je(m-1,-1,c.length-1),w=Je(m+1,-1,c.length-1),k=c[m],A=c[w],N=c[x].sub(k).unit(),z=A.sub(k).unit(),V=z.angleWithSep(N.x,N.y),X=N.add(z).unit().mult(-1*a/Math.sin(V/2));h.push(k.add(X))}return h},l.cacheEntryPossiblyAdded=function(c){is++,is>Er&&(c.getActor().send("enforceCacheSizeLimit",qn),is=0)},l.calculateGlobeLabelMatrix=function(c,a){const{x:h,y:m}=c.point,x=Ld(h,m,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Of(x,x,wo(Kc(a)))},l.calculateGlobeMatrix=function(c){const{x:a,y:h}=c.point,{lng:m,lat:x}=c._center;return Ld(a,h,c.worldSize,m,x)},l.calculateGlobeMercatorMatrix=function(c){const a=c.pixelsPerMeter,h=a/Hl(1,c.center.lat),m=_c(new Float64Array(16));return cg(m,m,[c.point.x,c.point.y,0]),Ff(m,m,[h,h,a]),Float32Array.from(m)},l.circumferenceAtLatitude=xg,l.clamp=Ce,l.clearTileCache=function(c){if(!Fr())return;const a=E.caches.delete(On);c&&a.catch(c).then(()=>c())},l.clipLine=yA,l.clone=function(c){var a=new Io(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},l.clone$1=Mi,l.collisionCircleLayout=Fn,l.config=j,l.conjugate=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},l.create=function(){var c=new Io(16);return Io!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},l.create$1=C0,l.createExpression=Bp,l.createLayout=Bt,l.createStyleLayer=function(c){return c.type==="custom"?new sW(c):new aW[c.type](c)},l.cross=I3,l.degToRad=qe,l.distance=function(c,a){return Math.hypot(a[0]-c[0],a[1]-c[1],a[2]-c[2])},l.div=function(c,a,h){return c[0]=a[0]/h[0],c[1]=a[1]/h[1],c[2]=a[2]/h[2],c},l.dot=Zc,l.earthRadius=Uf,l.ease=xe,l.easeCubicInOut=ye,l.ecefToLatLng=function([c,a,h]){const m=Math.hypot(c,a,h),x=Math.atan2(c,h),w=.5*Math.PI-Math.acos(-a/m);return new ms(et(x),et(w))},l.emitValidationErrors=Lv,l.endsWith=wi,l.enforceCacheSizeLimit=function(c){Tr(),Sr&&Sr.then(a=>{a.keys().then(h=>{for(let m=0;m<h.length-c;m++)a.delete(h[m])})})},l.evaluateSizeForFeature=dr,l.evaluateSizeForZoom=hn,l.evaluateVariableOffset=wA,l.evented=C,l.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},l.exactEquals$1=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]},l.exported=bo,l.exported$1=$,l.extend=ht,l.extend$1=ko,l.fillExtrusionHeightLift=G,l.filterObject=fi,l.fromMat4=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},l.fromQuat=function(c,a){var h=a[0],m=a[1],x=a[2],w=a[3],k=h+h,A=m+m,N=x+x,z=h*k,V=m*k,X=m*A,ee=x*k,ae=x*A,he=x*N,Te=w*k,Oe=w*A,Ze=w*N;return c[0]=1-X-he,c[1]=V+Ze,c[2]=ee-Oe,c[3]=0,c[4]=V-Ze,c[5]=1-z-he,c[6]=ae+Te,c[7]=0,c[8]=ee+Oe,c[9]=ae-Te,c[10]=1-z-X,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},l.fromRotation=function(c,a){var h=Math.sin(a),m=Math.cos(a);return c[0]=m,c[1]=h,c[2]=0,c[3]=-h,c[4]=m,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},l.fromScaling=A0,l.furthestTileCorner=function(c){const a=Math.round((c+45+360)%360/90)%4;return Q[a]},l.getAABBPointSquareDist=function(c,a,h){let m=0;for(let x=0;x<2;++x){const w=h?h[x]:0;c[x]>w&&(m+=(c[x]-w)*(c[x]-w)),a[x]<w&&(m+=(w-a[x])*(w-a[x]))}return m},l.getAnchorAlignment=Gi,l.getAnchorJustification=e6,l.getBounds=function(c){let a=1/0,h=1/0,m=-1/0,x=-1/0;for(const w of c)a=Math.min(a,w.x),h=Math.min(h,w.y),m=Math.max(m,w.x),x=Math.max(x,w.y);return{min:new We(a,h),max:new We(m,x)}},l.getColumn=en,l.getDefaultExportFromCjs=ce,l.getGridMatrix=function(c,a,h,m){const x=a.getNorth(),w=a.getSouth(),k=a.getWest(),A=a.getEast(),N=1<<c.z,z=A-k,V=x-w,X=z/Id,ee=-V/Ad[h],ae=[0,X,0,ee,0,0,x,k,0];if(c.z>0){const he=180/m;Dv(ae,ae,[he/z+1,0,0,0,he/V+1,0,-.5*he/X,.5*he/ee,1])}return ae[2]=N,ae[5]=c.x,ae[8]=c.y,ae},l.getImage=Ae,l.getJSON=function(c,a){return Vn(ht(c,{type:"json"}),a)},l.getLatitudinalLod=function(c){const a=co-5;c=Ce(c,-a,a)/a*90;const h=Math.pow(Math.abs(Math.sin(qe(c))),3);return Math.round(h*(Ad.length-1))},l.getMapSessionAPI=Us,l.getPerformanceMeasurement=Ia,l.getProjection=AA,l.getRTLTextPluginStatus=L,l.getReferrer=vo,l.getTilePoint=function(c,{x:a,y:h},m=0){return new We(((a-m)*c.scale-c.x)*Yr,(h*c.scale-c.y)*Yr)},l.getTileVec3=function(c,a,h=0){return zf(((a.x-h)*c.scale-c.x)*Yr,(a.y*c.scale-c.y)*Yr,Wl(a.z,a.y))},l.getVideo=function(c,a){const h=E.document.createElement("video");h.muted=!0,h.onloadstart=function(){a(null,h)};for(let m=0;m<c.length;m++){const x=E.document.createElement("source");Ps(c[m])||(h.crossOrigin="Anonymous"),x.src=c[m],h.appendChild(x)}return{cancel:()=>{}}},l.globeCenterToScreenPoint=function(c){const a=[0,0,0],h=_c(new Float64Array(16));return Of(h,c.pixelMatrix,c.globeMatrix),Ho(a,a,h),new We(a[0],a[1])},l.globeDenormalizeECEF=wo,l.globeECEFOrigin=function(c,a){const h=[0,0,0];return Ho(h,h,V_(Kc(a.canonical))),Ho(h,h,c),h},l.globeMetersToEcef=mg,l.globeNormalizeECEF=V_,l.globePixelsToTileUnits=function(c,a){return Yr/(512*Math.pow(2,c))*U0(Kc(a))},l.globePoleMatrixForTile=function(c,a,h){const m=_c(new Float64Array(16)),x=(a/(1<<c)-.5)*Math.PI*2;return R_(m,h.globeMatrix,x),Float32Array.from(m)},l.globeTileBounds=Kc,l.globeTiltAtLngLat=Gv,l.globeToMercatorTransition=_g,l.globeUseCustomAntiAliasing=function(c,a,h){const m=_g(h.zoom),x=c.style.map._antialias,w=!!a.extStandardDerivatives,k=a.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return m===0&&!x&&!k&&w},l.identity=_c,l.identity$1=L3,l.invert=I0,l.isFullscreen=function(){return!!E.document.fullscreenElement||!!E.document.webkitFullscreenElement},l.isLngLatBehindGlobe=Hv,l.isMapAuthenticated=function(c){return uo.has(c)},l.isMapboxURL=nt,l.isSafariWithAntialiasingBug=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!Rt(c)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},l.latFromMercatorY=sl,l.latLngToECEF=Yp,l.len=VM,l.length=R0,l.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},l.lngFromMercatorX=Su,l.loadVectorTile=QA,l.makeRequest=Vn,l.mapValue=function(c,a,h,m,x){return Ce((c-a)/(h-a)*(x-m)+m,m,x)},l.mercatorScale=Qc,l.mercatorXfromLng=Xu,l.mercatorYfromLat=Pd,l.mercatorZfromAltitude=Hl,l.mul=Ov,l.mul$1=A3,l.multiply=Of,l.multiply$1=Dv,l.multiply$2=Fv,l.nextPowerOfTwo=rr,l.normalize=su,l.normalize$1=U_,l.normalize$2=U9,l.number=Yi,l.ortho=function(c,a,h,m,x,w,k){var A=1/(a-h),N=1/(m-x),z=1/(w-k);return c[0]=-2*A,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*N,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*z,c[11]=0,c[12]=(a+h)*A,c[13]=(x+m)*N,c[14]=(k+w)*z,c[15]=1,c},l.pbf=Wr,l.perspective=function(c,a,h,m,x){var w,k=1/Math.tan(a/2);return c[0]=k/h,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=k,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,x!=null&&x!==1/0?(c[10]=(x+m)*(w=1/(m-x)),c[14]=2*x*m*w):(c[10]=-1,c[14]=-2*m),c},l.pick=function(c,a){const h={};for(let m=0;m<a.length;m++){const x=a[m];x in c&&(h[x]=c[x])}return h},l.plugin=U,l.pointGeometry=ut,l.polesInViewport=function(c){const a=_c(new Float64Array(16));Of(a,c.pixelMatrix,c.globeMatrix);const h=[0,El,0],m=[0,Sl,0];return Ho(h,h,a),Ho(m,m,a),[h[0]>0&&h[0]<=c.width&&h[1]>0&&h[1]<=c.height&&!Hv(c,new ms(c.center.lat,90)),m[0]>0&&m[0]<=c.width&&m[1]>0&&m[1]<=c.height&&!Hv(c,new ms(c.center.lat,-90))]},l.polygonContainsPoint=Vf,l.polygonIntersectsBox=Xv,l.polygonIntersectsPolygon=z3,l.polygonizeBounds=function(c,a,h=0,m=!0){const x=new We(h,h),w=c.sub(x),k=a.add(x),A=[w,new We(k.x,w.y),k,new We(w.x,k.y)];return m&&A.push(w.clone()),A},l.posAttributes=dg,l.postMapLoadEvent=Hi,l.postPerformanceEvent=ss,l.postTurnstileEvent=pi,l.potpack=K3,l.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},l.radToDeg=et,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(c){return c({pluginStatus:b,pluginURL:d}),C.on("pluginStateChange",c),c},l.removeAuthState=function(c){uo.delete(c)},l.renderColorRamp=Jv,l.resample=F3,l.rotateX=P_,l.rotateX$1=z_,l.rotateY=R_,l.rotateY$1=B_,l.rotateZ=function(c,a,h){var m=Math.sin(h),x=Math.cos(h),w=a[0],k=a[1],A=a[2],N=a[3],z=a[4],V=a[5],X=a[6],ee=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=w*x+z*m,c[1]=k*x+V*m,c[2]=A*x+X*m,c[3]=N*x+ee*m,c[4]=z*x-w*m,c[5]=V*x-k*m,c[6]=X*x-A*m,c[7]=ee*x-N*m,c},l.rotateZ$1=function(c,a,h){h*=.5;var m=a[0],x=a[1],w=a[2],k=a[3],A=Math.sin(h),N=Math.cos(h);return c[0]=m*N+x*A,c[1]=x*N-m*A,c[2]=w*N+k*A,c[3]=k*N-w*A,c},l.scale=Ff,l.scale$1=hg,l.scale$2=Ja,l.scaleAndAdd=Bf,l.set=function(c,a,h,m){return c[0]=a,c[1]=h,c[2]=m,c},l.setCacheLimits=function(c,a){qn=c,Er=a},l.setColumn=function(c,a,h){c[4*a+0]=h[0],c[4*a+1]=h[1],c[4*a+2]=h[2],c[4*a+3]=h[3]},l.setRTLTextPlugin=function(c,a,h=!1){if(b===T_||b===M_||b===k_)throw new Error("setRTLTextPlugin cannot be called multiple times.");d=bo.resolveURL(c),b=T_,Af=a,T(),h||B()},l.smoothstep=tt,l.spec=Nt,l.squaredLength=function(c){var a=c[0],h=c[1],m=c[2];return a*a+h*h+m*m},l.storeAuthState=function(c,a){a?uo.add(c):uo.delete(c)},l.sub=Rh,l.subtract=N0,l.symbolSize=dt,l.tileAABB=function(c,a,h,m,x,w,k,A,N){if(N.name==="globe")return jv(c,a,new de(h,m,x));const z=a1({z:h,x:m,y:x},N);return new Ao([(w+z.x/z.scale)*a,a*(z.y/z.scale),k],[(w+z.x2/z.scale)*a,a*(z.y2/z.scale),A])},l.tileCornersToBounds=B0,l.tileTransform=a1,l.transformMat3=function(c,a,h){var m=a[0],x=a[1],w=a[2];return c[0]=m*h[0]+x*h[3]+w*h[6],c[1]=m*h[1]+x*h[4]+w*h[7],c[2]=m*h[2]+x*h[5]+w*h[8],c},l.transformMat4=Ho,l.transformMat4$1=no,l.transformQuat=B9,l.transitionTileAABBinECEF=N3,l.translate=cg,l.transpose=function(c,a){if(c===a){var h=a[1],m=a[2],x=a[5];c[1]=a[3],c[2]=a[6],c[3]=h,c[5]=a[7],c[6]=m,c[7]=x}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},l.triggerPluginCompletionEvent=v,l.uniqueId=Nn,l.updateGlobeVertexNormal=function(c,a,h,m,x){const w=5*a+2;c.float32[w+0]=h,c.float32[w+1]=m,c.float32[w+2]=x},l.validateCustomStyleLayer=function(c){const a=[],h=c.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),c.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},l.validateFilter=c=>Hu(ig(c)),l.validateFog=c=>Hu(Cv(c)),l.validateLayer=c=>Hu(Sv(c)),l.validateLight=c=>Hu(kv(c)),l.validateSource=c=>Hu(Mv(c)),l.validateStyle=Av,l.validateTerrain=c=>Hu(b_(c)),l.values=Ut,l.vectorTile=Q_,l.version=P,l.warnOnce=Be,l.window=E,l.wrap=Je}),p(["./shared"],function(l){function E(ct){if(typeof ct=="number"||typeof ct=="boolean"||typeof ct=="string"||ct==null)return JSON.stringify(ct);if(Array.isArray(ct)){let le="[";for(const Ae of ct)le+=`${E(Ae)},`;return`${le}]`}let se="{";for(const le of Object.keys(ct).sort())se+=`${le}:${E(ct[le])},`;return`${se}}`}function P(ct){let se="";for(const le of l.refProperties)se+=`/${E(ct[le])}`;return se}class O{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,le){for(const Fe of se)this._layerConfigs[Fe.id]=Fe,(this._layers[Fe.id]=l.createStyleLayer(Fe)).compileFilter(),this.keyCache[Fe.id]&&delete this.keyCache[Fe.id];for(const Fe of le)delete this.keyCache[Fe],delete this._layerConfigs[Fe],delete this._layers[Fe];this.familiesBySource={};const Ae=function(Fe,nt){const kt={};for(let at=0;at<Fe.length;at++){const me=nt&&nt[Fe[at].id]||P(Fe[at]);nt&&(nt[Fe[at].id]=me);let fn=kt[me];fn||(fn=kt[me]=[]),fn.push(Fe[at])}const Tt=[];for(const at in kt)Tt.push(kt[at]);return Tt}(l.values(this._layerConfigs),this.keyCache);for(const Fe of Ae){const nt=Fe.map(Mn=>this._layers[Mn.id]),kt=nt[0];if(kt.visibility==="none")continue;const Tt=kt.source||"";let at=this.familiesBySource[Tt];at||(at=this.familiesBySource[Tt]={});const me=kt.sourceLayer||"_geojsonTileLayer";let fn=at[me];fn||(fn=at[me]=[]),fn.push(nt)}}}class j{loadTile(se,le){const{uid:Ae,encoding:Fe,rawImageData:nt,padding:kt,buildQuadTree:Tt}=se,at=l.window.ImageBitmap&&nt instanceof l.window.ImageBitmap?this.getImageData(nt,kt):nt;le(null,new l.DEMData(Ae,at,Fe,kt<1,Tt))}getImageData(se,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(se.width,se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=se.width,this.offscreenCanvas.height=se.height,this.offscreenCanvasContext.drawImage(se,0,0,se.width,se.height);const Ae=this.offscreenCanvasContext.getImageData(-le,-le,se.width+2*le,se.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ae}}function $(ct,se){if(ct.length!==0){Y(ct[0],se);for(var le=1;le<ct.length;le++)Y(ct[le],!se)}}function Y(ct,se){for(var le=0,Ae=0,Fe=0,nt=ct.length,kt=nt-1;Fe<nt;kt=Fe++){var Tt=(ct[Fe][0]-ct[kt][0])*(ct[kt][1]+ct[Fe][1]),at=le+Tt;Ae+=Math.abs(le)>=Math.abs(Tt)?le-at+Tt:Tt-at+le,le=at}le+Ae>=0!=!!se&&ct.reverse()}var re=l.getDefaultExportFromCjs(function ct(se,le){var Ae,Fe=se&&se.type;if(Fe==="FeatureCollection")for(Ae=0;Ae<se.features.length;Ae++)ct(se.features[Ae],le);else if(Fe==="GeometryCollection")for(Ae=0;Ae<se.geometries.length;Ae++)ct(se.geometries[Ae],le);else if(Fe==="Feature")ct(se.geometry,le);else if(Fe==="Polygon")$(se.coordinates,le);else if(Fe==="MultiPolygon")for(Ae=0;Ae<se.coordinates.length;Ae++)$(se.coordinates[Ae],le);return se});const _e=l.VectorTileFeature.prototype.toGeoJSON;var J={exports:{}},H=l.pointGeometry,te=l.vectorTile.VectorTileFeature,ce=Se;function Se(ct,se){this.options=se||{},this.features=ct,this.length=ct.length}function Ie(ct,se){this.id=typeof ct.id=="number"?ct.id:void 0,this.type=ct.type,this.rawGeometry=ct.type===1?[ct.geometry]:ct.geometry,this.properties=ct.tags,this.extent=se||4096}Se.prototype.feature=function(ct){return new Ie(this.features[ct],this.options.extent)},Ie.prototype.loadGeometry=function(){var ct=this.rawGeometry;this.geometry=[];for(var se=0;se<ct.length;se++){for(var le=ct[se],Ae=[],Fe=0;Fe<le.length;Fe++)Ae.push(new H(le[Fe][0],le[Fe][1]));this.geometry.push(Ae)}return this.geometry},Ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ct=this.geometry,se=1/0,le=-1/0,Ae=1/0,Fe=-1/0,nt=0;nt<ct.length;nt++)for(var kt=ct[nt],Tt=0;Tt<kt.length;Tt++){var at=kt[Tt];se=Math.min(se,at.x),le=Math.max(le,at.x),Ae=Math.min(Ae,at.y),Fe=Math.max(Fe,at.y)}return[se,Ae,le,Fe]},Ie.prototype.toGeoJSON=te.prototype.toGeoJSON;var Ne=l.pbf,ut=ce;function mt(ct){var se=new Ne;return function(le,Ae){for(var Fe in le.layers)Ae.writeMessage(3,We,le.layers[Fe])}(ct,se),se.finish()}function We(ct,se){var le;se.writeVarintField(15,ct.version||1),se.writeStringField(1,ct.name||""),se.writeVarintField(5,ct.extent||4096);var Ae={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<ct.length;le++)Ae.feature=ct.feature(le),se.writeMessage(2,Ot,Ae);var Fe=Ae.keys;for(le=0;le<Fe.length;le++)se.writeStringField(3,Fe[le]);var nt=Ae.values;for(le=0;le<nt.length;le++)se.writeMessage(4,ye,nt[le])}function Ot(ct,se){var le=ct.feature;le.id!==void 0&&se.writeVarintField(1,le.id),se.writeMessage(2,st,ct),se.writeVarintField(3,le.type),se.writeMessage(4,Q,le)}function st(ct,se){var le=ct.feature,Ae=ct.keys,Fe=ct.values,nt=ct.keycache,kt=ct.valuecache;for(var Tt in le.properties){var at=le.properties[Tt],me=nt[Tt];if(at!==null){me===void 0&&(Ae.push(Tt),nt[Tt]=me=Ae.length-1),se.writeVarint(me);var fn=typeof at;fn!=="string"&&fn!=="boolean"&&fn!=="number"&&(at=JSON.stringify(at));var Mn=fn+":"+at,Jt=kt[Mn];Jt===void 0&&(Fe.push(at),kt[Mn]=Jt=Fe.length-1),se.writeVarint(Jt)}}}function qe(ct,se){return(se<<3)+(7&ct)}function et(ct){return ct<<1^ct>>31}function Q(ct,se){for(var le=ct.loadGeometry(),Ae=ct.type,Fe=0,nt=0,kt=le.length,Tt=0;Tt<kt;Tt++){var at=le[Tt],me=1;Ae===1&&(me=at.length),se.writeVarint(qe(1,me));for(var fn=Ae===3?at.length-1:at.length,Mn=0;Mn<fn;Mn++){Mn===1&&Ae!==1&&se.writeVarint(qe(2,fn-1));var Jt=at[Mn].x-Fe,mr=at[Mn].y-nt;se.writeVarint(et(Jt)),se.writeVarint(et(mr)),Fe+=Jt,nt+=mr}Ae===3&&se.writeVarint(qe(7,1))}}function ye(ct,se){var le=typeof ct;le==="string"?se.writeStringField(1,ct):le==="boolean"?se.writeBooleanField(7,ct):le==="number"&&(ct%1!=0?se.writeDoubleField(3,ct):ct<0?se.writeSVarintField(6,ct):se.writeVarintField(5,ct))}J.exports=mt,J.exports.fromVectorTileJs=mt,J.exports.fromGeojsonVt=function(ct,se){se=se||{};var le={};for(var Ae in ct)le[Ae]=new ut(ct[Ae].features,se),le[Ae].name=Ae,le[Ae].version=se.version,le[Ae].extent=se.extent;return mt({layers:le})},J.exports.GeoJSONWrapper=ut;var ge=l.getDefaultExportFromCjs(J.exports);const xe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ct=>ct},Ce=Math.fround||(tt=new Float32Array(1),ct=>(tt[0]=+ct,tt[0]));var tt;const Je=3,rt=5,Ut=6;class ht{constructor(se){this.options=Object.assign(Object.create(xe),se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(se){const{log:le,minZoom:Ae,maxZoom:Fe}=this.options;le&&console.time("total time");const nt=`prepare ${se.length} points`;le&&console.time(nt),this.points=se;const kt=[];for(let at=0;at<se.length;at++){const me=se[at];if(!me.geometry)continue;const[fn,Mn]=me.geometry.coordinates,Jt=Ce(zn(fn)),mr=Ce(rr(Mn));kt.push(Jt,mr,1/0,at,-1,1),this.options.reduce&&kt.push(0)}let Tt=this.trees[Fe+1]=this._createTree(kt);le&&console.timeEnd(nt);for(let at=Fe;at>=Ae;at--){const me=+Date.now();Tt=this.trees[at]=this._createTree(this._cluster(Tt,at)),le&&console.log("z%d: %d clusters in %dms",at,Tt.numItems,+Date.now()-me)}return le&&console.timeEnd("total time"),this}getClusters(se,le){let Ae=((se[0]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,se[1]));let nt=se[2]===180?180:((se[2]+180)%360+360)%360-180;const kt=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)Ae=-180,nt=180;else if(Ae>nt){const Mn=this.getClusters([Ae,Fe,180,kt],le),Jt=this.getClusters([-180,Fe,nt,kt],le);return Mn.concat(Jt)}const Tt=this.trees[this._limitZoom(le)],at=Tt.range(zn(Ae),rr(kt),zn(nt),rr(Fe)),me=Tt.data,fn=[];for(const Mn of at){const Jt=this.stride*Mn;fn.push(me[Jt+rt]>1?Ft(me,Jt,this.clusterProps):this.points[me[Jt+Je]])}return fn}getChildren(se){const le=this._getOriginId(se),Ae=this._getOriginZoom(se),Fe="No cluster with the specified id.",nt=this.trees[Ae];if(!nt)throw new Error(Fe);const kt=nt.data;if(le*this.stride>=kt.length)throw new Error(Fe);const Tt=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),at=nt.within(kt[le*this.stride],kt[le*this.stride+1],Tt),me=[];for(const fn of at){const Mn=fn*this.stride;kt[Mn+4]===se&&me.push(kt[Mn+rt]>1?Ft(kt,Mn,this.clusterProps):this.points[kt[Mn+Je]])}if(me.length===0)throw new Error(Fe);return me}getLeaves(se,le,Ae){const Fe=[];return this._appendLeaves(Fe,se,le=le||10,Ae=Ae||0,0),Fe}getTile(se,le,Ae){const Fe=this.trees[this._limitZoom(se)],nt=Math.pow(2,se),{extent:kt,radius:Tt}=this.options,at=Tt/kt,me=(Ae-at)/nt,fn=(Ae+1+at)/nt,Mn={features:[]};return this._addTileFeatures(Fe.range((le-at)/nt,me,(le+1+at)/nt,fn),Fe.data,le,Ae,nt,Mn),le===0&&this._addTileFeatures(Fe.range(1-at/nt,me,1,fn),Fe.data,nt,Ae,nt,Mn),le===nt-1&&this._addTileFeatures(Fe.range(0,me,at/nt,fn),Fe.data,-1,Ae,nt,Mn),Mn.features.length?Mn:null}getClusterExpansionZoom(se){let le=this._getOriginZoom(se)-1;for(;le<=this.options.maxZoom;){const Ae=this.getChildren(se);if(le++,Ae.length!==1)break;se=Ae[0].properties.cluster_id}return le}_appendLeaves(se,le,Ae,Fe,nt){const kt=this.getChildren(le);for(const Tt of kt){const at=Tt.properties;if(at&&at.cluster?nt+at.point_count<=Fe?nt+=at.point_count:nt=this._appendLeaves(se,at.cluster_id,Ae,Fe,nt):nt<Fe?nt++:se.push(Tt),se.length===Ae)break}return nt}_createTree(se){const le=new l.KDBush(se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ae=0;Ae<se.length;Ae+=this.stride)le.add(se[Ae],se[Ae+1]);return le.finish(),le.data=se,le}_addTileFeatures(se,le,Ae,Fe,nt,kt){for(const Tt of se){const at=Tt*this.stride,me=le[at+rt]>1;let fn,Mn,Jt;if(me)fn=Nn(le,at,this.clusterProps),Mn=le[at],Jt=le[at+1];else{const zr=this.points[le[at+Je]];fn=zr.properties;const[Kr,pi]=zr.geometry.coordinates;Mn=zn(Kr),Jt=rr(pi)}const mr={type:1,geometry:[[Math.round(this.options.extent*(Mn*nt-Ae)),Math.round(this.options.extent*(Jt*nt-Fe))]],tags:fn};let Cr;Cr=me||this.options.generateId?le[at+Je]:this.points[le[at+Je]].id,Cr!==void 0&&(mr.id=Cr),kt.features.push(mr)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,le){const{radius:Ae,extent:Fe,reduce:nt,minPoints:kt}=this.options,Tt=Ae/(Fe*Math.pow(2,le)),at=se.data,me=[],fn=this.stride;for(let Mn=0;Mn<at.length;Mn+=fn){if(at[Mn+2]<=le)continue;at[Mn+2]=le;const Jt=at[Mn],mr=at[Mn+1],Cr=se.within(at[Mn],at[Mn+1],Tt),zr=at[Mn+rt];let Kr=zr;for(const pi of Cr){const Xi=pi*fn;at[Xi+2]>le&&(Kr+=at[Xi+rt])}if(Kr>zr&&Kr>=kt){let pi,Xi=Jt*zr,Hi=mr*zr,Zi=-1;const ss=((Mn/fn|0)<<5)+(le+1)+this.points.length;for(const xo of Cr){const Us=xo*fn;if(at[Us+2]<=le)continue;at[Us+2]=le;const uo=at[Us+rt];Xi+=at[Us]*uo,Hi+=at[Us+1]*uo,at[Us+4]=ss,nt&&(pi||(pi=this._map(at,Mn,!0),Zi=this.clusterProps.length,this.clusterProps.push(pi)),nt(pi,this._map(at,Us)))}at[Mn+4]=ss,me.push(Xi/Kr,Hi/Kr,1/0,ss,-1,Kr),nt&&me.push(Zi)}else{for(let pi=0;pi<fn;pi++)me.push(at[Mn+pi]);if(Kr>1)for(const pi of Cr){const Xi=pi*fn;if(!(at[Xi+2]<=le)){at[Xi+2]=le;for(let Hi=0;Hi<fn;Hi++)me.push(at[Xi+Hi])}}}}return me}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,le,Ae){if(se[le+rt]>1){const kt=this.clusterProps[se[le+Ut]];return Ae?Object.assign({},kt):kt}const Fe=this.points[se[le+Je]].properties,nt=this.options.map(Fe);return Ae&&nt===Fe?Object.assign({},nt):nt}}function Ft(ct,se,le){return{type:"Feature",id:ct[se+Je],properties:Nn(ct,se,le),geometry:{type:"Point",coordinates:[(Ae=ct[se],360*(Ae-.5)),Gr(ct[se+1])]}};var Ae}function Nn(ct,se,le){const Ae=ct[se+rt],Fe=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae,nt=ct[se+Ut],kt=nt===-1?{}:Object.assign({},le[nt]);return Object.assign(kt,{cluster:!0,cluster_id:ct[se+Je],point_count:Ae,point_count_abbreviated:Fe})}function zn(ct){return ct/360+.5}function rr(ct){const se=Math.sin(ct*Math.PI/180),le=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return le<0?0:le>1?1:le}function Gr(ct){const se=(180-360*ct)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function Li(ct,se,le,Ae){for(var Fe,nt=Ae,kt=le-se>>1,Tt=le-se,at=ct[se],me=ct[se+1],fn=ct[le],Mn=ct[le+1],Jt=se+3;Jt<le;Jt+=3){var mr=wi(ct[Jt],ct[Jt+1],at,me,fn,Mn);if(mr>nt)Fe=Jt,nt=mr;else if(mr===nt){var Cr=Math.abs(Jt-kt);Cr<Tt&&(Fe=Jt,Tt=Cr)}}nt>Ae&&(Fe-se>3&&Li(ct,se,Fe,Ae),ct[Fe+2]=nt,le-Fe>3&&Li(ct,Fe,le,Ae))}function wi(ct,se,le,Ae,Fe,nt){var kt=Fe-le,Tt=nt-Ae;if(kt!==0||Tt!==0){var at=((ct-le)*kt+(se-Ae)*Tt)/(kt*kt+Tt*Tt);at>1?(le=Fe,Ae=nt):at>0&&(le+=kt*at,Ae+=Tt*at)}return(kt=ct-le)*kt+(Tt=se-Ae)*Tt}function Nr(ct,se,le,Ae){var Fe={id:ct===void 0?null:ct,type:se,geometry:le,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(nt){var kt=nt.geometry,Tt=nt.type;if(Tt==="Point"||Tt==="MultiPoint"||Tt==="LineString")fi(nt,kt);else if(Tt==="Polygon"||Tt==="MultiLineString")for(var at=0;at<kt.length;at++)fi(nt,kt[at]);else if(Tt==="MultiPolygon")for(at=0;at<kt.length;at++)for(var me=0;me<kt[at].length;me++)fi(nt,kt[at][me])}(Fe),Fe}function fi(ct,se){for(var le=0;le<se.length;le+=3)ct.minX=Math.min(ct.minX,se[le]),ct.minY=Math.min(ct.minY,se[le+1]),ct.maxX=Math.max(ct.maxX,se[le]),ct.maxY=Math.max(ct.maxY,se[le+1])}function Mi(ct,se,le,Ae){if(se.geometry){var Fe=se.geometry.coordinates,nt=se.geometry.type,kt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Tt=[],at=se.id;if(le.promoteId?at=se.properties[le.promoteId]:le.generateId&&(at=Ae||0),nt==="Point")jn(Fe,Tt);else if(nt==="MultiPoint")for(var me=0;me<Fe.length;me++)jn(Fe[me],Tt);else if(nt==="LineString")Be(Fe,Tt,kt,!1);else if(nt==="MultiLineString"){if(le.lineMetrics){for(me=0;me<Fe.length;me++)Be(Fe[me],Tt=[],kt,!1),ct.push(Nr(at,"LineString",Tt,se.properties));return}ze(Fe,Tt,kt,!1)}else if(nt==="Polygon")ze(Fe,Tt,kt,!0);else{if(nt!=="MultiPolygon"){if(nt==="GeometryCollection"){for(me=0;me<se.geometry.geometries.length;me++)Mi(ct,{id:at,geometry:se.geometry.geometries[me],properties:se.properties},le,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<Fe.length;me++){var fn=[];ze(Fe[me],fn,kt,!0),Tt.push(fn)}}ct.push(Nr(at,nt,Tt,se.properties))}}function jn(ct,se){se.push(vt(ct[0])),se.push(Qe(ct[1])),se.push(0)}function Be(ct,se,le,Ae){for(var Fe,nt,kt=0,Tt=0;Tt<ct.length;Tt++){var at=vt(ct[Tt][0]),me=Qe(ct[Tt][1]);se.push(at),se.push(me),se.push(0),Tt>0&&(kt+=Ae?(Fe*me-at*nt)/2:Math.sqrt(Math.pow(at-Fe,2)+Math.pow(me-nt,2))),Fe=at,nt=me}var fn=se.length-3;se[2]=1,Li(se,0,fn,le),se[fn+2]=1,se.size=Math.abs(kt),se.start=0,se.end=se.size}function ze(ct,se,le,Ae){for(var Fe=0;Fe<ct.length;Fe++){var nt=[];Be(ct[Fe],nt,le,Ae),se.push(nt)}}function vt(ct){return ct/360+.5}function Qe(ct){var se=Math.sin(ct*Math.PI/180),le=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return le<0?0:le>1?1:le}function gt(ct,se,le,Ae,Fe,nt,kt,Tt){if(Ae/=se,nt>=(le/=se)&&kt<Ae)return ct;if(kt<le||nt>=Ae)return null;for(var at=[],me=0;me<ct.length;me++){var fn=ct[me],Mn=fn.geometry,Jt=fn.type,mr=Fe===0?fn.minX:fn.minY,Cr=Fe===0?fn.maxX:fn.maxY;if(mr>=le&&Cr<Ae)at.push(fn);else if(!(Cr<le||mr>=Ae)){var zr=[];if(Jt==="Point"||Jt==="MultiPoint")St(Mn,zr,le,Ae,Fe);else if(Jt==="LineString")Rt(Mn,zr,le,Ae,Fe,!1,Tt.lineMetrics);else if(Jt==="MultiLineString")en(Mn,zr,le,Ae,Fe,!1);else if(Jt==="Polygon")en(Mn,zr,le,Ae,Fe,!0);else if(Jt==="MultiPolygon")for(var Kr=0;Kr<Mn.length;Kr++){var pi=[];en(Mn[Kr],pi,le,Ae,Fe,!0),pi.length&&zr.push(pi)}if(zr.length){if(Tt.lineMetrics&&Jt==="LineString"){for(Kr=0;Kr<zr.length;Kr++)at.push(Nr(fn.id,Jt,zr[Kr],fn.tags));continue}Jt!=="LineString"&&Jt!=="MultiLineString"||(zr.length===1?(Jt="LineString",zr=zr[0]):Jt="MultiLineString"),Jt!=="Point"&&Jt!=="MultiPoint"||(Jt=zr.length===3?"Point":"MultiPoint"),at.push(Nr(fn.id,Jt,zr,fn.tags))}}}return at.length?at:null}function St(ct,se,le,Ae,Fe){for(var nt=0;nt<ct.length;nt+=3){var kt=ct[nt+Fe];kt>=le&&kt<=Ae&&(se.push(ct[nt]),se.push(ct[nt+1]),se.push(ct[nt+2]))}}function Rt(ct,se,le,Ae,Fe,nt,kt){for(var Tt,at,me=At(ct),fn=Fe===0?qn:Er,Mn=ct.start,Jt=0;Jt<ct.length-3;Jt+=3){var mr=ct[Jt],Cr=ct[Jt+1],zr=ct[Jt+2],Kr=ct[Jt+3],pi=ct[Jt+4],Xi=Fe===0?mr:Cr,Hi=Fe===0?Kr:pi,Zi=!1;kt&&(Tt=Math.sqrt(Math.pow(mr-Kr,2)+Math.pow(Cr-pi,2))),Xi<le?Hi>le&&(at=fn(me,mr,Cr,Kr,pi,le),kt&&(me.start=Mn+Tt*at)):Xi>Ae?Hi<Ae&&(at=fn(me,mr,Cr,Kr,pi,Ae),kt&&(me.start=Mn+Tt*at)):On(me,mr,Cr,zr),Hi<le&&Xi>=le&&(at=fn(me,mr,Cr,Kr,pi,le),Zi=!0),Hi>Ae&&Xi<=Ae&&(at=fn(me,mr,Cr,Kr,pi,Ae),Zi=!0),!nt&&Zi&&(kt&&(me.end=Mn+Tt*at),se.push(me),me=At(ct)),kt&&(Mn+=Tt)}var ss=ct.length-3;mr=ct[ss],Cr=ct[ss+1],zr=ct[ss+2],(Xi=Fe===0?mr:Cr)>=le&&Xi<=Ae&&On(me,mr,Cr,zr),ss=me.length-3,nt&&ss>=3&&(me[ss]!==me[0]||me[ss+1]!==me[1])&&On(me,me[0],me[1],me[2]),me.length&&se.push(me)}function At(ct){var se=[];return se.size=ct.size,se.start=ct.start,se.end=ct.end,se}function en(ct,se,le,Ae,Fe,nt){for(var kt=0;kt<ct.length;kt++)Rt(ct[kt],se,le,Ae,Fe,nt,!1)}function On(ct,se,le,Ae){ct.push(se),ct.push(le),ct.push(Ae)}function qn(ct,se,le,Ae,Fe,nt){var kt=(nt-se)/(Ae-se);return ct.push(nt),ct.push(le+(Fe-le)*kt),ct.push(1),kt}function Er(ct,se,le,Ae,Fe,nt){var kt=(nt-le)/(Fe-le);return ct.push(se+(Ae-se)*kt),ct.push(nt),ct.push(1),kt}function Sr(ct,se){for(var le=[],Ae=0;Ae<ct.length;Ae++){var Fe,nt=ct[Ae],kt=nt.type;if(kt==="Point"||kt==="MultiPoint"||kt==="LineString")Fe=Dr(nt.geometry,se);else if(kt==="MultiLineString"||kt==="Polygon"){Fe=[];for(var Tt=0;Tt<nt.geometry.length;Tt++)Fe.push(Dr(nt.geometry[Tt],se))}else if(kt==="MultiPolygon")for(Fe=[],Tt=0;Tt<nt.geometry.length;Tt++){for(var at=[],me=0;me<nt.geometry[Tt].length;me++)at.push(Dr(nt.geometry[Tt][me],se));Fe.push(at)}le.push(Nr(nt.id,kt,Fe,nt.tags))}return le}function Dr(ct,se){var le=[];le.size=ct.size,ct.start!==void 0&&(le.start=ct.start,le.end=ct.end);for(var Ae=0;Ae<ct.length;Ae+=3)le.push(ct[Ae]+se,ct[Ae+1],ct[Ae+2]);return le}function Fr(ct,se){if(ct.transformed)return ct;var le,Ae,Fe,nt=1<<ct.z,kt=ct.x,Tt=ct.y;for(le=0;le<ct.features.length;le++){var at=ct.features[le],me=at.geometry,fn=at.type;if(at.geometry=[],fn===1)for(Ae=0;Ae<me.length;Ae+=2)at.geometry.push(Tr(me[Ae],me[Ae+1],se,nt,kt,Tt));else for(Ae=0;Ae<me.length;Ae++){var Mn=[];for(Fe=0;Fe<me[Ae].length;Fe+=2)Mn.push(Tr(me[Ae][Fe],me[Ae][Fe+1],se,nt,kt,Tt));at.geometry.push(Mn)}}return ct.transformed=!0,ct}function Tr(ct,se,le,Ae,Fe,nt){return[Math.round(le*(ct*Ae-Fe)),Math.round(le*(se*Ae-nt))]}function Zr(ct,se,le,Ae,Fe){for(var nt=se===Fe.maxZoom?0:Fe.tolerance/((1<<se)*Fe.extent),kt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:Ae,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Tt=0;Tt<ct.length;Tt++){kt.numFeatures++,is(kt,ct[Tt],nt,Fe);var at=ct[Tt].minX,me=ct[Tt].minY,fn=ct[Tt].maxX,Mn=ct[Tt].maxY;at<kt.minX&&(kt.minX=at),me<kt.minY&&(kt.minY=me),fn>kt.maxX&&(kt.maxX=fn),Mn>kt.maxY&&(kt.maxY=Mn)}return kt}function is(ct,se,le,Ae){var Fe=se.geometry,nt=se.type,kt=[];if(nt==="Point"||nt==="MultiPoint")for(var Tt=0;Tt<Fe.length;Tt+=3)kt.push(Fe[Tt]),kt.push(Fe[Tt+1]),ct.numPoints++,ct.numSimplified++;else if(nt==="LineString")$i(kt,Fe,ct,le,!1,!1);else if(nt==="MultiLineString"||nt==="Polygon")for(Tt=0;Tt<Fe.length;Tt++)$i(kt,Fe[Tt],ct,le,nt==="Polygon",Tt===0);else if(nt==="MultiPolygon")for(var at=0;at<Fe.length;at++){var me=Fe[at];for(Tt=0;Tt<me.length;Tt++)$i(kt,me[Tt],ct,le,!0,Tt===0)}if(kt.length){var fn=se.tags||null;if(nt==="LineString"&&Ae.lineMetrics){for(var Mn in fn={},se.tags)fn[Mn]=se.tags[Mn];fn.mapbox_clip_start=Fe.start/Fe.size,fn.mapbox_clip_end=Fe.end/Fe.size}var Jt={geometry:kt,type:nt==="Polygon"||nt==="MultiPolygon"?3:nt==="LineString"||nt==="MultiLineString"?2:1,tags:fn};se.id!==null&&(Jt.id=se.id),ct.features.push(Jt)}}function $i(ct,se,le,Ae,Fe,nt){var kt=Ae*Ae;if(Ae>0&&se.size<(Fe?kt:Ae))le.numPoints+=se.length/3;else{for(var Tt=[],at=0;at<se.length;at+=3)(Ae===0||se[at+2]>kt)&&(le.numSimplified++,Tt.push(se[at]),Tt.push(se[at+1])),le.numPoints++;Fe&&function(me,fn){for(var Mn=0,Jt=0,mr=me.length,Cr=mr-2;Jt<mr;Cr=Jt,Jt+=2)Mn+=(me[Jt]-me[Cr])*(me[Jt+1]+me[Cr+1]);if(Mn>0===fn)for(Jt=0,mr=me.length;Jt<mr/2;Jt+=2){var zr=me[Jt],Kr=me[Jt+1];me[Jt]=me[mr-2-Jt],me[Jt+1]=me[mr-1-Jt],me[mr-2-Jt]=zr,me[mr-1-Jt]=Kr}}(Tt,nt),ct.push(Tt)}}function Xs(ct,se){var le=(se=this.options=function(Fe,nt){for(var kt in nt)Fe[kt]=nt[kt];return Fe}(Object.create(this.options),se)).debug;if(le&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ae=function(Fe,nt){var kt=[];if(Fe.type==="FeatureCollection")for(var Tt=0;Tt<Fe.features.length;Tt++)Mi(kt,Fe.features[Tt],nt,Tt);else Mi(kt,Fe.type==="Feature"?Fe:{geometry:Fe},nt);return kt}(ct,se);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ae=function(Fe,nt){var kt=nt.buffer/nt.extent,Tt=Fe,at=gt(Fe,1,-1-kt,kt,0,-1,2,nt),me=gt(Fe,1,1-kt,2+kt,0,-1,2,nt);return(at||me)&&(Tt=gt(Fe,1,-kt,1+kt,0,-1,2,nt)||[],at&&(Tt=Sr(at,1).concat(Tt)),me&&(Tt=Tt.concat(Sr(me,-1)))),Tt}(Ae,se),Ae.length&&this.splitTile(Ae,0,0,0),le&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vo(ct,se,le){return 32*((1<<ct)*le+se)+ct}function Vn(ct,se){const le=ct.tileID.canonical;if(!this._geoJSONIndex)return se(null,null);const Ae=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!Ae)return se(null,null);const Fe=new class{constructor(kt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=kt.length,this._features=kt}feature(kt){return new class{constructor(Tt){this._feature=Tt,this.extent=l.EXTENT,this.type=Tt.type,this.properties=Tt.tags,"id"in Tt&&!isNaN(Tt.id)&&(this.id=parseInt(Tt.id,10))}loadGeometry(){if(this._feature.type===1){const Tt=[];for(const at of this._feature.geometry)Tt.push([new l.Point(at[0],at[1])]);return Tt}{const Tt=[];for(const at of this._feature.geometry){const me=[];for(const fn of at)me.push(new l.Point(fn[0],fn[1]));Tt.push(me)}return Tt}}toGeoJSON(Tt,at,me){return _e.call(this,Tt,at,me)}}(this._features[kt])}}(Ae.features);let nt=ge(Fe);nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),se(null,{vectorTile:Fe,rawData:nt.buffer})}Xs.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Xs.prototype.splitTile=function(ct,se,le,Ae,Fe,nt,kt){for(var Tt=[ct,se,le,Ae],at=this.options,me=at.debug;Tt.length;){Ae=Tt.pop(),le=Tt.pop(),se=Tt.pop(),ct=Tt.pop();var fn=1<<se,Mn=vo(se,le,Ae),Jt=this.tiles[Mn];if(!Jt&&(me>1&&console.time("creation"),Jt=this.tiles[Mn]=Zr(ct,se,le,Ae,at),this.tileCoords.push({z:se,x:le,y:Ae}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,le,Ae,Jt.numFeatures,Jt.numPoints,Jt.numSimplified),console.timeEnd("creation"));var mr="z"+se;this.stats[mr]=(this.stats[mr]||0)+1,this.total++}if(Jt.source=ct,Fe){if(se===at.maxZoom||se===Fe)continue;var Cr=1<<Fe-se;if(le!==Math.floor(nt/Cr)||Ae!==Math.floor(kt/Cr))continue}else if(se===at.indexMaxZoom||Jt.numPoints<=at.indexMaxPoints)continue;if(Jt.source=null,ct.length!==0){me>1&&console.time("clipping");var zr,Kr,pi,Xi,Hi,Zi,ss=.5*at.buffer/at.extent,xo=.5-ss,Us=.5+ss,uo=1+ss;zr=Kr=pi=Xi=null,Hi=gt(ct,fn,le-ss,le+Us,0,Jt.minX,Jt.maxX,at),Zi=gt(ct,fn,le+xo,le+uo,0,Jt.minX,Jt.maxX,at),ct=null,Hi&&(zr=gt(Hi,fn,Ae-ss,Ae+Us,1,Jt.minY,Jt.maxY,at),Kr=gt(Hi,fn,Ae+xo,Ae+uo,1,Jt.minY,Jt.maxY,at),Hi=null),Zi&&(pi=gt(Zi,fn,Ae-ss,Ae+Us,1,Jt.minY,Jt.maxY,at),Xi=gt(Zi,fn,Ae+xo,Ae+uo,1,Jt.minY,Jt.maxY,at),Zi=null),me>1&&console.timeEnd("clipping"),Tt.push(zr||[],se+1,2*le,2*Ae),Tt.push(Kr||[],se+1,2*le,2*Ae+1),Tt.push(pi||[],se+1,2*le+1,2*Ae),Tt.push(Xi||[],se+1,2*le+1,2*Ae+1)}}},Xs.prototype.getTile=function(ct,se,le){var Ae=this.options,Fe=Ae.extent,nt=Ae.debug;if(ct<0||ct>24)return null;var kt=1<<ct,Tt=vo(ct,se=(se%kt+kt)%kt,le);if(this.tiles[Tt])return Fr(this.tiles[Tt],Fe);nt>1&&console.log("drilling down to z%d-%d-%d",ct,se,le);for(var at,me=ct,fn=se,Mn=le;!at&&me>0;)me--,fn=Math.floor(fn/2),Mn=Math.floor(Mn/2),at=this.tiles[vo(me,fn,Mn)];return at&&at.source?(nt>1&&console.log("found parent tile z%d-%d-%d",me,fn,Mn),nt>1&&console.time("drilling down"),this.splitTile(at.source,me,fn,Mn,ct,se,le),nt>1&&console.timeEnd("drilling down"),this.tiles[Tt]?Fr(this.tiles[Tt],Fe):null):null};class Di extends l.VectorTileWorkerSource{constructor(se,le,Ae,Fe,nt){super(se,le,Ae,Fe,Vn),nt&&(this.loadGeoJSON=nt)}loadData(se,le){const Ae=se&&se.request,Fe=Ae&&Ae.collectResourceTiming;this.loadGeoJSON(se,(nt,kt)=>{if(nt||!kt)return le(nt);if(typeof kt!="object")return le(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));{re(kt,!0);try{if(se.filter){const at=l.createExpression(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(at.result==="error")throw new Error(at.value.map(fn=>`${fn.key}: ${fn.message}`).join(", "));kt={type:"FeatureCollection",features:kt.features.filter(fn=>at.value.evaluate({zoom:0},fn))}}this._geoJSONIndex=se.cluster?new ht(function({superclusterOptions:at,clusterProperties:me}){if(!me||!at)return at;const fn={},Mn={},Jt={accumulated:null,zoom:0},mr={properties:null},Cr=Object.keys(me);for(const zr of Cr){const[Kr,pi]=me[zr],Xi=l.createExpression(pi),Hi=l.createExpression(typeof Kr=="string"?[Kr,["accumulated"],["get",zr]]:Kr);fn[zr]=Xi.value,Mn[zr]=Hi.value}return at.map=zr=>{mr.properties=zr;const Kr={};for(const pi of Cr)Kr[pi]=fn[pi].evaluate(Jt,mr);return Kr},at.reduce=(zr,Kr)=>{mr.properties=Kr;for(const pi of Cr)Jt.accumulated=zr[pi],zr[pi]=Mn[pi].evaluate(Jt,mr)},at}(se)).load(kt.features):function(at,me){return new Xs(at,me)}(kt,se.geojsonVtOptions)}catch(at){return le(at)}this.loaded={};const Tt={};if(Fe){const at=l.getPerformanceMeasurement(Ae);at&&(Tt.resourceTiming={},Tt.resourceTiming[se.source]=JSON.parse(JSON.stringify(at)))}le(null,Tt)}})}reloadTile(se,le){const Ae=this.loaded;return Ae&&Ae[se.uid]?super.reloadTile(se,le):this.loadTile(se,le)}loadGeoJSON(se,le){if(se.request)l.getJSON(se.request,le);else{if(typeof se.data!="string")return le(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(se.data))}catch{return le(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(se,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(se.clusterId))}catch(Ae){le(Ae)}}getClusterChildren(se,le){try{le(null,this._geoJSONIndex.getChildren(se.clusterId))}catch(Ae){le(Ae)}}getClusterLeaves(se,le){try{le(null,this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset))}catch(Ae){le(Ae)}}}class Ps{constructor(se){this.self=se,this.actor=new l.Actor(se,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=l.getProjection({name:"mercator"}),this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:Di},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,Ae)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=Ae},this.self.registerRTLTextPlugin=le=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=le.applyArabicShaping,l.plugin.processBidirectionalText=le.processBidirectionalText,l.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(se,le,Ae){delete this.layerIndexes[se],delete this.availableImages[se],delete this.workerSources[se],delete this.demWorkerSources[se],Ae()}checkIfReady(se,le,Ae){Ae()}setReferrer(se,le){this.referrer=le}spriteLoaded(se,le){this.isSpriteLoaded[se]=le;for(const Ae in this.workerSources[se]){const Fe=this.workerSources[se][Ae];for(const nt in Fe)Fe[nt]instanceof l.VectorTileWorkerSource&&(Fe[nt].isSpriteLoaded=le,Fe[nt].fire(new l.Event("isSpriteLoaded")))}}setImages(se,le,Ae){this.availableImages[se]=le;for(const Fe in this.workerSources[se]){const nt=this.workerSources[se][Fe];for(const kt in nt)nt[kt].availableImages=le}Ae()}enableTerrain(se,le,Ae){this.terrain=le,Ae()}setProjection(se,le){this.projections[se]=l.getProjection(le)}setLayers(se,le,Ae){this.getLayerIndex(se).replace(le),Ae()}updateLayers(se,le,Ae){this.getLayerIndex(se).update(le.layers,le.removedIds),Ae()}loadTile(se,le,Ae){const Fe=this.enableTerrain?l.extend({enableTerrain:this.terrain},le):le;Fe.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,le.type,le.source).loadTile(Fe,Ae)}loadDEMTile(se,le,Ae){const Fe=this.enableTerrain?l.extend({buildQuadTree:this.terrain},le):le;this.getDEMWorkerSource(se,le.source).loadTile(Fe,Ae)}reloadTile(se,le,Ae){const Fe=this.enableTerrain?l.extend({enableTerrain:this.terrain},le):le;Fe.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,le.type,le.source).reloadTile(Fe,Ae)}abortTile(se,le,Ae){this.getWorkerSource(se,le.type,le.source).abortTile(le,Ae)}removeTile(se,le,Ae){this.getWorkerSource(se,le.type,le.source).removeTile(le,Ae)}removeSource(se,le,Ae){if(!this.workerSources[se]||!this.workerSources[se][le.type]||!this.workerSources[se][le.type][le.source])return;const Fe=this.workerSources[se][le.type][le.source];delete this.workerSources[se][le.type][le.source],Fe.removeSource!==void 0?Fe.removeSource(le,Ae):Ae()}loadWorkerSource(se,le,Ae){try{this.self.importScripts(le.url),Ae()}catch(Fe){Ae(Fe.toString())}}syncRTLPluginState(se,le,Ae){try{l.plugin.setState(le);const Fe=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&Fe!=null){this.self.importScripts(Fe);const nt=l.plugin.isParsed();Ae(nt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Fe}`),nt)}}catch(Fe){Ae(Fe.toString())}}getAvailableImages(se){let le=this.availableImages[se];return le||(le=[]),le}getLayerIndex(se){let le=this.layerIndexes[se];return le||(le=this.layerIndexes[se]=new O),le}getWorkerSource(se,le,Ae){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][le]||(this.workerSources[se][le]={}),!this.workerSources[se][le][Ae]){const Fe={send:(nt,kt,Tt,at,me,fn)=>{this.actor.send(nt,kt,Tt,se,me,fn)},scheduler:this.actor.scheduler};this.workerSources[se][le][Ae]=new this.workerSourceTypes[le](Fe,this.getLayerIndex(se),this.getAvailableImages(se),this.isSpriteLoaded[se])}return this.workerSources[se][le][Ae]}getDEMWorkerSource(se,le){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][le]||(this.demWorkerSources[se][le]=new j),this.demWorkerSources[se][le]}enforceCacheSizeLimit(se,le){l.enforceCacheSizeLimit(le)}getWorkerPerformanceMetrics(se,le,Ae){Ae(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ps(self)),Ps}),p(["./shared"],function(l){function E(b,d){if(Array.isArray(b)){if(!Array.isArray(d)||b.length!==d.length)return!1;for(let v=0;v<b.length;v++)if(!E(b[v],d[v]))return!1;return!0}if(typeof b=="object"&&b!==null&&d!==null){if(typeof d!="object"||Object.keys(b).length!==Object.keys(d).length)return!1;for(const v in b)if(!E(b[v],d[v]))return!1;return!0}return b===d}var P=O;function O(b){return!function(d){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,C,L=new Blob([""],{type:"text/javascript"}),B=URL.createObjectURL(L);try{C=new Worker(B),T=!0}catch{T=!1}return C&&C.terminate(),URL.revokeObjectURL(B),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var C=T.getContext("2d");if(!C)return!1;var L=C.getImageData(0,0,1,1);return L&&L.width===T.width}()?(j[v=d&&d.failIfMajorPerformanceCaveat]===void 0&&(j[v]=function(T){var C,L=function(B){var U=document.createElement("canvas"),q=Object.create(O.webGLContextAttributes);return q.failIfMajorPerformanceCaveat=B,U.getContext("webgl",q)||U.getContext("experimental-webgl",q)}(T);if(!L)return!1;try{C=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!C||L.isContextLost())&&(L.shaderSource(C,"void main() {}"),L.compileShader(C),L.getShaderParameter(C,L.COMPILE_STATUS)===!0)}(v)),j[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var v}(b)}var j={};function $(b,d,v){const T=l.window.document.createElement(b);return d!==void 0&&(T.className=d),v&&v.appendChild(T),T}function Y(b,d,v){const T=l.window.document.createElementNS("http://www.w3.org/2000/svg",b);for(const C of Object.keys(d))T.setAttributeNS(null,C,d[C]);return v&&v.appendChild(T),T}O.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const re=l.window.document&&l.window.document.documentElement.style,_e=re&&re.userSelect!==void 0?"userSelect":"WebkitUserSelect";let J;function H(){re&&_e&&(J=re[_e],re[_e]="none")}function te(){re&&_e&&(re[_e]=J)}function ce(b){b.preventDefault(),b.stopPropagation(),l.window.removeEventListener("click",ce,!0)}function Se(){l.window.addEventListener("click",ce,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",ce,!0)},0)}function Ie(b,d){const v=b.getBoundingClientRect();return mt(b,v,d)}function Ne(b,d){const v=b.getBoundingClientRect(),T=[];for(let C=0;C<d.length;C++)T.push(mt(b,v,d[C]));return T}function ut(b){return l.window.InstallTrigger!==void 0&&b.button===2&&b.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button}function mt(b,d,v){const T=b.offsetWidth===d.width?1:b.offsetWidth/d.width;return new l.Point((v.clientX-d.left)*T,(v.clientY-d.top)*T)}function We(b,d){var v=d[0],T=d[1],C=d[2],L=d[3],B=v*L-C*T;return B?(b[0]=L*(B=1/B),b[1]=-T*B,b[2]=-C*B,b[3]=v*B,b):null}function Ot(b){const{userImage:d}=b;return!!(d&&d.render&&d.render())&&(b.data.replace(new Uint8Array(d.data.buffer)),!0)}class st extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d,d)){for(const{ids:v,callback:T}of this.requestors)this._notify(v,T);this.requestors=[]}}hasImage(d){return!!this.getImage(d)}getImage(d){return this.images[d]}addImage(d,v){this._validate(d,v)&&(this.images[d]=v)}_validate(d,v){let T=!0;return this._validateStretch(v.stretchX,v.data&&v.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),T=!1),this._validateStretch(v.stretchY,v.data&&v.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),T=!1),this._validateContent(v.content,v)||(this.fire(new l.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),T=!1),T}_validateStretch(d,v){if(!d)return!0;let T=0;for(const C of d){if(C[0]<T||C[1]<C[0]||v<C[1])return!1;T=C[1]}return!0}_validateContent(d,v){return!(d&&(d.length!==4||d[0]<0||v.data.width<d[0]||d[1]<0||v.data.height<d[1]||d[2]<0||v.data.width<d[2]||d[3]<0||v.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,v){v.version=this.images[d].version+1,this.images[d]=v,this.updatedImages[d]=!0}removeImage(d){const v=this.images[d];delete this.images[d],delete this.patterns[d],v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d,v){let T=!0;if(!this.isLoaded())for(const C of d)this.images[C]||(T=!1);this.isLoaded()||T?this._notify(d,v):this.requestors.push({ids:d,callback:v})}_notify(d,v){const T={};for(const C of d){this.images[C]||this.fire(new l.Event("styleimagemissing",{id:C}));const L=this.images[C];L?T[C]={data:L.data.clone(),pixelRatio:L.pixelRatio,sdf:L.sdf,version:L.version,stretchX:L.stretchX,stretchY:L.stretchY,content:L.content,hasRenderCallback:!!(L.userImage&&L.userImage.render)}:l.warnOnce(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}v(null,T)}getPixelSize(){const{width:d,height:v}=this.atlasImage;return{width:d,height:v}}getPattern(d){const v=this.patterns[d],T=this.getImage(d);if(!T)return null;if(v&&v.position.version===T.version)return v.position;if(v)v.position.version=T.version;else{const C={w:T.data.width+2,h:T.data.height+2,x:0,y:0},L=new l.ImagePosition(C,T);this.patterns[d]={bin:C,position:L}}return this._updatePatternAtlas(),this.patterns[d].position}bind(d){const v=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(d,this.atlasImage,v.RGBA),this.atlasTexture&&this.atlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE)}_updatePatternAtlas(){const d=[];for(const L in this.patterns)d.push(this.patterns[L].bin);const{w:v,h:T}=l.potpack(d),C=this.atlasImage;C.resize({width:v||1,height:T||1});for(const L in this.patterns){const{bin:B}=this.patterns[L],U=B.x+1,q=B.y+1,ie=this.images[L].data,ne=ie.width,be=ie.height;l.RGBAImage.copy(ie,C,{x:0,y:0},{x:U,y:q},{width:ne,height:be}),l.RGBAImage.copy(ie,C,{x:0,y:be-1},{x:U,y:q-1},{width:ne,height:1}),l.RGBAImage.copy(ie,C,{x:0,y:0},{x:U,y:q+be},{width:ne,height:1}),l.RGBAImage.copy(ie,C,{x:ne-1,y:0},{x:U-1,y:q},{width:1,height:be}),l.RGBAImage.copy(ie,C,{x:0,y:0},{x:U+ne,y:q},{width:1,height:be})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const v of d){if(this.callbackDispatchedThisFrame[v])continue;this.callbackDispatchedThisFrame[v]=!0;const T=this.images[v];Ot(T)&&this.updateImage(v,T)}}}const qe=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(b,d){return function([v,T,C]){const L=l.degToRad(T+90),B=l.degToRad(C);return{x:v*Math.cos(L)*Math.sin(B),y:v*Math.sin(L)*Math.sin(B),z:v*Math.cos(B),azimuthal:T,polar:C}}(b.expression.evaluate(d))}interpolate(b,d,v){return{x:l.number(b.x,d.x,v),y:l.number(b.y,d.y,v),z:l.number(b.z,d.z,v),azimuthal:l.number(b.azimuthal,d.azimuthal,v),polar:l.number(b.polar,d.polar,v)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)});class et extends l.Evented{constructor(d){super(),this._transitionable=new l.Transitionable(qe),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,v={}){if(!this._validate(l.validateLight,d,v))for(const T in d){const C=d[T];l.endsWith(T,"-transition")?this._transitionable.setTransition(T.slice(0,-11),C):this._transitionable.setValue(T,C)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,v,T){return(!T||T.validate!==!1)&&l.emitValidationErrors(this,d.call(l.validateStyle,l.extend({value:v,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const Q=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)});let ye=class extends l.Evented{constructor(b,d){super(),this._transitionable=new l.Transitionable(Q),this.set(b),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(b){for(const d in b){const v=b[d];l.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-11),v):this._transitionable.setValue(d,v)}}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}};function ge(b,d,v,T){const C=l.smoothstep(45,65,v),[L,B]=xe(b,T),U=l.length(d);let q=1-Math.min(1,Math.exp((U-L)/(B-L)*-6));return q*=q*q,q=Math.min(1,1.00747*q),q*C*b.alpha}function xe(b,d){const v=.5/Math.tan(.5*d);return[b.range[0]+v,b.range[1]+v]}const Ce=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"high-color":new l.DataConstantProperty(l.spec.fog["high-color"]),"space-color":new l.DataConstantProperty(l.spec.fog["space-color"]),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"]),"star-intensity":new l.DataConstantProperty(l.spec.fog["star-intensity"])});class tt extends l.Evented{constructor(d,v){super(),this._transitionable=new l.Transitionable(Ce),this.set(d),this._transitioning=this._transitionable.untransitioned(),this._transform=v}get state(){const d=this._transform,v=d.projection.name==="globe",T=l.globeToMercatorTransition(d.zoom),C=this.properties.get("range"),L=[.5,3];return{range:v?[l.number(L[0],C[0],T),l.number(L[1],C[1],T)]:C,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(d,v={}){if(!this._validate(l.validateFog,d,v)){for(const T of Object.keys(l.spec.fog))d&&d[T]===void 0&&(d[T]=l.spec.fog[T].default);for(const T in d){const C=d[T];l.endsWith(T,"-transition")?this._transitionable.setTransition(T.slice(0,-11),C):this._transitionable.setValue(T,C)}}}getOpacity(d){if(!this._transform.projection.supportsFog)return 0;const v=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:l.smoothstep(45,65,d))*v.a}getOpacityAtLatLng(d,v){return this._transform.projection.supportsFog?function(T,C,L){const B=l.MercatorCoordinate.fromLngLat(C),U=L.elevation?L.elevation.getAtPointOrZero(B):0,q=[B.x,B.y,U];return l.transformMat4(q,q,L.mercatorFogMatrix),ge(T,q,L.pitch,L._fov)}(this.state,d,v):0}getFovAdjustedRange(d){return this._transform.projection.supportsFog?xe(this.state,d):[0,1]}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,v,T){return(!T||T.validate!==!1)&&l.emitValidationErrors(this,d.call(l.validateStyle,l.extend({value:v,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class Je{constructor(d,v){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const T=this.workerPool.acquire(this.id);for(let C=0;C<T.length;C++){const L=new Je.Actor(T[C],v,this.id);L.name=`Worker ${C}`,this.actors.push(L)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,v,T){l.asyncAll(this.actors,(C,L)=>{C.send(d,v,L)},T=T||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}function rt(b,d,v){return d*(l.EXTENT/(b.tileSize*Math.pow(2,v-b.tileID.overscaledZ)))}Je.Actor=l.Actor;class Ut{constructor(d,v,T,C){this.screenBounds=d,this.cameraPoint=v,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=T,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,C)}static createFromScreenPoints(d,v){let T,C;if(d instanceof l.Point||typeof d[0]=="number"){const L=l.Point.convert(d);T=[L],C=v.isPointAboveHorizon(L)}else{const L=l.Point.convert(d[0]),B=l.Point.convert(d[1]);T=[L,B],C=l.polygonizeBounds(L,B).every(U=>v.isPointAboveHorizon(U))}return new Ut(T,v.getCameraPoint(),C,v)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(d){return l.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],d)}bufferedCameraGeometry(d){const v=this.screenBounds[0],T=this.screenBounds.length===1?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],C=l.polygonizeBounds(v,T,0,!1);return this.cameraPoint.y>T.y&&(this.cameraPoint.x>v.x&&this.cameraPoint.x<T.x?C.splice(3,0,this.cameraPoint):this.cameraPoint.x>=T.x?C[2]=this.cameraPoint:this.cameraPoint.x<=v.x&&(C[3]=this.cameraPoint)),l.bufferConvexPolygon(C,d)}bufferedCameraGeometryGlobe(d){const v=this.screenBounds[0],T=this.screenBounds.length===1?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],C=l.polygonizeBounds(v,T,d),L=this.cameraPoint.clone();switch(3*((L.y>v.y)+(L.y>T.y))+((L.x>v.x)+(L.x>T.x))){case 0:C[0]=L,C[4]=L.clone();break;case 1:C.splice(1,0,L);break;case 2:C[1]=L;break;case 3:C.splice(4,0,L);break;case 5:C.splice(2,0,L);break;case 6:C[3]=L;break;case 7:C.splice(3,0,L);break;case 8:C[2]=L}return C}containsTile(d,v,T,C=0){const L=d.queryPadding/v._pixelsPerMercatorPixel+1,B=T?this._bufferedCameraMercator(L,v):this._bufferedScreenMercator(L,v);let U=d.tileID.wrap+(B.unwrapped?C:0);const q=B.polygon.map(Xe=>l.getTilePoint(d.tileTransform,Xe,U));if(!l.polygonIntersectsBox(q,0,0,l.EXTENT,l.EXTENT))return;U=d.tileID.wrap+(this.screenGeometryMercator.unwrapped?C:0);const ie=this.screenGeometryMercator.polygon.map(Xe=>l.getTileVec3(d.tileTransform,Xe,U)),ne=ie.map(Xe=>new l.Point(Xe[0],Xe[1])),be=v.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),Re=l.getTileVec3(d.tileTransform,be,U),je=ie.map(Xe=>{const Ee=l.sub(Xe,Xe,Re);return l.normalize(Ee,Ee),new l.Ray(Re,Ee)}),He=rt(d,1,v.zoom)*v._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:ne,tilespaceRays:je,bufferedTilespaceGeometry:q,bufferedTilespaceBounds:(Ge=l.getBounds(q),Ge.min.x=l.clamp(Ge.min.x,0,l.EXTENT),Ge.min.y=l.clamp(Ge.min.y,0,l.EXTENT),Ge.max.x=l.clamp(Ge.max.x,0,l.EXTENT),Ge.max.y=l.clamp(Ge.max.y,0,l.EXTENT),Ge),tile:d,tileID:d.tileID,pixelToTileUnitsFactor:He};var Ge}_bufferedScreenMercator(d,v){const T=Nn(d);if(this._screenRaycastCache[T])return this._screenRaycastCache[T];{let C;return C=v.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(d),v):{polygon:this.bufferedScreenGeometry(d).map(L=>v.pointCoordinate3D(L)),unwrapped:!0},this._screenRaycastCache[T]=C,C}}_bufferedCameraMercator(d,v){const T=Nn(d);if(this._cameraRaycastCache[T])return this._cameraRaycastCache[T];{let C;return C=v.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(d),v):{polygon:this.bufferedCameraGeometry(d).map(L=>v.pointCoordinate3D(L)),unwrapped:!0},this._cameraRaycastCache[T]=C,C}}_projectAndResample(d,v){const T=function(L,B){const U=l.multiply([],B.pixelMatrix,B.globeMatrix),q=[0,-l.GLOBE_RADIUS,0,1],ie=[0,l.GLOBE_RADIUS,0,1],ne=[0,0,0,1];l.transformMat4$1(q,q,U),l.transformMat4$1(ie,ie,U),l.transformMat4$1(ne,ne,U);const be=new l.Point(q[0]/q[3],q[1]/q[3]),Re=new l.Point(ie[0]/ie[3],ie[1]/ie[3]),je=l.polygonContainsPoint(L,be)&&q[3]<ne[3],He=l.polygonContainsPoint(L,Re)&&ie[3]<ne[3];if(!je&&!He)return null;const Ge=function(Mt,jt,Bt){for(let Yt=1;Yt<Mt.length;Yt++){const Zn=Ft(jt.pointCoordinate3D(Mt[Yt-1]).x),zt=Ft(jt.pointCoordinate3D(Mt[Yt]).x);if(Bt<0){if(Zn<zt)return{idx:Yt,t:-Zn/(zt-1-Zn)}}else if(zt<Zn)return{idx:Yt,t:(1-Zn)/(zt+1-Zn)}}return null}(L,B,je?-1:1);if(!Ge)return null;const{idx:Xe,t:Ee}=Ge;let Ue=Xe>1?ht(L.slice(0,Xe),B):[],it=Xe<L.length?ht(L.slice(Xe),B):[];Ue=Ue.map(Mt=>new l.Point(Ft(Mt.x),Mt.y)),it=it.map(Mt=>new l.Point(Ft(Mt.x),Mt.y));const lt=[...Ue];lt.length===0&&lt.push(it[it.length-1]);const Ct=l.number(lt[lt.length-1].y,(it.length===0?Ue[0]:it[0]).y,Ee);let It;return It=je?[new l.Point(0,Ct),new l.Point(0,0),new l.Point(1,0),new l.Point(1,Ct)]:[new l.Point(1,Ct),new l.Point(1,1),new l.Point(0,1),new l.Point(0,Ct)],lt.push(...It),it.length===0?lt.push(Ue[0]):lt.push(...it),{polygon:lt.map(Mt=>new l.MercatorCoordinate(Mt.x,Mt.y)),unwrapped:!1}}(d,v);if(T)return T;const C=function(L,B){let U=!1,q=-1/0,ie=0;for(let be=0;be<L.length-1;be++)L[be].x>q&&(q=L[be].x,ie=be);for(let be=0;be<L.length-1;be++){const Re=(ie+be)%(L.length-1),je=L[Re],He=L[Re+1];Math.abs(je.x-He.x)>.5&&(je.x<He.x?(je.x+=1,Re===0&&(L[L.length-1].x+=1)):(He.x+=1,Re+1===L.length-1&&(L[0].x+=1)),U=!0)}const ne=l.mercatorXfromLng(B.center.lng);return U&&ne<Math.abs(ne-1)&&L.forEach(be=>{be.x-=1}),{polygon:L,unwrapped:U}}(ht(d,v).map(L=>new l.Point(Ft(L.x),L.y)),v);return{polygon:C.polygon.map(L=>new l.MercatorCoordinate(L.x,L.y)),unwrapped:C.unwrapped}}}function ht(b,d){return l.resample(b,v=>{const T=d.pointCoordinate3D(v);v.x=T.x,v.y=T.y},1/256)}function Ft(b){return b<0?1+b%1:b%1}function Nn(b){return 100*b|0}function zn(b,d,v,T,C){const L=function(B,U){if(B)return C(B);if(U){b.url&&U.tiles&&b.tiles&&delete b.tiles;const q=l.pick(l.extend(U,b),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);U.vector_layers&&(q.vectorLayers=U.vector_layers,q.vectorLayerIds=q.vectorLayers.map(ie=>ie.id)),q.tiles=d.canonicalizeTileset(q,b.url),C(null,q)}};return b.url?l.getJSON(d.transformRequest(d.normalizeSourceURL(b.url,null,v,T),l.ResourceType.Source),L):l.exported.frame(()=>L(null,b))}class rr{constructor(d,v,T){this.bounds=l.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=v||0,this.maxzoom=T||24}validateBounds(d){return Array.isArray(d)&&d.length===4?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){const v=Math.pow(2,d.z),T=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*v),C=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*v),L=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*v),B=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*v);return d.x>=T&&d.x<L&&d.y>=C&&d.y<B}}class Gr{constructor(d,v,T){this.context=d;const C=d.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!T,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,v.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||v.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){const v=this.context.gl;this.context.unbindVAO(),this.bind(),v.bufferSubData(v.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Li={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wi{constructor(d,v,T,C){this.length=v.length,this.attributes=T,this.itemSize=v.bytesPerElement,this.dynamicDraw=C,this.context=d;const L=d.gl;this.buffer=L.createBuffer(),d.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,v.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||v.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){const v=this.context.gl;this.bind(),v.bufferSubData(v.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,v){for(let T=0;T<this.attributes.length;T++){const C=v.attributes[this.attributes[T].name];C!==void 0&&d.enableVertexAttribArray(C)}}setVertexAttribPointers(d,v,T){for(let C=0;C<this.attributes.length;C++){const L=this.attributes[C],B=v.attributes[L.name];B!==void 0&&d.vertexAttribPointer(B,L.components,d[Li[L.type]],!1,this.itemSize,L.offset+this.itemSize*(T||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Nr{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fi extends Nr{getDefault(){return l.Color.transparent}set(d){const v=this.current;(d.r!==v.r||d.g!==v.g||d.b!==v.b||d.a!==v.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Mi extends Nr{getDefault(){return 1}set(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class jn extends Nr{getDefault(){return 0}set(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class Be extends Nr{getDefault(){return[!0,!0,!0,!0]}set(d){const v=this.current;(d[0]!==v[0]||d[1]!==v[1]||d[2]!==v[2]||d[3]!==v[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class ze extends Nr{getDefault(){return!0}set(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class vt extends Nr{getDefault(){return 255}set(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Qe extends Nr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){const v=this.current;(d.func!==v.func||d.ref!==v.ref||d.mask!==v.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class gt extends Nr{getDefault(){const d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){const v=this.current;(d[0]!==v[0]||d[1]!==v[1]||d[2]!==v[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class St extends Nr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;d?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST),this.current=d,this.dirty=!1}}class Rt extends Nr{getDefault(){return[0,1]}set(d){const v=this.current;(d[0]!==v[0]||d[1]!==v[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class At extends Nr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;d?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST),this.current=d,this.dirty=!1}}class en extends Nr{getDefault(){return this.gl.LESS}set(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class On extends Nr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;d?v.enable(v.BLEND):v.disable(v.BLEND),this.current=d,this.dirty=!1}}class qn extends Nr{getDefault(){const d=this.gl;return[d.ONE,d.ZERO]}set(d){const v=this.current;(d[0]!==v[0]||d[1]!==v[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class Er extends Nr{getDefault(){return l.Color.transparent}set(d){const v=this.current;(d.r!==v.r||d.g!==v.g||d.b!==v.b||d.a!==v.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Sr extends Nr{getDefault(){return this.gl.FUNC_ADD}set(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class Dr extends Nr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;d?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE),this.current=d,this.dirty=!1}}class Fr extends Nr{getDefault(){return this.gl.BACK}set(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class Tr extends Nr{getDefault(){return this.gl.CCW}set(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}let Zr,is=class extends Nr{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}};class $i extends Nr{getDefault(){return this.gl.TEXTURE0}set(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class Xs extends Nr{getDefault(){const d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){const v=this.current;(d[0]!==v[0]||d[1]!==v[1]||d[2]!==v[2]||d[3]!==v[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class vo extends Nr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.bindFramebuffer(v.FRAMEBUFFER,d),this.current=d,this.dirty=!1}}class Vn extends Nr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.bindRenderbuffer(v.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class Di extends Nr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.bindTexture(v.TEXTURE_2D,d),this.current=d,this.dirty=!1}}class Ps extends Nr{getDefault(){return null}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.bindBuffer(v.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class ct extends Nr{getDefault(){return null}set(d){const v=this.gl;v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class se extends Nr{constructor(d){super(d),this.vao=d.extVertexArrayObject}getDefault(){return null}set(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class le extends Nr{getDefault(){return 4}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}}class Ae extends Nr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}}class Fe extends Nr{getDefault(){return!1}set(d){if(d===this.current&&!this.dirty)return;const v=this.gl;v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}}class nt extends Nr{constructor(d,v){super(d),this.context=d,this.parent=v}getDefault(){return null}}class kt extends nt{setDirty(){this.dirty=!0}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}}class Tt extends nt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(d){if(d===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const v=this.gl;v.framebufferRenderbuffer(v.FRAMEBUFFER,this.attachment(),v.RENDERBUFFER,d),this.current=d,this.dirty=!1}}class at extends Tt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class me{constructor(d,v,T,C){this.context=d,this.width=v,this.height=T;const L=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new kt(d,L),C&&(this.depthAttachment=new Tt(d,L))}destroy(){const d=this.context.gl,v=this.colorAttachment.get();if(v&&d.deleteTexture(v),this.depthAttachment){const T=this.depthAttachment.get();T&&d.deleteRenderbuffer(T)}d.deleteFramebuffer(this.framebuffer)}}class fn{constructor(d,v=!1){if(this.gl=d,this.isWebGL2=v,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),v){const T=d;this.extVertexArrayObject={createVertexArrayOES:T.createVertexArray.bind(d),deleteVertexArrayOES:T.deleteVertexArray.bind(d),bindVertexArrayOES:T.bindVertexArray.bind(d)}}this.clearColor=new fi(this),this.clearDepth=new Mi(this),this.clearStencil=new jn(this),this.colorMask=new Be(this),this.depthMask=new ze(this),this.stencilMask=new vt(this),this.stencilFunc=new Qe(this),this.stencilOp=new gt(this),this.stencilTest=new St(this),this.depthRange=new Rt(this),this.depthTest=new At(this),this.depthFunc=new en(this),this.blend=new On(this),this.blendFunc=new qn(this),this.blendColor=new Er(this),this.blendEquation=new Sr(this),this.cullFace=new Dr(this),this.cullFaceSide=new Fr(this),this.frontFace=new Tr(this),this.program=new is(this),this.activeTexture=new $i(this),this.viewport=new Xs(this),this.bindFramebuffer=new vo(this),this.bindRenderbuffer=new Vn(this),this.bindTexture=new Di(this),this.bindVertexBuffer=new Ps(this),this.bindElementBuffer=new ct(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new se(this),this.pixelStoreUnpack=new le(this),this.pixelStoreUnpackPremultiplyAlpha=new Ae(this),this.pixelStoreUnpackFlipY=new Fe(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=d.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=d.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=d.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),v||(this.extTextureHalfFloat=d.getExtension("OES_texture_half_float")),(v||this.extTextureHalfFloat&&d.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=v||d.getExtension("OES_standard_derivatives"),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,v){return new Gr(this,d,v)}createVertexBuffer(d,v,T){return new wi(this,d,v,T)}createRenderbuffer(d,v,T){const C=this.gl,L=C.createRenderbuffer();return this.bindRenderbuffer.set(L),C.renderbufferStorage(C.RENDERBUFFER,d,v,T),this.bindRenderbuffer.set(null),L}createFramebuffer(d,v,T){return new me(this,d,v,T)}clear({color:d,depth:v,stencil:T}){const C=this.gl;let L=0;d&&(L|=C.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),v!==void 0&&(L|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(v),this.depthMask.set(!0)),T!==void 0&&(L|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(T),this.stencilMask.set(255)),C.clear(L)}setCullFace(d){d.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){E(d.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Mn extends l.Evented{constructor(d,v,T,C){if(super(),this.id=d,this.dispatcher=T,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(v,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},v),this._collectResourceTiming=v.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(d){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"}));const v=Array.isArray(this.map._language)?this.map._language.join():this.map._language,T=this.map._worldview;this._tileJSONRequest=zn(this._options,this.map._requestManager,v,T,(C,L)=>{this._tileJSONRequest=null,this._loaded=!0,C?(v&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${v}`),T&&T.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${T}`),this.fire(new l.ErrorEvent(C))):L&&(l.extend(this,L),L.bounds&&(this.tileBounds=new rr(L.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(L.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(C)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}loadTile(d,v){const T=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),C={request:this.map._requestManager.transformRequest(T,l.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(C.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=v:d.request=d.actor.send("reloadTile",C,L.bind(this));else if(d.actor=this._tileWorkers[T]=this._tileWorkers[T]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",C,L.bind(this),void 0,!0);else{const B=l.loadVectorTile.call({deduped:this._deduped},C,(U,q)=>{U||!q?L.call(this,U):(C.data={cacheControl:q.cacheControl,expires:q.expires,rawData:q.rawData.slice(0)},d.actor&&d.actor.send("loadTile",C,L.bind(this),void 0,!0))},!0);d.request={cancel:B}}function L(B,U){return delete d.request,d.aborted?v(null):B&&B.status!==404?v(B):(U&&U.resourceTiming&&(d.resourceTiming=U.resourceTiming),this.map._refreshExpiredTiles&&U&&d.setExpiryData(U),d.loadVectorData(U,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),v(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Jt extends l.Evented{constructor(d,v,T,C){super(),this.id=d,this.dispatcher=T,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},v),l.extend(this,l.pick(v,["url","scheme","tileSize"]))}load(d){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zn(this._options,this.map._requestManager,null,null,(v,T)=>{this._tileJSONRequest=null,this._loaded=!0,v?this.fire(new l.ErrorEvent(v)):T&&(l.extend(this,T),T.bounds&&(this.tileBounds=new rr(T.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(T.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(v)})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,v){const T=l.exported.devicePixelRatio>=2,C=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),T,this.tileSize);d.request=l.getImage(this.map._requestManager.transformRequest(C,l.ResourceType.Tile),(L,B,U,q)=>(delete d.request,d.aborted?(d.state="unloaded",v(null)):L?(d.state="errored",v(L)):B?(this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:U,expires:q}),d.setTexture(B,this.map.painter),d.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),void v(null)):v(null)))}static loadTileData(d,v,T){d.setTexture(v,T)}static unloadTileData(d,v){d.texture&&v.saveTileTexture(d.texture)}abortTile(d,v){d.request&&(d.request.cancel(),delete d.request),v()}unloadTile(d,v){d.texture&&this.map.painter.saveTileTexture(d.texture),v()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function mr(b,d,v,T,C,L,B,U){const q=[b,v,C,d,T,L,1,1,1],ie=[B,U,1],ne=l.adjoint([],q),[be,Re,je]=l.transformMat3(ie,ie,l.transpose(ne,ne));return l.multiply$1(q,[be,0,0,0,Re,0,0,0,je],q)}class Cr extends l.Evented{constructor(d,v,T,C){super(),this.id=d,this.dispatcher=T,this.coordinates=v.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=v,this._dirty=!1}load(d,v){this._loaded=v||!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(T,C)=>{if(this._imageRequest=null,this._loaded=!0,T)this.fire(new l.ErrorEvent(T));else if(C){const{HTMLImageElement:L}=l.window;this.image=C instanceof L?l.exported.getImageData(C):C,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,d&&(this.coordinates=d),this._finishLoading()}})}loaded(){return this._loaded}updateImage(d){return this.image&&d.url?(this._imageRequest&&d.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=d.url,this.load(d.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(d){this.coordinates=d,this._boundsArray=void 0;const v=d.map(l.MercatorCoordinate.fromLngLat);return this.tileID=function(T){let C=1/0,L=1/0,B=-1/0,U=-1/0;for(const be of T)C=Math.min(C,be.x),L=Math.min(L,be.y),B=Math.max(B,be.x),U=Math.max(U,be.y);const q=Math.max(B-C,U-L),ie=Math.max(0,Math.floor(-Math.log(q)/Math.LN2)),ne=Math.pow(2,ie);return new l.CanonicalTileID(ie,Math.floor((C+B)/2*ne),Math.floor((L+U)/2*ne))}(v),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(d){for(const q in this.tiles){const ie=this.tiles[q];ie.state!=="loaded"&&(ie.state="loaded",ie.texture=this.texture)}if(this._boundsArray)return;const v=l.tileTransform(this.tileID,this.map.transform.projection),[T,C,L,B]=this.coordinates.map(q=>{const ie=v.projection.project(q[0],q[1]);return l.getTilePoint(v,ie)._round()});this.perspectiveTransform=function(q,ie,ne,be,Re,je,He,Ge,Xe,Ee){const Ue=mr(0,0,q,0,0,ie,q,ie),it=mr(ne,be,Re,je,He,Ge,Xe,Ee);return l.multiply$1(it,l.adjoint(Ue,Ue),it),[it[6]/it[8]*q/l.EXTENT,it[7]/it[8]*ie/l.EXTENT]}(this.width,this.height,T.x,T.y,C.x,C.y,B.x,B.y,L.x,L.y);const U=this._boundsArray=new l.StructArrayLayout4i8;U.emplaceBack(T.x,T.y,0,0),U.emplaceBack(C.x,C.y,l.EXTENT,0),U.emplaceBack(B.x,B.y,0,l.EXTENT),U.emplaceBack(L.x,L.y,l.EXTENT,l.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=d.createVertexBuffer(U,l.boundsAttributes.members),this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const d=this.map.painter.context,v=d.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new l.Texture(d,this.image,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(d)}loadTile(d,v){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},v(null)):(d.state="errored",v(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const zr={vector:Mn,raster:Jt,"raster-dem":class extends Jt{constructor(b,d,v,T){super(b,d,v,T),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}loadTile(b,d){const v=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function T(C,L){C&&(b.state="errored",d(C)),L&&(b.dem=L,b.dem.onDeserialize(),b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0,b.state="loaded",d(null))}b.request=l.getImage(this.map._requestManager.transformRequest(v,l.ResourceType.Tile),(function(C,L,B,U){if(delete b.request,b.aborted)b.state="unloaded",d(null);else if(C)b.state="errored",d(C);else if(L){this.map._refreshExpiredTiles&&b.setExpiryData({cacheControl:B,expires:U});const q=l.window.ImageBitmap&&L instanceof l.window.ImageBitmap&&(Zr==null&&(Zr=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&typeof l.window.createImageBitmap=="function"),Zr),ie=1-(L.width-l.prevPowerOfTwo(L.width))/2;ie<1||b.neighboringTiles||(b.neighboringTiles=this._getNeighboringTiles(b.tileID));const ne=q?L:l.exported.getImageData(L,ie),be={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:ne,encoding:this.encoding,padding:ie};b.actor&&b.state!=="expired"||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",be,T.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(b){const d=b.canonical,v=Math.pow(2,d.z),T=(d.x-1+v)%v,C=d.x===0?b.wrap-1:b.wrap,L=(d.x+1+v)%v,B=d.x+1===v?b.wrap+1:b.wrap,U={};return U[new l.OverscaledTileID(b.overscaledZ,C,d.z,T,d.y).key]={backfilled:!1},U[new l.OverscaledTileID(b.overscaledZ,B,d.z,L,d.y).key]={backfilled:!1},d.y>0&&(U[new l.OverscaledTileID(b.overscaledZ,C,d.z,T,d.y-1).key]={backfilled:!1},U[new l.OverscaledTileID(b.overscaledZ,b.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},U[new l.OverscaledTileID(b.overscaledZ,B,d.z,L,d.y-1).key]={backfilled:!1}),d.y+1<v&&(U[new l.OverscaledTileID(b.overscaledZ,C,d.z,T,d.y+1).key]={backfilled:!1},U[new l.OverscaledTileID(b.overscaledZ,b.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},U[new l.OverscaledTileID(b.overscaledZ,B,d.z,L,d.y+1).key]={backfilled:!1}),U}unloadTile(b){b.demTexture&&this.map.painter.saveTileTexture(b.demTexture),b.fbo&&(b.fbo.destroy(),delete b.fbo),b.dem&&delete b.dem,delete b.neighboringTiles,b.state="unloaded"}},geojson:class extends l.Evented{constructor(b,d,v,T){super(),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=v.getActor(),this.setEventedParent(T),this._data=d.data,this._options=l.extend({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const C=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*C,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*C,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:l.EXTENT,radius:(d.clusterRadius!==void 0?d.clusterRadius:50)*C,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}onAdd(b){this.map=b,this.setData(this._data)}setData(b){return this._data=b,this._updateWorkerData(),this}getClusterExpansionZoom(b,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:b,source:this.id},d),this}getClusterChildren(b,d){return this.actor.send("geojson.getClusterChildren",{clusterId:b,source:this.id},d),this}getClusterLeaves(b,d,v,T){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:b,limit:d,offset:v},T),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const b=l.extend({},this.workerOptions),d=this._data;typeof d=="string"?(b.request=this.map._requestManager.transformRequest(l.exported.resolveURL(d),l.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,b,(v,T)=>{if(this._loaded=!0,this._pendingLoad=null,v)this.fire(new l.ErrorEvent(v));else{const C={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&T&&T.resourceTiming&&T.resourceTiming[this.id]&&(C.resourceTiming=T.resourceTiming[this.id]),this.fire(new l.Event("data",C)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(b,d){const v=b.actor?"reloadTile":"loadTile";b.actor=this.actor,b.request=this.actor.send(v,{type:this.type,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(T,C)=>(delete b.request,b.unloadVectorData(),b.aborted?d(null):T?d(T):(b.loadVectorData(C,this.map.painter,v==="reloadTile"),d(null))),void 0,v==="loadTile")}abortTile(b){b.request&&(b.request.cancel(),delete b.request),b.aborted=!0}unloadTile(b){b.unloadVectorData(),this.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Cr{constructor(b,d,v,T){super(b,d,v,T),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const b=this.options;this.urls=[];for(const d of b.urls)this.urls.push(this.map._requestManager.transformRequest(d,l.ResourceType.Source).url);l.getVideo(this.urls,(d,v)=>{this._loaded=!0,d?this.fire(new l.ErrorEvent(d)):v&&(this.video=v,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){const d=this.video.seekable;b<d.start(0)||b>d.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,d=b.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(b,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(b)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Cr,canvas:class extends Cr{constructor(b,d,v,T){super(b,d,v,T),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(C=>!Array.isArray(C)||C.length!==2||C.some(L=>typeof L!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${b}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${b}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${b}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context;this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(d,this.canvas,d.gl.RGBA,{premultiply:!0}),this._prepareData(d)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const b of[this.canvas.width,this.canvas.height])if(isNaN(b)||b<=0)return!0;return!1}},custom:class extends l.Evented{constructor(b,d,v,T){super(),this.id=b,this.type="custom",this._dataType="raster",this._dispatcher=v,this._implementation=d,this.setEventedParent(T),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new l.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new l.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new rr(this._implementation.bounds,this.minzoom,this.maxzoom)),d.update=this._update.bind(this),d.clearTiles=this._clearTiles.bind(this),d.coveringTiles=this._coveringTiles.bind(this),l.extend(this,l.pick(d,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return l.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(b){this._map=b,this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(b),this.load()}onRemove(b){this._implementation.onRemove&&this._implementation.onRemove(b)}hasTile(b){if(this._implementation.hasTile){const{x:d,y:v,z:T}=b.canonical;return this._implementation.hasTile({x:d,y:v,z:T})}return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b,d){const{x:v,y:T,z:C}=b.tileID.canonical,L=new l.window.AbortController;b.request=Promise.resolve(this._implementation.loadTile({x:v,y:T,z:C},{signal:L.signal})).then((function(B){return delete b.request,b.aborted?(b.state="unloaded",d(null)):B===void 0?(b.state="errored",d(null)):B===null?(this.loadTileData(b,{width:this.tileSize,height:this.tileSize,data:null}),b.state="loaded",d(null)):function(U){return U instanceof l.window.ImageData||U instanceof l.window.HTMLCanvasElement||U instanceof l.window.ImageBitmap||U instanceof l.window.HTMLImageElement}(B)?(this.loadTileData(b,B),b.state="loaded",void d(null)):(b.state="errored",d(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(B=>{B.code!==20&&(b.state="errored",d(B))}),b.request.cancel=()=>L.abort()}loadTileData(b,d){Jt.loadTileData(b,d,this._map.painter)}unloadTileData(b){Jt.unloadTileData(b,this._map.painter)}unloadTile(b,d){if(this.unloadTileData(b),this._implementation.unloadTile){const{x:v,y:T,z:C}=b.tileID.canonical;this._implementation.unloadTile({x:v,y:T,z:C})}d()}abortTile(b,d){b.request&&b.request.cancel&&(b.request.cancel(),delete b.request),d()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(b=>({x:b.canonical.x,y:b.canonical.y,z:b.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Kr=function(b,d,v,T){const C=new zr[d.type](b,d,v,T);if(C.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${C.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],C),C};function pi(b,d){const v=l.identity([]);return l.scale(v,v,[.5*b.width,.5*-b.height,1]),l.translate(v,v,[1,-1,0]),l.multiply(v,v,b.calculateProjMatrix(d.toUnwrapped())),Float32Array.from(v)}function Xi(b,d,v,T,C,L,B,U=!1){const q=b.tilesIn(T,B,U);q.sort(Zi);const ie=[];for(const be of q)ie.push({wrappedTileID:be.tile.tileID.wrapped().key,queryResults:be.tile.queryRenderedFeatures(d,v,b._state,be,C,L,pi(b.transform,be.tile.tileID),U)});const ne=function(be){const Re={},je={};for(const He of be){const Ge=He.queryResults,Xe=He.wrappedTileID,Ee=je[Xe]=je[Xe]||{};for(const Ue in Ge){const it=Ge[Ue],lt=Ee[Ue]=Ee[Ue]||{},Ct=Re[Ue]=Re[Ue]||[];for(const It of it)lt[It.featureIndex]||(lt[It.featureIndex]=!0,Ct.push(It))}}return Re}(ie);for(const be in ne)ne[be].forEach(Re=>{const je=Re.feature,He=je.layer;He&&He.type!=="background"&&He.type!=="sky"&&(je.source=He.source,He["source-layer"]&&(je.sourceLayer=He["source-layer"]),je.state=je.id!==void 0?b.getFeatureState(He["source-layer"],je.id):{})});return ne}function Hi(b,d){const v=b.getRenderableIds().map(L=>b.getTileByID(L)),T=[],C={};for(let L=0;L<v.length;L++){const B=v[L],U=B.tileID.canonical.key;C[U]||(C[U]=!0,B.querySourceFeatures(T,d))}return T}function Zi(b,d){const v=b.tileID,T=d.tileID;return v.overscaledZ-T.overscaledZ||v.canonical.y-T.canonical.y||v.wrap-T.wrap||v.canonical.x-T.canonical.x}function ss(){return Af.workerClass!=null?new Af.workerClass:new l.window.Worker(Af.workerUrl)}const xo="mapboxgl_preloaded_worker_pool";class Us{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<Us.workerCount;)this.workers.push(new ss);return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],this.numActive()===0&&(this.workers.forEach(v=>{v.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xo]}numActive(){return Object.keys(this.active).length}}let uo;function No(){return uo||(uo=new Us),uo}function xs(b,d){const v={};for(const T in b)T!=="ref"&&(v[T]=b[T]);return l.refProperties.forEach(T=>{T in d&&(v[T]=d[T])}),v}function ea(b){b=b.slice();const d=Object.create(null);for(let v=0;v<b.length;v++)d[b[v].id]=b[v];for(let v=0;v<b.length;v++)"ref"in b[v]&&(b[v]=xs(b[v],d[b[v].ref]));return b}Us.workerCount=2;const ri={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ia(b,d,v){v.push({command:ri.addSource,args:[b,d[b]]})}function zl(b,d,v){d.push({command:ri.removeSource,args:[b]}),v[b]=!0}function tl(b,d,v,T){zl(b,v,T),Ia(b,d,v)}function Zs(b,d,v){let T;for(T in b[v])if(b[v].hasOwnProperty(T)&&T!=="data"&&!E(b[v][T],d[v][T]))return!1;for(T in d[v])if(d[v].hasOwnProperty(T)&&T!=="data"&&!E(b[v][T],d[v][T]))return!1;return!0}function ta(b,d,v,T,C,L){let B;for(B in d=d||{},b=b||{})b.hasOwnProperty(B)&&(E(b[B],d[B])||v.push({command:L,args:[T,B,d[B],C]}));for(B in d)d.hasOwnProperty(B)&&!b.hasOwnProperty(B)&&(E(b[B],d[B])||v.push({command:L,args:[T,B,d[B],C]}))}function bo(b){return b.id}function nl(b,d){return b[d.id]=d,b}class Bc{constructor(d,v){this.reset(d,v)}reset(d,v){this.points=d||[],this._distances=[0];for(let T=1;T<this.points.length;T++)this._distances[T]=this._distances[T-1]+this.points[T].dist(this.points[T-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(v||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(d){if(this.points.length===1)return this.points[0];d=l.clamp(d,0,1);let v=1,T=this._distances[v];const C=d*this.paddedLength+this.padding;for(;T<C&&v<this._distances.length;)T=this._distances[++v];const L=v-1,B=this._distances[L],U=T-B,q=U>0?(C-B)/U:0;return this.points[L].mult(1-q).add(this.points[v].mult(q))}}class yl{constructor(d,v,T){const C=this.boxCells=[],L=this.circleCells=[];this.xCellCount=Math.ceil(d/T),this.yCellCount=Math.ceil(v/T);for(let B=0;B<this.xCellCount*this.yCellCount;B++)C.push([]),L.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=v,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/v,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,v,T,C,L){this._forEachCell(v,T,C,L,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(v),this.bboxes.push(T),this.bboxes.push(C),this.bboxes.push(L)}insertCircle(d,v,T,C){this._forEachCell(v-C,T-C,v+C,T+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(v),this.circles.push(T),this.circles.push(C)}_insertBoxCell(d,v,T,C,L,B){this.boxCells[L].push(B)}_insertCircleCell(d,v,T,C,L,B){this.circleCells[L].push(B)}_query(d,v,T,C,L,B){if(T<0||d>this.width||C<0||v>this.height)return!L&&[];const U=[];if(d<=0&&v<=0&&this.width<=T&&this.height<=C){if(L)return!0;for(let q=0;q<this.boxKeys.length;q++)U.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(let q=0;q<this.circleKeys.length;q++){const ie=this.circles[3*q],ne=this.circles[3*q+1],be=this.circles[3*q+2];U.push({key:this.circleKeys[q],x1:ie-be,y1:ne-be,x2:ie+be,y2:ne+be})}return B?U.filter(B):U}return this._forEachCell(d,v,T,C,this._queryCell,U,{hitTest:L,seenUids:{box:{},circle:{}}},B),L?U.length>0:U}_queryCircle(d,v,T,C,L){const B=d-T,U=d+T,q=v-T,ie=v+T;if(U<0||B>this.width||ie<0||q>this.height)return!C&&[];const ne=[];return this._forEachCell(B,q,U,ie,this._queryCellCircle,ne,{hitTest:C,circle:{x:d,y:v,radius:T},seenUids:{box:{},circle:{}}},L),C?ne.length>0:ne}query(d,v,T,C,L){return this._query(d,v,T,C,!1,L)}hitTest(d,v,T,C,L){return this._query(d,v,T,C,!0,L)}hitTestCircle(d,v,T,C){return this._queryCircle(d,v,T,!0,C)}_queryCell(d,v,T,C,L,B,U,q){const ie=U.seenUids,ne=this.boxCells[L];if(ne!==null){const Re=this.bboxes;for(const je of ne)if(!ie.box[je]){ie.box[je]=!0;const He=4*je;if(d<=Re[He+2]&&v<=Re[He+3]&&T>=Re[He+0]&&C>=Re[He+1]&&(!q||q(this.boxKeys[je]))){if(U.hitTest)return B.push(!0),!0;B.push({key:this.boxKeys[je],x1:Re[He],y1:Re[He+1],x2:Re[He+2],y2:Re[He+3]})}}}const be=this.circleCells[L];if(be!==null){const Re=this.circles;for(const je of be)if(!ie.circle[je]){ie.circle[je]=!0;const He=3*je;if(this._circleAndRectCollide(Re[He],Re[He+1],Re[He+2],d,v,T,C)&&(!q||q(this.circleKeys[je]))){if(U.hitTest)return B.push(!0),!0;{const Ge=Re[He],Xe=Re[He+1],Ee=Re[He+2];B.push({key:this.circleKeys[je],x1:Ge-Ee,y1:Xe-Ee,x2:Ge+Ee,y2:Xe+Ee})}}}}}_queryCellCircle(d,v,T,C,L,B,U,q){const ie=U.circle,ne=U.seenUids,be=this.boxCells[L];if(be!==null){const je=this.bboxes;for(const He of be)if(!ne.box[He]){ne.box[He]=!0;const Ge=4*He;if(this._circleAndRectCollide(ie.x,ie.y,ie.radius,je[Ge+0],je[Ge+1],je[Ge+2],je[Ge+3])&&(!q||q(this.boxKeys[He])))return B.push(!0),!0}}const Re=this.circleCells[L];if(Re!==null){const je=this.circles;for(const He of Re)if(!ne.circle[He]){ne.circle[He]=!0;const Ge=3*He;if(this._circlesCollide(je[Ge],je[Ge+1],je[Ge+2],ie.x,ie.y,ie.radius)&&(!q||q(this.circleKeys[He])))return B.push(!0),!0}}}_forEachCell(d,v,T,C,L,B,U,q){const ie=this._convertToXCellCoord(d),ne=this._convertToYCellCoord(v),be=this._convertToXCellCoord(T),Re=this._convertToYCellCoord(C);for(let je=ie;je<=be;je++)for(let He=ne;He<=Re;He++)if(L.call(this,d,v,T,C,this.xCellCount*He+je,B,U,q))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,v,T,C,L,B){const U=C-d,q=L-v,ie=T+B;return ie*ie>U*U+q*q}_circleAndRectCollide(d,v,T,C,L,B,U){const q=(B-C)/2,ie=Math.abs(d-(C+q));if(ie>q+T)return!1;const ne=(U-L)/2,be=Math.abs(v-(L+ne));if(be>ne+T)return!1;if(ie<=q||be<=ne)return!0;const Re=ie-q,je=be-ne;return Re*Re+je*je<=T*T}}const _l={unknown:0,flipRequired:1,flipNotRequired:2},rl=Math.tan(85*Math.PI/180);function Nt(b,d,v,T,C,L,B){const U=l.create();if(v)if(L.name==="globe"){const q=l.calculateGlobeLabelMatrix(C,d);l.multiply(U,U,q)}else{const q=We([],B);U[0]=q[0],U[1]=q[1],U[4]=q[2],U[5]=q[3],T||l.rotateZ(U,U,C.angle)}else l.multiply(U,C.labelPlaneMatrix,b);return U}function ko(b,d,v,T,C,L,B){const U=Nt(b,d,v,T,C,L,B);return L.name==="globe"&&v||(U[2]=U[6]=U[10]=U[14]=0),U}function ns(b,d,v,T,C,L,B){if(v){if(L.name==="globe"){const U=Nt(b,d,v,T,C,L,B);return l.invert(U,U),l.multiply(U,b,U),U}{const U=l.clone(b),q=l.identity([]);return q[0]=B[0],q[1]=B[1],q[4]=B[2],q[5]=B[3],l.multiply(U,U,q),T||l.rotateZ(U,U,-C.angle),U}}return C.glCoordMatrix}function Ds(b,d,v,T){const C=[b,d,v,1];v?l.transformMat4$1(C,C,T):vi(C,C,T);const L=C[3];return C[0]/=L,C[1]/=L,C[2]/=L,C}function Tp(b,d){return Math.min(.5+b/d*.5,1.5)}function Uo(b,d){const v=b[0]/b[3],T=b[1]/b[3];return v>=-d[0]&&v<=d[0]&&T>=-d[1]&&T<=d[1]}function Uc(b,d,v,T,C,L,B,U,q,ie){const ne=v.transform,be=T?b.textSizeData:b.iconSizeData,Re=l.evaluateSizeForZoom(be,v.transform.zoom),je=ne.projection.name==="globe",He=[256/v.width*2+1,256/v.height*2+1],Ge=T?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;Ge.clear();let Xe=null;je&&(Xe=T?b.text.globeExtVertexArray:b.icon.globeExtVertexArray);const Ee=b.lineVertexArray,Ue=T?b.text.placedSymbolArray:b.icon.placedSymbolArray,it=v.transform.width/v.transform.height;let lt,Ct=!1;for(let It=0;It<Ue.length;It++){const Mt=Ue.get(It),{numGlyphs:jt,writingMode:Bt}=Mt;if(Bt!==l.WritingMode.vertical||Ct||lt===l.WritingMode.horizontal||(Ct=!0),lt=Bt,(Mt.hidden||Bt===l.WritingMode.vertical)&&!Ct){$a(jt,Ge);continue}Ct=!1;const Yt=new l.Point(Mt.tileAnchorX,Mt.tileAnchorY);let{x:Zn,y:zt,z:wn}=ne.projection.projectTilePoint(Yt.x,Yt.y,ie.canonical);if(q){const[ui,Mr,Xr]=q(Yt);Zn+=ui,zt+=Mr,wn+=Xr}const Qt=[Zn,zt,wn,1];if(l.transformMat4$1(Qt,Qt,d),!Uo(Qt,He)){$a(jt,Ge);continue}const Gn=Tp(v.transform.cameraToCenterDistance,Qt[3]),$t=l.evaluateSizeForFeature(be,Re,Mt),vn=B?$t/Gn:$t*Gn,Tn=Ds(Zn,zt,wn,C);if(Tn[3]<=0){$a(jt,Ge);continue}let kn={};const Yn=B?null:q,Ur=ur(Mt,vn,!1,U,d,C,L,b.glyphOffsetArray,Ee,Ge,Xe,Tn,Yt,kn,it,Yn,ne.projection,ie,B);Ct=Ur.useVertical,Yn&&Ur.needsFlipping&&(kn={}),(Ur.notEnoughRoom||Ct||Ur.needsFlipping&&ur(Mt,vn,!0,U,d,C,L,b.glyphOffsetArray,Ee,Ge,Xe,Tn,Yt,kn,it,Yn,ne.projection,ie,B).notEnoughRoom)&&$a(jt,Ge)}T?(b.text.dynamicLayoutVertexBuffer.updateData(Ge),Xe&&b.text.globeExtVertexBuffer.updateData(Xe)):(b.icon.dynamicLayoutVertexBuffer.updateData(Ge),Xe&&b.icon.globeExtVertexBuffer.updateData(Xe))}function Aa(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge){const{lineStartIndex:Xe,glyphStartIndex:Ee,segment:Ue}=U,it=Ee+U.numGlyphs,lt=Xe+U.lineLength,Ct=d.getoffsetX(Ee),It=d.getoffsetX(it-1),Mt=ys(b*Ct,v,T,C,L,B,Ue,Xe,lt,q,ie,ne,be,Re,!0,je,He,Ge);if(!Mt)return null;const jt=ys(b*It,v,T,C,L,B,Ue,Xe,lt,q,ie,ne,be,Re,!0,je,He,Ge);return jt?{first:Mt,last:jt}:null}function hc(b,d,v,T){return b===l.WritingMode.horizontal&&Math.abs(T)>Math.abs(v)?{useVertical:!0}:b===l.WritingMode.vertical?T>0?{needsFlipping:!0}:null:d!==_l.unknown&&function(C,L){return C===0||Math.abs(L/C)>rl}(v,T)?d===_l.flipRequired?{needsFlipping:!0}:null:v<0?{needsFlipping:!0}:null}function ur(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge,Xe,Ee,Ue){const it=d/24,lt=b.lineOffsetX*it,Ct=b.lineOffsetY*it,{lineStartIndex:It,glyphStartIndex:Mt,numGlyphs:jt,segment:Bt,writingMode:Yt,flipState:Zn}=b,zt=It+b.lineLength,wn=Qt=>{if(ne){const[Tn,kn,Yn]=Qt.up,Ur=ie.length;l.updateGlobeVertexNormal(ne,Ur+0,Tn,kn,Yn),l.updateGlobeVertexNormal(ne,Ur+1,Tn,kn,Yn),l.updateGlobeVertexNormal(ne,Ur+2,Tn,kn,Yn),l.updateGlobeVertexNormal(ne,Ur+3,Tn,kn,Yn)}const[Gn,$t,vn]=Qt.point;l.addDynamicAttributes(ie,Gn,$t,vn,Qt.angle)};if(jt>1){const Qt=Aa(it,U,lt,Ct,v,be,Re,b,q,L,je,Ge,!1,Xe,Ee,Ue);if(!Qt)return{notEnoughRoom:!0};if(T&&!v){let[Gn,$t,vn]=Qt.first.point,[Tn,kn,Yn]=Qt.last.point;[Gn,$t]=Ds(Gn,$t,vn,B),[Tn,kn]=Ds(Tn,kn,Yn,B);const Ur=hc(Yt,Zn,(Tn-Gn)*He,kn-$t);if(b.flipState=Ur&&Ur.needsFlipping?_l.flipRequired:_l.flipNotRequired,Ur)return Ur}wn(Qt.first);for(let Gn=Mt+1;Gn<Mt+jt-1;Gn++){const $t=ys(it*U.getoffsetX(Gn),lt,Ct,v,be,Re,Bt,It,zt,q,L,je,Ge,!1,!1,Xe,Ee,Ue);if(!$t)return ie.length-=4*(Gn-Mt),{notEnoughRoom:!0};wn($t)}wn(Qt.last)}else{if(T&&!v){const Gn=Ds(Re.x,Re.y,0,C),$t=It+Bt+1,vn=new l.Point(q.getx($t),q.gety($t)),Tn=Ds(vn.x,vn.y,0,C),kn=Tn[3]>0?Tn:Si(Re,vn,Gn,1,C,void 0,Xe,Ee.canonical),Yn=hc(Yt,Zn,(kn[0]-Gn[0])*He,kn[1]-Gn[1]);if(b.flipState=Yn&&Yn.needsFlipping?_l.flipRequired:_l.flipNotRequired,Yn)return Yn}const Qt=ys(it*U.getoffsetX(Mt),lt,Ct,v,be,Re,Bt,It,zt,q,L,je,Ge,!1,!1,Xe,Ee,Ue);if(!Qt)return{notEnoughRoom:!0};wn(Qt)}return{}}function Ei(b,d,v,T,C){const{x:L,y:B,z:U}=T.projectTilePoint(b.x,b.y,d);if(!C)return Ds(L,B,U,v);const[q,ie,ne]=C(b);return Ds(L+q,B+ie,U+ne,v)}function Si(b,d,v,T,C,L,B,U){const q=Ei(b.sub(d)._unit()._add(b),U,C,B,L);return l.sub(q,v,q),l.normalize(q,q),l.scaleAndAdd(q,v,q,T)}function ys(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge,Xe,Ee){const Ue=T?b-d:b+d;let it=Ue>0?1:-1,lt=0;T&&(it*=-1,lt=Math.PI),it<0&&(lt+=Math.PI);let Ct=U+B+(it>0?0:1)|0,It=C,Mt=C,jt=0,Bt=0;const Yt=Math.abs(Ue),Zn=[],zt=[];let wn=L,Qt=wn;const Gn=()=>Si(Qt,wn,Mt,Yt-jt+1,ne,Re,Ge,Xe.canonical);for(;jt+Bt<=Yt;){if(Ct+=it,Ct<U||Ct>=q)return null;if(Mt=It,Qt=wn,Zn.push(Mt),je&&zt.push(Qt),wn=new l.Point(ie.getx(Ct),ie.gety(Ct)),It=be[Ct],!It){const Xr=Ei(wn,Xe.canonical,ne,Ge,Re);It=Xr[3]>0?be[Ct]=Xr:Gn()}jt+=Bt,Bt=l.distance(Mt,It)}He&&Re&&(be[Ct]&&(It=Gn(),Bt=l.distance(Mt,It)),be[Ct]=It);const $t=(Yt-jt)/Bt,vn=wn.sub(Qt)._mult($t)._add(Qt),Tn=l.sub([],It,Mt),kn=l.scaleAndAdd([],Mt,Tn,$t);let Yn=[0,0,1],Ur=Tn[0],ui=Tn[1];if(Ee&&(Yn=Ge.upVector(Xe.canonical,vn.x,vn.y),Yn[0]!==0||Yn[1]!==0||Yn[2]!==1)){const Xr=[Yn[2],0,-Yn[0]],ki=l.cross([],Yn,Xr);l.normalize(Xr,Xr),l.normalize(ki,ki),Ur=l.dot(Tn,Xr),ui=l.dot(Tn,ki)}if(v){const Xr=l.cross([],Yn,Tn);l.normalize(Xr,Xr),l.scaleAndAdd(kn,kn,Xr,v*it)}const Mr=lt+Math.atan2(ui,Ur);return Zn.push(kn),je&&zt.push(vn),{point:kn,angle:Mr,path:Zn,tilePath:zt,up:Yn}}function $a(b,d){const v=d.length,T=v+4*b;d.resize(T),d.float32.fill(-1/0,4*v,4*T)}function vi(b,d,v){const T=d[0],C=d[1];return b[0]=v[0]*T+v[4]*C+v[12],b[1]=v[1]*T+v[5]*C+v[13],b[3]=v[3]*T+v[7]*C+v[15],b}const we=100;class ve{constructor(d,v,T=new yl(d.width+200,d.height+200,25),C=new yl(d.width+200,d.height+200,25)){this.transform=d,this.grid=T,this.ignoredGrid=C,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+we,this.screenBottomBoundary=d.height+we,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.fogState=v}placeCollisionBox(d,v,T,C,L,B,U,q){let ie=T.projectedAnchorX,ne=T.projectedAnchorY,be=T.projectedAnchorZ;const Re=T.elevation,je=T.tileID,He=d.getProjection();if(Re&&je){const[It,Mt,jt]=He.upVector(je.canonical,T.tileAnchorX,T.tileAnchorY),Bt=He.upVectorScale(je.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;ie+=It*Re*Bt,ne+=Mt*Re*Bt,be+=jt*Re*Bt}const Ge=this.projectAndGetPerspectiveRatio(U,ie,ne,be,T.tileID,He.name==="globe"||!!Re||this.transform.pitch>0,He),Xe=B*Ge.perspectiveRatio,Ee=(T.x1*v+C.x-T.padding)*Xe+Ge.point.x,Ue=(T.y1*v+C.y-T.padding)*Xe+Ge.point.y,it=(T.x2*v+C.x+T.padding)*Xe+Ge.point.x,lt=(T.y2*v+C.y+T.padding)*Xe+Ge.point.y,Ct=Ge.perspectiveRatio<=.55||Ge.occluded;return!this.isInsideGrid(Ee,Ue,it,lt)||!L&&this.grid.hitTest(Ee,Ue,it,lt,q)||Ct?{box:[],offscreen:!1,occluded:Ge.occluded}:{box:[Ee,Ue,it,lt],offscreen:this.isOffscreen(Ee,Ue,it,lt),occluded:!1}}placeCollisionCircles(d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge){const Xe=[],Ee=this.transform.elevation,Ue=d.getProjection(),it=Ee?Ee.getAtTileOffsetFunc(Ge,this.transform.center.lat,this.transform.worldSize,Ue):null,lt=new l.Point(T.tileAnchorX,T.tileAnchorY);let{x:Ct,y:It,z:Mt}=Ue.projectTilePoint(lt.x,lt.y,Ge.canonical);if(it){const[vn,Tn,kn]=it(lt);Ct+=vn,It+=Tn,Mt+=kn}const jt=Ue.name==="globe",Bt=this.projectAndGetPerspectiveRatio(U,Ct,It,Mt,Ge,jt||!!Ee||this.transform.pitch>0,Ue),{perspectiveRatio:Yt}=Bt,Zn=(be?B/Yt:B*Yt)/l.ONE_EM,zt=Ds(Ct,It,Mt,q),wn=Bt.signedDistanceFromCamera>0?Aa(Zn,L,T.lineOffsetX*Zn,T.lineOffsetY*Zn,!1,zt,lt,T,C,q,{},Ee&&!be?it:null,be&&!!Ee,Ue,Ge,be):null;let Qt=!1,Gn=!1,$t=!0;if(wn&&!Bt.occluded){const vn=.5*je*Yt+He,Tn=new l.Point(-100,-100),kn=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),Yn=new Bc,{first:Ur,last:ui}=wn,Mr=Ur.path.length;let Xr=[];for(let Hr=Mr-1;Hr>=1;Hr--)Xr.push(Ur.path[Hr]);for(let Hr=1;Hr<ui.path.length;Hr++)Xr.push(ui.path[Hr]);const ki=2.5*vn;ie&&(Xr=Xr.map(([Hr,fs,bs],Ts)=>(it&&!jt&&(bs=it(Ts<Mr-1?Ur.tilePath[Mr-1-Ts]:ui.tilePath[Ts-Mr+2])[2]),Ds(Hr,fs,bs,ie))),Xr.some(Hr=>Hr[3]<=0)&&(Xr=[]));let Ci=[];if(Xr.length>0){let Hr=1/0,fs=-1/0,bs=1/0,Ts=-1/0;for(const Os of Xr)Hr=Math.min(Hr,Os[0]),bs=Math.min(bs,Os[1]),fs=Math.max(fs,Os[0]),Ts=Math.max(Ts,Os[1]);fs>=Tn.x&&Hr<=kn.x&&Ts>=Tn.y&&bs<=kn.y&&(Ci=[Xr.map(Os=>new l.Point(Os[0],Os[1]))],(Hr<Tn.x||fs>kn.x||bs<Tn.y||Ts>kn.y)&&(Ci=l.clipLine(Ci,Tn.x,Tn.y,kn.x,kn.y)))}for(const Hr of Ci){Yn.reset(Hr,.25*vn);let fs=0;fs=Yn.length<=.5*vn?1:Math.ceil(Yn.paddedLength/ki)+1;for(let bs=0;bs<fs;bs++){const Ts=bs/Math.max(fs-1,1),Os=Yn.lerp(Ts),Ya=Os.x+we,Ra=Os.y+we;Xe.push(Ya,Ra,vn,0);const Vl=Ya-vn,wu=Ra-vn,Hs=Ya+vn,Fs=Ra+vn;if($t=$t&&this.isOffscreen(Vl,wu,Hs,Fs),Gn=Gn||this.isInsideGrid(Vl,wu,Hs,Fs),!v&&this.grid.hitTestCircle(Ya,Ra,vn,Re)&&(Qt=!0,!ne))return{circles:[],offscreen:!1,collisionDetected:Qt,occluded:!1}}}}return{circles:!ne&&Qt||!Gn?[]:Xe,offscreen:$t,collisionDetected:Qt,occluded:Bt.occluded}}queryRenderedSymbols(d){if(d.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const v=[];let T=1/0,C=1/0,L=-1/0,B=-1/0;for(const ne of d){const be=new l.Point(ne.x+we,ne.y+we);T=Math.min(T,be.x),C=Math.min(C,be.y),L=Math.max(L,be.x),B=Math.max(B,be.y),v.push(be)}const U=this.grid.query(T,C,L,B).concat(this.ignoredGrid.query(T,C,L,B)),q={},ie={};for(const ne of U){const be=ne.key;if(q[be.bucketInstanceId]===void 0&&(q[be.bucketInstanceId]={}),q[be.bucketInstanceId][be.featureIndex])continue;const Re=[new l.Point(ne.x1,ne.y1),new l.Point(ne.x2,ne.y1),new l.Point(ne.x2,ne.y2),new l.Point(ne.x1,ne.y2)];l.polygonIntersectsPolygon(v,Re)&&(q[be.bucketInstanceId][be.featureIndex]=!0,ie[be.bucketInstanceId]===void 0&&(ie[be.bucketInstanceId]=[]),ie[be.bucketInstanceId].push(be.featureIndex))}return ie}insertCollisionBox(d,v,T,C,L){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:T,featureIndex:C,collisionGroupID:L},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,v,T,C,L){const B=v?this.ignoredGrid:this.grid,U={bucketInstanceId:T,featureIndex:C,collisionGroupID:L};for(let q=0;q<d.length;q+=4)B.insertCircle(U,d[q],d[q+1],d[q+2])}projectAndGetPerspectiveRatio(d,v,T,C,L,B,U){const q=[v,T,C,1];let ie=!1;C||this.transform.pitch>0?(l.transformMat4$1(q,q,d),this.fogState&&L&&U.name!=="globe"&&(ie=function(Re,je,He,Ge,Xe,Ee){const Ue=Ee.calculateFogTileMatrix(Xe),it=[je,He,Ge];return l.transformMat4(it,it,Ue),ge(Re,it,Ee.pitch,Ee._fov)}(this.fogState,v,T,C,L.toUnwrapped(),this.transform)>.9)):vi(q,q,d);const ne=q[3];return{point:new l.Point((q[0]/ne+1)/2*this.transform.width+we,(-q[1]/ne+1)/2*this.transform.height+we),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(U)/ne*.5,1.5),signedDistanceFromCamera:ne,occluded:B&&q[2]>ne||ie}}isOffscreen(d,v,T,C){return T<we||d>=this.screenRightBoundary||C<we||v>this.screenBottomBoundary}isInsideGrid(d,v,T,C){return T>=0&&d<this.gridRightBoundary&&C>=0&&v<this.gridBottomBoundary}getViewportMatrix(){const d=l.identity([]);return l.translate(d,d,[-100,-100,0]),d}}function Le(b,d,v){const T=d.createTileMatrix(b,b.worldSize,v.toUnwrapped());return l.multiply(new Float32Array(16),b.projMatrix,T)}function ot(b,d,v){if(d.projection.name===v.projection.name)return b.projMatrix;const T=v.clone();return T.setProjection(d.projection),Le(T,d.getProjection(),b)}function Gt(b,d,v){return d.name===v.projection.name?b.projMatrix:Le(v,d,b)}class yn{constructor(d,v,T,C){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?v:-v))):C&&T?1:0,this.placed=T}isHidden(){return this.opacity===0&&!this.placed}}class Ht{constructor(d,v,T,C,L,B=!1){this.text=new yn(d?d.text:null,v,T,L),this.icon=new yn(d?d.icon:null,v,C,L),this.clipped=B}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class En{constructor(d,v,T,C=!1){this.text=d,this.icon=v,this.skipFade=T,this.clipped=C}}class fe{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class ue{constructor(d,v,T,C,L){this.bucketInstanceId=d,this.featureIndex=v,this.sourceLayerIndex=T,this.bucketIndex=C,this.tileID=L}}class Me{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const v=++this.maxGroupID;this.collisionGroups[d]={ID:v,predicate:T=>T.collisionGroupID===v}}return this.collisionGroups[d]}}function De(b,d,v,T,C){const{horizontalAlign:L,verticalAlign:B}=l.getAnchorAlignment(b),U=-(L-.5)*d,q=-(B-.5)*v,ie=l.evaluateVariableOffset(b,T);return new l.Point(U+ie[0]*C,q+ie[1]*C)}function Pe(b,d,v,T,C){const L=new l.Point(b,d);return v&&L._rotate(T?C:-C),L}class Dt{constructor(d,v,T,C,L){this.transform=d.clone(),this.projection=d.projection.name,this.collisionIndex=new ve(this.transform,L),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new Me(T),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,v,T,C){const L=T.getBucket(v),B=T.latestFeatureIndex;if(!L||!B||v.id!==L.layerIds[0])return;const U=L.layers[0].layout,q=T.collisionBoxArray,ie=Math.pow(2,this.transform.zoom-T.tileID.overscaledZ),ne=T.tileSize/l.EXTENT,be=T.tileID.toUnwrapped();this.transform.setProjection(L.projection);const Re=(je=T.tileID,He=L.getProjection(),Ge=this.transform,He.name===this.projection?Ge.calculateProjMatrix(je.toUnwrapped()):Le(Ge,He,je));var je,He,Ge;const Xe=U.get("text-pitch-alignment")==="map",Ee=U.get("text-rotation-alignment")==="map";v.compileFilter();const Ue=v.dynamicFilter(),it=v.dynamicFilterNeedsFeature(),lt=this.transform.calculatePixelsToTileUnitsMatrix(T),Ct=ko(Re,T.tileID.canonical,Xe,Ee,this.transform,L.getProjection(),lt);let It=null;if(Xe){const Bt=ns(Re,T.tileID.canonical,Xe,Ee,this.transform,L.getProjection(),lt);It=l.multiply([],this.transform.labelPlaneMatrix,Bt)}let Mt=null;Ue&&T.latestFeatureIndex&&(Mt={unwrappedTileID:be,dynamicFilter:Ue,dynamicFilterNeedsFeature:it,featureIndex:T.latestFeatureIndex}),this.retainedQueryData[L.bucketInstanceId]=new ue(L.bucketInstanceId,B,L.sourceLayerIndex,L.index,T.tileID);const jt={bucket:L,layout:U,posMatrix:Re,textLabelPlaneMatrix:Ct,labelToScreenMatrix:It,clippingData:Mt,scale:ie,textPixelRatio:ne,holdingForFade:T.holdingForFade(),collisionBoxArray:q,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(L.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(L.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(L.sourceID)};if(C)for(const Bt of L.sortKeyRanges){const{sortKey:Yt,symbolInstanceStart:Zn,symbolInstanceEnd:zt}=Bt;d.push({sortKey:Yt,symbolInstanceStart:Zn,symbolInstanceEnd:zt,parameters:jt})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:L.symbolInstances.length,parameters:jt})}attemptAnchorPlacement(d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge,Xe,Ee,Ue){const{textOffset0:it,textOffset1:lt,crossTileID:Ct}=Re,It=[it,lt],Mt=De(d,T,C,It,L),jt=this.collisionIndex.placeCollisionBox(He,L,v,Pe(Mt.x,Mt.y,B,U,this.transform.angle),be,q,ie,ne.predicate);if(Xe){const Bt=He.getSymbolInstanceIconSize(Ue,this.transform.zoom,Re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(He,Bt,Xe,Pe(Mt.x,Mt.y,B,U,this.transform.angle),be,q,ie,ne.predicate).box.length===0)return}if(jt.box.length>0){let Bt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ct]&&this.prevPlacement.placements[Ct]&&this.prevPlacement.placements[Ct].text&&(Bt=this.prevPlacement.variableOffsets[Ct].anchor),this.variableOffsets[Ct]={textOffset:It,width:T,height:C,anchor:d,textScale:L,prevAnchor:Bt},this.markUsedJustification(He,d,Re,Ge),He.allowVerticalPlacement&&(this.markUsedOrientation(He,Ge,Re),this.placedOrientations[Ct]=Ge),{shift:Mt,placedGlyphBoxes:jt}}}placeLayerBucketPart(d,v,T,C){const{bucket:L,layout:B,posMatrix:U,textLabelPlaneMatrix:q,labelToScreenMatrix:ie,clippingData:ne,textPixelRatio:be,holdingForFade:Re,collisionBoxArray:je,partiallyEvaluatedTextSize:He,partiallyEvaluatedIconSize:Ge,collisionGroup:Xe}=d.parameters,Ee=B.get("text-optional"),Ue=B.get("icon-optional"),it=B.get("text-allow-overlap"),lt=B.get("icon-allow-overlap"),Ct=B.get("text-rotation-alignment")==="map",It=B.get("text-pitch-alignment")==="map",Mt=B.get("icon-text-fit")!=="none",jt=B.get("symbol-z-order")==="viewport-y";this.transform.setProjection(L.projection);let Bt=it&&(lt||!L.hasIconData()||Ue),Yt=lt&&(it||!L.hasTextData()||Ee);!L.collisionArrays&&je&&L.deserializeCollisionBoxes(je),T&&C&&L.updateCollisionDebugBuffers(this.transform.zoom,je);const Zn=(zt,wn,Qt)=>{const{crossTileID:Gn,numVerticalGlyphVertices:$t}=zt;if(ne){const Hs={zoom:this.transform.zoom,pitch:this.transform.pitch};let Fs=null;if(ne.dynamicFilterNeedsFeature){const ps=this.retainedQueryData[L.bucketInstanceId];Fs=ne.featureIndex.loadFeature({featureIndex:zt.featureIndex,bucketIndex:ps.bucketIndex,sourceLayerIndex:ps.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,ne.dynamicFilter)(Hs,Fs,this.retainedQueryData[L.bucketInstanceId].tileID.canonical,new l.Point(zt.tileAnchorX,zt.tileAnchorY),this.transform.calculateDistanceTileData(ne.unwrappedTileID)))return this.placements[Gn]=new En(!1,!1,!1,!0),void v.add(Gn)}if(v.has(Gn))return;if(Re)return void(this.placements[Gn]=new En(!1,!1,!1));let vn=!1,Tn=!1,kn=!0,Yn=!1,Ur=!1,ui=null,Mr={box:null,offscreen:null,occluded:null},Xr={box:null,offscreen:null,occluded:null},ki=null,Ci=null,Hr=null,fs=0,bs=0,Ts=0;Qt.textFeatureIndex?fs=Qt.textFeatureIndex:zt.useRuntimeCollisionCircles&&(fs=zt.featureIndex),Qt.verticalTextFeatureIndex&&(bs=Qt.verticalTextFeatureIndex);const Os=Hs=>{Hs.tileID=this.retainedQueryData[L.bucketInstanceId].tileID;const Fs=this.transform.elevation;(Fs||Hs.elevation)&&(Hs.elevation=Fs?Fs.getAtTileOffset(Hs.tileID,Hs.tileAnchorX,Hs.tileAnchorY):0)},Ya=Qt.textBox;if(Ya){Os(Ya);const Hs=ps=>{let Go=l.WritingMode.horizontal;if(L.allowVerticalPlacement&&!ps&&this.prevPlacement){const wl=this.prevPlacement.placedOrientations[Gn];wl&&(this.placedOrientations[Gn]=wl,Go=wl,this.markUsedOrientation(L,Go,zt))}return Go},Fs=(ps,Go)=>{if(L.allowVerticalPlacement&&$t>0&&Qt.verticalTextBox){for(const wl of L.writingModes)if(wl===l.WritingMode.vertical?(Mr=Go(),Xr=Mr):Mr=ps(),Mr&&Mr.box&&Mr.box.length)break}else Mr=ps()};if(B.get("text-variable-anchor")){let ps=B.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Gn]){const Ys=this.prevPlacement.variableOffsets[Gn];ps.indexOf(Ys.anchor)>0&&(ps=ps.filter(iu=>iu!==Ys.anchor),ps.unshift(Ys.anchor))}const Go=(Ys,iu,ag)=>{const qc=L.getSymbolInstanceTextSize(He,zt,this.transform.zoom,wn),kd=(Ys.x2-Ys.x1)*qc+2*Ys.padding,Gl=(Ys.y2-Ys.y1)*qc+2*Ys.padding,Ih=Mt&&!lt?iu:null;Ih&&Os(Ih);let Lf={box:[],offscreen:!1,occluded:!1};const Pf=it?2*ps.length:ps.length;for(let yc=0;yc<Pf;++yc){const E0=this.attemptAnchorPlacement(ps[yc%ps.length],Ys,kd,Gl,qc,Ct,It,be,U,Xe,yc>=ps.length,zt,wn,L,ag,Ih,He,Ge);if(E0&&(Lf=E0.placedGlyphBoxes,Lf&&Lf.box&&Lf.box.length)){vn=!0,ui=E0.shift;break}}return Lf};Fs(()=>Go(Ya,Qt.iconBox,l.WritingMode.horizontal),()=>{const Ys=Qt.verticalTextBox;return Ys&&Os(Ys),L.allowVerticalPlacement&&!(Mr&&Mr.box&&Mr.box.length)&&$t>0&&Ys?Go(Ys,Qt.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Mr&&(vn=Mr.box,kn=Mr.offscreen,Yn=Mr.occluded);const wl=Hs(!(!Mr||!Mr.box));if(!vn&&this.prevPlacement){const Ys=this.prevPlacement.variableOffsets[Gn];Ys&&(this.variableOffsets[Gn]=Ys,this.markUsedJustification(L,Ys.anchor,zt,wl))}}else{const ps=(Go,wl)=>{const Ys=L.getSymbolInstanceTextSize(He,zt,this.transform.zoom,wn),iu=this.collisionIndex.placeCollisionBox(L,Ys,Go,new l.Point(0,0),it,be,U,Xe.predicate);return iu&&iu.box&&iu.box.length&&(this.markUsedOrientation(L,wl,zt),this.placedOrientations[Gn]=wl),iu};Fs(()=>ps(Ya,l.WritingMode.horizontal),()=>{const Go=Qt.verticalTextBox;return L.allowVerticalPlacement&&$t>0&&Go?(Os(Go),ps(Go,l.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Hs(!!(Mr&&Mr.box&&Mr.box.length))}}if(ki=Mr,vn=ki&&ki.box&&ki.box.length>0,kn=ki&&ki.offscreen,Yn=ki&&ki.occluded,zt.useRuntimeCollisionCircles){const Hs=L.text.placedSymbolArray.get(zt.centerJustifiedTextSymbolIndex>=0?zt.centerJustifiedTextSymbolIndex:zt.verticalPlacedTextSymbolIndex),Fs=l.evaluateSizeForFeature(L.textSizeData,He,Hs),ps=B.get("text-padding");Ci=this.collisionIndex.placeCollisionCircles(L,it,Hs,L.lineVertexArray,L.glyphOffsetArray,Fs,U,q,ie,T,It,Xe.predicate,zt.collisionCircleDiameter*Fs/l.ONE_EM,ps,this.retainedQueryData[L.bucketInstanceId].tileID),vn=it||Ci.circles.length>0&&!Ci.collisionDetected,kn=kn&&Ci.offscreen,Yn=Ci.occluded}if(Qt.iconFeatureIndex&&(Ts=Qt.iconFeatureIndex),Qt.iconBox){const Hs=Fs=>{Os(Fs);const ps=Mt&&ui?Pe(ui.x,ui.y,Ct,It,this.transform.angle):new l.Point(0,0),Go=L.getSymbolInstanceIconSize(Ge,this.transform.zoom,zt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(L,Go,Fs,ps,lt,be,U,Xe.predicate)};Xr&&Xr.box&&Xr.box.length&&Qt.verticalIconBox?(Hr=Hs(Qt.verticalIconBox),Tn=Hr.box.length>0):(Hr=Hs(Qt.iconBox),Tn=Hr.box.length>0),kn=kn&&Hr.offscreen,Ur=Hr.occluded}const Ra=Ee||zt.numHorizontalGlyphVertices===0&&$t===0,Vl=Ue||zt.numIconVertices===0;if(Ra||Vl?Vl?Ra||(Tn=Tn&&vn):vn=Tn&&vn:Tn=vn=Tn&&vn,vn&&ki&&ki.box&&this.collisionIndex.insertCollisionBox(ki.box,B.get("text-ignore-placement"),L.bucketInstanceId,Xr&&Xr.box&&bs?bs:fs,Xe.ID),Tn&&Hr&&this.collisionIndex.insertCollisionBox(Hr.box,B.get("icon-ignore-placement"),L.bucketInstanceId,Ts,Xe.ID),Ci&&(vn&&this.collisionIndex.insertCollisionCircles(Ci.circles,B.get("text-ignore-placement"),L.bucketInstanceId,fs,Xe.ID),T)){const Hs=L.bucketInstanceId;let Fs=this.collisionCircleArrays[Hs];Fs===void 0&&(Fs=this.collisionCircleArrays[Hs]=new fe);for(let ps=0;ps<Ci.circles.length;ps+=4)Fs.circles.push(Ci.circles[ps+0]),Fs.circles.push(Ci.circles[ps+1]),Fs.circles.push(Ci.circles[ps+2]),Fs.circles.push(Ci.collisionDetected?1:0)}const wu=L.projection.name!=="globe";Bt=Bt&&(wu||!Yn),Yt=Yt&&(wu||!Ur),this.placements[Gn]=new En(vn||Bt,Tn||Yt,kn||L.justReloaded),v.add(Gn)};if(jt){const zt=L.getSortedSymbolIndexes(this.transform.angle);for(let wn=zt.length-1;wn>=0;--wn){const Qt=zt[wn];Zn(L.symbolInstances.get(Qt),Qt,L.collisionArrays[Qt])}}else for(let zt=d.symbolInstanceStart;zt<d.symbolInstanceEnd;zt++)Zn(L.symbolInstances.get(zt),zt,L.collisionArrays[zt]);if(T&&L.bucketInstanceId in this.collisionCircleArrays){const zt=this.collisionCircleArrays[L.bucketInstanceId];l.invert(zt.invProjMatrix,U),zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}L.justReloaded=!1}markUsedJustification(d,v,T,C){const{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:q,crossTileID:ie}=T,ne=l.getAnchorJustification(v),be=C===l.WritingMode.vertical?q:ne==="left"?L:ne==="center"?B:ne==="right"?U:-1;L>=0&&(d.text.placedSymbolArray.get(L).crossTileID=be>=0&&L!==be?0:ie),B>=0&&(d.text.placedSymbolArray.get(B).crossTileID=be>=0&&B!==be?0:ie),U>=0&&(d.text.placedSymbolArray.get(U).crossTileID=be>=0&&U!==be?0:ie),q>=0&&(d.text.placedSymbolArray.get(q).crossTileID=be>=0&&q!==be?0:ie)}markUsedOrientation(d,v,T){const C=v===l.WritingMode.horizontal||v===l.WritingMode.horizontalOnly?v:0,L=v===l.WritingMode.vertical?v:0,{leftJustifiedTextSymbolIndex:B,centerJustifiedTextSymbolIndex:U,rightJustifiedTextSymbolIndex:q,verticalPlacedTextSymbolIndex:ie}=T,ne=d.text.placedSymbolArray;B>=0&&(ne.get(B).placedOrientation=C),U>=0&&(ne.get(U).placedOrientation=C),q>=0&&(ne.get(q).placedOrientation=C),ie>=0&&(ne.get(ie).placedOrientation=L)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;const v=this.prevPlacement;let T=!1;this.prevZoomAdjustment=v?v.zoomAdjustment(this.transform.zoom):0;const C=v?v.symbolFadeChange(d):1,L=v?v.opacities:{},B=v?v.variableOffsets:{},U=v?v.placedOrientations:{};for(const q in this.placements){const ie=this.placements[q],ne=L[q];ne?(this.opacities[q]=new Ht(ne,C,ie.text,ie.icon,null,ie.clipped),T=T||ie.text!==ne.text.placed||ie.icon!==ne.icon.placed):(this.opacities[q]=new Ht(null,C,ie.text,ie.icon,ie.skipFade,ie.clipped),T=T||ie.text||ie.icon)}for(const q in L){const ie=L[q];if(!this.opacities[q]){const ne=new Ht(ie,C,!1,!1);ne.isHidden()||(this.opacities[q]=ne,T=T||ie.text.placed||ie.icon.placed)}}for(const q in B)this.variableOffsets[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.variableOffsets[q]=B[q]);for(const q in U)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=U[q]);T?this.lastPlacementChangeTime=d:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=v?v.lastPlacementChangeTime:d)}updateLayerOpacities(d,v){const T=new Set;for(const C of v){const L=C.getBucket(d);L&&C.latestFeatureIndex&&d.id===L.layerIds[0]&&this.updateBucketOpacities(L,T,C.collisionBoxArray)}}updateBucketOpacities(d,v,T){d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();const C=d.layers[0].layout,L=!!d.layers[0].dynamicFilter(),B=new Ht(null,0,!1,!1,!0),U=C.get("text-allow-overlap"),q=C.get("icon-allow-overlap"),ie=C.get("text-variable-anchor"),ne=C.get("text-rotation-alignment")==="map",be=C.get("text-pitch-alignment")==="map",Re=C.get("icon-text-fit")!=="none",je=new Ht(null,0,U&&(q||!d.hasIconData()||C.get("icon-optional")),q&&(U||!d.hasTextData()||C.get("text-optional")),!0);!d.collisionArrays&&T&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(T);const He=(Xe,Ee,Ue)=>{for(let it=0;it<Ee/4;it++)Xe.opacityVertexArray.emplaceBack(Ue)};let Ge=0;for(let Xe=0;Xe<d.symbolInstances.length;Xe++){const Ee=d.symbolInstances.get(Xe),{numHorizontalGlyphVertices:Ue,numVerticalGlyphVertices:it,crossTileID:lt,numIconVertices:Ct}=Ee,It=v.has(lt);let Mt=this.opacities[lt];It?Mt=B:Mt||(Mt=je,this.opacities[lt]=Mt),v.add(lt);const jt=Ue>0||it>0,Bt=Ct>0,Yt=this.placedOrientations[lt],Zn=Yt===l.WritingMode.vertical,zt=Yt===l.WritingMode.horizontal||Yt===l.WritingMode.horizontalOnly;if(!jt&&!Bt||Mt.isHidden()||Ge++,jt){const wn=fr(Mt.text);He(d.text,Ue,Zn?cn:wn),He(d.text,it,zt?cn:wn);const Qt=Mt.text.isHidden(),{leftJustifiedTextSymbolIndex:Gn,centerJustifiedTextSymbolIndex:$t,rightJustifiedTextSymbolIndex:vn,verticalPlacedTextSymbolIndex:Tn}=Ee,kn=d.text.placedSymbolArray,Yn=Qt||Zn?1:0;Gn>=0&&(kn.get(Gn).hidden=Yn),$t>=0&&(kn.get($t).hidden=Yn),vn>=0&&(kn.get(vn).hidden=Yn),Tn>=0&&(kn.get(Tn).hidden=Qt||zt?1:0);const Ur=this.variableOffsets[lt];Ur&&this.markUsedJustification(d,Ur.anchor,Ee,Yt);const ui=this.placedOrientations[lt];ui&&(this.markUsedJustification(d,"left",Ee,ui),this.markUsedOrientation(d,ui,Ee))}if(Bt){const wn=fr(Mt.icon),{placedIconSymbolIndex:Qt,verticalPlacedIconSymbolIndex:Gn}=Ee,$t=d.icon.placedSymbolArray,vn=Mt.icon.isHidden()?1:0;Qt>=0&&(He(d.icon,Ct,Zn?cn:wn),$t.get(Qt).hidden=vn),Gn>=0&&(He(d.icon,Ee.numVerticalIconVertices,zt?cn:wn),$t.get(Gn).hidden=vn)}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){const wn=d.collisionArrays[Xe];if(wn){let Qt=new l.Point(0,0),Gn=!0;if(wn.textBox||wn.verticalTextBox){if(ie){const vn=this.variableOffsets[lt];vn?(Qt=De(vn.anchor,vn.width,vn.height,vn.textOffset,vn.textScale),ne&&Qt._rotate(be?this.transform.angle:-this.transform.angle)):Gn=!1}L&&(Gn=!Mt.clipped),wn.textBox&&Zt(d.textCollisionBox.collisionVertexArray,Mt.text.placed,!Gn||Zn,Qt.x,Qt.y),wn.verticalTextBox&&Zt(d.textCollisionBox.collisionVertexArray,Mt.text.placed,!Gn||zt,Qt.x,Qt.y)}const $t=Gn&&!!(!zt&&wn.verticalIconBox);wn.iconBox&&Zt(d.iconCollisionBox.collisionVertexArray,Mt.icon.placed,$t,Re?Qt.x:0,Re?Qt.y:0),wn.verticalIconBox&&Zt(d.iconCollisionBox.collisionVertexArray,Mt.icon.placed,!$t,Re?Qt.x:0,Re?Qt.y:0)}}}if(d.fullyClipped=Ge===0,d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){const Xe=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=Xe.invProjMatrix,d.placementViewportMatrix=Xe.viewportMatrix,d.collisionCircleArray=Xe.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}}symbolFadeChange(d){return this.fadeDuration===0?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,v){const T=this.zoomAtLastRecencyCheck===v?1-this.zoomAdjustment(v):1;return this.zoomAtLastRecencyCheck=v,this.commitTime+this.fadeDuration*T>d}setStale(){this.stale=!0}}function Zt(b,d,v,T,C){b.emplaceBack(d?1:0,v?1:0,T||0,C||0),b.emplaceBack(d?1:0,v?1:0,T||0,C||0),b.emplaceBack(d?1:0,v?1:0,T||0,C||0),b.emplaceBack(d?1:0,v?1:0,T||0,C||0)}const pn=Math.pow(2,25),Sn=Math.pow(2,24),lr=Math.pow(2,17),In=Math.pow(2,16),un=Math.pow(2,9),cr=Math.pow(2,8),Bn=Math.pow(2,1);function fr(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const d=b.placed?1:0,v=Math.floor(127*b.opacity);return v*pn+d*Sn+v*lr+d*In+v*un+d*cr+v*Bn+d}const cn=0;class Ar{constructor(d){this._sortAcrossTiles=d.layout.get("symbol-z-order")!=="viewport-y"&&d.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(d,v,T,C,L){const B=this._bucketParts;for(;this._currentTileIndex<d.length;)if(v.getBucketParts(B,C,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,L())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,B.sort((U,q)=>U.sortKey-q.sortKey));this._currentPartIndex<B.length;){const U=B[this._currentPartIndex];if(v.placeLayerBucketPart(U,this._seenCrossTileIDs,T,U.symbolInstanceStart===0),this._currentPartIndex++,L())return!0}return!1}}class $r{constructor(d,v,T,C,L,B,U,q){this.placement=new Dt(d,L,B,U,q),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=T,this._showCollisionBoxes=C,this._done=!1}isDone(){return this._done}continuePlacement(d,v,T){const C=l.exported.now(),L=()=>{const B=l.exported.now()-C;return!this._forceFullPlacement&&B>2};for(;this._currentPlacementIndex>=0;){const B=v[d[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=U)&&(!B.maxzoom||B.maxzoom>U)){if(this._inProgressLayer||(this._inProgressLayer=new Ar(B)),this._inProgressLayer.continuePlacement(T[B.source],this.placement,this._showCollisionBoxes,B,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const ei=512/l.EXTENT/2;class Br{constructor(d,v,T){this.tileID=d,this.bucketInstanceId=T,this.index=new l.KDBush(v.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const C=d.canonical.x*l.EXTENT,L=d.canonical.y*l.EXTENT;for(let B=0;B<v.length;B++){const{key:U,crossTileID:q,tileAnchorX:ie,tileAnchorY:ne}=v.get(B),be=Math.floor((C+ie)*ei),Re=Math.floor((L+ne)*ei);this.index.add(be,Re),this.keys.push(U),this.crossTileIDs.push(q)}this.index.finish()}findMatches(d,v,T){const C=this.tileID.canonical.z<v.canonical.z?1:Math.pow(2,this.tileID.canonical.z-v.canonical.z),L=ei/Math.pow(2,v.canonical.z-this.tileID.canonical.z),B=v.canonical.x*l.EXTENT,U=v.canonical.y*l.EXTENT;for(let q=0;q<d.length;q++){const ie=d.get(q);if(ie.crossTileID)continue;const{key:ne,tileAnchorX:be,tileAnchorY:Re}=ie,je=Math.floor((B+be)*L),He=Math.floor((U+Re)*L),Ge=this.index.range(je-C,He-C,je+C,He+C);for(const Xe of Ge){const Ee=this.crossTileIDs[Xe];if(this.keys[Xe]===ne&&!T.has(Ee)){T.add(Ee),ie.crossTileID=Ee;break}}}}}class qi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Oi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){const v=Math.round((d-this.lng)/360);if(v!==0)for(const T in this.indexes){const C=this.indexes[T],L={};for(const B in C){const U=C[B];U.tileID=U.tileID.unwrapTo(U.tileID.wrap+v),L[U.tileID.key]=U}this.indexes[T]=L}this.lng=d}addBucket(d,v,T){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===v.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let L=0;L<v.symbolInstances.length;L++)v.symbolInstances.get(L).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]=new Set);const C=this.usedCrossTileIDs[d.overscaledZ];for(const L in this.indexes){const B=this.indexes[L];if(Number(L)>d.overscaledZ)for(const U in B){const q=B[U];q.tileID.isChildOf(d)&&q.findMatches(v.symbolInstances,d,C)}else{const U=B[d.scaledTo(Number(L)).key];U&&U.findMatches(v.symbolInstances,d,C)}}for(let L=0;L<v.symbolInstances.length;L++){const B=v.symbolInstances.get(L);B.crossTileID||(B.crossTileID=T.generate(),C.add(B.crossTileID))}return this.indexes[d.overscaledZ]===void 0&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Br(d,v.symbolInstances,v.bucketInstanceId),!0}removeBucketCrossTileIDs(d,v){for(const T of v.crossTileIDs)this.usedCrossTileIDs[d].delete(T)}removeStaleBuckets(d){let v=!1;for(const T in this.indexes){const C=this.indexes[T];for(const L in C)d[C[L].bucketInstanceId]||(this.removeBucketCrossTileIDs(T,C[L]),delete C[L],v=!0)}return v}}class Xn{constructor(){this.layerIndexes={},this.crossTileIDs=new qi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,v,T,C){let L=this.layerIndexes[d.id];L===void 0&&(L=this.layerIndexes[d.id]=new Oi);let B=!1;const U={};C.name!=="globe"&&L.handleWrapJump(T);for(const q of v){const ie=q.getBucket(d);ie&&d.id===ie.layerIds[0]&&(ie.bucketInstanceId||(ie.bucketInstanceId=++this.maxBucketInstanceId),L.addBucket(q.tileID,ie,this.crossTileIDs)&&(B=!0),U[ie.bucketInstanceId]=!0)}return L.removeStaleBuckets(U)&&(B=!0),B}pruneUnusedLayers(d){const v={};d.forEach(T=>{v[T]=!0});for(const T in this.layerIndexes)v[T]||delete this.layerIndexes[T]}}const es=(b,d)=>l.emitValidationErrors(b,d&&d.filter(v=>v.identifier!=="source.canvas")),li=l.pick(ri,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Do=l.pick(ri,["setCenter","setZoom","setBearing","setPitch"]),xi={version:8,layers:[],sources:{}},pa={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class jo extends l.Evented{constructor(d,v={}){super(),this.map=d,this.dispatcher=new Je(No(),this),this.imageManager=new st,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(d._requestManager,v.localFontFamily?l.LocalGlyphMode.all:v.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,v.localFontFamily||v.localIdeographFontFamily),this.crossTileSymbolIndex=new Xn,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const T=this;this._rtlTextPluginCallback=jo.registerForPluginStateChange(C=>{T.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(L,B)=>{if(l.triggerPluginCompletionEvent(L),B&&B.every(U=>U))for(const U in T._sourceCaches){const q=T._sourceCaches[U],ie=q.getSource().type;ie!=="vector"&&ie!=="geojson"||q.reload()}})}),this.on("data",C=>{if(C.dataType!=="source"||C.sourceDataType!=="metadata")return;const L=this.getSource(C.sourceId);if(L&&L.vectorLayerIds)for(const B in this._layers){const U=this._layers[B];U.source===L.id&&this._validateLayer(U)}})}loadURL(d,v={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const T=typeof v.validate=="boolean"?v.validate:!l.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,v.accessToken);const C=this.map._requestManager.transformRequest(d,l.ResourceType.Style);this._request=l.getJSON(C,(L,B)=>{this._request=null,L?this.fire(new l.ErrorEvent(L)):B&&this._load(B,T)})}loadJSON(d,v={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(d,v.validate!==!1)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(xi,!1)}_updateLayerCount(d,v){const T=v?1:-1;d.is3D()&&(this._num3DLayers+=T),d.type==="circle"&&(this._numCircleLayers+=T),d.type==="symbol"&&(this._numSymbolLayers+=T)}_load(d,v){if(v&&es(this,l.validateStyle(d)))return;this._loaded=!0,this.stylesheet=l.clone$1(d),this._updateMapProjection();for(const C in d.sources)this.addSource(C,d.sources[C],{validate:!1});this._changed=!1,d.sprite?this._loadSprite(d.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(d.glyphs);const T=ea(this.stylesheet.layers);this._order=T.map(C=>C.id),this._layers={},this._serializedLayers={};for(const C of T){const L=l.createStyleLayer(C);L.setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=L,this._serializedLayers[L.id]=L.serialize(),this._updateLayerCount(L,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new et(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(d){d?this.stylesheet.projection=d:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(d){this._spriteRequest=function(v,T,C){let L,B,U;const q=l.exported.devicePixelRatio>1?"@2x":"";let ie=l.getJSON(T.transformRequest(T.normalizeSpriteURL(v,q,".json"),l.ResourceType.SpriteJSON),(Re,je)=>{ie=null,U||(U=Re,L=je,be())}),ne=l.getImage(T.transformRequest(T.normalizeSpriteURL(v,q,".png"),l.ResourceType.SpriteImage),(Re,je)=>{ne=null,U||(U=Re,B=je,be())});function be(){if(U)C(U);else if(L&&B){const Re=l.exported.getImageData(B),je={};for(const He in L){const{width:Ge,height:Xe,x:Ee,y:Ue,sdf:it,pixelRatio:lt,stretchX:Ct,stretchY:It,content:Mt}=L[He],jt=new l.RGBAImage({width:Ge,height:Xe});l.RGBAImage.copy(Re,jt,{x:Ee,y:Ue},{x:0,y:0},{width:Ge,height:Xe}),je[He]={data:jt,pixelRatio:lt,sdf:it,stretchX:Ct,stretchY:It,content:Mt}}C(null,je)}}return{cancel(){ie&&(ie.cancel(),ie=null),ne&&(ne.cancel(),ne=null)}}}(d,this.map._requestManager,(v,T)=>{if(this._spriteRequest=null,v)this.fire(new l.ErrorEvent(v));else if(T)for(const C in T)this.imageManager.addImage(C,T[C]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(d){const v=this.getSource(d.source);if(!v)return;const T=d.sourceLayer;T&&(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(T)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${T}" does not exist on source "${v.id}" as specified by style layer "${d.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this._sourceCaches)if(!this._sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(d){const v=[];for(const T of d){const C=this._layers[T];C.type!=="custom"&&v.push(C.serialize())}return v}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const d in this._sourceCaches)if(this._sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(d){return!!this.terrain&&(typeof d.isLayerDraped=="function"?d.isLayerDraped():pa[d.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(d){if(!this._loaded)return;const v=this._changed;if(this._changed){const C=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);(C.length||L.length)&&this._updateWorkerLayers(C,L);for(const B in this._updatedSources){const U=this._updatedSources[B];U==="reload"?this._reloadSource(B):U==="clear"&&this._clearSource(B)}this._updateTilesForChangedImages();for(const B in this._updatedPaintProps)this._layers[B].updateTransitions(d);this.light.updateTransitions(d),this.fog&&this.fog.updateTransitions(d),this._resetUpdates()}const T={};for(const C in this._sourceCaches){const L=this._sourceCaches[C];T[C]=L.used,L.used=!1}for(const C of this._order){const L=this._layers[C];if(L.recalculate(d,this._availableImages),!L.isHidden(d.zoom)){const U=this._getLayerSourceCache(L);U&&(U.used=!0)}const B=this.map.painter;if(B){const U=L.getProgramIds();if(!U)continue;const q=L.getProgramConfiguration(d.zoom);for(const ie of U)B.useProgram(ie,q)}}for(const C in T){const L=this._sourceCaches[C];T[C]!==L.used&&L.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light.recalculate(d),this.terrain&&this.terrain.recalculate(d),this.fog&&this.fog.recalculate(d),this.z=d.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),v&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const d=Object.keys(this._changedImages);if(d.length){for(const v in this._sourceCaches)this._sourceCaches[v].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateWorkerLayers(d,v){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:v})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(d){if(this._checkLoaded(),es(this,l.validateStyle(d)))return!1;(d=l.clone$1(d)).layers=ea(d.layers);const v=function(C,L){if(!C)return[{command:ri.setStyle,args:[L]}];let B=[];try{if(!E(C.version,L.version))return[{command:ri.setStyle,args:[L]}];E(C.center,L.center)||B.push({command:ri.setCenter,args:[L.center]}),E(C.zoom,L.zoom)||B.push({command:ri.setZoom,args:[L.zoom]}),E(C.bearing,L.bearing)||B.push({command:ri.setBearing,args:[L.bearing]}),E(C.pitch,L.pitch)||B.push({command:ri.setPitch,args:[L.pitch]}),E(C.sprite,L.sprite)||B.push({command:ri.setSprite,args:[L.sprite]}),E(C.glyphs,L.glyphs)||B.push({command:ri.setGlyphs,args:[L.glyphs]}),E(C.transition,L.transition)||B.push({command:ri.setTransition,args:[L.transition]}),E(C.light,L.light)||B.push({command:ri.setLight,args:[L.light]}),E(C.fog,L.fog)||B.push({command:ri.setFog,args:[L.fog]}),E(C.projection,L.projection)||B.push({command:ri.setProjection,args:[L.projection]});const U={},q=[];(function(be,Re,je,He){let Ge;for(Ge in Re=Re||{},be=be||{})be.hasOwnProperty(Ge)&&(Re.hasOwnProperty(Ge)||zl(Ge,je,He));for(Ge in Re){if(!Re.hasOwnProperty(Ge))continue;const Xe=Re[Ge];be.hasOwnProperty(Ge)?E(be[Ge],Xe)||(be[Ge].type==="geojson"&&Xe.type==="geojson"&&Zs(be,Re,Ge)?je.push({command:ri.setGeoJSONSourceData,args:[Ge,Xe.data]}):tl(Ge,Re,je,He)):Ia(Ge,Re,je)}})(C.sources,L.sources,q,U);const ie=[];C.layers&&C.layers.forEach(be=>{be.source&&U[be.source]?B.push({command:ri.removeLayer,args:[be.id]}):ie.push(be)});let ne=C.terrain;ne&&U[ne.source]&&(B.push({command:ri.setTerrain,args:[void 0]}),ne=void 0),B=B.concat(q),E(ne,L.terrain)||B.push({command:ri.setTerrain,args:[L.terrain]}),function(be,Re,je){Re=Re||[];const He=(be=be||[]).map(bo),Ge=Re.map(bo),Xe=be.reduce(nl,{}),Ee=Re.reduce(nl,{}),Ue=He.slice(),it=Object.create(null);let lt,Ct,It,Mt,jt,Bt,Yt;for(lt=0,Ct=0;lt<He.length;lt++)It=He[lt],Ee.hasOwnProperty(It)?Ct++:(je.push({command:ri.removeLayer,args:[It]}),Ue.splice(Ue.indexOf(It,Ct),1));for(lt=0,Ct=0;lt<Ge.length;lt++)It=Ge[Ge.length-1-lt],Ue[Ue.length-1-lt]!==It&&(Xe.hasOwnProperty(It)?(je.push({command:ri.removeLayer,args:[It]}),Ue.splice(Ue.lastIndexOf(It,Ue.length-Ct),1)):Ct++,Bt=Ue[Ue.length-lt],je.push({command:ri.addLayer,args:[Ee[It],Bt]}),Ue.splice(Ue.length-lt,0,It),it[It]=!0);for(lt=0;lt<Ge.length;lt++)if(It=Ge[lt],Mt=Xe[It],jt=Ee[It],!it[It]&&!E(Mt,jt))if(E(Mt.source,jt.source)&&E(Mt["source-layer"],jt["source-layer"])&&E(Mt.type,jt.type)){for(Yt in ta(Mt.layout,jt.layout,je,It,null,ri.setLayoutProperty),ta(Mt.paint,jt.paint,je,It,null,ri.setPaintProperty),E(Mt.filter,jt.filter)||je.push({command:ri.setFilter,args:[It,jt.filter]}),E(Mt.minzoom,jt.minzoom)&&E(Mt.maxzoom,jt.maxzoom)||je.push({command:ri.setLayerZoomRange,args:[It,jt.minzoom,jt.maxzoom]}),Mt)Mt.hasOwnProperty(Yt)&&Yt!=="layout"&&Yt!=="paint"&&Yt!=="filter"&&Yt!=="metadata"&&Yt!=="minzoom"&&Yt!=="maxzoom"&&(Yt.indexOf("paint.")===0?ta(Mt[Yt],jt[Yt],je,It,Yt.slice(6),ri.setPaintProperty):E(Mt[Yt],jt[Yt])||je.push({command:ri.setLayerProperty,args:[It,Yt,jt[Yt]]}));for(Yt in jt)jt.hasOwnProperty(Yt)&&!Mt.hasOwnProperty(Yt)&&Yt!=="layout"&&Yt!=="paint"&&Yt!=="filter"&&Yt!=="metadata"&&Yt!=="minzoom"&&Yt!=="maxzoom"&&(Yt.indexOf("paint.")===0?ta(Mt[Yt],jt[Yt],je,It,Yt.slice(6),ri.setPaintProperty):E(Mt[Yt],jt[Yt])||je.push({command:ri.setLayerProperty,args:[It,Yt,jt[Yt]]}))}else je.push({command:ri.removeLayer,args:[It]}),Bt=Ue[Ue.lastIndexOf(It)+1],je.push({command:ri.addLayer,args:[jt,Bt]})}(ie,L.layers,B)}catch(U){console.warn("Unable to compute style diff:",U),B=[{command:ri.setStyle,args:[L]}]}return B}(this.serialize(),d).filter(C=>!(C.command in Do));if(v.length===0)return!1;const T=v.filter(C=>!(C.command in li));if(T.length>0)throw new Error(`Unimplemented: ${T.map(C=>C.command).join(", ")}.`);return v.forEach(C=>{C.command!=="setTransition"&&C.command!=="setProjection"&&this[C.command].apply(this,C.args)}),this.stylesheet=d,this._updateMapProjection(),!0}addImage(d,v){return this.getImage(d)?this.fire(new l.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(d,v),this._afterImageUpdated(d),this)}updateImage(d,v){this.imageManager.updateImage(d,v)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){return this.getImage(d)?(this.imageManager.removeImage(d),this._afterImageUpdated(d),this):this.fire(new l.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(d,v,T={}){if(this._checkLoaded(),this.getSource(d)!==void 0)throw new Error("There is already a source with this ID");if(!v.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(v).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(v.type)>=0&&this._validate(l.validateSource,`sources.${d}`,v,null,T))return;this.map&&this.map._collectResourceTiming&&(v.collectResourceTiming=!0);const C=Kr(d,v,this.dispatcher,this);C.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(d),source:C.serialize(),sourceId:d}));const L=B=>{const U=(B?"symbol:":"other:")+d,q=this._sourceCaches[U]=new l.SourceCache(U,C,B);(B?this._symbolSourceCaches:this._otherSourceCaches)[d]=q,q.style=this,q.onAdd(this.map)};L(!1),v.type!=="vector"&&v.type!=="geojson"||L(!0),C.onAdd&&C.onAdd(this.map),this._changed=!0}removeSource(d){this._checkLoaded();const v=this.getSource(d);if(!v)throw new Error("There is no source with this ID");for(const C in this._layers)if(this._layers[C].source===d)return this.fire(new l.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${C}" is using it.`)));if(this.terrain&&this.terrain.get().source===d)return this.fire(new l.ErrorEvent(new Error(`Source "${d}" cannot be removed while terrain is using it.`)));const T=this._getSourceCaches(d);for(const C of T)delete this._sourceCaches[C.id],delete this._updatedSources[C.id],C.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:C.getSource().id})),C.setEventedParent(null),C.clearTiles();return delete this._otherSourceCaches[d],delete this._symbolSourceCaches[d],v.setEventedParent(null),v.onRemove&&v.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(d,v){this._checkLoaded(),this.getSource(d).setData(v),this._changed=!0}getSource(d){const v=this._getSourceCache(d);return v&&v.getSource()}_getSources(){const d=[];for(const v in this._otherSourceCaches){const T=this._getSourceCache(v);T&&d.push(T.getSource())}return d}addLayer(d,v,T={}){this._checkLoaded();const C=d.id;if(this.getLayer(C))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${C}" already exists on this map`)));let L;if(d.type==="custom"){if(es(this,l.validateCustomStyleLayer(d)))return;L=l.createStyleLayer(d)}else{if(typeof d.source=="object"&&(this.addSource(C,d.source),d=l.clone$1(d),d=l.extend(d,{source:C})),this._validate(l.validateLayer,`layers.${C}`,d,{arrayIndex:-1},T))return;L=l.createStyleLayer(d),this._validateLayer(L),L.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[L.id]=L.serialize(),this._updateLayerCount(L,!0)}const B=v?this._order.indexOf(v):this._order.length;if(v&&B===-1)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${v}" does not exist on this map.`)));this._order.splice(B,0,C),this._layerOrderChanged=!0,this._layers[C]=L;const U=this._getLayerSourceCache(L);if(this._removedLayers[C]&&L.source&&U&&L.type!=="custom"){const q=this._removedLayers[C];delete this._removedLayers[C],q.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",U.pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(d,v){if(this._checkLoaded(),this._changed=!0,!this._layers[d])return void this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)));if(d===v)return;const T=this._order.indexOf(d);this._order.splice(T,1);const C=v?this._order.indexOf(v):this._order.length;v&&C===-1?this.fire(new l.ErrorEvent(new Error(`Layer with id "${v}" does not exist on this map.`))):(this._order.splice(C,0,d),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(d){this._checkLoaded();const v=this._layers[d];if(!v)return void this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be removed.`)));v.setEventedParent(null),this._updateLayerCount(v,!1);const T=this._order.indexOf(d);this._order.splice(T,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=v,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],v.onRemove&&v.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(d){return this._layers[d]}hasLayer(d){return d in this._layers}hasLayerType(d){for(const v in this._layers)if(this._layers[v].type===d)return!0;return!1}setLayerZoomRange(d,v,T){this._checkLoaded();const C=this.getLayer(d);C?C.minzoom===v&&C.maxzoom===T||(v!=null&&(C.minzoom=v),T!=null&&(C.maxzoom=T),this._updateLayer(C)):this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(d,v,T={}){this._checkLoaded();const C=this.getLayer(d);if(C){if(!E(C.filter,v))return v==null?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(l.validateFilter,`layers.${C.id}.filter`,v,{layerType:C.type},T)||(C.filter=l.clone$1(v),this._updateLayer(C)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be filtered.`)))}getFilter(d){const v=this.getLayer(d);return v&&l.clone$1(v.filter)}setLayoutProperty(d,v,T,C={}){this._checkLoaded();const L=this.getLayer(d);L?E(L.getLayoutProperty(v),T)||(L.setLayoutProperty(v,T,C),this._updateLayer(L)):this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(d,v){const T=this.getLayer(d);if(T)return T.getLayoutProperty(v);this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style.`)))}setPaintProperty(d,v,T,C={}){this._checkLoaded();const L=this.getLayer(d);L?E(L.getPaintProperty(v),T)||(L.setPaintProperty(v,T,C)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(d,v){const T=this.getLayer(d);return T&&T.getPaintProperty(v)}setFeatureState(d,v){this._checkLoaded();const T=d.source,C=d.sourceLayer,L=this.getSource(T);if(!L)return void this.fire(new l.ErrorEvent(new Error(`The source '${T}' does not exist in the map's style.`)));const B=L.type;if(B==="geojson"&&C)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(B==="vector"&&!C)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));d.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const U=this._getSourceCaches(T);for(const q of U)q.setFeatureState(C,d.id,v)}removeFeatureState(d,v){this._checkLoaded();const T=d.source,C=this.getSource(T);if(!C)return void this.fire(new l.ErrorEvent(new Error(`The source '${T}' does not exist in the map's style.`)));const L=C.type,B=L==="vector"?d.sourceLayer:void 0;if(L==="vector"&&!B)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(v&&typeof d.id!="string"&&typeof d.id!="number")return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const U=this._getSourceCaches(T);for(const q of U)q.removeFeatureState(B,d.id,v)}getFeatureState(d){this._checkLoaded();const v=d.source,T=d.sourceLayer,C=this.getSource(v);if(C){if(C.type!=="vector"||T)return d.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(v)[0].getFeatureState(T,d.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const d={};for(const v in this._sourceCaches){const T=this._sourceCaches[v].getSource();d[T.id]||(d[T.id]=T.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:d,layers:this._serializeLayers(this._order)},v=>v!==void 0)}_updateLayer(d){this._updatedLayers[d.id]=!0;const v=this._getLayerSourceCache(d);d.source&&!this._updatedSources[d.source]&&v&&v.getSource().type!=="raster"&&(this._updatedSources[d.source]="reload",v.pause()),this._changed=!0,d.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(d){const v=B=>this._layers[B].type==="fill-extrusion",T={},C=[];for(let B=this._order.length-1;B>=0;B--){const U=this._order[B];if(v(U)){T[U]=B;for(const q of d){const ie=q[U];if(ie)for(const ne of ie)C.push(ne)}}}C.sort((B,U)=>U.intersectionZ-B.intersectionZ);const L=[];for(let B=this._order.length-1;B>=0;B--){const U=this._order[B];if(v(U))for(let q=C.length-1;q>=0;q--){const ie=C[q].feature;if(T[ie.layer.id]<B)break;L.push(ie),C.pop()}else for(const q of d){const ie=q[U];if(ie)for(const ne of ie)L.push(ne.feature)}}return L}queryRenderedFeatures(d,v,T){v&&v.filter&&this._validate(l.validateFilter,"queryRenderedFeatures.filter",v.filter,null,v);const C={};if(v&&v.layers){if(!Array.isArray(v.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const q of v.layers){const ie=this._layers[q];if(!ie)return this.fire(new l.ErrorEvent(new Error(`The layer '${q}' does not exist in the map's style and cannot be queried for features.`))),[];C[ie.source]=!0}}const L=[];v.availableImages=this._availableImages;const B=v&&v.layers?v.layers.some(q=>{const ie=this.getLayer(q);return ie&&ie.is3D()}):this.has3DLayers(),U=Ut.createFromScreenPoints(d,T);for(const q in this._sourceCaches){const ie=this._sourceCaches[q].getSource().id;v.layers&&!C[ie]||L.push(Xi(this._sourceCaches[q],this._layers,this._serializedLayers,U,v,T,B,!!this.map._showQueryGeometry))}return this.placement&&L.push(function(q,ie,ne,be,Re,je,He){const Ge={},Xe=je.queryRenderedSymbols(be),Ee=[];for(const Ue of Object.keys(Xe).map(Number))Ee.push(He[Ue]);Ee.sort(Zi);for(const Ue of Ee){const it=Ue.featureIndex.lookupSymbolFeatures(Xe[Ue.bucketInstanceId],ie,Ue.bucketIndex,Ue.sourceLayerIndex,Re.filter,Re.layers,Re.availableImages,q);for(const lt in it){const Ct=Ge[lt]=Ge[lt]||[],It=it[lt];It.sort((Mt,jt)=>{const Bt=Ue.featureSortOrder;if(Bt){const Yt=Bt.indexOf(Mt.featureIndex);return Bt.indexOf(jt.featureIndex)-Yt}return jt.featureIndex-Mt.featureIndex});for(const Mt of It)Ct.push(Mt)}}for(const Ue in Ge)Ge[Ue].forEach(it=>{const lt=it.feature,Ct=ne(q[Ue]);if(!Ct)return;const It=Ct.getFeatureState(lt.layer["source-layer"],lt.id);lt.source=lt.layer.source,lt.layer["source-layer"]&&(lt.sourceLayer=lt.layer["source-layer"]),lt.state=It});return Ge}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),U.screenGeometry,v,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(L)}querySourceFeatures(d,v){v&&v.filter&&this._validate(l.validateFilter,"querySourceFeatures.filter",v.filter,null,v);const T=this._getSourceCaches(d);let C=[];for(const L of T)C=C.concat(Hi(L,v));return C}addSourceType(d,v,T){return jo.getSourceType(d)?T(new Error(`A source type called "${d}" already exists.`)):(jo.setSourceType(d,v),v.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:v.workerSourceURL},T):T(null,null))}getLight(){return this.light.getLight()}setLight(d,v={}){this._checkLoaded();const T=this.light.getLight();let C=!1;for(const B in d)if(!E(d[B],T[B])){C=!0;break}if(!C)return;const L=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(d,v),this.light.updateTransitions(L)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(d,v=1){if(this._checkLoaded(),!d)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let T=d;if(v===1){if(typeof T.source=="object"){const C="terrain-dem-src";this.addSource(C,T.source),T=l.clone$1(T),T=l.extend(T,{source:C})}if(this._validate(l.validateTerrain,"terrain",T))return}if(!this.terrain||this.terrain&&v!==this.terrain.drapeRenderMode){if(!T)return;this._createTerrain(T,v)}else{const C=this.terrain,L=C.get();for(const B of Object.keys(l.spec.terrain))!T.hasOwnProperty(B)&&l.spec.terrain[B].default&&(T[B]=l.spec.terrain[B].default);for(const B in T)if(!E(T[B],L[B])){C.set(T),this.stylesheet.terrain=T;const U=this._setTransitionParameters({duration:0});C.updateTransitions(U);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(d){const v=this.fog=new tt(d,this.map.transform);this.stylesheet.fog=d;const T=this._setTransitionParameters({duration:0});v.updateTransitions(T)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const d of this.map._markers)d._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(d){if(this._checkLoaded(),!d)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const v=this.fog,T=v.get();Object.keys(d).length===0&&v.set(d);for(const C in d)if(!E(d[C],T[C])){v.set(d),this.stylesheet.fog=d;const L=this._setTransitionParameters({duration:0});v.updateTransitions(L);break}}else this._createFog(d);this._markersNeedUpdate=!0}_setTransitionParameters(d){return{now:l.exported.now(),transition:l.extend(d,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const d=this._order.filter(T=>this.isLayerDraped(this._layers[T])),v=this._order.filter(T=>!this.isLayerDraped(this._layers[T]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...d),this._drapedFirstOrder.push(...v)}_createTerrain(d,v){const T=this.terrain=new ye(d,v);this.stylesheet.terrain=d,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const C=this._setTransitionParameters({duration:0});T.updateTransitions(C)}_force3DLayerUpdate(){for(const d in this._layers){const v=this._layers[d];v.type==="fill-extrusion"&&this._updateLayer(v)}}_forceSymbolLayerUpdate(){for(const d in this._layers){const v=this._layers[d];v.type==="symbol"&&this._updateLayer(v)}}_validate(d,v,T,C,L={}){return(!L||L.validate!==!1)&&es(this,d.call(l.validateStyle,l.extend({key:v,style:this.serialize(),value:T,styleSpec:l.spec},C)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this._sourceCaches)this._sourceCaches[d].clearTiles(),this._sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(d){const v=this._getSourceCaches(d);for(const T of v)T.clearTiles()}_reloadSource(d){const v=this._getSourceCaches(d);for(const T of v)T.resume(),T.reload()}_reloadSources(){for(const d of this._getSources())d.reload&&d.reload()}_updateSources(d){for(const v in this._sourceCaches)this._sourceCaches[v].update(d)}_generateCollisionBoxes(){for(const d in this._sourceCaches){const v=this._sourceCaches[d];v.resume(),v.reload()}}_updatePlacement(d,v,T,C,L=!1){let B=!1,U=!1;const q={};for(const ie of this._order){const ne=this._layers[ie];if(ne.type!=="symbol")continue;if(!q[ne.source]){const Re=this._getLayerSourceCache(ne);if(!Re)continue;q[ne.source]=Re.getRenderableIds(!0).map(je=>Re.getTileByID(je)).sort((je,He)=>He.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(He.tileID)?-1:1))}const be=this.crossTileSymbolIndex.addLayer(ne,q[ne.source],d.center.lng,d.projection);B=B||be}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),L=L||this._layerOrderChanged||T===0,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),d.zoom))&&(this.pauseablePlacement=new $r(d,this._order,L,v,T,C,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),U=!0),B&&this.pauseablePlacement.placement.setStale()),U||B)for(const ie of this._order){const ne=this._layers[ie];ne.type==="symbol"&&this.placement.updateLayerOpacities(ne,q[ne.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const d in this._sourceCaches)this._sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,v,T){this.imageManager.getImages(v.icons,T),this._updateTilesForChangedImages();const C=L=>{L&&L.setDependencies(v.tileID.key,v.type,v.icons)};C(this._otherSourceCaches[v.source]),C(this._symbolSourceCaches[v.source])}getGlyphs(d,v,T){this.glyphManager.getGlyphs(v.stacks,T)}getResource(d,v,T){return l.makeRequest(v,T)}_getSourceCache(d){return this._otherSourceCaches[d]}_getLayerSourceCache(d){return d.type==="symbol"?this._symbolSourceCaches[d.source]:this._otherSourceCaches[d.source]}_getSourceCaches(d){const v=[];return this._otherSourceCaches[d]&&v.push(this._otherSourceCaches[d]),this._symbolSourceCaches[d]&&v.push(this._symbolSourceCaches[d]),v}_isSourceCacheLoaded(d){const v=this._getSourceCaches(d);return v.length===0?(this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${d}'`))),!1):v.every(T=>T.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}jo.getSourceType=function(b){return zr[b]},jo.setSourceType=function(b,d){zr[b]=d},jo.registerForPluginStateChange=l.registerForPluginStateChange;var Xa=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Za="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Oo=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,na=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Gs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let jc={},Pr={};const vu=[];il(Xa,vu),il(Oo,vu),il(na,vu),il(Gs,vu),jc=hs("",Oo),Pr=hs(Gs,na);const Mp=hs(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),gf=Xa,dc=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var yf={background:hs(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:hs(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:hs(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:hs("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hs(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:hs(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hs("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:hs("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:hs("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:hs(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:hs(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:hs(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:hs(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:hs(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:hs(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:hs(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hs(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:hs(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:hs(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:hs(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:hs(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:hs(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:hs(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:hs(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:hs(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hs(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Za),skyboxGradient:hs(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Za),skyboxCapture:hs(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hs(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:hs(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function il(b,d){const v=b.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let T of v)if(T=T.trim(),T[0]==="#"&&T.includes("if")&&!T.includes("endif")){T=T.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const C=T.split(" ");for(const L of C)d.includes(L)||d.push(L)}}function hs(b,d){const v=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,T=d.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),C={},L=[...vu];return il(b,L),il(d,L),{fragmentSource:b=b.replace(v,(B,U,q,ie,ne)=>(C[ne]=!0,U==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
varying ${q} ${ie} ${ne};
#else
uniform ${q} ${ie} u_${ne};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ne}
    ${q} ${ie} ${ne} = u_${ne};
#endif
`)),vertexSource:d=d.replace(v,(B,U,q,ie,ne)=>{const be=ie==="float"?"vec2":"vec4",Re=ne.match(/color/)?"color":be;return C[ne]?U==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
attribute ${q} ${be} a_${ne};
varying ${q} ${ie} ${ne};
#else
uniform ${q} ${ie} u_${ne};
#endif
`:Re==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = a_${ne};
#else
    ${q} ${ie} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = unpack_mix_${Re}(a_${ne}, u_${ne}_t);
#else
    ${q} ${ie} ${ne} = u_${ne};
#endif
`:U==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
attribute ${q} ${be} a_${ne};
#else
uniform ${q} ${ie} u_${ne};
#endif
`:Re==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${q} ${ie} ${ne} = a_${ne};
#else
    ${q} ${ie} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${q} ${ie} ${ne} = unpack_mix_${Re}(a_${ne}, u_${ne}_t);
#else
    ${q} ${ie} ${ne} = u_${ne};
#endif
`}),staticAttributes:T,usedDefines:L}}class kp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(d,v,T,C,L,B,U){this.context=d;let q=this.boundPaintVertexBuffers.length!==C.length;for(let ne=0;!q&&ne<C.length;ne++)this.boundPaintVertexBuffers[ne]!==C[ne]&&(q=!0);let ie=this.boundDynamicVertexBuffers.length!==U.length;for(let ne=0;!ie&&ne<U.length;ne++)this.boundDynamicVertexBuffers[ne]!==U[ne]&&(ie=!0);if(!d.extVertexArrayObject||!this.vao||this.boundProgram!==v||this.boundLayoutVertexBuffer!==T||q||ie||this.boundIndexBuffer!==L||this.boundVertexOffset!==B)this.freshBind(v,T,C,L,B,U);else{d.bindVertexArrayOES.set(this.vao);for(const ne of U)ne&&ne.bind();L&&L.dynamicDraw&&L.bind()}}freshBind(d,v,T,C,L,B){let U;const q=d.numAttributes,ie=this.context,ne=ie.gl;if(ie.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ie.extVertexArrayObject.createVertexArrayOES(),ie.bindVertexArrayOES.set(this.vao),U=0,this.boundProgram=d,this.boundLayoutVertexBuffer=v,this.boundPaintVertexBuffers=T,this.boundIndexBuffer=C,this.boundVertexOffset=L,this.boundDynamicVertexBuffers=B;else{U=ie.currentNumAttributes||0;for(let be=q;be<U;be++)ne.disableVertexAttribArray(be)}v.enableAttributes(ne,d),v.bind(),v.setVertexAttribPointers(ne,d,L);for(const be of T)be.enableAttributes(ne,d),be.bind(),be.setVertexAttribPointers(ne,d,L);for(const be of B)be&&(be.enableAttributes(ne,d),be.bind(),be.setVertexAttribPointers(ne,d,L));C&&C.bind(),ie.currentNumAttributes=q}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Bl(b,d){const v=Math.pow(2,d.canonical.z),T=d.canonical.y;return[new l.MercatorCoordinate(0,T/v).toLngLat().lat,new l.MercatorCoordinate(0,(T+1)/v).toLngLat().lat]}function Cp(b,d,v,T,C,L,B){const U=b.context,q=U.gl,ie=v.fbo;if(!ie)return;b.prepareDrawTile();const ne=b.useProgram("hillshade");U.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,ie.colorAttachment.get());const be=((Ge,Xe,Ee,Ue)=>{const it=Ee.paint.get("hillshade-shadow-color"),lt=Ee.paint.get("hillshade-highlight-color"),Ct=Ee.paint.get("hillshade-accent-color");let It=Ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(It-=Ge.transform.angle);const Mt=!Ge.options.moving;return{u_matrix:Ue||Ge.transform.calculateProjMatrix(Xe.tileID.toUnwrapped(),Mt),u_image:0,u_latrange:Bl(0,Xe.tileID),u_light:[Ee.paint.get("hillshade-exaggeration"),It],u_shadow:it,u_highlight:lt,u_accent:Ct}})(b,v,T,b.terrain?d.projMatrix:null);b.prepareDrawProgram(U,ne,d.toUnwrapped());const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:je,tileBoundsSegments:He}=b.getTileBoundsBuffers(v);ne.draw(U,q.TRIANGLES,C,L,B,l.CullFaceMode.disabled,be,T.id,Re,je,He)}function ma(b,d,v){if(!d.needsDEMTextureUpload)return;const T=b.context,C=T.gl;T.pixelStoreUnpackPremultiplyAlpha.set(!1),d.demTexture=d.demTexture||b.getTileTexture(v.stride);const L=v.getPixels();d.demTexture?d.demTexture.update(L,{premultiply:!1}):d.demTexture=new l.Texture(T,L,C.RGBA,{premultiply:!1}),d.needsDEMTextureUpload=!1}function bi(b,d,v,T,C,L){const B=b.context,U=B.gl;if(!d.dem)return;const q=d.dem;if(B.activeTexture.set(U.TEXTURE1),ma(b,d,q),!d.demTexture)return;d.demTexture.bind(U.NEAREST,U.CLAMP_TO_EDGE);const ie=q.dim;B.activeTexture.set(U.TEXTURE0);let ne=d.fbo;if(!ne){const He=new l.Texture(B,{width:ie,height:ie,data:null},U.RGBA);He.bind(U.LINEAR,U.CLAMP_TO_EDGE),ne=d.fbo=B.createFramebuffer(ie,ie,!0),ne.colorAttachment.set(He.texture)}B.bindFramebuffer.set(ne.framebuffer),B.viewport.set([0,0,ie,ie]);const{tileBoundsBuffer:be,tileBoundsIndexBuffer:Re,tileBoundsSegments:je}=b.getMercatorTileBoundsBuffers();b.useProgram("hillshadePrepare").draw(B,U.TRIANGLES,T,C,L,l.CullFaceMode.disabled,((He,Ge)=>{const Xe=Ge.stride,Ee=l.create();return l.ortho(Ee,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(Ee,Ee,[0,-l.EXTENT,0]),{u_matrix:Ee,u_image:1,u_dimension:[Xe,Xe],u_zoom:He.overscaledZ,u_unpack:Ge.unpackVector}})(d.tileID,q),v.id,be,Re,je),d.needsHillshadePrepare=!1}const l0=b=>({u_matrix:new l.UniformMatrix4f(b),u_image0:new l.Uniform1i(b),u_skirt_height:new l.Uniform1f(b)}),fc=(b,d)=>({u_matrix:b,u_image0:0,u_skirt_height:d}),Ip=(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He)=>({u_proj_matrix:Float32Array.from(b),u_globe_matrix:d,u_normalize_matrix:Float32Array.from(T),u_merc_matrix:v,u_zoom_transition:C,u_merc_center:L,u_image0:0,u_frustum_tl:B,u_frustum_tr:U,u_frustum_br:q,u_frustum_bl:ie,u_globe_pos:ne,u_globe_radius:be,u_viewport:Re,u_grid_matrix:He?Float32Array.from(He):new Float32Array(9),u_skirt_height:je});function xu(b,d){return b!=null&&d!=null&&!(!b.hasData()||!d.hasData())&&b.demTexture!=null&&d.demTexture!=null&&b.tileID.key!==d.tileID.key}const vl=new class{constructor(){this.operations={}}newMorphing(b,d,v,T,C){if(b in this.operations){const L=this.operations[b];L.to.tileID.key!==v.tileID.key&&(L.queued=v)}else this.operations[b]={startTime:T,phase:0,duration:C,from:d,to:v,queued:null}}getMorphValuesForProxy(b){if(!(b in this.operations))return null;const d=this.operations[b];return{from:d.from,to:d.to,phase:d.phase}}update(b){for(const d in this.operations){const v=this.operations[d];for(v.phase=(b-v.startTime)/v.duration;v.phase>=1||!this._validOp(v);)if(!this._nextOp(v,b)){delete this.operations[d];break}}}_nextOp(b,d){return!!b.queued&&(b.from=b.to,b.to=b.queued,b.queued=null,b.phase=0,b.startTime=d,!0)}_validOp(b){return b.from.hasData()&&b.to.hasData()}},tu={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ap(b){return 6*Math.pow(1.5,22-b)}function u0(b,d){const v=1<<b.z;return!d&&(b.x===0||b.x===v-1)||b.y===0||b.y===v-1}const _f=b=>({u_matrix:b});function Lp(b,d,v,T,C){if(C>0){const L=l.exported.now(),B=(L-b.timeAdded)/C,U=d?(L-d.timeAdded)/C:-1,q=v.getSource(),ie=T.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),ne=!d||Math.abs(d.tileID.overscaledZ-ie)>Math.abs(b.tileID.overscaledZ-ie),be=ne&&b.refreshedUponExpiration?1:l.clamp(ne?B:1-U,0,1);return b.refreshedUponExpiration&&B>=1&&(b.refreshedUponExpiration=!1),d?{opacity:1,mix:1-be}:{opacity:be,mix:0}}return{opacity:1,mix:0}}class Pp extends l.SourceCache{constructor(d){const v={type:"raster-dem",maxzoom:d.transform.maxZoom},T=new Je(No(),null),C=Kr("mock-dem",v,T,d.style);super("mock-dem",C,!1),C.setEventedParent(this),this._sourceLoaded=!0}_loadTile(d,v){d.state="loaded",v(null)}}class vf extends l.SourceCache{constructor(d){const v=Kr("proxy",{type:"geojson",maxzoom:d.transform.maxZoom},new Je(No(),null),d.style);super("proxy",v,!1),v.setEventedParent(this),this.map=this.getSource().map=d,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(d,v,T){if(d.freezeTileCoverage)return;this.transform=d;const C=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((L,B)=>{if(L[B.key]="",!this._tiles[B.key]){const U=new l.Tile(B,this._source.tileSize*B.overscaleFactor(),d.tileZoom);U.state="loaded",this._tiles[B.key]=U}return L},{});for(const L in this._tiles)L in C||(this.freeFBO(L),this._tiles[L].unloadVectorData(),delete this._tiles[L])}freeFBO(d){const v=this.proxyCachedFBO[d];if(v!==void 0){const T=Object.values(v);this.renderCachePool.push(...T),delete this.proxyCachedFBO[d]}}deallocRenderCache(){this.renderCache.forEach(d=>d.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class xf extends l.OverscaledTileID{constructor(d,v,T){super(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y),this.proxyTileKey=v,this.projMatrix=T}}class Rp extends l.Elevation{constructor(d,v){super(),this.painter=d,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[T,C,L]=function(q){const ie=new l.StructArrayLayout2i4,ne=new l.StructArrayLayout3ui6,be=131;ie.reserve(17161),ne.reserve(33800);const Re=l.EXTENT/128,je=l.EXTENT+Re/2,He=je+Re;for(let Xe=-Re;Xe<He;Xe+=Re)for(let Ee=-Re;Ee<He;Ee+=Re){const Ue=Ee<0||Ee>je||Xe<0||Xe>je?24575:0,it=l.clamp(Math.round(Ee),0,l.EXTENT),lt=l.clamp(Math.round(Xe),0,l.EXTENT);ie.emplaceBack(it+Ue,lt)}const Ge=(Xe,Ee)=>{const Ue=Ee*be+Xe;ne.emplaceBack(Ue+1,Ue,Ue+be),ne.emplaceBack(Ue+be,Ue+be+1,Ue+1)};for(let Xe=1;Xe<129;Xe++)for(let Ee=1;Ee<129;Ee++)Ge(Ee,Xe);return[0,129].forEach(Xe=>{for(let Ee=0;Ee<130;Ee++)Ge(Ee,Xe),Ge(Xe,Ee)}),[ie,ne,32768]}(),B=d.context;this.gridBuffer=B.createVertexBuffer(T,l.posAttributes.members),this.gridIndexBuffer=B.createIndexBuffer(C),this.gridSegments=l.SegmentVector.simpleSegment(0,0,T.length,C.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,T.length,L),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new vf(v.map),this.orthoMatrix=l.create(),l.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,l.EXTENT,0,l.EXTENT,0,1);const U=B.gl;this._overlapStencilMode=new l.StencilMode({func:U.GEQUAL,mask:255},0,255,U.KEEP,U.KEEP,U.REPLACE),this._previousZoom=d.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=v,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Pp(v.map)}set style(d){d.on("data",this._onStyleDataEvent.bind(this)),d.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=d,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(d,v,T){if(d&&d.terrain){this._style!==d&&(this.style=d),this.enabled=!0;const C=d.terrain.properties;this.sourceCache=d.terrain.drapeRenderMode===0?this._mockSourceCache:d._getSourceCache(C.get("source")),this._exaggeration=C.get("exaggeration");const L=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const B=this.getScaledDemTileSize();this.sourceCache.update(v,B,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,L(),this._initializing=!0),L(),v.updateElevation(!0,T),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(v),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(d){this._findCoveringTileCache[d]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const d=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||d.efficiency!==100&&l.warnOnce(`Terrain render cache efficiency is not optimal (${d.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${d.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(d){d.coord&&d.dataType==="source"?this._clearRenderCacheForTile(d.sourceCacheId,d.coord):d.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const d in this._style._sourceCaches)this._style._sourceCaches[d].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(d=>d.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const d=2*this.proxySourceCache.getSource().tileSize;return[d,d]}set useVertexMorphing(d){this._useVertexMorphing=d}updateTileBinding(d){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const v=this.proxySourceCache,T=this.painter.transform;this._initializing&&(this._initializing=T._centerAltitude===0&&this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(T.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const C=this.proxyCoords=v.getIds().map(q=>{const ie=v.getTileByID(q).tileID;return ie.projMatrix=T.calculateProjMatrix(ie.toUnwrapped()),ie});(function(q,ie){const ne=ie.transform.pointCoordinate(ie.transform.getCameraPoint()),be=new l.Point(ne.x,ne.y);q.sort((Re,je)=>{if(je.overscaledZ-Re.overscaledZ)return je.overscaledZ-Re.overscaledZ;const He=new l.Point(Re.canonical.x+(1<<Re.canonical.z)*Re.wrap,Re.canonical.y),Ge=new l.Point(je.canonical.x+(1<<je.canonical.z)*je.wrap,je.canonical.y),Xe=be.mult(1<<Re.canonical.z);return Xe.x-=.5,Xe.y-=.5,Xe.distSqr(He)-Xe.distSqr(Ge)})})(C,this.painter),this._previousZoom=T.zoom;const L=this.proxyToSource||{};this.proxyToSource={},C.forEach(q=>{this.proxyToSource[q.key]={}}),this.terrainTileForTile={};const B=this._style._sourceCaches;for(const q in B){const ie=B[q];if(!ie.used||(ie!==this.sourceCache&&this.resetTileLookupCache(ie.id),this._setupProxiedCoordsForOrtho(ie,d[q],L),ie.usedForTerrain))continue;const ne=d[q];ie.getSource().reparseOverscaled&&this._assignTerrainTiles(ne)}this.proxiedCoords[v.id]=C.map(q=>new xf(q,q.key,this.orthoMatrix)),this._assignTerrainTiles(C),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(L),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const U={};this._visibleDemTiles=[];for(const q of this.proxyCoords){const ie=this.terrainTileForTile[q.key];if(!ie)continue;const ne=ie.tileID.key;ne in U||(this._visibleDemTiles.push(ie),U[ne]=ne)}}_assignTerrainTiles(d){this._initializing||d.forEach(v=>{if(this.terrainTileForTile[v.key])return;const T=this._findTileCoveringTileID(v,this.sourceCache);T&&(this.terrainTileForTile[v.key]=T)})}_prepareDEMTextures(){const d=this.painter.context,v=d.gl;for(const T in this.terrainTileForTile){const C=this.terrainTileForTile[T],L=C.dem;!L||C.demTexture&&!C.needsDEMTextureUpload||(d.activeTexture.set(v.TEXTURE1),ma(this.painter,C,L))}}_prepareDemTileUniforms(d,v,T,C){if(!v||v.demTexture==null)return!1;const L=d.tileID.canonical,B=Math.pow(2,v.tileID.canonical.z-L.z),U=C||"";return T[`u_dem_tl${U}`]=[L.x*B%1,L.y*B%1],T[`u_dem_scale${U}`]=B,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const d=this.painter.context,v=d.gl;if(!this._emptyDepthBufferTexture){const T=new l.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new l.Texture(d,T,v.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let d=0;const v=this._visibleDemTiles.reduce((T,C)=>{if(!C.dem)return T;const L=C.dem.tree.minimums[0];return L>0&&d++,T+L},0);return d?v/d:0}_updateEmptyDEMTexture(){const d=this.painter.context,v=d.gl;d.activeTexture.set(v.TEXTURE2);const T=this._getLoadedAreaMinimum(),C=new l.RGBAImage({width:1,height:1},new Uint8Array(l.DEMData.pack(T,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let L=this._emptyDEMTexture;return L?L.update(C,{premultiply:!1}):L=this._emptyDEMTexture=new l.Texture(d,C,v.RGBA,{premultiply:!1}),L}setupElevationDraw(d,v,T){const C=this.painter.context,L=C.gl,B=(U=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(U),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var U;B.u_dem_size=this.sourceCache.getSource().tileSize,B.u_exaggeration=this.exaggeration();let q=null,ie=null,ne=1;if(T&&T.morphing&&this._useVertexMorphing){const be=T.morphing.srcDemTile,Re=T.morphing.dstDemTile;ne=T.morphing.phase,be&&Re&&(this._prepareDemTileUniforms(d,be,B,"_prev")&&(ie=be),this._prepareDemTileUniforms(d,Re,B)&&(q=Re))}if(ie&&q?(C.activeTexture.set(L.TEXTURE2),q.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE,L.NEAREST),C.activeTexture.set(L.TEXTURE4),ie.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE,L.NEAREST),B.u_dem_lerp=ne):(q=this.terrainTileForTile[d.tileID.key],C.activeTexture.set(L.TEXTURE2),(this._prepareDemTileUniforms(d,q,B)?q.demTexture:this.emptyDEMTexture).bind(L.NEAREST,L.CLAMP_TO_EDGE)),C.activeTexture.set(L.TEXTURE3),T&&T.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE),this._depthFBO&&(B.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE),B.u_depth_size_inv=[1,1]),T&&T.useMeterToDem&&q){const be=(1<<q.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;B.u_meter_to_dem=be}if(T&&T.labelPlaneMatrixInv&&(B.u_label_plane_matrix_inv=T.labelPlaneMatrixInv),v.setTerrainUniformValues(C,B),this.painter.transform.projection.name==="globe"){const be=this.globeUniformValues(this.painter.transform,d.tileID.canonical,T&&T.useDenormalizedUpVectorScale);v.setGlobeUniformValues(C,be)}}globeUniformValues(d,v,T){const C=d.projection;return{u_tile_tl_up:C.upVector(v,0,0),u_tile_tr_up:C.upVector(v,l.EXTENT,0),u_tile_br_up:C.upVector(v,l.EXTENT,l.EXTENT),u_tile_bl_up:C.upVector(v,0,l.EXTENT),u_tile_up_scale:T?l.globeMetersToEcef(1):C.upVectorScale(v,d.center.lat,d.worldSize).metersToTile}}renderToBackBuffer(d){const v=this.painter,T=this.painter.context;d.length!==0&&(T.bindFramebuffer.set(null),T.viewport.set([0,0,v.width,v.height]),v.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(C,L,B,U,q){if(C.transform.projection.name==="globe")(function(ie,ne,be,Re,je){const He=ie.context,Ge=He.gl;let Xe,Ee;const Ue=ie.options.showTerrainWireframe?2:0,it=ie.transform,lt=l.globeUseCustomAntiAliasing(ie,He,it),Ct=(Gn,$t)=>{if(Ee===Gn)return;const vn=[tu[Gn],"PROJECTION_GLOBE_VIEW"];lt&&vn.push("CUSTOM_ANTIALIASING"),$t&&vn.push(tu[Ue]),Xe=ie.useProgram("globeRaster",null,vn),Ee=Gn},It=ie.colorModeForRenderPass(),Mt=new l.DepthMode(Ge.LEQUAL,l.DepthMode.ReadWrite,ie.depthRangeFor3D);vl.update(je);const jt=l.calculateGlobeMercatorMatrix(it),Bt=[l.mercatorXfromLng(it.center.lng),l.mercatorYfromLat(it.center.lat)],Yt=Ue?[!1,!0]:[!1],Zn=ie.globeSharedBuffers,zt=[it.width*l.exported.devicePixelRatio,it.height*l.exported.devicePixelRatio],wn=Float32Array.from(it.globeMatrix),Qt={useDenormalizedUpVectorScale:!0};if(Yt.forEach(Gn=>{const $t=ie.transform,vn=Ap($t.zoom)*ne.exaggeration();Ee=-1;const Tn=Gn?Ge.LINES:Ge.TRIANGLES;for(const kn of Re){const Yn=be.getTile(kn),Ur=l.StencilMode.disabled,ui=ne.prevTerrainTileForTile[kn.key],Mr=ne.terrainTileForTile[kn.key];xu(ui,Mr)&&vl.newMorphing(kn.key,ui,Mr,je,250),He.activeTexture.set(Ge.TEXTURE0),Yn.texture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE);const Xr=vl.getMorphValuesForProxy(kn.key),ki=Xr?1:0;Xr&&l.extend$1(Qt,{morphing:{srcDemTile:Xr.from,dstDemTile:Xr.to,phase:l.easeCubicInOut(Xr.phase)}});const Ci=l.tileCornersToBounds(kn.canonical),Hr=l.getLatitudinalLod(Ci.getCenter().lat),fs=l.getGridMatrix(kn.canonical,Ci,Hr,$t.worldSize/$t._pixelsPerMercatorPixel),bs=l.globeNormalizeECEF(l.globeTileBounds(kn.canonical)),Ts=Ip($t.projMatrix,wn,jt,bs,l.globeToMercatorTransition($t.zoom),Bt,$t.frustumCorners.TL,$t.frustumCorners.TR,$t.frustumCorners.BR,$t.frustumCorners.BL,$t.globeCenterInViewSpace,$t.globeRadius,zt,vn,fs);if(Ct(ki,Gn),ne.setupElevationDraw(Yn,Xe,Qt),ie.prepareDrawProgram(He,Xe,kn.toUnwrapped()),Zn){const[Os,Ya,Ra]=Gn?Zn.getWirefameBuffers(ie.context,Hr):Zn.getGridBuffers(Hr,vn!==0);Xe.draw(He,Tn,Mt,Ur,It,l.CullFaceMode.backCCW,Ts,"globe_raster",Os,Ya,Ra)}}}),Zn){const Gn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];lt&&Gn.push("CUSTOM_ANTIALIASING"),Xe=ie.useProgram("globeRaster",null,Gn);for(const $t of Re){const{x:vn,y:Tn,z:kn}=$t.canonical,Yn=Tn===0,Ur=Tn===(1<<kn)-1,[ui,Mr,Xr,ki]=Zn.getPoleBuffers(kn);if(ki&&(Yn||Ur)){const Ci=be.getTile($t);He.activeTexture.set(Ge.TEXTURE0),Ci.texture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE);let Hr=l.globePoleMatrixForTile(kn,vn,it);const fs=l.globeNormalizeECEF(l.globeTileBounds($t.canonical)),bs=(Ts,Os)=>Ts.draw(He,Ge.TRIANGLES,Mt,l.StencilMode.disabled,It,l.CullFaceMode.disabled,Ip(it.projMatrix,Hr,Hr,fs,0,Bt,it.frustumCorners.TL,it.frustumCorners.TR,it.frustumCorners.BR,it.frustumCorners.BL,it.globeCenterInViewSpace,it.globeRadius,zt,0),"globe_pole_raster",Os,Xr,ki);ne.setupElevationDraw(Ci,Xe,Qt),ie.prepareDrawProgram(He,Xe,$t.toUnwrapped()),Yn&&bs(Xe,ui),Ur&&(Hr=l.scale(l.create(),Hr,[1,-1,1]),bs(Xe,Mr))}}}})(C,L,B,U,q);else{const ie=C.context,ne=ie.gl;let be,Re;const je=C.options.showTerrainWireframe?2:0,He=(it,lt)=>{if(Re===it)return;const Ct=[tu[it]];lt&&Ct.push(tu[je]),be=C.useProgram("terrainRaster",null,Ct),Re=it},Ge=C.colorModeForRenderPass(),Xe=new l.DepthMode(ne.LEQUAL,l.DepthMode.ReadWrite,C.depthRangeFor3D);vl.update(q);const Ee=C.transform,Ue=Ap(Ee.zoom)*L.exaggeration();(je?[!1,!0]:[!1]).forEach(it=>{Re=-1;const lt=it?ne.LINES:ne.TRIANGLES,[Ct,It]=it?L.getWirefameBuffer():[L.gridIndexBuffer,L.gridSegments];for(const Mt of U){const jt=B.getTile(Mt),Bt=l.StencilMode.disabled,Yt=L.prevTerrainTileForTile[Mt.key],Zn=L.terrainTileForTile[Mt.key];xu(Yt,Zn)&&vl.newMorphing(Mt.key,Yt,Zn,q,250),ie.activeTexture.set(ne.TEXTURE0),jt.texture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE,ne.LINEAR_MIPMAP_NEAREST);const zt=vl.getMorphValuesForProxy(Mt.key),wn=zt?1:0;let Qt;zt&&(Qt={morphing:{srcDemTile:zt.from,dstDemTile:zt.to,phase:l.easeCubicInOut(zt.phase)}});const Gn=fc(Mt.projMatrix,u0(Mt.canonical,Ee.renderWorldCopies)?Ue/10:Ue);He(wn,it),L.setupElevationDraw(jt,be,Qt),C.prepareDrawProgram(ie,be,Mt.toUnwrapped()),be.draw(ie,lt,Xe,Bt,Ge,l.CullFaceMode.backCCW,Gn,"terrain_raster",L.gridBuffer,Ct,It)}})}}(v,this,this.proxySourceCache,d,this._updateTimestamp),this.renderingToTexture=!0,v.gpuTimingDeferredRenderEnd(),d.splice(0,d.length))}renderBatch(d){if(this._drapedRenderBatches.length===0)return d+1;this.renderingToTexture=!0;const v=this.painter,T=this.painter.context,C=this.proxySourceCache,L=this.proxiedCoords[C.id],B=this._drapedRenderBatches.shift(),U=[],q=v.style.order;let ie=0;for(const ne of L){const be=C.getTileByID(ne.proxyTileKey),Re=C.proxyCachedFBO[ne.key]?C.proxyCachedFBO[ne.key][d]:void 0,je=Re!==void 0?C.renderCache[Re]:this.pool[ie++],He=Re!==void 0;if(be.texture=je.tex,He&&!je.dirty){U.push(be.tileID);continue}let Ge;T.bindFramebuffer.set(je.fb.framebuffer),this.renderedToTile=!1,je.dirty&&(T.clear({color:l.Color.transparent,stencil:0}),je.dirty=!1);for(let Xe=B.start;Xe<=B.end;++Xe){const Ee=v.style._layers[q[Xe]];if(Ee.isHidden(v.transform.zoom))continue;const Ue=v.style._getLayerSourceCache(Ee),it=Ue?this.proxyToSource[ne.key][Ue.id]:[ne];if(!it)continue;const lt=it;T.viewport.set([0,0,je.fb.width,je.fb.height]),Ge!==(Ue?Ue.id:null)&&(this._setupStencil(je,it,Ee,Ue),Ge=Ue?Ue.id:null),v.renderLayer(v,Ue,Ee,lt)}this.renderedToTile?(je.dirty=!0,U.push(be.tileID)):He||--ie,ie===5&&(ie=0,this.renderToBackBuffer(U))}return this.renderToBackBuffer(U),this.renderingToTexture=!1,T.bindFramebuffer.set(null),T.viewport.set([0,0,v.width,v.height]),B.end+1}postRender(){}renderCacheEfficiency(d){const v=d.order.length;if(v===0)return{efficiency:100};let T,C=0,L=0,B=!1;for(let U=0;U<v;++U){const q=d._layers[d.order[U]];this._style.isLayerDraped(q)?(B&&++C,++L):B||(B=!0,T=q.id)}return L===0?{efficiency:100}:{efficiency:100*(1-C/L),firstUndrapedLayer:T}}getMinElevationBelowMSL(){let d=0;return this._visibleDemTiles.filter(v=>v.dem).forEach(v=>{d=Math.min(d,v.dem.tree.minimums[0])}),d===0?d:(d-30)*this._exaggeration}raycast(d,v,T){if(!this._visibleDemTiles)return null;const C=this._visibleDemTiles.filter(L=>L.dem).map(L=>{const B=L.tileID,U=1<<B.overscaledZ,{x:q,y:ie}=B.canonical,ne=q/U,be=(q+1)/U,Re=ie/U,je=(ie+1)/U;return{minx:ne,miny:Re,maxx:be,maxy:je,t:L.dem.tree.raycastRoot(ne,Re,be,je,d,v,T),tile:L}});C.sort((L,B)=>(L.t!==null?L.t:Number.MAX_VALUE)-(B.t!==null?B.t:Number.MAX_VALUE));for(const L of C){if(L.t==null)return null;const B=L.tile.dem.tree.raycast(L.minx,L.miny,L.maxx,L.maxy,d,v,T);if(B!=null)return B}return null}_createFBO(){const d=this.painter.context,v=d.gl,T=this.drapeBufferSize;d.activeTexture.set(v.TEXTURE0);const C=new l.Texture(d,{width:T[0],height:T[1],data:null},v.RGBA);C.bind(v.LINEAR,v.CLAMP_TO_EDGE);const L=d.createFramebuffer(T[0],T[1],!1);return L.colorAttachment.set(C.texture),L.depthAttachment=new at(d,L.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=d.createRenderbuffer(d.gl.DEPTH_STENCIL,T[0],T[1]),this._stencilRef=0,L.depthAttachment.set(this._sharedDepthStencil),d.clear({stencil:0})):L.depthAttachment.set(this._sharedDepthStencil),d.extTextureFilterAnisotropic&&!d.extTextureFilterAnisotropicForceOff&&v.texParameterf(v.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax),{fb:L,tex:C,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const d in this._style._sourceCaches)if(this._style._sourceCaches[d].hasTransition())return!0;return this._style.order.some(d=>{const v=this._style._layers[d],T=v.isHidden(this.painter.transform.zoom);return v.type==="custom"?!T&&v.shouldRedrape():!T&&v.hasTransition()})}_clearLineLayersFromRenderCache(){let d=!1;for(const T of this._style._getSources())if(T instanceof Mn){d=!0;break}if(!d)return;const v={};for(let T=0;T<this._style.order.length;++T){const C=this._style._layers[this._style.order[T]],L=this._style._getLayerSourceCache(C);if(L&&!v[L.id]&&!C.isHidden(this.painter.transform.zoom)&&C.type==="line"&&C.widthExpression()instanceof l.ZoomDependentExpression){v[L.id]=!0;for(const B of this.proxyCoords){const U=this.proxyToSource[B.key][L.id];if(U)for(const q of U)this._clearRenderCacheForTile(L.id,q)}}}}_clearRasterLayersFromRenderCache(){let d=!1;for(const T in this._style._sourceCaches)if(this._style._sourceCaches[T]._source instanceof Jt){d=!0;break}if(!d)return;const v={};for(let T=0;T<this._style.order.length;++T){const C=this._style._layers[this._style.order[T]],L=this._style._getLayerSourceCache(C);if(!L||v[L.id]||C.isHidden(this.painter.transform.zoom)||C.type!=="raster")continue;const B=C.paint.get("raster-fade-duration");for(const U of this.proxyCoords){const q=this.proxyToSource[U.key][L.id];if(q)for(const ie of q){const ne=Lp(L.getTile(ie),L.findLoadedParent(ie,0),L,this.painter.transform,B);(ne.opacity!==1||ne.mix!==0)&&this._clearRenderCacheForTile(L.id,ie)}}}}_setupDrapedRenderBatches(){const d=this._style.order,v=d.length;if(v===0)return;const T=[];let C,L=0,B=this._style._layers[d[L]];for(;!this._style.isLayerDraped(B)&&B.isHidden(this.painter.transform.zoom)&&++L<v;)B=this._style._layers[d[L]];for(;L<v;++L){const U=this._style._layers[d[L]];U.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(U)?C===void 0&&(C=L):C!==void 0&&(T.push({start:C,end:L-1}),C=void 0))}C!==void 0&&T.push({start:C,end:L-1}),this._drapedRenderBatches=T}_setupRenderCache(d){const v=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,v.renderCache.length>v.renderCachePool.length){const B=Object.values(v.proxyCachedFBO);v.proxyCachedFBO={};for(let U=0;U<B.length;++U){const q=Object.values(B[U]);v.renderCachePool.push(...q)}}return}this._clearRasterLayersFromRenderCache();const T=this.proxyCoords,C=this._tilesDirty;for(let B=T.length-1;B>=0;B--){const U=T[B];if(v.getTileByID(U.key),v.proxyCachedFBO[U.key]!==void 0){const q=d[U.key],ie=this.proxyToSource[U.key];let ne=0;for(const be in ie){const Re=ie[be],je=q[be];if(!je||je.length!==Re.length||Re.some((He,Ge)=>He!==je[Ge]||C[be]&&C[be].hasOwnProperty(He.key))){ne=-1;break}++ne}for(const be in v.proxyCachedFBO[U.key])v.renderCache[v.proxyCachedFBO[U.key][be]].dirty=ne<0||ne!==Object.values(q).length}}const L=[...this._drapedRenderBatches];L.sort((B,U)=>U.end-U.start-(B.end-B.start));for(const B of L)for(const U of T){if(v.proxyCachedFBO[U.key])continue;let q=v.renderCachePool.pop();q===void 0&&v.renderCache.length<50&&(q=v.renderCache.length,v.renderCache.push(this._createFBO())),q!==void 0&&(v.proxyCachedFBO[U.key]={},v.proxyCachedFBO[U.key][B.start]=q,v.renderCache[q].dirty=!0)}this._tilesDirty={}}_setupStencil(d,v,T,C){if(!C||!this._sourceTilesOverlap[C.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const L=this.painter.context,B=L.gl;if(v.length<=1)return void(this._overlapStencilType=!1);let U;if(T.isTileClipped())U=v.length,this._overlapStencilMode.test={func:B.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(v[0].overscaledZ>v[v.length-1].overscaledZ))return void(this._overlapStencilType=!1);U=1,this._overlapStencilMode.test={func:B.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+U>255&&(L.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=U,this._overlapStencilMode.ref=this._stencilRef,T.isTileClipped()&&this._renderTileClippingMasks(v,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(d){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[d.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(d,v){const T=this.painter,C=this.painter.context,L=C.gl;T._tileClippingMaskIDs={},C.setColorMode(l.ColorMode.disabled),C.setDepthMode(l.DepthMode.disabled);const B=T.useProgram("clippingMask");for(const U of d){const q=T._tileClippingMaskIDs[U.key]=--v;B.draw(C,L.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:L.ALWAYS,mask:0},q,255,L.KEEP,L.KEEP,L.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,_f(U.projMatrix),"$clipping",T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}}pointCoordinate(d){const v=this.painter.transform;if(d.x<0||d.x>v.width||d.y<0||d.y>v.height)return null;const T=[d.x,d.y,1,1];l.transformMat4$1(T,T,v.pixelMatrixInverse),l.scale$1(T,T,1/T[3]),T[0]/=v.worldSize,T[1]/=v.worldSize;const C=v._camera.position,L=l.mercatorZfromAltitude(1,v.center.lat),B=[C[0],C[1],C[2]/L,0],U=l.subtract([],T.slice(0,3),B);l.normalize(U,U);const q=this.raycast(B,U,this._exaggeration);return q!==null&&q?(l.scaleAndAdd(B,B,U,q),B[3]=B[2],B[2]*=L,B):null}drawDepth(){const d=this.painter,v=d.context,T=this.proxySourceCache,C=Math.ceil(d.width),L=Math.ceil(d.height);if(!this._depthFBO||this._depthFBO.width===C&&this._depthFBO.height===L||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const B=v.gl,U=v.createFramebuffer(C,L,!0);v.activeTexture.set(B.TEXTURE0);const q=new l.Texture(v,{width:C,height:L,data:null},B.RGBA);q.bind(B.NEAREST,B.CLAMP_TO_EDGE),U.colorAttachment.set(q.texture);const ie=v.createRenderbuffer(v.gl.DEPTH_COMPONENT16,C,L);U.depthAttachment.set(ie),this._depthFBO=U,this._depthTexture=q}v.bindFramebuffer.set(this._depthFBO.framebuffer),v.viewport.set([0,0,C,L]),function(B,U,q,ie){if(B.transform.projection.name==="globe")return;const ne=B.context,be=ne.gl;ne.clear({depth:1});const Re=B.useProgram("terrainDepth"),je=new l.DepthMode(be.LESS,l.DepthMode.ReadWrite,B.depthRangeFor3D);for(const He of ie){const Ge=q.getTile(He),Xe=fc(He.projMatrix,0);U.setupElevationDraw(Ge,Re),Re.draw(ne,be.TRIANGLES,je,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,Xe,"terrain_depth",U.gridBuffer,U.gridIndexBuffer,U.gridNoSkirtSegments)}}(d,this,T,this.proxyCoords)}_setupProxiedCoordsForOrtho(d,v,T){if(d.getSource()instanceof Cr)return this._setupProxiedCoordsForImageSource(d,v,T);this._findCoveringTileCache[d.id]=this._findCoveringTileCache[d.id]||{};const C=this.proxiedCoords[d.id]=[],L=this.proxyCoords;for(let U=0;U<L.length;U++){const q=L[U],ie=this._findTileCoveringTileID(q,d);if(ie){const ne=this._createProxiedId(q,ie,T[q.key]&&T[q.key][d.id]);C.push(ne),this.proxyToSource[q.key][d.id]=[ne]}}let B=!1;for(let U=0;U<v.length;U++){const q=d.getTile(v[U]);if(!q||!q.hasData())continue;const ie=this._findTileCoveringTileID(q.tileID,this.proxySourceCache);if(ie&&ie.tileID.canonical.z!==q.tileID.canonical.z){const ne=this.proxyToSource[ie.tileID.key][d.id],be=this._createProxiedId(ie.tileID,q,T[ie.tileID.key]&&T[ie.tileID.key][d.id]);ne?ne.splice(ne.length-1,0,be):this.proxyToSource[ie.tileID.key][d.id]=[be],C.push(be),B=!0}}this._sourceTilesOverlap[d.id]=B}_setupProxiedCoordsForImageSource(d,v,T){if(!d.getSource().loaded())return;const C=this.proxiedCoords[d.id]=[],L=this.proxyCoords,B=d.getSource(),U=new l.Point(B.tileID.x,B.tileID.y)._div(1<<B.tileID.z),q=B.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((ne,be)=>(ne.min.x=Math.min(ne.min.x,be.x-U.x),ne.min.y=Math.min(ne.min.y,be.y-U.y),ne.max.x=Math.max(ne.max.x,be.x-U.x),ne.max.y=Math.max(ne.max.y,be.y-U.y),ne),{min:new l.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),ie=(ne,be)=>{const Re=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),je=ne.canonical.y/(1<<ne.canonical.z),He=l.EXTENT/(1<<ne.canonical.z),Ge=be.wrap+be.canonical.x/(1<<be.canonical.z),Xe=be.canonical.y/(1<<be.canonical.z);return Re+He<Ge+q.min.x||Re>Ge+q.max.x||je+He<Xe+q.min.y||je>Xe+q.max.y};for(let ne=0;ne<L.length;ne++){const be=L[ne];for(let Re=0;Re<v.length;Re++){const je=d.getTile(v[Re]);if(!je||!je.hasData()||ie(be,je.tileID))continue;const He=this._createProxiedId(be,je,T[be.key]&&T[be.key][d.id]),Ge=this.proxyToSource[be.key][d.id];Ge?Ge.push(He):this.proxyToSource[be.key][d.id]=[He],C.push(He)}}}_createProxiedId(d,v,T){let C=this.orthoMatrix;if(T){const L=T.find(B=>B.key===v.tileID.key);if(L)return L}if(v.tileID.key!==d.key){const L=d.canonical.z-v.tileID.canonical.z;let B,U,q;C=l.create();const ie=v.tileID.wrap-d.wrap<<d.overscaledZ;L>0?(B=l.EXTENT>>L,U=B*((v.tileID.canonical.x<<L)-d.canonical.x+ie),q=B*((v.tileID.canonical.y<<L)-d.canonical.y)):(B=l.EXTENT<<-L,U=l.EXTENT*(v.tileID.canonical.x-(d.canonical.x+ie<<-L)),q=l.EXTENT*(v.tileID.canonical.y-(d.canonical.y<<-L))),l.ortho(C,0,B,0,B,0,1),l.translate(C,C,[U,q,0])}return new xf(v.tileID,d.key,C)}_findTileCoveringTileID(d,v){let T=v.getTile(d);if(T&&T.hasData())return T;const C=this._findCoveringTileCache[v.id],L=C[d.key];if(T=L?v.getTileByID(L):null,T&&T.hasData()||L===null)return T;let B=T?T.tileID:d,U=B.overscaledZ;const q=v.getSource().minzoom,ie=[];if(!L){const be=v.getSource().maxzoom;if(d.canonical.z>=be){const Re=d.canonical.z-be;v.getSource().reparseOverscaled?(U=Math.max(d.canonical.z+2,v.transform.tileZoom),B=new l.OverscaledTileID(U,d.wrap,be,d.canonical.x>>Re,d.canonical.y>>Re)):Re!==0&&(U=be,B=new l.OverscaledTileID(U,d.wrap,be,d.canonical.x>>Re,d.canonical.y>>Re))}B.key!==d.key&&(ie.push(B.key),T=v.getTile(B))}const ne=be=>{ie.forEach(Re=>{C[Re]=be}),ie.length=0};for(U-=1;U>=q&&(!T||!T.hasData());U--){T&&ne(T.tileID.key);const be=B.calculateScaledKey(U);if(T=v.getTileByID(be),T&&T.hasData())break;const Re=C[be];if(Re===null)break;Re===void 0?ie.push(be):T=v.getTileByID(Re)}return ne(T?T.tileID.key:null),T&&T.hasData()?T:null}findDEMTileFor(d){return this.enabled?this._findTileCoveringTileID(d,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(d,v){let T=this._tilesDirty[d];T||(T=this._tilesDirty[d]={}),T[v.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const d=function(v){let T=0;const C=new l.StructArrayLayout2ui4,L=131;for(let B=1;B<129;B++){for(let U=1;U<129;U++)T=B*L+U,C.emplaceBack(T,T+1),C.emplaceBack(T,T+L),C.emplaceBack(T+1,T+L),B===128&&C.emplaceBack(T+L,T+L+1);C.emplaceBack(T+1,T+1+L)}return C}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(d),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,d.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Yi{static cacheKey(d,v,T,C){let L=`${v}${C?C.cacheKey:""}`;for(const B of T)d.usedDefines.includes(B)&&(L+=`/${B}`);return L}constructor(d,v,T,C,L,B){const U=d.gl;this.program=U.createProgram();const q=function(Ee){const Ue=[];for(let it=0;it<Ee.length;it++){if(Ee[it]===null)continue;const lt=Ee[it].split(" ");Ue.push(lt.pop())}return Ue}(T.staticAttributes),ie=C?C.getBinderAttributes():[],ne=q.concat(ie);let be=C?C.defines():[];be=be.concat(B.map(Ee=>`#define ${Ee}`));const Re=d.isWebGL2?`#version 300 es
`:"",je=Re+be.concat(d.extStandardDerivatives&&Re.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(dc):dc,dc,gf,Mp.fragmentSource,Pr.fragmentSource,T.fragmentSource).join(`
`),He=Re+be.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,gf,Mp.vertexSource,Pr.vertexSource,jc.vertexSource,T.vertexSource).join(`
`),Ge=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(Ge,je),U.compileShader(Ge),U.attachShader(this.program,Ge);const Xe=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())this.failedToCreate=!0;else{U.shaderSource(Xe,He),U.compileShader(Xe),U.attachShader(this.program,Xe),this.attributes={},this.numAttributes=ne.length;for(let Ee=0;Ee<this.numAttributes;Ee++)ne[Ee]&&(U.bindAttribLocation(this.program,Ee,ne[Ee]),this.attributes[ne[Ee]]=Ee);U.linkProgram(this.program),U.deleteShader(Xe),U.deleteShader(Ge),this.fixedUniforms=L(d),this.binderUniforms=C?C.getUniforms(d):[],B.includes("TERRAIN")&&(this.terrainUniforms=(Ee=>({u_dem:new l.Uniform1i(Ee),u_dem_prev:new l.Uniform1i(Ee),u_dem_unpack:new l.Uniform4f(Ee),u_dem_tl:new l.Uniform2f(Ee),u_dem_scale:new l.Uniform1f(Ee),u_dem_tl_prev:new l.Uniform2f(Ee),u_dem_scale_prev:new l.Uniform1f(Ee),u_dem_size:new l.Uniform1f(Ee),u_dem_lerp:new l.Uniform1f(Ee),u_exaggeration:new l.Uniform1f(Ee),u_depth:new l.Uniform1i(Ee),u_depth_size_inv:new l.Uniform2f(Ee),u_meter_to_dem:new l.Uniform1f(Ee),u_label_plane_matrix_inv:new l.UniformMatrix4f(Ee)}))(d)),B.includes("GLOBE")&&(this.globeUniforms=(Ee=>({u_tile_tl_up:new l.Uniform3f(Ee),u_tile_tr_up:new l.Uniform3f(Ee),u_tile_br_up:new l.Uniform3f(Ee),u_tile_bl_up:new l.Uniform3f(Ee),u_tile_up_scale:new l.Uniform1f(Ee)}))(d)),B.includes("FOG")&&(this.fogUniforms=(Ee=>({u_fog_matrix:new l.UniformMatrix4f(Ee),u_fog_range:new l.Uniform2f(Ee),u_fog_color:new l.Uniform4f(Ee),u_fog_horizon_blend:new l.Uniform1f(Ee),u_fog_temporal_offset:new l.Uniform1f(Ee),u_frustum_tl:new l.Uniform3f(Ee),u_frustum_tr:new l.Uniform3f(Ee),u_frustum_br:new l.Uniform3f(Ee),u_frustum_bl:new l.Uniform3f(Ee),u_globe_pos:new l.Uniform3f(Ee),u_globe_radius:new l.Uniform1f(Ee),u_globe_transition:new l.Uniform1f(Ee),u_is_globe:new l.Uniform1i(Ee),u_viewport:new l.Uniform2f(Ee)}))(d))}}setTerrainUniformValues(d,v){if(!this.terrainUniforms)return;const T=this.terrainUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in v)T[C]&&T[C].set(this.program,C,v[C])}}setGlobeUniformValues(d,v){if(!this.globeUniforms)return;const T=this.globeUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in v)T[C]&&T[C].set(this.program,C,v[C])}}setFogUniformValues(d,v){if(!this.fogUniforms)return;const T=this.fogUniforms;if(!this.failedToCreate){d.program.set(this.program);for(const C in v)T[C].set(this.program,C,v[C])}}draw(d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge){const Xe=d.gl;if(this.failedToCreate)return;d.program.set(this.program),d.setDepthMode(T),d.setStencilMode(C),d.setColorMode(L),d.setCullFace(B);for(const Ue of Object.keys(this.fixedUniforms))this.fixedUniforms[Ue].set(this.program,Ue,U[Ue]);He&&He.setUniforms(this.program,d,this.binderUniforms,Re,{zoom:je});const Ee={[Xe.LINES]:2,[Xe.TRIANGLES]:3,[Xe.LINE_STRIP]:1}[v];for(const Ue of be.get()){const it=Ue.vaos||(Ue.vaos={});(it[q]||(it[q]=new kp)).bind(d,this,ie,He?He.getPaintVertexBuffers():[],ne,Ue.vertexOffset,Ge||[]),Xe.drawElements(v,Ue.primitiveLength*Ee,Xe.UNSIGNED_SHORT,Ue.primitiveOffset*Ee*2)}}}function bf(b,d){const v=Math.pow(2,d.tileID.overscaledZ),T=d.tileSize*Math.pow(2,b.transform.tileZoom)/v,C=T*(d.tileID.canonical.x+d.tileID.wrap*v),L=T*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_tile_units_to_pixels:1/rt(d,1,b.transform.tileZoom),u_pixel_coord_upper:[C>>16,L>>16],u_pixel_coord_lower:[65535&C,65535&L]}}const Wm=l.create(),Vo=(b,d,v,T,C,L,B,U,q,ie,ne)=>{const be=d.style.light,Re=be.properties.get("position"),je=[Re.x,Re.y,Re.z],He=l.create$1();be.properties.get("anchor")==="viewport"&&(l.fromRotation(He,-d.transform.angle),l.transformMat3(je,je,He));const Ge=be.properties.get("color"),Xe=d.transform,Ee={u_matrix:b,u_lightpos:je,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Ge.r,Ge.g,Ge.b],u_vertical_gradient:+v,u_opacity:T,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Wm,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:C,u_edge_radius:L};return Xe.projection.name==="globe"&&(Ee.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],Ee.u_zoom_transition=q,Ee.u_inv_rot_matrix=ne,Ee.u_merc_center=ie,Ee.u_up_dir=Xe.projection.upVector(new l.CanonicalTileID(0,0,0),ie[0]*l.EXTENT,ie[1]*l.EXTENT),Ee.u_height_lift=U),Ee},qm=(b,d,v,T,C,L,B,U,q,ie,ne,be)=>{const Re=Vo(b,d,v,T,C,L,B,q,ie,ne,be),je={u_height_factor:-Math.pow(2,B.overscaledZ)/U.tileSize/8};return l.extend(Re,bf(d,U),je)},Ul=b=>({u_matrix:b}),vd=(b,d,v)=>l.extend(Ul(b),bf(d,v)),xl=(b,d)=>({u_matrix:b,u_world:d}),mv=(b,d,v,T)=>l.extend(vd(b,d,v),{u_world:T}),Th=l.create(),wf=(b,d,v,T,C,L)=>{const B=b.transform,U=B.projection.name==="globe";let q;if(L.paint.get("circle-pitch-alignment")==="map")if(U){const ne=l.globePixelsToTileUnits(B.zoom,d.canonical)*B._pixelsPerMercatorPixel;q=Float32Array.from([ne,0,0,ne])}else q=B.calculatePixelsToTileUnitsMatrix(v);else q=new Float32Array([B.pixelsToGLUnits[0],0,0,B.pixelsToGLUnits[1]]);const ie={u_camera_to_center_distance:B.cameraToCenterDistance,u_matrix:b.translatePosMatrix(d.projMatrix,v,L.paint.get("circle-translate"),L.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:q,u_inv_rot_matrix:Th,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){ie.u_inv_rot_matrix=T,ie.u_merc_center=C,ie.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],ie.u_zoom_transition=l.globeToMercatorTransition(B.zoom);const ne=C[0]*l.EXTENT,be=C[1]*l.EXTENT;ie.u_up_dir=B.projection.upVector(new l.CanonicalTileID(0,0,0),ne,be)}return ie},ga=b=>{const d=[];return b.paint.get("circle-pitch-alignment")==="map"&&d.push("PITCH_WITH_MAP"),b.paint.get("circle-pitch-scale")==="map"&&d.push("SCALE_WITH_MAP"),d},xd=(b,d,v,T)=>{const C=l.EXTENT/v.tileSize;return{u_matrix:b,u_camera_to_center_distance:d.getCameraToCenterDistance(T),u_extrude_scale:[d.pixelsToGLUnits[0]/C,d.pixelsToGLUnits[1]/C]}},Ef=(b,d,v=1)=>({u_matrix:b,u_color:d,u_overlay:0,u_overlay_scale:v}),Sf=l.create(),$m=(b,d,v,T,C,L,B)=>{const U=b.transform,q=U.projection.name==="globe",ie=q?l.globePixelsToTileUnits(U.zoom,d.canonical)*U._pixelsPerMercatorPixel:rt(v,1,L),ne={u_matrix:d.projMatrix,u_extrude_scale:ie,u_intensity:B,u_inv_rot_matrix:Sf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(q){ne.u_inv_rot_matrix=T,ne.u_merc_center=C,ne.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],ne.u_zoom_transition=l.globeToMercatorTransition(U.zoom);const be=C[0]*l.EXTENT,Re=C[1]*l.EXTENT;ne.u_up_dir=U.projection.upVector(new l.CanonicalTileID(0,0,0),be,Re)}return ne},i_=(b,d,v,T,C,L,B)=>{const U=b.transform,q=U.calculatePixelsToTileUnitsMatrix(d);return{u_matrix:Vu(b,d,v,T),u_pixels_to_tile_units:q,u_device_pixel_ratio:L,u_units_to_pixels:[1/U.pixelsToGLUnits[0],1/U.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:C,u_texsize:Vc(v)?d.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Np(d,b.transform),u_alpha_discard_threshold:0,u_trim_offset:B}},Xm=(b,d,v,T,C)=>{const L=b.transform;return{u_matrix:Vu(b,d,v,T),u_texsize:d.imageAtlasTexture.size,u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(d),u_device_pixel_ratio:C,u_image:0,u_tile_units_to_pixels:Np(d,L),u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Np(b,d){return 1/rt(b,1,d.tileZoom)}function Vu(b,d,v,T){return b.translatePosMatrix(T||d.tileID.projMatrix,d,v.paint.get("line-translate"),v.paint.get("line-translate-anchor"))}function Vc(b){const d=b.paint.get("line-dasharray").value;return d.value||d.kind!=="constant"}const Dp=(b,d,v,T,C,L)=>{return{u_matrix:b,u_tl_parent:d,u_scale_parent:v,u_fade_t:T.mix,u_opacity:T.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(U=C.paint.get("raster-saturation"),U>0?1-1/(1.001-U):-U),u_contrast_factor:(B=C.paint.get("raster-contrast"),B>0?1/(1-B):1+B),u_spin_weights:nu(C.paint.get("raster-hue-rotate")),u_perspective_transform:L};var B,U};function nu(b){b*=Math.PI/180;const d=Math.sin(b),v=Math.cos(b);return[(2*v+1)/3,(-Math.sqrt(3)*d-v+1)/3,(Math.sqrt(3)*d-v+1)/3]}const Zm=l.create(),s_=(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge)=>{const Xe=C.transform,Ee={u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:Xe.cameraToCenterDistance,u_rotate_symbol:+v,u_aspect_ratio:Xe.width/Xe.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:B,u_coord_matrix:U,u_is_text:+q,u_pitch_with_map:+T,u_texsize:ie,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Zm,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Zm,u_up_vector:[0,-1,0]};return Ge.name==="globe"&&(Ee.u_tile_id=[ne.canonical.x,ne.canonical.y,1<<ne.canonical.z],Ee.u_zoom_transition=be,Ee.u_inv_rot_matrix=je,Ee.u_merc_center=Re,Ee.u_camera_forward=Xe._camera.forward(),Ee.u_ecef_origin=l.globeECEFOrigin(Xe.globeMatrix,ne.toUnwrapped()),Ee.u_tile_matrix=Float32Array.from(Xe.globeMatrix),Ee.u_up_vector=He),Ee},Gc=(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge,Xe)=>l.extend(s_(b,d,v,T,C,L,B,U,q,ie,be,Re,je,He,Ge,Xe),{u_gamma_scale:T?C.transform.cameraToCenterDistance*Math.cos(C.terrain?0:C.transform._pitch):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+ne}),ts=(b,d,v,T,C,L,B,U,q,ie,ne,be,Re,je,He,Ge)=>l.extend(Gc(b,d,v,T,C,L,B,U,!0,q,!0,ne,be,Re,je,He,Ge),{u_texsize_icon:ie,u_texture_icon:1}),Lr=(b,d,v)=>({u_matrix:b,u_opacity:d,u_color:v}),pc=(b,d,v,T,C)=>l.extend(function(L,B,U){const q=B.imageManager.getPattern(L.toString()),{width:ie,height:ne}=B.imageManager.getPixelSize(),be=Math.pow(2,U.tileID.overscaledZ),Re=U.tileSize*Math.pow(2,B.transform.tileZoom)/be,je=Re*(U.tileID.canonical.x+U.tileID.wrap*be),He=Re*U.tileID.canonical.y;return{u_image:0,u_pattern_tl:q.tl,u_pattern_br:q.br,u_texsize:[ie,ne],u_pattern_size:q.displaySize,u_tile_units_to_pixels:1/rt(U,1,B.transform.tileZoom),u_pixel_coord_upper:[je>>16,He>>16],u_pixel_coord_lower:[65535&je,65535&He]}}(T,v,C),{u_matrix:b,u_opacity:d}),o_={fillExtrusion:b=>({u_matrix:new l.UniformMatrix4f(b),u_lightpos:new l.Uniform3f(b),u_lightintensity:new l.Uniform1f(b),u_lightcolor:new l.Uniform3f(b),u_vertical_gradient:new l.Uniform1f(b),u_opacity:new l.Uniform1f(b),u_edge_radius:new l.Uniform1f(b),u_ao:new l.Uniform2f(b),u_tile_id:new l.Uniform3f(b),u_zoom_transition:new l.Uniform1f(b),u_inv_rot_matrix:new l.UniformMatrix4f(b),u_merc_center:new l.Uniform2f(b),u_up_dir:new l.Uniform3f(b),u_height_lift:new l.Uniform1f(b)}),fillExtrusionPattern:b=>({u_matrix:new l.UniformMatrix4f(b),u_lightpos:new l.Uniform3f(b),u_lightintensity:new l.Uniform1f(b),u_lightcolor:new l.Uniform3f(b),u_vertical_gradient:new l.Uniform1f(b),u_height_factor:new l.Uniform1f(b),u_edge_radius:new l.Uniform1f(b),u_ao:new l.Uniform2f(b),u_tile_id:new l.Uniform3f(b),u_zoom_transition:new l.Uniform1f(b),u_inv_rot_matrix:new l.UniformMatrix4f(b),u_merc_center:new l.Uniform2f(b),u_up_dir:new l.Uniform3f(b),u_height_lift:new l.Uniform1f(b),u_image:new l.Uniform1i(b),u_texsize:new l.Uniform2f(b),u_pixel_coord_upper:new l.Uniform2f(b),u_pixel_coord_lower:new l.Uniform2f(b),u_tile_units_to_pixels:new l.Uniform1f(b),u_opacity:new l.Uniform1f(b)}),fill:b=>({u_matrix:new l.UniformMatrix4f(b)}),fillPattern:b=>({u_matrix:new l.UniformMatrix4f(b),u_image:new l.Uniform1i(b),u_texsize:new l.Uniform2f(b),u_pixel_coord_upper:new l.Uniform2f(b),u_pixel_coord_lower:new l.Uniform2f(b),u_tile_units_to_pixels:new l.Uniform1f(b)}),fillOutline:b=>({u_matrix:new l.UniformMatrix4f(b),u_world:new l.Uniform2f(b)}),fillOutlinePattern:b=>({u_matrix:new l.UniformMatrix4f(b),u_world:new l.Uniform2f(b),u_image:new l.Uniform1i(b),u_texsize:new l.Uniform2f(b),u_pixel_coord_upper:new l.Uniform2f(b),u_pixel_coord_lower:new l.Uniform2f(b),u_tile_units_to_pixels:new l.Uniform1f(b)}),circle:b=>({u_camera_to_center_distance:new l.Uniform1f(b),u_extrude_scale:new l.UniformMatrix2f(b),u_device_pixel_ratio:new l.Uniform1f(b),u_matrix:new l.UniformMatrix4f(b),u_inv_rot_matrix:new l.UniformMatrix4f(b),u_merc_center:new l.Uniform2f(b),u_tile_id:new l.Uniform3f(b),u_zoom_transition:new l.Uniform1f(b),u_up_dir:new l.Uniform3f(b)}),collisionBox:b=>({u_matrix:new l.UniformMatrix4f(b),u_camera_to_center_distance:new l.Uniform1f(b),u_extrude_scale:new l.Uniform2f(b)}),collisionCircle:b=>({u_matrix:new l.UniformMatrix4f(b),u_inv_matrix:new l.UniformMatrix4f(b),u_camera_to_center_distance:new l.Uniform1f(b),u_viewport_size:new l.Uniform2f(b)}),debug:b=>({u_color:new l.UniformColor(b),u_matrix:new l.UniformMatrix4f(b),u_overlay:new l.Uniform1i(b),u_overlay_scale:new l.Uniform1f(b)}),clippingMask:b=>({u_matrix:new l.UniformMatrix4f(b)}),heatmap:b=>({u_extrude_scale:new l.Uniform1f(b),u_intensity:new l.Uniform1f(b),u_matrix:new l.UniformMatrix4f(b),u_inv_rot_matrix:new l.UniformMatrix4f(b),u_merc_center:new l.Uniform2f(b),u_tile_id:new l.Uniform3f(b),u_zoom_transition:new l.Uniform1f(b),u_up_dir:new l.Uniform3f(b)}),heatmapTexture:b=>({u_image:new l.Uniform1i(b),u_color_ramp:new l.Uniform1i(b),u_opacity:new l.Uniform1f(b)}),hillshade:b=>({u_matrix:new l.UniformMatrix4f(b),u_image:new l.Uniform1i(b),u_latrange:new l.Uniform2f(b),u_light:new l.Uniform2f(b),u_shadow:new l.UniformColor(b),u_highlight:new l.UniformColor(b),u_accent:new l.UniformColor(b)}),hillshadePrepare:b=>({u_matrix:new l.UniformMatrix4f(b),u_image:new l.Uniform1i(b),u_dimension:new l.Uniform2f(b),u_zoom:new l.Uniform1f(b),u_unpack:new l.Uniform4f(b)}),line:b=>({u_matrix:new l.UniformMatrix4f(b),u_pixels_to_tile_units:new l.UniformMatrix2f(b),u_device_pixel_ratio:new l.Uniform1f(b),u_units_to_pixels:new l.Uniform2f(b),u_dash_image:new l.Uniform1i(b),u_gradient_image:new l.Uniform1i(b),u_image_height:new l.Uniform1f(b),u_texsize:new l.Uniform2f(b),u_tile_units_to_pixels:new l.Uniform1f(b),u_alpha_discard_threshold:new l.Uniform1f(b),u_trim_offset:new l.Uniform2f(b)}),linePattern:b=>({u_matrix:new l.UniformMatrix4f(b),u_texsize:new l.Uniform2f(b),u_pixels_to_tile_units:new l.UniformMatrix2f(b),u_device_pixel_ratio:new l.Uniform1f(b),u_image:new l.Uniform1i(b),u_units_to_pixels:new l.Uniform2f(b),u_tile_units_to_pixels:new l.Uniform1f(b),u_alpha_discard_threshold:new l.Uniform1f(b)}),raster:b=>({u_matrix:new l.UniformMatrix4f(b),u_tl_parent:new l.Uniform2f(b),u_scale_parent:new l.Uniform1f(b),u_fade_t:new l.Uniform1f(b),u_opacity:new l.Uniform1f(b),u_image0:new l.Uniform1i(b),u_image1:new l.Uniform1i(b),u_brightness_low:new l.Uniform1f(b),u_brightness_high:new l.Uniform1f(b),u_saturation_factor:new l.Uniform1f(b),u_contrast_factor:new l.Uniform1f(b),u_spin_weights:new l.Uniform3f(b),u_perspective_transform:new l.Uniform2f(b)}),symbolIcon:b=>({u_is_size_zoom_constant:new l.Uniform1i(b),u_is_size_feature_constant:new l.Uniform1i(b),u_size_t:new l.Uniform1f(b),u_size:new l.Uniform1f(b),u_camera_to_center_distance:new l.Uniform1f(b),u_rotate_symbol:new l.Uniform1i(b),u_aspect_ratio:new l.Uniform1f(b),u_fade_change:new l.Uniform1f(b),u_matrix:new l.UniformMatrix4f(b),u_label_plane_matrix:new l.UniformMatrix4f(b),u_coord_matrix:new l.UniformMatrix4f(b),u_is_text:new l.Uniform1i(b),u_pitch_with_map:new l.Uniform1i(b),u_texsize:new l.Uniform2f(b),u_tile_id:new l.Uniform3f(b),u_zoom_transition:new l.Uniform1f(b),u_inv_rot_matrix:new l.UniformMatrix4f(b),u_merc_center:new l.Uniform2f(b),u_camera_forward:new l.Uniform3f(b),u_tile_matrix:new l.UniformMatrix4f(b),u_up_vector:new l.Uniform3f(b),u_ecef_origin:new l.Uniform3f(b),u_texture:new l.Uniform1i(b)}),symbolSDF:b=>({u_is_size_zoom_constant:new l.Uniform1i(b),u_is_size_feature_constant:new l.Uniform1i(b),u_size_t:new l.Uniform1f(b),u_size:new l.Uniform1f(b),u_camera_to_center_distance:new l.Uniform1f(b),u_rotate_symbol:new l.Uniform1i(b),u_aspect_ratio:new l.Uniform1f(b),u_fade_change:new l.Uniform1f(b),u_matrix:new l.UniformMatrix4f(b),u_label_plane_matrix:new l.UniformMatrix4f(b),u_coord_matrix:new l.UniformMatrix4f(b),u_is_text:new l.Uniform1i(b),u_pitch_with_map:new l.Uniform1i(b),u_texsize:new l.Uniform2f(b),u_texture:new l.Uniform1i(b),u_gamma_scale:new l.Uniform1f(b),u_device_pixel_ratio:new l.Uniform1f(b),u_tile_id:new l.Uniform3f(b),u_zoom_transition:new l.Uniform1f(b),u_inv_rot_matrix:new l.UniformMatrix4f(b),u_merc_center:new l.Uniform2f(b),u_camera_forward:new l.Uniform3f(b),u_tile_matrix:new l.UniformMatrix4f(b),u_up_vector:new l.Uniform3f(b),u_ecef_origin:new l.Uniform3f(b),u_is_halo:new l.Uniform1i(b)}),symbolTextAndIcon:b=>({u_is_size_zoom_constant:new l.Uniform1i(b),u_is_size_feature_constant:new l.Uniform1i(b),u_size_t:new l.Uniform1f(b),u_size:new l.Uniform1f(b),u_camera_to_center_distance:new l.Uniform1f(b),u_rotate_symbol:new l.Uniform1i(b),u_aspect_ratio:new l.Uniform1f(b),u_fade_change:new l.Uniform1f(b),u_matrix:new l.UniformMatrix4f(b),u_label_plane_matrix:new l.UniformMatrix4f(b),u_coord_matrix:new l.UniformMatrix4f(b),u_is_text:new l.Uniform1i(b),u_pitch_with_map:new l.Uniform1i(b),u_texsize:new l.Uniform2f(b),u_texsize_icon:new l.Uniform2f(b),u_texture:new l.Uniform1i(b),u_texture_icon:new l.Uniform1i(b),u_gamma_scale:new l.Uniform1f(b),u_device_pixel_ratio:new l.Uniform1f(b),u_is_halo:new l.Uniform1i(b)}),background:b=>({u_matrix:new l.UniformMatrix4f(b),u_opacity:new l.Uniform1f(b),u_color:new l.UniformColor(b)}),backgroundPattern:b=>({u_matrix:new l.UniformMatrix4f(b),u_opacity:new l.Uniform1f(b),u_image:new l.Uniform1i(b),u_pattern_tl:new l.Uniform2f(b),u_pattern_br:new l.Uniform2f(b),u_texsize:new l.Uniform2f(b),u_pattern_size:new l.Uniform2f(b),u_pixel_coord_upper:new l.Uniform2f(b),u_pixel_coord_lower:new l.Uniform2f(b),u_tile_units_to_pixels:new l.Uniform1f(b)}),terrainRaster:l0,terrainDepth:l0,skybox:b=>({u_matrix:new l.UniformMatrix4f(b),u_sun_direction:new l.Uniform3f(b),u_cubemap:new l.Uniform1i(b),u_opacity:new l.Uniform1f(b),u_temporal_offset:new l.Uniform1f(b)}),skyboxGradient:b=>({u_matrix:new l.UniformMatrix4f(b),u_color_ramp:new l.Uniform1i(b),u_center_direction:new l.Uniform3f(b),u_radius:new l.Uniform1f(b),u_opacity:new l.Uniform1f(b),u_temporal_offset:new l.Uniform1f(b)}),skyboxCapture:b=>({u_matrix_3f:new l.UniformMatrix3f(b),u_sun_direction:new l.Uniform3f(b),u_sun_intensity:new l.Uniform1f(b),u_color_tint_r:new l.Uniform4f(b),u_color_tint_m:new l.Uniform4f(b),u_luminance:new l.Uniform1f(b)}),globeRaster:b=>({u_proj_matrix:new l.UniformMatrix4f(b),u_globe_matrix:new l.UniformMatrix4f(b),u_normalize_matrix:new l.UniformMatrix4f(b),u_merc_matrix:new l.UniformMatrix4f(b),u_zoom_transition:new l.Uniform1f(b),u_merc_center:new l.Uniform2f(b),u_image0:new l.Uniform1i(b),u_grid_matrix:new l.UniformMatrix3f(b),u_skirt_height:new l.Uniform1f(b),u_frustum_tl:new l.Uniform3f(b),u_frustum_tr:new l.Uniform3f(b),u_frustum_br:new l.Uniform3f(b),u_frustum_bl:new l.Uniform3f(b),u_globe_pos:new l.Uniform3f(b),u_globe_radius:new l.Uniform1f(b),u_viewport:new l.Uniform2f(b)}),globeAtmosphere:b=>({u_frustum_tl:new l.Uniform3f(b),u_frustum_tr:new l.Uniform3f(b),u_frustum_br:new l.Uniform3f(b),u_frustum_bl:new l.Uniform3f(b),u_horizon:new l.Uniform1f(b),u_transition:new l.Uniform1f(b),u_fadeout_range:new l.Uniform1f(b),u_color:new l.Uniform4f(b),u_high_color:new l.Uniform4f(b),u_space_color:new l.Uniform4f(b),u_star_intensity:new l.Uniform1f(b),u_star_density:new l.Uniform1f(b),u_star_size:new l.Uniform1f(b),u_temporal_offset:new l.Uniform1f(b),u_horizon_angle:new l.Uniform1f(b),u_rotation_matrix:new l.UniformMatrix4f(b)})};let c0;function Ym(b,d,v,T,C,L,B){const U=b.context,q=U.gl,ie=b.transform,ne=b.useProgram("collisionBox"),be=[];let Re=0,je=0;for(let lt=0;lt<T.length;lt++){const Ct=T[lt],It=d.getTile(Ct),Mt=It.getBucket(v);if(!Mt)continue;const jt=ot(Ct,Mt,ie);let Bt=jt;C[0]===0&&C[1]===0||(Bt=b.translatePosMatrix(jt,It,C,L));const Yt=B?Mt.textCollisionBox:Mt.iconCollisionBox,Zn=Mt.collisionCircleArray;if(Zn.length>0){const zt=l.create(),wn=Bt;l.mul(zt,Mt.placementInvProjMatrix,ie.glCoordMatrix),l.mul(zt,zt,Mt.placementViewportMatrix),be.push({circleArray:Zn,circleOffset:je,transform:wn,invTransform:zt,projection:Mt.getProjection()}),Re+=Zn.length/4,je=Re}Yt&&(b.terrain&&b.terrain.setupElevationDraw(It,ne),ne.draw(U,q.LINES,l.DepthMode.disabled,l.StencilMode.disabled,b.colorModeForRenderPass(),l.CullFaceMode.disabled,xd(Bt,ie,It,Mt.getProjection()),v.id,Yt.layoutVertexBuffer,Yt.indexBuffer,Yt.segments,null,ie.zoom,null,[Yt.collisionVertexBuffer,Yt.collisionVertexBufferExt]))}if(!B||!be.length)return;const He=b.useProgram("collisionCircle"),Ge=new l.StructArrayLayout2f1f2i16;Ge.resize(4*Re),Ge._trim();let Xe=0;for(const lt of be)for(let Ct=0;Ct<lt.circleArray.length/4;Ct++){const It=4*Ct,Mt=lt.circleArray[It+0],jt=lt.circleArray[It+1],Bt=lt.circleArray[It+2],Yt=lt.circleArray[It+3];Ge.emplace(Xe++,Mt,jt,Bt,Yt,0),Ge.emplace(Xe++,Mt,jt,Bt,Yt,1),Ge.emplace(Xe++,Mt,jt,Bt,Yt,2),Ge.emplace(Xe++,Mt,jt,Bt,Yt,3)}(!c0||c0.length<2*Re)&&(c0=function(lt){const Ct=2*lt,It=new l.StructArrayLayout3ui6;It.resize(Ct),It._trim();for(let Mt=0;Mt<Ct;Mt++){const jt=6*Mt;It.uint16[jt+0]=4*Mt+0,It.uint16[jt+1]=4*Mt+1,It.uint16[jt+2]=4*Mt+2,It.uint16[jt+3]=4*Mt+2,It.uint16[jt+4]=4*Mt+3,It.uint16[jt+5]=4*Mt+0}return It}(Re));const Ee=U.createIndexBuffer(c0,!0),Ue=U.createVertexBuffer(Ge,l.collisionCircleLayout.members,!0);for(const lt of be){const Ct={u_matrix:lt.transform,u_inv_matrix:lt.invTransform,u_camera_to_center_distance:(it=ie).getCameraToCenterDistance(lt.projection),u_viewport_size:[it.width,it.height]};He.draw(U,q.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,b.colorModeForRenderPass(),l.CullFaceMode.disabled,Ct,v.id,Ue,Ee,l.SegmentVector.simpleSegment(0,2*lt.circleOffset,lt.circleArray.length,lt.circleArray.length/2),null,ie.zoom)}var it;Ue.destroy(),Ee.destroy()}const gv=l.create();function a_({width:b,height:d,anchor:v,textOffset:T,textScale:C},L){const{horizontalAlign:B,verticalAlign:U}=l.getAnchorAlignment(v),q=-(B-.5)*b,ie=-(U-.5)*d,ne=l.evaluateVariableOffset(v,T);return new l.Point((q/C+ne[0])*L,(ie/C+ne[1])*L)}function m3(b,d,v,T,C,L,B,U,q,ie,ne){const be=b.text.placedSymbolArray,Re=b.text.dynamicLayoutVertexArray,je=b.icon.dynamicLayoutVertexArray,He={},Ge=b.getProjection(),Xe=Gt(U,Ge,L),Ee=L.elevation,Ue=Ge.upVectorScale(U.canonical,L.center.lat,L.worldSize).metersToTile;Re.clear();for(let it=0;it<be.length;it++){const lt=be.get(it),{tileAnchorX:Ct,tileAnchorY:It,numGlyphs:Mt}=lt,jt=lt.hidden||!lt.crossTileID||b.allowVerticalPlacement&&!lt.placedOrientation?null:T[lt.crossTileID];if(jt){let Bt=0,Yt=0,Zn=0;if(Ee){const Yn=Ee?Ee.getAtTileOffset(U,Ct,It):0,[Ur,ui,Mr]=Ge.upVector(U.canonical,Ct,It);Bt=Yn*Ur*Ue,Yt=Yn*ui*Ue,Zn=Yn*Mr*Ue}let[zt,wn,Qt,Gn]=Ds(lt.projectedAnchorX+Bt,lt.projectedAnchorY+Yt,lt.projectedAnchorZ+Zn,v?Xe:B);const $t=Tp(L.getCameraToCenterDistance(Ge),Gn);let vn=C.evaluateSizeForFeature(b.textSizeData,ie,lt)*$t/l.ONE_EM;v&&(vn*=b.tilePixelRatio/q);const Tn=a_(jt,vn);v?({x:zt,y:wn,z:Qt}=Ge.projectTilePoint(Ct+Tn.x,It+Tn.y,U.canonical),[zt,wn,Qt]=Ds(zt+Bt,wn+Yt,Qt+Zn,B)):(d&&Tn._rotate(-L.angle),zt+=Tn.x,wn+=Tn.y,Qt=0);const kn=b.allowVerticalPlacement&&lt.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let Yn=0;Yn<Mt;Yn++)l.addDynamicAttributes(Re,zt,wn,Qt,kn);ne&&lt.associatedIconIndex>=0&&(He[lt.associatedIconIndex]={x:zt,y:wn,z:Qt,angle:kn})}else $a(Mt,Re)}if(ne){je.clear();const it=b.icon.placedSymbolArray;for(let lt=0;lt<it.length;lt++){const Ct=it.get(lt),{numGlyphs:It}=Ct,Mt=He[lt];if(Ct.hidden||!Mt)$a(It,je);else{const{x:jt,y:Bt,z:Yt,angle:Zn}=Mt;for(let zt=0;zt<It;zt++)l.addDynamicAttributes(je,jt,Bt,Yt,Zn)}}b.icon.dynamicLayoutVertexBuffer.updateData(je)}b.text.dynamicLayoutVertexBuffer.updateData(Re)}function Tf(b,d,v){return v.iconsInText&&d?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Mf(b,d,v,T,C,L,B,U,q,ie,ne,be){const Re=b.context,je=Re.gl,He=b.transform,Ge=U==="map",Xe=q==="map",Ee=Ge&&v.layout.get("symbol-placement")!=="point",Ue=Ge&&!Xe&&!Ee,it=v.layout.get("symbol-sort-key").constantOr(1)!==void 0;let lt=!1;const Ct=b.depthModeForSublayer(0,l.DepthMode.ReadOnly),It=[l.mercatorXfromLng(He.center.lng),l.mercatorYfromLat(He.center.lat)],Mt=v.layout.get("text-variable-anchor"),jt=He.projection.name==="globe",Bt=[],Yt=[0,-1,0];let Zn=Yt;!jt&&!He.mercatorFromTransition||Ge||(Zn=function(zt){const wn=zt._camera.getWorldToCamera(zt.worldSize,1),Qt=l.multiply([],wn,zt.globeMatrix);l.invert(Qt,Qt);const Gn=[0,0,0],$t=[0,1,0,0];return l.transformMat4$1($t,$t,Qt),Gn[0]=$t[0],Gn[1]=$t[1],Gn[2]=$t[2],l.normalize(Gn,Gn),Gn}(He));for(const zt of T){const wn=d.getTile(zt),Qt=wn.getBucket(v);if(!Qt||Qt.projection.name==="mercator"&&jt)continue;const Gn=C?Qt.text:Qt.icon;if(!Gn||Qt.fullyClipped||!Gn.segments.get().length)continue;const $t=Gn.programConfigurations.get(v.id),vn=C||Qt.sdfIcons,Tn=C?Qt.textSizeData:Qt.iconSizeData,kn=Xe||He.pitch!==0,Yn=l.evaluateSizeForZoom(Tn,He.zoom);let Ur,ui,Mr,Xr,ki=[0,0],Ci=null;if(C)ui=wn.glyphAtlasTexture,Mr=je.LINEAR,Ur=wn.glyphAtlasTexture.size,Qt.iconsInText&&(ki=wn.imageAtlasTexture.size,Ci=wn.imageAtlasTexture,Xr=kn||b.options.rotating||b.options.zooming||Tn.kind==="composite"||Tn.kind==="camera"?je.LINEAR:je.NEAREST);else{const Gl=v.layout.get("icon-size").constantOr(0)!==1||Qt.iconsNeedLinear;ui=wn.imageAtlasTexture,Mr=vn||b.options.rotating||b.options.zooming||Gl||kn?je.LINEAR:je.NEAREST,Ur=wn.imageAtlasTexture.size}const Hr=Qt.projection.name==="globe",fs=Hr?Zn:Yt,bs=Hr?l.globeToMercatorTransition(He.zoom):0,Ts=Gt(zt,Qt.getProjection(),He),Os=He.calculatePixelsToTileUnitsMatrix(wn),Ya=Nt(Ts,wn.tileID.canonical,Xe,Ge,He,Qt.getProjection(),Os),Ra=b.terrain&&Xe&&Ee?l.invert(l.create(),Ya):gv,Vl=ns(Ts,wn.tileID.canonical,Xe,Ge,He,Qt.getProjection(),Os),wu=Mt&&Qt.hasTextData(),Hs=v.layout.get("icon-text-fit")!=="none"&&wu&&Qt.hasIconData();if(Ee){const Gl=He.elevation,Ih=Gl?Gl.getAtTileOffsetFunc(zt,He.center.lat,He.worldSize,Qt.getProjection()):null,Lf=ko(Ts,wn.tileID.canonical,Xe,Ge,He,Qt.getProjection(),Os);Uc(Qt,Ts,b,C,Lf,Vl,Xe,ie,Ih,zt)}const Fs=Ee||C&&Mt||Hs,ps=b.translatePosMatrix(Ts,wn,L,B),Go=Fs?gv:Ya,wl=b.translatePosMatrix(Vl,wn,L,B,!0),Ys=Qt.getProjection().createInversionMatrix(He,zt.canonical),iu=[];b.terrainRenderModeElevated()&&Xe&&iu.push("PITCH_WITH_MAP_TERRAIN"),Hr&&iu.push("PROJECTION_GLOBE_VIEW"),Fs&&iu.push("PROJECTED_POS_ON_VIEWPORT");const ag=vn&&v.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let qc;qc=vn?Qt.iconsInText?ts(Tn.kind,Yn,Ue,Xe,b,ps,Go,wl,Ur,ki,zt,bs,It,Ys,fs,Qt.getProjection()):Gc(Tn.kind,Yn,Ue,Xe,b,ps,Go,wl,C,Ur,!0,zt,bs,It,Ys,fs,Qt.getProjection()):s_(Tn.kind,Yn,Ue,Xe,b,ps,Go,wl,C,Ur,zt,bs,It,Ys,fs,Qt.getProjection());const kd={program:b.useProgram(Tf(vn,C,Qt),$t,iu),buffers:Gn,uniformValues:qc,atlasTexture:ui,atlasTextureIcon:Ci,atlasInterpolation:Mr,atlasInterpolationIcon:Xr,isSDF:vn,hasHalo:ag,tile:wn,labelPlaneMatrixInv:Ra};if(it&&Qt.canOverlap){lt=!0;const Gl=Gn.segments.get();for(const Ih of Gl)Bt.push({segments:new l.SegmentVector([Ih]),sortKey:Ih.sortKey,state:kd})}else Bt.push({segments:Gn.segments,sortKey:0,state:kd})}lt&&Bt.sort((zt,wn)=>zt.sortKey-wn.sortKey);for(const zt of Bt){const wn=zt.state;if(b.terrain&&b.terrain.setupElevationDraw(wn.tile,wn.program,{useDepthForOcclusion:!jt,labelPlaneMatrixInv:wn.labelPlaneMatrixInv}),Re.activeTexture.set(je.TEXTURE0),wn.atlasTexture.bind(wn.atlasInterpolation,je.CLAMP_TO_EDGE),wn.atlasTextureIcon&&(Re.activeTexture.set(je.TEXTURE1),wn.atlasTextureIcon&&wn.atlasTextureIcon.bind(wn.atlasInterpolationIcon,je.CLAMP_TO_EDGE)),wn.isSDF){const Qt=wn.uniformValues;wn.hasHalo&&(Qt.u_is_halo=1,ru(wn.buffers,zt.segments,v,b,wn.program,Ct,ne,be,Qt)),Qt.u_is_halo=0}ru(wn.buffers,zt.segments,v,b,wn.program,Ct,ne,be,wn.uniformValues)}}function ru(b,d,v,T,C,L,B,U,q){const ie=T.context,ne=[b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer,b.globeExtVertexBuffer];C.draw(ie,ie.gl.TRIANGLES,L,B,U,l.CullFaceMode.disabled,q,v.id,b.layoutVertexBuffer,b.indexBuffer,d,v.paint,T.transform.zoom,b.programConfigurations.get(v.id),ne)}function l_(b,d,v,T,C,L,B){const U=b.context.gl,q=v.paint.get("fill-pattern"),ie=q&&q.constantOr(1);let ne,be,Re,je,He;B?(be=ie&&!v.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ne=U.LINES):(be=ie?"fillPattern":"fill",ne=U.TRIANGLES);for(const Ge of T){const Xe=d.getTile(Ge);if(ie&&!Xe.patternsLoaded())continue;const Ee=Xe.getBucket(v);if(!Ee)continue;b.prepareDrawTile();const Ue=Ee.programConfigurations.get(v.id),it=b.useProgram(be,Ue);ie&&(b.context.activeTexture.set(U.TEXTURE0),Xe.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Ue.updatePaintBuffers());const lt=q.constantOr(null);if(lt&&Xe.imageAtlas){const It=Xe.imageAtlas.patternPositions[lt.toString()];It&&Ue.setConstantPatternPositions(It)}const Ct=b.translatePosMatrix(Ge.projMatrix,Xe,v.paint.get("fill-translate"),v.paint.get("fill-translate-anchor"));if(B){je=Ee.indexBuffer2,He=Ee.segments2;const It=b.terrain&&b.terrain.renderingToTexture?b.terrain.drapeBufferSize:[U.drawingBufferWidth,U.drawingBufferHeight];Re=be==="fillOutlinePattern"&&ie?mv(Ct,b,Xe,It):xl(Ct,It)}else je=Ee.indexBuffer,He=Ee.segments,Re=ie?vd(Ct,b,Xe):Ul(Ct);b.prepareDrawProgram(b.context,it,Ge.toUnwrapped()),it.draw(b.context,ne,C,b.stencilModeForClipping(Ge),L,l.CullFaceMode.disabled,Re,v.id,Ee.layoutVertexBuffer,je,He,v.paint,b.transform.zoom,Ue)}}function Km(b,d,v,T,C,L,B){const U=b.context,q=U.gl,ie=b.transform,ne=v.paint.get("fill-extrusion-pattern"),be=ne.constantOr(1),Re=v.paint.get("fill-extrusion-opacity"),je=[v.paint.get("fill-extrusion-ambient-occlusion-intensity"),v.paint.get("fill-extrusion-ambient-occlusion-radius")],He=v.layout.get("fill-extrusion-edge-radius"),Ge=He>0&&!v.paint.get("fill-extrusion-rounded-roof"),Xe=Ge?0:He,Ee=ie.projection.name==="globe"?l.fillExtrusionHeightLift():0,Ue=ie.projection.name==="globe",it=Ue?l.globeToMercatorTransition(ie.zoom):0,lt=[l.mercatorXfromLng(ie.center.lng),l.mercatorYfromLat(ie.center.lat)],Ct=[];Ue&&Ct.push("PROJECTION_GLOBE_VIEW"),je[0]>0&&Ct.push("FAUX_AO"),Ge&&Ct.push("ZERO_ROOF_RADIUS");for(const It of T){const Mt=d.getTile(It),jt=Mt.getBucket(v);if(!jt||jt.projection.name!==ie.projection.name)continue;const Bt=jt.programConfigurations.get(v.id),Yt=b.useProgram(be?"fillExtrusionPattern":"fillExtrusion",Bt,Ct);if(b.terrain){const vn=b.terrain;if(b.style.terrainSetForDrapingOnly())vn.setupElevationDraw(Mt,Yt,{useMeterToDem:!0});else{if(!jt.enableTerrain)continue;if(vn.setupElevationDraw(Mt,Yt,{useMeterToDem:!0}),Jm(U,d,It,jt,v,vn),!jt.centroidVertexBuffer){const Tn=Yt.attributes.a_centroid_pos;Tn!==void 0&&q.vertexAttrib2f(Tn,0,0)}}}be&&(b.context.activeTexture.set(q.TEXTURE0),Mt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),Bt.updatePaintBuffers());const Zn=ne.constantOr(null);if(Zn&&Mt.imageAtlas){const vn=Mt.imageAtlas.patternPositions[Zn.toString()];vn&&Bt.setConstantPatternPositions(vn)}const zt=b.translatePosMatrix(It.projMatrix,Mt,v.paint.get("fill-extrusion-translate"),v.paint.get("fill-extrusion-translate-anchor")),wn=ie.projection.createInversionMatrix(ie,It.canonical),Qt=v.paint.get("fill-extrusion-vertical-gradient"),Gn=be?qm(zt,b,Qt,Re,je,Xe,It,Mt,Ee,it,lt,wn):Vo(zt,b,Qt,Re,je,Xe,It,Ee,it,lt,wn);b.prepareDrawProgram(U,Yt,It.toUnwrapped());const $t=[];b.terrain&&$t.push(jt.centroidVertexBuffer),Ue&&$t.push(jt.layoutVertexExtBuffer),Yt.draw(U,U.gl.TRIANGLES,C,L,B,l.CullFaceMode.backCCW,Gn,v.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,v.paint,b.transform.zoom,Bt,$t)}}function Jm(b,d,v,T,C,L){const B=[Ee=>{let Ue=Ee.canonical.x-1,it=Ee.wrap;return Ue<0&&(Ue=(1<<Ee.canonical.z)-1,it--),new l.OverscaledTileID(Ee.overscaledZ,it,Ee.canonical.z,Ue,Ee.canonical.y)},Ee=>{let Ue=Ee.canonical.x+1,it=Ee.wrap;return Ue===1<<Ee.canonical.z&&(Ue=0,it++),new l.OverscaledTileID(Ee.overscaledZ,it,Ee.canonical.z,Ue,Ee.canonical.y)},Ee=>new l.OverscaledTileID(Ee.overscaledZ,Ee.wrap,Ee.canonical.z,Ee.canonical.x,(Ee.canonical.y===0?1<<Ee.canonical.z:Ee.canonical.y)-1),Ee=>new l.OverscaledTileID(Ee.overscaledZ,Ee.wrap,Ee.canonical.z,Ee.canonical.x,Ee.canonical.y===(1<<Ee.canonical.z)-1?0:Ee.canonical.y+1)],U=Ee=>{const Ue=d.getSource().minzoom,it=Ct=>{const It=d.getTileByID(Ct);if(It&&It.hasData())return It.getBucket(C)},lt=[0,-1,1];for(const Ct of lt){if(Ee.overscaledZ+Ct<Ue)continue;const It=it(Ee.calculateScaledKey(Ee.overscaledZ+Ct));if(It)return It}},q=[0,0,0],ie=(Ee,Ue)=>(q[0]=Math.min(Ee.min.y,Ue.min.y),q[1]=Math.max(Ee.max.y,Ue.max.y),q[2]=l.EXTENT-Ue.min.x>Ee.max.x?Ue.min.x-l.EXTENT:Ee.max.x,q),ne=(Ee,Ue)=>(q[0]=Math.min(Ee.min.x,Ue.min.x),q[1]=Math.max(Ee.max.x,Ue.max.x),q[2]=l.EXTENT-Ue.min.y>Ee.max.y?Ue.min.y-l.EXTENT:Ee.max.y,q),be=[(Ee,Ue)=>ie(Ee,Ue),(Ee,Ue)=>ie(Ue,Ee),(Ee,Ue)=>ne(Ee,Ue),(Ee,Ue)=>ne(Ue,Ee)],Re=new l.Point(0,0);let je,He,Ge;const Xe=(Ee,Ue,it,lt,Ct)=>{const It=[[lt?it:Ee,lt?Ee:it,0],[lt?it:Ue,lt?Ue:it,0]],Mt=Ct<0?l.EXTENT+Ct:Ct,jt=[lt?Mt:(Ee+Ue)/2,lt?(Ee+Ue)/2:Mt,0];return it===0&&Ct<0||it!==0&&Ct>0?L.getForTilePoints(Ge,[jt],!0,He):It.push(jt),L.getForTilePoints(v,It,!0,je),Math.max(It[0][2],It[1][2],jt[2])/L.exaggeration()};for(let Ee=0;Ee<4;Ee++){const Ue=(Ee<2?1:5)-Ee,it=T.borders[Ee];if(it.length===0)continue;const lt=Ge=B[Ee](v),Ct=U(lt);if(!(Ct&&Ct instanceof l.FillExtrusionBucket&&Ct.enableTerrain)||T.borderDoneWithNeighborZ[Ee]===Ct.canonical.z&&Ct.borderDoneWithNeighborZ[Ue]===T.canonical.z||(He=L.findDEMTileFor(lt),!He||!He.dem))continue;if(!je){const Bt=L.findDEMTileFor(v);if(!Bt||!Bt.dem)return;je=Bt}const It=Ct.borders[Ue];let Mt=0;const jt=Ct.borderDoneWithNeighborZ[Ue]!==T.canonical.z;if(T.canonical.z===Ct.canonical.z){for(let Bt=0;Bt<it.length;Bt++){const Yt=T.featuresOnBorder[it[Bt]],Zn=Yt.borders[Ee];let zt;for(;Mt<It.length&&(zt=Ct.featuresOnBorder[It[Mt]],!(zt.borders[Ue][1]>Zn[0]+3));)jt&&Ct.encodeCentroid(void 0,zt,!1),Mt++;if(zt&&Mt<It.length){const wn=Mt;let Qt=0;for(;!(zt.borders[Ue][0]>Zn[1]-3)&&(Qt++,++Mt!==It.length);)zt=Ct.featuresOnBorder[It[Mt]];if(zt=Ct.featuresOnBorder[It[wn]],Yt.intersectsCount()>1||zt.intersectsCount()>1||Qt!==1){Qt!==1&&(Mt=wn),T.encodeCentroid(void 0,Yt,!1),jt&&Ct.encodeCentroid(void 0,zt,!1);continue}const Gn=be[Ee](Yt,zt),$t=Ee%2?l.EXTENT-1:0;Re.x=Xe(Gn[0],Math.min(l.EXTENT-1,Gn[1]),$t,Ee<2,Gn[2]),Re.y=0,T.encodeCentroid(Re,Yt,!1),jt&&Ct.encodeCentroid(Re,zt,!1)}else T.encodeCentroid(void 0,Yt,!1)}T.borderDoneWithNeighborZ[Ee]=Ct.canonical.z,T.needsCentroidUpdate=!0,jt&&(Ct.borderDoneWithNeighborZ[Ue]=T.canonical.z,Ct.needsCentroidUpdate=!0)}else{for(const Bt of it)T.encodeCentroid(void 0,T.featuresOnBorder[Bt],!1);if(jt){for(const Bt of It)Ct.encodeCentroid(void 0,Ct.featuresOnBorder[Bt],!1);Ct.borderDoneWithNeighborZ[Ue]=T.canonical.z,Ct.needsCentroidUpdate=!0}T.borderDoneWithNeighborZ[Ee]=Ct.canonical.z,T.needsCentroidUpdate=!0}}(T.needsCentroidUpdate||!T.centroidVertexBuffer&&T.centroidVertexArray.length!==0)&&T.uploadCentroid(b)}const jl=new l.Color(1,0,0,1),u_=new l.Color(0,1,0,1),Qm=new l.Color(0,0,1,1),yv=new l.Color(1,0,1,1),h0=new l.Color(0,1,1,1);function _v(b,d,v){const T=b.context,C=b.transform,L=T.gl,B=C.projection.name==="globe",U=B?["PROJECTION_GLOBE_VIEW"]:null;let q=v.projMatrix;if(B&&l.globeToMercatorTransition(C.zoom)>0){const Yt=l.transitionTileAABBinECEF(v.canonical,C),Zn=l.globeDenormalizeECEF(Yt);q=l.multiply(new Float32Array(16),C.globeMatrix,Zn),l.multiply(q,C.projMatrix,q)}const ie=b.useProgram("debug",null,U),ne=d.getTileByID(v.key);b.terrain&&b.terrain.setupElevationDraw(ne,ie);const be=l.DepthMode.disabled,Re=l.StencilMode.disabled,je=b.colorModeForRenderPass(),He="$debug";T.activeTexture.set(L.TEXTURE0),b.emptyTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),B?ne._makeGlobeTileDebugBuffers(b.context,C):ne._makeDebugTileBoundsBuffers(b.context,C.projection);const Ge=ne._tileDebugBuffer||b.debugBuffer,Xe=ne._tileDebugIndexBuffer||b.debugIndexBuffer,Ee=ne._tileDebugSegments||b.debugSegments;ie.draw(T,L.LINE_STRIP,be,Re,je,l.CullFaceMode.disabled,Ef(q,l.Color.red),He,Ge,Xe,Ee,null,null,null,[ne._globeTileDebugBorderBuffer]);const Ue=ne.latestRawTileData,it=Math.floor((Ue&&Ue.byteLength||0)/1024),lt=d.getTile(v).tileSize,Ct=512/Math.min(lt,512)*(v.overscaledZ/C.zoom)*.5;let It=v.canonical.toString();v.overscaledZ!==v.canonical.z&&(It+=` => ${v.overscaledZ}`),It+=` ${it}kb`,function(Yt,Zn){Yt.initDebugOverlayCanvas();const zt=Yt.debugOverlayCanvas,wn=Yt.context.gl,Qt=Yt.debugOverlayCanvas.getContext("2d");Qt.clearRect(0,0,zt.width,zt.height),Qt.shadowColor="white",Qt.shadowBlur=2,Qt.lineWidth=1.5,Qt.strokeStyle="white",Qt.textBaseline="top",Qt.font="bold 36px Open Sans, sans-serif",Qt.fillText(Zn,5,5),Qt.strokeText(Zn,5,5),Yt.debugOverlayTexture.update(zt),Yt.debugOverlayTexture.bind(wn.LINEAR,wn.CLAMP_TO_EDGE)}(b,It);const Mt=ne._tileDebugTextBuffer||b.debugBuffer,jt=ne._tileDebugTextIndexBuffer||b.quadTriangleIndexBuffer,Bt=ne._tileDebugTextSegments||b.debugSegments;ie.draw(T,L.TRIANGLES,be,Re,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,Ef(q,l.Color.transparent,Ct),He,Mt,jt,Bt,null,null,null,[ne._globeTileDebugTextBuffer])}function d0(b,d,v,T){mc(b,0,d+v/2,b.transform.width,v,T)}function Hc(b,d,v,T){mc(b,d-v/2,0,v,b.transform.height,T)}function mc(b,d,v,T,C,L){const B=b.context,U=B.gl;U.enable(U.SCISSOR_TEST),U.scissor(d*l.exported.devicePixelRatio,v*l.exported.devicePixelRatio,T*l.exported.devicePixelRatio,C*l.exported.devicePixelRatio),B.clear({color:L}),U.disable(U.SCISSOR_TEST)}const c_=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:h_}=c_;function Mh(b,d,v,T){b.emplaceBack(d,v,T)}class f0{constructor(d){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,Mh(this.vertexArray,-1,-1,1),Mh(this.vertexArray,1,-1,1),Mh(this.vertexArray,-1,1,1),Mh(this.vertexArray,1,1,1),Mh(this.vertexArray,-1,-1,-1),Mh(this.vertexArray,1,-1,-1),Mh(this.vertexArray,-1,1,-1),Mh(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=d.createVertexBuffer(this.vertexArray,h_),this.indexBuffer=d.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function bu(b,d,v,T,C,L){const B=b.gl,U=d.paint.get("sky-atmosphere-color"),q=d.paint.get("sky-atmosphere-halo-color"),ie=d.paint.get("sky-atmosphere-sun-intensity"),ne=((be,Re,je,He,Ge)=>({u_matrix_3f:be,u_sun_direction:Re,u_sun_intensity:je,u_color_tint_r:[He.r,He.g,He.b,He.a],u_color_tint_m:[Ge.r,Ge.g,Ge.b,Ge.a],u_luminance:5e-5}))(l.fromMat4(l.create$1(),T),C,ie,U,q);B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+L,d.skyboxTexture,0),v.draw(b,B.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,ne,"skyboxCapture",d.skyboxGeometry.vertexBuffer,d.skyboxGeometry.indexBuffer,d.skyboxGeometry.segment)}const bd=l.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class d_{constructor(d){const v=new l.StructArrayLayout5f20;v.emplaceBack(-1,1,1,0,0),v.emplaceBack(1,1,1,1,0),v.emplaceBack(1,-1,1,1,1),v.emplaceBack(-1,-1,1,0,1);const T=new l.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,3,0),this.vertexBuffer=d.createVertexBuffer(v,bd.members),this.indexBuffer=d.createIndexBuffer(T),this.segments=l.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const wd={symbol:function(b,d,v,T,C){if(b.renderPass!=="translucent")return;const L=l.StencilMode.disabled,B=b.colorModeForRenderPass();v.layout.get("text-variable-anchor")&&function(U,q,ie,ne,be,Re,je){const He=q.transform,Ge=be==="map",Xe=Re==="map";for(const Ee of U){const Ue=ne.getTile(Ee),it=Ue.getBucket(ie);if(!it||!it.text||!it.text.segments.get().length)continue;const lt=l.evaluateSizeForZoom(it.textSizeData,He.zoom),Ct=Gt(Ee,it.getProjection(),He),It=He.calculatePixelsToTileUnitsMatrix(Ue),Mt=Nt(Ct,Ue.tileID.canonical,Xe,Ge,He,it.getProjection(),It),jt=ie.layout.get("icon-text-fit")!=="none"&&it.hasIconData();if(lt){const Bt=Math.pow(2,He.zoom-Ue.tileID.overscaledZ);m3(it,Ge,Xe,je,l.symbolSize,He,Mt,Ee,Bt,lt,jt)}}}(T,b,v,d,v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),C),v.paint.get("icon-opacity").constantOr(1)!==0&&Mf(b,d,v,T,!1,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),v.layout.get("icon-rotation-alignment"),v.layout.get("icon-pitch-alignment"),v.layout.get("icon-keep-upright"),L,B),v.paint.get("text-opacity").constantOr(1)!==0&&Mf(b,d,v,T,!0,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),v.layout.get("text-rotation-alignment"),v.layout.get("text-pitch-alignment"),v.layout.get("text-keep-upright"),L,B),d.map.showCollisionBoxes&&(Ym(b,d,v,T,v.paint.get("text-translate"),v.paint.get("text-translate-anchor"),!0),Ym(b,d,v,T,v.paint.get("icon-translate"),v.paint.get("icon-translate-anchor"),!1))},circle:function(b,d,v,T){if(b.renderPass!=="translucent")return;const C=v.paint.get("circle-opacity"),L=v.paint.get("circle-stroke-width"),B=v.paint.get("circle-stroke-opacity"),U=v.layout.get("circle-sort-key").constantOr(1)!==void 0;if(C.constantOr(1)===0&&(L.constantOr(1)===0||B.constantOr(1)===0))return;const q=b.context,ie=q.gl,ne=b.transform,be=b.depthModeForSublayer(0,l.DepthMode.ReadOnly),Re=l.StencilMode.disabled,je=b.colorModeForRenderPass(),He=ne.projection.name==="globe",Ge=[l.mercatorXfromLng(ne.center.lng),l.mercatorYfromLat(ne.center.lat)],Xe=[];for(let Ue=0;Ue<T.length;Ue++){const it=T[Ue],lt=d.getTile(it),Ct=lt.getBucket(v);if(!Ct||Ct.projection.name!==ne.projection.name)continue;const It=Ct.programConfigurations.get(v.id),Mt=ga(v);He&&Mt.push("PROJECTION_GLOBE_VIEW");const jt=b.useProgram("circle",It,Mt),Bt=Ct.layoutVertexBuffer,Yt=Ct.globeExtVertexBuffer,Zn=Ct.indexBuffer,zt=ne.projection.createInversionMatrix(ne,it.canonical),wn={programConfiguration:It,program:jt,layoutVertexBuffer:Bt,globeExtVertexBuffer:Yt,indexBuffer:Zn,uniformValues:wf(b,it,lt,zt,Ge,v),tile:lt};if(U){const Qt=Ct.segments.get();for(const Gn of Qt)Xe.push({segments:new l.SegmentVector([Gn]),sortKey:Gn.sortKey,state:wn})}else Xe.push({segments:Ct.segments,sortKey:0,state:wn})}U&&Xe.sort((Ue,it)=>Ue.sortKey-it.sortKey);const Ee={useDepthForOcclusion:!He};for(const Ue of Xe){const{programConfiguration:it,program:lt,layoutVertexBuffer:Ct,globeExtVertexBuffer:It,indexBuffer:Mt,uniformValues:jt,tile:Bt}=Ue.state,Yt=Ue.segments;b.terrain&&b.terrain.setupElevationDraw(Bt,lt,Ee),b.prepareDrawProgram(q,lt,Bt.tileID.toUnwrapped()),lt.draw(q,ie.TRIANGLES,be,Re,je,l.CullFaceMode.disabled,jt,v.id,Ct,Mt,Yt,v.paint,ne.zoom,it,[It])}},heatmap:function(b,d,v,T){if(v.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const C=b.context,L=C.gl,B=l.StencilMode.disabled,U=new l.ColorMode([L.ONE,L.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(je,He,Ge,Xe){const Ee=je.gl,Ue=He.width*Xe,it=He.height*Xe;je.activeTexture.set(Ee.TEXTURE1),je.viewport.set([0,0,Ue,it]);let lt=Ge.heatmapFbo;if(!lt||lt&&(lt.width!==Ue||lt.height!==it)){lt&&lt.destroy();const Ct=Ee.createTexture();Ee.bindTexture(Ee.TEXTURE_2D,Ct),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_WRAP_S,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_WRAP_T,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_MIN_FILTER,Ee.LINEAR),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_MAG_FILTER,Ee.LINEAR),lt=Ge.heatmapFbo=je.createFramebuffer(Ue,it,!1),function(It,Mt,jt,Bt,Yt,Zn){const zt=It.gl;zt.texImage2D(zt.TEXTURE_2D,0,It.isWebGL2&&It.extRenderToTextureHalfFloat?zt.RGBA16F:zt.RGBA,Yt,Zn,0,zt.RGBA,It.extRenderToTextureHalfFloat?It.isWebGL2?zt.HALF_FLOAT:It.extTextureHalfFloat.HALF_FLOAT_OES:zt.UNSIGNED_BYTE,null),Bt.colorAttachment.set(jt)}(je,0,Ct,lt,Ue,it)}else Ee.bindTexture(Ee.TEXTURE_2D,lt.colorAttachment.get()),je.bindFramebuffer.set(lt.framebuffer)})(C,b,v,b.transform.projection.name==="globe"?.5:.25),C.clear({color:l.Color.transparent});const q=b.transform,ie=q.projection.name==="globe",ne=ie?["PROJECTION_GLOBE_VIEW"]:null,be=ie?l.CullFaceMode.frontCCW:l.CullFaceMode.disabled,Re=[l.mercatorXfromLng(q.center.lng),l.mercatorYfromLat(q.center.lat)];for(let je=0;je<T.length;je++){const He=T[je];if(d.hasRenderableParent(He))continue;const Ge=d.getTile(He),Xe=Ge.getBucket(v);if(!Xe||Xe.projection.name!==q.projection.name)continue;const Ee=Xe.programConfigurations.get(v.id),Ue=b.useProgram("heatmap",Ee,ne),{zoom:it}=b.transform;b.terrain&&b.terrain.setupElevationDraw(Ge,Ue),b.prepareDrawProgram(C,Ue,He.toUnwrapped());const lt=q.projection.createInversionMatrix(q,He.canonical);Ue.draw(C,L.TRIANGLES,l.DepthMode.disabled,B,U,be,$m(b,He,Ge,lt,Re,it,v.paint.get("heatmap-intensity")),v.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,v.paint,b.transform.zoom,Ee,ie?[Xe.globeExtVertexBuffer]:null)}C.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(C,L){const B=C.context,U=B.gl,q=L.heatmapFbo;if(!q)return;B.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,q.colorAttachment.get()),B.activeTexture.set(U.TEXTURE1);let ie=L.colorRampTexture;ie||(ie=L.colorRampTexture=new l.Texture(B,L.colorRamp,U.RGBA)),ie.bind(U.LINEAR,U.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(B,U.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,C.colorModeForRenderPass(),l.CullFaceMode.disabled,((ne,be,Re,je)=>({u_image:0,u_color_ramp:1,u_opacity:be.paint.get("heatmap-opacity")}))(0,L),L.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,L.paint,C.transform.zoom)}(b,v))},line:function(b,d,v,T){if(b.renderPass!=="translucent")return;const C=v.paint.get("line-opacity"),L=v.paint.get("line-width");if(C.constantOr(1)===0||L.constantOr(1)===0)return;const B=b.depthModeForSublayer(0,l.DepthMode.ReadOnly),U=b.colorModeForRenderPass(),q=b.terrain&&b.terrain.renderingToTexture?1:l.exported.devicePixelRatio,ie=v.paint.get("line-dasharray"),ne=ie.constantOr(1),be=v.layout.get("line-cap"),Re=v.paint.get("line-pattern"),je=Re.constantOr(1),He=v.paint.get("line-gradient"),Ge=je?"linePattern":"line",Xe=b.context,Ee=Xe.gl,Ue=(lt=>{const Ct=[];Vc(lt)&&Ct.push("RENDER_LINE_DASH"),lt.paint.get("line-gradient")&&Ct.push("RENDER_LINE_GRADIENT");const It=lt.paint.get("line-trim-offset");It[0]===0&&It[1]===0||Ct.push("RENDER_LINE_TRIM_OFFSET");const Mt=lt.paint.get("line-pattern").constantOr(1),jt=lt.paint.get("line-opacity").constantOr(1)!==1;return!Mt&&jt&&Ct.push("RENDER_LINE_ALPHA_DISCARD"),Ct})(v);let it=Ue.includes("RENDER_LINE_ALPHA_DISCARD");b.terrain&&b.terrain.clipOrMaskOverlapStencilType()&&(it=!1);for(const lt of T){const Ct=d.getTile(lt);if(je&&!Ct.patternsLoaded())continue;const It=Ct.getBucket(v);if(!It)continue;b.prepareDrawTile();const Mt=It.programConfigurations.get(v.id),jt=b.useProgram(Ge,Mt,Ue),Bt=Re.constantOr(null);if(Bt&&Ct.imageAtlas){const vn=Ct.imageAtlas.patternPositions[Bt.toString()];vn&&Mt.setConstantPatternPositions(vn)}const Yt=ie.constantOr(null),Zn=be.constantOr(null);if(!je&&Yt&&Zn&&Ct.lineAtlas){const vn=Ct.lineAtlas.getDash(Yt,Zn);vn&&Mt.setConstantPatternPositions(vn)}let[zt,wn]=v.paint.get("line-trim-offset");(Zn==="round"||Zn==="square")&&zt!==wn&&(zt===0&&(zt-=1),wn===1&&(wn+=1));const Qt=b.terrain?lt.projMatrix:null,Gn=je?Xm(b,Ct,v,Qt,q):i_(b,Ct,v,Qt,It.lineClipsArray.length,q,[zt,wn]);if(He){const vn=It.gradients[v.id];let Tn=vn.texture;if(v.gradientVersion!==vn.version){let kn=256;if(v.stepInterpolant){const Yn=d.getSource().maxzoom,Ur=lt.canonical.z===Yn?Math.ceil(1<<b.transform.maxZoom-lt.canonical.z):1;kn=l.clamp(l.nextPowerOfTwo(It.maxLineLength/l.EXTENT*1024*Ur),256,Xe.maxTextureSize)}vn.gradient=l.renderColorRamp({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:vn.gradient||void 0,clips:It.lineClipsArray}),vn.texture?vn.texture.update(vn.gradient):vn.texture=new l.Texture(Xe,vn.gradient,Ee.RGBA),vn.version=v.gradientVersion,Tn=vn.texture}Xe.activeTexture.set(Ee.TEXTURE1),Tn.bind(v.stepInterpolant?Ee.NEAREST:Ee.LINEAR,Ee.CLAMP_TO_EDGE)}ne&&(Xe.activeTexture.set(Ee.TEXTURE0),Ct.lineAtlasTexture.bind(Ee.LINEAR,Ee.REPEAT),Mt.updatePaintBuffers()),je&&(Xe.activeTexture.set(Ee.TEXTURE0),Ct.imageAtlasTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE),Mt.updatePaintBuffers()),b.prepareDrawProgram(Xe,jt,lt.toUnwrapped());const $t=vn=>{jt.draw(Xe,Ee.TRIANGLES,B,vn,U,l.CullFaceMode.disabled,Gn,v.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,v.paint,b.transform.zoom,Mt,[It.layoutVertexBuffer2])};if(it){const vn=b.stencilModeForClipping(lt).ref;vn===0&&b.terrain&&Xe.clear({stencil:0});const Tn={func:Ee.EQUAL,mask:255};Gn.u_alpha_discard_threshold=.8,$t(new l.StencilMode(Tn,vn,255,Ee.KEEP,Ee.KEEP,Ee.INVERT)),Gn.u_alpha_discard_threshold=0,$t(new l.StencilMode(Tn,vn,255,Ee.KEEP,Ee.KEEP,Ee.KEEP))}else $t(b.stencilModeForClipping(lt))}it&&(b.resetStencilClippingMasks(),b.terrain&&Xe.clear({stencil:0}))},fill:function(b,d,v,T){const C=v.paint.get("fill-color"),L=v.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const B=b.colorModeForRenderPass(),U=v.paint.get("fill-pattern"),q=b.opaquePassEnabledForLayer()&&!U.constantOr(1)&&C.constantOr(l.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===q){const ie=b.depthModeForSublayer(1,b.renderPass==="opaque"?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);l_(b,d,v,T,ie,B,!1)}if(b.renderPass==="translucent"&&v.paint.get("fill-antialias")){const ie=b.depthModeForSublayer(v.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);l_(b,d,v,T,ie,B,!0)}},"fill-extrusion":function(b,d,v,T){const C=v.paint.get("fill-extrusion-opacity");if(C!==0&&b.renderPass==="translucent"){const L=new l.DepthMode(b.context.gl.LEQUAL,l.DepthMode.ReadWrite,b.depthRangeFor3D);if(C!==1||v.paint.get("fill-extrusion-pattern").constantOr(1))Km(b,d,v,T,L,l.StencilMode.disabled,l.ColorMode.disabled),Km(b,d,v,T,L,b.stencilModeFor3D(),b.colorModeForRenderPass()),b.resetStencilClippingMasks();else{const B=b.colorModeForRenderPass();Km(b,d,v,T,L,l.StencilMode.disabled,B)}}},hillshade:function(b,d,v,T){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const C=b.context,L=b.depthModeForSublayer(0,l.DepthMode.ReadOnly),B=b.colorModeForRenderPass(),U=b.terrain&&b.terrain.renderingToTexture,[q,ie]=b.renderPass!=="translucent"||U?[{},T]:b.stencilConfigForOverlap(T);for(const ne of ie){const be=d.getTile(ne);if(be.needsHillshadePrepare&&b.renderPass==="offscreen")bi(b,be,v,L,l.StencilMode.disabled,B);else if(b.renderPass==="translucent"){const Re=U&&b.terrain?b.terrain.stencilModeForRTTOverlap(ne):q[ne.overscaledZ];Cp(b,ne,be,v,L,Re,B)}}C.viewport.set([0,0,b.width,b.height]),b.resetStencilClippingMasks()},raster:function(b,d,v,T,C,L){if(b.renderPass!=="translucent"||v.paint.get("raster-opacity")===0||!T.length)return;const B=b.context,U=B.gl,q=d.getSource(),ie=b.useProgram("raster"),ne=b.colorModeForRenderPass(),be=b.terrain&&b.terrain.renderingToTexture,[Re,je]=q instanceof Cr||be?[{},T]:b.stencilConfigForOverlap(T),He=je[je.length-1].overscaledZ,Ge=!b.options.moving;for(const Xe of je){const Ee=be?l.DepthMode.disabled:b.depthModeForSublayer(Xe.overscaledZ-He,v.paint.get("raster-opacity")===1?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,U.LESS),Ue=Xe.toUnwrapped(),it=d.getTile(Xe);if(be&&(!it||!it.hasData()))continue;const lt=be?Xe.projMatrix:b.transform.calculateProjMatrix(Ue,Ge),Ct=b.terrain&&be?b.terrain.stencilModeForRTTOverlap(Xe):Re[Xe.overscaledZ],It=L?0:v.paint.get("raster-fade-duration");it.registerFadeDuration(It);const Mt=d.findLoadedParent(Xe,0),jt=Lp(it,Mt,d,b.transform,It);let Bt,Yt;b.terrain&&b.terrain.prepareDrawTile();const Zn=v.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;B.activeTexture.set(U.TEXTURE0),it.texture.bind(Zn,U.CLAMP_TO_EDGE),B.activeTexture.set(U.TEXTURE1),Mt?(Mt.texture.bind(Zn,U.CLAMP_TO_EDGE),Bt=Math.pow(2,Mt.tileID.overscaledZ-it.tileID.overscaledZ),Yt=[it.tileID.canonical.x*Bt%1,it.tileID.canonical.y*Bt%1]):it.texture.bind(Zn,U.CLAMP_TO_EDGE),it.texture.useMipmap&&B.extTextureFilterAnisotropic&&b.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const zt=Dp(lt,Yt||[0,0],Bt||1,jt,v,q instanceof Cr?q.perspectiveTransform:[0,0]);if(b.prepareDrawProgram(B,ie,Ue),q instanceof Cr)q.boundsBuffer&&q.boundsSegments&&ie.draw(B,U.TRIANGLES,Ee,l.StencilMode.disabled,ne,l.CullFaceMode.disabled,zt,v.id,q.boundsBuffer,b.quadTriangleIndexBuffer,q.boundsSegments);else{const{tileBoundsBuffer:wn,tileBoundsIndexBuffer:Qt,tileBoundsSegments:Gn}=b.getTileBoundsBuffers(it);ie.draw(B,U.TRIANGLES,Ee,Ct,ne,l.CullFaceMode.disabled,zt,v.id,wn,Qt,Gn)}}b.resetStencilClippingMasks()},background:function(b,d,v,T){const C=v.paint.get("background-color"),L=v.paint.get("background-opacity");if(L===0)return;const B=b.context,U=B.gl,q=b.transform,ie=q.tileSize,ne=v.paint.get("background-pattern");if(b.isPatternMissing(ne))return;const be=!ne&&C.a===1&&L===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==be)return;const Re=l.StencilMode.disabled,je=b.depthModeForSublayer(0,be==="opaque"?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),He=b.colorModeForRenderPass(),Ge=b.useProgram(ne?"backgroundPattern":"background");let Xe,Ee=T;Ee||(Xe=b.getBackgroundTiles(),Ee=Object.values(Xe).map(Ue=>Ue.tileID)),ne&&(B.activeTexture.set(U.TEXTURE0),b.imageManager.bind(b.context));for(const Ue of Ee){const it=Ue.toUnwrapped(),lt=T?Ue.projMatrix:b.transform.calculateProjMatrix(it);b.prepareDrawTile();const Ct=d?d.getTile(Ue):Xe?Xe[Ue.key]:new l.Tile(Ue,ie,q.zoom,b),It=ne?pc(lt,L,b,ne,{tileID:Ue,tileSize:ie}):Lr(lt,L,C);b.prepareDrawProgram(B,Ge,it);const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:jt,tileBoundsSegments:Bt}=b.getTileBoundsBuffers(Ct);Ge.draw(B,U.TRIANGLES,je,Re,He,l.CullFaceMode.disabled,It,v.id,Mt,jt,Bt)}},sky:function(b,d,v){const T=b.transform,C=T.projection.name==="mercator"||T.projection.name==="globe"?1:l.smoothstep(7,8,T.zoom),L=v.paint.get("sky-opacity")*C;if(L===0)return;const B=b.context,U=v.paint.get("sky-type"),q=new l.DepthMode(B.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),ie=b.frameCounter/1e3%1;U==="atmosphere"?b.renderPass==="offscreen"?v.needsSkyboxCapture(b)&&(function(ne,be,Re,je){const He=ne.context,Ge=He.gl;let Xe=be.skyboxFbo;if(!Xe){Xe=be.skyboxFbo=He.createFramebuffer(32,32,!1),be.skyboxGeometry=new f0(He),be.skyboxTexture=He.gl.createTexture(),Ge.bindTexture(Ge.TEXTURE_CUBE_MAP,be.skyboxTexture),Ge.texParameteri(Ge.TEXTURE_CUBE_MAP,Ge.TEXTURE_WRAP_S,Ge.CLAMP_TO_EDGE),Ge.texParameteri(Ge.TEXTURE_CUBE_MAP,Ge.TEXTURE_WRAP_T,Ge.CLAMP_TO_EDGE),Ge.texParameteri(Ge.TEXTURE_CUBE_MAP,Ge.TEXTURE_MIN_FILTER,Ge.LINEAR),Ge.texParameteri(Ge.TEXTURE_CUBE_MAP,Ge.TEXTURE_MAG_FILTER,Ge.LINEAR);for(let lt=0;lt<6;++lt)Ge.texImage2D(Ge.TEXTURE_CUBE_MAP_POSITIVE_X+lt,0,Ge.RGBA,32,32,0,Ge.RGBA,Ge.UNSIGNED_BYTE,null)}He.bindFramebuffer.set(Xe.framebuffer),He.viewport.set([0,0,32,32]);const Ee=be.getCenter(ne,!0),Ue=ne.useProgram("skyboxCapture"),it=new Float64Array(16);l.identity(it),l.rotateY(it,it,.5*-Math.PI),bu(He,be,Ue,it,Ee,0),l.identity(it),l.rotateY(it,it,.5*Math.PI),bu(He,be,Ue,it,Ee,1),l.identity(it),l.rotateX(it,it,.5*-Math.PI),bu(He,be,Ue,it,Ee,2),l.identity(it),l.rotateX(it,it,.5*Math.PI),bu(He,be,Ue,it,Ee,3),l.identity(it),bu(He,be,Ue,it,Ee,4),l.identity(it),l.rotateY(it,it,Math.PI),bu(He,be,Ue,it,Ee,5),He.viewport.set([0,0,ne.width,ne.height])}(b,v),v.markSkyboxValid(b)):b.renderPass==="sky"&&function(ne,be,Re,je,He){const Ge=ne.context,Xe=Ge.gl,Ee=ne.transform,Ue=ne.useProgram("skybox");Ge.activeTexture.set(Xe.TEXTURE0),Xe.bindTexture(Xe.TEXTURE_CUBE_MAP,be.skyboxTexture);const it=((lt,Ct,It,Mt,jt)=>({u_matrix:lt,u_sun_direction:Ct,u_cubemap:0,u_opacity:Mt,u_temporal_offset:jt}))(Ee.skyboxMatrix,be.getCenter(ne,!1),0,je,He);ne.prepareDrawProgram(Ge,Ue),Ue.draw(Ge,Xe.TRIANGLES,Re,l.StencilMode.disabled,ne.colorModeForRenderPass(),l.CullFaceMode.backCW,it,"skybox",be.skyboxGeometry.vertexBuffer,be.skyboxGeometry.indexBuffer,be.skyboxGeometry.segment)}(b,v,q,L,ie):U==="gradient"&&b.renderPass==="sky"&&function(ne,be,Re,je,He){const Ge=ne.context,Xe=Ge.gl,Ee=ne.transform,Ue=ne.useProgram("skyboxGradient");be.skyboxGeometry||(be.skyboxGeometry=new f0(Ge)),Ge.activeTexture.set(Xe.TEXTURE0);let it=be.colorRampTexture;it||(it=be.colorRampTexture=new l.Texture(Ge,be.colorRamp,Xe.RGBA)),it.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE);const lt=((Ct,It,Mt,jt,Bt)=>({u_matrix:Ct,u_color_ramp:0,u_center_direction:It,u_radius:l.degToRad(Mt),u_opacity:jt,u_temporal_offset:Bt}))(Ee.skyboxMatrix,be.getCenter(ne,!1),be.paint.get("sky-gradient-radius"),je,He);ne.prepareDrawProgram(Ge,Ue),Ue.draw(Ge,Xe.TRIANGLES,Re,l.StencilMode.disabled,ne.colorModeForRenderPass(),l.CullFaceMode.backCW,lt,"skyboxGradient",be.skyboxGeometry.vertexBuffer,be.skyboxGeometry.indexBuffer,be.skyboxGeometry.segment)}(b,v,q,L,ie)},debug:function(b,d,v){for(let T=0;T<v.length;T++)_v(b,d,v[T])},custom:function(b,d,v,T){const C=b.context,L=v.implementation;if(!b.transform.projection.unsupportedLayers||!b.transform.projection.unsupportedLayers.includes("custom")||b.terrain&&(b.terrain.renderingToTexture||b.renderPass==="offscreen")&&v.isLayerDraped()){if(b.renderPass==="offscreen"){const B=L.prerender;if(B){if(b.setCustomLayerDefaults(),C.setColorMode(b.colorModeForRenderPass()),b.transform.projection.name==="globe"){const U=b.transform.pointMerc;B.call(L,C.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(b.transform.zoom),[U.x,U.y],b.transform.pixelsPerMeterRatio)}else B.call(L,C.gl,b.transform.customLayerMatrix());C.setDirty(),b.setBaseState()}}else if(b.renderPass==="translucent"){if(b.terrain&&b.terrain.renderingToTexture){const U=L.renderToTile;if(U){const q=T[0].canonical,ie=new l.MercatorCoordinate(q.x+T[0].wrap*(1<<q.z),q.y,q.z);C.setDepthMode(l.DepthMode.disabled),C.setStencilMode(l.StencilMode.disabled),C.setColorMode(b.colorModeForRenderPass()),b.setCustomLayerDefaults(),U.call(L,C.gl,ie),C.setDirty(),b.setBaseState()}return}b.setCustomLayerDefaults(),C.setColorMode(b.colorModeForRenderPass()),C.setStencilMode(l.StencilMode.disabled);const B=L.renderingMode==="3d"?new l.DepthMode(b.context.gl.LEQUAL,l.DepthMode.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,l.DepthMode.ReadOnly);if(C.setDepthMode(B),b.transform.projection.name==="globe"){const U=b.transform.pointMerc;L.render(C.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(b.transform.zoom),[U.x,U.y],b.transform.pixelsPerMeterRatio)}else L.render(C.gl,b.transform.customLayerMatrix());C.setDirty(),b.setBaseState(),C.bindFramebuffer.set(null)}}else l.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Ed{constructor(d,v,T=!1){this.context=new fn(d,T),this.transform=v,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(d,v){const T=!!d&&!!d.terrain&&this.transform.projection.supportsTerrain;if(!(T||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Rp(this,d));const C=this._terrain;this.transform.elevation=T?C:null,C.update(d,this.transform,v)}_updateFog(d){const v=d.fog;if(!v||this.transform.projection.name==="globe"||v.getOpacity(this.transform.pitch)<1||v.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[T,C]=v.getFovAdjustedRange(this.transform._fov);if(T>C)return void(this.transform.fogCullDistSq=null);const L=T+.78*(C-T);this.transform.fogCullDistSq=L*L}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(d,v){if(this.width=d*l.exported.devicePixelRatio,this.height=v*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const T of this.style.order)this.style._layers[T].resize()}setup(){const d=this.context,v=new l.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(l.EXTENT,0),v.emplaceBack(0,l.EXTENT),v.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(v,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const T=new l.StructArrayLayout2i4;T.emplaceBack(0,0),T.emplaceBack(l.EXTENT,0),T.emplaceBack(0,l.EXTENT),T.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=d.createVertexBuffer(T,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const C=new l.StructArrayLayout2i4;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(-1,1),C.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(C,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const L=new l.StructArrayLayout4i8;L.emplaceBack(0,0,0,0),L.emplaceBack(l.EXTENT,0,l.EXTENT,0),L.emplaceBack(0,l.EXTENT,0,l.EXTENT),L.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.mercatorBoundsBuffer=d.createVertexBuffer(L,l.boundsAttributes.members),this.mercatorBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const B=new l.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(B);const U=new l.StructArrayLayout1ui2;for(const ie of[0,1,3,2,0])U.emplaceBack(ie);this.debugIndexBuffer=d.createIndexBuffer(U),this.emptyTexture=new l.Texture(d,new l.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),d.gl.RGBA),this.identityMat=l.create();const q=this.context.gl;this.stencilClearMode=new l.StencilMode({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO),this.loadTimeStamps.push(l.window.performance.now()),this.atmosphereBuffer=new d_(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(d){return d._makeTileBoundsBuffers(this.context,this.transform.projection),d._tileBoundsBuffer?{tileBoundsBuffer:d._tileBoundsBuffer,tileBoundsIndexBuffer:d._tileBoundsIndexBuffer,tileBoundsSegments:d._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const d=this.context,v=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(d,v.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,_f(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(d,v,T){if(!v||this.currentStencilSource===v.id||!d.isTileClipped()||!T||T.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let U=!1;for(const q of T)if(this._tileClippingMaskIDs[q.key]===void 0){U=!0;break}if(!U)return}this.currentStencilSource=v.id;const C=this.context,L=C.gl;this.nextStencilID+T.length>256&&this.clearStencil(),C.setColorMode(l.ColorMode.disabled),C.setDepthMode(l.DepthMode.disabled);const B=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const U of T){const q=v.getTile(U),ie=this._tileClippingMaskIDs[U.key]=this.nextStencilID++,{tileBoundsBuffer:ne,tileBoundsIndexBuffer:be,tileBoundsSegments:Re}=this.getTileBoundsBuffers(q);B.draw(C,L.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:L.ALWAYS,mask:0},ie,255,L.KEEP,L.KEEP,L.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,_f(U.projMatrix),"$clipping",ne,be,Re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const d=this.nextStencilID++,v=this.context.gl;return new l.StencilMode({func:v.NOTEQUAL,mask:255},d,255,v.KEEP,v.KEEP,v.REPLACE)}stencilModeForClipping(d){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(d);const v=this.context.gl;return new l.StencilMode({func:v.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,v.KEEP,v.KEEP,v.REPLACE)}stencilConfigForOverlap(d){const v=this.context.gl,T=d.sort((B,U)=>U.overscaledZ-B.overscaledZ),C=T[T.length-1].overscaledZ,L=T[0].overscaledZ-C+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();const B={};for(let U=0;U<L;U++)B[U+C]=new l.StencilMode({func:v.GEQUAL,mask:255},U+this.nextStencilID,255,v.KEEP,v.KEEP,v.REPLACE);return this.nextStencilID+=L,[B,T]}return[{[C]:l.StencilMode.disabled},T]}colorModeForRenderPass(){const d=this.context.gl;return this._showOverdrawInspector?new l.ColorMode([d.CONSTANT_COLOR,d.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(d,v,T){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new l.DepthMode(T||this.context.gl.LEQUAL,v,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,v){this.style=d,this.options=v,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const T=this.style.order,C=this.style._sourceCaches;for(const ie in C){const ne=C[ie];ne.used&&ne.prepare(this.context)}const L={},B={},U={};for(const ie in C){const ne=C[ie];L[ie]=ne.getVisibleCoordinates(),B[ie]=L[ie].slice().reverse(),U[ie]=ne.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ie=0;ie<T.length;ie++)if(this.style._layers[T[ie]].is3D()){this.opaquePassCutoff=ie;break}if(this.terrain&&(this.terrain.updateTileBinding(U),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new l.GlobeSharedBuffers(this.context)),!l.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const ie of T){const ne=this.style._layers[ie],be=d._getLayerSourceCache(ne);if(!ne.hasOffscreenPass()||ne.isHidden(this.transform.zoom))continue;const Re=be?B[be.id]:void 0;(ne.type==="custom"||ne.isSky()||Re&&Re.length)&&this.renderLayer(this,be,ne,Re)}this.depthRangeFor3D=[0,1-(d.order.length+2)*this.numSublayers*this.depthEpsilon];const q=this.terrain;if(q&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&q.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:v.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=v.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const ie=this.style._layers[T[this.currentLayer]],ne=d._getLayerSourceCache(ie);if(ie.isSky())continue;const be=ne?B[ne.id]:void 0;this._renderTileClippingMasks(ie,ne,be),this.renderLayer(this,ne,ie,be)}if(this.style.fog&&this.transform.projection.supportsFog&&function(ie,ne){const be=ie.context,Re=be.gl,je=ie.transform,He=new l.DepthMode(Re.LEQUAL,l.DepthMode.ReadOnly,[0,1]),Ge=ie.useProgram("globeAtmosphere",null,je.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Xe=l.globeToMercatorTransition(je.zoom),Ee=ne.properties.get("color").toArray01(),Ue=ne.properties.get("high-color").toArray01(),it=ne.properties.get("space-color").toArray01PremultipliedAlpha(),lt=l.identity$1([]);l.rotateY$1(lt,lt,-l.degToRad(je._center.lng)),l.rotateX$1(lt,lt,l.degToRad(je._center.lat)),l.rotateZ$1(lt,lt,je.angle),l.rotateX$1(lt,lt,-je._pitch);const Ct=l.fromQuat(new Float32Array(16),lt),It=l.mapValue(ne.properties.get("star-intensity"),0,1,0,.25),Mt=5e-4,jt=l.mapValue(ne.properties.get("horizon-blend"),0,1,Mt,.25),Bt=l.globeUseCustomAntiAliasing(ie,be,je)&&jt===Mt?je.worldSize/(2*Math.PI*1.025)-1:je.globeRadius,Yt=ie.frameCounter/1e3%1,Zn=l.length(je.globeCenterInViewSpace),zt=Math.sqrt(Math.pow(Zn,2)-Math.pow(Bt,2)),wn=Math.acos(zt/Zn),Qt=(($t,vn,Tn,kn,Yn,Ur,ui,Mr,Xr,ki,Ci,Hr,fs,bs)=>({u_frustum_tl:$t,u_frustum_tr:vn,u_frustum_br:Tn,u_frustum_bl:kn,u_horizon:Yn,u_transition:Ur,u_fadeout_range:ui,u_color:Mr,u_high_color:Xr,u_space_color:ki,u_star_intensity:Ci,u_star_size:5*l.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Hr,u_horizon_angle:fs,u_rotation_matrix:bs}))(je.frustumCorners.TL,je.frustumCorners.TR,je.frustumCorners.BR,je.frustumCorners.BL,je.frustumCorners.horizon,Xe,jt,Ee,Ue,it,It,Yt,wn,Ct);ie.prepareDrawProgram(be,Ge);const Gn=ie.atmosphereBuffer;Gn&&Ge.draw(be,Re.TRIANGLES,He,l.StencilMode.disabled,l.ColorMode.alphaBlended,l.CullFaceMode.backCW,Qt,"skybox",Gn.vertexBuffer,Gn.indexBuffer,Gn.segments)}(this,this.style.fog),this.renderPass="sky",(l.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const ie=this.style._layers[T[this.currentLayer]],ne=d._getLayerSourceCache(ie);ie.isSky()&&this.renderLayer(this,ne,ie,ne?B[ne.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<T.length;){const ie=this.style._layers[T[this.currentLayer]],ne=d._getLayerSourceCache(ie);if(ie.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(ie)){if(ie.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const be=ne?(ie.type==="symbol"?U:B)[ne.id]:void 0;this._renderTileClippingMasks(ie,ne,ne?L[ne.id]:void 0),this.renderLayer(this,ne,ie,be),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ie=null;l.values(this.style._layers).forEach(ne=>{const be=d._getLayerSourceCache(ne);be&&!ne.isHidden(this.transform.zoom)&&(!ie||ie.getSource().maxzoom<be.getSource().maxzoom)&&(ie=be)}),ie&&this.options.showTileBoundaries&&wd.debug(this,ie,ie.getVisibleCoordinates())}this.options.showPadding&&function(ie){const ne=ie.transform.padding;d0(ie,ie.transform.height-(ne.top||0),3,jl),d0(ie,ne.bottom||0,3,u_),Hc(ie,ne.left||0,3,Qm),Hc(ie,ie.transform.width-(ne.right||0),3,yv);const be=ie.transform.centerPoint;(function(Re,je,He,Ge){mc(Re,je-1,He-10,2,20,Ge),mc(Re,je-10,He-1,20,2,Ge)})(ie,be.x,ie.transform.height-be.y,h0)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}renderLayer(d,v,T,C){T.isHidden(this.transform.zoom)||(T.type==="background"||T.type==="sky"||T.type==="custom"||C&&C.length)&&(this.id=T.id,this.gpuTimingStart(T),(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes(T.type)||d.terrain&&T.type==="custom")&&wd[T.type](d,v,T,C,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(d){if(!this.options.gpuTiming)return;const v=this.context.extTimerQuery;let T=this.gpuTimers[d.id];T||(T=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:v.createQueryEXT()}),T.calls++,v.beginQueryEXT(v.TIME_ELAPSED_EXT,T.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const d=this.context.extTimerQuery,v=d.createQueryEXT();this.deferredRenderGpuTimeQueries.push(v),d.beginQueryEXT(d.TIME_ELAPSED_EXT,v)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}collectGpuTimers(){const d=this.gpuTimers;return this.gpuTimers={},d}collectDeferredRenderGpuQueries(){const d=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],d}queryGpuTimers(d){const v={};for(const T in d){const C=d[T],L=this.context.extTimerQuery,B=L.getQueryObjectEXT(C.query,L.QUERY_RESULT_EXT)/1e6;L.deleteQueryEXT(C.query),v[T]=B}return v}queryGpuTimeDeferredRender(d){if(!this.options.gpuTimingDeferredRender)return 0;const v=this.context.extTimerQuery;let T=0;for(const C of d)T+=v.getQueryObjectEXT(C,v.QUERY_RESULT_EXT)/1e6,v.deleteQueryEXT(C);return T}translatePosMatrix(d,v,T,C,L){if(!T[0]&&!T[1])return d;const B=L?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(B){const ie=Math.sin(B),ne=Math.cos(B);T=[T[0]*ne-T[1]*ie,T[0]*ie+T[1]*ne]}const U=[L?T[0]:rt(v,T[0],this.transform.zoom),L?T[1]:rt(v,T[1],this.transform.zoom),0],q=new Float32Array(16);return l.translate(q,d,U),q}saveTileTexture(d){const v=this._tileTextures[d.size[0]];v?v.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){const v=this._tileTextures[d];return v&&v.length>0?v.pop():null}isPatternMissing(d){return d===null||d!==void 0&&!this.imageManager.getPattern(d.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const d=this.terrain&&this.terrain.renderingToTexture,v=this.terrain&&this.terrain.exaggeration()===0,T=this.style&&this.style.fog,C=[];return this.terrainRenderModeElevated()&&C.push("TERRAIN"),this.transform.projection.name==="globe"&&C.push("GLOBE"),v&&C.push("ZERO_EXAGGERATION"),T&&!d&&T.getOpacity(this.transform.pitch)!==0&&C.push("FOG"),d&&C.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&C.push("OVERDRAW_INSPECTOR"),C}useProgram(d,v,T){this.cache=this.cache||{};const C=T||[],L=this.currentGlobalDefines().concat(C),B=Yi.cacheKey(yf[d],d,L,v);return this.cache[B]||(this.cache[B]=new Yi(this.context,d,yf[d],v,o_[d],L)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(d,v,T){if(this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const L=C.getOpacity(this.transform.pitch),B=((U,q,ie,ne,be,Re,je,He,Ge,Xe,Ee)=>{const Ue=U.transform,it=q.properties.get("color").toArray01();it[3]=ne;const lt=U.frameCounter/1e3%1;return{u_fog_matrix:ie?Ue.calculateFogTileMatrix(ie):U.identityMat,u_fog_range:q.getFovAdjustedRange(Ue._fov),u_fog_color:it,u_fog_horizon_blend:q.properties.get("horizon-blend"),u_fog_temporal_offset:lt,u_frustum_tl:be,u_frustum_tr:Re,u_frustum_br:je,u_frustum_bl:He,u_globe_pos:Ge,u_globe_radius:Xe,u_viewport:Ee,u_globe_transition:l.globeToMercatorTransition(Ue.zoom),u_is_globe:+(Ue.projection.name==="globe")}})(this,C,T,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*l.exported.devicePixelRatio,this.transform.height*l.exported.devicePixelRatio]);v.setFogUniformValues(d,B)}}setTileLoadedFlag(d){this.tileLoaded=d}saveCanvasCopy(){const d=this.canvasCopy();d&&(this.frameCopies.push(d),this.tileLoaded=!1)}canvasCopy(){const d=this.context.gl,v=d.createTexture();return d.bindTexture(d.TEXTURE_2D,v),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,d.drawingBufferWidth,d.drawingBufferHeight,0),v}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const d=this.style&&this.style.fog;return!!d&&d.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const d=this._backgroundTiles,v=this._backgroundTiles={},T=this.transform.coveringTiles({tileSize:512});for(const C of T)v[C.key]=d[C.key]||new l.Tile(C,512,this.transform.tileZoom,this);return v}clearBackgroundTiles(){this._backgroundTiles={}}}class Op{constructor(d=0,v=0,T=0,C=0){if(isNaN(d)||d<0||isNaN(v)||v<0||isNaN(T)||T<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=v,this.left=T,this.right=C}interpolate(d,v,T){return v.top!=null&&d.top!=null&&(this.top=l.number(d.top,v.top,T)),v.bottom!=null&&d.bottom!=null&&(this.bottom=l.number(d.bottom,v.bottom,T)),v.left!=null&&d.left!=null&&(this.left=l.number(d.left,v.left,T)),v.right!=null&&d.right!=null&&(this.right=l.number(d.right,v.right,T)),this}getCenter(d,v){const T=l.clamp((this.left+d-this.right)/2,0,d),C=l.clamp((this.top+v-this.bottom)/2,0,v);return new l.Point(T,C)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new Op(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function p0(b,d){const v=l.getColumn(b,3);l.fromQuat(b,d),l.setColumn(b,3,v)}function ds(b,d){const v=l.identity$1([]);return l.rotateZ$1(v,v,-d),l.rotateX$1(v,v,-b),v}function eg(b,d){const v=[b[0],b[1],0],T=[d[0],d[1],0];if(l.length(v)>=1e-15){const B=l.normalize([],v);l.scale$2(T,B,l.dot(T,B)),d[0]=T[0],d[1]=T[1]}const C=l.cross([],d,b);if(l.len(C)<1e-15)return null;const L=Math.atan2(-C[1],C[0]);return ds(Math.atan2(Math.sqrt(b[0]*b[0]+b[1]*b[1]),-b[2]),L)}class vv{constructor(d,v){this.position=d,this.orientation=v}get position(){return this._position}set position(d){if(d){const v=d instanceof l.MercatorCoordinate?d:new l.MercatorCoordinate(d[0],d[1],d[2]);this._renderWorldCopies&&(v.x=l.wrap(v.x,0,1)),this._position=v}else this._position=null}lookAtPoint(d,v){if(this.orientation=null,!this.position)return;const T=this.position,C=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(d)):0,L=l.MercatorCoordinate.fromLngLat(d,C),B=[L.x-T.x,L.y-T.y,L.z-T.z];v||(v=[0,0,1]),v[2]=Math.abs(v[2]),this.orientation=eg(B,v)}setPitchBearing(d,v){this.orientation=ds(l.degToRad(d),l.degToRad(-v))}}class m0{constructor(d,v){this._transform=l.identity([]),this.orientation=v,this.position=d}get mercatorPosition(){const d=this.position;return new l.MercatorCoordinate(d[0],d[1],d[2])}get position(){const d=l.getColumn(this._transform,3);return[d[0],d[1],d[2]]}set position(d){var v;d&&l.setColumn(this._transform,3,[(v=d)[0],v[1],v[2],1])}get orientation(){return this._orientation}set orientation(d){this._orientation=d||l.identity$1([]),d&&p0(this._transform,this._orientation)}getPitchBearing(){const d=this.forward(),v=this.right();return{bearing:Math.atan2(-v[1],v[0]),pitch:Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2])}}setPitchBearing(d,v){this._orientation=ds(d,v),p0(this._transform,this._orientation)}forward(){const d=l.getColumn(this._transform,2);return[-d[0],-d[1],-d[2]]}up(){const d=l.getColumn(this._transform,1);return[-d[0],-d[1],-d[2]]}right(){const d=l.getColumn(this._transform,0);return[d[0],d[1],d[2]]}getCameraToWorld(d,v){const T=new Float64Array(16);return l.invert(T,this.getWorldToCamera(d,v)),T}getWorldToCameraPosition(d,v,T){const C=this.position;l.scale$2(C,C,-d);const L=new Float64Array(16);return l.fromScaling(L,[T,T,T]),l.translate(L,L,C),L[10]*=v,L}getWorldToCamera(d,v){const T=new Float64Array(16),C=new Float64Array(4),L=this.position;return l.conjugate(C,this._orientation),l.scale$2(L,L,-d),l.fromQuat(T,C),l.translate(T,T,L),T[1]*=-1,T[5]*=-1,T[9]*=-1,T[13]*=-1,T[8]*=v,T[9]*=v,T[10]*=v,T[11]*=v,T}getCameraToClipPerspective(d,v,T,C){const L=new Float64Array(16);return l.perspective(L,d,v,T,C),L}getDistanceToElevation(d,v=!1){const T=d===0?0:l.mercatorZfromAltitude(d,v?l.latFromMercatorY(this.position[1]):this.position[1]),C=this.forward();return(T-this.position[2])/C[2]}clone(){return new m0([...this.position],[...this.orientation])}}function Fp(b,d){const v=g0(b.projection,b.zoom,b.width,b.height),T=function(L,B,U,q,ie){const ne=new l.LngLat(U.lng-180*kh,U.lat),be=new l.LngLat(U.lng+180*kh,U.lat),Re=L.project(ne.lng,ne.lat),je=L.project(be.lng,be.lat),He=-Math.atan2(je.y-Re.y,je.x-Re.x),Ge=l.MercatorCoordinate.fromLngLat(U);Ge.y=l.clamp(Ge.y,-1+kh,1-kh);const Xe=Ge.toLngLat(),Ee=L.project(Xe.lng,Xe.lat),Ue=l.MercatorCoordinate.fromLngLat(Xe);Ue.x+=kh;const it=Ue.toLngLat(),lt=L.project(it.lng,it.lat),Ct=zp(lt.x-Ee.x,lt.y-Ee.y,He),It=l.MercatorCoordinate.fromLngLat(Xe);It.y+=kh;const Mt=It.toLngLat(),jt=L.project(Mt.lng,Mt.lat),Bt=zp(jt.x-Ee.x,jt.y-Ee.y,He),Yt=Math.abs(Ct.x)/Math.abs(Bt.y),Zn=l.identity([]);l.rotateZ(Zn,Zn,-He*(1-(ie?0:q)));const zt=l.identity([]);return l.scale(zt,zt,[1,1-(1-Yt)*q,1]),zt[4]=-Bt.x/Bt.y*q,l.rotateZ(zt,zt,He),l.multiply(zt,Zn,zt),zt}(b.projection,0,b.center,v,d),C=xv(b);return l.scale(T,T,[C,C,1]),T}function xv(b){const d=b.projection,v=g0(b.projection,b.zoom,b.width,b.height),T=y0(d,b.center),C=y0(d,l.LngLat.convert(d.center));return Math.pow(2,T*v+(1-v)*C)}function g0(b,d,v,T,C=1/0){const L=b.range;if(!L)return 0;const B=Math.min(C,Math.max(v,T)),U=Math.log(B/1024)/Math.LN2;return l.smoothstep(L[0]+U,L[1]+U,d)}const kh=1/4e4;function y0(b,d){const v=l.clamp(d.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),T=new l.LngLat(d.lng-180*kh,v),C=new l.LngLat(d.lng+180*kh,v),L=b.project(T.lng,v),B=b.project(C.lng,v),U=l.MercatorCoordinate.fromLngLat(T),q=l.MercatorCoordinate.fromLngLat(C),ie=B.x-L.x,ne=B.y-L.y,be=q.x-U.x,Re=q.y-U.y,je=Math.sqrt((be*be+Re*Re)/(ie*ie+ne*ne));return Math.log(je)/Math.LN2}function zp(b,d,v){const T=Math.cos(v),C=Math.sin(v);return{x:b*T-d*C,y:b*C+d*T}}class kf{constructor(d,v,T,C,L,B,U){this.tileSize=512,this._renderWorldCopies=L===void 0||L,this._minZoom=d||0,this._maxZoom=v||22,this._minPitch=T??0,this._maxPitch=C??60,this.setProjection(B),this.setMaxBounds(U),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Op,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new m0,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const d=new kf(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return d._elevation=this._elevation,d._centerAltitude=this._centerAltitude,d._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,d.tileSize=this.tileSize,d.mercatorFromTransition=this.mercatorFromTransition,d.width=this.width,d.height=this.height,d.cameraElevationReference=this.cameraElevationReference,d._center=this._center,d._setZoom(this.zoom),d._seaLevelZoom=this._seaLevelZoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._nearZ=this._nearZ,d._farZ=this._farZ,d._averageElevation=this._averageElevation,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._camera=this._camera.clone(),d._calcMatrices(),d.freezeTileCoverage=this.freezeTileCoverage,d.frustumCorners=this.frustumCorners,d}get elevation(){return this._elevation}set elevation(d){this._elevation!==d&&(this._elevation=d,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(d,v=!1){const T=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||T)&&this._updateCameraOnTerrain(),(d||T)&&this._constrainCamera(v),this._calcMatrices()}getProjection(){return l.pick(this.projection,["name","center","parallels"])}setProjection(d){this.projectionOptions=d||{name:"mercator"};const v=this.projection?this.getProjection():void 0;this.projection=l.getProjection(this.projectionOptions);const T=!E(v,this.getProjection());return T&&this._calcMatrices(),this.mercatorFromTransition=!1,T}setMercatorFromTransition(){const d=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=l.getProjection({name:"mercator"});const v=d!==this.projection.name;return v&&this._calcMatrices(),v}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(d){d===void 0?d=!0:d===null&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get cameraWorldSize(){const d=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(d))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return l.wrap(this.rotation,-180,180)}set bearing(d){this.rotation=d}get rotation(){return-this.angle/Math.PI*180}set rotation(d){const v=-d*Math.PI/180;var T;this.angle!==v&&(this._unmodified=!1,this.angle=v,this._calcMatrices(),this.rotationMatrix=(T=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(T[1]=0,T[2]=0),T[0]=1,T[3]=1,T),function(C,L,B){var U=L[0],q=L[1],ie=L[2],ne=L[3],be=Math.sin(B),Re=Math.cos(B);C[0]=U*Re+ie*be,C[1]=q*Re+ne*be,C[2]=U*-be+ie*Re,C[3]=q*-be+ne*Re}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(d){const v=l.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==v&&(this._unmodified=!1,this._pitch=v,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const d=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/d)}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=l.degToRad(d),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(d){this._averageElevation=d,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(d){const v=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==v&&(this._unmodified=!1,this._setZoom(v),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(d){this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;this._centerAltitude=d.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=d.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const d=this._elevation,v=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],T=this.horizonLineFromTop();let C=0,L=0;for(let B=0;B<v.length;B++){const U=new l.Point(v[B][0]*this.width,T+v[B][1]*(this.height-T)),q=d.pointCoordinate(U);if(!q)continue;const ie=1/Math.hypot(q[0]-this._camera.position[0],q[1]-this._camera.position[1]);C+=q[3]*ie,L+=ie}return L===0?NaN:C/L}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const d=this._seaLevelZoom,v=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),T=this.pixelsPerMeter/this.worldSize*v,C=this._mercatorZfromZoom(d),L=this._mercatorZfromZoom(this._maxZoom),B=Math.max(C-T,L);this._setZoom(this._zoomFromMercatorZ(B))}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}computeZoomRelativeTo(d){const v=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,d.toAltitude()));let T;T=d.z<this._camera.position[2]?[v.x,v.y,v.z]:[d.x,d.y,d.z];const C=l.length(l.sub([],this._camera.position,T));return l.clamp(this._zoomFromMercatorZ(C),this._minZoom,this._maxZoom)}setFreeCameraOptions(d){if(!this.height||!d.position&&!d.orientation)return;this._updateCameraState();let v=!1;if(d.orientation&&!l.exactEquals(d.orientation,this._camera.orientation)&&(v=this._setCameraOrientation(d.orientation)),d.position){const T=[d.position.x,d.position.y,d.position.z];l.exactEquals$1(T,this._camera.position)||(this._setCameraPosition(T),v=!0)}v&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const d=this._camera.position,v=new vv;return v.position=new l.MercatorCoordinate(d[0],d[1],d[2]),v.orientation=this._camera.orientation,v._elevation=this.elevation,v._renderWorldCopies=this.renderWorldCopies,v}_setCameraOrientation(d){if(!l.length$1(d))return!1;l.normalize$1(d,d);const v=l.transformQuat([],[0,0,-1],d),T=l.transformQuat([],[0,-1,0],d);if(T[2]<0)return!1;const C=eg(v,T);return!!C&&(this._camera.orientation=C,!0)}_setCameraPosition(d){const v=this.zoomScale(this.minZoom)*this.tileSize,T=this.zoomScale(this.maxZoom)*this.tileSize,C=this.cameraToCenterDistance;d[2]=l.clamp(d[2],C/T,C/v),this._camera.position=d}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,v,T){this._unmodified=!1,this._edgeInsets.interpolate(d,v,T),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){const v=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,v)}getVisibleUnwrappedCoordinates(d){const v=[new l.UnwrappedTileID(0,d)];if(this.renderWorldCopies){const T=this.pointCoordinate(new l.Point(0,0)),C=this.pointCoordinate(new l.Point(this.width,0)),L=this.pointCoordinate(new l.Point(this.width,this.height)),B=this.pointCoordinate(new l.Point(0,this.height)),U=Math.floor(Math.min(T.x,C.x,L.x,B.x)),q=Math.floor(Math.max(T.x,C.x,L.x,B.x)),ie=1;for(let ne=U-ie;ne<=q+ie;ne++)ne!==0&&v.push(new l.UnwrappedTileID(ne,d))}return v}coveringTiles(d){let v=this.coveringZoomLevel(d);const T=v,C=this.elevation&&!d.isTerrainDEM,L=this.projection.name==="mercator";if(d.minzoom!==void 0&&v<d.minzoom)return[];d.maxzoom!==void 0&&v>d.maxzoom&&(v=d.maxzoom);const B=this.locationCoordinate(this.center),U=this.center.lat,q=1<<v,ie=[q*B.x,q*B.y,0],ne=this.projection.name==="globe",be=!ne,Re=l.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,v,be),je=ne?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),He=q*l.mercatorZfromAltitude(1,this.center.lat),Ge=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),Xe=[q*je.x,q*je.y,Ge*(be?1:He)],Ee=this.cameraToCenterDistance/d.tileSize*(d.roundZoom?1:.502),Ue=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?v:0,it=d.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,lt=d.isTerrainDEM?-it:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ct=this.projection.isReprojectedInTileSpace?xv(this):1,It=$t=>{const Tn=new l.MercatorCoordinate($t.x+25e-6,$t.y,$t.z),kn=new l.MercatorCoordinate($t.x,$t.y+25e-6,$t.z),Yn=$t.toLngLat(),Ur=Tn.toLngLat(),ui=kn.toLngLat(),Mr=this.locationCoordinate(Yn),Xr=this.locationCoordinate(Ur),ki=this.locationCoordinate(ui),Ci=Math.hypot(Xr.x-Mr.x,Xr.y-Mr.y),Hr=Math.hypot(ki.x-Mr.x,ki.y-Mr.y);return Math.sqrt(Ci*Hr)*Ct/25e-6},Mt=$t=>{const vn=it,Tn=lt;return{aabb:l.tileAABB(this,q,0,0,0,$t,Tn,vn,this.projection),zoom:0,x:0,y:0,minZ:Tn,maxZ:vn,wrap:$t,fullyVisible:!1}},jt=[];let Bt=[];const Yt=v,Zn=d.reparseOverscaled?T:v,zt=$t=>$t*$t,wn=zt((Ge-this._centerAltitude)*He),Qt=$t=>{if(!this._elevation||!$t.tileID||!L)return;const vn=this._elevation.getMinMaxForTile($t.tileID),Tn=$t.aabb;vn?(Tn.min[2]=vn.min,Tn.max[2]=vn.max,Tn.center[2]=(Tn.min[2]+Tn.max[2])/2):($t.shouldSplit=Gn($t),$t.shouldSplit||(Tn.min[2]=Tn.max[2]=Tn.center[2]=this._centerAltitude))},Gn=$t=>{if($t.zoom<Ue)return!0;if($t.zoom===Yt)return!1;if($t.shouldSplit!=null)return $t.shouldSplit;const vn=$t.aabb.distanceX(Xe),Tn=$t.aabb.distanceY(Xe);let kn=wn,Yn=1;if(ne){kn=zt($t.aabb.distanceZ(Xe));const Mr=Math.pow(2,$t.zoom),Xr=l.latFromMercatorY(($t.y+1)/Mr),ki=l.latFromMercatorY($t.y/Mr),Ci=Math.min(Math.max(U,Xr),ki),Hr=l.circumferenceAtLatitude(Ci)/l.circumferenceAtLatitude(U);if(Yn=Ci===U?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Hr/this._mercatorScaleRatio),this.zoom<=l.GLOBE_ZOOM_THRESHOLD_MIN&&$t.zoom===Yt-1&&Hr>=.9)return!0}else if(C&&(kn=zt($t.aabb.distanceZ(Xe)*He)),this.projection.isReprojectedInTileSpace&&T<=5){const Mr=Math.pow(2,$t.zoom),Xr=It(new l.MercatorCoordinate(($t.x+.5)/Mr,($t.y+.5)/Mr));Yn=Xr>.85?1:Xr}const Ur=vn*vn+Tn*Tn+kn,ui=zt((1<<Yt-$t.zoom)*Ee*Yn*((Mr,Xr)=>{if(Xr*zt(.707)<Mr)return 1;const ki=Math.sqrt(Xr/Mr);return ki/(1.4144271570014144+(Math.pow(1.1,ki-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(kn,wn),Ur));return Ur<ui};if(this.renderWorldCopies)for(let $t=1;$t<=3;$t++)jt.push(Mt(-$t)),jt.push(Mt($t));for(jt.push(Mt(0));jt.length>0;){const $t=jt.pop(),vn=$t.x,Tn=$t.y;let kn=$t.fullyVisible;if(!kn){const Yn=$t.aabb.intersects(Re);if(Yn===0)continue;kn=Yn===2}if($t.zoom!==Yt&&Gn($t))for(let Yn=0;Yn<4;Yn++){const Ur=(vn<<1)+Yn%2,ui=(Tn<<1)+(Yn>>1),Mr={aabb:L?$t.aabb.quadrant(Yn):l.tileAABB(this,q,$t.zoom+1,Ur,ui,$t.wrap,$t.minZ,$t.maxZ,this.projection),zoom:$t.zoom+1,x:Ur,y:ui,wrap:$t.wrap,fullyVisible:kn,tileID:void 0,shouldSplit:void 0,minZ:$t.minZ,maxZ:$t.maxZ};C&&!ne&&(Mr.tileID=new l.OverscaledTileID($t.zoom+1===Yt?Zn:$t.zoom+1,$t.wrap,$t.zoom+1,Ur,ui),Qt(Mr)),jt.push(Mr)}else{const Yn=$t.zoom===Yt?Zn:$t.zoom;if(d.minzoom&&d.minzoom>Yn)continue;const Ur=ie[0]-(.5+vn+($t.wrap<<$t.zoom))*(1<<v-$t.zoom),ui=ie[1]-.5-Tn,Mr=$t.tileID?$t.tileID:new l.OverscaledTileID(Yn,$t.wrap,$t.zoom,vn,Tn);Bt.push({tileID:Mr,distanceSq:Ur*Ur+ui*ui})}}if(this.fogCullDistSq){const $t=this.fogCullDistSq,vn=this.horizonLineFromTop();Bt=Bt.filter(Tn=>{const kn=[0,0,0,1],Yn=[l.EXTENT,l.EXTENT,0,1],Ur=this.calculateFogTileMatrix(Tn.tileID.toUnwrapped());l.transformMat4$1(kn,kn,Ur),l.transformMat4$1(Yn,Yn,Ur);const ui=l.getAABBPointSquareDist(kn,Yn);if(ui===0)return!0;let Mr=!1;const Xr=this._elevation;if(Xr&&ui>$t&&vn!==0){const ki=this.calculateProjMatrix(Tn.tileID.toUnwrapped());let Ci;d.isTerrainDEM||(Ci=Xr.getMinMaxForTile(Tn.tileID)),Ci||(Ci={min:lt,max:it});const Hr=l.furthestTileCorner(this.rotation),fs=[Hr[0]*l.EXTENT,Hr[1]*l.EXTENT,Ci.max];l.transformMat4(fs,fs,ki),Mr=(1-fs[1])*this.height*.5<vn}return ui<$t||Mr})}return Bt.sort(($t,vn)=>$t.distanceSq-vn.distanceSq).map($t=>$t.tileID)}resize(d,v){this.width=d,this.height=v,this.pixelsToGLUnits=[2/d,-2/v],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){const v=l.clamp(d.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),T=this.projection.project(d.lng,v);return new l.Point(T.x*this.worldSize,T.y*this.worldSize)}unproject(d){return this.projection.unproject(d.x/this.worldSize,d.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/l.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(d,v){let T,C;const L=this.centerPoint;if(this.projection.name==="globe"){const U=this.worldSize;T=(v.x-L.x)/U,C=(v.y-L.y)/U}else{const U=this.pointCoordinate(v),q=this.pointCoordinate(L);T=U.x-q.x,C=U.y-q.y}const B=this.locationCoordinate(d);this.setLocation(new l.MercatorCoordinate(B.x-T,B.y-C))}setLocation(d){this.center=this.coordinateLocation(d),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(d){return this.projection.locationPoint(this,d)}locationPoint3D(d){return this.projection.locationPoint(this,d,!0)}pointLocation(d){return this.coordinateLocation(this.pointCoordinate(d))}pointLocation3D(d){return this.coordinateLocation(this.pointCoordinate3D(d))}locationCoordinate(d,v){const T=v?l.mercatorZfromAltitude(v,d.lat):void 0,C=this.projection.project(d.lng,d.lat);return new l.MercatorCoordinate(C.x,C.y,T)}coordinateLocation(d){return this.projection.unproject(d.x,d.y)}pointRayIntersection(d,v){const T=v??this._centerAltitude,C=[d.x,d.y,0,1],L=[d.x,d.y,1,1];l.transformMat4$1(C,C,this.pixelMatrixInverse),l.transformMat4$1(L,L,this.pixelMatrixInverse);const B=L[3];l.scale$1(C,C,1/C[3]),l.scale$1(L,L,1/B);const U=C[2],q=L[2];return{p0:C,p1:L,t:U===q?0:(T-U)/(q-U)}}screenPointToMercatorRay(d){const v=[d.x,d.y,0,1],T=[d.x,d.y,1,1];return l.transformMat4$1(v,v,this.pixelMatrixInverse),l.transformMat4$1(T,T,this.pixelMatrixInverse),l.scale$1(v,v,1/v[3]),l.scale$1(T,T,1/T[3]),v[2]=l.mercatorZfromAltitude(v[2],this._center.lat)*this.worldSize,T[2]=l.mercatorZfromAltitude(T[2],this._center.lat)*this.worldSize,l.scale$1(v,v,1/this.worldSize),l.scale$1(T,T,1/this.worldSize),new l.Ray([v[0],v[1],v[2]],l.normalize([],l.sub([],T,v)))}rayIntersectionCoordinate(d){const{p0:v,p1:T,t:C}=d,L=l.mercatorZfromAltitude(v[2],this._center.lat),B=l.mercatorZfromAltitude(T[2],this._center.lat);return new l.MercatorCoordinate(l.number(v[0],T[0],C)/this.worldSize,l.number(v[1],T[1],C)/this.worldSize,l.number(L,B,C))}pointCoordinate(d,v=this._centerAltitude){return this.projection.pointCoordinate(this,d.x,d.y,v)}pointCoordinate3D(d){if(!this.elevation)return this.pointCoordinate(d);let v=this.projection.pointCoordinate3D(this,d.x,d.y);if(v)return new l.MercatorCoordinate(v[0],v[1],v[2]);let T=0,C=this.horizonLineFromTop();if(d.y>C)return this.pointCoordinate(d);const L=.02*C,B=d.clone();for(let U=0;U<10&&C-T>L;U++){B.y=l.number(T,C,.66);const q=this.projection.pointCoordinate3D(this,B.x,B.y);q?(C=B.y,v=q):T=B.y}return v?new l.MercatorCoordinate(v[0],v[1],v[2]):this.pointCoordinate(d)}isPointAboveHorizon(d){return this.projection.isPointAboveHorizon(this,d)}isPointOnSurface(d){if(d.y<0||d.y>this.height||d.x<0||d.x>this.width)return!1;if(this.elevation||this.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(d);const v=this.pointCoordinate(d);return v.y>=0&&v.y<=1}_coordinatePoint(d,v){const T=v&&this.elevation?this.elevation.getAtPointOrZero(d,this._centerAltitude):this._centerAltitude,C=[d.x*this.worldSize,d.y*this.worldSize,T+d.toAltitude(),1];return l.transformMat4$1(C,C,this.pixelMatrix),C[3]>0?new l.Point(C[0]/C[3],C[1]/C[3]):new l.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:d,left:v}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,L=this.pointLocation3D(new l.Point(v,d)),B=this.pointLocation3D(new l.Point(C,d)),U=this.pointLocation3D(new l.Point(C,T)),q=this.pointLocation3D(new l.Point(v,T));let ie=Math.min(L.lng,B.lng,U.lng,q.lng),ne=Math.max(L.lng,B.lng,U.lng,q.lng),be=Math.min(L.lat,B.lat,U.lat,q.lat),Re=Math.max(L.lat,B.lat,U.lat,q.lat);const je=Math.pow(2,-this.zoom)/16*270,He=this.projection.name==="globe"?1:4,Ge=(Xe,Ee,Ue,it,lt)=>{const Ct=(Xe+Ue)/2,It=(Ee+it)/2,Mt=new l.Point(Ct,It),{lng:jt,lat:Bt}=this.pointLocation3D(Mt),Yt=Math.max(0,ie-jt,be-Bt,jt-ne,Bt-Re);ie=Math.min(ie,jt),ne=Math.max(ne,jt),be=Math.min(be,Bt),Re=Math.max(Re,Bt),(lt<He||Yt>je)&&(Ge(Xe,Ee,Ct,It,lt+1),Ge(Ct,It,Ue,it,lt+1))};if(Ge(v,d,C,d,1),Ge(C,d,C,T,1),Ge(C,T,v,T,1),Ge(v,T,v,d,1),this.projection.name==="globe"){const[Xe,Ee]=l.polesInViewport(this);Xe?(Re=90,ne=180,ie=-180):Ee&&(be=-90,ne=180,ie=-180)}return new l.LngLatBounds(new l.LngLat(ie,be),new l.LngLat(ne,Re))}_getBoundsRectangular(d,v){const{top:T,left:C}=this._edgeInsets,L=this.height-this._edgeInsets.bottom,B=this.width-this._edgeInsets.right,U=new l.Point(C,T),q=new l.Point(B,T),ie=new l.Point(B,L),ne=new l.Point(C,L);let be=this.pointCoordinate(U,d),Re=this.pointCoordinate(q,d);const je=this.pointCoordinate(ie,v),He=this.pointCoordinate(ne,v),Ge=(Xe,Ee)=>(Ee.y-Xe.y)/(Ee.x-Xe.x);return be.y>1&&Re.y>=0?be=new l.MercatorCoordinate((1-He.y)/Ge(He,be)+He.x,1):be.y<0&&Re.y<=1&&(be=new l.MercatorCoordinate(-He.y/Ge(He,be)+He.x,0)),Re.y>1&&be.y>=0?Re=new l.MercatorCoordinate((1-je.y)/Ge(je,Re)+je.x,1):Re.y<0&&be.y<=1&&(Re=new l.MercatorCoordinate(-je.y/Ge(je,Re)+je.x,0)),new l.LngLatBounds().extend(this.coordinateLocation(be)).extend(this.coordinateLocation(Re)).extend(this.coordinateLocation(He)).extend(this.coordinateLocation(je))}_getBoundsRectangularTerrain(){const d=this.elevation;if(!d.visibleDemTiles.length||d.isUsingMockSource())return this._getBoundsRectangular(0,0);const v=d.visibleDemTiles.reduce((T,C)=>{if(C.dem){const L=C.dem.tree;T.min=Math.min(T.min,L.minimums[0]),T.max=Math.max(T.max,L.maximums[0])}return T},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(v.min*d.exaggeration(),v.max*d.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(d=!0){const v=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,T=this.height/2-v*(1-this._horizonShift);return d?Math.max(0,T):T}getMaxBounds(){return this.maxBounds}setMaxBounds(d){this.maxBounds=d,this.minLat=-l.MAX_MERCATOR_LATITUDE,this.maxLat=l.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,d&&(this.minLat=d.getSouth(),this.maxLat=d.getNorth(),this.minLng=d.getWest(),this.maxLng=d.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=l.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=l.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=l.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=l.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(d,v){return this.projection.createTileMatrix(this,v,d)}calculateDistanceTileData(d){const v=d.key,T=this._distanceTileDataCache;if(T[v])return T[v];const C=d.canonical,L=1/this.height,B=this.cameraWorldSize,U=B/this.zoomScale(C.z),q=(C.x+Math.pow(2,C.z)*d.wrap)*U,ie=C.y*U,ne=this.point;ne.x*=B/this.worldSize,ne.y*=B/this.worldSize;const be=this.angle,Re=Math.sin(-be),je=-Math.cos(-be);return T[v]={bearing:[Re,je],center:[(ne.x-q)*L,(ne.y-ie)*L],scale:U/l.EXTENT*L},T[v]}calculateFogTileMatrix(d){const v=d.key,T=this._fogTileMatrixCache;if(T[v])return T[v];const C=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,d);return l.multiply(C,this.worldToFogMatrix,C),T[v]=new Float32Array(C),T[v]}calculateProjMatrix(d,v=!1){const T=d.key,C=v?this._alignedProjMatrixCache:this._projMatrixCache;if(C[T])return C[T];const L=this.calculatePosMatrix(d,this.worldSize);return l.multiply(L,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:v?this.alignedProjMatrix:this.projMatrix,L),C[T]=new Float32Array(L),C[T]}calculatePixelsToTileUnitsMatrix(d){const v=d.tileID.key,T=this._pixelsToTileUnitsCache;if(T[v])return T[v];const C=function(L,B){const{scale:U}=L.tileTransform,q=U*l.EXTENT/(L.tileSize*Math.pow(2,B.zoom-L.tileID.overscaledZ+L.tileID.canonical.z));return ie=new Float32Array(4),Re=(ne=B.inverseAdjustmentMatrix)[1],je=ne[2],He=ne[3],Xe=(be=[q,q])[1],ie[0]=ne[0]*(Ge=be[0]),ie[1]=Re*Ge,ie[2]=je*Xe,ie[3]=He*Xe,ie;var ie,ne,be,Re,je,He,Ge,Xe}(d,this);return T[v]=C,T[v]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const d=1/this.worldSize,v=l.fromScaling([],[d,d,d]);return l.multiply(v,v,this.globeMatrix),v}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const d=this._elevation;this._updateCameraState();const v=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(v),C=this._camera.forward(),L=l.mercatorZfromAltitude(1,this._center.lat);T[2]/=L,C[2]/=L,l.normalize(C,C);const B=d.raycast(T,C,d.exaggeration());if(B){const U=l.scaleAndAdd([],T,C,B),q=new l.MercatorCoordinate(U[0],U[1],l.mercatorZfromAltitude(U[2],l.latFromMercatorY(U[1]))),ie=(q.z+l.length([q.x-T[0],q.y-T[1],q.z-T[2]*L]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(ie),this._centerAltitude=q.toAltitude(),this._center=this.coordinateLocation(q),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(d=!1){if(!this._elevation)return;const v=this._elevation,T=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,C=this._computeCameraPosition(T),L=v.getAtPointOrZero(new l.MercatorCoordinate(...C)),B=this.pixelsPerMeter/this.worldSize*L,U=this._minimumHeightOverTerrain(),q=C[2]-B;if(q<=U)if(q<0||d){const ie=this.locationCoordinate(this._center,this._centerAltitude),ne=[C[0],C[1],ie.z-C[2]],be=l.length(ne);ne[2]-=(U-q)/this._pixelsPerMercatorPixel;const Re=l.length(ne);if(Re===0)return;l.scale$2(ne,ne,be/Re*this._pixelsPerMercatorPixel),this._camera.position=[C[0],C[1],ie.z*this._pixelsPerMercatorPixel-ne[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const d=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||d){const Re=this.center;return Re.lat=l.clamp(Re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!d)&&(Re.lng=l.clamp(Re.lng,this.minLng,this.maxLng)),this.center=Re,void(this._constraining=!1)}const v=this._unmodified,{x:T,y:C}=this.point;let L=0,B=T,U=C;const q=this.width/2,ie=this.height/2,ne=this.worldMinY*this.scale,be=this.worldMaxY*this.scale;if(C-ie<ne&&(U=ne+ie),C+ie>be&&(U=be-ie),be-ne<this.height&&(L=Math.max(L,this.height/(be-ne)),U=(be+ne)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Re=this.worldMinX*this.scale,je=this.worldMaxX*this.scale,He=this.worldSize/2-(Re+je)/2;B=(T+He+this.worldSize)%this.worldSize-He,B-q<Re&&(B=Re+q),B+q>je&&(B=je-q),je-Re<this.width&&(L=Math.max(L,this.width/(je-Re)),B=(je+Re)/2)}B===T&&U===C||(this.center=this.unproject(new l.Point(B,U))),L&&(this.zoom+=this.scaleZoom(L)),this._constrainCamera(),this._unmodified=v,this._constraining=!1}_minZoomForBounds(){let d=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(d=Math.max(d,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),d}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const d=this.centerOffset,v=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=l.mercatorZfromAltitude(1,this.center.lat)/l.mercatorZfromAltitude(1,l.GLOBE_SCALE_MATCH_LATITUDE));const T=g0(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,T),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const C=this.projection.zAxisUnit==="meters"?v:1,L=this._camera.getWorldToCamera(this.worldSize,C),B=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);B[8]=2*-d.x/this.width,B[9]=2*d.y/this.height;let U=l.mul([],B,L);if(this.projection.isReprojectedInTileSpace){const It=this.locationCoordinate(this.center),Mt=l.identity([]);l.translate(Mt,Mt,[It.x*this.worldSize,It.y*this.worldSize,0]),l.multiply(Mt,Mt,Fp(this)),l.translate(Mt,Mt,[-It.x*this.worldSize,-It.y*this.worldSize,0]),l.multiply(U,U,Mt),this.inverseAdjustmentMatrix=function(jt){const Bt=Fp(jt,!0);return We([],[Bt[0],Bt[1],Bt[4],Bt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=l.scale([],U,[this.worldSize,this.worldSize,this.worldSize/C,1]),this.projMatrix=U,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const q=l.invert([],B);this.frustumCorners=l.FrustumCorners.fromInvProjectionMatrix(q,this.horizonLineFromTop(),this.height);const ie=new Float32Array(16);l.identity(ie),l.scale(ie,ie,[1,-1,1]),l.rotateX(ie,ie,this._pitch),l.rotateZ(ie,ie,this.angle);const ne=l.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),be=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ne[8]=2*-d.x/this.width,ne[9]=2*(d.y+be)/this.height,this.skyboxMatrix=l.multiply(ie,ne,ie);const Re=this.point,je=Re.x,He=Re.y,Ge=this.width%2/2,Xe=this.height%2/2,Ee=Math.cos(this.angle),Ue=Math.sin(this.angle),it=je-Math.round(je)+Ee*Ge+Ue*Xe,lt=He-Math.round(He)+Ee*Xe+Ue*Ge,Ct=new Float64Array(U);if(l.translate(Ct,Ct,[it>.5?it-1:it,lt>.5?lt-1:lt,0]),this.alignedProjMatrix=Ct,U=l.create(),l.scale(U,U,[this.width/2,-this.height/2,1]),l.translate(U,U,[1,-1,0]),this.labelPlaneMatrix=U,U=l.create(),l.scale(U,U,[1,-1,1]),l.translate(U,U,[-1,-1,0]),l.scale(U,U,[2/this.width,2/this.height,1]),this.glCoordMatrix=U,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},U=l.invert(new Float64Array(16),this.pixelMatrix),!U)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=U,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=l.calculateGlobeMatrix(this);const It=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=l.transformMat4(It,It,L),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=U;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const d=this.cameraWorldSizeForFog,v=this.cameraPixelsPerMeter,T=this._camera.position,C=1/this.height/this._pixelsPerMercatorPixel,L=[d,d,v];l.scale$2(L,L,C),l.scale$2(T,T,-1),l.multiply$2(T,T,L);const B=l.create();l.translate(B,B,T),l.scale(B,B,L),this.mercatorFogMatrix=B,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(d,v,C)}_computeCameraPosition(d){const v=(d=d||this.pixelsPerMeter)/this.pixelsPerMeter,T=this._camera.forward(),C=this.point,L=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*v-d/this.worldSize*this._centerAltitude;return[C.x/this.worldSize-T[0]*L,C.y/this.worldSize-T[1]*L,d/this.worldSize*this._centerAltitude-T[2]*L]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(d){const v=this._maxCameraBoundsDistance()*Math.cos(this._pitch),T=this._camera.position[2],C=d[2];let L=1;this.projection.wrap&&(this.center=this.center.wrap()),C>0&&(L=Math.min((v-T)/C,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,d,L),this._updateStateFromCamera()}_updateStateFromCamera(){const d=this._camera.position,v=this._camera.forward(),{pitch:T,bearing:C}=this._camera.getPitchBearing(),L=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,B=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),U=Math.max((d[2]-L)/Math.cos(T),B),q=this._zoomFromMercatorZ(U);l.scaleAndAdd(d,d,v,U),this._pitch=l.clamp(T,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(C,-Math.PI,Math.PI),this._setZoom(l.clamp(q,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new l.MercatorCoordinate(d[0],d[1],d[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(d){return Math.pow(2,d)*this.tileSize}_mercatorZfromZoom(d){return this.cameraToCenterDistance/this._worldSizeFromZoom(d)}_minimumHeightOverTerrain(){const d=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(d)}_zoomFromMercatorZ(d){return this.scaleZoom(this.cameraToCenterDistance/(d*this.tileSize))}zoomFromMercatorZAdjusted(d){let v=0,T=l.GLOBE_ZOOM_THRESHOLD_MAX,C=0,L=1/0;for(;T-v>1e-6&&T>v;){const B=v+.5*(T-v),U=this.tileSize*Math.pow(2,B),q=this.getCameraToCenterDistance(this.projection,B,U),ie=this.scaleZoom(q/(d*this.tileSize)),ne=Math.abs(B-ie);ne<L&&(L=ne,C=B),B<ie?v=B:T=B}return C}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(l.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(d,v){const T=Math.min(d.x,v.x),C=Math.max(d.x,v.x),L=Math.min(d.y,v.y),B=Math.max(d.y,v.y);if(L<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const U=[new l.Point(T,L),new l.Point(C,B),new l.Point(T,B),new l.Point(C,L)],q=this.renderWorldCopies?-3:0,ie=this.renderWorldCopies?4:1;for(const ne of U){const be=this.pointRayIntersection(ne);if(be.t<0)return!0;const Re=this.rayIntersectionCoordinate(be);if(Re.x<q||Re.y<0||Re.x>ie||Re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new l.Point(0,0),new l.Point(this.width,this.height))}zoomDeltaToMovement(d,v){const T=l.length(l.sub([],this._camera.position,d)),C=this._zoomFromMercatorZ(T)+v;return T-this._mercatorZfromZoom(C)}getCameraPoint(){if(this.projection.name==="globe"){const d=function([v,T,C],L){const B=[v,T,C,1];l.transformMat4$1(B,B,L);const U=B[3]=Math.max(B[3],1e-6);return B[0]/=U,B[1]/=U,B[2]/=U,B}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new l.Point(d[0],d[1])}{const d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,d))}}getCameraToCenterDistance(d,v=this.zoom,T=this.worldSize){const C=g0(d,v,this.width,this.height,1024),L=d.pixelSpaceConversion(this.center.lat,T,C);return .5/Math.tan(.5*this._fov)*this.height*L}getWorldToCameraMatrix(){const d=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&l.multiply(d,d,this.globeMatrix),d}}function Bp(b,d){let v=!1,T=null;const C=()=>{T=null,v&&(b(),T=setTimeout(C,d),v=!1)};return()=>(v=!0,T||C(),T)}class f_{constructor(d){this._hashName=d&&encodeURIComponent(d),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Bp(this._updateHashUnthrottled.bind(this),300)}addTo(d){return this._map=d,l.window.addEventListener("hashchange",this._onHashChange,!1),d.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),l.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const d=this._map;if(!d)return"";const v=Up(d);if(this._hashName){const T=this._hashName;let C=!1;const L=l.window.location.hash.slice(1).split("&").map(B=>{const U=B.split("=")[0];return U===T?(C=!0,`${U}=${v}`):B}).filter(B=>B);return C||L.push(`${T}=${v}`),`#${L.join("&")}`}return`#${v}`}_getCurrentHash(){const d=l.window.location.hash.replace("#","");if(this._hashName){let v;return d.split("&").map(T=>T.split("=")).forEach(T=>{T[0]===this._hashName&&(v=T)}),(v&&v[1]||"").split("/")}return d.split("/")}_onHashChange(){const d=this._map;if(!d)return!1;const v=this._getCurrentHash();if(v.length>=3&&!v.some(T=>isNaN(T))){const T=d.dragRotate.isEnabled()&&d.touchZoomRotate.isEnabled()?+(v[3]||0):d.getBearing();return d.jumpTo({center:[+v[2],+v[1]],zoom:+v[0],bearing:T,pitch:+(v[4]||0)}),!0}return!1}_updateHashUnthrottled(){const d=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,d)}}function Up(b,d){const v=b.getCenter(),T=Math.round(100*b.getZoom())/100,C=Math.ceil((T*Math.LN2+Math.log(512/360/.5))/Math.LN10),L=Math.pow(10,C),B=Math.round(v.lng*L)/L,U=Math.round(v.lat*L)/L,q=b.getBearing(),ie=b.getPitch();let ne=d?`/${B}/${U}/${T}`:`${T}/${U}/${B}`;return(q||ie)&&(ne+="/"+Math.round(10*q)/10),ie&&(ne+=`/${Math.round(ie)}`),ne}const jp={linearity:.3,easing:l.bezier(0,0,.3,1)},tg=l.extend({deceleration:2500,maxSpeed:1400},jp),ng=l.extend({deceleration:20,maxSpeed:1400},jp),br=l.extend({deceleration:1e3,maxSpeed:360},jp),Gu=l.extend({deceleration:1e3,maxSpeed:90},jp);class Cf{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:d})}_drainInertiaBuffer(){const d=this._inertiaBuffer,v=l.exported.now();for(;d.length>0&&v-d[0].time>160;)d.shift()}_onMoveEnd(d){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const v={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:L}of this._inertiaBuffer)v.zoom+=L.zoomDelta||0,v.bearing+=L.bearingDelta||0,v.pitch+=L.pitchDelta||0,L.panDelta&&v.pan._add(L.panDelta),L.around&&(v.around=L.around),L.pinchAround&&(v.pinchAround=L.pinchAround);const T=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(v.pan.mag()){const L=ya(v.pan.mag(),T,l.extend({},tg,d||{}));C.offset=v.pan.mult(L.amount/v.pan.mag()),C.center=this._map.transform.center,La(C,L)}if(v.zoom){const L=ya(v.zoom,T,ng);C.zoom=this._map.transform.zoom+L.amount,La(C,L)}if(v.bearing){const L=ya(v.bearing,T,br);C.bearing=this._map.transform.bearing+l.clamp(L.amount,-179,179),La(C,L)}if(v.pitch){const L=ya(v.pitch,T,Gu);C.pitch=this._map.transform.pitch+L.amount,La(C,L)}if(C.zoom||C.bearing){const L=v.pinchAround===void 0?v.around:v.pinchAround;C.around=L?this._map.unproject(L):this._map.getCenter()}return this.clear(),C.noMoveStart=!0,C}}function La(b,d){(!b.duration||b.duration<d.duration)&&(b.duration=d.duration,b.easing=d.easing)}function ya(b,d,v){const{maxSpeed:T,linearity:C,deceleration:L}=v,B=l.clamp(b*C/(d/1e3),-T,T),U=Math.abs(B)/(L*C);return{easing:v.easing,duration:1e3*U,amount:B*(U/2)}}class Pa extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,v,T,C={}){const L=Ie(v.getCanvasContainer(),T),B=v.unproject(L);super(d,l.extend({point:L,lngLat:B,originalEvent:T},C)),this._defaultPrevented=!1,this.target=v}}class rg extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,v,T){const C=d==="touchend"?T.changedTouches:T.touches,L=Ne(v.getCanvasContainer(),C),B=L.map(q=>v.unproject(q)),U=L.reduce((q,ie,ne,be)=>q.add(ie.div(be.length)),new l.Point(0,0));super(d,{points:L,point:U,lngLats:B,lngLat:v.unproject(U),originalEvent:T}),this._defaultPrevented=!1}}class _0 extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,v,T){super(d,{originalEvent:T}),this._defaultPrevented=!1}}class p_{constructor(d,v){this._map=d,this._clickTolerance=v.clickTolerance}reset(){this._mousedownPos=void 0}wheel(d){return this._firePreventable(new _0(d.type,this._map,d))}mousedown(d,v){return this._mousedownPos=v,this._firePreventable(new Pa(d.type,this._map,d))}mouseup(d){this._map.fire(new Pa(d.type,this._map,d))}preclick(d){const v=l.extend({},d);v.type="preclick",this._map.fire(new Pa(v.type,this._map,v))}click(d,v){this._mousedownPos&&this._mousedownPos.dist(v)>=this._clickTolerance||(this.preclick(d),this._map.fire(new Pa(d.type,this._map,d)))}dblclick(d){return this._firePreventable(new Pa(d.type,this._map,d))}mouseover(d){this._map.fire(new Pa(d.type,this._map,d))}mouseout(d){this._map.fire(new Pa(d.type,this._map,d))}touchstart(d){return this._firePreventable(new rg(d.type,this._map,d))}touchmove(d){this._map.fire(new rg(d.type,this._map,d))}touchend(d){this._map.fire(new rg(d.type,this._map,d))}touchcancel(d){this._map.fire(new rg(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class v0{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(d){this._map.fire(new Pa(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new Pa(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bv{constructor(d,v){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=v.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,v){this.isEnabled()&&d.shiftKey&&d.button===0&&(H(),this._startPos=this._lastPos=v,this._active=!0)}mousemoveWindow(d,v){if(!this._active)return;const T=v,C=this._startPos,L=this._lastPos;if(!C||!L||L.equals(T)||!this._box&&T.dist(C)<this._clickTolerance)return;this._lastPos=T,this._box||(this._box=$("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));const B=Math.min(C.x,T.x),U=Math.max(C.x,T.x),q=Math.min(C.y,T.y),ie=Math.max(C.y,T.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${B}px,${q}px)`,this._box.style.width=U-B+"px",this._box.style.height=ie-q+"px")})}mouseupWindow(d,v){if(!this._active)return;const T=this._startPos,C=v;if(T&&d.button===0){if(this.reset(),Se(),T.x!==C.x||T.y!==C.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:L=>L.fitScreenCoordinates(T,C,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&d.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",d))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),te(),delete this._startPos,delete this._lastPos}_fireEvent(d,v){return this._map.fire(new l.Event(d,{originalEvent:v}))}}function x0(b,d){const v={};for(let T=0;T<b.length;T++)v[b[T].identifier]=d[T];return v}class Vp{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(d,v,T){(this.centroid||T.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=d.timeStamp),T.length===this.numTouches&&(this.centroid=function(C){const L=new l.Point(0,0);for(const B of C)L._add(B);return L.div(C.length)}(v),this.touches=x0(T,v)))}touchmove(d,v,T){if(this.aborted||!this.centroid)return;const C=x0(T,v);for(const L in this.touches){const B=C[L];(!B||B.dist(this.touches[L])>30)&&(this.aborted=!0)}}touchend(d,v,T){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),T.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class m_{constructor(d){this.singleTap=new Vp(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(d,v,T){this.singleTap.touchstart(d,v,T)}touchmove(d,v,T){this.singleTap.touchmove(d,v,T)}touchend(d,v,T){const C=this.singleTap.touchend(d,v,T);if(C){const L=d.timeStamp-this.lastTime<500,B=!this.lastTap||this.lastTap.dist(C)<30;if(L&&B||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class g3{constructor(){this._zoomIn=new m_({numTouches:1,numTaps:2}),this._zoomOut=new m_({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,v,T){this._zoomIn.touchstart(d,v,T),this._zoomOut.touchstart(d,v,T)}touchmove(d,v,T){this._zoomIn.touchmove(d,v,T),this._zoomOut.touchmove(d,v,T)}touchend(d,v,T){const C=this._zoomIn.touchend(d,v,T),L=this._zoomOut.touchend(d,v,T);return C?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(C)},{originalEvent:d})}):L?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(L)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const wv={0:1,2:2};class Gp{constructor(d){this.reset(),this._clickTolerance=d.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(d,v){return!1}_move(d,v){return{}}mousedown(d,v){if(this._lastPoint)return;const T=ut(d);this._correctButton(d,T)&&(this._lastPoint=v,this._eventButton=T)}mousemoveWindow(d,v){const T=this._lastPoint;if(T){if(d.preventDefault(),this._eventButton!=null&&function(C,L){const B=wv[L];return C.buttons===void 0||(C.buttons&B)!==B}(d,this._eventButton))this.reset();else if(this._moved||!(v.dist(T)<this._clickTolerance))return this._moved=!0,this._lastPoint=v,this._move(T,v)}}mouseupWindow(d){this._lastPoint&&ut(d)===this._eventButton&&(this._moved&&Se(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class g_ extends Gp{mousedown(d,v){super.mousedown(d,v),this._lastPoint&&(this._active=!0)}_correctButton(d,v){return v===0&&!d.ctrlKey}_move(d,v){return{around:v,panDelta:v.sub(d)}}}class y_ extends Gp{_correctButton(d,v){return v===0&&d.ctrlKey||v===2}_move(d,v){const T=.8*(v.x-d.x);if(T)return this._active=!0,{bearingDelta:T}}contextmenu(d){d.preventDefault()}}class __ extends Gp{_correctButton(d,v){return v===0&&d.ctrlKey||v===2}_move(d,v){const T=-.5*(v.y-d.y);if(T)return this._active=!0,{pitchDelta:T}}contextmenu(d){d.preventDefault()}}class b0{constructor(d,v){this._map=d,this._el=d.getCanvasContainer(),this._minTouches=1,this._clickTolerance=v.clickTolerance||1,this.reset(),l.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)}touchstart(d,v,T){return this._calculateTransform(d,v,T)}touchmove(d,v,T){if(this._active&&!(T.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(T.length===1&&!l.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return d.cancelable&&d.preventDefault(),this._calculateTransform(d,v,T)}}touchend(d,v,T){this._calculateTransform(d,v,T),this._active&&T.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,v,T){T.length>0&&(this._active=!0);const C=x0(T,v),L=new l.Point(0,0),B=new l.Point(0,0);let U=0;for(const ie in C){const ne=C[ie],be=this._touches[ie];be&&(L._add(ne),B._add(ne.sub(be)),U++,C[ie]=ne)}if(this._touches=C,U<this._minTouches||!B.mag())return;const q=B.div(U);return this._sum._add(q),this._sum.mag()<this._clickTolerance?void 0:{around:L.div(U),panDelta:q}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ig{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(d){}_move(d,v,T){return{}}touchstart(d,v,T){this._firstTwoTouches||T.length<2||(this._firstTwoTouches=[T[0].identifier,T[1].identifier],this._start([v[0],v[1]]))}touchmove(d,v,T){const C=this._firstTwoTouches;if(!C)return;d.preventDefault();const[L,B]=C,U=sg(T,v,L),q=sg(T,v,B);if(!U||!q)return;const ie=this._aroundCenter?null:U.add(q).div(2);return this._move([U,q],ie,d)}touchend(d,v,T){if(!this._firstTwoTouches)return;const[C,L]=this._firstTwoTouches,B=sg(T,v,C),U=sg(T,v,L);B&&U||(this._active&&Se(),this.reset())}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&d.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function sg(b,d,v){for(let T=0;T<b.length;T++)if(b[T].identifier===v)return d[T]}function v_(b,d){return Math.log(b/d)/Math.LN2}class Ev extends ig{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,v){const T=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(v_(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:v_(this._distance,T),pinchAround:v}}}function x_(b,d){return 180*b.angleWith(d)/Math.PI}class Sv extends ig{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,v){const T=this._vector;if(this._vector=d[0].sub(d[1]),T&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:x_(this._vector,T),pinchAround:v}}_isBelowThreshold(d){this._minDiameter=Math.min(this._minDiameter,d.mag());const v=25/(Math.PI*this._minDiameter)*360,T=this._startVector;if(!T)return!1;const C=x_(d,T);return Math.abs(C)<v}}function Sd(b){return Math.abs(b.y)>Math.abs(b.x)}class Tv extends ig{constructor(d){super(),this._map=d}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(d){this._lastPoints=d,Sd(d[0].sub(d[1]))&&(this._valid=!1)}_move(d,v,T){const C=this._lastPoints;if(!C)return;const L=d[0].sub(C[0]),B=d[1].sub(C[1]);return this._map._cooperativeGestures&&!l.isFullscreen()&&T.touches.length<3||(this._valid=this.gestureBeginsVertically(L,B,T.timeStamp),!this._valid)?void 0:(this._lastPoints=d,this._active=!0,{pitchDelta:(L.y+B.y)/2*-.5})}gestureBeginsVertically(d,v,T){if(this._valid!==void 0)return this._valid;const C=d.mag()>=2,L=v.mag()>=2;if(!C&&!L)return;if(!C||!L)return this._firstMove==null&&(this._firstMove=T),T-this._firstMove<100&&void 0;const B=d.y>0==v.y>0;return Sd(d)&&Sd(v)&&B}}const Mv={panStep:100,bearingStep:15,pitchStep:10};class y3{constructor(){const d=Mv;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(d){if(d.altKey||d.ctrlKey||d.metaKey)return;let v=0,T=0,C=0,L=0,B=0;switch(d.keyCode){case 61:case 107:case 171:case 187:v=1;break;case 189:case 109:case 173:v=-1;break;case 37:d.shiftKey?T=-1:(d.preventDefault(),L=-1);break;case 39:d.shiftKey?T=1:(d.preventDefault(),L=1);break;case 38:d.shiftKey?C=1:(d.preventDefault(),B=-1);break;case 40:d.shiftKey?C=-1:(d.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(T=0,C=0),{cameraAnimation:U=>{const q=U.getZoom();U.easeTo({duration:300,easeId:"keyboardHandler",easing:kv,zoom:v?Math.round(q)+v*(d.shiftKey?2:1):q,bearing:U.getBearing()+T*this._bearingStep,pitch:U.getPitch()+C*this._pitchStep,offset:[-L*this._panStep,-B*this._panStep],center:U.getCenter()},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kv(b){return b*(2-b)}const b_=4.000244140625;class Cv{constructor(d,v){this._map=d,this._el=d.getCanvasContainer(),this._handler=v,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&d.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(d){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(d.ctrlKey||d.metaKey||this.isZooming()||l.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let v=d.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;const T=l.exported.now(),C=T-(this._lastWheelEventTime||0);this._lastWheelEventTime=T,v!==0&&v%b_==0?this._type="wheel":v!==0&&Math.abs(v)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=v,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(C*v)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,v+=this._lastValue)),d.shiftKey&&v&&(v/=4),this._type&&(this._lastWheelEvent=d,this._delta-=v,this._active||this._start(d)),d.preventDefault()}_onTimeout(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)}_start(d){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const v=Ie(this._el,d);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:v,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const d=this._map.transform;this._type==="wheel"&&d.projection.wrap&&(d._center.lng>=180||d._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const v=()=>d._terrainEnabled()&&this._aroundCoord?d.computeZoomRelativeTo(this._aroundCoord):d.zoom;if(this._delta!==0){const q=this._type==="wheel"&&Math.abs(this._delta)>b_?this._wheelZoomRate:this._defaultZoomRate;let ie=2/(1+Math.exp(-Math.abs(this._delta*q)));this._delta<0&&ie!==0&&(ie=1/ie);const ne=v(),be=Math.pow(2,ne),Re=typeof this._targetZoom=="number"?d.zoomScale(this._targetZoom):be;this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(Re*ie))),this._type==="wheel"&&(this._startZoom=ne,this._easing=this._smoothOutEasing(200)),this._delta=0}const T=typeof this._targetZoom=="number"?this._targetZoom:v(),C=this._startZoom,L=this._easing;let B,U=!1;if(this._type==="wheel"&&C&&L){const q=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),ie=L(q);B=l.number(C,T,ie),q<1?this._frameId||(this._frameId=!0):U=!0}else B=T,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:B-v(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(d){let v=l.ease;if(this._prevEase){const T=this._prevEase,C=(l.exported.now()-T.start)/T.duration,L=T.easing(C+.01)-T.easing(C),B=.27/Math.sqrt(L*L+1e-4)*.01,U=Math.sqrt(.0729-B*B);v=l.bezier(B,U,.25,1)}return this._prevEase={start:l.exported.now(),duration:d,easing:v},v}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(l.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Iv{constructor(d,v){this._clickZoom=d,this._tapZoom=v}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bl{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(d,v){return d.preventDefault(),{cameraAnimation:T=>{T.easeTo({duration:300,zoom:T.getZoom()+(d.shiftKey?-1:1),around:T.unproject(v)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _3{constructor(){this._tap=new m_({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(d,v,T){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?T.length>0&&(this._swipePoint=v[0],this._swipeTouch=T[0].identifier):this._tap.touchstart(d,v,T))}touchmove(d,v,T){if(this._tapTime){if(this._swipePoint){if(T[0].identifier!==this._swipeTouch)return;const C=v[0],L=C.y-this._swipePoint.y;return this._swipePoint=C,d.preventDefault(),this._active=!0,{zoomDelta:L/128}}}else this._tap.touchmove(d,v,T)}touchend(d,v,T){this._tapTime?this._swipePoint&&T.length===0&&this.reset():this._tap.touchend(d,v,T)&&(this._tapTime=d.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Av{constructor(d,v,T){this._el=d,this._mousePan=v,this._touchPan=T}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class v3{constructor(d,v,T){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=v,this._mousePitch=T}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class x3{constructor(d,v,T,C){this._el=d,this._touchZoom=v,this._touchRotate=T,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Hu=b=>b.zoom||b.drag||b.pitch||b.rotate;class Lv extends l.Event{}class b3{constructor(){this.constants=[1,1,.01],this.radius=0}setup(d,v){const T=l.sub([],v,d);this.radius=l.length(T[2]<0?l.div([],T,this.constants):[T[0],T[1],0])}projectRay(d){l.div(d,d,this.constants),l.normalize(d,d),l.mul$1(d,d,this.constants);const v=l.scale$2([],d,this.radius);if(v[2]>0){const T=l.scale$2([],[0,0,1],l.dot(v,[0,0,1])),C=l.scale$2([],l.normalize([],[v[0],v[1],0]),this.radius),L=l.add([],v,l.scale$2([],l.sub([],l.add([],C,T),v),2));v[0]=L[0],v[1]=L[1]}return v}}function Wu(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class gc{constructor(d,v){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cf(d),this._bearingSnap=v.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new b3,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(v),l.bindAll(["handleEvent","handleWindowEvent"],this);const T=this._el;this._listeners=[[T,"touchstart",{passive:!0}],[T,"touchmove",{passive:!1}],[T,"touchend",void 0],[T,"touchcancel",void 0],[T,"mousedown",void 0],[T,"mousemove",void 0],[T,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[T,"mouseover",void 0],[T,"mouseout",void 0],[T,"dblclick",void 0],[T,"click",void 0],[T,"keydown",{capture:!1}],[T,"keyup",void 0],[T,"wheel",{passive:!1}],[T,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[C,L,B]of this._listeners)C.addEventListener(L,C===l.window.document?this.handleWindowEvent:this.handleEvent,B)}destroy(){for(const[d,v,T]of this._listeners)d.removeEventListener(v,d===l.window.document?this.handleWindowEvent:this.handleEvent,T)}_addDefaultHandlers(d){const v=this._map,T=v.getCanvasContainer();this._add("mapEvent",new p_(v,d));const C=v.boxZoom=new bv(v,d);this._add("boxZoom",C);const L=new g3,B=new bl;v.doubleClickZoom=new Iv(B,L),this._add("tapZoom",L),this._add("clickZoom",B);const U=new _3;this._add("tapDragZoom",U);const q=v.touchPitch=new Tv(v);this._add("touchPitch",q);const ie=new y_(d),ne=new __(d);v.dragRotate=new v3(d,ie,ne),this._add("mouseRotate",ie,["mousePitch"]),this._add("mousePitch",ne,["mouseRotate"]);const be=new g_(d),Re=new b0(v,d);v.dragPan=new Av(T,be,Re),this._add("mousePan",be),this._add("touchPan",Re,["touchZoom","touchRotate"]);const je=new Sv,He=new Ev;v.touchZoomRotate=new x3(T,He,je,U),this._add("touchRotate",je,["touchPan","touchZoom"]),this._add("touchZoom",He,["touchPan","touchRotate"]),this._add("blockableMapEvent",new v0(v));const Ge=v.scrollZoom=new Cv(v,this);this._add("scrollZoom",Ge,["mousePan"]);const Xe=v.keyboard=new y3;this._add("keyboard",Xe);for(const Ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])d.interactive&&d[Ee]&&v[Ee].enable(d[Ee])}_add(d,v,T){this._handlers.push({handlerName:d,handler:v,allowed:T}),this._handlersById[d]=v}stop(d){if(!this._updatingCamera){for(const{handler:v}of this._handlers)v.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(const{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(d,v,T){for(const C in d)if(C!==T&&(!v||v.indexOf(C)<0))return!0;return!1}handleWindowEvent(d){this.handleEvent(d,`${d.type}Window`)}_getMapTouches(d){const v=[];for(const T of d)this._el.contains(T.target)&&v.push(T);return v}handleEvent(d,v){this._updatingCamera=!0;const T=d.type==="renderFrame",C=T?void 0:d,L={needsRenderFrame:!1},B={},U={},q=d.touches?this._getMapTouches(d.touches):void 0,ie=q?Ne(this._el,q):T?void 0:Ie(this._el,d);for(const{handlerName:Re,handler:je,allowed:He}of this._handlers){if(!je.isEnabled())continue;let Ge;this._blockedByActive(U,He,Re)?je.reset():je[v||d.type]&&(Ge=je[v||d.type](d,ie,q),this.mergeHandlerResult(L,B,Ge,Re,C),Ge&&Ge.needsRenderFrame&&this._triggerRenderFrame()),(Ge||je.isActive())&&(U[Re]=je)}const ne={};for(const Re in this._previousActiveHandlers)U[Re]||(ne[Re]=C);this._previousActiveHandlers=U,(Object.keys(ne).length||Wu(L))&&(this._changes.push([L,B,ne]),this._triggerRenderFrame()),(Object.keys(U).length||Wu(L))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:be}=L;be&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],be(this._map))}mergeHandlerResult(d,v,T,C,L){if(!T)return;l.extend(d,T);const B={handlerName:C,originalEvent:T.originalEvent||L};T.zoomDelta!==void 0&&(v.zoom=B),T.panDelta!==void 0&&(v.drag=B),T.pitchDelta!==void 0&&(v.pitch=B),T.bearingDelta!==void 0&&(v.rotate=B)}_applyChanges(){const d={},v={},T={};for(const[C,L,B]of this._changes)C.panDelta&&(d.panDelta=(d.panDelta||new l.Point(0,0))._add(C.panDelta)),C.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(d.around=C.around),C.aroundCoord!==void 0&&(d.aroundCoord=C.aroundCoord),C.pinchAround!==void 0&&(d.pinchAround=C.pinchAround),C.noInertia&&(d.noInertia=C.noInertia),l.extend(v,L),l.extend(T,B);this._updateMapTransform(d,v,T),this._changes=[]}_updateMapTransform(d,v,T){const C=this._map,L=C.transform,B=Ue=>[Ue.x,Ue.y,Ue.z];if((Ue=>{const it=this._eventsInProgress.drag;return it&&!this._handlersById[it.handlerName].isActive()})()&&!Wu(d)){const Ue=L.zoom;L.cameraElevationReference="sea",L.recenterOnTerrain(),L.cameraElevationReference="ground",Ue!==L.zoom&&this._map._update(!0)}if(L._isCameraConstrained&&C._stop(!0),!Wu(d))return void this._fireEvents(v,T,!0);let{panDelta:U,zoomDelta:q,bearingDelta:ie,pitchDelta:ne,around:be,aroundCoord:Re,pinchAround:je}=d;L._isCameraConstrained&&(q>0&&(q=0),L._isCameraConstrained=!1),je!==void 0&&(be=je),(q||(Ue=>v[Ue]&&!this._eventsInProgress[Ue])("drag"))&&be&&(this._dragOrigin=B(L.pointCoordinate3D(be)),this._trackingEllipsoid.setup(L._camera.position,this._dragOrigin)),L.cameraElevationReference="sea",C._stop(!0),be=be||C.transform.centerPoint,ie&&(L.bearing+=ie),ne&&(L.pitch+=ne),L._updateCameraState();const He=[0,0,0];if(U)if(L.projection.name==="mercator"){const Ue=this._trackingEllipsoid.projectRay(L.screenPointToMercatorRay(be).dir),it=this._trackingEllipsoid.projectRay(L.screenPointToMercatorRay(be.sub(U)).dir);He[0]=it[0]-Ue[0],He[1]=it[1]-Ue[1]}else{const Ue=L.pointCoordinate(be);if(L.projection.name==="globe"){U=U.rotate(-L.angle);const it=L._pixelsPerMercatorPixel/L.worldSize;He[0]=-U.x*l.mercatorScale(l.latFromMercatorY(Ue.y))*it,He[1]=-U.y*l.mercatorScale(L.center.lat)*it}else{const it=L.pointCoordinate(be.sub(U));Ue&&it&&(He[0]=it.x-Ue.x,He[1]=it.y-Ue.y)}}const Ge=L.zoom,Xe=[0,0,0];if(q){const Ue=B(Re||L.pointCoordinate3D(be)),it={dir:l.normalize([],l.sub([],Ue,L._camera.position))};if(it.dir[2]<0){const lt=L.zoomDeltaToMovement(Ue,q);l.scale$2(Xe,it.dir,lt)}}const Ee=l.add(He,He,Xe);L._translateCameraConstrained(Ee),q&&Math.abs(L.zoom-Ge)>1e-4&&L.recenterOnTerrain(),L.cameraElevationReference="ground",this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(v,T,!0)}_fireEvents(d,v,T){const C=Hu(this._eventsInProgress),L=Hu(d),B={};for(const ne in d){const{originalEvent:be}=d[ne];this._eventsInProgress[ne]||(B[`${ne}start`]=be),this._eventsInProgress[ne]=d[ne]}!C&&L&&this._fireEvent("movestart",L.originalEvent);for(const ne in B)this._fireEvent(ne,B[ne]);L&&this._fireEvent("move",L.originalEvent);for(const ne in d){const{originalEvent:be}=d[ne];this._fireEvent(ne,be)}const U={};let q;for(const ne in this._eventsInProgress){const{handlerName:be,originalEvent:Re}=this._eventsInProgress[ne];this._handlersById[be].isActive()||(delete this._eventsInProgress[ne],q=v[be]||Re,U[`${ne}end`]=q)}for(const ne in U)this._fireEvent(ne,U[ne]);const ie=Hu(this._eventsInProgress);if(T&&(C||L)&&!ie){this._updatingCamera=!0;const ne=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=Re=>Re!==0&&-this._bearingSnap<Re&&Re<this._bearingSnap;ne?(be(ne.bearing||this._map.getBearing())&&(ne.bearing=0),this._map.easeTo(ne,{originalEvent:q})):(this._map.fire(new l.Event("moveend",{originalEvent:q})),be(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(d,v){this._map.fire(new l.Event(d,v?{originalEvent:v}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{this._frameId=void 0,this.handleEvent(new Lv("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ch="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class og extends l.Evented{constructor(d,v){super(),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=v.bearingSnap,this._respectPrefersReducedMotion=v.respectPrefersReducedMotion!==!1,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,v){return this.jumpTo({center:d},v)}panBy(d,v,T){return d=l.Point.convert(d).mult(-1),this.panTo(this.transform.center,l.extend({offset:d},v),T)}panTo(d,v,T){return this.easeTo(l.extend({center:d},v),T)}getZoom(){return this.transform.zoom}setZoom(d,v){return this.jumpTo({zoom:d},v),this}zoomTo(d,v,T){return this.easeTo(l.extend({zoom:d},v),T)}zoomIn(d,v){return this.zoomTo(this.getZoom()+1,d,v),this}zoomOut(d,v){return this.zoomTo(this.getZoom()-1,d,v),this}getBearing(){return this.transform.bearing}setBearing(d,v){return this.jumpTo({bearing:d},v),this}getPadding(){return this.transform.padding}setPadding(d,v){return this.jumpTo({padding:d},v),this}rotateTo(d,v,T){return this.easeTo(l.extend({bearing:d},v),T)}resetNorth(d,v){return this.rotateTo(0,l.extend({duration:1e3},d),v),this}resetNorthPitch(d,v){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},d),v),this}snapToNorth(d,v){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,v):this}getPitch(){return this.transform.pitch}setPitch(d,v){return this.jumpTo({pitch:d},v),this}cameraForBounds(d,v){d=l.LngLatBounds.convert(d);const T=v&&v.bearing||0,C=v&&v.pitch||0,L=d.getNorthWest(),B=d.getSouthEast();return this._cameraForBounds(this.transform,L,B,T,C,v)}_extendCameraOptions(d){const v={top:0,bottom:0,right:0,left:0};if(typeof(d=l.extend({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const T=d.padding;d.padding={top:T,bottom:T,right:T,left:T}}return d.padding=l.extend(v,d.padding),d}_minimumAABBFrustumDistance(d,v){const T=v.max[0]-v.min[0],C=v.max[1]-v.min[1];return T/C>d.aspect?T/(2*Math.tan(.5*d.fovX)*d.aspect):C/(2*Math.tan(.5*d.fovY)*d.aspect)}_cameraForBoundsOnGlobe(d,v,T,C,L,B){const U=d.clone(),q=this._extendCameraOptions(B);U.bearing=C,U.pitch=L;const ie=l.LngLat.convert(v),ne=l.LngLat.convert(T),be=.5*(ie.lat+ne.lat),Re=.5*(ie.lng+ne.lng),je=l.latLngToECEF(be,Re),He=l.normalize([],je),Ge=l.normalize([],l.cross([],He,[0,1,0])),Xe=l.cross([],Ge,He),Ee=[Ge[0],Ge[1],Ge[2],0,Xe[0],Xe[1],Xe[2],0,He[0],He[1],He[2],0,0,0,0,1],Ue=[je,l.latLngToECEF(ie.lat,ie.lng),l.latLngToECEF(ne.lat,ie.lng),l.latLngToECEF(ne.lat,ne.lng),l.latLngToECEF(ie.lat,ne.lng),l.latLngToECEF(be,ie.lng),l.latLngToECEF(be,ne.lng),l.latLngToECEF(ie.lat,Re),l.latLngToECEF(ne.lat,Re)];let it=l.Aabb.fromPoints(Ue.map(kn=>[l.dot(Ge,kn),l.dot(Xe,kn),l.dot(He,kn)]));const lt=l.transformMat4([],it.center,Ee);l.squaredLength(lt)===0&&l.set(lt,0,0,1),l.normalize(lt,lt),l.scale$2(lt,lt,l.GLOBE_RADIUS),U.center=l.ecefToLatLng(lt);const Ct=U.getWorldToCameraMatrix(),It=l.invert(new Float64Array(16),Ct);it=l.Aabb.applyTransform(it,l.multiply([],Ct,Ee)),l.transformMat4(lt,lt,Ct);const Mt=.5*(it.max[2]-it.min[2]),jt=this._minimumAABBFrustumDistance(U,it),Bt=l.scale$2([],[0,0,1],Mt),Yt=l.add(Bt,lt,Bt),Zn=jt+(U.pitch===0?0:l.distance(lt,Yt)),zt=U.globeCenterInViewSpace,wn=l.sub([],lt,[zt[0],zt[1],zt[2]]);l.normalize(wn,wn),l.scale$2(wn,wn,Zn);const Qt=l.add([],lt,wn);l.transformMat4(Qt,Qt,It);const Gn=l.earthRadius/l.GLOBE_RADIUS,$t=l.length(Qt),vn=l.mercatorZfromAltitude(Math.max($t*Gn-l.earthRadius,Number.EPSILON),0),Tn=Math.min(U.zoomFromMercatorZAdjusted(vn),q.maxZoom);return Tn>.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(U.setProjection({name:"mercator"}),U.zoom=Tn,this._cameraForBounds(U,v,T,C,L,B)):{center:U.center,zoom:Tn,bearing:C,pitch:L}}queryTerrainElevation(d,v){const T=this.transform.elevation;return T?(v=l.extend({},{exaggerated:!0},v),T.getAtPoint(l.MercatorCoordinate.fromLngLat(d),null,v.exaggerated)):null}_cameraForBounds(d,v,T,C,L,B){if(d.projection.name==="globe")return this._cameraForBoundsOnGlobe(d,v,T,C,L,B);const U=d.clone(),q=this._extendCameraOptions(B),ie=U.padding;U.bearing=C,U.pitch=L;const ne=l.LngLat.convert(v),be=l.LngLat.convert(T),Re=new l.LngLat(ne.lng,be.lat),je=new l.LngLat(be.lng,ne.lat),He=U.project(ne),Ge=U.project(be),Xe=this.queryTerrainElevation(ne),Ee=this.queryTerrainElevation(be),Ue=this.queryTerrainElevation(Re),it=this.queryTerrainElevation(je),lt=[[He.x,He.y,Math.min(Xe||0,Ee||0,Ue||0,it||0)],[Ge.x,Ge.y,Math.max(Xe||0,Ee||0,Ue||0,it||0)]];let Ct=l.Aabb.fromPoints(lt);const It=U.getWorldToCameraMatrix(),Mt=l.invert(new Float64Array(16),It);Ct=l.Aabb.applyTransform(Ct,It);const jt=l.sub([],Ct.max,Ct.min),Bt=ie.left||0,Yt=ie.right||0,Zn=ie.bottom||0,zt=ie.top||0,{left:wn,right:Qt,top:Gn,bottom:$t}=q.padding,vn=.5*(Bt+Yt),Tn=.5*(zt+Zn),kn=Math.min(U.scaleZoom(U.scale*Math.min((U.width-(Bt+Yt+wn+Qt))/jt[0],(U.height-(Zn+zt+$t+Gn))/jt[1])),q.maxZoom),Yn=U.scale/U.zoomScale(kn);Ct=new l.Aabb([Ct.min[0]-(wn+vn)*Yn,Ct.min[1]-($t+Tn)*Yn,Ct.min[2]],[Ct.max[0]+(Qt+vn)*Yn,Ct.max[1]+(Gn+Tn)*Yn,Ct.max[2]]);const Ur=.5*jt[2],ui=this._minimumAABBFrustumDistance(U,Ct),Mr=[0,0,1,0];l.transformMat4$1(Mr,Mr,It),l.normalize$2(Mr,Mr);const Xr=l.scale$2([],Mr,ui+Ur),ki=l.add([],Ct.center,Xr),Ci=(typeof q.offset.x=="number"&&typeof q.offset.y=="number"?new l.Point(q.offset.x,q.offset.y):l.Point.convert(q.offset)).rotate(-l.degToRad(C));Ct.center[0]-=Ci.x*Yn,Ct.center[1]+=Ci.y*Yn,l.transformMat4(Ct.center,Ct.center,Mt),l.transformMat4(ki,ki,Mt);const Hr=[Ct.center[0],Ct.center[1],ki[2]*U.pixelsPerMeter];l.scale$2(Hr,Hr,1/U.worldSize);const fs=l.lngFromMercatorX(Hr[0]),bs=l.latFromMercatorY(Hr[1]),Ts=Math.min(U._zoomFromMercatorZ(Hr[2]),q.maxZoom),Os=new l.LngLat(fs,bs);return U.mercatorFromTransition&&Ts<.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(U.setProjection({name:"globe"}),U.zoom=Ts,this._cameraForBounds(U,v,T,C,L,B)):{center:Os,zoom:Ts,bearing:C,pitch:L}}fitBounds(d,v,T){const C=this.cameraForBounds(d,v);return this._fitInternal(C,v,T)}fitScreenCoordinates(d,v,T,C,L){const B=l.Point.convert(d),U=l.Point.convert(v),q=new l.Point(Math.min(B.x,U.x),Math.min(B.y,U.y)),ie=new l.Point(Math.max(B.x,U.x),Math.max(B.y,U.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(B,U))return this;const ne=this.transform.pointLocation3D(q),be=this.transform.pointLocation3D(ie),Re=this.transform.pointLocation3D(new l.Point(q.x,ie.y)),je=this.transform.pointLocation3D(new l.Point(ie.x,q.y)),He=[Math.min(ne.lng,be.lng,Re.lng,je.lng),Math.min(ne.lat,be.lat,Re.lat,je.lat)],Ge=[Math.max(ne.lng,be.lng,Re.lng,je.lng),Math.max(ne.lat,be.lat,Re.lat,je.lat)],Xe=C&&C.pitch?C.pitch:this.getPitch(),Ee=this._cameraForBounds(this.transform,He,Ge,T,Xe,C);return this._fitInternal(Ee,C,L)}_fitInternal(d,v,T){return d?(delete(v=l.extend(d,v)).padding,v.linear?this.easeTo(v,T):this.flyTo(v,T)):this}jumpTo(d,v){this.stop();const T=d.preloadOnly?this.transform.clone():this.transform;let C=!1,L=!1,B=!1;return"zoom"in d&&T.zoom!==+d.zoom&&(C=!0,T.zoom=+d.zoom),d.center!==void 0&&(T.center=l.LngLat.convert(d.center)),"bearing"in d&&T.bearing!==+d.bearing&&(L=!0,T.bearing=+d.bearing),"pitch"in d&&T.pitch!==+d.pitch&&(B=!0,T.pitch=+d.pitch),d.padding==null||T.isPaddingEqual(d.padding)||(T.padding=d.padding),d.preloadOnly?(this._preloadTiles(T),this):(this.fire(new l.Event("movestart",v)).fire(new l.Event("move",v)),C&&this.fire(new l.Event("zoomstart",v)).fire(new l.Event("zoom",v)).fire(new l.Event("zoomend",v)),L&&this.fire(new l.Event("rotatestart",v)).fire(new l.Event("rotate",v)).fire(new l.Event("rotateend",v)),B&&this.fire(new l.Event("pitchstart",v)).fire(new l.Event("pitch",v)).fire(new l.Event("pitchend",v)),this.fire(new l.Event("moveend",v)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||l.warnOnce(Ch),this.transform.getFreeCameraOptions()}setFreeCameraOptions(d,v){const T=this.transform;if(!T.projection.supportsFreeCamera)return l.warnOnce(Ch),this;this.stop();const C=T.zoom,L=T.pitch,B=T.bearing;T.setFreeCameraOptions(d);const U=C!==T.zoom,q=L!==T.pitch,ie=B!==T.bearing;return this.fire(new l.Event("movestart",v)).fire(new l.Event("move",v)),U&&this.fire(new l.Event("zoomstart",v)).fire(new l.Event("zoom",v)).fire(new l.Event("zoomend",v)),ie&&this.fire(new l.Event("rotatestart",v)).fire(new l.Event("rotate",v)).fire(new l.Event("rotateend",v)),q&&this.fire(new l.Event("pitchstart",v)).fire(new l.Event("pitch",v)).fire(new l.Event("pitchend",v)),this.fire(new l.Event("moveend",v)),this}easeTo(d,v){this._stop(!1,d.easeId),((d=l.extend({offset:[0,0],duration:500,easing:l.ease},d)).animate===!1||this._prefersReducedMotion(d))&&(d.duration=0);const T=this.transform,C=this.getZoom(),L=this.getBearing(),B=this.getPitch(),U=this.getPadding(),q="zoom"in d?+d.zoom:C,ie="bearing"in d?this._normalizeBearing(d.bearing,L):L,ne="pitch"in d?+d.pitch:B,be="padding"in d?d.padding:T.padding,Re=l.Point.convert(d.offset);let je,He,Ge;if(T.projection.name==="globe"){const Bt=l.MercatorCoordinate.fromLngLat(T.center),Yt=Re.rotate(-T.angle);Bt.x+=Yt.x/T.worldSize,Bt.y+=Yt.y/T.worldSize;const Zn=Bt.toLngLat(),zt=l.LngLat.convert(d.center||Zn);this._normalizeCenter(zt),je=T.centerPoint.add(Yt),He=new l.Point(Bt.x,Bt.y).mult(T.worldSize),Ge=new l.Point(l.mercatorXfromLng(zt.lng),l.mercatorYfromLat(zt.lat)).mult(T.worldSize).sub(He)}else{je=T.centerPoint.add(Re);const Bt=T.pointLocation(je),Yt=l.LngLat.convert(d.center||Bt);this._normalizeCenter(Yt),He=T.project(Bt),Ge=T.project(Yt).sub(He)}const Xe=T.zoomScale(q-C);let Ee,Ue;d.around&&(Ee=l.LngLat.convert(d.around),Ue=T.locationPoint(Ee));const it=this._zooming||q!==C,lt=this._rotating||L!==ie,Ct=this._pitching||ne!==B,It=!T.isPaddingEqual(be),Mt=Bt=>Yt=>{if(it&&(Bt.zoom=l.number(C,q,Yt)),lt&&(Bt.bearing=l.number(L,ie,Yt)),Ct&&(Bt.pitch=l.number(B,ne,Yt)),It&&(Bt.interpolatePadding(U,be,Yt),je=Bt.centerPoint.add(Re)),Ee)Bt.setLocationAtPoint(Ee,Ue);else{const Zn=Bt.zoomScale(Bt.zoom-C),zt=q>C?Math.min(2,Xe):Math.max(.5,Xe),wn=Math.pow(zt,1-Yt),Qt=Bt.unproject(He.add(Ge.mult(Yt*wn)).mult(Zn));Bt.setLocationAtPoint(Bt.renderWorldCopies?Qt.wrap():Qt,je)}return d.preloadOnly||this._fireMoveEvents(v),Bt};if(d.preloadOnly){const Bt=this._emulate(Mt,d.duration,T);return this._preloadTiles(Bt),this}const jt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=it,this._rotating=lt,this._pitching=Ct,this._padding=It,this._easeId=d.easeId,this._prepareEase(v,d.noMoveStart,jt),this._ease(Mt(T),Bt=>{T.recenterOnTerrain(),this._afterEase(v,Bt)},d),this}_prepareEase(d,v,T={}){this._moving=!0,this.transform.cameraElevationReference="sea",v||T.moving||this.fire(new l.Event("movestart",d)),this._zooming&&!T.zooming&&this.fire(new l.Event("zoomstart",d)),this._rotating&&!T.rotating&&this.fire(new l.Event("rotatestart",d)),this._pitching&&!T.pitching&&this.fire(new l.Event("pitchstart",d))}_fireMoveEvents(d){this.fire(new l.Event("move",d)),this._zooming&&this.fire(new l.Event("zoom",d)),this._rotating&&this.fire(new l.Event("rotate",d)),this._pitching&&this.fire(new l.Event("pitch",d))}_afterEase(d,v){if(this._easeId&&v&&this._easeId===v)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const T=this._zooming,C=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,T&&this.fire(new l.Event("zoomend",d)),C&&this.fire(new l.Event("rotateend",d)),L&&this.fire(new l.Event("pitchend",d)),this.fire(new l.Event("moveend",d))}flyTo(d,v){if(this._prefersReducedMotion(d)){const kn=l.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(kn,v)}this.stop(),d=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},d);const T=this.transform,C=this.getZoom(),L=this.getBearing(),B=this.getPitch(),U=this.getPadding(),q="zoom"in d?l.clamp(+d.zoom,T.minZoom,T.maxZoom):C,ie="bearing"in d?this._normalizeBearing(d.bearing,L):L,ne="pitch"in d?+d.pitch:B,be="padding"in d?d.padding:T.padding,Re=T.zoomScale(q-C),je=l.Point.convert(d.offset);let He=T.centerPoint.add(je);const Ge=T.pointLocation(He),Xe=l.LngLat.convert(d.center||Ge);this._normalizeCenter(Xe);const Ee=T.project(Ge),Ue=T.project(Xe).sub(Ee);let it=d.curve;const lt=Math.max(T.width,T.height),Ct=lt/Re,It=Ue.mag();if("minZoom"in d){const kn=l.clamp(Math.min(d.minZoom,C,q),T.minZoom,T.maxZoom),Yn=lt/T.zoomScale(kn-C);it=Math.sqrt(Yn/It*2)}const Mt=it*it;function jt(kn){const Yn=(Ct*Ct-lt*lt+(kn?-1:1)*Mt*Mt*It*It)/(2*(kn?Ct:lt)*Mt*It);return Math.log(Math.sqrt(Yn*Yn+1)-Yn)}function Bt(kn){return(Math.exp(kn)-Math.exp(-kn))/2}function Yt(kn){return(Math.exp(kn)+Math.exp(-kn))/2}const Zn=jt(0);let zt=function(kn){return Yt(Zn)/Yt(Zn+it*kn)},wn=function(kn){return lt*((Yt(Zn)*(Bt(Yn=Zn+it*kn)/Yt(Yn))-Bt(Zn))/Mt)/It;var Yn},Qt=(jt(1)-Zn)/it;if(Math.abs(It)<1e-6||!isFinite(Qt)){if(Math.abs(lt-Ct)<1e-6)return this.easeTo(d,v);const kn=Ct<lt?-1:1;Qt=Math.abs(Math.log(Ct/lt))/it,wn=function(){return 0},zt=function(Yn){return Math.exp(kn*it*Yn)}}d.duration="duration"in d?+d.duration:1e3*Qt/("screenSpeed"in d?+d.screenSpeed/it:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0);const Gn=L!==ie,$t=ne!==B,vn=!T.isPaddingEqual(be),Tn=kn=>Yn=>{const Ur=Yn*Qt,ui=1/zt(Ur);kn.zoom=Yn===1?q:C+kn.scaleZoom(ui),Gn&&(kn.bearing=l.number(L,ie,Yn)),$t&&(kn.pitch=l.number(B,ne,Yn)),vn&&(kn.interpolatePadding(U,be,Yn),He=kn.centerPoint.add(je));const Mr=Yn===1?Xe:kn.unproject(Ee.add(Ue.mult(wn(Ur))).mult(ui));return kn.setLocationAtPoint(kn.renderWorldCopies?Mr.wrap():Mr,He),kn._updateCameraOnTerrain(),d.preloadOnly||this._fireMoveEvents(v),kn};if(d.preloadOnly){const kn=this._emulate(Tn,d.duration,T);return this._preloadTiles(kn),this}return this._zooming=!0,this._rotating=Gn,this._pitching=$t,this._padding=vn,this._prepareEase(v,!1),this._ease(Tn(T),()=>this._afterEase(v),d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,v){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const T=this._onEaseEnd;this._onEaseEnd=void 0,T.call(this,v)}if(!d){const T=this.handlers;T&&T.stop(!1)}return this}_ease(d,v,T){T.animate===!1||T.duration===0?(d(1),v()):(this._easeStart=l.exported.now(),this._easeOptions=T,this._onEaseFrame=d,this._onEaseEnd=v,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const d=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1),v=this._onEaseFrame;v&&v(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(d,v){d=l.wrap(d,-180,180);const T=Math.abs(d-v);return Math.abs(d-360-v)<T&&(d-=360),Math.abs(d+360-v)<T&&(d+=360),d}_normalizeCenter(d){const v=this.transform;if(!v.renderWorldCopies||v.maxBounds)return;const T=d.lng-v.center.lng;d.lng+=T>180?-360:T<-180?360:0}_prefersReducedMotion(d){return this._respectPrefersReducedMotion&&l.exported.prefersReducedMotion&&!(d&&d.essential)}_emulate(d,v,T){const C=Math.ceil(15*v/1e3),L=[],B=d(T.clone());for(let U=0;U<=C;U++){const q=B(U/C);L.push(q.clone())}return L}}class Ir{constructor(d={}){this.options=d,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(d){const v=this.options&&this.options.compact;return this._map=d,this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=$("button","mapboxgl-ctrl-attrib-button",this._container),$("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=$("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),v&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),v===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(d,v){const T=this._map._getUIString(`AttributionControl.${v}`);d.setAttribute("aria-label",T),d.removeAttribute("title"),d.firstElementChild&&d.firstElementChild.setAttribute("title",T)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));const v=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(d){const T=v.reduce((C,L,B)=>(L.value&&(C+=`${L.key}=${L.value}${B<v.length-1?"&":""}`),C),"?");d.href=`${l.config.FEEDBACK_URL}/${T}#${Up(this._map,!0)}`,d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}}_updateData(d){!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let d=[];if(this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const v=this._map.style._sourceCaches;for(const C in v){const L=v[C];if(L.used){const B=L.getSource();B.attribution&&d.indexOf(B.attribution)<0&&d.push(B.attribution)}}d.sort((C,L)=>C.length-L.length),d=d.filter((C,L)=>{for(let B=L+1;B<d.length;B++)if(d[B].indexOf(C)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=[...this.options.customAttribution,...d]:d.unshift(this.options.customAttribution));const T=d.join(" | ");T!==this._attribHTML&&(this._attribHTML=T,d.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Wc{constructor(){l.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(d){this._map=d,this._container=$("div","mapboxgl-ctrl");const v=$("a","mapboxgl-ctrl-logo");return v.target="_blank",v.rel="noopener nofollow",v.href="https://www.mapbox.com/",v.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),v.setAttribute("rel","noopener nofollow"),this._container.appendChild(v),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(d){d&&d.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const d=this._map.style._sourceCaches;if(Object.entries(d).length===0)return!0;for(const v in d){const T=d[v].getSource();if(T.hasOwnProperty("mapbox_logo")&&!T.mapbox_logo)return!1}return!0}_updateCompact(){const d=this._container.children;if(d.length){const v=d[0];this._map.getCanvasContainer().offsetWidth<250?v.classList.add("mapboxgl-compact"):v.classList.remove("mapboxgl-compact")}}}class w0{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){const v=++this._id;return this._queue.push({callback:d,id:v,cancelled:!1}),v}remove(d){const v=this._currentlyRunning,T=v?this._queue.concat(v):this._queue;for(const C of T)if(C.id===d)return void(C.cancelled=!0)}run(d=0){const v=this._currentlyRunning=this._queue;this._queue=[];for(const T of v)if(!T.cancelled&&(T.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Hp(b,d,v){if(b=new l.LngLat(b.lng,b.lat),d){const T=new l.LngLat(b.lng-360,b.lat),C=new l.LngLat(b.lng+360,b.lat),L=360*Math.ceil(Math.abs(b.lng-v.center.lng)/360),B=v.locationPoint(b).distSqr(d),U=d.x<0||d.y<0||d.x>v.width||d.y>v.height;v.locationPoint(T).distSqr(d)<B&&(U||Math.abs(T.lng-v.center.lng)<L)?b=T:v.locationPoint(C).distSqr(d)<B&&(U||Math.abs(C.lng-v.center.lng)<L)&&(b=C)}for(;Math.abs(b.lng-v.center.lng)>180;){const T=v.locationPoint(b);if(T.x>=0&&T.y>=0&&T.x<=v.width&&T.y<=v.height)break;b.lng>v.center.lng?b.lng-=360:b.lng+=360}return b}const Td={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class gr extends l.Evented{constructor(d,v){if(super(),(d instanceof l.window.HTMLElement||v)&&(d=l.extend({element:d},v)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=d&&d.occludedOpacity||.2,d&&d.element)this._element=d.element,this._offset=l.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=$("div");const C=41,L=27,B=Y("svg",{display:"block",height:C*this._scale+"px",width:L*this._scale+"px",viewBox:`0 0 ${L} ${C}`},this._element),U=Y("radialGradient",{id:"shadowGradient"},Y("defs",{},B));Y("stop",{offset:"10%","stop-opacity":.4},U),Y("stop",{offset:"100%","stop-opacity":.05},U),Y("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},B),Y("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},B),Y("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},B),Y("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},B),this._offset=l.Point.convert(d&&d.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",C=>{C.preventDefault()}),this._element.addEventListener("mousedown",C=>{C.preventDefault()});const T=this._element.classList;for(const C in Td)T.remove(`mapboxgl-marker-anchor-${C}`);T.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(d){return d===this._map||(this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._updateMoving),d.on("moveend",this._update),d.on("remove",this._clearFadeTimer),d._addMarker(this),this.setDraggable(this._draggable),this._update(),d.on("click",this._onMapClick)),this}remove(){const d=this._map;return d&&(d.off("click",this._onMapClick),d.off("move",this._updateMoving),d.off("moveend",this._update),d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler),d.off("mouseup",this._onUp),d.off("touchend",this._onUp),d.off("mousemove",this._onMove),d.off("touchmove",this._onMove),d.off("remove",this._clearFadeTimer),d._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=l.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=d,d._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(d){const v=d.code,T=d.charCode||d.keyCode;v!=="Space"&&v!=="Enter"&&T!==32&&T!==13||this.togglePopup()}_onMapClick(d){const v=d.originalEvent.target,T=this._element;this._popup&&(v===T||T.contains(v))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const d=this._popup;return d?(d.isOpen()?(d.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(d.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const d=this._map,v=this._pos;if(!d||!v)return!1;const T=d.unproject(v),C=d.getFreeCameraOptions();if(!C.position)return!1;const L=C.position.toLngLat();return L.distanceTo(T)<.9*L.distanceTo(this._lngLat)}_evaluateOpacity(){const d=this._map;if(!d)return;const v=this._pos;if(!v||v.x<0||v.x>d.transform.width||v.y<0||v.y>d.transform.height)return void this._clearFadeTimer();const T=d.unproject(v);let C;d._showingGlobe()&&l.isLngLatBehindGlobe(d.transform,this._lngLat)?C=0:(C=1-d._queryFogOpacity(T),d.transform._terrainEnabled()&&d.getTerrain()&&this._behindTerrain()&&(C*=this._occludedOpacity)),this._element.style.opacity=`${C}`,this._element.style.pointerEvents=C>0?"auto":"none",this._popup&&this._popup._setOpacity(C),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const d=this._pos;if(!d||!this._map)return;const v=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${d.x}px,${d.y}px)
            ${Td[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${v.x}px,${v.y}px)
        `}_calculateXYTransform(){const d=this._pos,v=this._map,T=this.getPitchAlignment();if(!v||!d||T!=="map")return"";if(!v._showingGlobe()){const q=v.getPitch();return q?`rotateX(${q}deg)`:""}const C=l.radToDeg(l.globeTiltAtLngLat(v.transform,this._lngLat)),L=d.sub(l.globeCenterToScreenPoint(v.transform)),B=Math.abs(L.x)+Math.abs(L.y);if(B===0)return"";const U=C/B;return`rotateX(${-L.y*U}deg) rotateY(${L.x*U}deg)`}_calculateZTransform(){const d=this._pos,v=this._map;if(!v||!d)return"";let T=0;const C=this.getRotationAlignment();if(C==="map")if(v._showingGlobe()){const L=v.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),B=v.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(L);T=l.radToDeg(Math.atan2(B.y,B.x))-90}else T=-v.getBearing();else if(C==="horizon"){const L=l.smoothstep(4,6,v.getZoom()),B=l.globeCenterToScreenPoint(v.transform);B.y+=L*v.transform.height;const U=d.sub(B),q=l.radToDeg(Math.atan2(U.y,U.x));T=(q>90?q-270:q+90)*(1-L)}return T+=this._rotation,T?`rotateZ(${T}deg)`:""}_update(d){l.window.cancelAnimationFrame(this._updateFrameId);const v=this._map;v&&(v.transform.renderWorldCopies&&(this._lngLat=Hp(this._lngLat,this._pos,v.transform)),this._pos=v.project(this._lngLat),d===!0?this._updateFrameId=l.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),v._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(v._showingGlobe()||v.getTerrain()||v.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(d){return this._offset=l.Point.convert(d),this._update(),this}_onMove(d){const v=this._map;if(!v)return;const T=this._pointerdownPos,C=this._positionDelta;if(T&&C){if(!this._isDragging){const L=this._clickTolerance||v._clickTolerance;if(d.point.dist(T)<L)return;this._isDragging=!0}this._pos=d.point.sub(C),this._lngLat=v.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const d=this._map;d&&(d.off("mousemove",this._onMove),d.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(d){const v=this._map,T=this._pos;v&&T&&this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(T),this._pointerdownPos=d.point,this._state="pending",v.on("mousemove",this._onMove),v.on("touchmove",this._onMove),v.once("mouseup",this._onUp),v.once("touchend",this._onUp))}setDraggable(d){this._draggable=!!d;const v=this._map;return v&&(d?(v.on("mousedown",this._addDragHandler),v.on("touchstart",this._addDragHandler)):(v.off("mousedown",this._addDragHandler),v.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(d){return this._occludedOpacity=d||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Md={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},w3=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pv(b=new l.Point(0,0),d="bottom"){if(typeof b=="number"){const v=Math.round(Math.sqrt(.5*Math.pow(b,2)));switch(d){case"top":return new l.Point(0,b);case"top-left":return new l.Point(v,v);case"top-right":return new l.Point(-v,v);case"bottom":return new l.Point(0,-b);case"bottom-left":return new l.Point(v,-v);case"bottom-right":return new l.Point(-v,-v);case"left":return new l.Point(b,0);case"right":return new l.Point(-b,0)}return new l.Point(0,0)}return b instanceof l.Point||Array.isArray(b)?l.Point.convert(b):l.Point.convert(b[d]||[0,0])}class If{constructor(d){this.jumpTo(d)}getValue(d){if(d<=this._startTime)return this._start;if(d>=this._endTime)return this._end;const v=l.easeCubicInOut((d-this._startTime)/(this._endTime-this._startTime));return this._start*(1-v)+this._end*v}isEasing(d){return d>=this._startTime&&d<=this._endTime}jumpTo(d){this._startTime=-1/0,this._endTime=-1/0,this._start=d,this._end=d}easeTo(d,v,T){this._start=this.getValue(v),this._end=d,this._startTime=v,this._endTime=v+T}}const w_={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},E_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},E3={showCompass:!0,showZoom:!0,visualizePitch:!1};class S_{constructor(d,v,T=!1){this._clickTolerance=10,this.element=v,this.mouseRotate=new y_({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,T&&(this.mousePitch=new __({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),v.addEventListener("mousedown",this.mousedown),v.addEventListener("touchstart",this.touchstart,{passive:!1}),v.addEventListener("touchmove",this.touchmove),v.addEventListener("touchend",this.touchend),v.addEventListener("touchcancel",this.reset)}down(d,v){this.mouseRotate.mousedown(d,v),this.mousePitch&&this.mousePitch.mousedown(d,v),H()}move(d,v){const T=this.map,C=this.mouseRotate.mousemoveWindow(d,v),L=C&&C.bearingDelta;if(L&&T.setBearing(T.getBearing()+L),this.mousePitch){const B=this.mousePitch.mousemoveWindow(d,v),U=B&&B.pitchDelta;U&&T.setPitch(T.getPitch()+U)}}off(){const d=this.element;d.removeEventListener("mousedown",this.mousedown),d.removeEventListener("touchstart",this.touchstart,{passive:!1}),d.removeEventListener("touchmove",this.touchmove),d.removeEventListener("touchend",this.touchend),d.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){te(),l.window.removeEventListener("mousemove",this.mousemove),l.window.removeEventListener("mouseup",this.mouseup)}mousedown(d){this.down(l.extend({},d,{ctrlKey:!0,preventDefault:()=>d.preventDefault()}),Ie(this.element,d)),l.window.addEventListener("mousemove",this.mousemove),l.window.addEventListener("mouseup",this.mouseup)}mousemove(d){this.move(d,Ie(this.element,d))}mouseup(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()}touchstart(d){d.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ne(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>d.preventDefault()},this._startPos))}touchmove(d){d.targetTouches.length!==1?this.reset():(this._lastPos=Ne(this.element,d.targetTouches)[0],this.move({preventDefault:()=>d.preventDefault()},this._lastPos))}touchend(d){d.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const T_={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},M_={maxWidth:100,unit:"metric"},k_={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Af={version:l.version,supported:P,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends og{constructor(b){if(l.LivePerformanceUtils.mark(l.PerformanceMarkers.create),(b=l.extend({},E_,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(b.antialias&&l.isSafariWithAntialiasingBug(l.window)&&(b.antialias=!1,l.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new kf(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),b),this._interactive=b.interactive,this._minTileCacheSize=b.minTileCacheSize,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._useWebGL2=b.useWebGL2,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=b.crossSourceCollisions,this._collectResourceTiming=b.collectResourceTiming,this._optimizeForTerrain=b.optimizeForTerrain,this._language=this._parseLanguage(b.language),this._worldview=b.worldview,this._renderTaskQueue=new w0,this._domRenderTaskQueue=new w0,this._controls=[],this._markers=[],this._popups=[],this._mapId=l.uniqueId(),this._locale=l.extend({},w_,b.locale),this._clickTolerance=b.clickTolerance,this._cooperativeGestures=b.cooperativeGestures,this._performanceMetricsCollection=b.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new If(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new l.RequestManager(b.transformRequest,b.accessToken,b.testMode),this._silenceAuthErrors=!!b.testMode,typeof b.container=="string"){if(this._container=l.window.document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof l.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(this._container.childNodes.length>0&&l.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),b.maxBounds&&this.setMaxBounds(b.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),l.window!==void 0&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new gc(this,b),this._localFontFamily=b.localFontFamily,this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),b.projection&&this.setProjection(b.projection),this._hash=b.hash&&new f_(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,l.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),b.attributionControl&&this.addControl(new Ir({customAttribution:b.customAttribution})),this._logoControl=new Wc,this.addControl(this._logoControl,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new l.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new l.Event(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(b,d){if(d===void 0&&(d=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const v=b.onAdd(this);this._controls.push(b);const T=this._controlPositions[d];return d.indexOf("bottom")!==-1?T.insertBefore(v,T.firstChild):T.appendChild(v),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const d=this._controls.indexOf(b);return d>-1&&this._controls.splice(d,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(b){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const d=!this._moving;return d&&this.fire(new l.Event("movestart",b)).fire(new l.Event("move",b)),this.fire(new l.Event("resize",b)),d&&this.fire(new l.Event("moveend",b)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(b){return this.transform.setMaxBounds(l.LngLatBounds.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b?this.setZoom(b):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b?this.setZoom(b):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b?this.setPitch(b):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b?this.setPitch(b):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(b){return b==="auto"?l.window.navigator.language:Array.isArray(b)?b.length===0?void 0:b.map(d=>d==="auto"?l.window.navigator.language:d):b}setLanguage(b){const d=this._parseLanguage(b);if(!this.style||d===this._language)return this;this._language=d,this.style._reloadSources();for(const v of this._controls)v._setLanguage&&v._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(b){return this.style&&b!==this._worldview?(this._worldview=b,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(b){return this._lazyInitEmptyStyle(),b?typeof b=="string"&&(b={name:b}):b=null,this._useExplicitProjection=!!b,this._prioritizeAndUpdateProjection(b,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const b=this.transform,d=b.projection.name;let v;d==="globe"&&b.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?(b.setMercatorFromTransition(),v=!0):d==="mercator"&&b.zoom<l.GLOBE_ZOOM_THRESHOLD_MAX&&(b.setProjection({name:"globe"}),v=!0),v&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(b,d){return this._updateProjection(b||d||{name:"mercator"})}_updateProjection(b){let d;if(d=b.name==="globe"&&this.transform.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(b),this.style.applyProjectionUpdate(),d){this.painter.clearBackgroundTiles();for(const v in this.style._sourceCaches)this.style._sourceCaches[v].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(b){return this.transform.locationPoint3D(l.LngLat.convert(b))}unproject(b){return this.transform.pointLocation3D(l.Point.convert(b))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(b,d,v){if(b==="mouseenter"||b==="mouseover"){let T=!1;const C=B=>{const U=d.filter(ie=>this.getLayer(ie)),q=U.length?this.queryRenderedFeatures(B.point,{layers:U}):[];q.length?T||(T=!0,v.call(this,new Pa(b,this,B.originalEvent,{features:q}))):T=!1},L=()=>{T=!1};return{layers:new Set(d),listener:v,delegates:{mousemove:C,mouseout:L}}}if(b==="mouseleave"||b==="mouseout"){let T=!1;const C=B=>{const U=d.filter(q=>this.getLayer(q));(U.length?this.queryRenderedFeatures(B.point,{layers:U}):[]).length?T=!0:T&&(T=!1,v.call(this,new Pa(b,this,B.originalEvent)))},L=B=>{T&&(T=!1,v.call(this,new Pa(b,this,B.originalEvent)))};return{layers:new Set(d),listener:v,delegates:{mousemove:C,mouseout:L}}}{const T=C=>{const L=d.filter(U=>this.getLayer(U)),B=L.length?this.queryRenderedFeatures(C.point,{layers:L}):[];B.length&&(C.features=B,v.call(this,C),delete C.features)};return{layers:new Set(d),listener:v,delegates:{[b]:T}}}}on(b,d,v){if(v===void 0)return super.on(b,d);Array.isArray(d)||(d=[d]);const T=this._createDelegatedListener(b,d,v);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(T);for(const C in T.delegates)this.on(C,T.delegates[C]);return this}once(b,d,v){if(v===void 0)return super.once(b,d);Array.isArray(d)||(d=[d]);const T=this._createDelegatedListener(b,d,v);for(const C in T.delegates)this.once(C,T.delegates[C]);return this}off(b,d,v){if(v===void 0)return super.off(b,d);d=new Set(Array.isArray(d)?d:[d]);const T=(L,B)=>{if(L.size!==B.size)return!1;for(const U of L)if(!B.has(U))return!1;return!0},C=this._delegatedListeners?this._delegatedListeners[b]:void 0;return C&&(L=>{for(let B=0;B<L.length;B++){const U=L[B];if(U.listener===v&&T(U.layers,d)){for(const q in U.delegates)this.off(q,U.delegates[q]);return L.splice(B,1),this}}})(C),this}queryRenderedFeatures(b,d){return this.style?(d!==void 0||b===void 0||b instanceof l.Point||Array.isArray(b)||(d=b,b=void 0),this.style.queryRenderedFeatures(b=b||[[0,0],[this.transform.width,this.transform.height]],d=d||{},this.transform)):[]}querySourceFeatures(b,d){return this.style.querySourceFeatures(b,d)}isPointOnSurface(b){const{name:d}=this.transform.projection;return d!=="globe"&&d!=="mercator"&&l.warnOnce(`${d} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(l.Point.convert(b))}setStyle(b,d){return(d=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},d)).diff!==!1&&d.localIdeographFontFamily===this._localIdeographFontFamily&&d.localFontFamily===this._localFontFamily&&this.style&&b?(this._diffStyle(b,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._localFontFamily=d.localFontFamily,this._updateStyle(b,d))}_getUIString(b){const d=this._locale[b];if(d==null)throw new Error(`Missing UI string '${b}'`);return d}_updateStyle(b,d){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),b&&(this.style=new jo(this,d||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b):this.style.loadJSON(b)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new jo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,d){if(typeof b=="string"){const v=this._requestManager.normalizeStyleURL(b),T=this._requestManager.transformRequest(v,l.ResourceType.Style);l.getJSON(T,(C,L)=>{C?this.fire(new l.ErrorEvent(C)):L&&this._updateDiff(L,d)})}else typeof b=="object"&&this._updateDiff(b,d)}_updateDiff(b,d){try{this.style.setState(b)&&this._update(!0)}catch(v){l.warnOnce(`Unable to perform style diff: ${v.message||v.error||v}.  Rebuilding the style from scratch.`),this._updateStyle(b,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(l.warnOnce("There is no style added to the map."),!1)}addSource(b,d){return this._lazyInitEmptyStyle(),this.style.addSource(b,d),this._update(!0)}isSourceLoaded(b){return!!this.style&&this.style._isSourceCacheLoaded(b)}areTilesLoaded(){const b=this.style&&this.style._sourceCaches;for(const d in b){const v=b[d]._tiles;for(const T in v){const C=v[T];if(C.state!=="loaded"&&C.state!=="errored")return!1}}return!0}addSourceType(b,d,v){this._lazyInitEmptyStyle(),this.style.addSourceType(b,d,v)}removeSource(b){return this.style.removeSource(b),this._updateTerrain(),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,d,{pixelRatio:v=1,sdf:T=!1,stretchX:C,stretchY:L,content:B}={}){if(this._lazyInitEmptyStyle(),d instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&d instanceof l.window.ImageBitmap){const{width:U,height:q,data:ie}=l.exported.getImageData(d);this.style.addImage(b,{data:new l.RGBAImage({width:U,height:q},ie),pixelRatio:v,stretchX:C,stretchY:L,content:B,sdf:T,version:0})}else if(d.width===void 0||d.height===void 0)this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:U,height:q}=d,ie=d;this.style.addImage(b,{data:new l.RGBAImage({width:U,height:q},new Uint8Array(ie.data)),pixelRatio:v,stretchX:C,stretchY:L,content:B,sdf:T,version:0,userImage:ie}),ie.onAdd&&ie.onAdd(this,b)}}updateImage(b,d){const v=this.style.getImage(b);if(!v)return void this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const T=d instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&d instanceof l.window.ImageBitmap?l.exported.getImageData(d):d,{width:C,height:L}=T;C!==void 0&&L!==void 0?C===v.data.width&&L===v.data.height?(v.data.replace(T.data,!(d instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&d instanceof l.window.ImageBitmap)),this.style.updateImage(b,v)):this.fire(new l.ErrorEvent(new Error(`The width and height of the updated image (${C}, ${L})
                must be that same as the previous version of the image
                (${v.data.width}, ${v.data.height})`))):this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,d){l.getImage(this._requestManager.transformRequest(b,l.ResourceType.Image),(v,T)=>{d(v,T instanceof l.window.HTMLImageElement?l.exported.getImageData(T):T)})}listImages(){return this.style.listImages()}addLayer(b,d){return this._lazyInitEmptyStyle(),this.style.addLayer(b,d),this._update(!0)}moveLayer(b,d){return this.style.moveLayer(b,d),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}setLayerZoomRange(b,d,v){return this.style.setLayerZoomRange(b,d,v),this._update(!0)}setFilter(b,d,v={}){return this.style.setFilter(b,d,v),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,d,v,T={}){return this.style.setPaintProperty(b,d,v,T),this._update(!0)}getPaintProperty(b,d){return this.style.getPaintProperty(b,d)}setLayoutProperty(b,d,v,T={}){return this.style.setLayoutProperty(b,d,v,T),this._update(!0)}getLayoutProperty(b,d){return this.style.getLayoutProperty(b,d)}setLight(b,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,d),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(b){return this._lazyInitEmptyStyle(),!b&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(b),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(b){return this._lazyInitEmptyStyle(),this.style.setFog(b),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(b){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(b),this.transform):0}setFeatureState(b,d){return this.style.setFeatureState(b,d),this._update()}removeFeatureState(b,d){return this.style.removeFeatureState(b,d),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}_updateContainerDimensions(){if(!this._container)return;const b=this._container.getBoundingClientRect().width||400,d=this._container.getBoundingClientRect().height||300;let v,T,C,L=this._container;for(;L&&(!T||!C);){const B=l.window.getComputedStyle(L).transform;B&&B!=="none"&&(v=B.match(/matrix.*\((.+)\)/)[1].split(", "),v[0]&&v[0]!=="0"&&v[0]!=="1"&&(T=v[0]),v[3]&&v[3]!=="0"&&v[3]!=="1"&&(C=v[3])),L=L.parentElement}this._containerWidth=T?Math.abs(b/T):b,this._containerHeight=C?Math.abs(d/C):d}_detectMissingCSS(){l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const b=this._container;b.classList.add("mapboxgl-map"),(this._missingCSSCanary=$("div","mapboxgl-canary",b)).style.visibility="hidden",this._detectMissingCSS();const d=this._canvasContainer=$("div","mapboxgl-canvas-container",b);this._interactive&&d.classList.add("mapboxgl-interactive"),this._canvas=$("canvas","mapboxgl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const v=this._controlContainer=$("div","mapboxgl-control-container",b),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(C=>{T[C]=$("div",`mapboxgl-ctrl-${C}`,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,d){const v=l.exported.devicePixelRatio||1;this._canvas.width=v*Math.ceil(b),this._canvas.height=v*Math.ceil(d),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${d}px`}_addMarker(b){this._markers.push(b)}_removeMarker(b){const d=this._markers.indexOf(b);d!==-1&&this._markers.splice(d,1)}_addPopup(b){this._popups.push(b)}_removePopup(b){const d=this._popups.indexOf(b);d!==-1&&this._popups.splice(d,1)}_setupPainter(){const b=l.extend({},P.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),d=this._useWebGL2&&this._canvas.getContext("webgl2",b),v=d||this._canvas.getContext("webgl",b)||this._canvas.getContext("experimental-webgl",b);v?(this._useWebGL2&&!d&&l.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),l.storeAuthState(v,!0),this.painter=new Ed(v,this.transform,!!d),this.on("data",T=>{T.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(v)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_requestDomTask(b){!this.loaded()||this.loaded()&&!this.isMoving()?b():this._domRenderTaskQueue.add(b)}_render(b){let d;const v=this.painter.context.extTimerQuery,T=l.exported.now();if(this.listens("gpu-timing-frame")&&(d=v.createQueryEXT(),v.beginQueryEXT(v.TIME_ELAPSED_EXT,d)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],l.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],l.window.performance.now())),this._renderTaskQueue.run(b),this._domRenderTaskQueue.run(b),this._removed)return;this._updateProjectionTransition();const C=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,q=this.transform.pitch,ie=l.exported.now(),ne=new l.EvaluationParameters(U,{now:ie,fadeDuration:C,pitch:q,transition:this.style.getTransition()});this.style.update(ne)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let L=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),L=this._updateAverageElevation(T),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):L=this._updateAverageElevation(T),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,C,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:C,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),d){const U=l.exported.now()-T;v.endQueryEXT(v.TIME_ELAPSED_EXT,d),setTimeout(()=>{const q=v.getQueryObjectEXT(d,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(d),this.fire(new l.Event("gpu-timing-frame",{cpuTime:U,gpuTime:q})),l.window.performance.mark("frame-gpu",{startTime:T,detail:{gpuTime:q}})},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const q=this.painter.queryGpuTimers(U);this.fire(new l.Event("gpu-timing-layer",{layerTimes:q}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const q=this.painter.queryGpuTimeDeferredRender(U);this.fire(new l.Event("gpu-timing-deferred-render",{gpuTime:q}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||L;if(B||this._repaint)this.triggerRepaint();else{const U=!this.isMoving()&&this.loaded();if(U&&(L=this._updateAverageElevation(T,!0)),L)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const q=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:q})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,l.LivePerformanceUtils.mark(l.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&l.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(b){for(const d of this._markers)b&&!this.getRenderWorldCopies()&&(d._lngLat=d._lngLat.wrap()),d._update();for(const d of this._popups)!b||this.getRenderWorldCopies()||d._trackPointer||(d._lngLat=d._lngLat.wrap()),d._update()}_updateAverageElevation(b,d=!1){const v=T=>(this.transform.averageElevation=T,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&v(0);if((d||b-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(b)){const T=this.transform.averageElevation;let C=this.transform.sampleAverageElevation(),L=!1;this.transform.elevation&&(L=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(C)?C=0:this._averageElevationLastSampledAt=b;const B=Math.abs(T-C);if(B>1){if(this._isInitialLoad||L)return this._averageElevation.jumpTo(C),v(C);this._averageElevation.easeTo(C,b,300)}else if(B>1e-4)return this._averageElevation.jumpTo(C),v(C)}return!!this._averageElevation.isEasing(b)&&v(this._averageElevation.getValue(b))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,b=>{if(b&&(b.message===l.AUTH_ERR_MSG||b.status===401)){const d=this.painter.context.gl;l.storeAuthState(d,!1),this._logoControl instanceof Wc&&this._logoControl._updateLogo(),d&&d.clear(d.DEPTH_BUFFER_BIT|d.COLOR_BUFFER_BIT|d.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const b=this._isDragging();this.painter.updateTerrain(this.style,b)}_calculateSpeedIndex(){const b=this.painter.canvasCopy(),d=this.painter.getCanvasCopiesAndTimestamps();d.timeStamps.push(performance.now());const v=this.painter.context.gl,T=v.createFramebuffer();function C(L){v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,L,0);const B=new Uint8Array(v.drawingBufferWidth*v.drawingBufferHeight*4);return v.readPixels(0,0,v.drawingBufferWidth,v.drawingBufferHeight,v.RGBA,v.UNSIGNED_BYTE,B),B}return v.bindFramebuffer(v.FRAMEBUFFER,T),this._canvasPixelComparison(C(b),d.canvasCopies.map(C),d.timeStamps)}_canvasPixelComparison(b,d,v){let T=v[1]-v[0];const C=b.length/4;for(let L=0;L<d.length;L++){const B=d[L];let U=0;for(let q=0;q<B.length;q+=4)B[q]===b[q]&&B[q+1]===b[q+1]&&B[q+2]===b[q+2]&&B[q+3]===b[q+3]&&(U+=1);T+=(v[L+2]-v[L+1])*(1-U/C)}return T}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),l.window!==void 0&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1),l.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(b){this._renderNextFrame=this._renderNextFrame||b,this.style&&!this._frame&&(this._frame=l.exported.frame(d=>{const v=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,v&&this._render(d)}))}_preloadTiles(b){const d=this.style?Object.values(this.style._sourceCaches):[];return l.asyncAll(d,(v,T)=>v._preloadTiles(b,T),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}_onVisibilityChange(){l.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(b){this._showTerrainWireframe!==b&&(this._showTerrainWireframe=b,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(b){this._speedIndexTiming!==b&&(this._speedIndexTiming=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(b){this._showTileAABBs!==b&&(this._showTileAABBs=b,b&&this._update())}_setCacheLimits(b,d){l.setCacheLimits(b,d)}get version(){return l.version}},NavigationControl:class{constructor(b){this.options=l.extend({},E3,b),this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",d=>{this._map&&this._map.zoomIn({},{originalEvent:d})}),$("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",d=>{this._map&&this._map.zoomOut({},{originalEvent:d})}),$("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",d=>{const v=this._map;v&&(this.options.visualizePitch?v.resetNorthPitch({},{originalEvent:d}):v.resetNorth({},{originalEvent:d}))}),this._compassIcon=$("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map;if(!b)return;const d=b.getZoom(),v=d===b.getMaxZoom(),T=d===b.getMinZoom();this._zoomInButton.disabled=v,this._zoomOutButton.disabled=T,this._zoomInButton.setAttribute("aria-disabled",v.toString()),this._zoomOutButton.setAttribute("aria-disabled",T.toString())}_rotateCompassArrow(){const b=this._map;if(!b)return;const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(b.transform.pitch*(Math.PI/180)),.5)}) rotateX(${b.transform.pitch}deg) rotateZ(${b.transform.angle*(180/Math.PI)}deg)`:`rotate(${b.transform.angle*(180/Math.PI)}deg)`;b._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=d)})}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),b.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&b.on("pitch",this._rotateCompassArrow),b.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new S_(b,this._compass,this.options.visualizePitch)),this._container}onRemove(){const b=this._map;b&&(this._container.remove(),this.options.showZoom&&b.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&b.off("pitch",this._rotateCompassArrow),b.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(b,d){const v=$("button",b,this._container);return v.type="button",v.addEventListener("click",d),v}_setButtonTitle(b,d){if(!this._map)return;const v=this._map._getUIString(`NavigationControl.${d}`);b.setAttribute("aria-label",v),b.firstElementChild&&b.firstElementChild.setAttribute("title",v)}},GeolocateControl:class extends l.Evented{constructor(b){super(),this.options=l.extend({geolocation:l.window.navigator.geolocation},T_,b),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Bp(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(b){return this._map=b,this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(b){const d=(v=!!this.options.geolocation)=>{this._supportsGeolocation=v,b(v)};this._supportsGeolocation!==void 0?b(this._supportsGeolocation):l.window.navigator.permissions!==void 0?l.window.navigator.permissions.query({name:"geolocation"}).then(v=>d(v.state!=="denied")).catch(()=>d()):d()}_isOutOfMapMaxBounds(b){const d=this._map.getMaxBounds(),v=b.coords;return!!d&&(v.longitude<d.getWest()||v.longitude>d.getEast()||v.latitude<d.getSouth()||v.latitude>d.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",b)),this._finish()}}_updateCamera(b){const d=new l.LngLat(b.coords.longitude,b.coords.latitude),v=b.coords.accuracy,T=this._map.getBearing(),C=l.extend({bearing:T},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(v),C,{geolocateSource:!0})}_updateMarker(b){if(b){const d=new l.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map.transform,d=l.mercatorZfromAltitude(1,b._center.lat)*b.worldSize,v=Math.ceil(2*this._accuracy*d);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=$("button","mapboxgl-ctrl-geolocate",this._container),$("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",b===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",d),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$("div","mapboxgl-user-location"),this._dotElement.appendChild($("div","mapboxgl-user-location-dot")),this._dotElement.appendChild($("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new gr({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=$("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}}_onDeviceOrientation(b){this._userLocationDotMarker&&(b.webkitCompassHeading?this._heading=b.webkitCompassHeading:b.absolute===!0&&(this._heading=-1*b.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(b={maximumAge:6e5,timeout:0},this._noTimeout=!0):(b=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,b),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const b=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};l.window.DeviceMotionEvent!==void 0&&typeof l.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(d=>{d==="granted"&&b()}).catch(console.error):b()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientation),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ir,ScaleControl:class{constructor(b){this.options=l.extend({},M_,b),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),l.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const b=this.options.maxWidth||100,d=this._map,v=d._containerHeight/2,T=d._containerWidth/2-b/2,C=d.unproject([T,v]),L=d.unproject([T+b,v]),B=C.distanceTo(L);if(this.options.unit==="imperial"){const U=3.2808*B;U>5280?this._setScale(b,U/5280,"mile"):this._setScale(b,U,"foot")}else this.options.unit==="nautical"?this._setScale(b,B/1852,"nautical-mile"):B>=1e3?this._setScale(b,B/1e3,"kilometer"):this._setScale(b,B,"meter")}_setScale(b,d,v){this._map._requestDomTask(()=>{const T=function(L){const B=Math.pow(10,`${Math.floor(L)}`.length-1);let U=L/B;return U=U>=10?10:U>=5?5:U>=3?3:U>=2?2:U>=1?1:function(q){const ie=Math.pow(10,Math.ceil(-Math.log(q)/Math.LN10));return Math.round(q*ie)/ie}(U),B*U}(d),C=T/d;this._container.innerHTML=this._isNumberFormatSupported&&v!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:v}).format(T):`${T}&nbsp;${k_[v]}`,this._container.style.width=b*C+"px"})}onAdd(b){return this._map=b,this._language=b.getLanguage(),this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(b){this._language=b,this._update()}setUnit(b){this.options.unit=b,this._update()}},FullscreenControl:class{constructor(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof l.window.HTMLElement?this._container=b.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=$("button","mapboxgl-ctrl-fullscreen",this._controlContainer);$("span","mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",b)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(b){super(),this.options=l.extend(Object.create(Md),b),l.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(b&&b.className?b.className.trim().split(/\s+/):[])}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&b.on("preclick",this._onClose),this.options.closeOnMove&&b.on("move",this._onClose),b.on("remove",this.remove),this._update(),b._addPopup(this),this._focusFirstElement(),this._trackPointer?(b.on("mousemove",this._onMouseEvent),b.on("mouseup",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")):b.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const b=this._map;return b&&(b.off("move",this._update),b.off("move",this._onClose),b.off("preclick",this._onClose),b.off("click",this._onClose),b.off("remove",this.remove),b.off("mousemove",this._onMouseEvent),b.off("mouseup",this._onMouseEvent),b.off("drag",this._onMouseEvent),b._canvasContainer&&b._canvasContainer.classList.remove("mapboxgl-track-pointer"),b._removePopup(this),this._map=void 0),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(b){this._lngLat=l.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update();const d=this._map;return d&&(d.on("move",this._update),d.off("mousemove",this._onMouseEvent),d._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const b=this._map;return b&&(b.off("move",this._update),b.on("mousemove",this._onMouseEvent),b.on("drag",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(l.window.document.createTextNode(b))}setHTML(b){const d=l.window.document.createDocumentFragment(),v=l.window.document.createElement("body");let T;for(v.innerHTML=b;T=v.firstChild,T;)d.appendChild(T);return this.setDOMContent(d)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){let d=this._content;if(d)for(;d.hasChildNodes();)d.firstChild&&d.removeChild(d.firstChild);else d=this._content=$("div","mapboxgl-popup-content",this._container||void 0);if(d.appendChild(b),this.options.closeButton){const v=this._closeButton=$("button","mapboxgl-popup-close-button",d);v.type="button",v.setAttribute("aria-label","Close popup"),v.setAttribute("aria-hidden","true"),v.innerHTML="&#215;",v.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(b){return this._classList.add(b),this._updateClassList(),this}removeClassName(b){return this._classList.delete(b),this._updateClassList(),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){let d;return this._classList.delete(b)?d=!1:(this._classList.add(b),d=!0),this._updateClassList(),d}_onMouseEvent(b){this._update(b.point)}_getAnchor(b){if(this.options.anchor)return this.options.anchor;const d=this._map,v=this._container,T=this._pos;if(!d||!v||!T)return"bottom";const C=v.offsetWidth,L=v.offsetHeight,B=T.x<C/2,U=T.x>d.transform.width-C/2;if(T.y+b<L)return B?"top-left":U?"top-right":"top";if(T.y>d.transform.height-L){if(B)return"bottom-left";if(U)return"bottom-right"}return B?"left":U?"right":"bottom"}_updateClassList(){const b=this._container;if(!b)return;const d=[...this._classList];d.push("mapboxgl-popup"),this._anchor&&d.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&d.push("mapboxgl-popup-track-pointer"),b.className=d.join(" ")}_update(b){const d=this._map,v=this._content;if(!d||!this._lngLat&&!this._trackPointer||!v)return;let T=this._container;if(T||(T=this._container=$("div","mapboxgl-popup",d.getContainer()),this._tip=$("div","mapboxgl-popup-tip",T),T.appendChild(v)),this.options.maxWidth&&T.style.maxWidth!==this.options.maxWidth&&(T.style.maxWidth=this.options.maxWidth),d.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Hp(this._lngLat,this._pos,d.transform)),!this._trackPointer||b){const C=this._pos=this._trackPointer&&b?b:d.project(this._lngLat),L=Pv(this.options.offset),B=this._anchor=this._getAnchor(L.y),U=Pv(this.options.offset,B),q=C.add(U).round();d._requestDomTask(()=>{this._container&&B&&(this._container.style.transform=`${Td[B]} translate(${q.x}px,${q.y}px)`)})}if(!this._marker&&d._showingGlobe()){const C=l.isLngLatBehindGlobe(d.transform,this._lngLat)?0:1;this._setOpacity(C)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(w3);b&&b.focus()}_onClose(){this.remove()}_setOpacity(b){this._container&&(this._container.style.opacity=`${b}`),this._content&&(this._content.style.pointerEvents=b?"auto":"none")}},Marker:gr,Style:jo,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:vv,Evented:l.Evented,config:l.config,prewarm:function(){No().acquire(xo)},clearPrewarmedResources:function(){const b=uo;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(xo),uo=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(b){l.config.ACCESS_TOKEN=b},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(b){l.config.API_URL=b},get workerCount(){return Us.workerCount},set workerCount(b){Us.workerCount=b},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){l.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){l.clearTileCache(b)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return Af});var g=u;return g})})(xV);var Yk=xV.exports;const m8=HS(Yk);var wV={exports:{}},EV={exports:{}},Kk={exports:{}};/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */(function(t,e){(function(n,r){r(e)})(m2,function(n){const r="132",At="300 es";class en{addEventListener(i,f){this._listeners===void 0&&(this._listeners={});const y=this._listeners;y[i]===void 0&&(y[i]=[]),y[i].indexOf(f)===-1&&y[i].push(f)}hasEventListener(i,f){if(this._listeners===void 0)return!1;const y=this._listeners;return y[i]!==void 0&&y[i].indexOf(f)!==-1}removeEventListener(i,f){if(this._listeners===void 0)return;const y=this._listeners[i];if(y!==void 0){const _=y.indexOf(f);_!==-1&&y.splice(_,1)}}dispatchEvent(i){if(this._listeners===void 0)return;const f=this._listeners[i.type];if(f!==void 0){i.target=this;const y=f.slice(0);for(let _=0,S=y.length;_<S;_++)y[_].call(this,i);i.target=null}}}const On=[];for(let M=0;M<256;M++)On[M]=(M<16?"0":"")+M.toString(16);let qn=1234567;const Er=Math.PI/180,Sr=180/Math.PI;function Dr(){const M=4294967295*Math.random()|0,i=4294967295*Math.random()|0,f=4294967295*Math.random()|0,y=4294967295*Math.random()|0;return(On[255&M]+On[M>>8&255]+On[M>>16&255]+On[M>>24&255]+"-"+On[255&i]+On[i>>8&255]+"-"+On[i>>16&15|64]+On[i>>24&255]+"-"+On[63&f|128]+On[f>>8&255]+"-"+On[f>>16&255]+On[f>>24&255]+On[255&y]+On[y>>8&255]+On[y>>16&255]+On[y>>24&255]).toUpperCase()}function Fr(M,i,f){return Math.max(i,Math.min(f,M))}function Tr(M,i){return(M%i+i)%i}function Zr(M,i,f){return(1-f)*M+f*i}function is(M){return(M&M-1)==0&&M!==0}function $i(M){return Math.pow(2,Math.ceil(Math.log(M)/Math.LN2))}function Xs(M){return Math.pow(2,Math.floor(Math.log(M)/Math.LN2))}var vo=Object.freeze({__proto__:null,DEG2RAD:Er,RAD2DEG:Sr,generateUUID:Dr,clamp:Fr,euclideanModulo:Tr,mapLinear:function(M,i,f,y,_){return y+(M-i)*(_-y)/(f-i)},inverseLerp:function(M,i,f){return M!==i?(f-M)/(i-M):0},lerp:Zr,damp:function(M,i,f,y){return Zr(M,i,1-Math.exp(-f*y))},pingpong:function(M,i=1){return i-Math.abs(Tr(M,2*i)-i)},smoothstep:function(M,i,f){return M<=i?0:M>=f?1:(M=(M-i)/(f-i))*M*(3-2*M)},smootherstep:function(M,i,f){return M<=i?0:M>=f?1:(M=(M-i)/(f-i))*M*M*(M*(6*M-15)+10)},randInt:function(M,i){return M+Math.floor(Math.random()*(i-M+1))},randFloat:function(M,i){return M+Math.random()*(i-M)},randFloatSpread:function(M){return M*(.5-Math.random())},seededRandom:function(M){return M!==void 0&&(qn=M%2147483647),qn=16807*qn%2147483647,(qn-1)/2147483646},degToRad:function(M){return M*Er},radToDeg:function(M){return M*Sr},isPowerOfTwo:is,ceilPowerOfTwo:$i,floorPowerOfTwo:Xs,setQuaternionFromProperEuler:function(M,i,f,y,_){const S=Math.cos,I=Math.sin,R=S(f/2),D=I(f/2),F=S((i+y)/2),G=I((i+y)/2),W=S((i-y)/2),Z=I((i-y)/2),K=S((y-i)/2),oe=I((y-i)/2);switch(_){case"XYX":M.set(R*G,D*W,D*Z,R*F);break;case"YZY":M.set(D*Z,R*G,D*W,R*F);break;case"ZXZ":M.set(D*W,D*Z,R*G,R*F);break;case"XZX":M.set(R*G,D*oe,D*K,R*F);break;case"YXY":M.set(D*K,R*G,D*oe,R*F);break;case"ZYZ":M.set(D*oe,D*K,R*G,R*F);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}});class Vn{constructor(i=0,f=0){this.x=i,this.y=f}get width(){return this.x}set width(i){this.x=i}get height(){return this.y}set height(i){this.y=i}set(i,f){return this.x=i,this.y=f,this}setScalar(i){return this.x=i,this.y=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setComponent(i,f){switch(i){case 0:this.x=f;break;case 1:this.y=f;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y)}copy(i){return this.x=i.x,this.y=i.y,this}add(i,f){return f!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,f)):(this.x+=i.x,this.y+=i.y,this)}addScalar(i){return this.x+=i,this.y+=i,this}addVectors(i,f){return this.x=i.x+f.x,this.y=i.y+f.y,this}addScaledVector(i,f){return this.x+=i.x*f,this.y+=i.y*f,this}sub(i,f){return f!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,f)):(this.x-=i.x,this.y-=i.y,this)}subScalar(i){return this.x-=i,this.y-=i,this}subVectors(i,f){return this.x=i.x-f.x,this.y=i.y-f.y,this}multiply(i){return this.x*=i.x,this.y*=i.y,this}multiplyScalar(i){return this.x*=i,this.y*=i,this}divide(i){return this.x/=i.x,this.y/=i.y,this}divideScalar(i){return this.multiplyScalar(1/i)}applyMatrix3(i){const f=this.x,y=this.y,_=i.elements;return this.x=_[0]*f+_[3]*y+_[6],this.y=_[1]*f+_[4]*y+_[7],this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this}clamp(i,f){return this.x=Math.max(i.x,Math.min(f.x,this.x)),this.y=Math.max(i.y,Math.min(f.y,this.y)),this}clampScalar(i,f){return this.x=Math.max(i,Math.min(f,this.x)),this.y=Math.max(i,Math.min(f,this.y)),this}clampLength(i,f){const y=this.length();return this.divideScalar(y||1).multiplyScalar(Math.max(i,Math.min(f,y)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(i){return this.x*i.x+this.y*i.y}cross(i){return this.x*i.y-this.y*i.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const f=this.x-i.x,y=this.y-i.y;return f*f+y*y}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,f){return this.x+=(i.x-this.x)*f,this.y+=(i.y-this.y)*f,this}lerpVectors(i,f,y){return this.x=i.x+(f.x-i.x)*y,this.y=i.y+(f.y-i.y)*y,this}equals(i){return i.x===this.x&&i.y===this.y}fromArray(i,f=0){return this.x=i[f],this.y=i[f+1],this}toArray(i=[],f=0){return i[f]=this.x,i[f+1]=this.y,i}fromBufferAttribute(i,f,y){return y!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(f),this.y=i.getY(f),this}rotateAround(i,f){const y=Math.cos(f),_=Math.sin(f),S=this.x-i.x,I=this.y-i.y;return this.x=S*y-I*_+i.x,this.y=S*_+I*y+i.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Vn.prototype.isVector2=!0;class Di{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(i,f,y,_,S,I,R,D,F){const G=this.elements;return G[0]=i,G[1]=_,G[2]=R,G[3]=f,G[4]=S,G[5]=D,G[6]=y,G[7]=I,G[8]=F,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(i){const f=this.elements,y=i.elements;return f[0]=y[0],f[1]=y[1],f[2]=y[2],f[3]=y[3],f[4]=y[4],f[5]=y[5],f[6]=y[6],f[7]=y[7],f[8]=y[8],this}extractBasis(i,f,y){return i.setFromMatrix3Column(this,0),f.setFromMatrix3Column(this,1),y.setFromMatrix3Column(this,2),this}setFromMatrix4(i){const f=i.elements;return this.set(f[0],f[4],f[8],f[1],f[5],f[9],f[2],f[6],f[10]),this}multiply(i){return this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,f){const y=i.elements,_=f.elements,S=this.elements,I=y[0],R=y[3],D=y[6],F=y[1],G=y[4],W=y[7],Z=y[2],K=y[5],oe=y[8],de=_[0],ke=_[3],pe=_[6],Ve=_[1],Ye=_[4],$e=_[7],_t=_[2],bt=_[5],Vt=_[8];return S[0]=I*de+R*Ve+D*_t,S[3]=I*ke+R*Ye+D*bt,S[6]=I*pe+R*$e+D*Vt,S[1]=F*de+G*Ve+W*_t,S[4]=F*ke+G*Ye+W*bt,S[7]=F*pe+G*$e+W*Vt,S[2]=Z*de+K*Ve+oe*_t,S[5]=Z*ke+K*Ye+oe*bt,S[8]=Z*pe+K*$e+oe*Vt,this}multiplyScalar(i){const f=this.elements;return f[0]*=i,f[3]*=i,f[6]*=i,f[1]*=i,f[4]*=i,f[7]*=i,f[2]*=i,f[5]*=i,f[8]*=i,this}determinant(){const i=this.elements,f=i[0],y=i[1],_=i[2],S=i[3],I=i[4],R=i[5],D=i[6],F=i[7],G=i[8];return f*I*G-f*R*F-y*S*G+y*R*D+_*S*F-_*I*D}invert(){const i=this.elements,f=i[0],y=i[1],_=i[2],S=i[3],I=i[4],R=i[5],D=i[6],F=i[7],G=i[8],W=G*I-R*F,Z=R*D-G*S,K=F*S-I*D,oe=f*W+y*Z+_*K;if(oe===0)return this.set(0,0,0,0,0,0,0,0,0);const de=1/oe;return i[0]=W*de,i[1]=(_*F-G*y)*de,i[2]=(R*y-_*I)*de,i[3]=Z*de,i[4]=(G*f-_*D)*de,i[5]=(_*S-R*f)*de,i[6]=K*de,i[7]=(y*D-F*f)*de,i[8]=(I*f-y*S)*de,this}transpose(){let i;const f=this.elements;return i=f[1],f[1]=f[3],f[3]=i,i=f[2],f[2]=f[6],f[6]=i,i=f[5],f[5]=f[7],f[7]=i,this}getNormalMatrix(i){return this.setFromMatrix4(i).invert().transpose()}transposeIntoArray(i){const f=this.elements;return i[0]=f[0],i[1]=f[3],i[2]=f[6],i[3]=f[1],i[4]=f[4],i[5]=f[7],i[6]=f[2],i[7]=f[5],i[8]=f[8],this}setUvTransform(i,f,y,_,S,I,R){const D=Math.cos(S),F=Math.sin(S);return this.set(y*D,y*F,-y*(D*I+F*R)+I+i,-_*F,_*D,-_*(-F*I+D*R)+R+f,0,0,1),this}scale(i,f){const y=this.elements;return y[0]*=i,y[3]*=i,y[6]*=i,y[1]*=f,y[4]*=f,y[7]*=f,this}rotate(i){const f=Math.cos(i),y=Math.sin(i),_=this.elements,S=_[0],I=_[3],R=_[6],D=_[1],F=_[4],G=_[7];return _[0]=f*S+y*D,_[3]=f*I+y*F,_[6]=f*R+y*G,_[1]=-y*S+f*D,_[4]=-y*I+f*F,_[7]=-y*R+f*G,this}translate(i,f){const y=this.elements;return y[0]+=i*y[2],y[3]+=i*y[5],y[6]+=i*y[8],y[1]+=f*y[2],y[4]+=f*y[5],y[7]+=f*y[8],this}equals(i){const f=this.elements,y=i.elements;for(let _=0;_<9;_++)if(f[_]!==y[_])return!1;return!0}fromArray(i,f=0){for(let y=0;y<9;y++)this.elements[y]=i[y+f];return this}toArray(i=[],f=0){const y=this.elements;return i[f]=y[0],i[f+1]=y[1],i[f+2]=y[2],i[f+3]=y[3],i[f+4]=y[4],i[f+5]=y[5],i[f+6]=y[6],i[f+7]=y[7],i[f+8]=y[8],i}clone(){return new this.constructor().fromArray(this.elements)}}let Ps;Di.prototype.isMatrix3=!0;class ct{static getDataURL(i){if(/^data:/i.test(i.src)||typeof HTMLCanvasElement>"u")return i.src;let f;if(i instanceof HTMLCanvasElement)f=i;else{Ps===void 0&&(Ps=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ps.width=i.width,Ps.height=i.height;const y=Ps.getContext("2d");i instanceof ImageData?y.putImageData(i,0,0):y.drawImage(i,0,0,i.width,i.height),f=Ps}return f.width>2048||f.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",i),f.toDataURL("image/jpeg",.6)):f.toDataURL("image/png")}}let se=0;class le extends en{constructor(i=le.DEFAULT_IMAGE,f=le.DEFAULT_MAPPING,y=1001,_=1001,S=1006,I=1008,R=1023,D=1009,F=1,G=3e3){super(),Object.defineProperty(this,"id",{value:se++}),this.uuid=Dr(),this.name="",this.image=i,this.mipmaps=[],this.mapping=f,this.wrapS=y,this.wrapT=_,this.magFilter=S,this.minFilter=I,this.anisotropy=F,this.format=R,this.internalFormat=null,this.type=D,this.offset=new Vn(0,0),this.repeat=new Vn(1,1),this.center=new Vn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Di,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=G,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(i){return this.name=i.name,this.image=i.image,this.mipmaps=i.mipmaps.slice(0),this.mapping=i.mapping,this.wrapS=i.wrapS,this.wrapT=i.wrapT,this.magFilter=i.magFilter,this.minFilter=i.minFilter,this.anisotropy=i.anisotropy,this.format=i.format,this.internalFormat=i.internalFormat,this.type=i.type,this.offset.copy(i.offset),this.repeat.copy(i.repeat),this.center.copy(i.center),this.rotation=i.rotation,this.matrixAutoUpdate=i.matrixAutoUpdate,this.matrix.copy(i.matrix),this.generateMipmaps=i.generateMipmaps,this.premultiplyAlpha=i.premultiplyAlpha,this.flipY=i.flipY,this.unpackAlignment=i.unpackAlignment,this.encoding=i.encoding,this}toJSON(i){const f=i===void 0||typeof i=="string";if(!f&&i.textures[this.uuid]!==void 0)return i.textures[this.uuid];const y={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const _=this.image;if(_.uuid===void 0&&(_.uuid=Dr()),!f&&i.images[_.uuid]===void 0){let S;if(Array.isArray(_)){S=[];for(let I=0,R=_.length;I<R;I++)_[I].isDataTexture?S.push(Ae(_[I].image)):S.push(Ae(_[I]))}else S=Ae(_);i.images[_.uuid]={uuid:_.uuid,url:S}}y.image=_.uuid}return f||(i.textures[this.uuid]=y),y}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(i){if(this.mapping!==300)return i;if(i.applyMatrix3(this.matrix),i.x<0||i.x>1)switch(this.wrapS){case 1e3:i.x=i.x-Math.floor(i.x);break;case 1001:i.x=i.x<0?0:1;break;case 1002:Math.abs(Math.floor(i.x)%2)===1?i.x=Math.ceil(i.x)-i.x:i.x=i.x-Math.floor(i.x)}if(i.y<0||i.y>1)switch(this.wrapT){case 1e3:i.y=i.y-Math.floor(i.y);break;case 1001:i.y=i.y<0?0:1;break;case 1002:Math.abs(Math.floor(i.y)%2)===1?i.y=Math.ceil(i.y)-i.y:i.y=i.y-Math.floor(i.y)}return this.flipY&&(i.y=1-i.y),i}set needsUpdate(i){i===!0&&this.version++}}function Ae(M){return typeof HTMLImageElement<"u"&&M instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&M instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&M instanceof ImageBitmap?ct.getDataURL(M):M.data?{data:Array.prototype.slice.call(M.data),width:M.width,height:M.height,type:M.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}le.DEFAULT_IMAGE=void 0,le.DEFAULT_MAPPING=300,le.prototype.isTexture=!0;class Fe{constructor(i=0,f=0,y=0,_=1){this.x=i,this.y=f,this.z=y,this.w=_}get width(){return this.z}set width(i){this.z=i}get height(){return this.w}set height(i){this.w=i}set(i,f,y,_){return this.x=i,this.y=f,this.z=y,this.w=_,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this.w=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setW(i){return this.w=i,this}setComponent(i,f){switch(i){case 0:this.x=f;break;case 1:this.y=f;break;case 2:this.z=f;break;case 3:this.w=f;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w!==void 0?i.w:1,this}add(i,f){return f!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,f)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this.w+=i.w,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this.w+=i,this}addVectors(i,f){return this.x=i.x+f.x,this.y=i.y+f.y,this.z=i.z+f.z,this.w=i.w+f.w,this}addScaledVector(i,f){return this.x+=i.x*f,this.y+=i.y*f,this.z+=i.z*f,this.w+=i.w*f,this}sub(i,f){return f!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,f)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this.w-=i.w,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this.w-=i,this}subVectors(i,f){return this.x=i.x-f.x,this.y=i.y-f.y,this.z=i.z-f.z,this.w=i.w-f.w,this}multiply(i){return this.x*=i.x,this.y*=i.y,this.z*=i.z,this.w*=i.w,this}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this}applyMatrix4(i){const f=this.x,y=this.y,_=this.z,S=this.w,I=i.elements;return this.x=I[0]*f+I[4]*y+I[8]*_+I[12]*S,this.y=I[1]*f+I[5]*y+I[9]*_+I[13]*S,this.z=I[2]*f+I[6]*y+I[10]*_+I[14]*S,this.w=I[3]*f+I[7]*y+I[11]*_+I[15]*S,this}divideScalar(i){return this.multiplyScalar(1/i)}setAxisAngleFromQuaternion(i){this.w=2*Math.acos(i.w);const f=Math.sqrt(1-i.w*i.w);return f<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=i.x/f,this.y=i.y/f,this.z=i.z/f),this}setAxisAngleFromRotationMatrix(i){let f,y,_,S;const D=i.elements,F=D[0],G=D[4],W=D[8],Z=D[1],K=D[5],oe=D[9],de=D[2],ke=D[6],pe=D[10];if(Math.abs(G-Z)<.01&&Math.abs(W-de)<.01&&Math.abs(oe-ke)<.01){if(Math.abs(G+Z)<.1&&Math.abs(W+de)<.1&&Math.abs(oe+ke)<.1&&Math.abs(F+K+pe-3)<.1)return this.set(1,0,0,0),this;f=Math.PI;const Ye=(F+1)/2,$e=(K+1)/2,_t=(pe+1)/2,bt=(G+Z)/4,Vt=(W+de)/4,qt=(oe+ke)/4;return Ye>$e&&Ye>_t?Ye<.01?(y=0,_=.707106781,S=.707106781):(y=Math.sqrt(Ye),_=bt/y,S=Vt/y):$e>_t?$e<.01?(y=.707106781,_=0,S=.707106781):(_=Math.sqrt($e),y=bt/_,S=qt/_):_t<.01?(y=.707106781,_=.707106781,S=0):(S=Math.sqrt(_t),y=Vt/S,_=qt/S),this.set(y,_,S,f),this}let Ve=Math.sqrt((ke-oe)*(ke-oe)+(W-de)*(W-de)+(Z-G)*(Z-G));return Math.abs(Ve)<.001&&(Ve=1),this.x=(ke-oe)/Ve,this.y=(W-de)/Ve,this.z=(Z-G)/Ve,this.w=Math.acos((F+K+pe-1)/2),this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this.w=Math.min(this.w,i.w),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this}clamp(i,f){return this.x=Math.max(i.x,Math.min(f.x,this.x)),this.y=Math.max(i.y,Math.min(f.y,this.y)),this.z=Math.max(i.z,Math.min(f.z,this.z)),this.w=Math.max(i.w,Math.min(f.w,this.w)),this}clampScalar(i,f){return this.x=Math.max(i,Math.min(f,this.x)),this.y=Math.max(i,Math.min(f,this.y)),this.z=Math.max(i,Math.min(f,this.z)),this.w=Math.max(i,Math.min(f,this.w)),this}clampLength(i,f){const y=this.length();return this.divideScalar(y||1).multiplyScalar(Math.max(i,Math.min(f,y)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z+this.w*i.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,f){return this.x+=(i.x-this.x)*f,this.y+=(i.y-this.y)*f,this.z+=(i.z-this.z)*f,this.w+=(i.w-this.w)*f,this}lerpVectors(i,f,y){return this.x=i.x+(f.x-i.x)*y,this.y=i.y+(f.y-i.y)*y,this.z=i.z+(f.z-i.z)*y,this.w=i.w+(f.w-i.w)*y,this}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z&&i.w===this.w}fromArray(i,f=0){return this.x=i[f],this.y=i[f+1],this.z=i[f+2],this.w=i[f+3],this}toArray(i=[],f=0){return i[f]=this.x,i[f+1]=this.y,i[f+2]=this.z,i[f+3]=this.w,i}fromBufferAttribute(i,f,y){return y!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(f),this.y=i.getY(f),this.z=i.getZ(f),this.w=i.getW(f),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Fe.prototype.isVector4=!0;class nt extends en{constructor(i,f,y={}){super(),this.width=i,this.height=f,this.depth=1,this.scissor=new Fe(0,0,i,f),this.scissorTest=!1,this.viewport=new Fe(0,0,i,f),this.texture=new le(void 0,y.mapping,y.wrapS,y.wrapT,y.magFilter,y.minFilter,y.format,y.type,y.anisotropy,y.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:i,height:f,depth:1},this.texture.generateMipmaps=y.generateMipmaps!==void 0&&y.generateMipmaps,this.texture.internalFormat=y.internalFormat!==void 0?y.internalFormat:null,this.texture.minFilter=y.minFilter!==void 0?y.minFilter:1006,this.depthBuffer=y.depthBuffer===void 0||y.depthBuffer,this.stencilBuffer=y.stencilBuffer!==void 0&&y.stencilBuffer,this.depthTexture=y.depthTexture!==void 0?y.depthTexture:null}setTexture(i){i.image={width:this.width,height:this.height,depth:this.depth},this.texture=i}setSize(i,f,y=1){this.width===i&&this.height===f&&this.depth===y||(this.width=i,this.height=f,this.depth=y,this.texture.image.width=i,this.texture.image.height=f,this.texture.image.depth=y,this.dispose()),this.viewport.set(0,0,i,f),this.scissor.set(0,0,i,f)}clone(){return new this.constructor().copy(this)}copy(i){return this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.copy(i.viewport),this.texture=i.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}nt.prototype.isWebGLRenderTarget=!0;class kt extends nt{constructor(i,f,y){super(i,f);const _=this.texture;this.texture=[];for(let S=0;S<y;S++)this.texture[S]=_.clone()}setSize(i,f,y=1){if(this.width!==i||this.height!==f||this.depth!==y){this.width=i,this.height=f,this.depth=y;for(let _=0,S=this.texture.length;_<S;_++)this.texture[_].image.width=i,this.texture[_].image.height=f,this.texture[_].image.depth=y;this.dispose()}return this.viewport.set(0,0,i,f),this.scissor.set(0,0,i,f),this}copy(i){this.dispose(),this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.texture.length=0;for(let f=0,y=i.texture.length;f<y;f++)this.texture[f]=i.texture[f].clone();return this}}kt.prototype.isWebGLMultipleRenderTargets=!0;class Tt extends nt{constructor(i,f,y){super(i,f,y),this.samples=4}copy(i){return super.copy.call(this,i),this.samples=i.samples,this}}Tt.prototype.isWebGLMultisampleRenderTarget=!0;class at{constructor(i=0,f=0,y=0,_=1){this._x=i,this._y=f,this._z=y,this._w=_}static slerp(i,f,y,_){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),y.slerpQuaternions(i,f,_)}static slerpFlat(i,f,y,_,S,I,R){let D=y[_+0],F=y[_+1],G=y[_+2],W=y[_+3];const Z=S[I+0],K=S[I+1],oe=S[I+2],de=S[I+3];if(R===0)return i[f+0]=D,i[f+1]=F,i[f+2]=G,void(i[f+3]=W);if(R===1)return i[f+0]=Z,i[f+1]=K,i[f+2]=oe,void(i[f+3]=de);if(W!==de||D!==Z||F!==K||G!==oe){let ke=1-R;const pe=D*Z+F*K+G*oe+W*de,Ve=pe>=0?1:-1,Ye=1-pe*pe;if(Ye>Number.EPSILON){const _t=Math.sqrt(Ye),bt=Math.atan2(_t,pe*Ve);ke=Math.sin(ke*bt)/_t,R=Math.sin(R*bt)/_t}const $e=R*Ve;if(D=D*ke+Z*$e,F=F*ke+K*$e,G=G*ke+oe*$e,W=W*ke+de*$e,ke===1-R){const _t=1/Math.sqrt(D*D+F*F+G*G+W*W);D*=_t,F*=_t,G*=_t,W*=_t}}i[f]=D,i[f+1]=F,i[f+2]=G,i[f+3]=W}static multiplyQuaternionsFlat(i,f,y,_,S,I){const R=y[_],D=y[_+1],F=y[_+2],G=y[_+3],W=S[I],Z=S[I+1],K=S[I+2],oe=S[I+3];return i[f]=R*oe+G*W+D*K-F*Z,i[f+1]=D*oe+G*Z+F*W-R*K,i[f+2]=F*oe+G*K+R*Z-D*W,i[f+3]=G*oe-R*W-D*Z-F*K,i}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get w(){return this._w}set w(i){this._w=i,this._onChangeCallback()}set(i,f,y,_){return this._x=i,this._y=f,this._z=y,this._w=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(i){return this._x=i.x,this._y=i.y,this._z=i.z,this._w=i.w,this._onChangeCallback(),this}setFromEuler(i,f){if(!i||!i.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const y=i._x,_=i._y,S=i._z,I=i._order,R=Math.cos,D=Math.sin,F=R(y/2),G=R(_/2),W=R(S/2),Z=D(y/2),K=D(_/2),oe=D(S/2);switch(I){case"XYZ":this._x=Z*G*W+F*K*oe,this._y=F*K*W-Z*G*oe,this._z=F*G*oe+Z*K*W,this._w=F*G*W-Z*K*oe;break;case"YXZ":this._x=Z*G*W+F*K*oe,this._y=F*K*W-Z*G*oe,this._z=F*G*oe-Z*K*W,this._w=F*G*W+Z*K*oe;break;case"ZXY":this._x=Z*G*W-F*K*oe,this._y=F*K*W+Z*G*oe,this._z=F*G*oe+Z*K*W,this._w=F*G*W-Z*K*oe;break;case"ZYX":this._x=Z*G*W-F*K*oe,this._y=F*K*W+Z*G*oe,this._z=F*G*oe-Z*K*W,this._w=F*G*W+Z*K*oe;break;case"YZX":this._x=Z*G*W+F*K*oe,this._y=F*K*W+Z*G*oe,this._z=F*G*oe-Z*K*W,this._w=F*G*W-Z*K*oe;break;case"XZY":this._x=Z*G*W-F*K*oe,this._y=F*K*W-Z*G*oe,this._z=F*G*oe+Z*K*W,this._w=F*G*W+Z*K*oe;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+I)}return f!==!1&&this._onChangeCallback(),this}setFromAxisAngle(i,f){const y=f/2,_=Math.sin(y);return this._x=i.x*_,this._y=i.y*_,this._z=i.z*_,this._w=Math.cos(y),this._onChangeCallback(),this}setFromRotationMatrix(i){const f=i.elements,y=f[0],_=f[4],S=f[8],I=f[1],R=f[5],D=f[9],F=f[2],G=f[6],W=f[10],Z=y+R+W;if(Z>0){const K=.5/Math.sqrt(Z+1);this._w=.25/K,this._x=(G-D)*K,this._y=(S-F)*K,this._z=(I-_)*K}else if(y>R&&y>W){const K=2*Math.sqrt(1+y-R-W);this._w=(G-D)/K,this._x=.25*K,this._y=(_+I)/K,this._z=(S+F)/K}else if(R>W){const K=2*Math.sqrt(1+R-y-W);this._w=(S-F)/K,this._x=(_+I)/K,this._y=.25*K,this._z=(D+G)/K}else{const K=2*Math.sqrt(1+W-y-R);this._w=(I-_)/K,this._x=(S+F)/K,this._y=(D+G)/K,this._z=.25*K}return this._onChangeCallback(),this}setFromUnitVectors(i,f){let y=i.dot(f)+1;return y<Number.EPSILON?(y=0,Math.abs(i.x)>Math.abs(i.z)?(this._x=-i.y,this._y=i.x,this._z=0,this._w=y):(this._x=0,this._y=-i.z,this._z=i.y,this._w=y)):(this._x=i.y*f.z-i.z*f.y,this._y=i.z*f.x-i.x*f.z,this._z=i.x*f.y-i.y*f.x,this._w=y),this.normalize()}angleTo(i){return 2*Math.acos(Math.abs(Fr(this.dot(i),-1,1)))}rotateTowards(i,f){const y=this.angleTo(i);if(y===0)return this;const _=Math.min(1,f/y);return this.slerp(i,_),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(i){return this._x*i._x+this._y*i._y+this._z*i._z+this._w*i._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let i=this.length();return i===0?(this._x=0,this._y=0,this._z=0,this._w=1):(i=1/i,this._x=this._x*i,this._y=this._y*i,this._z=this._z*i,this._w=this._w*i),this._onChangeCallback(),this}multiply(i,f){return f!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(i,f)):this.multiplyQuaternions(this,i)}premultiply(i){return this.multiplyQuaternions(i,this)}multiplyQuaternions(i,f){const y=i._x,_=i._y,S=i._z,I=i._w,R=f._x,D=f._y,F=f._z,G=f._w;return this._x=y*G+I*R+_*F-S*D,this._y=_*G+I*D+S*R-y*F,this._z=S*G+I*F+y*D-_*R,this._w=I*G-y*R-_*D-S*F,this._onChangeCallback(),this}slerp(i,f){if(f===0)return this;if(f===1)return this.copy(i);const y=this._x,_=this._y,S=this._z,I=this._w;let R=I*i._w+y*i._x+_*i._y+S*i._z;if(R<0?(this._w=-i._w,this._x=-i._x,this._y=-i._y,this._z=-i._z,R=-R):this.copy(i),R>=1)return this._w=I,this._x=y,this._y=_,this._z=S,this;const D=1-R*R;if(D<=Number.EPSILON){const K=1-f;return this._w=K*I+f*this._w,this._x=K*y+f*this._x,this._y=K*_+f*this._y,this._z=K*S+f*this._z,this.normalize(),this._onChangeCallback(),this}const F=Math.sqrt(D),G=Math.atan2(F,R),W=Math.sin((1-f)*G)/F,Z=Math.sin(f*G)/F;return this._w=I*W+this._w*Z,this._x=y*W+this._x*Z,this._y=_*W+this._y*Z,this._z=S*W+this._z*Z,this._onChangeCallback(),this}slerpQuaternions(i,f,y){this.copy(i).slerp(f,y)}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._w===this._w}fromArray(i,f=0){return this._x=i[f],this._y=i[f+1],this._z=i[f+2],this._w=i[f+3],this._onChangeCallback(),this}toArray(i=[],f=0){return i[f]=this._x,i[f+1]=this._y,i[f+2]=this._z,i[f+3]=this._w,i}fromBufferAttribute(i,f){return this._x=i.getX(f),this._y=i.getY(f),this._z=i.getZ(f),this._w=i.getW(f),this}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}at.prototype.isQuaternion=!0;class me{constructor(i=0,f=0,y=0){this.x=i,this.y=f,this.z=y}set(i,f,y){return y===void 0&&(y=this.z),this.x=i,this.y=f,this.z=y,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setComponent(i,f){switch(i){case 0:this.x=f;break;case 1:this.y=f;break;case 2:this.z=f;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this}add(i,f){return f!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,f)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this}addVectors(i,f){return this.x=i.x+f.x,this.y=i.y+f.y,this.z=i.z+f.z,this}addScaledVector(i,f){return this.x+=i.x*f,this.y+=i.y*f,this.z+=i.z*f,this}sub(i,f){return f!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,f)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this}subVectors(i,f){return this.x=i.x-f.x,this.y=i.y-f.y,this.z=i.z-f.z,this}multiply(i,f){return f!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(i,f)):(this.x*=i.x,this.y*=i.y,this.z*=i.z,this)}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this}multiplyVectors(i,f){return this.x=i.x*f.x,this.y=i.y*f.y,this.z=i.z*f.z,this}applyEuler(i){return i&&i.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Mn.setFromEuler(i))}applyAxisAngle(i,f){return this.applyQuaternion(Mn.setFromAxisAngle(i,f))}applyMatrix3(i){const f=this.x,y=this.y,_=this.z,S=i.elements;return this.x=S[0]*f+S[3]*y+S[6]*_,this.y=S[1]*f+S[4]*y+S[7]*_,this.z=S[2]*f+S[5]*y+S[8]*_,this}applyNormalMatrix(i){return this.applyMatrix3(i).normalize()}applyMatrix4(i){const f=this.x,y=this.y,_=this.z,S=i.elements,I=1/(S[3]*f+S[7]*y+S[11]*_+S[15]);return this.x=(S[0]*f+S[4]*y+S[8]*_+S[12])*I,this.y=(S[1]*f+S[5]*y+S[9]*_+S[13])*I,this.z=(S[2]*f+S[6]*y+S[10]*_+S[14])*I,this}applyQuaternion(i){const f=this.x,y=this.y,_=this.z,S=i.x,I=i.y,R=i.z,D=i.w,F=D*f+I*_-R*y,G=D*y+R*f-S*_,W=D*_+S*y-I*f,Z=-S*f-I*y-R*_;return this.x=F*D+Z*-S+G*-R-W*-I,this.y=G*D+Z*-I+W*-S-F*-R,this.z=W*D+Z*-R+F*-I-G*-S,this}project(i){return this.applyMatrix4(i.matrixWorldInverse).applyMatrix4(i.projectionMatrix)}unproject(i){return this.applyMatrix4(i.projectionMatrixInverse).applyMatrix4(i.matrixWorld)}transformDirection(i){const f=this.x,y=this.y,_=this.z,S=i.elements;return this.x=S[0]*f+S[4]*y+S[8]*_,this.y=S[1]*f+S[5]*y+S[9]*_,this.z=S[2]*f+S[6]*y+S[10]*_,this.normalize()}divide(i){return this.x/=i.x,this.y/=i.y,this.z/=i.z,this}divideScalar(i){return this.multiplyScalar(1/i)}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this}clamp(i,f){return this.x=Math.max(i.x,Math.min(f.x,this.x)),this.y=Math.max(i.y,Math.min(f.y,this.y)),this.z=Math.max(i.z,Math.min(f.z,this.z)),this}clampScalar(i,f){return this.x=Math.max(i,Math.min(f,this.x)),this.y=Math.max(i,Math.min(f,this.y)),this.z=Math.max(i,Math.min(f,this.z)),this}clampLength(i,f){const y=this.length();return this.divideScalar(y||1).multiplyScalar(Math.max(i,Math.min(f,y)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,f){return this.x+=(i.x-this.x)*f,this.y+=(i.y-this.y)*f,this.z+=(i.z-this.z)*f,this}lerpVectors(i,f,y){return this.x=i.x+(f.x-i.x)*y,this.y=i.y+(f.y-i.y)*y,this.z=i.z+(f.z-i.z)*y,this}cross(i,f){return f!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(i,f)):this.crossVectors(this,i)}crossVectors(i,f){const y=i.x,_=i.y,S=i.z,I=f.x,R=f.y,D=f.z;return this.x=_*D-S*R,this.y=S*I-y*D,this.z=y*R-_*I,this}projectOnVector(i){const f=i.lengthSq();if(f===0)return this.set(0,0,0);const y=i.dot(this)/f;return this.copy(i).multiplyScalar(y)}projectOnPlane(i){return fn.copy(this).projectOnVector(i),this.sub(fn)}reflect(i){return this.sub(fn.copy(i).multiplyScalar(2*this.dot(i)))}angleTo(i){const f=Math.sqrt(this.lengthSq()*i.lengthSq());if(f===0)return Math.PI/2;const y=this.dot(i)/f;return Math.acos(Fr(y,-1,1))}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const f=this.x-i.x,y=this.y-i.y,_=this.z-i.z;return f*f+y*y+_*_}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)+Math.abs(this.z-i.z)}setFromSpherical(i){return this.setFromSphericalCoords(i.radius,i.phi,i.theta)}setFromSphericalCoords(i,f,y){const _=Math.sin(f)*i;return this.x=_*Math.sin(y),this.y=Math.cos(f)*i,this.z=_*Math.cos(y),this}setFromCylindrical(i){return this.setFromCylindricalCoords(i.radius,i.theta,i.y)}setFromCylindricalCoords(i,f,y){return this.x=i*Math.sin(f),this.y=y,this.z=i*Math.cos(f),this}setFromMatrixPosition(i){const f=i.elements;return this.x=f[12],this.y=f[13],this.z=f[14],this}setFromMatrixScale(i){const f=this.setFromMatrixColumn(i,0).length(),y=this.setFromMatrixColumn(i,1).length(),_=this.setFromMatrixColumn(i,2).length();return this.x=f,this.y=y,this.z=_,this}setFromMatrixColumn(i,f){return this.fromArray(i.elements,4*f)}setFromMatrix3Column(i,f){return this.fromArray(i.elements,3*f)}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z}fromArray(i,f=0){return this.x=i[f],this.y=i[f+1],this.z=i[f+2],this}toArray(i=[],f=0){return i[f]=this.x,i[f+1]=this.y,i[f+2]=this.z,i}fromBufferAttribute(i,f,y){return y!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(f),this.y=i.getY(f),this.z=i.getZ(f),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}me.prototype.isVector3=!0;const fn=new me,Mn=new at;class Jt{constructor(i=new me(1/0,1/0,1/0),f=new me(-1/0,-1/0,-1/0)){this.min=i,this.max=f}set(i,f){return this.min.copy(i),this.max.copy(f),this}setFromArray(i){let f=1/0,y=1/0,_=1/0,S=-1/0,I=-1/0,R=-1/0;for(let D=0,F=i.length;D<F;D+=3){const G=i[D],W=i[D+1],Z=i[D+2];G<f&&(f=G),W<y&&(y=W),Z<_&&(_=Z),G>S&&(S=G),W>I&&(I=W),Z>R&&(R=Z)}return this.min.set(f,y,_),this.max.set(S,I,R),this}setFromBufferAttribute(i){let f=1/0,y=1/0,_=1/0,S=-1/0,I=-1/0,R=-1/0;for(let D=0,F=i.count;D<F;D++){const G=i.getX(D),W=i.getY(D),Z=i.getZ(D);G<f&&(f=G),W<y&&(y=W),Z<_&&(_=Z),G>S&&(S=G),W>I&&(I=W),Z>R&&(R=Z)}return this.min.set(f,y,_),this.max.set(S,I,R),this}setFromPoints(i){this.makeEmpty();for(let f=0,y=i.length;f<y;f++)this.expandByPoint(i[f]);return this}setFromCenterAndSize(i,f){const y=Cr.copy(f).multiplyScalar(.5);return this.min.copy(i).sub(y),this.max.copy(i).add(y),this}setFromObject(i){return this.makeEmpty(),this.expandByObject(i)}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(i){return this.isEmpty()?i.set(0,0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return this.isEmpty()?i.set(0,0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}expandByObject(i){i.updateWorldMatrix(!1,!1);const f=i.geometry;f!==void 0&&(f.boundingBox===null&&f.computeBoundingBox(),zr.copy(f.boundingBox),zr.applyMatrix4(i.matrixWorld),this.union(zr));const y=i.children;for(let _=0,S=y.length;_<S;_++)this.expandByObject(y[_]);return this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y||i.z<this.min.z||i.z>this.max.z)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y&&this.min.z<=i.min.z&&i.max.z<=this.max.z}getParameter(i,f){return f.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y),(i.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y||i.max.z<this.min.z||i.min.z>this.max.z)}intersectsSphere(i){return this.clampPoint(i.center,Cr),Cr.distanceToSquared(i.center)<=i.radius*i.radius}intersectsPlane(i){let f,y;return i.normal.x>0?(f=i.normal.x*this.min.x,y=i.normal.x*this.max.x):(f=i.normal.x*this.max.x,y=i.normal.x*this.min.x),i.normal.y>0?(f+=i.normal.y*this.min.y,y+=i.normal.y*this.max.y):(f+=i.normal.y*this.max.y,y+=i.normal.y*this.min.y),i.normal.z>0?(f+=i.normal.z*this.min.z,y+=i.normal.z*this.max.z):(f+=i.normal.z*this.max.z,y+=i.normal.z*this.min.z),f<=-i.constant&&y>=-i.constant}intersectsTriangle(i){if(this.isEmpty())return!1;this.getCenter(xo),Us.subVectors(this.max,xo),Kr.subVectors(i.a,xo),pi.subVectors(i.b,xo),Xi.subVectors(i.c,xo),Hi.subVectors(pi,Kr),Zi.subVectors(Xi,pi),ss.subVectors(Kr,Xi);let f=[0,-Hi.z,Hi.y,0,-Zi.z,Zi.y,0,-ss.z,ss.y,Hi.z,0,-Hi.x,Zi.z,0,-Zi.x,ss.z,0,-ss.x,-Hi.y,Hi.x,0,-Zi.y,Zi.x,0,-ss.y,ss.x,0];return!!xs(f,Kr,pi,Xi,Us)&&(f=[1,0,0,0,1,0,0,0,1],!!xs(f,Kr,pi,Xi,Us)&&(uo.crossVectors(Hi,Zi),f=[uo.x,uo.y,uo.z],xs(f,Kr,pi,Xi,Us)))}clampPoint(i,f){return f.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return Cr.copy(i).clamp(this.min,this.max).sub(i).length()}getBoundingSphere(i){return this.getCenter(i.center),i.radius=.5*this.getSize(Cr).length(),i}intersect(i){return this.min.max(i.min),this.max.min(i.max),this.isEmpty()&&this.makeEmpty(),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}applyMatrix4(i){return this.isEmpty()||(mr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(i),mr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(i),mr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(i),mr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(i),mr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(i),mr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(i),mr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(i),mr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(i),this.setFromPoints(mr)),this}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}Jt.prototype.isBox3=!0;const mr=[new me,new me,new me,new me,new me,new me,new me,new me],Cr=new me,zr=new Jt,Kr=new me,pi=new me,Xi=new me,Hi=new me,Zi=new me,ss=new me,xo=new me,Us=new me,uo=new me,No=new me;function xs(M,i,f,y,_){for(let S=0,I=M.length-3;S<=I;S+=3){No.fromArray(M,S);const R=_.x*Math.abs(No.x)+_.y*Math.abs(No.y)+_.z*Math.abs(No.z),D=i.dot(No),F=f.dot(No),G=y.dot(No);if(Math.max(-Math.max(D,F,G),Math.min(D,F,G))>R)return!1}return!0}const ea=new Jt,ri=new me,Ia=new me,zl=new me;class tl{constructor(i=new me,f=-1){this.center=i,this.radius=f}set(i,f){return this.center.copy(i),this.radius=f,this}setFromPoints(i,f){const y=this.center;f!==void 0?y.copy(f):ea.setFromPoints(i).getCenter(y);let _=0;for(let S=0,I=i.length;S<I;S++)_=Math.max(_,y.distanceToSquared(i[S]));return this.radius=Math.sqrt(_),this}copy(i){return this.center.copy(i.center),this.radius=i.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(i){return i.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(i){return i.distanceTo(this.center)-this.radius}intersectsSphere(i){const f=this.radius+i.radius;return i.center.distanceToSquared(this.center)<=f*f}intersectsBox(i){return i.intersectsSphere(this)}intersectsPlane(i){return Math.abs(i.distanceToPoint(this.center))<=this.radius}clampPoint(i,f){const y=this.center.distanceToSquared(i);return f.copy(i),y>this.radius*this.radius&&(f.sub(this.center).normalize(),f.multiplyScalar(this.radius).add(this.center)),f}getBoundingBox(i){return this.isEmpty()?(i.makeEmpty(),i):(i.set(this.center,this.center),i.expandByScalar(this.radius),i)}applyMatrix4(i){return this.center.applyMatrix4(i),this.radius=this.radius*i.getMaxScaleOnAxis(),this}translate(i){return this.center.add(i),this}expandByPoint(i){zl.subVectors(i,this.center);const f=zl.lengthSq();if(f>this.radius*this.radius){const y=Math.sqrt(f),_=.5*(y-this.radius);this.center.add(zl.multiplyScalar(_/y)),this.radius+=_}return this}union(i){return Ia.subVectors(i.center,this.center).normalize().multiplyScalar(i.radius),this.expandByPoint(ri.copy(i.center).add(Ia)),this.expandByPoint(ri.copy(i.center).sub(Ia)),this}equals(i){return i.center.equals(this.center)&&i.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Zs=new me,ta=new me,bo=new me,nl=new me,Bc=new me,yl=new me,_l=new me;class rl{constructor(i=new me,f=new me(0,0,-1)){this.origin=i,this.direction=f}set(i,f){return this.origin.copy(i),this.direction.copy(f),this}copy(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this}at(i,f){return f.copy(this.direction).multiplyScalar(i).add(this.origin)}lookAt(i){return this.direction.copy(i).sub(this.origin).normalize(),this}recast(i){return this.origin.copy(this.at(i,Zs)),this}closestPointToPoint(i,f){f.subVectors(i,this.origin);const y=f.dot(this.direction);return y<0?f.copy(this.origin):f.copy(this.direction).multiplyScalar(y).add(this.origin)}distanceToPoint(i){return Math.sqrt(this.distanceSqToPoint(i))}distanceSqToPoint(i){const f=Zs.subVectors(i,this.origin).dot(this.direction);return f<0?this.origin.distanceToSquared(i):(Zs.copy(this.direction).multiplyScalar(f).add(this.origin),Zs.distanceToSquared(i))}distanceSqToSegment(i,f,y,_){ta.copy(i).add(f).multiplyScalar(.5),bo.copy(f).sub(i).normalize(),nl.copy(this.origin).sub(ta);const S=.5*i.distanceTo(f),I=-this.direction.dot(bo),R=nl.dot(this.direction),D=-nl.dot(bo),F=nl.lengthSq(),G=Math.abs(1-I*I);let W,Z,K,oe;if(G>0)if(W=I*D-R,Z=I*R-D,oe=S*G,W>=0)if(Z>=-oe)if(Z<=oe){const de=1/G;W*=de,Z*=de,K=W*(W+I*Z+2*R)+Z*(I*W+Z+2*D)+F}else Z=S,W=Math.max(0,-(I*Z+R)),K=-W*W+Z*(Z+2*D)+F;else Z=-S,W=Math.max(0,-(I*Z+R)),K=-W*W+Z*(Z+2*D)+F;else Z<=-oe?(W=Math.max(0,-(-I*S+R)),Z=W>0?-S:Math.min(Math.max(-S,-D),S),K=-W*W+Z*(Z+2*D)+F):Z<=oe?(W=0,Z=Math.min(Math.max(-S,-D),S),K=Z*(Z+2*D)+F):(W=Math.max(0,-(I*S+R)),Z=W>0?S:Math.min(Math.max(-S,-D),S),K=-W*W+Z*(Z+2*D)+F);else Z=I>0?-S:S,W=Math.max(0,-(I*Z+R)),K=-W*W+Z*(Z+2*D)+F;return y&&y.copy(this.direction).multiplyScalar(W).add(this.origin),_&&_.copy(bo).multiplyScalar(Z).add(ta),K}intersectSphere(i,f){Zs.subVectors(i.center,this.origin);const y=Zs.dot(this.direction),_=Zs.dot(Zs)-y*y,S=i.radius*i.radius;if(_>S)return null;const I=Math.sqrt(S-_),R=y-I,D=y+I;return R<0&&D<0?null:R<0?this.at(D,f):this.at(R,f)}intersectsSphere(i){return this.distanceSqToPoint(i.center)<=i.radius*i.radius}distanceToPlane(i){const f=i.normal.dot(this.direction);if(f===0)return i.distanceToPoint(this.origin)===0?0:null;const y=-(this.origin.dot(i.normal)+i.constant)/f;return y>=0?y:null}intersectPlane(i,f){const y=this.distanceToPlane(i);return y===null?null:this.at(y,f)}intersectsPlane(i){const f=i.distanceToPoint(this.origin);return f===0?!0:i.normal.dot(this.direction)*f<0}intersectBox(i,f){let y,_,S,I,R,D;const F=1/this.direction.x,G=1/this.direction.y,W=1/this.direction.z,Z=this.origin;return F>=0?(y=(i.min.x-Z.x)*F,_=(i.max.x-Z.x)*F):(y=(i.max.x-Z.x)*F,_=(i.min.x-Z.x)*F),G>=0?(S=(i.min.y-Z.y)*G,I=(i.max.y-Z.y)*G):(S=(i.max.y-Z.y)*G,I=(i.min.y-Z.y)*G),y>I||S>_?null:((S>y||y!=y)&&(y=S),(I<_||_!=_)&&(_=I),W>=0?(R=(i.min.z-Z.z)*W,D=(i.max.z-Z.z)*W):(R=(i.max.z-Z.z)*W,D=(i.min.z-Z.z)*W),y>D||R>_?null:((R>y||y!=y)&&(y=R),(D<_||_!=_)&&(_=D),_<0?null:this.at(y>=0?y:_,f)))}intersectsBox(i){return this.intersectBox(i,Zs)!==null}intersectTriangle(i,f,y,_,S){Bc.subVectors(f,i),yl.subVectors(y,i),_l.crossVectors(Bc,yl);let I,R=this.direction.dot(_l);if(R>0){if(_)return null;I=1}else{if(!(R<0))return null;I=-1,R=-R}nl.subVectors(this.origin,i);const D=I*this.direction.dot(yl.crossVectors(nl,yl));if(D<0)return null;const F=I*this.direction.dot(Bc.cross(nl));if(F<0||D+F>R)return null;const G=-I*nl.dot(_l);return G<0?null:this.at(G/R,S)}applyMatrix4(i){return this.origin.applyMatrix4(i),this.direction.transformDirection(i),this}equals(i){return i.origin.equals(this.origin)&&i.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Nt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(i,f,y,_,S,I,R,D,F,G,W,Z,K,oe,de,ke){const pe=this.elements;return pe[0]=i,pe[4]=f,pe[8]=y,pe[12]=_,pe[1]=S,pe[5]=I,pe[9]=R,pe[13]=D,pe[2]=F,pe[6]=G,pe[10]=W,pe[14]=Z,pe[3]=K,pe[7]=oe,pe[11]=de,pe[15]=ke,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Nt().fromArray(this.elements)}copy(i){const f=this.elements,y=i.elements;return f[0]=y[0],f[1]=y[1],f[2]=y[2],f[3]=y[3],f[4]=y[4],f[5]=y[5],f[6]=y[6],f[7]=y[7],f[8]=y[8],f[9]=y[9],f[10]=y[10],f[11]=y[11],f[12]=y[12],f[13]=y[13],f[14]=y[14],f[15]=y[15],this}copyPosition(i){const f=this.elements,y=i.elements;return f[12]=y[12],f[13]=y[13],f[14]=y[14],this}setFromMatrix3(i){const f=i.elements;return this.set(f[0],f[3],f[6],0,f[1],f[4],f[7],0,f[2],f[5],f[8],0,0,0,0,1),this}extractBasis(i,f,y){return i.setFromMatrixColumn(this,0),f.setFromMatrixColumn(this,1),y.setFromMatrixColumn(this,2),this}makeBasis(i,f,y){return this.set(i.x,f.x,y.x,0,i.y,f.y,y.y,0,i.z,f.z,y.z,0,0,0,0,1),this}extractRotation(i){const f=this.elements,y=i.elements,_=1/ko.setFromMatrixColumn(i,0).length(),S=1/ko.setFromMatrixColumn(i,1).length(),I=1/ko.setFromMatrixColumn(i,2).length();return f[0]=y[0]*_,f[1]=y[1]*_,f[2]=y[2]*_,f[3]=0,f[4]=y[4]*S,f[5]=y[5]*S,f[6]=y[6]*S,f[7]=0,f[8]=y[8]*I,f[9]=y[9]*I,f[10]=y[10]*I,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,this}makeRotationFromEuler(i){i&&i.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const f=this.elements,y=i.x,_=i.y,S=i.z,I=Math.cos(y),R=Math.sin(y),D=Math.cos(_),F=Math.sin(_),G=Math.cos(S),W=Math.sin(S);if(i.order==="XYZ"){const Z=I*G,K=I*W,oe=R*G,de=R*W;f[0]=D*G,f[4]=-D*W,f[8]=F,f[1]=K+oe*F,f[5]=Z-de*F,f[9]=-R*D,f[2]=de-Z*F,f[6]=oe+K*F,f[10]=I*D}else if(i.order==="YXZ"){const Z=D*G,K=D*W,oe=F*G,de=F*W;f[0]=Z+de*R,f[4]=oe*R-K,f[8]=I*F,f[1]=I*W,f[5]=I*G,f[9]=-R,f[2]=K*R-oe,f[6]=de+Z*R,f[10]=I*D}else if(i.order==="ZXY"){const Z=D*G,K=D*W,oe=F*G,de=F*W;f[0]=Z-de*R,f[4]=-I*W,f[8]=oe+K*R,f[1]=K+oe*R,f[5]=I*G,f[9]=de-Z*R,f[2]=-I*F,f[6]=R,f[10]=I*D}else if(i.order==="ZYX"){const Z=I*G,K=I*W,oe=R*G,de=R*W;f[0]=D*G,f[4]=oe*F-K,f[8]=Z*F+de,f[1]=D*W,f[5]=de*F+Z,f[9]=K*F-oe,f[2]=-F,f[6]=R*D,f[10]=I*D}else if(i.order==="YZX"){const Z=I*D,K=I*F,oe=R*D,de=R*F;f[0]=D*G,f[4]=de-Z*W,f[8]=oe*W+K,f[1]=W,f[5]=I*G,f[9]=-R*G,f[2]=-F*G,f[6]=K*W+oe,f[10]=Z-de*W}else if(i.order==="XZY"){const Z=I*D,K=I*F,oe=R*D,de=R*F;f[0]=D*G,f[4]=-W,f[8]=F*G,f[1]=Z*W+de,f[5]=I*G,f[9]=K*W-oe,f[2]=oe*W-K,f[6]=R*G,f[10]=de*W+Z}return f[3]=0,f[7]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,this}makeRotationFromQuaternion(i){return this.compose(Ds,i,Tp)}lookAt(i,f,y){const _=this.elements;return Aa.subVectors(i,f),Aa.lengthSq()===0&&(Aa.z=1),Aa.normalize(),Uo.crossVectors(y,Aa),Uo.lengthSq()===0&&(Math.abs(y.z)===1?Aa.x+=1e-4:Aa.z+=1e-4,Aa.normalize(),Uo.crossVectors(y,Aa)),Uo.normalize(),Uc.crossVectors(Aa,Uo),_[0]=Uo.x,_[4]=Uc.x,_[8]=Aa.x,_[1]=Uo.y,_[5]=Uc.y,_[9]=Aa.y,_[2]=Uo.z,_[6]=Uc.z,_[10]=Aa.z,this}multiply(i,f){return f!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(i,f)):this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,f){const y=i.elements,_=f.elements,S=this.elements,I=y[0],R=y[4],D=y[8],F=y[12],G=y[1],W=y[5],Z=y[9],K=y[13],oe=y[2],de=y[6],ke=y[10],pe=y[14],Ve=y[3],Ye=y[7],$e=y[11],_t=y[15],bt=_[0],Vt=_[4],qt=_[8],mn=_[12],sn=_[1],dn=_[5],wr=_[9],er=_[13],Pn=_[2],ir=_[6],Or=_[10],jr=_[14],si=_[3],gi=_[7],yi=_[11],sr=_[15];return S[0]=I*bt+R*sn+D*Pn+F*si,S[4]=I*Vt+R*dn+D*ir+F*gi,S[8]=I*qt+R*wr+D*Or+F*yi,S[12]=I*mn+R*er+D*jr+F*sr,S[1]=G*bt+W*sn+Z*Pn+K*si,S[5]=G*Vt+W*dn+Z*ir+K*gi,S[9]=G*qt+W*wr+Z*Or+K*yi,S[13]=G*mn+W*er+Z*jr+K*sr,S[2]=oe*bt+de*sn+ke*Pn+pe*si,S[6]=oe*Vt+de*dn+ke*ir+pe*gi,S[10]=oe*qt+de*wr+ke*Or+pe*yi,S[14]=oe*mn+de*er+ke*jr+pe*sr,S[3]=Ve*bt+Ye*sn+$e*Pn+_t*si,S[7]=Ve*Vt+Ye*dn+$e*ir+_t*gi,S[11]=Ve*qt+Ye*wr+$e*Or+_t*yi,S[15]=Ve*mn+Ye*er+$e*jr+_t*sr,this}multiplyScalar(i){const f=this.elements;return f[0]*=i,f[4]*=i,f[8]*=i,f[12]*=i,f[1]*=i,f[5]*=i,f[9]*=i,f[13]*=i,f[2]*=i,f[6]*=i,f[10]*=i,f[14]*=i,f[3]*=i,f[7]*=i,f[11]*=i,f[15]*=i,this}determinant(){const i=this.elements,f=i[0],y=i[4],_=i[8],S=i[12],I=i[1],R=i[5],D=i[9],F=i[13],G=i[2],W=i[6],Z=i[10],K=i[14];return i[3]*(+S*D*W-_*F*W-S*R*Z+y*F*Z+_*R*K-y*D*K)+i[7]*(+f*D*K-f*F*Z+S*I*Z-_*I*K+_*F*G-S*D*G)+i[11]*(+f*F*W-f*R*K-S*I*W+y*I*K+S*R*G-y*F*G)+i[15]*(-_*R*G-f*D*W+f*R*Z+_*I*W-y*I*Z+y*D*G)}transpose(){const i=this.elements;let f;return f=i[1],i[1]=i[4],i[4]=f,f=i[2],i[2]=i[8],i[8]=f,f=i[6],i[6]=i[9],i[9]=f,f=i[3],i[3]=i[12],i[12]=f,f=i[7],i[7]=i[13],i[13]=f,f=i[11],i[11]=i[14],i[14]=f,this}setPosition(i,f,y){const _=this.elements;return i.isVector3?(_[12]=i.x,_[13]=i.y,_[14]=i.z):(_[12]=i,_[13]=f,_[14]=y),this}invert(){const i=this.elements,f=i[0],y=i[1],_=i[2],S=i[3],I=i[4],R=i[5],D=i[6],F=i[7],G=i[8],W=i[9],Z=i[10],K=i[11],oe=i[12],de=i[13],ke=i[14],pe=i[15],Ve=W*ke*F-de*Z*F+de*D*K-R*ke*K-W*D*pe+R*Z*pe,Ye=oe*Z*F-G*ke*F-oe*D*K+I*ke*K+G*D*pe-I*Z*pe,$e=G*de*F-oe*W*F+oe*R*K-I*de*K-G*R*pe+I*W*pe,_t=oe*W*D-G*de*D-oe*R*Z+I*de*Z+G*R*ke-I*W*ke,bt=f*Ve+y*Ye+_*$e+S*_t;if(bt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Vt=1/bt;return i[0]=Ve*Vt,i[1]=(de*Z*S-W*ke*S-de*_*K+y*ke*K+W*_*pe-y*Z*pe)*Vt,i[2]=(R*ke*S-de*D*S+de*_*F-y*ke*F-R*_*pe+y*D*pe)*Vt,i[3]=(W*D*S-R*Z*S-W*_*F+y*Z*F+R*_*K-y*D*K)*Vt,i[4]=Ye*Vt,i[5]=(G*ke*S-oe*Z*S+oe*_*K-f*ke*K-G*_*pe+f*Z*pe)*Vt,i[6]=(oe*D*S-I*ke*S-oe*_*F+f*ke*F+I*_*pe-f*D*pe)*Vt,i[7]=(I*Z*S-G*D*S+G*_*F-f*Z*F-I*_*K+f*D*K)*Vt,i[8]=$e*Vt,i[9]=(oe*W*S-G*de*S-oe*y*K+f*de*K+G*y*pe-f*W*pe)*Vt,i[10]=(I*de*S-oe*R*S+oe*y*F-f*de*F-I*y*pe+f*R*pe)*Vt,i[11]=(G*R*S-I*W*S-G*y*F+f*W*F+I*y*K-f*R*K)*Vt,i[12]=_t*Vt,i[13]=(G*de*_-oe*W*_+oe*y*Z-f*de*Z-G*y*ke+f*W*ke)*Vt,i[14]=(oe*R*_-I*de*_-oe*y*D+f*de*D+I*y*ke-f*R*ke)*Vt,i[15]=(I*W*_-G*R*_+G*y*D-f*W*D-I*y*Z+f*R*Z)*Vt,this}scale(i){const f=this.elements,y=i.x,_=i.y,S=i.z;return f[0]*=y,f[4]*=_,f[8]*=S,f[1]*=y,f[5]*=_,f[9]*=S,f[2]*=y,f[6]*=_,f[10]*=S,f[3]*=y,f[7]*=_,f[11]*=S,this}getMaxScaleOnAxis(){const i=this.elements,f=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],y=i[4]*i[4]+i[5]*i[5]+i[6]*i[6],_=i[8]*i[8]+i[9]*i[9]+i[10]*i[10];return Math.sqrt(Math.max(f,y,_))}makeTranslation(i,f,y){return this.set(1,0,0,i,0,1,0,f,0,0,1,y,0,0,0,1),this}makeRotationX(i){const f=Math.cos(i),y=Math.sin(i);return this.set(1,0,0,0,0,f,-y,0,0,y,f,0,0,0,0,1),this}makeRotationY(i){const f=Math.cos(i),y=Math.sin(i);return this.set(f,0,y,0,0,1,0,0,-y,0,f,0,0,0,0,1),this}makeRotationZ(i){const f=Math.cos(i),y=Math.sin(i);return this.set(f,-y,0,0,y,f,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(i,f){const y=Math.cos(f),_=Math.sin(f),S=1-y,I=i.x,R=i.y,D=i.z,F=S*I,G=S*R;return this.set(F*I+y,F*R-_*D,F*D+_*R,0,F*R+_*D,G*R+y,G*D-_*I,0,F*D-_*R,G*D+_*I,S*D*D+y,0,0,0,0,1),this}makeScale(i,f,y){return this.set(i,0,0,0,0,f,0,0,0,0,y,0,0,0,0,1),this}makeShear(i,f,y,_,S,I){return this.set(1,y,S,0,i,1,I,0,f,_,1,0,0,0,0,1),this}compose(i,f,y){const _=this.elements,S=f._x,I=f._y,R=f._z,D=f._w,F=S+S,G=I+I,W=R+R,Z=S*F,K=S*G,oe=S*W,de=I*G,ke=I*W,pe=R*W,Ve=D*F,Ye=D*G,$e=D*W,_t=y.x,bt=y.y,Vt=y.z;return _[0]=(1-(de+pe))*_t,_[1]=(K+$e)*_t,_[2]=(oe-Ye)*_t,_[3]=0,_[4]=(K-$e)*bt,_[5]=(1-(Z+pe))*bt,_[6]=(ke+Ve)*bt,_[7]=0,_[8]=(oe+Ye)*Vt,_[9]=(ke-Ve)*Vt,_[10]=(1-(Z+de))*Vt,_[11]=0,_[12]=i.x,_[13]=i.y,_[14]=i.z,_[15]=1,this}decompose(i,f,y){const _=this.elements;let S=ko.set(_[0],_[1],_[2]).length();const I=ko.set(_[4],_[5],_[6]).length(),R=ko.set(_[8],_[9],_[10]).length();this.determinant()<0&&(S=-S),i.x=_[12],i.y=_[13],i.z=_[14],ns.copy(this);const D=1/S,F=1/I,G=1/R;return ns.elements[0]*=D,ns.elements[1]*=D,ns.elements[2]*=D,ns.elements[4]*=F,ns.elements[5]*=F,ns.elements[6]*=F,ns.elements[8]*=G,ns.elements[9]*=G,ns.elements[10]*=G,f.setFromRotationMatrix(ns),y.x=S,y.y=I,y.z=R,this}makePerspective(i,f,y,_,S,I){I===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const R=this.elements,D=2*S/(f-i),F=2*S/(y-_),G=(f+i)/(f-i),W=(y+_)/(y-_),Z=-(I+S)/(I-S),K=-2*I*S/(I-S);return R[0]=D,R[4]=0,R[8]=G,R[12]=0,R[1]=0,R[5]=F,R[9]=W,R[13]=0,R[2]=0,R[6]=0,R[10]=Z,R[14]=K,R[3]=0,R[7]=0,R[11]=-1,R[15]=0,this}makeOrthographic(i,f,y,_,S,I){const R=this.elements,D=1/(f-i),F=1/(y-_),G=1/(I-S),W=(f+i)*D,Z=(y+_)*F,K=(I+S)*G;return R[0]=2*D,R[4]=0,R[8]=0,R[12]=-W,R[1]=0,R[5]=2*F,R[9]=0,R[13]=-Z,R[2]=0,R[6]=0,R[10]=-2*G,R[14]=-K,R[3]=0,R[7]=0,R[11]=0,R[15]=1,this}equals(i){const f=this.elements,y=i.elements;for(let _=0;_<16;_++)if(f[_]!==y[_])return!1;return!0}fromArray(i,f=0){for(let y=0;y<16;y++)this.elements[y]=i[y+f];return this}toArray(i=[],f=0){const y=this.elements;return i[f]=y[0],i[f+1]=y[1],i[f+2]=y[2],i[f+3]=y[3],i[f+4]=y[4],i[f+5]=y[5],i[f+6]=y[6],i[f+7]=y[7],i[f+8]=y[8],i[f+9]=y[9],i[f+10]=y[10],i[f+11]=y[11],i[f+12]=y[12],i[f+13]=y[13],i[f+14]=y[14],i[f+15]=y[15],i}}Nt.prototype.isMatrix4=!0;const ko=new me,ns=new Nt,Ds=new me(0,0,0),Tp=new me(1,1,1),Uo=new me,Uc=new me,Aa=new me,hc=new Nt,ur=new at;class Ei{constructor(i=0,f=0,y=0,_=Ei.DefaultOrder){this._x=i,this._y=f,this._z=y,this._order=_}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get order(){return this._order}set order(i){this._order=i,this._onChangeCallback()}set(i,f,y,_=this._order){return this._x=i,this._y=f,this._z=y,this._order=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(i){return this._x=i._x,this._y=i._y,this._z=i._z,this._order=i._order,this._onChangeCallback(),this}setFromRotationMatrix(i,f=this._order,y=!0){const _=i.elements,S=_[0],I=_[4],R=_[8],D=_[1],F=_[5],G=_[9],W=_[2],Z=_[6],K=_[10];switch(f){case"XYZ":this._y=Math.asin(Fr(R,-1,1)),Math.abs(R)<.9999999?(this._x=Math.atan2(-G,K),this._z=Math.atan2(-I,S)):(this._x=Math.atan2(Z,F),this._z=0);break;case"YXZ":this._x=Math.asin(-Fr(G,-1,1)),Math.abs(G)<.9999999?(this._y=Math.atan2(R,K),this._z=Math.atan2(D,F)):(this._y=Math.atan2(-W,S),this._z=0);break;case"ZXY":this._x=Math.asin(Fr(Z,-1,1)),Math.abs(Z)<.9999999?(this._y=Math.atan2(-W,K),this._z=Math.atan2(-I,F)):(this._y=0,this._z=Math.atan2(D,S));break;case"ZYX":this._y=Math.asin(-Fr(W,-1,1)),Math.abs(W)<.9999999?(this._x=Math.atan2(Z,K),this._z=Math.atan2(D,S)):(this._x=0,this._z=Math.atan2(-I,F));break;case"YZX":this._z=Math.asin(Fr(D,-1,1)),Math.abs(D)<.9999999?(this._x=Math.atan2(-G,F),this._y=Math.atan2(-W,S)):(this._x=0,this._y=Math.atan2(R,K));break;case"XZY":this._z=Math.asin(-Fr(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(Z,F),this._y=Math.atan2(R,S)):(this._x=Math.atan2(-G,K),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+f)}return this._order=f,y===!0&&this._onChangeCallback(),this}setFromQuaternion(i,f,y){return hc.makeRotationFromQuaternion(i),this.setFromRotationMatrix(hc,f,y)}setFromVector3(i,f=this._order){return this.set(i.x,i.y,i.z,f)}reorder(i){return ur.setFromEuler(this),this.setFromQuaternion(ur,i)}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order}fromArray(i){return this._x=i[0],this._y=i[1],this._z=i[2],i[3]!==void 0&&(this._order=i[3]),this._onChangeCallback(),this}toArray(i=[],f=0){return i[f]=this._x,i[f+1]=this._y,i[f+2]=this._z,i[f+3]=this._order,i}toVector3(i){return i?i.set(this._x,this._y,this._z):new me(this._x,this._y,this._z)}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}Ei.prototype.isEuler=!0,Ei.DefaultOrder="XYZ",Ei.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Si{constructor(){this.mask=1}set(i){this.mask=1<<i|0}enable(i){this.mask|=1<<i|0}enableAll(){this.mask=-1}toggle(i){this.mask^=1<<i|0}disable(i){this.mask&=~(1<<i|0)}disableAll(){this.mask=0}test(i){return(this.mask&i.mask)!=0}}let ys=0;const $a=new me,vi=new at,we=new Nt,ve=new me,Le=new me,ot=new me,Gt=new at,yn=new me(1,0,0),Ht=new me(0,1,0),En=new me(0,0,1),fe={type:"added"},ue={type:"removed"};class Me extends en{constructor(){super(),Object.defineProperty(this,"id",{value:ys++}),this.uuid=Dr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Me.DefaultUp.clone();const i=new me,f=new Ei,y=new at,_=new me(1,1,1);f._onChange(function(){y.setFromEuler(f,!1)}),y._onChange(function(){f.setFromQuaternion(y,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:i},rotation:{configurable:!0,enumerable:!0,value:f},quaternion:{configurable:!0,enumerable:!0,value:y},scale:{configurable:!0,enumerable:!0,value:_},modelViewMatrix:{value:new Nt},normalMatrix:{value:new Di}}),this.matrix=new Nt,this.matrixWorld=new Nt,this.matrixAutoUpdate=Me.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Si,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(i){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(i),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(i){return this.quaternion.premultiply(i),this}setRotationFromAxisAngle(i,f){this.quaternion.setFromAxisAngle(i,f)}setRotationFromEuler(i){this.quaternion.setFromEuler(i,!0)}setRotationFromMatrix(i){this.quaternion.setFromRotationMatrix(i)}setRotationFromQuaternion(i){this.quaternion.copy(i)}rotateOnAxis(i,f){return vi.setFromAxisAngle(i,f),this.quaternion.multiply(vi),this}rotateOnWorldAxis(i,f){return vi.setFromAxisAngle(i,f),this.quaternion.premultiply(vi),this}rotateX(i){return this.rotateOnAxis(yn,i)}rotateY(i){return this.rotateOnAxis(Ht,i)}rotateZ(i){return this.rotateOnAxis(En,i)}translateOnAxis(i,f){return $a.copy(i).applyQuaternion(this.quaternion),this.position.add($a.multiplyScalar(f)),this}translateX(i){return this.translateOnAxis(yn,i)}translateY(i){return this.translateOnAxis(Ht,i)}translateZ(i){return this.translateOnAxis(En,i)}localToWorld(i){return i.applyMatrix4(this.matrixWorld)}worldToLocal(i){return i.applyMatrix4(we.copy(this.matrixWorld).invert())}lookAt(i,f,y){i.isVector3?ve.copy(i):ve.set(i,f,y);const _=this.parent;this.updateWorldMatrix(!0,!1),Le.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?we.lookAt(Le,ve,this.up):we.lookAt(ve,Le,this.up),this.quaternion.setFromRotationMatrix(we),_&&(we.extractRotation(_.matrixWorld),vi.setFromRotationMatrix(we),this.quaternion.premultiply(vi.invert()))}add(i){if(arguments.length>1){for(let f=0;f<arguments.length;f++)this.add(arguments[f]);return this}return i===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",i),this):(i&&i.isObject3D?(i.parent!==null&&i.parent.remove(i),i.parent=this,this.children.push(i),i.dispatchEvent(fe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",i),this)}remove(i){if(arguments.length>1){for(let y=0;y<arguments.length;y++)this.remove(arguments[y]);return this}const f=this.children.indexOf(i);return f!==-1&&(i.parent=null,this.children.splice(f,1),i.dispatchEvent(ue)),this}removeFromParent(){const i=this.parent;return i!==null&&i.remove(this),this}clear(){for(let i=0;i<this.children.length;i++){const f=this.children[i];f.parent=null,f.dispatchEvent(ue)}return this.children.length=0,this}attach(i){return this.updateWorldMatrix(!0,!1),we.copy(this.matrixWorld).invert(),i.parent!==null&&(i.parent.updateWorldMatrix(!0,!1),we.multiply(i.parent.matrixWorld)),i.applyMatrix4(we),this.add(i),i.updateWorldMatrix(!1,!0),this}getObjectById(i){return this.getObjectByProperty("id",i)}getObjectByName(i){return this.getObjectByProperty("name",i)}getObjectByProperty(i,f){if(this[i]===f)return this;for(let y=0,_=this.children.length;y<_;y++){const S=this.children[y].getObjectByProperty(i,f);if(S!==void 0)return S}}getWorldPosition(i){return this.updateWorldMatrix(!0,!1),i.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(i){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Le,i,ot),i}getWorldScale(i){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Le,Gt,i),i}getWorldDirection(i){this.updateWorldMatrix(!0,!1);const f=this.matrixWorld.elements;return i.set(f[8],f[9],f[10]).normalize()}raycast(){}traverse(i){i(this);const f=this.children;for(let y=0,_=f.length;y<_;y++)f[y].traverse(i)}traverseVisible(i){if(this.visible===!1)return;i(this);const f=this.children;for(let y=0,_=f.length;y<_;y++)f[y].traverseVisible(i)}traverseAncestors(i){const f=this.parent;f!==null&&(i(f),f.traverseAncestors(i))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(i){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||i)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,i=!0);const f=this.children;for(let y=0,_=f.length;y<_;y++)f[y].updateMatrixWorld(i)}updateWorldMatrix(i,f){const y=this.parent;if(i===!0&&y!==null&&y.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),f===!0){const _=this.children;for(let S=0,I=_.length;S<I;S++)_[S].updateWorldMatrix(!1,!0)}}toJSON(i){const f=i===void 0||typeof i=="string",y={};f&&(i={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},y.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const _={};function S(R,D){return R[D.uuid]===void 0&&(R[D.uuid]=D.toJSON(i)),D.uuid}if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),this.castShadow===!0&&(_.castShadow=!0),this.receiveShadow===!0&&(_.receiveShadow=!0),this.visible===!1&&(_.visible=!1),this.frustumCulled===!1&&(_.frustumCulled=!1),this.renderOrder!==0&&(_.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(_.userData=this.userData),_.layers=this.layers.mask,_.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(_.matrixAutoUpdate=!1),this.isInstancedMesh&&(_.type="InstancedMesh",_.count=this.count,_.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(_.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?_.background=this.background.toJSON():this.background.isTexture&&(_.background=this.background.toJSON(i).uuid)),this.environment&&this.environment.isTexture&&(_.environment=this.environment.toJSON(i).uuid);else if(this.isMesh||this.isLine||this.isPoints){_.geometry=S(i.geometries,this.geometry);const R=this.geometry.parameters;if(R!==void 0&&R.shapes!==void 0){const D=R.shapes;if(Array.isArray(D))for(let F=0,G=D.length;F<G;F++){const W=D[F];S(i.shapes,W)}else S(i.shapes,D)}}if(this.isSkinnedMesh&&(_.bindMode=this.bindMode,_.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(S(i.skeletons,this.skeleton),_.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const R=[];for(let D=0,F=this.material.length;D<F;D++)R.push(S(i.materials,this.material[D]));_.material=R}else _.material=S(i.materials,this.material);if(this.children.length>0){_.children=[];for(let R=0;R<this.children.length;R++)_.children.push(this.children[R].toJSON(i).object)}if(this.animations.length>0){_.animations=[];for(let R=0;R<this.animations.length;R++){const D=this.animations[R];_.animations.push(S(i.animations,D))}}if(f){const R=I(i.geometries),D=I(i.materials),F=I(i.textures),G=I(i.images),W=I(i.shapes),Z=I(i.skeletons),K=I(i.animations);R.length>0&&(y.geometries=R),D.length>0&&(y.materials=D),F.length>0&&(y.textures=F),G.length>0&&(y.images=G),W.length>0&&(y.shapes=W),Z.length>0&&(y.skeletons=Z),K.length>0&&(y.animations=K)}return y.object=_,y;function I(R){const D=[];for(const F in R){const G=R[F];delete G.metadata,D.push(G)}return D}}clone(i){return new this.constructor().copy(this,i)}copy(i,f=!0){if(this.name=i.name,this.up.copy(i.up),this.position.copy(i.position),this.rotation.order=i.rotation.order,this.quaternion.copy(i.quaternion),this.scale.copy(i.scale),this.matrix.copy(i.matrix),this.matrixWorld.copy(i.matrixWorld),this.matrixAutoUpdate=i.matrixAutoUpdate,this.matrixWorldNeedsUpdate=i.matrixWorldNeedsUpdate,this.layers.mask=i.layers.mask,this.visible=i.visible,this.castShadow=i.castShadow,this.receiveShadow=i.receiveShadow,this.frustumCulled=i.frustumCulled,this.renderOrder=i.renderOrder,this.userData=JSON.parse(JSON.stringify(i.userData)),f===!0)for(let y=0;y<i.children.length;y++){const _=i.children[y];this.add(_.clone())}return this}}Me.DefaultUp=new me(0,1,0),Me.DefaultMatrixAutoUpdate=!0,Me.prototype.isObject3D=!0;const De=new me,Pe=new me,Dt=new me,Zt=new me,pn=new me,Sn=new me,lr=new me,In=new me,un=new me,cr=new me;class Bn{constructor(i=new me,f=new me,y=new me){this.a=i,this.b=f,this.c=y}static getNormal(i,f,y,_){_.subVectors(y,f),De.subVectors(i,f),_.cross(De);const S=_.lengthSq();return S>0?_.multiplyScalar(1/Math.sqrt(S)):_.set(0,0,0)}static getBarycoord(i,f,y,_,S){De.subVectors(_,f),Pe.subVectors(y,f),Dt.subVectors(i,f);const I=De.dot(De),R=De.dot(Pe),D=De.dot(Dt),F=Pe.dot(Pe),G=Pe.dot(Dt),W=I*F-R*R;if(W===0)return S.set(-2,-1,-1);const Z=1/W,K=(F*D-R*G)*Z,oe=(I*G-R*D)*Z;return S.set(1-K-oe,oe,K)}static containsPoint(i,f,y,_){return this.getBarycoord(i,f,y,_,Zt),Zt.x>=0&&Zt.y>=0&&Zt.x+Zt.y<=1}static getUV(i,f,y,_,S,I,R,D){return this.getBarycoord(i,f,y,_,Zt),D.set(0,0),D.addScaledVector(S,Zt.x),D.addScaledVector(I,Zt.y),D.addScaledVector(R,Zt.z),D}static isFrontFacing(i,f,y,_){return De.subVectors(y,f),Pe.subVectors(i,f),De.cross(Pe).dot(_)<0}set(i,f,y){return this.a.copy(i),this.b.copy(f),this.c.copy(y),this}setFromPointsAndIndices(i,f,y,_){return this.a.copy(i[f]),this.b.copy(i[y]),this.c.copy(i[_]),this}clone(){return new this.constructor().copy(this)}copy(i){return this.a.copy(i.a),this.b.copy(i.b),this.c.copy(i.c),this}getArea(){return De.subVectors(this.c,this.b),Pe.subVectors(this.a,this.b),.5*De.cross(Pe).length()}getMidpoint(i){return i.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(i){return Bn.getNormal(this.a,this.b,this.c,i)}getPlane(i){return i.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(i,f){return Bn.getBarycoord(i,this.a,this.b,this.c,f)}getUV(i,f,y,_,S){return Bn.getUV(i,this.a,this.b,this.c,f,y,_,S)}containsPoint(i){return Bn.containsPoint(i,this.a,this.b,this.c)}isFrontFacing(i){return Bn.isFrontFacing(this.a,this.b,this.c,i)}intersectsBox(i){return i.intersectsTriangle(this)}closestPointToPoint(i,f){const y=this.a,_=this.b,S=this.c;let I,R;pn.subVectors(_,y),Sn.subVectors(S,y),In.subVectors(i,y);const D=pn.dot(In),F=Sn.dot(In);if(D<=0&&F<=0)return f.copy(y);un.subVectors(i,_);const G=pn.dot(un),W=Sn.dot(un);if(G>=0&&W<=G)return f.copy(_);const Z=D*W-G*F;if(Z<=0&&D>=0&&G<=0)return I=D/(D-G),f.copy(y).addScaledVector(pn,I);cr.subVectors(i,S);const K=pn.dot(cr),oe=Sn.dot(cr);if(oe>=0&&K<=oe)return f.copy(S);const de=K*F-D*oe;if(de<=0&&F>=0&&oe<=0)return R=F/(F-oe),f.copy(y).addScaledVector(Sn,R);const ke=G*oe-K*W;if(ke<=0&&W-G>=0&&K-oe>=0)return lr.subVectors(S,_),R=(W-G)/(W-G+(K-oe)),f.copy(_).addScaledVector(lr,R);const pe=1/(ke+de+Z);return I=de*pe,R=Z*pe,f.copy(y).addScaledVector(pn,I).addScaledVector(Sn,R)}equals(i){return i.a.equals(this.a)&&i.b.equals(this.b)&&i.c.equals(this.c)}}let fr=0;class cn extends en{constructor(){super(),Object.defineProperty(this,"id",{value:fr++}),this.uuid=Dr(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.format=1023,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(i){this._alphaTest>0!=i>0&&this.version++,this._alphaTest=i}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(i){if(i!==void 0)for(const f in i){const y=i[f];if(y===void 0){console.warn("THREE.Material: '"+f+"' parameter is undefined.");continue}if(f==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=y===1;continue}const _=this[f];_!==void 0?_&&_.isColor?_.set(y):_&&_.isVector3&&y&&y.isVector3?_.copy(y):this[f]=y:console.warn("THREE."+this.type+": '"+f+"' is not a property of this material.")}}toJSON(i){const f=i===void 0||typeof i=="string";f&&(i={textures:{},images:{}});const y={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function _(S){const I=[];for(const R in S){const D=S[R];delete D.metadata,I.push(D)}return I}if(y.uuid=this.uuid,y.type=this.type,this.name!==""&&(y.name=this.name),this.color&&this.color.isColor&&(y.color=this.color.getHex()),this.roughness!==void 0&&(y.roughness=this.roughness),this.metalness!==void 0&&(y.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(y.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(y.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(y.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(y.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(y.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(y.specularTint=this.specularTint.getHex()),this.shininess!==void 0&&(y.shininess=this.shininess),this.clearcoat!==void 0&&(y.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(y.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(y.clearcoatMap=this.clearcoatMap.toJSON(i).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(y.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(i).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(y.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(i).uuid,y.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(y.map=this.map.toJSON(i).uuid),this.matcap&&this.matcap.isTexture&&(y.matcap=this.matcap.toJSON(i).uuid),this.alphaMap&&this.alphaMap.isTexture&&(y.alphaMap=this.alphaMap.toJSON(i).uuid),this.lightMap&&this.lightMap.isTexture&&(y.lightMap=this.lightMap.toJSON(i).uuid,y.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(y.aoMap=this.aoMap.toJSON(i).uuid,y.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(y.bumpMap=this.bumpMap.toJSON(i).uuid,y.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(y.normalMap=this.normalMap.toJSON(i).uuid,y.normalMapType=this.normalMapType,y.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(y.displacementMap=this.displacementMap.toJSON(i).uuid,y.displacementScale=this.displacementScale,y.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(y.roughnessMap=this.roughnessMap.toJSON(i).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(y.metalnessMap=this.metalnessMap.toJSON(i).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(y.emissiveMap=this.emissiveMap.toJSON(i).uuid),this.specularMap&&this.specularMap.isTexture&&(y.specularMap=this.specularMap.toJSON(i).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(y.specularIntensityMap=this.specularIntensityMap.toJSON(i).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(y.specularTintMap=this.specularTintMap.toJSON(i).uuid),this.envMap&&this.envMap.isTexture&&(y.envMap=this.envMap.toJSON(i).uuid,this.combine!==void 0&&(y.combine=this.combine)),this.envMapIntensity!==void 0&&(y.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(y.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(y.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(y.gradientMap=this.gradientMap.toJSON(i).uuid),this.transmission!==void 0&&(y.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(y.transmissionMap=this.transmissionMap.toJSON(i).uuid),this.thickness!==void 0&&(y.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(y.thicknessMap=this.thicknessMap.toJSON(i).uuid),this.attenuationDistance!==void 0&&(y.attenuationDistance=this.attenuationDistance),this.attenuationTint!==void 0&&(y.attenuationTint=this.attenuationTint.getHex()),this.size!==void 0&&(y.size=this.size),this.shadowSide!==null&&(y.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(y.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(y.blending=this.blending),this.side!==0&&(y.side=this.side),this.vertexColors&&(y.vertexColors=!0),this.opacity<1&&(y.opacity=this.opacity),this.format!==1023&&(y.format=this.format),this.transparent===!0&&(y.transparent=this.transparent),y.depthFunc=this.depthFunc,y.depthTest=this.depthTest,y.depthWrite=this.depthWrite,y.colorWrite=this.colorWrite,y.stencilWrite=this.stencilWrite,y.stencilWriteMask=this.stencilWriteMask,y.stencilFunc=this.stencilFunc,y.stencilRef=this.stencilRef,y.stencilFuncMask=this.stencilFuncMask,y.stencilFail=this.stencilFail,y.stencilZFail=this.stencilZFail,y.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(y.rotation=this.rotation),this.polygonOffset===!0&&(y.polygonOffset=!0),this.polygonOffsetFactor!==0&&(y.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(y.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(y.linewidth=this.linewidth),this.dashSize!==void 0&&(y.dashSize=this.dashSize),this.gapSize!==void 0&&(y.gapSize=this.gapSize),this.scale!==void 0&&(y.scale=this.scale),this.dithering===!0&&(y.dithering=!0),this.alphaTest>0&&(y.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(y.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(y.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(y.wireframe=this.wireframe),this.wireframeLinewidth>1&&(y.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(y.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(y.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(y.flatShading=this.flatShading),this.visible===!1&&(y.visible=!1),this.toneMapped===!1&&(y.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(y.userData=this.userData),f){const S=_(i.textures),I=_(i.images);S.length>0&&(y.textures=S),I.length>0&&(y.images=I)}return y}clone(){return new this.constructor().copy(this)}copy(i){this.name=i.name,this.fog=i.fog,this.blending=i.blending,this.side=i.side,this.vertexColors=i.vertexColors,this.opacity=i.opacity,this.format=i.format,this.transparent=i.transparent,this.blendSrc=i.blendSrc,this.blendDst=i.blendDst,this.blendEquation=i.blendEquation,this.blendSrcAlpha=i.blendSrcAlpha,this.blendDstAlpha=i.blendDstAlpha,this.blendEquationAlpha=i.blendEquationAlpha,this.depthFunc=i.depthFunc,this.depthTest=i.depthTest,this.depthWrite=i.depthWrite,this.stencilWriteMask=i.stencilWriteMask,this.stencilFunc=i.stencilFunc,this.stencilRef=i.stencilRef,this.stencilFuncMask=i.stencilFuncMask,this.stencilFail=i.stencilFail,this.stencilZFail=i.stencilZFail,this.stencilZPass=i.stencilZPass,this.stencilWrite=i.stencilWrite;const f=i.clippingPlanes;let y=null;if(f!==null){const _=f.length;y=new Array(_);for(let S=0;S!==_;++S)y[S]=f[S].clone()}return this.clippingPlanes=y,this.clipIntersection=i.clipIntersection,this.clipShadows=i.clipShadows,this.shadowSide=i.shadowSide,this.colorWrite=i.colorWrite,this.precision=i.precision,this.polygonOffset=i.polygonOffset,this.polygonOffsetFactor=i.polygonOffsetFactor,this.polygonOffsetUnits=i.polygonOffsetUnits,this.dithering=i.dithering,this.alphaTest=i.alphaTest,this.alphaToCoverage=i.alphaToCoverage,this.premultipliedAlpha=i.premultipliedAlpha,this.visible=i.visible,this.toneMapped=i.toneMapped,this.userData=JSON.parse(JSON.stringify(i.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(i){i===!0&&this.version++}}cn.prototype.isMaterial=!0;const Ar={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$r={h:0,s:0,l:0},ei={h:0,s:0,l:0};function Br(M,i,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?M+6*(i-M)*f:f<.5?i:f<2/3?M+6*(i-M)*(2/3-f):M}function qi(M){return M<.04045?.0773993808*M:Math.pow(.9478672986*M+.0521327014,2.4)}function Oi(M){return M<.0031308?12.92*M:1.055*Math.pow(M,.41666)-.055}class Xn{constructor(i,f,y){return f===void 0&&y===void 0?this.set(i):this.setRGB(i,f,y)}set(i){return i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i),this}setScalar(i){return this.r=i,this.g=i,this.b=i,this}setHex(i){return i=Math.floor(i),this.r=(i>>16&255)/255,this.g=(i>>8&255)/255,this.b=(255&i)/255,this}setRGB(i,f,y){return this.r=i,this.g=f,this.b=y,this}setHSL(i,f,y){if(i=Tr(i,1),f=Fr(f,0,1),y=Fr(y,0,1),f===0)this.r=this.g=this.b=y;else{const _=y<=.5?y*(1+f):y+f-y*f,S=2*y-_;this.r=Br(S,_,i+1/3),this.g=Br(S,_,i),this.b=Br(S,_,i-1/3)}return this}setStyle(i){function f(_){_!==void 0&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}let y;if(y=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(i)){let _;const S=y[1],I=y[2];switch(S){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(I))return this.r=Math.min(255,parseInt(_[1],10))/255,this.g=Math.min(255,parseInt(_[2],10))/255,this.b=Math.min(255,parseInt(_[3],10))/255,f(_[4]),this;if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(I))return this.r=Math.min(100,parseInt(_[1],10))/100,this.g=Math.min(100,parseInt(_[2],10))/100,this.b=Math.min(100,parseInt(_[3],10))/100,f(_[4]),this;break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(I)){const R=parseFloat(_[1])/360,D=parseInt(_[2],10)/100,F=parseInt(_[3],10)/100;return f(_[4]),this.setHSL(R,D,F)}}}else if(y=/^\#([A-Fa-f\d]+)$/.exec(i)){const _=y[1],S=_.length;if(S===3)return this.r=parseInt(_.charAt(0)+_.charAt(0),16)/255,this.g=parseInt(_.charAt(1)+_.charAt(1),16)/255,this.b=parseInt(_.charAt(2)+_.charAt(2),16)/255,this;if(S===6)return this.r=parseInt(_.charAt(0)+_.charAt(1),16)/255,this.g=parseInt(_.charAt(2)+_.charAt(3),16)/255,this.b=parseInt(_.charAt(4)+_.charAt(5),16)/255,this}return i&&i.length>0?this.setColorName(i):this}setColorName(i){const f=Ar[i.toLowerCase()];return f!==void 0?this.setHex(f):console.warn("THREE.Color: Unknown color "+i),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(i){return this.r=i.r,this.g=i.g,this.b=i.b,this}copyGammaToLinear(i,f=2){return this.r=Math.pow(i.r,f),this.g=Math.pow(i.g,f),this.b=Math.pow(i.b,f),this}copyLinearToGamma(i,f=2){const y=f>0?1/f:1;return this.r=Math.pow(i.r,y),this.g=Math.pow(i.g,y),this.b=Math.pow(i.b,y),this}convertGammaToLinear(i){return this.copyGammaToLinear(this,i),this}convertLinearToGamma(i){return this.copyLinearToGamma(this,i),this}copySRGBToLinear(i){return this.r=qi(i.r),this.g=qi(i.g),this.b=qi(i.b),this}copyLinearToSRGB(i){return this.r=Oi(i.r),this.g=Oi(i.g),this.b=Oi(i.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(i){const f=this.r,y=this.g,_=this.b,S=Math.max(f,y,_),I=Math.min(f,y,_);let R,D;const F=(I+S)/2;if(I===S)R=0,D=0;else{const G=S-I;switch(D=F<=.5?G/(S+I):G/(2-S-I),S){case f:R=(y-_)/G+(y<_?6:0);break;case y:R=(_-f)/G+2;break;case _:R=(f-y)/G+4}R/=6}return i.h=R,i.s=D,i.l=F,i}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(i,f,y){return this.getHSL($r),$r.h+=i,$r.s+=f,$r.l+=y,this.setHSL($r.h,$r.s,$r.l),this}add(i){return this.r+=i.r,this.g+=i.g,this.b+=i.b,this}addColors(i,f){return this.r=i.r+f.r,this.g=i.g+f.g,this.b=i.b+f.b,this}addScalar(i){return this.r+=i,this.g+=i,this.b+=i,this}sub(i){return this.r=Math.max(0,this.r-i.r),this.g=Math.max(0,this.g-i.g),this.b=Math.max(0,this.b-i.b),this}multiply(i){return this.r*=i.r,this.g*=i.g,this.b*=i.b,this}multiplyScalar(i){return this.r*=i,this.g*=i,this.b*=i,this}lerp(i,f){return this.r+=(i.r-this.r)*f,this.g+=(i.g-this.g)*f,this.b+=(i.b-this.b)*f,this}lerpColors(i,f,y){return this.r=i.r+(f.r-i.r)*y,this.g=i.g+(f.g-i.g)*y,this.b=i.b+(f.b-i.b)*y,this}lerpHSL(i,f){this.getHSL($r),i.getHSL(ei);const y=Zr($r.h,ei.h,f),_=Zr($r.s,ei.s,f),S=Zr($r.l,ei.l,f);return this.setHSL(y,_,S),this}equals(i){return i.r===this.r&&i.g===this.g&&i.b===this.b}fromArray(i,f=0){return this.r=i[f],this.g=i[f+1],this.b=i[f+2],this}toArray(i=[],f=0){return i[f]=this.r,i[f+1]=this.g,i[f+2]=this.b,i}fromBufferAttribute(i,f){return this.r=i.getX(f),this.g=i.getY(f),this.b=i.getZ(f),i.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Xn.NAMES=Ar,Xn.prototype.isColor=!0,Xn.prototype.r=1,Xn.prototype.g=1,Xn.prototype.b=1;class es extends cn{constructor(i){super(),this.type="MeshBasicMaterial",this.color=new Xn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.specularMap=i.specularMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.combine=i.combine,this.reflectivity=i.reflectivity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this}}es.prototype.isMeshBasicMaterial=!0;const li=new me,Do=new Vn;class xi{constructor(i,f,y){if(Array.isArray(i))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=i,this.itemSize=f,this.count=i!==void 0?i.length/f:0,this.normalized=y===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(i){i===!0&&this.version++}setUsage(i){return this.usage=i,this}copy(i){return this.name=i.name,this.array=new i.array.constructor(i.array),this.itemSize=i.itemSize,this.count=i.count,this.normalized=i.normalized,this.usage=i.usage,this}copyAt(i,f,y){i*=this.itemSize,y*=f.itemSize;for(let _=0,S=this.itemSize;_<S;_++)this.array[i+_]=f.array[y+_];return this}copyArray(i){return this.array.set(i),this}copyColorsArray(i){const f=this.array;let y=0;for(let _=0,S=i.length;_<S;_++){let I=i[_];I===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",_),I=new Xn),f[y++]=I.r,f[y++]=I.g,f[y++]=I.b}return this}copyVector2sArray(i){const f=this.array;let y=0;for(let _=0,S=i.length;_<S;_++){let I=i[_];I===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",_),I=new Vn),f[y++]=I.x,f[y++]=I.y}return this}copyVector3sArray(i){const f=this.array;let y=0;for(let _=0,S=i.length;_<S;_++){let I=i[_];I===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",_),I=new me),f[y++]=I.x,f[y++]=I.y,f[y++]=I.z}return this}copyVector4sArray(i){const f=this.array;let y=0;for(let _=0,S=i.length;_<S;_++){let I=i[_];I===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",_),I=new Fe),f[y++]=I.x,f[y++]=I.y,f[y++]=I.z,f[y++]=I.w}return this}applyMatrix3(i){if(this.itemSize===2)for(let f=0,y=this.count;f<y;f++)Do.fromBufferAttribute(this,f),Do.applyMatrix3(i),this.setXY(f,Do.x,Do.y);else if(this.itemSize===3)for(let f=0,y=this.count;f<y;f++)li.fromBufferAttribute(this,f),li.applyMatrix3(i),this.setXYZ(f,li.x,li.y,li.z);return this}applyMatrix4(i){for(let f=0,y=this.count;f<y;f++)li.x=this.getX(f),li.y=this.getY(f),li.z=this.getZ(f),li.applyMatrix4(i),this.setXYZ(f,li.x,li.y,li.z);return this}applyNormalMatrix(i){for(let f=0,y=this.count;f<y;f++)li.x=this.getX(f),li.y=this.getY(f),li.z=this.getZ(f),li.applyNormalMatrix(i),this.setXYZ(f,li.x,li.y,li.z);return this}transformDirection(i){for(let f=0,y=this.count;f<y;f++)li.x=this.getX(f),li.y=this.getY(f),li.z=this.getZ(f),li.transformDirection(i),this.setXYZ(f,li.x,li.y,li.z);return this}set(i,f=0){return this.array.set(i,f),this}getX(i){return this.array[i*this.itemSize]}setX(i,f){return this.array[i*this.itemSize]=f,this}getY(i){return this.array[i*this.itemSize+1]}setY(i,f){return this.array[i*this.itemSize+1]=f,this}getZ(i){return this.array[i*this.itemSize+2]}setZ(i,f){return this.array[i*this.itemSize+2]=f,this}getW(i){return this.array[i*this.itemSize+3]}setW(i,f){return this.array[i*this.itemSize+3]=f,this}setXY(i,f,y){return i*=this.itemSize,this.array[i+0]=f,this.array[i+1]=y,this}setXYZ(i,f,y,_){return i*=this.itemSize,this.array[i+0]=f,this.array[i+1]=y,this.array[i+2]=_,this}setXYZW(i,f,y,_,S){return i*=this.itemSize,this.array[i+0]=f,this.array[i+1]=y,this.array[i+2]=_,this.array[i+3]=S,this}onUpload(i){return this.onUploadCallback=i,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const i={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(i.name=this.name),this.usage!==35044&&(i.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(i.updateRange=this.updateRange),i}}xi.prototype.isBufferAttribute=!0;class pa extends xi{constructor(i,f,y){super(new Int8Array(i),f,y)}}class jo extends xi{constructor(i,f,y){super(new Uint8Array(i),f,y)}}class Xa extends xi{constructor(i,f,y){super(new Uint8ClampedArray(i),f,y)}}class Za extends xi{constructor(i,f,y){super(new Int16Array(i),f,y)}}class Oo extends xi{constructor(i,f,y){super(new Uint16Array(i),f,y)}}class na extends xi{constructor(i,f,y){super(new Int32Array(i),f,y)}}class Gs extends xi{constructor(i,f,y){super(new Uint32Array(i),f,y)}}class jc extends xi{constructor(i,f,y){super(new Uint16Array(i),f,y)}}jc.prototype.isFloat16BufferAttribute=!0;class Pr extends xi{constructor(i,f,y){super(new Float32Array(i),f,y)}}class vu extends xi{constructor(i,f,y){super(new Float64Array(i),f,y)}}function Mp(M){if(M.length===0)return-1/0;let i=M[0];for(let f=1,y=M.length;f<y;++f)M[f]>i&&(i=M[f]);return i}const gf={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dc(M,i){return new gf[M](i)}let yf=0;const il=new Nt,hs=new Me,kp=new me,Bl=new Jt,Cp=new Jt,ma=new me;class bi extends en{constructor(){super(),Object.defineProperty(this,"id",{value:yf++}),this.uuid=Dr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(i){return Array.isArray(i)?this.index=new(Mp(i)>65535?Gs:Oo)(i,1):this.index=i,this}getAttribute(i){return this.attributes[i]}setAttribute(i,f){return this.attributes[i]=f,this}deleteAttribute(i){return delete this.attributes[i],this}hasAttribute(i){return this.attributes[i]!==void 0}addGroup(i,f,y=0){this.groups.push({start:i,count:f,materialIndex:y})}clearGroups(){this.groups=[]}setDrawRange(i,f){this.drawRange.start=i,this.drawRange.count=f}applyMatrix4(i){const f=this.attributes.position;f!==void 0&&(f.applyMatrix4(i),f.needsUpdate=!0);const y=this.attributes.normal;if(y!==void 0){const S=new Di().getNormalMatrix(i);y.applyNormalMatrix(S),y.needsUpdate=!0}const _=this.attributes.tangent;return _!==void 0&&(_.transformDirection(i),_.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(i){return il.makeRotationFromQuaternion(i),this.applyMatrix4(il),this}rotateX(i){return il.makeRotationX(i),this.applyMatrix4(il),this}rotateY(i){return il.makeRotationY(i),this.applyMatrix4(il),this}rotateZ(i){return il.makeRotationZ(i),this.applyMatrix4(il),this}translate(i,f,y){return il.makeTranslation(i,f,y),this.applyMatrix4(il),this}scale(i,f,y){return il.makeScale(i,f,y),this.applyMatrix4(il),this}lookAt(i){return hs.lookAt(i),hs.updateMatrix(),this.applyMatrix4(hs.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(kp).negate(),this.translate(kp.x,kp.y,kp.z),this}setFromPoints(i){const f=[];for(let y=0,_=i.length;y<_;y++){const S=i[y];f.push(S.x,S.y,S.z||0)}return this.setAttribute("position",new Pr(f,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Jt);const i=this.attributes.position,f=this.morphAttributes.position;if(i&&i.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new me(-1/0,-1/0,-1/0),new me(1/0,1/0,1/0));if(i!==void 0){if(this.boundingBox.setFromBufferAttribute(i),f)for(let y=0,_=f.length;y<_;y++){const S=f[y];Bl.setFromBufferAttribute(S),this.morphTargetsRelative?(ma.addVectors(this.boundingBox.min,Bl.min),this.boundingBox.expandByPoint(ma),ma.addVectors(this.boundingBox.max,Bl.max),this.boundingBox.expandByPoint(ma)):(this.boundingBox.expandByPoint(Bl.min),this.boundingBox.expandByPoint(Bl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new tl);const i=this.attributes.position,f=this.morphAttributes.position;if(i&&i.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new me,1/0);if(i){const y=this.boundingSphere.center;if(Bl.setFromBufferAttribute(i),f)for(let S=0,I=f.length;S<I;S++){const R=f[S];Cp.setFromBufferAttribute(R),this.morphTargetsRelative?(ma.addVectors(Bl.min,Cp.min),Bl.expandByPoint(ma),ma.addVectors(Bl.max,Cp.max),Bl.expandByPoint(ma)):(Bl.expandByPoint(Cp.min),Bl.expandByPoint(Cp.max))}Bl.getCenter(y);let _=0;for(let S=0,I=i.count;S<I;S++)ma.fromBufferAttribute(i,S),_=Math.max(_,y.distanceToSquared(ma));if(f)for(let S=0,I=f.length;S<I;S++){const R=f[S],D=this.morphTargetsRelative;for(let F=0,G=R.count;F<G;F++)ma.fromBufferAttribute(R,F),D&&(kp.fromBufferAttribute(i,F),ma.add(kp)),_=Math.max(_,y.distanceToSquared(ma))}this.boundingSphere.radius=Math.sqrt(_),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const i=this.index,f=this.attributes;if(i===null||f.position===void 0||f.normal===void 0||f.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const y=i.array,_=f.position.array,S=f.normal.array,I=f.uv.array,R=_.length/3;f.tangent===void 0&&this.setAttribute("tangent",new xi(new Float32Array(4*R),4));const D=f.tangent.array,F=[],G=[];for(let sn=0;sn<R;sn++)F[sn]=new me,G[sn]=new me;const W=new me,Z=new me,K=new me,oe=new Vn,de=new Vn,ke=new Vn,pe=new me,Ve=new me;function Ye(sn,dn,wr){W.fromArray(_,3*sn),Z.fromArray(_,3*dn),K.fromArray(_,3*wr),oe.fromArray(I,2*sn),de.fromArray(I,2*dn),ke.fromArray(I,2*wr),Z.sub(W),K.sub(W),de.sub(oe),ke.sub(oe);const er=1/(de.x*ke.y-ke.x*de.y);isFinite(er)&&(pe.copy(Z).multiplyScalar(ke.y).addScaledVector(K,-de.y).multiplyScalar(er),Ve.copy(K).multiplyScalar(de.x).addScaledVector(Z,-ke.x).multiplyScalar(er),F[sn].add(pe),F[dn].add(pe),F[wr].add(pe),G[sn].add(Ve),G[dn].add(Ve),G[wr].add(Ve))}let $e=this.groups;$e.length===0&&($e=[{start:0,count:y.length}]);for(let sn=0,dn=$e.length;sn<dn;++sn){const wr=$e[sn],er=wr.start;for(let Pn=er,ir=er+wr.count;Pn<ir;Pn+=3)Ye(y[Pn+0],y[Pn+1],y[Pn+2])}const _t=new me,bt=new me,Vt=new me,qt=new me;function mn(sn){Vt.fromArray(S,3*sn),qt.copy(Vt);const dn=F[sn];_t.copy(dn),_t.sub(Vt.multiplyScalar(Vt.dot(dn))).normalize(),bt.crossVectors(qt,dn);const wr=bt.dot(G[sn])<0?-1:1;D[4*sn]=_t.x,D[4*sn+1]=_t.y,D[4*sn+2]=_t.z,D[4*sn+3]=wr}for(let sn=0,dn=$e.length;sn<dn;++sn){const wr=$e[sn],er=wr.start;for(let Pn=er,ir=er+wr.count;Pn<ir;Pn+=3)mn(y[Pn+0]),mn(y[Pn+1]),mn(y[Pn+2])}}computeVertexNormals(){const i=this.index,f=this.getAttribute("position");if(f!==void 0){let y=this.getAttribute("normal");if(y===void 0)y=new xi(new Float32Array(3*f.count),3),this.setAttribute("normal",y);else for(let Z=0,K=y.count;Z<K;Z++)y.setXYZ(Z,0,0,0);const _=new me,S=new me,I=new me,R=new me,D=new me,F=new me,G=new me,W=new me;if(i)for(let Z=0,K=i.count;Z<K;Z+=3){const oe=i.getX(Z+0),de=i.getX(Z+1),ke=i.getX(Z+2);_.fromBufferAttribute(f,oe),S.fromBufferAttribute(f,de),I.fromBufferAttribute(f,ke),G.subVectors(I,S),W.subVectors(_,S),G.cross(W),R.fromBufferAttribute(y,oe),D.fromBufferAttribute(y,de),F.fromBufferAttribute(y,ke),R.add(G),D.add(G),F.add(G),y.setXYZ(oe,R.x,R.y,R.z),y.setXYZ(de,D.x,D.y,D.z),y.setXYZ(ke,F.x,F.y,F.z)}else for(let Z=0,K=f.count;Z<K;Z+=3)_.fromBufferAttribute(f,Z+0),S.fromBufferAttribute(f,Z+1),I.fromBufferAttribute(f,Z+2),G.subVectors(I,S),W.subVectors(_,S),G.cross(W),y.setXYZ(Z+0,G.x,G.y,G.z),y.setXYZ(Z+1,G.x,G.y,G.z),y.setXYZ(Z+2,G.x,G.y,G.z);this.normalizeNormals(),y.needsUpdate=!0}}merge(i,f){if(!i||!i.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",i);f===void 0&&(f=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const y=this.attributes;for(const _ in y){if(i.attributes[_]===void 0)continue;const S=y[_].array,I=i.attributes[_],R=I.array,D=I.itemSize*f,F=Math.min(R.length,S.length-D);for(let G=0,W=D;G<F;G++,W++)S[W]=R[G]}return this}normalizeNormals(){const i=this.attributes.normal;for(let f=0,y=i.count;f<y;f++)ma.fromBufferAttribute(i,f),ma.normalize(),i.setXYZ(f,ma.x,ma.y,ma.z)}toNonIndexed(){function i(R,D){const F=R.array,G=R.itemSize,W=R.normalized,Z=new F.constructor(D.length*G);let K=0,oe=0;for(let de=0,ke=D.length;de<ke;de++){K=R.isInterleavedBufferAttribute?D[de]*R.data.stride+R.offset:D[de]*G;for(let pe=0;pe<G;pe++)Z[oe++]=F[K++]}return new xi(Z,G,W)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const f=new bi,y=this.index.array,_=this.attributes;for(const R in _){const D=i(_[R],y);f.setAttribute(R,D)}const S=this.morphAttributes;for(const R in S){const D=[],F=S[R];for(let G=0,W=F.length;G<W;G++){const Z=i(F[G],y);D.push(Z)}f.morphAttributes[R]=D}f.morphTargetsRelative=this.morphTargetsRelative;const I=this.groups;for(let R=0,D=I.length;R<D;R++){const F=I[R];f.addGroup(F.start,F.count,F.materialIndex)}return f}toJSON(){const i={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),Object.keys(this.userData).length>0&&(i.userData=this.userData),this.parameters!==void 0){const D=this.parameters;for(const F in D)D[F]!==void 0&&(i[F]=D[F]);return i}i.data={attributes:{}};const f=this.index;f!==null&&(i.data.index={type:f.array.constructor.name,array:Array.prototype.slice.call(f.array)});const y=this.attributes;for(const D in y){const F=y[D];i.data.attributes[D]=F.toJSON(i.data)}const _={};let S=!1;for(const D in this.morphAttributes){const F=this.morphAttributes[D],G=[];for(let W=0,Z=F.length;W<Z;W++){const K=F[W];G.push(K.toJSON(i.data))}G.length>0&&(_[D]=G,S=!0)}S&&(i.data.morphAttributes=_,i.data.morphTargetsRelative=this.morphTargetsRelative);const I=this.groups;I.length>0&&(i.data.groups=JSON.parse(JSON.stringify(I)));const R=this.boundingSphere;return R!==null&&(i.data.boundingSphere={center:R.center.toArray(),radius:R.radius}),i}clone(){return new bi().copy(this)}copy(i){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const f={};this.name=i.name;const y=i.index;y!==null&&this.setIndex(y.clone(f));const _=i.attributes;for(const F in _){const G=_[F];this.setAttribute(F,G.clone(f))}const S=i.morphAttributes;for(const F in S){const G=[],W=S[F];for(let Z=0,K=W.length;Z<K;Z++)G.push(W[Z].clone(f));this.morphAttributes[F]=G}this.morphTargetsRelative=i.morphTargetsRelative;const I=i.groups;for(let F=0,G=I.length;F<G;F++){const W=I[F];this.addGroup(W.start,W.count,W.materialIndex)}const R=i.boundingBox;R!==null&&(this.boundingBox=R.clone());const D=i.boundingSphere;return D!==null&&(this.boundingSphere=D.clone()),this.drawRange.start=i.drawRange.start,this.drawRange.count=i.drawRange.count,this.userData=i.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}bi.prototype.isBufferGeometry=!0;const l0=new Nt,fc=new rl,Ip=new tl,xu=new me,vl=new me,tu=new me,Ap=new me,u0=new me,_f=new me,Lp=new me,Pp=new me,vf=new me,xf=new Vn,Rp=new Vn,Yi=new Vn,bf=new me,Wm=new me;class Vo extends Me{constructor(i=new bi,f=new es){super(),this.type="Mesh",this.geometry=i,this.material=f,this.updateMorphTargets()}copy(i){return super.copy(i),i.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=i.morphTargetInfluences.slice()),i.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},i.morphTargetDictionary)),this.material=i.material,this.geometry=i.geometry,this}updateMorphTargets(){const i=this.geometry;if(i.isBufferGeometry){const f=i.morphAttributes,y=Object.keys(f);if(y.length>0){const _=f[y[0]];if(_!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,I=_.length;S<I;S++){const R=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[R]=S}}}}else{const f=i.morphTargets;f!==void 0&&f.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(i,f){const y=this.geometry,_=this.material,S=this.matrixWorld;if(_===void 0||(y.boundingSphere===null&&y.computeBoundingSphere(),Ip.copy(y.boundingSphere),Ip.applyMatrix4(S),i.ray.intersectsSphere(Ip)===!1)||(l0.copy(S).invert(),fc.copy(i.ray).applyMatrix4(l0),y.boundingBox!==null&&fc.intersectsBox(y.boundingBox)===!1))return;let I;if(y.isBufferGeometry){const R=y.index,D=y.attributes.position,F=y.morphAttributes.position,G=y.morphTargetsRelative,W=y.attributes.uv,Z=y.attributes.uv2,K=y.groups,oe=y.drawRange;if(R!==null)if(Array.isArray(_))for(let de=0,ke=K.length;de<ke;de++){const pe=K[de],Ve=_[pe.materialIndex];for(let Ye=Math.max(pe.start,oe.start),$e=Math.min(pe.start+pe.count,oe.start+oe.count);Ye<$e;Ye+=3){const _t=R.getX(Ye),bt=R.getX(Ye+1),Vt=R.getX(Ye+2);I=qm(this,Ve,i,fc,D,F,G,W,Z,_t,bt,Vt),I&&(I.faceIndex=Math.floor(Ye/3),I.face.materialIndex=pe.materialIndex,f.push(I))}}else for(let de=Math.max(0,oe.start),ke=Math.min(R.count,oe.start+oe.count);de<ke;de+=3){const pe=R.getX(de),Ve=R.getX(de+1),Ye=R.getX(de+2);I=qm(this,_,i,fc,D,F,G,W,Z,pe,Ve,Ye),I&&(I.faceIndex=Math.floor(de/3),f.push(I))}else if(D!==void 0)if(Array.isArray(_))for(let de=0,ke=K.length;de<ke;de++){const pe=K[de],Ve=_[pe.materialIndex];for(let Ye=Math.max(pe.start,oe.start),$e=Math.min(pe.start+pe.count,oe.start+oe.count);Ye<$e;Ye+=3)I=qm(this,Ve,i,fc,D,F,G,W,Z,Ye,Ye+1,Ye+2),I&&(I.faceIndex=Math.floor(Ye/3),I.face.materialIndex=pe.materialIndex,f.push(I))}else for(let de=Math.max(0,oe.start),ke=Math.min(D.count,oe.start+oe.count);de<ke;de+=3)I=qm(this,_,i,fc,D,F,G,W,Z,de,de+1,de+2),I&&(I.faceIndex=Math.floor(de/3),f.push(I))}else y.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function qm(M,i,f,y,_,S,I,R,D,F,G,W){xu.fromBufferAttribute(_,F),vl.fromBufferAttribute(_,G),tu.fromBufferAttribute(_,W);const Z=M.morphTargetInfluences;if(S&&Z){Lp.set(0,0,0),Pp.set(0,0,0),vf.set(0,0,0);for(let oe=0,de=S.length;oe<de;oe++){const ke=Z[oe],pe=S[oe];ke!==0&&(Ap.fromBufferAttribute(pe,F),u0.fromBufferAttribute(pe,G),_f.fromBufferAttribute(pe,W),I?(Lp.addScaledVector(Ap,ke),Pp.addScaledVector(u0,ke),vf.addScaledVector(_f,ke)):(Lp.addScaledVector(Ap.sub(xu),ke),Pp.addScaledVector(u0.sub(vl),ke),vf.addScaledVector(_f.sub(tu),ke)))}xu.add(Lp),vl.add(Pp),tu.add(vf)}M.isSkinnedMesh&&(M.boneTransform(F,xu),M.boneTransform(G,vl),M.boneTransform(W,tu));const K=function(oe,de,ke,pe,Ve,Ye,$e,_t){let bt;if(bt=de.side===1?pe.intersectTriangle($e,Ye,Ve,!0,_t):pe.intersectTriangle(Ve,Ye,$e,de.side!==2,_t),bt===null)return null;Wm.copy(_t),Wm.applyMatrix4(oe.matrixWorld);const Vt=ke.ray.origin.distanceTo(Wm);return Vt<ke.near||Vt>ke.far?null:{distance:Vt,point:Wm.clone(),object:oe}}(M,i,f,y,xu,vl,tu,bf);if(K){R&&(xf.fromBufferAttribute(R,F),Rp.fromBufferAttribute(R,G),Yi.fromBufferAttribute(R,W),K.uv=Bn.getUV(bf,xu,vl,tu,xf,Rp,Yi,new Vn)),D&&(xf.fromBufferAttribute(D,F),Rp.fromBufferAttribute(D,G),Yi.fromBufferAttribute(D,W),K.uv2=Bn.getUV(bf,xu,vl,tu,xf,Rp,Yi,new Vn));const oe={a:F,b:G,c:W,normal:new me,materialIndex:0};Bn.getNormal(xu,vl,tu,oe.normal),K.face=oe}return K}Vo.prototype.isMesh=!0;class Ul extends bi{constructor(i=1,f=1,y=1,_=1,S=1,I=1){super(),this.type="BoxGeometry",this.parameters={width:i,height:f,depth:y,widthSegments:_,heightSegments:S,depthSegments:I};const R=this;_=Math.floor(_),S=Math.floor(S),I=Math.floor(I);const D=[],F=[],G=[],W=[];let Z=0,K=0;function oe(de,ke,pe,Ve,Ye,$e,_t,bt,Vt,qt,mn){const sn=$e/Vt,dn=_t/qt,wr=$e/2,er=_t/2,Pn=bt/2,ir=Vt+1,Or=qt+1;let jr=0,si=0;const gi=new me;for(let yi=0;yi<Or;yi++){const sr=yi*dn-er;for(let xt=0;xt<ir;xt++){const Pt=xt*sn-wr;gi[de]=Pt*Ve,gi[ke]=sr*Ye,gi[pe]=Pn,F.push(gi.x,gi.y,gi.z),gi[de]=0,gi[ke]=0,gi[pe]=bt>0?1:-1,G.push(gi.x,gi.y,gi.z),W.push(xt/Vt),W.push(1-yi/qt),jr+=1}}for(let yi=0;yi<qt;yi++)for(let sr=0;sr<Vt;sr++){const xt=Z+sr+ir*yi,Pt=Z+sr+ir*(yi+1),Fn=Z+(sr+1)+ir*(yi+1),ln=Z+(sr+1)+ir*yi;D.push(xt,Pt,ln),D.push(Pt,Fn,ln),si+=6}R.addGroup(K,si,mn),K+=si,Z+=jr}oe("z","y","x",-1,-1,y,f,i,I,S,0),oe("z","y","x",1,-1,y,f,-i,I,S,1),oe("x","z","y",1,1,i,y,f,_,I,2),oe("x","z","y",1,-1,i,y,-f,_,I,3),oe("x","y","z",1,-1,i,f,y,_,S,4),oe("x","y","z",-1,-1,i,f,-y,_,S,5),this.setIndex(D),this.setAttribute("position",new Pr(F,3)),this.setAttribute("normal",new Pr(G,3)),this.setAttribute("uv",new Pr(W,2))}static fromJSON(i){return new Ul(i.width,i.height,i.depth,i.widthSegments,i.heightSegments,i.depthSegments)}}function vd(M){const i={};for(const f in M){i[f]={};for(const y in M[f]){const _=M[f][y];_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture||_.isQuaternion)?i[f][y]=_.clone():Array.isArray(_)?i[f][y]=_.slice():i[f][y]=_}}return i}function xl(M){const i={};for(let f=0;f<M.length;f++){const y=vd(M[f]);for(const _ in y)i[_]=y[_]}return i}const mv={clone:vd,merge:xl};class Th extends cn{constructor(i){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,i!==void 0&&(i.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(i))}copy(i){return super.copy(i),this.fragmentShader=i.fragmentShader,this.vertexShader=i.vertexShader,this.uniforms=vd(i.uniforms),this.defines=Object.assign({},i.defines),this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.lights=i.lights,this.clipping=i.clipping,this.extensions=Object.assign({},i.extensions),this.glslVersion=i.glslVersion,this}toJSON(i){const f=super.toJSON(i);f.glslVersion=this.glslVersion,f.uniforms={};for(const _ in this.uniforms){const S=this.uniforms[_].value;S&&S.isTexture?f.uniforms[_]={type:"t",value:S.toJSON(i).uuid}:S&&S.isColor?f.uniforms[_]={type:"c",value:S.getHex()}:S&&S.isVector2?f.uniforms[_]={type:"v2",value:S.toArray()}:S&&S.isVector3?f.uniforms[_]={type:"v3",value:S.toArray()}:S&&S.isVector4?f.uniforms[_]={type:"v4",value:S.toArray()}:S&&S.isMatrix3?f.uniforms[_]={type:"m3",value:S.toArray()}:S&&S.isMatrix4?f.uniforms[_]={type:"m4",value:S.toArray()}:f.uniforms[_]={value:S}}Object.keys(this.defines).length>0&&(f.defines=this.defines),f.vertexShader=this.vertexShader,f.fragmentShader=this.fragmentShader;const y={};for(const _ in this.extensions)this.extensions[_]===!0&&(y[_]=!0);return Object.keys(y).length>0&&(f.extensions=y),f}}Th.prototype.isShaderMaterial=!0;class wf extends Me{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Nt,this.projectionMatrix=new Nt,this.projectionMatrixInverse=new Nt}copy(i,f){return super.copy(i,f),this.matrixWorldInverse.copy(i.matrixWorldInverse),this.projectionMatrix.copy(i.projectionMatrix),this.projectionMatrixInverse.copy(i.projectionMatrixInverse),this}getWorldDirection(i){this.updateWorldMatrix(!0,!1);const f=this.matrixWorld.elements;return i.set(-f[8],-f[9],-f[10]).normalize()}updateMatrixWorld(i){super.updateMatrixWorld(i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(i,f){super.updateWorldMatrix(i,f),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}wf.prototype.isCamera=!0;class ga extends wf{constructor(i=50,f=1,y=.1,_=2e3){super(),this.type="PerspectiveCamera",this.fov=i,this.zoom=1,this.near=y,this.far=_,this.focus=10,this.aspect=f,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(i,f){return super.copy(i,f),this.fov=i.fov,this.zoom=i.zoom,this.near=i.near,this.far=i.far,this.focus=i.focus,this.aspect=i.aspect,this.view=i.view===null?null:Object.assign({},i.view),this.filmGauge=i.filmGauge,this.filmOffset=i.filmOffset,this}setFocalLength(i){const f=.5*this.getFilmHeight()/i;this.fov=2*Sr*Math.atan(f),this.updateProjectionMatrix()}getFocalLength(){const i=Math.tan(.5*Er*this.fov);return .5*this.getFilmHeight()/i}getEffectiveFOV(){return 2*Sr*Math.atan(Math.tan(.5*Er*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(i,f,y,_,S,I){this.aspect=i/f,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=i,this.view.fullHeight=f,this.view.offsetX=y,this.view.offsetY=_,this.view.width=S,this.view.height=I,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const i=this.near;let f=i*Math.tan(.5*Er*this.fov)/this.zoom,y=2*f,_=this.aspect*y,S=-.5*_;const I=this.view;if(this.view!==null&&this.view.enabled){const D=I.fullWidth,F=I.fullHeight;S+=I.offsetX*_/D,f-=I.offsetY*y/F,_*=I.width/D,y*=I.height/F}const R=this.filmOffset;R!==0&&(S+=i*R/this.getFilmWidth()),this.projectionMatrix.makePerspective(S,S+_,f,f-y,i,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(i){const f=super.toJSON(i);return f.object.fov=this.fov,f.object.zoom=this.zoom,f.object.near=this.near,f.object.far=this.far,f.object.focus=this.focus,f.object.aspect=this.aspect,this.view!==null&&(f.object.view=Object.assign({},this.view)),f.object.filmGauge=this.filmGauge,f.object.filmOffset=this.filmOffset,f}}ga.prototype.isPerspectiveCamera=!0;const xd=90;class Ef extends Me{constructor(i,f,y){if(super(),this.type="CubeCamera",y.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=y;const _=new ga(xd,1,i,f);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new me(1,0,0)),this.add(_);const S=new ga(xd,1,i,f);S.layers=this.layers,S.up.set(0,-1,0),S.lookAt(new me(-1,0,0)),this.add(S);const I=new ga(xd,1,i,f);I.layers=this.layers,I.up.set(0,0,1),I.lookAt(new me(0,1,0)),this.add(I);const R=new ga(xd,1,i,f);R.layers=this.layers,R.up.set(0,0,-1),R.lookAt(new me(0,-1,0)),this.add(R);const D=new ga(xd,1,i,f);D.layers=this.layers,D.up.set(0,-1,0),D.lookAt(new me(0,0,1)),this.add(D);const F=new ga(xd,1,i,f);F.layers=this.layers,F.up.set(0,-1,0),F.lookAt(new me(0,0,-1)),this.add(F)}update(i,f){this.parent===null&&this.updateMatrixWorld();const y=this.renderTarget,[_,S,I,R,D,F]=this.children,G=i.xr.enabled,W=i.getRenderTarget();i.xr.enabled=!1;const Z=y.texture.generateMipmaps;y.texture.generateMipmaps=!1,i.setRenderTarget(y,0),i.render(f,_),i.setRenderTarget(y,1),i.render(f,S),i.setRenderTarget(y,2),i.render(f,I),i.setRenderTarget(y,3),i.render(f,R),i.setRenderTarget(y,4),i.render(f,D),y.texture.generateMipmaps=Z,i.setRenderTarget(y,5),i.render(f,F),i.setRenderTarget(W),i.xr.enabled=G}}class Sf extends le{constructor(i,f,y,_,S,I,R,D,F,G){super(i=i!==void 0?i:[],f=f!==void 0?f:301,y,_,S,I,R=R!==void 0?R:1022,D,F,G),this.flipY=!1}get images(){return this.image}set images(i){this.image=i}}Sf.prototype.isCubeTexture=!0;class $m extends nt{constructor(i,f,y){Number.isInteger(f)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),f=y),super(i,i,f),f=f||{},this.texture=new Sf(void 0,f.mapping,f.wrapS,f.wrapT,f.magFilter,f.minFilter,f.format,f.type,f.anisotropy,f.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=f.generateMipmaps!==void 0&&f.generateMipmaps,this.texture.minFilter=f.minFilter!==void 0?f.minFilter:1006,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(i,f){this.texture.type=f.type,this.texture.format=1023,this.texture.encoding=f.encoding,this.texture.generateMipmaps=f.generateMipmaps,this.texture.minFilter=f.minFilter,this.texture.magFilter=f.magFilter;const y={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},_=new Ul(5,5,5),S=new Th({name:"CubemapFromEquirect",uniforms:vd(y.uniforms),vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,side:1,blending:0});S.uniforms.tEquirect.value=f;const I=new Vo(_,S),R=f.minFilter;return f.minFilter===1008&&(f.minFilter=1006),new Ef(1,10,this).update(i,I),f.minFilter=R,I.geometry.dispose(),I.material.dispose(),this}clear(i,f,y,_){const S=i.getRenderTarget();for(let I=0;I<6;I++)i.setRenderTarget(this,I),i.clear(f,y,_);i.setRenderTarget(S)}}$m.prototype.isWebGLCubeRenderTarget=!0;const i_=new me,Xm=new me,Np=new Di;class Vu{constructor(i=new me(1,0,0),f=0){this.normal=i,this.constant=f}set(i,f){return this.normal.copy(i),this.constant=f,this}setComponents(i,f,y,_){return this.normal.set(i,f,y),this.constant=_,this}setFromNormalAndCoplanarPoint(i,f){return this.normal.copy(i),this.constant=-f.dot(this.normal),this}setFromCoplanarPoints(i,f,y){const _=i_.subVectors(y,f).cross(Xm.subVectors(i,f)).normalize();return this.setFromNormalAndCoplanarPoint(_,i),this}copy(i){return this.normal.copy(i.normal),this.constant=i.constant,this}normalize(){const i=1/this.normal.length();return this.normal.multiplyScalar(i),this.constant*=i,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(i){return this.normal.dot(i)+this.constant}distanceToSphere(i){return this.distanceToPoint(i.center)-i.radius}projectPoint(i,f){return f.copy(this.normal).multiplyScalar(-this.distanceToPoint(i)).add(i)}intersectLine(i,f){const y=i.delta(i_),_=this.normal.dot(y);if(_===0)return this.distanceToPoint(i.start)===0?f.copy(i.start):null;const S=-(i.start.dot(this.normal)+this.constant)/_;return S<0||S>1?null:f.copy(y).multiplyScalar(S).add(i.start)}intersectsLine(i){const f=this.distanceToPoint(i.start),y=this.distanceToPoint(i.end);return f<0&&y>0||y<0&&f>0}intersectsBox(i){return i.intersectsPlane(this)}intersectsSphere(i){return i.intersectsPlane(this)}coplanarPoint(i){return i.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(i,f){const y=f||Np.getNormalMatrix(i),_=this.coplanarPoint(i_).applyMatrix4(i),S=this.normal.applyMatrix3(y).normalize();return this.constant=-_.dot(S),this}translate(i){return this.constant-=i.dot(this.normal),this}equals(i){return i.normal.equals(this.normal)&&i.constant===this.constant}clone(){return new this.constructor().copy(this)}}Vu.prototype.isPlane=!0;const Vc=new tl,Dp=new me;class nu{constructor(i=new Vu,f=new Vu,y=new Vu,_=new Vu,S=new Vu,I=new Vu){this.planes=[i,f,y,_,S,I]}set(i,f,y,_,S,I){const R=this.planes;return R[0].copy(i),R[1].copy(f),R[2].copy(y),R[3].copy(_),R[4].copy(S),R[5].copy(I),this}copy(i){const f=this.planes;for(let y=0;y<6;y++)f[y].copy(i.planes[y]);return this}setFromProjectionMatrix(i){const f=this.planes,y=i.elements,_=y[0],S=y[1],I=y[2],R=y[3],D=y[4],F=y[5],G=y[6],W=y[7],Z=y[8],K=y[9],oe=y[10],de=y[11],ke=y[12],pe=y[13],Ve=y[14],Ye=y[15];return f[0].setComponents(R-_,W-D,de-Z,Ye-ke).normalize(),f[1].setComponents(R+_,W+D,de+Z,Ye+ke).normalize(),f[2].setComponents(R+S,W+F,de+K,Ye+pe).normalize(),f[3].setComponents(R-S,W-F,de-K,Ye-pe).normalize(),f[4].setComponents(R-I,W-G,de-oe,Ye-Ve).normalize(),f[5].setComponents(R+I,W+G,de+oe,Ye+Ve).normalize(),this}intersectsObject(i){const f=i.geometry;return f.boundingSphere===null&&f.computeBoundingSphere(),Vc.copy(f.boundingSphere).applyMatrix4(i.matrixWorld),this.intersectsSphere(Vc)}intersectsSprite(i){return Vc.center.set(0,0,0),Vc.radius=.7071067811865476,Vc.applyMatrix4(i.matrixWorld),this.intersectsSphere(Vc)}intersectsSphere(i){const f=this.planes,y=i.center,_=-i.radius;for(let S=0;S<6;S++)if(f[S].distanceToPoint(y)<_)return!1;return!0}intersectsBox(i){const f=this.planes;for(let y=0;y<6;y++){const _=f[y];if(Dp.x=_.normal.x>0?i.max.x:i.min.x,Dp.y=_.normal.y>0?i.max.y:i.min.y,Dp.z=_.normal.z>0?i.max.z:i.min.z,_.distanceToPoint(Dp)<0)return!1}return!0}containsPoint(i){const f=this.planes;for(let y=0;y<6;y++)if(f[y].distanceToPoint(i)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Zm(){let M=null,i=!1,f=null,y=null;function _(S,I){f(S,I),y=M.requestAnimationFrame(_)}return{start:function(){i!==!0&&f!==null&&(y=M.requestAnimationFrame(_),i=!0)},stop:function(){M.cancelAnimationFrame(y),i=!1},setAnimationLoop:function(S){f=S},setContext:function(S){M=S}}}function s_(M,i){const f=i.isWebGL2,y=new WeakMap;return{get:function(_){return _.isInterleavedBufferAttribute&&(_=_.data),y.get(_)},remove:function(_){_.isInterleavedBufferAttribute&&(_=_.data);const S=y.get(_);S&&(M.deleteBuffer(S.buffer),y.delete(_))},update:function(_,S){if(_.isGLBufferAttribute){const R=y.get(_);return void((!R||R.version<_.version)&&y.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version}))}_.isInterleavedBufferAttribute&&(_=_.data);const I=y.get(_);I===void 0?y.set(_,function(R,D){const F=R.array,G=R.usage,W=M.createBuffer();M.bindBuffer(D,W),M.bufferData(D,F,G),R.onUploadCallback();let Z=5126;return F instanceof Float32Array?Z=5126:F instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):F instanceof Uint16Array?R.isFloat16BufferAttribute?f?Z=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):Z=5123:F instanceof Int16Array?Z=5122:F instanceof Uint32Array?Z=5125:F instanceof Int32Array?Z=5124:F instanceof Int8Array?Z=5120:(F instanceof Uint8Array||F instanceof Uint8ClampedArray)&&(Z=5121),{buffer:W,type:Z,bytesPerElement:F.BYTES_PER_ELEMENT,version:R.version}}(_,S)):I.version<_.version&&(function(R,D,F){const G=D.array,W=D.updateRange;M.bindBuffer(F,R),W.count===-1?M.bufferSubData(F,0,G):(f?M.bufferSubData(F,W.offset*G.BYTES_PER_ELEMENT,G,W.offset,W.count):M.bufferSubData(F,W.offset*G.BYTES_PER_ELEMENT,G.subarray(W.offset,W.offset+W.count)),W.count=-1)}(I.buffer,_,S),I.version=_.version)}}}class Gc extends bi{constructor(i=1,f=1,y=1,_=1){super(),this.type="PlaneGeometry",this.parameters={width:i,height:f,widthSegments:y,heightSegments:_};const S=i/2,I=f/2,R=Math.floor(y),D=Math.floor(_),F=R+1,G=D+1,W=i/R,Z=f/D,K=[],oe=[],de=[],ke=[];for(let pe=0;pe<G;pe++){const Ve=pe*Z-I;for(let Ye=0;Ye<F;Ye++){const $e=Ye*W-S;oe.push($e,-Ve,0),de.push(0,0,1),ke.push(Ye/R),ke.push(1-pe/D)}}for(let pe=0;pe<D;pe++)for(let Ve=0;Ve<R;Ve++){const Ye=Ve+F*pe,$e=Ve+F*(pe+1),_t=Ve+1+F*(pe+1),bt=Ve+1+F*pe;K.push(Ye,$e,bt),K.push($e,_t,bt)}this.setIndex(K),this.setAttribute("position",new Pr(oe,3)),this.setAttribute("normal",new Pr(de,3)),this.setAttribute("uv",new Pr(ke,2))}static fromJSON(i){return new Gc(i.width,i.height,i.widthSegments,i.heightSegments)}}const ts={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment:`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotVH = saturate( dot( geometry.viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float NoH ) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float NoV, float NoL ) {
	return saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );
}
vec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		envColor = envMapTexelToLinear( envColor );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in GeometricContext geometry ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularTintFactor = specularTint;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARTINTMAP
			specularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularTintFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenTint = sheenTint;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenTint;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment:`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex:`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex:`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,output_fragment:`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment:`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationTint, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = transmission.a;
#endif`,transmission_pars_fragment:`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationTint;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( float roughness, float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularTint;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARTINTMAP
		uniform sampler2D specularTintMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenTint;
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Lr={common:{diffuse:{value:new Xn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Di},uv2Transform:{value:new Di},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Xn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Di}},sprite:{diffuse:{value:new Xn(16777215)},opacity:{value:1},center:{value:new Vn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Di}}},pc={basic:{uniforms:xl([Lr.common,Lr.specularmap,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.fog]),vertexShader:ts.meshbasic_vert,fragmentShader:ts.meshbasic_frag},lambert:{uniforms:xl([Lr.common,Lr.specularmap,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.fog,Lr.lights,{emissive:{value:new Xn(0)}}]),vertexShader:ts.meshlambert_vert,fragmentShader:ts.meshlambert_frag},phong:{uniforms:xl([Lr.common,Lr.specularmap,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.fog,Lr.lights,{emissive:{value:new Xn(0)},specular:{value:new Xn(1118481)},shininess:{value:30}}]),vertexShader:ts.meshphong_vert,fragmentShader:ts.meshphong_frag},standard:{uniforms:xl([Lr.common,Lr.envmap,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.roughnessmap,Lr.metalnessmap,Lr.fog,Lr.lights,{emissive:{value:new Xn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ts.meshphysical_vert,fragmentShader:ts.meshphysical_frag},toon:{uniforms:xl([Lr.common,Lr.aomap,Lr.lightmap,Lr.emissivemap,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.gradientmap,Lr.fog,Lr.lights,{emissive:{value:new Xn(0)}}]),vertexShader:ts.meshtoon_vert,fragmentShader:ts.meshtoon_frag},matcap:{uniforms:xl([Lr.common,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,Lr.fog,{matcap:{value:null}}]),vertexShader:ts.meshmatcap_vert,fragmentShader:ts.meshmatcap_frag},points:{uniforms:xl([Lr.points,Lr.fog]),vertexShader:ts.points_vert,fragmentShader:ts.points_frag},dashed:{uniforms:xl([Lr.common,Lr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ts.linedashed_vert,fragmentShader:ts.linedashed_frag},depth:{uniforms:xl([Lr.common,Lr.displacementmap]),vertexShader:ts.depth_vert,fragmentShader:ts.depth_frag},normal:{uniforms:xl([Lr.common,Lr.bumpmap,Lr.normalmap,Lr.displacementmap,{opacity:{value:1}}]),vertexShader:ts.meshnormal_vert,fragmentShader:ts.meshnormal_frag},sprite:{uniforms:xl([Lr.sprite,Lr.fog]),vertexShader:ts.sprite_vert,fragmentShader:ts.sprite_frag},background:{uniforms:{uvTransform:{value:new Di},t2D:{value:null}},vertexShader:ts.background_vert,fragmentShader:ts.background_frag},cube:{uniforms:xl([Lr.envmap,{opacity:{value:1}}]),vertexShader:ts.cube_vert,fragmentShader:ts.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ts.equirect_vert,fragmentShader:ts.equirect_frag},distanceRGBA:{uniforms:xl([Lr.common,Lr.displacementmap,{referencePosition:{value:new me},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ts.distanceRGBA_vert,fragmentShader:ts.distanceRGBA_frag},shadow:{uniforms:xl([Lr.lights,Lr.fog,{color:{value:new Xn(0)},opacity:{value:1}}]),vertexShader:ts.shadow_vert,fragmentShader:ts.shadow_frag}};function o_(M,i,f,y,_){const S=new Xn(0);let I,R,D=0,F=null,G=0,W=null;function Z(K,oe){f.buffers.color.setClear(K.r,K.g,K.b,oe,_)}return{getClearColor:function(){return S},setClearColor:function(K,oe=1){S.set(K),D=oe,Z(S,D)},getClearAlpha:function(){return D},setClearAlpha:function(K){D=K,Z(S,D)},render:function(K,oe){let de=!1,ke=oe.isScene===!0?oe.background:null;ke&&ke.isTexture&&(ke=i.get(ke));const pe=M.xr,Ve=pe.getSession&&pe.getSession();Ve&&Ve.environmentBlendMode==="additive"&&(ke=null),ke===null?Z(S,D):ke&&ke.isColor&&(Z(ke,1),de=!0),(M.autoClear||de)&&M.clear(M.autoClearColor,M.autoClearDepth,M.autoClearStencil),ke&&(ke.isCubeTexture||ke.mapping===306)?(R===void 0&&(R=new Vo(new Ul(1,1,1),new Th({name:"BackgroundCubeMaterial",uniforms:vd(pc.cube.uniforms),vertexShader:pc.cube.vertexShader,fragmentShader:pc.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),R.geometry.deleteAttribute("normal"),R.geometry.deleteAttribute("uv"),R.onBeforeRender=function(Ye,$e,_t){this.matrixWorld.copyPosition(_t.matrixWorld)},Object.defineProperty(R.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),y.update(R)),R.material.uniforms.envMap.value=ke,R.material.uniforms.flipEnvMap.value=ke.isCubeTexture&&ke.isRenderTargetTexture===!1?-1:1,F===ke&&G===ke.version&&W===M.toneMapping||(R.material.needsUpdate=!0,F=ke,G=ke.version,W=M.toneMapping),K.unshift(R,R.geometry,R.material,0,0,null)):ke&&ke.isTexture&&(I===void 0&&(I=new Vo(new Gc(2,2),new Th({name:"BackgroundMaterial",uniforms:vd(pc.background.uniforms),vertexShader:pc.background.vertexShader,fragmentShader:pc.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),Object.defineProperty(I.material,"map",{get:function(){return this.uniforms.t2D.value}}),y.update(I)),I.material.uniforms.t2D.value=ke,ke.matrixAutoUpdate===!0&&ke.updateMatrix(),I.material.uniforms.uvTransform.value.copy(ke.matrix),F===ke&&G===ke.version&&W===M.toneMapping||(I.material.needsUpdate=!0,F=ke,G=ke.version,W=M.toneMapping),K.unshift(I,I.geometry,I.material,0,0,null))}}}function c0(M,i,f,y){const _=M.getParameter(34921),S=y.isWebGL2?null:i.get("OES_vertex_array_object"),I=y.isWebGL2||S!==null,R={},D=Z(null);let F=D;function G($e){return y.isWebGL2?M.bindVertexArray($e):S.bindVertexArrayOES($e)}function W($e){return y.isWebGL2?M.deleteVertexArray($e):S.deleteVertexArrayOES($e)}function Z($e){const _t=[],bt=[],Vt=[];for(let qt=0;qt<_;qt++)_t[qt]=0,bt[qt]=0,Vt[qt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:_t,enabledAttributes:bt,attributeDivisors:Vt,object:$e,attributes:{},index:null}}function K(){const $e=F.newAttributes;for(let _t=0,bt=$e.length;_t<bt;_t++)$e[_t]=0}function oe($e){de($e,0)}function de($e,_t){const bt=F.newAttributes,Vt=F.enabledAttributes,qt=F.attributeDivisors;bt[$e]=1,Vt[$e]===0&&(M.enableVertexAttribArray($e),Vt[$e]=1),qt[$e]!==_t&&((y.isWebGL2?M:i.get("ANGLE_instanced_arrays"))[y.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"]($e,_t),qt[$e]=_t)}function ke(){const $e=F.newAttributes,_t=F.enabledAttributes;for(let bt=0,Vt=_t.length;bt<Vt;bt++)_t[bt]!==$e[bt]&&(M.disableVertexAttribArray(bt),_t[bt]=0)}function pe($e,_t,bt,Vt,qt,mn){y.isWebGL2!==!0||bt!==5124&&bt!==5125?M.vertexAttribPointer($e,_t,bt,Vt,qt,mn):M.vertexAttribIPointer($e,_t,bt,qt,mn)}function Ve(){Ye(),F!==D&&(F=D,G(F.object))}function Ye(){D.geometry=null,D.program=null,D.wireframe=!1}return{setup:function($e,_t,bt,Vt,qt){let mn=!1;if(I){const sn=function(dn,wr,er){const Pn=er.wireframe===!0;let ir=R[dn.id];ir===void 0&&(ir={},R[dn.id]=ir);let Or=ir[wr.id];Or===void 0&&(Or={},ir[wr.id]=Or);let jr=Or[Pn];return jr===void 0&&(jr=Z(y.isWebGL2?M.createVertexArray():S.createVertexArrayOES()),Or[Pn]=jr),jr}(Vt,bt,_t);F!==sn&&(F=sn,G(F.object)),mn=function(dn,wr){const er=F.attributes,Pn=dn.attributes;let ir=0;for(const Or in Pn){const jr=er[Or],si=Pn[Or];if(jr===void 0||jr.attribute!==si||jr.data!==si.data)return!0;ir++}return F.attributesNum!==ir||F.index!==wr}(Vt,qt),mn&&function(dn,wr){const er={},Pn=dn.attributes;let ir=0;for(const Or in Pn){const jr=Pn[Or],si={};si.attribute=jr,jr.data&&(si.data=jr.data),er[Or]=si,ir++}F.attributes=er,F.attributesNum=ir,F.index=wr}(Vt,qt)}else{const sn=_t.wireframe===!0;F.geometry===Vt.id&&F.program===bt.id&&F.wireframe===sn||(F.geometry=Vt.id,F.program=bt.id,F.wireframe=sn,mn=!0)}$e.isInstancedMesh===!0&&(mn=!0),qt!==null&&f.update(qt,34963),mn&&(function(sn,dn,wr,er){if(y.isWebGL2===!1&&(sn.isInstancedMesh||er.isInstancedBufferGeometry)&&i.get("ANGLE_instanced_arrays")===null)return;K();const Pn=er.attributes,ir=wr.getAttributes(),Or=dn.defaultAttributeValues;for(const jr in ir){const si=ir[jr];if(si.location>=0){let gi=Pn[jr];if(gi===void 0&&(jr==="instanceMatrix"&&sn.instanceMatrix&&(gi=sn.instanceMatrix),jr==="instanceColor"&&sn.instanceColor&&(gi=sn.instanceColor)),gi!==void 0){const yi=gi.normalized,sr=gi.itemSize,xt=f.get(gi);if(xt===void 0)continue;const Pt=xt.buffer,Fn=xt.type,ln=xt.bytesPerElement;if(gi.isInterleavedBufferAttribute){const rn=gi.data,yr=rn.stride,dr=gi.offset;if(rn&&rn.isInstancedInterleavedBuffer){for(let hn=0;hn<si.locationSize;hn++)de(si.location+hn,rn.meshPerAttribute);sn.isInstancedMesh!==!0&&er._maxInstanceCount===void 0&&(er._maxInstanceCount=rn.meshPerAttribute*rn.count)}else for(let hn=0;hn<si.locationSize;hn++)oe(si.location+hn);M.bindBuffer(34962,Pt);for(let hn=0;hn<si.locationSize;hn++)pe(si.location+hn,sr/si.locationSize,Fn,yi,yr*ln,(dr+sr/si.locationSize*hn)*ln)}else{if(gi.isInstancedBufferAttribute){for(let rn=0;rn<si.locationSize;rn++)de(si.location+rn,gi.meshPerAttribute);sn.isInstancedMesh!==!0&&er._maxInstanceCount===void 0&&(er._maxInstanceCount=gi.meshPerAttribute*gi.count)}else for(let rn=0;rn<si.locationSize;rn++)oe(si.location+rn);M.bindBuffer(34962,Pt);for(let rn=0;rn<si.locationSize;rn++)pe(si.location+rn,sr/si.locationSize,Fn,yi,sr*ln,sr/si.locationSize*rn*ln)}}else if(Or!==void 0){const yi=Or[jr];if(yi!==void 0)switch(yi.length){case 2:M.vertexAttrib2fv(si.location,yi);break;case 3:M.vertexAttrib3fv(si.location,yi);break;case 4:M.vertexAttrib4fv(si.location,yi);break;default:M.vertexAttrib1fv(si.location,yi)}}}}ke()}($e,_t,bt,Vt),qt!==null&&M.bindBuffer(34963,f.get(qt).buffer))},reset:Ve,resetDefaultState:Ye,dispose:function(){Ve();for(const $e in R){const _t=R[$e];for(const bt in _t){const Vt=_t[bt];for(const qt in Vt)W(Vt[qt].object),delete Vt[qt];delete _t[bt]}delete R[$e]}},releaseStatesOfGeometry:function($e){if(R[$e.id]===void 0)return;const _t=R[$e.id];for(const bt in _t){const Vt=_t[bt];for(const qt in Vt)W(Vt[qt].object),delete Vt[qt];delete _t[bt]}delete R[$e.id]},releaseStatesOfProgram:function($e){for(const _t in R){const bt=R[_t];if(bt[$e.id]===void 0)continue;const Vt=bt[$e.id];for(const qt in Vt)W(Vt[qt].object),delete Vt[qt];delete bt[$e.id]}},initAttributes:K,enableAttribute:oe,disableUnusedAttributes:ke}}function Ym(M,i,f,y){const _=y.isWebGL2;let S;this.setMode=function(I){S=I},this.render=function(I,R){M.drawArrays(S,I,R),f.update(R,S,1)},this.renderInstances=function(I,R,D){if(D===0)return;let F,G;if(_)F=M,G="drawArraysInstanced";else if(F=i.get("ANGLE_instanced_arrays"),G="drawArraysInstancedANGLE",F===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");F[G](S,I,R,D),f.update(R,S,D)}}function gv(M,i,f){let y;function _($e){if($e==="highp"){if(M.getShaderPrecisionFormat(35633,36338).precision>0&&M.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";$e="mediump"}return $e==="mediump"&&M.getShaderPrecisionFormat(35633,36337).precision>0&&M.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const S=typeof WebGL2RenderingContext<"u"&&M instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&M instanceof WebGL2ComputeRenderingContext;let I=f.precision!==void 0?f.precision:"highp";const R=_(I);R!==I&&(console.warn("THREE.WebGLRenderer:",I,"not supported, using",R,"instead."),I=R);const D=S||i.has("WEBGL_draw_buffers"),F=f.logarithmicDepthBuffer===!0,G=M.getParameter(34930),W=M.getParameter(35660),Z=M.getParameter(3379),K=M.getParameter(34076),oe=M.getParameter(34921),de=M.getParameter(36347),ke=M.getParameter(36348),pe=M.getParameter(36349),Ve=W>0,Ye=S||i.has("OES_texture_float");return{isWebGL2:S,drawBuffers:D,getMaxAnisotropy:function(){if(y!==void 0)return y;if(i.has("EXT_texture_filter_anisotropic")===!0){const $e=i.get("EXT_texture_filter_anisotropic");y=M.getParameter($e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else y=0;return y},getMaxPrecision:_,precision:I,logarithmicDepthBuffer:F,maxTextures:G,maxVertexTextures:W,maxTextureSize:Z,maxCubemapSize:K,maxAttributes:oe,maxVertexUniforms:de,maxVaryings:ke,maxFragmentUniforms:pe,vertexTextures:Ve,floatFragmentTextures:Ye,floatVertexTextures:Ve&&Ye,maxSamples:S?M.getParameter(36183):0}}function a_(M){const i=this;let f=null,y=0,_=!1,S=!1;const I=new Vu,R=new Di,D={value:null,needsUpdate:!1};function F(){D.value!==f&&(D.value=f,D.needsUpdate=y>0),i.numPlanes=y,i.numIntersection=0}function G(W,Z,K,oe){const de=W!==null?W.length:0;let ke=null;if(de!==0){if(ke=D.value,oe!==!0||ke===null){const pe=K+4*de,Ve=Z.matrixWorldInverse;R.getNormalMatrix(Ve),(ke===null||ke.length<pe)&&(ke=new Float32Array(pe));for(let Ye=0,$e=K;Ye!==de;++Ye,$e+=4)I.copy(W[Ye]).applyMatrix4(Ve,R),I.normal.toArray(ke,$e),ke[$e+3]=I.constant}D.value=ke,D.needsUpdate=!0}return i.numPlanes=de,i.numIntersection=0,ke}this.uniform=D,this.numPlanes=0,this.numIntersection=0,this.init=function(W,Z,K){const oe=W.length!==0||Z||y!==0||_;return _=Z,f=G(W,K,0),y=W.length,oe},this.beginShadows=function(){S=!0,G(null)},this.endShadows=function(){S=!1,F()},this.setState=function(W,Z,K){const oe=W.clippingPlanes,de=W.clipIntersection,ke=W.clipShadows,pe=M.get(W);if(!_||oe===null||oe.length===0||S&&!ke)S?G(null):F();else{const Ve=S?0:y,Ye=4*Ve;let $e=pe.clippingState||null;D.value=$e,$e=G(oe,Z,Ye,K);for(let _t=0;_t!==Ye;++_t)$e[_t]=f[_t];pe.clippingState=$e,this.numIntersection=de?this.numPlanes:0,this.numPlanes+=Ve}}}function m3(M){let i=new WeakMap;function f(_,S){return S===303?_.mapping=301:S===304&&(_.mapping=302),_}function y(_){const S=_.target;S.removeEventListener("dispose",y);const I=i.get(S);I!==void 0&&(i.delete(S),I.dispose())}return{get:function(_){if(_&&_.isTexture&&_.isRenderTargetTexture===!1){const S=_.mapping;if(S===303||S===304){if(i.has(_))return f(i.get(_).texture,_.mapping);{const I=_.image;if(I&&I.height>0){const R=M.getRenderTarget(),D=new $m(I.height/2);return D.fromEquirectangularTexture(M,_),i.set(_,D),M.setRenderTarget(R),_.addEventListener("dispose",y),f(D.texture,_.mapping)}return null}}}return _},dispose:function(){i=new WeakMap}}}pc.physical={uniforms:xl([pc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vn(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new Xn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Vn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Xn(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Xn(1,1,1)},specularTintMap:{value:null}}]),vertexShader:ts.meshphysical_vert,fragmentShader:ts.meshphysical_frag};class Tf extends wf{constructor(i=-1,f=1,y=1,_=-1,S=.1,I=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=i,this.right=f,this.top=y,this.bottom=_,this.near=S,this.far=I,this.updateProjectionMatrix()}copy(i,f){return super.copy(i,f),this.left=i.left,this.right=i.right,this.top=i.top,this.bottom=i.bottom,this.near=i.near,this.far=i.far,this.zoom=i.zoom,this.view=i.view===null?null:Object.assign({},i.view),this}setViewOffset(i,f,y,_,S,I){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=i,this.view.fullHeight=f,this.view.offsetX=y,this.view.offsetY=_,this.view.width=S,this.view.height=I,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const i=(this.right-this.left)/(2*this.zoom),f=(this.top-this.bottom)/(2*this.zoom),y=(this.right+this.left)/2,_=(this.top+this.bottom)/2;let S=y-i,I=y+i,R=_+f,D=_-f;if(this.view!==null&&this.view.enabled){const F=(this.right-this.left)/this.view.fullWidth/this.zoom,G=(this.top-this.bottom)/this.view.fullHeight/this.zoom;S+=F*this.view.offsetX,I=S+F*this.view.width,R-=G*this.view.offsetY,D=R-G*this.view.height}this.projectionMatrix.makeOrthographic(S,I,R,D,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(i){const f=super.toJSON(i);return f.object.zoom=this.zoom,f.object.left=this.left,f.object.right=this.right,f.object.top=this.top,f.object.bottom=this.bottom,f.object.near=this.near,f.object.far=this.far,this.view!==null&&(f.object.view=Object.assign({},this.view)),f}}Tf.prototype.isOrthographicCamera=!0;class Mf extends Th{constructor(i){super(i),this.type="RawShaderMaterial"}}Mf.prototype.isRawShaderMaterial=!0;const ru=Math.pow(2,8),l_=[.125,.215,.35,.446,.526,.582],Km=5+l_.length,Jm=20,jl={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},u_=new Tf,{_lodPlanes:Qm,_sizeLods:yv,_sigmas:h0}=f0(),_v=new Xn;let d0=null;const Hc=(1+Math.sqrt(5))/2,mc=1/Hc,c_=[new me(1,1,1),new me(-1,1,1),new me(1,1,-1),new me(-1,1,-1),new me(0,Hc,mc),new me(0,Hc,-mc),new me(mc,0,Hc),new me(-mc,0,Hc),new me(Hc,mc,0),new me(-Hc,mc,0)];class h_{constructor(i){this._renderer=i,this._pingPongRenderTarget=null,this._blurMaterial=function(f){const y=new Float32Array(f),_=new me(0,1,0);return new Mf({name:"SphericalGaussianBlur",defines:{n:f},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:y},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:_},inputEncoding:{value:jl[3e3]},outputEncoding:{value:jl[3e3]}},vertexShader:Ed(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${Op()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:0,depthTest:!1,depthWrite:!1})}(Jm),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(i,f=0,y=.1,_=100){d0=this._renderer.getRenderTarget();const S=this._allocateTargets();return this._sceneToCubeUV(i,y,_,S),f>0&&this._blur(S,0,0,f),this._applyPMREM(S),this._cleanup(S),S}fromEquirectangular(i){return this._fromTexture(i)}fromCubemap(i){return this._fromTexture(i)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=wd(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=d_(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let i=0;i<Qm.length;i++)Qm[i].dispose()}_cleanup(i){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(d0),i.scissorTest=!1,bd(i,0,0,i.width,i.height)}_fromTexture(i){d0=this._renderer.getRenderTarget();const f=this._allocateTargets(i);return this._textureToCubeUV(i,f),this._applyPMREM(f),this._cleanup(f),f}_allocateTargets(i){const f={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:Mh(i)?i.encoding:3002,depthBuffer:!1},y=bu(f);return y.depthBuffer=!i,this._pingPongRenderTarget=bu(f),y}_compileMaterial(i){const f=new Vo(Qm[0],i);this._renderer.compile(f,u_)}_sceneToCubeUV(i,f,y,_){const S=new ga(90,1,f,y),I=[1,-1,1,1,1,1],R=[1,1,1,-1,-1,-1],D=this._renderer,F=D.autoClear,G=D.outputEncoding,W=D.toneMapping;D.getClearColor(_v),D.toneMapping=0,D.outputEncoding=3e3,D.autoClear=!1;const Z=new es({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),K=new Vo(new Ul,Z);let oe=!1;const de=i.background;de?de.isColor&&(Z.color.copy(de),i.background=null,oe=!0):(Z.color.copy(_v),oe=!0);for(let ke=0;ke<6;ke++){const pe=ke%3;pe==0?(S.up.set(0,I[ke],0),S.lookAt(R[ke],0,0)):pe==1?(S.up.set(0,0,I[ke]),S.lookAt(0,R[ke],0)):(S.up.set(0,I[ke],0),S.lookAt(0,0,R[ke])),bd(_,pe*ru,ke>2?ru:0,ru,ru),D.setRenderTarget(_),oe&&D.render(K,S),D.render(i,S)}K.geometry.dispose(),K.material.dispose(),D.toneMapping=W,D.outputEncoding=G,D.autoClear=F,i.background=de}_textureToCubeUV(i,f){const y=this._renderer;i.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=wd()):this._equirectShader==null&&(this._equirectShader=d_());const _=i.isCubeTexture?this._cubemapShader:this._equirectShader,S=new Vo(Qm[0],_),I=_.uniforms;I.envMap.value=i,i.isCubeTexture||I.texelSize.value.set(1/i.image.width,1/i.image.height),I.inputEncoding.value=jl[i.encoding],I.outputEncoding.value=jl[f.texture.encoding],bd(f,0,0,3*ru,2*ru),y.setRenderTarget(f),y.render(S,u_)}_applyPMREM(i){const f=this._renderer,y=f.autoClear;f.autoClear=!1;for(let _=1;_<Km;_++){const S=Math.sqrt(h0[_]*h0[_]-h0[_-1]*h0[_-1]),I=c_[(_-1)%c_.length];this._blur(i,_-1,_,S,I)}f.autoClear=y}_blur(i,f,y,_,S){const I=this._pingPongRenderTarget;this._halfBlur(i,I,f,y,_,"latitudinal",S),this._halfBlur(I,i,y,y,_,"longitudinal",S)}_halfBlur(i,f,y,_,S,I,R){const D=this._renderer,F=this._blurMaterial;I!=="latitudinal"&&I!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const G=new Vo(Qm[_],F),W=F.uniforms,Z=yv[y]-1,K=isFinite(S)?Math.PI/(2*Z):2*Math.PI/39,oe=S/K,de=isFinite(S)?1+Math.floor(3*oe):Jm;de>Jm&&console.warn(`sigmaRadians, ${S}, is too large and will clip, as it requested ${de} samples when the maximum is set to 20`);const ke=[];let pe=0;for(let Ye=0;Ye<Jm;++Ye){const $e=Ye/oe,_t=Math.exp(-$e*$e/2);ke.push(_t),Ye==0?pe+=_t:Ye<de&&(pe+=2*_t)}for(let Ye=0;Ye<ke.length;Ye++)ke[Ye]=ke[Ye]/pe;W.envMap.value=i.texture,W.samples.value=de,W.weights.value=ke,W.latitudinal.value=I==="latitudinal",R&&(W.poleAxis.value=R),W.dTheta.value=K,W.mipInt.value=8-y,W.inputEncoding.value=jl[i.texture.encoding],W.outputEncoding.value=jl[i.texture.encoding];const Ve=yv[_];bd(f,3*Math.max(0,ru-2*Ve),(_===0?0:2*ru)+2*Ve*(_>4?_-8+4:0),3*Ve,2*Ve),D.setRenderTarget(f),D.render(G,u_)}}function Mh(M){return M!==void 0&&M.type===1009&&(M.encoding===3e3||M.encoding===3001||M.encoding===3007)}function f0(){const M=[],i=[],f=[];let y=8;for(let _=0;_<Km;_++){const S=Math.pow(2,y);i.push(S);let I=1/S;_>4?I=l_[_-8+4-1]:_==0&&(I=0),f.push(I);const R=1/(S-1),D=-R/2,F=1+R/2,G=[D,D,F,D,F,F,D,D,F,F,D,F],W=6,Z=6,K=3,oe=2,de=1,ke=new Float32Array(K*Z*W),pe=new Float32Array(oe*Z*W),Ve=new Float32Array(de*Z*W);for(let $e=0;$e<W;$e++){const _t=$e%3*2/3-1,bt=$e>2?0:-1,Vt=[_t,bt,0,_t+2/3,bt,0,_t+2/3,bt+1,0,_t,bt,0,_t+2/3,bt+1,0,_t,bt+1,0];ke.set(Vt,K*Z*$e),pe.set(G,oe*Z*$e);const qt=[$e,$e,$e,$e,$e,$e];Ve.set(qt,de*Z*$e)}const Ye=new bi;Ye.setAttribute("position",new xi(ke,K)),Ye.setAttribute("uv",new xi(pe,oe)),Ye.setAttribute("faceIndex",new xi(Ve,de)),M.push(Ye),y>4&&y--}return{_lodPlanes:M,_sizeLods:i,_sigmas:f}}function bu(M){const i=new nt(3*ru,3*ru,M);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function bd(M,i,f,y,_){M.viewport.set(i,f,y,_),M.scissor.set(i,f,y,_)}function d_(){const M=new Vn(1,1);return new Mf({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:M},inputEncoding:{value:jl[3e3]},outputEncoding:{value:jl[3e3]}},vertexShader:Ed(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${Op()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:0,depthTest:!1,depthWrite:!1})}function wd(){return new Mf({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:jl[3e3]},outputEncoding:{value:jl[3e3]}},vertexShader:Ed(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${Op()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:0,depthTest:!1,depthWrite:!1})}function Ed(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Op(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function p0(M){let i=new WeakMap,f=null;function y(_){const S=_.target;S.removeEventListener("dispose",y);const I=i.get(S);I!==void 0&&(i.delete(S),I.dispose())}return{get:function(_){if(_&&_.isTexture&&_.isRenderTargetTexture===!1){const S=_.mapping,I=S===303||S===304,R=S===301||S===302;if(I||R){if(i.has(_))return i.get(_).texture;{const D=_.image;if(I&&D&&D.height>0||R&&D&&function(F){let G=0;const W=6;for(let Z=0;Z<W;Z++)F[Z]!==void 0&&G++;return G===W}(D)){const F=M.getRenderTarget();f===null&&(f=new h_(M));const G=I?f.fromEquirectangular(_):f.fromCubemap(_);return i.set(_,G),M.setRenderTarget(F),_.addEventListener("dispose",y),G.texture}return null}}}return _},dispose:function(){i=new WeakMap,f!==null&&(f.dispose(),f=null)}}}function ds(M){const i={};function f(y){if(i[y]!==void 0)return i[y];let _;switch(y){case"WEBGL_depth_texture":_=M.getExtension("WEBGL_depth_texture")||M.getExtension("MOZ_WEBGL_depth_texture")||M.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_=M.getExtension("EXT_texture_filter_anisotropic")||M.getExtension("MOZ_EXT_texture_filter_anisotropic")||M.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_=M.getExtension("WEBGL_compressed_texture_s3tc")||M.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_=M.getExtension("WEBGL_compressed_texture_pvrtc")||M.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_=M.getExtension(y)}return i[y]=_,_}return{has:function(y){return f(y)!==null},init:function(y){y.isWebGL2?f("EXT_color_buffer_float"):(f("WEBGL_depth_texture"),f("OES_texture_float"),f("OES_texture_half_float"),f("OES_texture_half_float_linear"),f("OES_standard_derivatives"),f("OES_element_index_uint"),f("OES_vertex_array_object"),f("ANGLE_instanced_arrays")),f("OES_texture_float_linear"),f("EXT_color_buffer_half_float")},get:function(y){const _=f(y);return _===null&&console.warn("THREE.WebGLRenderer: "+y+" extension not supported."),_}}}function eg(M,i,f,y){const _={},S=new WeakMap;function I(D){const F=D.target;F.index!==null&&i.remove(F.index);for(const W in F.attributes)i.remove(F.attributes[W]);F.removeEventListener("dispose",I),delete _[F.id];const G=S.get(F);G&&(i.remove(G),S.delete(F)),y.releaseStatesOfGeometry(F),F.isInstancedBufferGeometry===!0&&delete F._maxInstanceCount,f.memory.geometries--}function R(D){const F=[],G=D.index,W=D.attributes.position;let Z=0;if(G!==null){const de=G.array;Z=G.version;for(let ke=0,pe=de.length;ke<pe;ke+=3){const Ve=de[ke+0],Ye=de[ke+1],$e=de[ke+2];F.push(Ve,Ye,Ye,$e,$e,Ve)}}else{const de=W.array;Z=W.version;for(let ke=0,pe=de.length/3-1;ke<pe;ke+=3){const Ve=ke+0,Ye=ke+1,$e=ke+2;F.push(Ve,Ye,Ye,$e,$e,Ve)}}const K=new(Mp(F)>65535?Gs:Oo)(F,1);K.version=Z;const oe=S.get(D);oe&&i.remove(oe),S.set(D,K)}return{get:function(D,F){return _[F.id]===!0||(F.addEventListener("dispose",I),_[F.id]=!0,f.memory.geometries++),F},update:function(D){const F=D.attributes;for(const W in F)i.update(F[W],34962);const G=D.morphAttributes;for(const W in G){const Z=G[W];for(let K=0,oe=Z.length;K<oe;K++)i.update(Z[K],34962)}},getWireframeAttribute:function(D){const F=S.get(D);if(F){const G=D.index;G!==null&&F.version<G.version&&R(D)}else R(D);return S.get(D)}}}function vv(M,i,f,y){const _=y.isWebGL2;let S,I,R;this.setMode=function(D){S=D},this.setIndex=function(D){I=D.type,R=D.bytesPerElement},this.render=function(D,F){M.drawElements(S,F,I,D*R),f.update(F,S,1)},this.renderInstances=function(D,F,G){if(G===0)return;let W,Z;if(_)W=M,Z="drawElementsInstanced";else if(W=i.get("ANGLE_instanced_arrays"),Z="drawElementsInstancedANGLE",W===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");W[Z](S,F,I,D*R,G),f.update(F,S,G)}}function m0(M){const i={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:i,programs:null,autoReset:!0,reset:function(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0},update:function(f,y,_){switch(i.calls++,y){case 4:i.triangles+=_*(f/3);break;case 1:i.lines+=_*(f/2);break;case 3:i.lines+=_*(f-1);break;case 2:i.lines+=_*f;break;case 0:i.points+=_*f;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",y)}}}}function Fp(M,i){return M[0]-i[0]}function xv(M,i){return Math.abs(i[1])-Math.abs(M[1])}function g0(M){const i={},f=new Float32Array(8),y=[];for(let _=0;_<8;_++)y[_]=[_,0];return{update:function(_,S,I,R){const D=_.morphTargetInfluences,F=D===void 0?0:D.length;let G=i[S.id];if(G===void 0||G.length!==F){G=[];for(let de=0;de<F;de++)G[de]=[de,0];i[S.id]=G}for(let de=0;de<F;de++){const ke=G[de];ke[0]=de,ke[1]=D[de]}G.sort(xv);for(let de=0;de<8;de++)de<F&&G[de][1]?(y[de][0]=G[de][0],y[de][1]=G[de][1]):(y[de][0]=Number.MAX_SAFE_INTEGER,y[de][1]=0);y.sort(Fp);const W=S.morphAttributes.position,Z=S.morphAttributes.normal;let K=0;for(let de=0;de<8;de++){const ke=y[de],pe=ke[0],Ve=ke[1];pe!==Number.MAX_SAFE_INTEGER&&Ve?(W&&S.getAttribute("morphTarget"+de)!==W[pe]&&S.setAttribute("morphTarget"+de,W[pe]),Z&&S.getAttribute("morphNormal"+de)!==Z[pe]&&S.setAttribute("morphNormal"+de,Z[pe]),f[de]=Ve,K+=Ve):(W&&S.hasAttribute("morphTarget"+de)===!0&&S.deleteAttribute("morphTarget"+de),Z&&S.hasAttribute("morphNormal"+de)===!0&&S.deleteAttribute("morphNormal"+de),f[de]=0)}const oe=S.morphTargetsRelative?1:1-K;R.getUniforms().setValue(M,"morphTargetBaseInfluence",oe),R.getUniforms().setValue(M,"morphTargetInfluences",f)}}}function kh(M,i,f,y){let _=new WeakMap;function S(I){const R=I.target;R.removeEventListener("dispose",S),f.remove(R.instanceMatrix),R.instanceColor!==null&&f.remove(R.instanceColor)}return{update:function(I){const R=y.render.frame,D=I.geometry,F=i.get(I,D);return _.get(F)!==R&&(i.update(F),_.set(F,R)),I.isInstancedMesh&&(I.hasEventListener("dispose",S)===!1&&I.addEventListener("dispose",S),f.update(I.instanceMatrix,34962),I.instanceColor!==null&&f.update(I.instanceColor,34962)),F},dispose:function(){_=new WeakMap}}}class y0 extends le{constructor(i=null,f=1,y=1,_=1){super(null),this.image={data:i,width:f,height:y,depth:_},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}y0.prototype.isDataTexture2DArray=!0;class zp extends le{constructor(i=null,f=1,y=1,_=1){super(null),this.image={data:i,width:f,height:y,depth:_},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}zp.prototype.isDataTexture3D=!0;const kf=new le,Bp=new y0,f_=new zp,Up=new Sf,jp=[],tg=[],ng=new Float32Array(16),br=new Float32Array(9),Gu=new Float32Array(4);function Cf(M,i,f){const y=M[0];if(y<=0||y>0)return M;const _=i*f;let S=jp[_];if(S===void 0&&(S=new Float32Array(_),jp[_]=S),i!==0){y.toArray(S,0);for(let I=1,R=0;I!==i;++I)R+=f,M[I].toArray(S,R)}return S}function La(M,i){if(M.length!==i.length)return!1;for(let f=0,y=M.length;f<y;f++)if(M[f]!==i[f])return!1;return!0}function ya(M,i){for(let f=0,y=i.length;f<y;f++)M[f]=i[f]}function Pa(M,i){let f=tg[i];f===void 0&&(f=new Int32Array(i),tg[i]=f);for(let y=0;y!==i;++y)f[y]=M.allocateTextureUnit();return f}function rg(M,i){const f=this.cache;f[0]!==i&&(M.uniform1f(this.addr,i),f[0]=i)}function _0(M,i){const f=this.cache;if(i.x!==void 0)f[0]===i.x&&f[1]===i.y||(M.uniform2f(this.addr,i.x,i.y),f[0]=i.x,f[1]=i.y);else{if(La(f,i))return;M.uniform2fv(this.addr,i),ya(f,i)}}function p_(M,i){const f=this.cache;if(i.x!==void 0)f[0]===i.x&&f[1]===i.y&&f[2]===i.z||(M.uniform3f(this.addr,i.x,i.y,i.z),f[0]=i.x,f[1]=i.y,f[2]=i.z);else if(i.r!==void 0)f[0]===i.r&&f[1]===i.g&&f[2]===i.b||(M.uniform3f(this.addr,i.r,i.g,i.b),f[0]=i.r,f[1]=i.g,f[2]=i.b);else{if(La(f,i))return;M.uniform3fv(this.addr,i),ya(f,i)}}function v0(M,i){const f=this.cache;if(i.x!==void 0)f[0]===i.x&&f[1]===i.y&&f[2]===i.z&&f[3]===i.w||(M.uniform4f(this.addr,i.x,i.y,i.z,i.w),f[0]=i.x,f[1]=i.y,f[2]=i.z,f[3]=i.w);else{if(La(f,i))return;M.uniform4fv(this.addr,i),ya(f,i)}}function bv(M,i){const f=this.cache,y=i.elements;if(y===void 0){if(La(f,i))return;M.uniformMatrix2fv(this.addr,!1,i),ya(f,i)}else{if(La(f,y))return;Gu.set(y),M.uniformMatrix2fv(this.addr,!1,Gu),ya(f,y)}}function x0(M,i){const f=this.cache,y=i.elements;if(y===void 0){if(La(f,i))return;M.uniformMatrix3fv(this.addr,!1,i),ya(f,i)}else{if(La(f,y))return;br.set(y),M.uniformMatrix3fv(this.addr,!1,br),ya(f,y)}}function Vp(M,i){const f=this.cache,y=i.elements;if(y===void 0){if(La(f,i))return;M.uniformMatrix4fv(this.addr,!1,i),ya(f,i)}else{if(La(f,y))return;ng.set(y),M.uniformMatrix4fv(this.addr,!1,ng),ya(f,y)}}function m_(M,i){const f=this.cache;f[0]!==i&&(M.uniform1i(this.addr,i),f[0]=i)}function g3(M,i){const f=this.cache;La(f,i)||(M.uniform2iv(this.addr,i),ya(f,i))}function wv(M,i){const f=this.cache;La(f,i)||(M.uniform3iv(this.addr,i),ya(f,i))}function Gp(M,i){const f=this.cache;La(f,i)||(M.uniform4iv(this.addr,i),ya(f,i))}function g_(M,i){const f=this.cache;f[0]!==i&&(M.uniform1ui(this.addr,i),f[0]=i)}function y_(M,i){const f=this.cache;La(f,i)||(M.uniform2uiv(this.addr,i),ya(f,i))}function __(M,i){const f=this.cache;La(f,i)||(M.uniform3uiv(this.addr,i),ya(f,i))}function b0(M,i){const f=this.cache;La(f,i)||(M.uniform4uiv(this.addr,i),ya(f,i))}function ig(M,i,f){const y=this.cache,_=f.allocateTextureUnit();y[0]!==_&&(M.uniform1i(this.addr,_),y[0]=_),f.safeSetTexture2D(i||kf,_)}function sg(M,i,f){const y=this.cache,_=f.allocateTextureUnit();y[0]!==_&&(M.uniform1i(this.addr,_),y[0]=_),f.setTexture3D(i||f_,_)}function v_(M,i,f){const y=this.cache,_=f.allocateTextureUnit();y[0]!==_&&(M.uniform1i(this.addr,_),y[0]=_),f.safeSetTextureCube(i||Up,_)}function Ev(M,i,f){const y=this.cache,_=f.allocateTextureUnit();y[0]!==_&&(M.uniform1i(this.addr,_),y[0]=_),f.setTexture2DArray(i||Bp,_)}function x_(M,i){M.uniform1fv(this.addr,i)}function Sv(M,i){const f=Cf(i,this.size,2);M.uniform2fv(this.addr,f)}function Sd(M,i){const f=Cf(i,this.size,3);M.uniform3fv(this.addr,f)}function Tv(M,i){const f=Cf(i,this.size,4);M.uniform4fv(this.addr,f)}function Mv(M,i){const f=Cf(i,this.size,4);M.uniformMatrix2fv(this.addr,!1,f)}function y3(M,i){const f=Cf(i,this.size,9);M.uniformMatrix3fv(this.addr,!1,f)}function kv(M,i){const f=Cf(i,this.size,16);M.uniformMatrix4fv(this.addr,!1,f)}function b_(M,i){M.uniform1iv(this.addr,i)}function Cv(M,i){M.uniform2iv(this.addr,i)}function Iv(M,i){M.uniform3iv(this.addr,i)}function bl(M,i){M.uniform4iv(this.addr,i)}function _3(M,i){M.uniform1uiv(this.addr,i)}function Av(M,i){M.uniform2uiv(this.addr,i)}function v3(M,i){M.uniform3uiv(this.addr,i)}function x3(M,i){M.uniform4uiv(this.addr,i)}function Hu(M,i,f){const y=i.length,_=Pa(f,y);M.uniform1iv(this.addr,_);for(let S=0;S!==y;++S)f.safeSetTexture2D(i[S]||kf,_[S])}function Lv(M,i,f){const y=i.length,_=Pa(f,y);M.uniform1iv(this.addr,_);for(let S=0;S!==y;++S)f.safeSetTextureCube(i[S]||Up,_[S])}function b3(M,i,f){this.id=M,this.addr=f,this.cache=[],this.setValue=function(y){switch(y){case 5126:return rg;case 35664:return _0;case 35665:return p_;case 35666:return v0;case 35674:return bv;case 35675:return x0;case 35676:return Vp;case 5124:case 35670:return m_;case 35667:case 35671:return g3;case 35668:case 35672:return wv;case 35669:case 35673:return Gp;case 5125:return g_;case 36294:return y_;case 36295:return __;case 36296:return b0;case 35678:case 36198:case 36298:case 36306:case 35682:return ig;case 35679:case 36299:case 36307:return sg;case 35680:case 36300:case 36308:case 36293:return v_;case 36289:case 36303:case 36311:case 36292:return Ev}}(i.type)}function Wu(M,i,f){this.id=M,this.addr=f,this.cache=[],this.size=i.size,this.setValue=function(y){switch(y){case 5126:return x_;case 35664:return Sv;case 35665:return Sd;case 35666:return Tv;case 35674:return Mv;case 35675:return y3;case 35676:return kv;case 5124:case 35670:return b_;case 35667:case 35671:return Cv;case 35668:case 35672:return Iv;case 35669:case 35673:return bl;case 5125:return _3;case 36294:return Av;case 36295:return v3;case 36296:return x3;case 35678:case 36198:case 36298:case 36306:case 35682:return Hu;case 35680:case 36300:case 36308:case 36293:return Lv}}(i.type)}function gc(M){this.id=M,this.seq=[],this.map={}}Wu.prototype.updateCache=function(M){const i=this.cache;M instanceof Float32Array&&i.length!==M.length&&(this.cache=new Float32Array(M.length)),ya(i,M)},gc.prototype.setValue=function(M,i,f){const y=this.seq;for(let _=0,S=y.length;_!==S;++_){const I=y[_];I.setValue(M,i[I.id],f)}};const Ch=/(\w+)(\])?(\[|\.)?/g;function og(M,i){M.seq.push(i),M.map[i.id]=i}function Ir(M,i,f){const y=M.name,_=y.length;for(Ch.lastIndex=0;;){const S=Ch.exec(y),I=Ch.lastIndex;let R=S[1];const D=S[2]==="]",F=S[3];if(D&&(R|=0),F===void 0||F==="["&&I+2===_){og(f,F===void 0?new b3(R,M,i):new Wu(R,M,i));break}{let G=f.map[R];G===void 0&&(G=new gc(R),og(f,G)),f=G}}}function Wc(M,i){this.seq=[],this.map={};const f=M.getProgramParameter(i,35718);for(let y=0;y<f;++y){const _=M.getActiveUniform(i,y);Ir(_,M.getUniformLocation(i,_.name),this)}}function w0(M,i,f){const y=M.createShader(i);return M.shaderSource(y,f),M.compileShader(y),y}Wc.prototype.setValue=function(M,i,f,y){const _=this.map[i];_!==void 0&&_.setValue(M,f,y)},Wc.prototype.setOptional=function(M,i,f){const y=i[f];y!==void 0&&this.setValue(M,f,y)},Wc.upload=function(M,i,f,y){for(let _=0,S=i.length;_!==S;++_){const I=i[_],R=f[I.id];R.needsUpdate!==!1&&I.setValue(M,R.value,y)}},Wc.seqWithValue=function(M,i){const f=[];for(let y=0,_=M.length;y!==_;++y){const S=M[y];S.id in i&&f.push(S)}return f};let Hp=0;function Td(M){switch(M){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",M),["Linear","( value )"]}}function gr(M,i,f){const y=M.getShaderParameter(i,35713),_=M.getShaderInfoLog(i).trim();return y&&_===""?"":f.toUpperCase()+`

`+_+`

`+function(S){const I=S.split(`
`);for(let R=0;R<I.length;R++)I[R]=R+1+": "+I[R];return I.join(`
`)}(M.getShaderSource(i))}function Md(M,i){const f=Td(i);return"vec4 "+M+"( vec4 value ) { return "+f[0]+"ToLinear"+f[1]+"; }"}function w3(M,i){const f=Td(i);return"vec4 "+M+"( vec4 value ) { return LinearTo"+f[0]+f[1]+"; }"}function Pv(M,i){let f;switch(i){case 1:f="Linear";break;case 2:f="Reinhard";break;case 3:f="OptimizedCineon";break;case 4:f="ACESFilmic";break;case 5:f="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",i),f="Linear"}return"vec3 "+M+"( vec3 color ) { return "+f+"ToneMapping( color ); }"}function If(M){return M!==""}function w_(M,i){return M.replace(/NUM_DIR_LIGHTS/g,i.numDirLights).replace(/NUM_SPOT_LIGHTS/g,i.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,i.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,i.numPointLights).replace(/NUM_HEMI_LIGHTS/g,i.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,i.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,i.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,i.numPointLightShadows)}function E_(M,i){return M.replace(/NUM_CLIPPING_PLANES/g,i.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,i.numClippingPlanes-i.numClipIntersection)}const E3=/^[ \t]*#include +<([\w\d./]+)>/gm;function S_(M){return M.replace(E3,T_)}function T_(M,i){const f=ts[i];if(f===void 0)throw new Error("Can not resolve #include <"+i+">");return S_(f)}const M_=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,k_=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Af(M){return M.replace(k_,d).replace(M_,b)}function b(M,i,f,y){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),d(M,i,f,y)}function d(M,i,f,y){let _="";for(let S=parseInt(i);S<parseInt(f);S++)_+=y.replace(/\[\s*i\s*\]/g,"[ "+S+" ]").replace(/UNROLLED_LOOP_INDEX/g,S);return _}function v(M){let i="precision "+M.precision+` float;
precision `+M.precision+" int;";return M.precision==="highp"?i+=`
#define HIGH_PRECISION`:M.precision==="mediump"?i+=`
#define MEDIUM_PRECISION`:M.precision==="lowp"&&(i+=`
#define LOW_PRECISION`),i}function T(M,i,f,y){const _=M.getContext(),S=f.defines;let I=f.vertexShader,R=f.fragmentShader;const D=function(qt){let mn="SHADOWMAP_TYPE_BASIC";return qt.shadowMapType===1?mn="SHADOWMAP_TYPE_PCF":qt.shadowMapType===2?mn="SHADOWMAP_TYPE_PCF_SOFT":qt.shadowMapType===3&&(mn="SHADOWMAP_TYPE_VSM"),mn}(f),F=function(qt){let mn="ENVMAP_TYPE_CUBE";if(qt.envMap)switch(qt.envMapMode){case 301:case 302:mn="ENVMAP_TYPE_CUBE";break;case 306:case 307:mn="ENVMAP_TYPE_CUBE_UV"}return mn}(f),G=function(qt){let mn="ENVMAP_MODE_REFLECTION";if(qt.envMap)switch(qt.envMapMode){case 302:case 307:mn="ENVMAP_MODE_REFRACTION"}return mn}(f),W=function(qt){let mn="ENVMAP_BLENDING_NONE";if(qt.envMap)switch(qt.combine){case 0:mn="ENVMAP_BLENDING_MULTIPLY";break;case 1:mn="ENVMAP_BLENDING_MIX";break;case 2:mn="ENVMAP_BLENDING_ADD"}return mn}(f),Z=M.gammaFactor>0?M.gammaFactor:1,K=f.isWebGL2?"":function(qt){return[qt.extensionDerivatives||qt.envMapCubeUV||qt.bumpMap||qt.tangentSpaceNormalMap||qt.clearcoatNormalMap||qt.flatShading||qt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(qt.extensionFragDepth||qt.logarithmicDepthBuffer)&&qt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",qt.extensionDrawBuffers&&qt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(qt.extensionShaderTextureLOD||qt.envMap||qt.transmission)&&qt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(If).join(`
`)}(f),oe=function(qt){const mn=[];for(const sn in qt){const dn=qt[sn];dn!==!1&&mn.push("#define "+sn+" "+dn)}return mn.join(`
`)}(S),de=_.createProgram();let ke,pe,Ve=f.glslVersion?"#version "+f.glslVersion+`
`:"";f.isRawShaderMaterial?(ke=[oe].filter(If).join(`
`),ke.length>0&&(ke+=`
`),pe=[K,oe].filter(If).join(`
`),pe.length>0&&(pe+=`
`)):(ke=[v(f),"#define SHADER_NAME "+f.shaderName,oe,f.instancing?"#define USE_INSTANCING":"",f.instancingColor?"#define USE_INSTANCING_COLOR":"",f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+Z,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp2?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+G:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.normalMap&&f.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",f.clearcoatMap?"#define USE_CLEARCOATMAP":"",f.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",f.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",f.specularTintMap?"#define USE_SPECULARTINTMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.transmission?"#define USE_TRANSMISSION":"",f.transmissionMap?"#define USE_TRANSMISSIONMAP":"",f.thicknessMap?"#define USE_THICKNESSMAP":"",f.vertexTangents?"#define USE_TANGENT":"",f.vertexColors?"#define USE_COLOR":"",f.vertexAlphas?"#define USE_COLOR_ALPHA":"",f.vertexUvs?"#define USE_UV":"",f.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&f.flatShading===!1?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+D:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&f.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(If).join(`
`),pe=[K,v(f),"#define SHADER_NAME "+f.shaderName,oe,"#define GAMMA_FACTOR "+Z,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp2?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.matcap?"#define USE_MATCAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+F:"",f.envMap?"#define "+G:"",f.envMap?"#define "+W:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.normalMap&&f.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",f.clearcoat?"#define USE_CLEARCOAT":"",f.clearcoatMap?"#define USE_CLEARCOATMAP":"",f.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",f.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",f.specularTintMap?"#define USE_SPECULARTINTMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.alphaTest?"#define USE_ALPHATEST":"",f.sheenTint?"#define USE_SHEEN":"",f.transmission?"#define USE_TRANSMISSION":"",f.transmissionMap?"#define USE_TRANSMISSIONMAP":"",f.thicknessMap?"#define USE_THICKNESSMAP":"",f.vertexTangents?"#define USE_TANGENT":"",f.vertexColors||f.instancingColor?"#define USE_COLOR":"",f.vertexAlphas?"#define USE_COLOR_ALPHA":"",f.vertexUvs?"#define USE_UV":"",f.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+D:"",f.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&f.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(f.extensionShaderTextureLOD||f.envMap)&&f.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",f.toneMapping!==0?"#define TONE_MAPPING":"",f.toneMapping!==0?ts.tonemapping_pars_fragment:"",f.toneMapping!==0?Pv("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",f.format===1022?"#define OPAQUE":"",ts.encodings_pars_fragment,f.map?Md("mapTexelToLinear",f.mapEncoding):"",f.matcap?Md("matcapTexelToLinear",f.matcapEncoding):"",f.envMap?Md("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMap?Md("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.specularTintMap?Md("specularTintMapTexelToLinear",f.specularTintMapEncoding):"",f.lightMap?Md("lightMapTexelToLinear",f.lightMapEncoding):"",w3("linearToOutputTexel",f.outputEncoding),f.depthPacking?"#define DEPTH_PACKING "+f.depthPacking:"",`
`].filter(If).join(`
`)),I=S_(I),I=w_(I,f),I=E_(I,f),R=S_(R),R=w_(R,f),R=E_(R,f),I=Af(I),R=Af(R),f.isWebGL2&&f.isRawShaderMaterial!==!0&&(Ve=`#version 300 es
`,ke=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+ke,pe=["#define varying in",f.glslVersion===At?"":"out highp vec4 pc_fragColor;",f.glslVersion===At?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+pe);const Ye=Ve+pe+R,$e=w0(_,35633,Ve+ke+I),_t=w0(_,35632,Ye);if(_.attachShader(de,$e),_.attachShader(de,_t),f.index0AttributeName!==void 0?_.bindAttribLocation(de,0,f.index0AttributeName):f.morphTargets===!0&&_.bindAttribLocation(de,0,"position"),_.linkProgram(de),M.debug.checkShaderErrors){const qt=_.getProgramInfoLog(de).trim(),mn=_.getShaderInfoLog($e).trim(),sn=_.getShaderInfoLog(_t).trim();let dn=!0,wr=!0;if(_.getProgramParameter(de,35714)===!1){dn=!1;const er=gr(_,$e,"vertex"),Pn=gr(_,_t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+_.getError()+" - VALIDATE_STATUS "+_.getProgramParameter(de,35715)+`

Program Info Log: `+qt+`
`+er+`
`+Pn)}else qt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",qt):mn!==""&&sn!==""||(wr=!1);wr&&(this.diagnostics={runnable:dn,programLog:qt,vertexShader:{log:mn,prefix:ke},fragmentShader:{log:sn,prefix:pe}})}let bt,Vt;return _.deleteShader($e),_.deleteShader(_t),this.getUniforms=function(){return bt===void 0&&(bt=new Wc(_,de)),bt},this.getAttributes=function(){return Vt===void 0&&(Vt=function(qt,mn){const sn={},dn=qt.getProgramParameter(mn,35721);for(let wr=0;wr<dn;wr++){const er=qt.getActiveAttrib(mn,wr),Pn=er.name;let ir=1;er.type===35674&&(ir=2),er.type===35675&&(ir=3),er.type===35676&&(ir=4),sn[Pn]={type:er.type,location:qt.getAttribLocation(mn,Pn),locationSize:ir}}return sn}(_,de)),Vt},this.destroy=function(){y.releaseStatesOfProgram(this),_.deleteProgram(de),this.program=void 0},this.name=f.shaderName,this.id=Hp++,this.cacheKey=i,this.usedTimes=1,this.program=de,this.vertexShader=$e,this.fragmentShader=_t,this}function C(M,i,f,y,_,S,I){const R=[],D=_.isWebGL2,F=_.logarithmicDepthBuffer,G=_.floatVertexTextures,W=_.maxVertexUniforms,Z=_.vertexTextures;let K=_.precision;const oe={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},de=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function ke(pe){let Ve;return pe&&pe.isTexture?Ve=pe.encoding:pe&&pe.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Ve=pe.texture.encoding):Ve=3e3,Ve}return{getParameters:function(pe,Ve,Ye,$e,_t){const bt=$e.fog,Vt=pe.isMeshStandardMaterial?$e.environment:null,qt=(pe.isMeshStandardMaterial?f:i).get(pe.envMap||Vt),mn=oe[pe.type],sn=_t.isSkinnedMesh?function(Or){const jr=Or.skeleton.bones;if(G)return 1024;{const si=W,gi=Math.floor((si-20)/4),yi=Math.min(gi,jr.length);return yi<jr.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+jr.length+" bones. This GPU supports "+yi+"."),0):yi}}(_t):0;let dn,wr;if(pe.precision!==null&&(K=_.getMaxPrecision(pe.precision),K!==pe.precision&&console.warn("THREE.WebGLProgram.getParameters:",pe.precision,"not supported, using",K,"instead.")),mn){const Or=pc[mn];dn=Or.vertexShader,wr=Or.fragmentShader}else dn=pe.vertexShader,wr=pe.fragmentShader;const er=M.getRenderTarget(),Pn=pe.alphaTest>0,ir=pe.clearcoat>0;return{isWebGL2:D,shaderID:mn,shaderName:pe.type,vertexShader:dn,fragmentShader:wr,defines:pe.defines,isRawShaderMaterial:pe.isRawShaderMaterial===!0,glslVersion:pe.glslVersion,precision:K,instancing:_t.isInstancedMesh===!0,instancingColor:_t.isInstancedMesh===!0&&_t.instanceColor!==null,supportsVertexTextures:Z,outputEncoding:er!==null?ke(er.texture):M.outputEncoding,map:!!pe.map,mapEncoding:ke(pe.map),matcap:!!pe.matcap,matcapEncoding:ke(pe.matcap),envMap:!!qt,envMapMode:qt&&qt.mapping,envMapEncoding:ke(qt),envMapCubeUV:!!qt&&(qt.mapping===306||qt.mapping===307),lightMap:!!pe.lightMap,lightMapEncoding:ke(pe.lightMap),aoMap:!!pe.aoMap,emissiveMap:!!pe.emissiveMap,emissiveMapEncoding:ke(pe.emissiveMap),bumpMap:!!pe.bumpMap,normalMap:!!pe.normalMap,objectSpaceNormalMap:pe.normalMapType===1,tangentSpaceNormalMap:pe.normalMapType===0,clearcoat:ir,clearcoatMap:ir&&!!pe.clearcoatMap,clearcoatRoughnessMap:ir&&!!pe.clearcoatRoughnessMap,clearcoatNormalMap:ir&&!!pe.clearcoatNormalMap,displacementMap:!!pe.displacementMap,roughnessMap:!!pe.roughnessMap,metalnessMap:!!pe.metalnessMap,specularMap:!!pe.specularMap,specularIntensityMap:!!pe.specularIntensityMap,specularTintMap:!!pe.specularTintMap,specularTintMapEncoding:ke(pe.specularTintMap),alphaMap:!!pe.alphaMap,alphaTest:Pn,gradientMap:!!pe.gradientMap,sheenTint:!!pe.sheenTint&&(pe.sheenTint.r>0||pe.sheenTint.g>0||pe.sheenTint.b>0),transmission:pe.transmission>0,transmissionMap:!!pe.transmissionMap,thicknessMap:!!pe.thicknessMap,combine:pe.combine,vertexTangents:!!pe.normalMap&&!!_t.geometry&&!!_t.geometry.attributes.tangent,vertexColors:pe.vertexColors,vertexAlphas:pe.vertexColors===!0&&!!_t.geometry&&!!_t.geometry.attributes.color&&_t.geometry.attributes.color.itemSize===4,vertexUvs:!!(pe.map||pe.bumpMap||pe.normalMap||pe.specularMap||pe.alphaMap||pe.emissiveMap||pe.roughnessMap||pe.metalnessMap||pe.clearcoatMap||pe.clearcoatRoughnessMap||pe.clearcoatNormalMap||pe.displacementMap||pe.transmissionMap||pe.thicknessMap||pe.specularIntensityMap||pe.specularTintMap),uvsVertexOnly:!(pe.map||pe.bumpMap||pe.normalMap||pe.specularMap||pe.alphaMap||pe.emissiveMap||pe.roughnessMap||pe.metalnessMap||pe.clearcoatNormalMap||pe.transmission>0||pe.transmissionMap||pe.thicknessMap||pe.specularIntensityMap||pe.specularTintMap||!pe.displacementMap),fog:!!bt,useFog:pe.fog,fogExp2:bt&&bt.isFogExp2,flatShading:!!pe.flatShading,sizeAttenuation:pe.sizeAttenuation,logarithmicDepthBuffer:F,skinning:_t.isSkinnedMesh===!0&&sn>0,maxBones:sn,useVertexTexture:G,morphTargets:!!_t.geometry&&!!_t.geometry.morphAttributes.position,morphNormals:!!_t.geometry&&!!_t.geometry.morphAttributes.normal,numDirLights:Ve.directional.length,numPointLights:Ve.point.length,numSpotLights:Ve.spot.length,numRectAreaLights:Ve.rectArea.length,numHemiLights:Ve.hemi.length,numDirLightShadows:Ve.directionalShadowMap.length,numPointLightShadows:Ve.pointShadowMap.length,numSpotLightShadows:Ve.spotShadowMap.length,numClippingPlanes:I.numPlanes,numClipIntersection:I.numIntersection,format:pe.format,dithering:pe.dithering,shadowMapEnabled:M.shadowMap.enabled&&Ye.length>0,shadowMapType:M.shadowMap.type,toneMapping:pe.toneMapped?M.toneMapping:0,physicallyCorrectLights:M.physicallyCorrectLights,premultipliedAlpha:pe.premultipliedAlpha,doubleSided:pe.side===2,flipSided:pe.side===1,depthPacking:pe.depthPacking!==void 0&&pe.depthPacking,index0AttributeName:pe.index0AttributeName,extensionDerivatives:pe.extensions&&pe.extensions.derivatives,extensionFragDepth:pe.extensions&&pe.extensions.fragDepth,extensionDrawBuffers:pe.extensions&&pe.extensions.drawBuffers,extensionShaderTextureLOD:pe.extensions&&pe.extensions.shaderTextureLOD,rendererExtensionFragDepth:D||y.has("EXT_frag_depth"),rendererExtensionDrawBuffers:D||y.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:D||y.has("EXT_shader_texture_lod"),customProgramCacheKey:pe.customProgramCacheKey()}},getProgramCacheKey:function(pe){const Ve=[];if(pe.shaderID?Ve.push(pe.shaderID):(Ve.push(pe.fragmentShader),Ve.push(pe.vertexShader)),pe.defines!==void 0)for(const Ye in pe.defines)Ve.push(Ye),Ve.push(pe.defines[Ye]);if(pe.isRawShaderMaterial===!1){for(let Ye=0;Ye<de.length;Ye++)Ve.push(pe[de[Ye]]);Ve.push(M.outputEncoding),Ve.push(M.gammaFactor)}return Ve.push(pe.customProgramCacheKey),Ve.join()},getUniforms:function(pe){const Ve=oe[pe.type];let Ye;if(Ve){const $e=pc[Ve];Ye=mv.clone($e.uniforms)}else Ye=pe.uniforms;return Ye},acquireProgram:function(pe,Ve){let Ye;for(let $e=0,_t=R.length;$e<_t;$e++){const bt=R[$e];if(bt.cacheKey===Ve){Ye=bt,++Ye.usedTimes;break}}return Ye===void 0&&(Ye=new T(M,Ve,pe,S),R.push(Ye)),Ye},releaseProgram:function(pe){if(--pe.usedTimes==0){const Ve=R.indexOf(pe);R[Ve]=R[R.length-1],R.pop(),pe.destroy()}},programs:R}}function L(){let M=new WeakMap;return{get:function(i){let f=M.get(i);return f===void 0&&(f={},M.set(i,f)),f},remove:function(i){M.delete(i)},update:function(i,f,y){M.get(i)[f]=y},dispose:function(){M=new WeakMap}}}function B(M,i){return M.groupOrder!==i.groupOrder?M.groupOrder-i.groupOrder:M.renderOrder!==i.renderOrder?M.renderOrder-i.renderOrder:M.program!==i.program?M.program.id-i.program.id:M.material.id!==i.material.id?M.material.id-i.material.id:M.z!==i.z?M.z-i.z:M.id-i.id}function U(M,i){return M.groupOrder!==i.groupOrder?M.groupOrder-i.groupOrder:M.renderOrder!==i.renderOrder?M.renderOrder-i.renderOrder:M.z!==i.z?i.z-M.z:M.id-i.id}function q(M){const i=[];let f=0;const y=[],_=[],S=[],I={id:-1};function R(D,F,G,W,Z,K){let oe=i[f];const de=M.get(G);return oe===void 0?(oe={id:D.id,object:D,geometry:F,material:G,program:de.program||I,groupOrder:W,renderOrder:D.renderOrder,z:Z,group:K},i[f]=oe):(oe.id=D.id,oe.object=D,oe.geometry=F,oe.material=G,oe.program=de.program||I,oe.groupOrder=W,oe.renderOrder=D.renderOrder,oe.z=Z,oe.group=K),f++,oe}return{opaque:y,transmissive:_,transparent:S,init:function(){f=0,y.length=0,_.length=0,S.length=0},push:function(D,F,G,W,Z,K){const oe=R(D,F,G,W,Z,K);G.transmission>0?_.push(oe):G.transparent===!0?S.push(oe):y.push(oe)},unshift:function(D,F,G,W,Z,K){const oe=R(D,F,G,W,Z,K);G.transmission>0?_.unshift(oe):G.transparent===!0?S.unshift(oe):y.unshift(oe)},finish:function(){for(let D=f,F=i.length;D<F;D++){const G=i[D];if(G.id===null)break;G.id=null,G.object=null,G.geometry=null,G.material=null,G.program=null,G.group=null}},sort:function(D,F){y.length>1&&y.sort(D||B),_.length>1&&_.sort(F||U),S.length>1&&S.sort(F||U)}}}function ie(M){let i=new WeakMap;return{get:function(f,y){let _;return i.has(f)===!1?(_=new q(M),i.set(f,[_])):y>=i.get(f).length?(_=new q(M),i.get(f).push(_)):_=i.get(f)[y],_},dispose:function(){i=new WeakMap}}}function ne(){const M={};return{get:function(i){if(M[i.id]!==void 0)return M[i.id];let f;switch(i.type){case"DirectionalLight":f={direction:new me,color:new Xn};break;case"SpotLight":f={position:new me,direction:new me,color:new Xn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":f={position:new me,color:new Xn,distance:0,decay:0};break;case"HemisphereLight":f={direction:new me,skyColor:new Xn,groundColor:new Xn};break;case"RectAreaLight":f={color:new Xn,position:new me,halfWidth:new me,halfHeight:new me}}return M[i.id]=f,f}}}let be=0;function Re(M,i){return(i.castShadow?1:0)-(M.castShadow?1:0)}function je(M,i){const f=new ne,y=function(){const D={};return{get:function(F){if(D[F.id]!==void 0)return D[F.id];let G;switch(F.type){case"DirectionalLight":case"SpotLight":G={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vn};break;case"PointLight":G={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vn,shadowCameraNear:1,shadowCameraFar:1e3}}return D[F.id]=G,G}}}(),_={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let D=0;D<9;D++)_.probe.push(new me);const S=new me,I=new Nt,R=new Nt;return{setup:function(D,F){let G=0,W=0,Z=0;for(let Vt=0;Vt<9;Vt++)_.probe[Vt].set(0,0,0);let K=0,oe=0,de=0,ke=0,pe=0,Ve=0,Ye=0,$e=0;D.sort(Re);const _t=F!==!0?Math.PI:1;for(let Vt=0,qt=D.length;Vt<qt;Vt++){const mn=D[Vt],sn=mn.color,dn=mn.intensity,wr=mn.distance,er=mn.shadow&&mn.shadow.map?mn.shadow.map.texture:null;if(mn.isAmbientLight)G+=sn.r*dn*_t,W+=sn.g*dn*_t,Z+=sn.b*dn*_t;else if(mn.isLightProbe)for(let Pn=0;Pn<9;Pn++)_.probe[Pn].addScaledVector(mn.sh.coefficients[Pn],dn);else if(mn.isDirectionalLight){const Pn=f.get(mn);if(Pn.color.copy(mn.color).multiplyScalar(mn.intensity*_t),mn.castShadow){const ir=mn.shadow,Or=y.get(mn);Or.shadowBias=ir.bias,Or.shadowNormalBias=ir.normalBias,Or.shadowRadius=ir.radius,Or.shadowMapSize=ir.mapSize,_.directionalShadow[K]=Or,_.directionalShadowMap[K]=er,_.directionalShadowMatrix[K]=mn.shadow.matrix,Ve++}_.directional[K]=Pn,K++}else if(mn.isSpotLight){const Pn=f.get(mn);if(Pn.position.setFromMatrixPosition(mn.matrixWorld),Pn.color.copy(sn).multiplyScalar(dn*_t),Pn.distance=wr,Pn.coneCos=Math.cos(mn.angle),Pn.penumbraCos=Math.cos(mn.angle*(1-mn.penumbra)),Pn.decay=mn.decay,mn.castShadow){const ir=mn.shadow,Or=y.get(mn);Or.shadowBias=ir.bias,Or.shadowNormalBias=ir.normalBias,Or.shadowRadius=ir.radius,Or.shadowMapSize=ir.mapSize,_.spotShadow[de]=Or,_.spotShadowMap[de]=er,_.spotShadowMatrix[de]=mn.shadow.matrix,$e++}_.spot[de]=Pn,de++}else if(mn.isRectAreaLight){const Pn=f.get(mn);Pn.color.copy(sn).multiplyScalar(dn),Pn.halfWidth.set(.5*mn.width,0,0),Pn.halfHeight.set(0,.5*mn.height,0),_.rectArea[ke]=Pn,ke++}else if(mn.isPointLight){const Pn=f.get(mn);if(Pn.color.copy(mn.color).multiplyScalar(mn.intensity*_t),Pn.distance=mn.distance,Pn.decay=mn.decay,mn.castShadow){const ir=mn.shadow,Or=y.get(mn);Or.shadowBias=ir.bias,Or.shadowNormalBias=ir.normalBias,Or.shadowRadius=ir.radius,Or.shadowMapSize=ir.mapSize,Or.shadowCameraNear=ir.camera.near,Or.shadowCameraFar=ir.camera.far,_.pointShadow[oe]=Or,_.pointShadowMap[oe]=er,_.pointShadowMatrix[oe]=mn.shadow.matrix,Ye++}_.point[oe]=Pn,oe++}else if(mn.isHemisphereLight){const Pn=f.get(mn);Pn.skyColor.copy(mn.color).multiplyScalar(dn*_t),Pn.groundColor.copy(mn.groundColor).multiplyScalar(dn*_t),_.hemi[pe]=Pn,pe++}}ke>0&&(i.isWebGL2||M.has("OES_texture_float_linear")===!0?(_.rectAreaLTC1=Lr.LTC_FLOAT_1,_.rectAreaLTC2=Lr.LTC_FLOAT_2):M.has("OES_texture_half_float_linear")===!0?(_.rectAreaLTC1=Lr.LTC_HALF_1,_.rectAreaLTC2=Lr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),_.ambient[0]=G,_.ambient[1]=W,_.ambient[2]=Z;const bt=_.hash;bt.directionalLength===K&&bt.pointLength===oe&&bt.spotLength===de&&bt.rectAreaLength===ke&&bt.hemiLength===pe&&bt.numDirectionalShadows===Ve&&bt.numPointShadows===Ye&&bt.numSpotShadows===$e||(_.directional.length=K,_.spot.length=de,_.rectArea.length=ke,_.point.length=oe,_.hemi.length=pe,_.directionalShadow.length=Ve,_.directionalShadowMap.length=Ve,_.pointShadow.length=Ye,_.pointShadowMap.length=Ye,_.spotShadow.length=$e,_.spotShadowMap.length=$e,_.directionalShadowMatrix.length=Ve,_.pointShadowMatrix.length=Ye,_.spotShadowMatrix.length=$e,bt.directionalLength=K,bt.pointLength=oe,bt.spotLength=de,bt.rectAreaLength=ke,bt.hemiLength=pe,bt.numDirectionalShadows=Ve,bt.numPointShadows=Ye,bt.numSpotShadows=$e,_.version=be++)},setupView:function(D,F){let G=0,W=0,Z=0,K=0,oe=0;const de=F.matrixWorldInverse;for(let ke=0,pe=D.length;ke<pe;ke++){const Ve=D[ke];if(Ve.isDirectionalLight){const Ye=_.directional[G];Ye.direction.setFromMatrixPosition(Ve.matrixWorld),S.setFromMatrixPosition(Ve.target.matrixWorld),Ye.direction.sub(S),Ye.direction.transformDirection(de),G++}else if(Ve.isSpotLight){const Ye=_.spot[Z];Ye.position.setFromMatrixPosition(Ve.matrixWorld),Ye.position.applyMatrix4(de),Ye.direction.setFromMatrixPosition(Ve.matrixWorld),S.setFromMatrixPosition(Ve.target.matrixWorld),Ye.direction.sub(S),Ye.direction.transformDirection(de),Z++}else if(Ve.isRectAreaLight){const Ye=_.rectArea[K];Ye.position.setFromMatrixPosition(Ve.matrixWorld),Ye.position.applyMatrix4(de),R.identity(),I.copy(Ve.matrixWorld),I.premultiply(de),R.extractRotation(I),Ye.halfWidth.set(.5*Ve.width,0,0),Ye.halfHeight.set(0,.5*Ve.height,0),Ye.halfWidth.applyMatrix4(R),Ye.halfHeight.applyMatrix4(R),K++}else if(Ve.isPointLight){const Ye=_.point[W];Ye.position.setFromMatrixPosition(Ve.matrixWorld),Ye.position.applyMatrix4(de),W++}else if(Ve.isHemisphereLight){const Ye=_.hemi[oe];Ye.direction.setFromMatrixPosition(Ve.matrixWorld),Ye.direction.transformDirection(de),Ye.direction.normalize(),oe++}}},state:_}}function He(M,i){const f=new je(M,i),y=[],_=[];return{init:function(){y.length=0,_.length=0},state:{lightsArray:y,shadowsArray:_,lights:f},setupLights:function(S){f.setup(y,S)},setupLightsView:function(S){f.setupView(y,S)},pushLight:function(S){y.push(S)},pushShadow:function(S){_.push(S)}}}function Ge(M,i){let f=new WeakMap;return{get:function(y,_=0){let S;return f.has(y)===!1?(S=new He(M,i),f.set(y,[S])):_>=f.get(y).length?(S=new He(M,i),f.get(y).push(S)):S=f.get(y)[_],S},dispose:function(){f=new WeakMap}}}class Xe extends cn{constructor(i){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(i)}copy(i){return super.copy(i),this.depthPacking=i.depthPacking,this.map=i.map,this.alphaMap=i.alphaMap,this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this}}Xe.prototype.isMeshDepthMaterial=!0;class Ee extends cn{constructor(i){super(),this.type="MeshDistanceMaterial",this.referencePosition=new me,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(i)}copy(i){return super.copy(i),this.referencePosition.copy(i.referencePosition),this.nearDistance=i.nearDistance,this.farDistance=i.farDistance,this.map=i.map,this.alphaMap=i.alphaMap,this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this}}Ee.prototype.isMeshDistanceMaterial=!0;function Ue(M,i,f){let y=new nu;const _=new Vn,S=new Vn,I=new Fe,R=new Xe({depthPacking:3201}),D=new Ee,F={},G=f.maxTextureSize,W={0:1,1:0,2:2},Z=new Th({uniforms:{shadow_pass:{value:null},resolution:{value:new Vn},radius:{value:4},samples:{value:8}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
uniform float samples;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),K=Z.clone();K.defines.HORIZONTAL_PASS=1;const oe=new bi;oe.setAttribute("position",new xi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const de=new Vo(oe,Z),ke=this;function pe($e,_t){const bt=i.update(de);Z.uniforms.shadow_pass.value=$e.map.texture,Z.uniforms.resolution.value=$e.mapSize,Z.uniforms.radius.value=$e.radius,Z.uniforms.samples.value=$e.blurSamples,M.setRenderTarget($e.mapPass),M.clear(),M.renderBufferDirect(_t,null,bt,Z,de,null),K.uniforms.shadow_pass.value=$e.mapPass.texture,K.uniforms.resolution.value=$e.mapSize,K.uniforms.radius.value=$e.radius,K.uniforms.samples.value=$e.blurSamples,M.setRenderTarget($e.map),M.clear(),M.renderBufferDirect(_t,null,bt,K,de,null)}function Ve($e,_t,bt,Vt,qt,mn,sn){let dn=null;const wr=Vt.isPointLight===!0?$e.customDistanceMaterial:$e.customDepthMaterial;if(dn=wr!==void 0?wr:Vt.isPointLight===!0?D:R,M.localClippingEnabled&&bt.clipShadows===!0&&bt.clippingPlanes.length!==0||bt.displacementMap&&bt.displacementScale!==0||bt.alphaMap&&bt.alphaTest>0){const er=dn.uuid,Pn=bt.uuid;let ir=F[er];ir===void 0&&(ir={},F[er]=ir);let Or=ir[Pn];Or===void 0&&(Or=dn.clone(),ir[Pn]=Or),dn=Or}return dn.visible=bt.visible,dn.wireframe=bt.wireframe,dn.side=sn===3?bt.shadowSide!==null?bt.shadowSide:bt.side:bt.shadowSide!==null?bt.shadowSide:W[bt.side],dn.alphaMap=bt.alphaMap,dn.alphaTest=bt.alphaTest,dn.clipShadows=bt.clipShadows,dn.clippingPlanes=bt.clippingPlanes,dn.clipIntersection=bt.clipIntersection,dn.displacementMap=bt.displacementMap,dn.displacementScale=bt.displacementScale,dn.displacementBias=bt.displacementBias,dn.wireframeLinewidth=bt.wireframeLinewidth,dn.linewidth=bt.linewidth,Vt.isPointLight===!0&&dn.isMeshDistanceMaterial===!0&&(dn.referencePosition.setFromMatrixPosition(Vt.matrixWorld),dn.nearDistance=qt,dn.farDistance=mn),dn}function Ye($e,_t,bt,Vt,qt){if($e.visible===!1)return;if($e.layers.test(_t.layers)&&($e.isMesh||$e.isLine||$e.isPoints)&&($e.castShadow||$e.receiveShadow&&qt===3)&&(!$e.frustumCulled||y.intersectsObject($e))){$e.modelViewMatrix.multiplyMatrices(bt.matrixWorldInverse,$e.matrixWorld);const sn=i.update($e),dn=$e.material;if(Array.isArray(dn)){const wr=sn.groups;for(let er=0,Pn=wr.length;er<Pn;er++){const ir=wr[er],Or=dn[ir.materialIndex];if(Or&&Or.visible){const jr=Ve($e,0,Or,Vt,bt.near,bt.far,qt);M.renderBufferDirect(bt,null,sn,jr,$e,ir)}}}else if(dn.visible){const wr=Ve($e,0,dn,Vt,bt.near,bt.far,qt);M.renderBufferDirect(bt,null,sn,wr,$e,null)}}const mn=$e.children;for(let sn=0,dn=mn.length;sn<dn;sn++)Ye(mn[sn],_t,bt,Vt,qt)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function($e,_t,bt){if(ke.enabled===!1||ke.autoUpdate===!1&&ke.needsUpdate===!1||$e.length===0)return;const Vt=M.getRenderTarget(),qt=M.getActiveCubeFace(),mn=M.getActiveMipmapLevel(),sn=M.state;sn.setBlending(0),sn.buffers.color.setClear(1,1,1,1),sn.buffers.depth.setTest(!0),sn.setScissorTest(!1);for(let dn=0,wr=$e.length;dn<wr;dn++){const er=$e[dn],Pn=er.shadow;if(Pn===void 0){console.warn("THREE.WebGLShadowMap:",er,"has no shadow.");continue}if(Pn.autoUpdate===!1&&Pn.needsUpdate===!1)continue;_.copy(Pn.mapSize);const ir=Pn.getFrameExtents();if(_.multiply(ir),S.copy(Pn.mapSize),(_.x>G||_.y>G)&&(_.x>G&&(S.x=Math.floor(G/ir.x),_.x=S.x*ir.x,Pn.mapSize.x=S.x),_.y>G&&(S.y=Math.floor(G/ir.y),_.y=S.y*ir.y,Pn.mapSize.y=S.y)),Pn.map===null&&!Pn.isPointLightShadow&&this.type===3){const jr={minFilter:1006,magFilter:1006,format:1023};Pn.map=new nt(_.x,_.y,jr),Pn.map.texture.name=er.name+".shadowMap",Pn.mapPass=new nt(_.x,_.y,jr),Pn.camera.updateProjectionMatrix()}if(Pn.map===null){const jr={minFilter:1003,magFilter:1003,format:1023};Pn.map=new nt(_.x,_.y,jr),Pn.map.texture.name=er.name+".shadowMap",Pn.camera.updateProjectionMatrix()}M.setRenderTarget(Pn.map),M.clear();const Or=Pn.getViewportCount();for(let jr=0;jr<Or;jr++){const si=Pn.getViewport(jr);I.set(S.x*si.x,S.y*si.y,S.x*si.z,S.y*si.w),sn.viewport(I),Pn.updateMatrices(er,jr),y=Pn.getFrustum(),Ye(_t,bt,Pn.camera,er,this.type)}Pn.isPointLightShadow||this.type!==3||pe(Pn,bt),Pn.needsUpdate=!1}ke.needsUpdate=!1,M.setRenderTarget(Vt,qt,mn)}}function it(M,i,f){const y=f.isWebGL2,_=new function(){let dt=!1;const an=new Fe;let Un=null;const Kn=new Fe(0,0,0,0);return{setMask:function(Hn){Un===Hn||dt||(M.colorMask(Hn,Hn,Hn,Hn),Un=Hn)},setLocked:function(Hn){dt=Hn},setClear:function(Hn,Wr,ci,Jr,Vr){Vr===!0&&(Hn*=Jr,Wr*=Jr,ci*=Jr),an.set(Hn,Wr,ci,Jr),Kn.equals(an)===!1&&(M.clearColor(Hn,Wr,ci,Jr),Kn.copy(an))},reset:function(){dt=!1,Un=null,Kn.set(-1,0,0,0)}}},S=new function(){let dt=!1,an=null,Un=null,Kn=null;return{setTest:function(Hn){Hn?sr(2929):xt(2929)},setMask:function(Hn){an===Hn||dt||(M.depthMask(Hn),an=Hn)},setFunc:function(Hn){if(Un!==Hn){if(Hn)switch(Hn){case 0:M.depthFunc(512);break;case 1:M.depthFunc(519);break;case 2:M.depthFunc(513);break;case 3:M.depthFunc(515);break;case 4:M.depthFunc(514);break;case 5:M.depthFunc(518);break;case 6:M.depthFunc(516);break;case 7:M.depthFunc(517);break;default:M.depthFunc(515)}else M.depthFunc(515);Un=Hn}},setLocked:function(Hn){dt=Hn},setClear:function(Hn){Kn!==Hn&&(M.clearDepth(Hn),Kn=Hn)},reset:function(){dt=!1,an=null,Un=null,Kn=null}}},I=new function(){let dt=!1,an=null,Un=null,Kn=null,Hn=null,Wr=null,ci=null,Jr=null,Vr=null;return{setTest:function(Fi){dt||(Fi?sr(2960):xt(2960))},setMask:function(Fi){an===Fi||dt||(M.stencilMask(Fi),an=Fi)},setFunc:function(Fi,ol,Ks){Un===Fi&&Kn===ol&&Hn===Ks||(M.stencilFunc(Fi,ol,Ks),Un=Fi,Kn=ol,Hn=Ks)},setOp:function(Fi,ol,Ks){Wr===Fi&&ci===ol&&Jr===Ks||(M.stencilOp(Fi,ol,Ks),Wr=Fi,ci=ol,Jr=Ks)},setLocked:function(Fi){dt=Fi},setClear:function(Fi){Vr!==Fi&&(M.clearStencil(Fi),Vr=Fi)},reset:function(){dt=!1,an=null,Un=null,Kn=null,Hn=null,Wr=null,ci=null,Jr=null,Vr=null}}};let R={},D=null,F={},G=null,W=!1,Z=null,K=null,oe=null,de=null,ke=null,pe=null,Ve=null,Ye=!1,$e=null,_t=null,bt=null,Vt=null,qt=null;const mn=M.getParameter(35661);let sn=!1,dn=0;const wr=M.getParameter(7938);wr.indexOf("WebGL")!==-1?(dn=parseFloat(/^WebGL (\d)/.exec(wr)[1]),sn=dn>=1):wr.indexOf("OpenGL ES")!==-1&&(dn=parseFloat(/^OpenGL ES (\d)/.exec(wr)[1]),sn=dn>=2);let er=null,Pn={};const ir=M.getParameter(3088),Or=M.getParameter(2978),jr=new Fe().fromArray(ir),si=new Fe().fromArray(Or);function gi(dt,an,Un){const Kn=new Uint8Array(4),Hn=M.createTexture();M.bindTexture(dt,Hn),M.texParameteri(dt,10241,9728),M.texParameteri(dt,10240,9728);for(let Wr=0;Wr<Un;Wr++)M.texImage2D(an+Wr,0,6408,1,1,0,6408,5121,Kn);return Hn}const yi={};function sr(dt){R[dt]!==!0&&(M.enable(dt),R[dt]=!0)}function xt(dt){R[dt]!==!1&&(M.disable(dt),R[dt]=!1)}yi[3553]=gi(3553,3553,1),yi[34067]=gi(34067,34069,6),_.setClear(0,0,0,1),S.setClear(1),I.setClear(0),sr(2929),S.setFunc(3),rn(!1),yr(1),sr(2884),ln(0);const Pt={100:32774,101:32778,102:32779};if(y)Pt[103]=32775,Pt[104]=32776;else{const dt=i.get("EXT_blend_minmax");dt!==null&&(Pt[103]=dt.MIN_EXT,Pt[104]=dt.MAX_EXT)}const Fn={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function ln(dt,an,Un,Kn,Hn,Wr,ci,Jr){if(dt!==0){if(W===!1&&(sr(3042),W=!0),dt===5)Hn=Hn||an,Wr=Wr||Un,ci=ci||Kn,an===K&&Hn===ke||(M.blendEquationSeparate(Pt[an],Pt[Hn]),K=an,ke=Hn),Un===oe&&Kn===de&&Wr===pe&&ci===Ve||(M.blendFuncSeparate(Fn[Un],Fn[Kn],Fn[Wr],Fn[ci]),oe=Un,de=Kn,pe=Wr,Ve=ci),Z=dt,Ye=null;else if(dt!==Z||Jr!==Ye){if(K===100&&ke===100||(M.blendEquation(32774),K=100,ke=100),Jr)switch(dt){case 1:M.blendFuncSeparate(1,771,1,771);break;case 2:M.blendFunc(1,1);break;case 3:M.blendFuncSeparate(0,0,769,771);break;case 4:M.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",dt)}else switch(dt){case 1:M.blendFuncSeparate(770,771,1,771);break;case 2:M.blendFunc(770,1);break;case 3:M.blendFunc(0,769);break;case 4:M.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",dt)}oe=null,de=null,pe=null,Ve=null,Z=dt,Ye=Jr}}else W===!0&&(xt(3042),W=!1)}function rn(dt){$e!==dt&&(dt?M.frontFace(2304):M.frontFace(2305),$e=dt)}function yr(dt){dt!==0?(sr(2884),dt!==_t&&(dt===1?M.cullFace(1029):dt===2?M.cullFace(1028):M.cullFace(1032))):xt(2884),_t=dt}function dr(dt,an,Un){dt?(sr(32823),Vt===an&&qt===Un||(M.polygonOffset(an,Un),Vt=an,qt=Un)):xt(32823)}function hn(dt){dt===void 0&&(dt=33984+mn-1),er!==dt&&(M.activeTexture(dt),er=dt)}return{buffers:{color:_,depth:S,stencil:I},enable:sr,disable:xt,bindFramebuffer:function(dt,an){return an===null&&D!==null&&(an=D),F[dt]!==an&&(M.bindFramebuffer(dt,an),F[dt]=an,y&&(dt===36009&&(F[36160]=an),dt===36160&&(F[36009]=an)),!0)},bindXRFramebuffer:function(dt){dt!==D&&(M.bindFramebuffer(36160,dt),D=dt)},useProgram:function(dt){return G!==dt&&(M.useProgram(dt),G=dt,!0)},setBlending:ln,setMaterial:function(dt,an){dt.side===2?xt(2884):sr(2884);let Un=dt.side===1;an&&(Un=!Un),rn(Un),dt.blending===1&&dt.transparent===!1?ln(0):ln(dt.blending,dt.blendEquation,dt.blendSrc,dt.blendDst,dt.blendEquationAlpha,dt.blendSrcAlpha,dt.blendDstAlpha,dt.premultipliedAlpha),S.setFunc(dt.depthFunc),S.setTest(dt.depthTest),S.setMask(dt.depthWrite),_.setMask(dt.colorWrite);const Kn=dt.stencilWrite;I.setTest(Kn),Kn&&(I.setMask(dt.stencilWriteMask),I.setFunc(dt.stencilFunc,dt.stencilRef,dt.stencilFuncMask),I.setOp(dt.stencilFail,dt.stencilZFail,dt.stencilZPass)),dr(dt.polygonOffset,dt.polygonOffsetFactor,dt.polygonOffsetUnits),dt.alphaToCoverage===!0?sr(32926):xt(32926)},setFlipSided:rn,setCullFace:yr,setLineWidth:function(dt){dt!==bt&&(sn&&M.lineWidth(dt),bt=dt)},setPolygonOffset:dr,setScissorTest:function(dt){dt?sr(3089):xt(3089)},activeTexture:hn,bindTexture:function(dt,an){er===null&&hn();let Un=Pn[er];Un===void 0&&(Un={type:void 0,texture:void 0},Pn[er]=Un),Un.type===dt&&Un.texture===an||(M.bindTexture(dt,an||yi[dt]),Un.type=dt,Un.texture=an)},unbindTexture:function(){const dt=Pn[er];dt!==void 0&&dt.type!==void 0&&(M.bindTexture(dt.type,null),dt.type=void 0,dt.texture=void 0)},compressedTexImage2D:function(){try{M.compressedTexImage2D.apply(M,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},texImage2D:function(){try{M.texImage2D.apply(M,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},texImage3D:function(){try{M.texImage3D.apply(M,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},scissor:function(dt){jr.equals(dt)===!1&&(M.scissor(dt.x,dt.y,dt.z,dt.w),jr.copy(dt))},viewport:function(dt){si.equals(dt)===!1&&(M.viewport(dt.x,dt.y,dt.z,dt.w),si.copy(dt))},reset:function(){M.disable(3042),M.disable(2884),M.disable(2929),M.disable(32823),M.disable(3089),M.disable(2960),M.disable(32926),M.blendEquation(32774),M.blendFunc(1,0),M.blendFuncSeparate(1,0,1,0),M.colorMask(!0,!0,!0,!0),M.clearColor(0,0,0,0),M.depthMask(!0),M.depthFunc(513),M.clearDepth(1),M.stencilMask(4294967295),M.stencilFunc(519,0,4294967295),M.stencilOp(7680,7680,7680),M.clearStencil(0),M.cullFace(1029),M.frontFace(2305),M.polygonOffset(0,0),M.activeTexture(33984),M.bindFramebuffer(36160,null),y===!0&&(M.bindFramebuffer(36009,null),M.bindFramebuffer(36008,null)),M.useProgram(null),M.lineWidth(1),M.scissor(0,0,M.canvas.width,M.canvas.height),M.viewport(0,0,M.canvas.width,M.canvas.height),R={},er=null,Pn={},D=null,F={},G=null,W=!1,Z=null,K=null,oe=null,de=null,ke=null,pe=null,Ve=null,Ye=!1,$e=null,_t=null,bt=null,Vt=null,qt=null,jr.set(0,0,M.canvas.width,M.canvas.height),si.set(0,0,M.canvas.width,M.canvas.height),_.reset(),S.reset(),I.reset()}}}function lt(M,i,f,y,_,S,I){const R=_.isWebGL2,D=_.maxTextures,F=_.maxCubemapSize,G=_.maxTextureSize,W=_.maxSamples,Z=new WeakMap;let K,oe=!1;try{oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function de(xt,Pt){return oe?new OffscreenCanvas(xt,Pt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function ke(xt,Pt,Fn,ln){let rn=1;if((xt.width>ln||xt.height>ln)&&(rn=ln/Math.max(xt.width,xt.height)),rn<1||Pt===!0){if(typeof HTMLImageElement<"u"&&xt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&xt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&xt instanceof ImageBitmap){const yr=Pt?Xs:Math.floor,dr=yr(rn*xt.width),hn=yr(rn*xt.height);K===void 0&&(K=de(dr,hn));const dt=Fn?de(dr,hn):K;return dt.width=dr,dt.height=hn,dt.getContext("2d").drawImage(xt,0,0,dr,hn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+xt.width+"x"+xt.height+") to ("+dr+"x"+hn+")."),dt}return"data"in xt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+xt.width+"x"+xt.height+")."),xt}return xt}function pe(xt){return is(xt.width)&&is(xt.height)}function Ve(xt,Pt){return xt.generateMipmaps&&Pt&&xt.minFilter!==1003&&xt.minFilter!==1006}function Ye(xt,Pt,Fn,ln,rn=1){M.generateMipmap(xt),y.get(Pt).__maxMipLevel=Math.log2(Math.max(Fn,ln,rn))}function $e(xt,Pt,Fn){if(R===!1)return Pt;if(xt!==null){if(M[xt]!==void 0)return M[xt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+xt+"'")}let ln=Pt;return Pt===6403&&(Fn===5126&&(ln=33326),Fn===5131&&(ln=33325),Fn===5121&&(ln=33321)),Pt===6407&&(Fn===5126&&(ln=34837),Fn===5131&&(ln=34843),Fn===5121&&(ln=32849)),Pt===6408&&(Fn===5126&&(ln=34836),Fn===5131&&(ln=34842),Fn===5121&&(ln=32856)),ln!==33325&&ln!==33326&&ln!==34842&&ln!==34836||i.get("EXT_color_buffer_float"),ln}function _t(xt){return xt===1003||xt===1004||xt===1005?9728:9729}function bt(xt){const Pt=xt.target;Pt.removeEventListener("dispose",bt),function(Fn){const ln=y.get(Fn);ln.__webglInit!==void 0&&(M.deleteTexture(ln.__webglTexture),y.remove(Fn))}(Pt),Pt.isVideoTexture&&Z.delete(Pt),I.memory.textures--}function Vt(xt){const Pt=xt.target;Pt.removeEventListener("dispose",Vt),function(Fn){const ln=Fn.texture,rn=y.get(Fn),yr=y.get(ln);if(Fn){if(yr.__webglTexture!==void 0&&(M.deleteTexture(yr.__webglTexture),I.memory.textures--),Fn.depthTexture&&Fn.depthTexture.dispose(),Fn.isWebGLCubeRenderTarget)for(let dr=0;dr<6;dr++)M.deleteFramebuffer(rn.__webglFramebuffer[dr]),rn.__webglDepthbuffer&&M.deleteRenderbuffer(rn.__webglDepthbuffer[dr]);else M.deleteFramebuffer(rn.__webglFramebuffer),rn.__webglDepthbuffer&&M.deleteRenderbuffer(rn.__webglDepthbuffer),rn.__webglMultisampledFramebuffer&&M.deleteFramebuffer(rn.__webglMultisampledFramebuffer),rn.__webglColorRenderbuffer&&M.deleteRenderbuffer(rn.__webglColorRenderbuffer),rn.__webglDepthRenderbuffer&&M.deleteRenderbuffer(rn.__webglDepthRenderbuffer);if(Fn.isWebGLMultipleRenderTargets)for(let dr=0,hn=ln.length;dr<hn;dr++){const dt=y.get(ln[dr]);dt.__webglTexture&&(M.deleteTexture(dt.__webglTexture),I.memory.textures--),y.remove(ln[dr])}y.remove(ln),y.remove(Fn)}}(Pt)}let qt=0;function mn(xt,Pt){const Fn=y.get(xt);if(xt.isVideoTexture&&function(ln){const rn=I.render.frame;Z.get(ln)!==rn&&(Z.set(ln,rn),ln.update())}(xt),xt.version>0&&Fn.__version!==xt.version){const ln=xt.image;if(ln===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(ln.complete!==!1)return void ir(Fn,xt,Pt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}f.activeTexture(33984+Pt),f.bindTexture(3553,Fn.__webglTexture)}function sn(xt,Pt){const Fn=y.get(xt);xt.version>0&&Fn.__version!==xt.version?function(ln,rn,yr){if(rn.image.length!==6)return;Pn(ln,rn),f.activeTexture(33984+yr),f.bindTexture(34067,ln.__webglTexture),M.pixelStorei(37440,rn.flipY),M.pixelStorei(37441,rn.premultiplyAlpha),M.pixelStorei(3317,rn.unpackAlignment),M.pixelStorei(37443,0);const dr=rn&&(rn.isCompressedTexture||rn.image[0].isCompressedTexture),hn=rn.image[0]&&rn.image[0].isDataTexture,dt=[];for(let Jr=0;Jr<6;Jr++)dt[Jr]=dr||hn?hn?rn.image[Jr].image:rn.image[Jr]:ke(rn.image[Jr],!1,!0,F);const an=dt[0],Un=pe(an)||R,Kn=S.convert(rn.format),Hn=S.convert(rn.type),Wr=$e(rn.internalFormat,Kn,Hn);let ci;if(er(34067,rn,Un),dr){for(let Jr=0;Jr<6;Jr++){ci=dt[Jr].mipmaps;for(let Vr=0;Vr<ci.length;Vr++){const Fi=ci[Vr];rn.format!==1023&&rn.format!==1022?Kn!==null?f.compressedTexImage2D(34069+Jr,Vr,Wr,Fi.width,Fi.height,0,Fi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):f.texImage2D(34069+Jr,Vr,Wr,Fi.width,Fi.height,0,Kn,Hn,Fi.data)}}ln.__maxMipLevel=ci.length-1}else{ci=rn.mipmaps;for(let Jr=0;Jr<6;Jr++)if(hn){f.texImage2D(34069+Jr,0,Wr,dt[Jr].width,dt[Jr].height,0,Kn,Hn,dt[Jr].data);for(let Vr=0;Vr<ci.length;Vr++){const Fi=ci[Vr].image[Jr].image;f.texImage2D(34069+Jr,Vr+1,Wr,Fi.width,Fi.height,0,Kn,Hn,Fi.data)}}else{f.texImage2D(34069+Jr,0,Wr,Kn,Hn,dt[Jr]);for(let Vr=0;Vr<ci.length;Vr++){const Fi=ci[Vr];f.texImage2D(34069+Jr,Vr+1,Wr,Kn,Hn,Fi.image[Jr])}}ln.__maxMipLevel=ci.length}Ve(rn,Un)&&Ye(34067,rn,an.width,an.height),ln.__version=rn.version,rn.onUpdate&&rn.onUpdate(rn)}(Fn,xt,Pt):(f.activeTexture(33984+Pt),f.bindTexture(34067,Fn.__webglTexture))}const dn={1e3:10497,1001:33071,1002:33648},wr={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function er(xt,Pt,Fn){if(Fn?(M.texParameteri(xt,10242,dn[Pt.wrapS]),M.texParameteri(xt,10243,dn[Pt.wrapT]),xt!==32879&&xt!==35866||M.texParameteri(xt,32882,dn[Pt.wrapR]),M.texParameteri(xt,10240,wr[Pt.magFilter]),M.texParameteri(xt,10241,wr[Pt.minFilter])):(M.texParameteri(xt,10242,33071),M.texParameteri(xt,10243,33071),xt!==32879&&xt!==35866||M.texParameteri(xt,32882,33071),Pt.wrapS===1001&&Pt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),M.texParameteri(xt,10240,_t(Pt.magFilter)),M.texParameteri(xt,10241,_t(Pt.minFilter)),Pt.minFilter!==1003&&Pt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),i.has("EXT_texture_filter_anisotropic")===!0){const ln=i.get("EXT_texture_filter_anisotropic");if(Pt.type===1015&&i.has("OES_texture_float_linear")===!1||R===!1&&Pt.type===1016&&i.has("OES_texture_half_float_linear")===!1)return;(Pt.anisotropy>1||y.get(Pt).__currentAnisotropy)&&(M.texParameterf(xt,ln.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Pt.anisotropy,_.getMaxAnisotropy())),y.get(Pt).__currentAnisotropy=Pt.anisotropy)}}function Pn(xt,Pt){xt.__webglInit===void 0&&(xt.__webglInit=!0,Pt.addEventListener("dispose",bt),xt.__webglTexture=M.createTexture(),I.memory.textures++)}function ir(xt,Pt,Fn){let ln=3553;Pt.isDataTexture2DArray&&(ln=35866),Pt.isDataTexture3D&&(ln=32879),Pn(xt,Pt),f.activeTexture(33984+Fn),f.bindTexture(ln,xt.__webglTexture),M.pixelStorei(37440,Pt.flipY),M.pixelStorei(37441,Pt.premultiplyAlpha),M.pixelStorei(3317,Pt.unpackAlignment),M.pixelStorei(37443,0);const rn=function(Hn){return!R&&(Hn.wrapS!==1001||Hn.wrapT!==1001||Hn.minFilter!==1003&&Hn.minFilter!==1006)}(Pt)&&pe(Pt.image)===!1,yr=ke(Pt.image,rn,!1,G),dr=pe(yr)||R,hn=S.convert(Pt.format);let dt,an=S.convert(Pt.type),Un=$e(Pt.internalFormat,hn,an);er(ln,Pt,dr);const Kn=Pt.mipmaps;if(Pt.isDepthTexture)Un=6402,R?Un=Pt.type===1015?36012:Pt.type===1014?33190:Pt.type===1020?35056:33189:Pt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Pt.format===1026&&Un===6402&&Pt.type!==1012&&Pt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Pt.type=1012,an=S.convert(Pt.type)),Pt.format===1027&&Un===6402&&(Un=34041,Pt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Pt.type=1020,an=S.convert(Pt.type))),f.texImage2D(3553,0,Un,yr.width,yr.height,0,hn,an,null);else if(Pt.isDataTexture)if(Kn.length>0&&dr){for(let Hn=0,Wr=Kn.length;Hn<Wr;Hn++)dt=Kn[Hn],f.texImage2D(3553,Hn,Un,dt.width,dt.height,0,hn,an,dt.data);Pt.generateMipmaps=!1,xt.__maxMipLevel=Kn.length-1}else f.texImage2D(3553,0,Un,yr.width,yr.height,0,hn,an,yr.data),xt.__maxMipLevel=0;else if(Pt.isCompressedTexture){for(let Hn=0,Wr=Kn.length;Hn<Wr;Hn++)dt=Kn[Hn],Pt.format!==1023&&Pt.format!==1022?hn!==null?f.compressedTexImage2D(3553,Hn,Un,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):f.texImage2D(3553,Hn,Un,dt.width,dt.height,0,hn,an,dt.data);xt.__maxMipLevel=Kn.length-1}else if(Pt.isDataTexture2DArray)f.texImage3D(35866,0,Un,yr.width,yr.height,yr.depth,0,hn,an,yr.data),xt.__maxMipLevel=0;else if(Pt.isDataTexture3D)f.texImage3D(32879,0,Un,yr.width,yr.height,yr.depth,0,hn,an,yr.data),xt.__maxMipLevel=0;else if(Kn.length>0&&dr){for(let Hn=0,Wr=Kn.length;Hn<Wr;Hn++)dt=Kn[Hn],f.texImage2D(3553,Hn,Un,hn,an,dt);Pt.generateMipmaps=!1,xt.__maxMipLevel=Kn.length-1}else f.texImage2D(3553,0,Un,hn,an,yr),xt.__maxMipLevel=0;Ve(Pt,dr)&&Ye(ln,Pt,yr.width,yr.height),xt.__version=Pt.version,Pt.onUpdate&&Pt.onUpdate(Pt)}function Or(xt,Pt,Fn,ln,rn){const yr=S.convert(Fn.format),dr=S.convert(Fn.type),hn=$e(Fn.internalFormat,yr,dr);rn===32879||rn===35866?f.texImage3D(rn,0,hn,Pt.width,Pt.height,Pt.depth,0,yr,dr,null):f.texImage2D(rn,0,hn,Pt.width,Pt.height,0,yr,dr,null),f.bindFramebuffer(36160,xt),M.framebufferTexture2D(36160,ln,rn,y.get(Fn).__webglTexture,0),f.bindFramebuffer(36160,null)}function jr(xt,Pt,Fn){if(M.bindRenderbuffer(36161,xt),Pt.depthBuffer&&!Pt.stencilBuffer){let ln=33189;if(Fn){const rn=Pt.depthTexture;rn&&rn.isDepthTexture&&(rn.type===1015?ln=36012:rn.type===1014&&(ln=33190));const yr=gi(Pt);M.renderbufferStorageMultisample(36161,yr,ln,Pt.width,Pt.height)}else M.renderbufferStorage(36161,ln,Pt.width,Pt.height);M.framebufferRenderbuffer(36160,36096,36161,xt)}else if(Pt.depthBuffer&&Pt.stencilBuffer){if(Fn){const ln=gi(Pt);M.renderbufferStorageMultisample(36161,ln,35056,Pt.width,Pt.height)}else M.renderbufferStorage(36161,34041,Pt.width,Pt.height);M.framebufferRenderbuffer(36160,33306,36161,xt)}else{const ln=Pt.isWebGLMultipleRenderTargets===!0?Pt.texture[0]:Pt.texture,rn=S.convert(ln.format),yr=S.convert(ln.type),dr=$e(ln.internalFormat,rn,yr);if(Fn){const hn=gi(Pt);M.renderbufferStorageMultisample(36161,hn,dr,Pt.width,Pt.height)}else M.renderbufferStorage(36161,dr,Pt.width,Pt.height)}M.bindRenderbuffer(36161,null)}function si(xt){const Pt=y.get(xt),Fn=xt.isWebGLCubeRenderTarget===!0;if(xt.depthTexture){if(Fn)throw new Error("target.depthTexture not supported in Cube render targets");(function(ln,rn){if(rn&&rn.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(f.bindFramebuffer(36160,ln),!rn.depthTexture||!rn.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");y.get(rn.depthTexture).__webglTexture&&rn.depthTexture.image.width===rn.width&&rn.depthTexture.image.height===rn.height||(rn.depthTexture.image.width=rn.width,rn.depthTexture.image.height=rn.height,rn.depthTexture.needsUpdate=!0),mn(rn.depthTexture,0);const yr=y.get(rn.depthTexture).__webglTexture;if(rn.depthTexture.format===1026)M.framebufferTexture2D(36160,36096,3553,yr,0);else{if(rn.depthTexture.format!==1027)throw new Error("Unknown depthTexture format");M.framebufferTexture2D(36160,33306,3553,yr,0)}})(Pt.__webglFramebuffer,xt)}else if(Fn){Pt.__webglDepthbuffer=[];for(let ln=0;ln<6;ln++)f.bindFramebuffer(36160,Pt.__webglFramebuffer[ln]),Pt.__webglDepthbuffer[ln]=M.createRenderbuffer(),jr(Pt.__webglDepthbuffer[ln],xt,!1)}else f.bindFramebuffer(36160,Pt.__webglFramebuffer),Pt.__webglDepthbuffer=M.createRenderbuffer(),jr(Pt.__webglDepthbuffer,xt,!1);f.bindFramebuffer(36160,null)}function gi(xt){return R&&xt.isWebGLMultisampleRenderTarget?Math.min(W,xt.samples):0}let yi=!1,sr=!1;this.allocateTextureUnit=function(){const xt=qt;return xt>=D&&console.warn("THREE.WebGLTextures: Trying to use "+xt+" texture units while this GPU supports only "+D),qt+=1,xt},this.resetTextureUnits=function(){qt=0},this.setTexture2D=mn,this.setTexture2DArray=function(xt,Pt){const Fn=y.get(xt);xt.version>0&&Fn.__version!==xt.version?ir(Fn,xt,Pt):(f.activeTexture(33984+Pt),f.bindTexture(35866,Fn.__webglTexture))},this.setTexture3D=function(xt,Pt){const Fn=y.get(xt);xt.version>0&&Fn.__version!==xt.version?ir(Fn,xt,Pt):(f.activeTexture(33984+Pt),f.bindTexture(32879,Fn.__webglTexture))},this.setTextureCube=sn,this.setupRenderTarget=function(xt){const Pt=xt.texture,Fn=y.get(xt),ln=y.get(Pt);xt.addEventListener("dispose",Vt),xt.isWebGLMultipleRenderTargets!==!0&&(ln.__webglTexture=M.createTexture(),ln.__version=Pt.version,I.memory.textures++);const rn=xt.isWebGLCubeRenderTarget===!0,yr=xt.isWebGLMultipleRenderTargets===!0,dr=xt.isWebGLMultisampleRenderTarget===!0,hn=Pt.isDataTexture3D||Pt.isDataTexture2DArray,dt=pe(xt)||R;if(!R||Pt.format!==1022||Pt.type!==1015&&Pt.type!==1016||(Pt.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),rn){Fn.__webglFramebuffer=[];for(let an=0;an<6;an++)Fn.__webglFramebuffer[an]=M.createFramebuffer()}else if(Fn.__webglFramebuffer=M.createFramebuffer(),yr)if(_.drawBuffers){const an=xt.texture;for(let Un=0,Kn=an.length;Un<Kn;Un++){const Hn=y.get(an[Un]);Hn.__webglTexture===void 0&&(Hn.__webglTexture=M.createTexture(),I.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(dr)if(R){Fn.__webglMultisampledFramebuffer=M.createFramebuffer(),Fn.__webglColorRenderbuffer=M.createRenderbuffer(),M.bindRenderbuffer(36161,Fn.__webglColorRenderbuffer);const an=S.convert(Pt.format),Un=S.convert(Pt.type),Kn=$e(Pt.internalFormat,an,Un),Hn=gi(xt);M.renderbufferStorageMultisample(36161,Hn,Kn,xt.width,xt.height),f.bindFramebuffer(36160,Fn.__webglMultisampledFramebuffer),M.framebufferRenderbuffer(36160,36064,36161,Fn.__webglColorRenderbuffer),M.bindRenderbuffer(36161,null),xt.depthBuffer&&(Fn.__webglDepthRenderbuffer=M.createRenderbuffer(),jr(Fn.__webglDepthRenderbuffer,xt,!0)),f.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(rn){f.bindTexture(34067,ln.__webglTexture),er(34067,Pt,dt);for(let an=0;an<6;an++)Or(Fn.__webglFramebuffer[an],xt,Pt,36064,34069+an);Ve(Pt,dt)&&Ye(34067,Pt,xt.width,xt.height),f.unbindTexture()}else if(yr){const an=xt.texture;for(let Un=0,Kn=an.length;Un<Kn;Un++){const Hn=an[Un],Wr=y.get(Hn);f.bindTexture(3553,Wr.__webglTexture),er(3553,Hn,dt),Or(Fn.__webglFramebuffer,xt,Hn,36064+Un,3553),Ve(Hn,dt)&&Ye(3553,Hn,xt.width,xt.height)}f.unbindTexture()}else{let an=3553;hn&&(R?an=Pt.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),f.bindTexture(an,ln.__webglTexture),er(an,Pt,dt),Or(Fn.__webglFramebuffer,xt,Pt,36064,an),Ve(Pt,dt)&&Ye(an,Pt,xt.width,xt.height,xt.depth),f.unbindTexture()}xt.depthBuffer&&si(xt)},this.updateRenderTargetMipmap=function(xt){const Pt=pe(xt)||R,Fn=xt.isWebGLMultipleRenderTargets===!0?xt.texture:[xt.texture];for(let ln=0,rn=Fn.length;ln<rn;ln++){const yr=Fn[ln];if(Ve(yr,Pt)){const dr=xt.isWebGLCubeRenderTarget?34067:3553,hn=y.get(yr).__webglTexture;f.bindTexture(dr,hn),Ye(dr,yr,xt.width,xt.height),f.unbindTexture()}}},this.updateMultisampleRenderTarget=function(xt){if(xt.isWebGLMultisampleRenderTarget)if(R){const Pt=xt.width,Fn=xt.height;let ln=16384;xt.depthBuffer&&(ln|=256),xt.stencilBuffer&&(ln|=1024);const rn=y.get(xt);f.bindFramebuffer(36008,rn.__webglMultisampledFramebuffer),f.bindFramebuffer(36009,rn.__webglFramebuffer),M.blitFramebuffer(0,0,Pt,Fn,0,0,Pt,Fn,ln,9728),f.bindFramebuffer(36008,null),f.bindFramebuffer(36009,rn.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(xt,Pt){xt&&xt.isWebGLRenderTarget&&(yi===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),yi=!0),xt=xt.texture),mn(xt,Pt)},this.safeSetTextureCube=function(xt,Pt){xt&&xt.isWebGLCubeRenderTarget&&(sr===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),sr=!0),xt=xt.texture),sn(xt,Pt)}}function Ct(M,i,f){const y=f.isWebGL2;return{convert:function(_){let S;if(_===1009)return 5121;if(_===1017)return 32819;if(_===1018)return 32820;if(_===1019)return 33635;if(_===1010)return 5120;if(_===1011)return 5122;if(_===1012)return 5123;if(_===1013)return 5124;if(_===1014)return 5125;if(_===1015)return 5126;if(_===1016)return y?5131:(S=i.get("OES_texture_half_float"),S!==null?S.HALF_FLOAT_OES:null);if(_===1021)return 6406;if(_===1022)return 6407;if(_===1023)return 6408;if(_===1024)return 6409;if(_===1025)return 6410;if(_===1026)return 6402;if(_===1027)return 34041;if(_===1028)return 6403;if(_===1029)return 36244;if(_===1030)return 33319;if(_===1031)return 33320;if(_===1032)return 36248;if(_===1033)return 36249;if(_===33776||_===33777||_===33778||_===33779){if(S=i.get("WEBGL_compressed_texture_s3tc"),S===null)return null;if(_===33776)return S.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===33777)return S.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===33778)return S.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===33779)return S.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(_===35840||_===35841||_===35842||_===35843){if(S=i.get("WEBGL_compressed_texture_pvrtc"),S===null)return null;if(_===35840)return S.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===35841)return S.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===35842)return S.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===35843)return S.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(_===36196)return S=i.get("WEBGL_compressed_texture_etc1"),S!==null?S.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===37492||_===37496)&&(S=i.get("WEBGL_compressed_texture_etc"),S!==null)){if(_===37492)return S.COMPRESSED_RGB8_ETC2;if(_===37496)return S.COMPRESSED_RGBA8_ETC2_EAC}return _===37808||_===37809||_===37810||_===37811||_===37812||_===37813||_===37814||_===37815||_===37816||_===37817||_===37818||_===37819||_===37820||_===37821||_===37840||_===37841||_===37842||_===37843||_===37844||_===37845||_===37846||_===37847||_===37848||_===37849||_===37850||_===37851||_===37852||_===37853?(S=i.get("WEBGL_compressed_texture_astc"),S!==null?_:null):_===36492?(S=i.get("EXT_texture_compression_bptc"),S!==null?_:null):_===1020?y?34042:(S=i.get("WEBGL_depth_texture"),S!==null?S.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class It extends ga{constructor(i=[]){super(),this.cameras=i}}It.prototype.isArrayCamera=!0;class Mt extends Me{constructor(){super(),this.type="Group"}}Mt.prototype.isGroup=!0;const jt={type:"move"};class Bt{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Mt,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Mt,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new me,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new me),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Mt,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new me,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new me),this._grip}dispatchEvent(i){return this._targetRay!==null&&this._targetRay.dispatchEvent(i),this._grip!==null&&this._grip.dispatchEvent(i),this._hand!==null&&this._hand.dispatchEvent(i),this}disconnect(i){return this.dispatchEvent({type:"disconnected",data:i}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(i,f,y){let _=null,S=null,I=null;const R=this._targetRay,D=this._grip,F=this._hand;if(i&&f.session.visibilityState!=="visible-blurred")if(R!==null&&(_=f.getPose(i.targetRaySpace,y),_!==null&&(R.matrix.fromArray(_.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),_.linearVelocity?(R.hasLinearVelocity=!0,R.linearVelocity.copy(_.linearVelocity)):R.hasLinearVelocity=!1,_.angularVelocity?(R.hasAngularVelocity=!0,R.angularVelocity.copy(_.angularVelocity)):R.hasAngularVelocity=!1,this.dispatchEvent(jt))),F&&i.hand){I=!0;for(const de of i.hand.values()){const ke=f.getJointPose(de,y);if(F.joints[de.jointName]===void 0){const Ve=new Mt;Ve.matrixAutoUpdate=!1,Ve.visible=!1,F.joints[de.jointName]=Ve,F.add(Ve)}const pe=F.joints[de.jointName];ke!==null&&(pe.matrix.fromArray(ke.transform.matrix),pe.matrix.decompose(pe.position,pe.rotation,pe.scale),pe.jointRadius=ke.radius),pe.visible=ke!==null}const G=F.joints["index-finger-tip"],W=F.joints["thumb-tip"],Z=G.position.distanceTo(W.position),K=.02,oe=.005;F.inputState.pinching&&Z>K+oe?(F.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:i.handedness,target:this})):!F.inputState.pinching&&Z<=K-oe&&(F.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:i.handedness,target:this}))}else D!==null&&i.gripSpace&&(S=f.getPose(i.gripSpace,y),S!==null&&(D.matrix.fromArray(S.transform.matrix),D.matrix.decompose(D.position,D.rotation,D.scale),S.linearVelocity?(D.hasLinearVelocity=!0,D.linearVelocity.copy(S.linearVelocity)):D.hasLinearVelocity=!1,S.angularVelocity?(D.hasAngularVelocity=!0,D.angularVelocity.copy(S.angularVelocity)):D.hasAngularVelocity=!1));return R!==null&&(R.visible=_!==null),D!==null&&(D.visible=S!==null),F!==null&&(F.visible=I!==null),this}}class Yt extends en{constructor(i,f){super();const y=this,_=i.state;let S=null,I=1,R=null,D="local-floor",F=null,G=null,W=null,Z=null,K=null,oe=!1,de=null,ke=null,pe=null,Ve=null,Ye=null,$e=null;const _t=[],bt=new Map,Vt=new ga;Vt.layers.enable(1),Vt.viewport=new Fe;const qt=new ga;qt.layers.enable(2),qt.viewport=new Fe;const mn=[Vt,qt],sn=new It;sn.layers.enable(1),sn.layers.enable(2);let dn=null,wr=null;function er(sr){const xt=bt.get(sr.inputSource);xt&&xt.dispatchEvent({type:sr.type,data:sr.inputSource})}function Pn(){bt.forEach(function(sr,xt){sr.disconnect(xt)}),bt.clear(),dn=null,wr=null,_.bindXRFramebuffer(null),i.setRenderTarget(i.getRenderTarget()),W&&f.deleteFramebuffer(W),de&&f.deleteFramebuffer(de),ke&&f.deleteRenderbuffer(ke),pe&&f.deleteRenderbuffer(pe),W=null,de=null,ke=null,pe=null,K=null,Z=null,G=null,S=null,yi.stop(),y.isPresenting=!1,y.dispatchEvent({type:"sessionend"})}function ir(sr){const xt=S.inputSources;for(let Pt=0;Pt<_t.length;Pt++)bt.set(xt[Pt],_t[Pt]);for(let Pt=0;Pt<sr.removed.length;Pt++){const Fn=sr.removed[Pt],ln=bt.get(Fn);ln&&(ln.dispatchEvent({type:"disconnected",data:Fn}),bt.delete(Fn))}for(let Pt=0;Pt<sr.added.length;Pt++){const Fn=sr.added[Pt],ln=bt.get(Fn);ln&&ln.dispatchEvent({type:"connected",data:Fn})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(sr){let xt=_t[sr];return xt===void 0&&(xt=new Bt,_t[sr]=xt),xt.getTargetRaySpace()},this.getControllerGrip=function(sr){let xt=_t[sr];return xt===void 0&&(xt=new Bt,_t[sr]=xt),xt.getGripSpace()},this.getHand=function(sr){let xt=_t[sr];return xt===void 0&&(xt=new Bt,_t[sr]=xt),xt.getHandSpace()},this.setFramebufferScaleFactor=function(sr){I=sr,y.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(sr){D=sr,y.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return R},this.getBaseLayer=function(){return Z!==null?Z:K},this.getBinding=function(){return G},this.getFrame=function(){return Ve},this.getSession=function(){return S},this.setSession=async function(sr){if(S=sr,S!==null){S.addEventListener("select",er),S.addEventListener("selectstart",er),S.addEventListener("selectend",er),S.addEventListener("squeeze",er),S.addEventListener("squeezestart",er),S.addEventListener("squeezeend",er),S.addEventListener("end",Pn),S.addEventListener("inputsourceschange",ir);const xt=f.getContextAttributes();if(xt.xrCompatible!==!0&&await f.makeXRCompatible(),S.renderState.layers===void 0){const Pt={antialias:xt.antialias,alpha:xt.alpha,depth:xt.depth,stencil:xt.stencil,framebufferScaleFactor:I};K=new XRWebGLLayer(S,f,Pt),S.updateRenderState({baseLayer:K})}else if(f instanceof WebGLRenderingContext){const Pt={antialias:!0,alpha:xt.alpha,depth:xt.depth,stencil:xt.stencil,framebufferScaleFactor:I};K=new XRWebGLLayer(S,f,Pt),S.updateRenderState({layers:[K]})}else{oe=xt.antialias;let Pt=null;xt.depth&&($e=256,xt.stencil&&($e|=1024),Ye=xt.stencil?33306:36096,Pt=xt.stencil?35056:33190);const Fn={colorFormat:xt.alpha?32856:32849,depthFormat:Pt,scaleFactor:I};G=new XRWebGLBinding(S,f),Z=G.createProjectionLayer(Fn),W=f.createFramebuffer(),S.updateRenderState({layers:[Z]}),oe&&(de=f.createFramebuffer(),ke=f.createRenderbuffer(),f.bindRenderbuffer(36161,ke),f.renderbufferStorageMultisample(36161,4,32856,Z.textureWidth,Z.textureHeight),_.bindFramebuffer(36160,de),f.framebufferRenderbuffer(36160,36064,36161,ke),f.bindRenderbuffer(36161,null),Pt!==null&&(pe=f.createRenderbuffer(),f.bindRenderbuffer(36161,pe),f.renderbufferStorageMultisample(36161,4,Pt,Z.textureWidth,Z.textureHeight),f.framebufferRenderbuffer(36160,Ye,36161,pe),f.bindRenderbuffer(36161,null)),_.bindFramebuffer(36160,null))}R=await S.requestReferenceSpace(D),yi.setContext(S),yi.start(),y.isPresenting=!0,y.dispatchEvent({type:"sessionstart"})}};const Or=new me,jr=new me;function si(sr,xt){xt===null?sr.matrixWorld.copy(sr.matrix):sr.matrixWorld.multiplyMatrices(xt.matrixWorld,sr.matrix),sr.matrixWorldInverse.copy(sr.matrixWorld).invert()}this.updateCamera=function(sr){if(S===null)return;sn.near=qt.near=Vt.near=sr.near,sn.far=qt.far=Vt.far=sr.far,dn===sn.near&&wr===sn.far||(S.updateRenderState({depthNear:sn.near,depthFar:sn.far}),dn=sn.near,wr=sn.far);const xt=sr.parent,Pt=sn.cameras;si(sn,xt);for(let ln=0;ln<Pt.length;ln++)si(Pt[ln],xt);sn.matrixWorld.decompose(sn.position,sn.quaternion,sn.scale),sr.position.copy(sn.position),sr.quaternion.copy(sn.quaternion),sr.scale.copy(sn.scale),sr.matrix.copy(sn.matrix),sr.matrixWorld.copy(sn.matrixWorld);const Fn=sr.children;for(let ln=0,rn=Fn.length;ln<rn;ln++)Fn[ln].updateMatrixWorld(!0);Pt.length===2?function(ln,rn,yr){Or.setFromMatrixPosition(rn.matrixWorld),jr.setFromMatrixPosition(yr.matrixWorld);const dr=Or.distanceTo(jr),hn=rn.projectionMatrix.elements,dt=yr.projectionMatrix.elements,an=hn[14]/(hn[10]-1),Un=hn[14]/(hn[10]+1),Kn=(hn[9]+1)/hn[5],Hn=(hn[9]-1)/hn[5],Wr=(hn[8]-1)/hn[0],ci=(dt[8]+1)/dt[0],Jr=an*Wr,Vr=an*ci,Fi=dr/(-Wr+ci),ol=Fi*-Wr;rn.matrixWorld.decompose(ln.position,ln.quaternion,ln.scale),ln.translateX(ol),ln.translateZ(Fi),ln.matrixWorld.compose(ln.position,ln.quaternion,ln.scale),ln.matrixWorldInverse.copy(ln.matrixWorld).invert();const Ks=an+Fi,Lo=Un+Fi,Tl=Jr-ol,em=Vr+(dr-ol),Sg=Kn*Un/Lo*Ks,Tg=Hn*Un/Lo*Ks;ln.projectionMatrix.makePerspective(Tl,em,Sg,Tg,Ks,Lo)}(sn,Vt,qt):sn.projectionMatrix.copy(Vt.projectionMatrix)},this.getCamera=function(){return sn},this.getFoveation=function(){return Z!==null?Z.fixedFoveation:K!==null?K.fixedFoveation:void 0},this.setFoveation=function(sr){Z!==null&&(Z.fixedFoveation=sr),K!==null&&K.fixedFoveation!==void 0&&(K.fixedFoveation=sr)};let gi=null;const yi=new Zm;yi.setAnimationLoop(function(sr,xt){if(F=xt.getViewerPose(R),Ve=xt,F!==null){const Fn=F.views;K!==null&&_.bindXRFramebuffer(K.framebuffer);let ln=!1;Fn.length!==sn.cameras.length&&(sn.cameras.length=0,ln=!0);for(let rn=0;rn<Fn.length;rn++){const yr=Fn[rn];let dr=null;if(K!==null)dr=K.getViewport(yr);else{const dt=G.getViewSubImage(Z,yr);_.bindXRFramebuffer(W),dt.depthStencilTexture!==void 0&&f.framebufferTexture2D(36160,Ye,3553,dt.depthStencilTexture,0),f.framebufferTexture2D(36160,36064,3553,dt.colorTexture,0),dr=dt.viewport}const hn=mn[rn];hn.matrix.fromArray(yr.transform.matrix),hn.projectionMatrix.fromArray(yr.projectionMatrix),hn.viewport.set(dr.x,dr.y,dr.width,dr.height),rn===0&&sn.matrix.copy(hn.matrix),ln===!0&&sn.cameras.push(hn)}oe&&(_.bindXRFramebuffer(de),$e!==null&&f.clear($e))}const Pt=S.inputSources;for(let Fn=0;Fn<_t.length;Fn++){const ln=_t[Fn],rn=Pt[Fn];ln.update(rn,xt,R)}if(gi&&gi(sr,xt),oe){const Fn=Z.textureWidth,ln=Z.textureHeight;_.bindFramebuffer(36008,de),_.bindFramebuffer(36009,W),f.invalidateFramebuffer(36008,[Ye]),f.invalidateFramebuffer(36009,[Ye]),f.blitFramebuffer(0,0,Fn,ln,0,0,Fn,ln,16384,9728),f.invalidateFramebuffer(36008,[36064]),_.bindFramebuffer(36008,null),_.bindFramebuffer(36009,null),_.bindFramebuffer(36160,de)}Ve=null}),this.setAnimationLoop=function(sr){gi=sr},this.dispose=function(){}}}function Zn(M){function i(y,_){y.opacity.value=_.opacity,_.color&&y.diffuse.value.copy(_.color),_.emissive&&y.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(y.map.value=_.map),_.alphaMap&&(y.alphaMap.value=_.alphaMap),_.specularMap&&(y.specularMap.value=_.specularMap),_.alphaTest>0&&(y.alphaTest.value=_.alphaTest);const S=M.get(_).envMap;if(S){y.envMap.value=S,y.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=_.reflectivity,y.ior.value=_.ior,y.refractionRatio.value=_.refractionRatio;const D=M.get(S).__maxMipLevel;D!==void 0&&(y.maxMipLevel.value=D)}let I,R;_.lightMap&&(y.lightMap.value=_.lightMap,y.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(y.aoMap.value=_.aoMap,y.aoMapIntensity.value=_.aoMapIntensity),_.map?I=_.map:_.specularMap?I=_.specularMap:_.displacementMap?I=_.displacementMap:_.normalMap?I=_.normalMap:_.bumpMap?I=_.bumpMap:_.roughnessMap?I=_.roughnessMap:_.metalnessMap?I=_.metalnessMap:_.alphaMap?I=_.alphaMap:_.emissiveMap?I=_.emissiveMap:_.clearcoatMap?I=_.clearcoatMap:_.clearcoatNormalMap?I=_.clearcoatNormalMap:_.clearcoatRoughnessMap?I=_.clearcoatRoughnessMap:_.specularIntensityMap?I=_.specularIntensityMap:_.specularTintMap?I=_.specularTintMap:_.transmissionMap?I=_.transmissionMap:_.thicknessMap&&(I=_.thicknessMap),I!==void 0&&(I.isWebGLRenderTarget&&(I=I.texture),I.matrixAutoUpdate===!0&&I.updateMatrix(),y.uvTransform.value.copy(I.matrix)),_.aoMap?R=_.aoMap:_.lightMap&&(R=_.lightMap),R!==void 0&&(R.isWebGLRenderTarget&&(R=R.texture),R.matrixAutoUpdate===!0&&R.updateMatrix(),y.uv2Transform.value.copy(R.matrix))}function f(y,_){y.roughness.value=_.roughness,y.metalness.value=_.metalness,_.roughnessMap&&(y.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(y.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(y.emissiveMap.value=_.emissiveMap),_.bumpMap&&(y.bumpMap.value=_.bumpMap,y.bumpScale.value=_.bumpScale,_.side===1&&(y.bumpScale.value*=-1)),_.normalMap&&(y.normalMap.value=_.normalMap,y.normalScale.value.copy(_.normalScale),_.side===1&&y.normalScale.value.negate()),_.displacementMap&&(y.displacementMap.value=_.displacementMap,y.displacementScale.value=_.displacementScale,y.displacementBias.value=_.displacementBias),M.get(_).envMap&&(y.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(y,_){y.fogColor.value.copy(_.color),_.isFog?(y.fogNear.value=_.near,y.fogFar.value=_.far):_.isFogExp2&&(y.fogDensity.value=_.density)},refreshMaterialUniforms:function(y,_,S,I,R){_.isMeshBasicMaterial?i(y,_):_.isMeshLambertMaterial?(i(y,_),function(D,F){F.emissiveMap&&(D.emissiveMap.value=F.emissiveMap)}(y,_)):_.isMeshToonMaterial?(i(y,_),function(D,F){F.gradientMap&&(D.gradientMap.value=F.gradientMap),F.emissiveMap&&(D.emissiveMap.value=F.emissiveMap),F.bumpMap&&(D.bumpMap.value=F.bumpMap,D.bumpScale.value=F.bumpScale,F.side===1&&(D.bumpScale.value*=-1)),F.normalMap&&(D.normalMap.value=F.normalMap,D.normalScale.value.copy(F.normalScale),F.side===1&&D.normalScale.value.negate()),F.displacementMap&&(D.displacementMap.value=F.displacementMap,D.displacementScale.value=F.displacementScale,D.displacementBias.value=F.displacementBias)}(y,_)):_.isMeshPhongMaterial?(i(y,_),function(D,F){D.specular.value.copy(F.specular),D.shininess.value=Math.max(F.shininess,1e-4),F.emissiveMap&&(D.emissiveMap.value=F.emissiveMap),F.bumpMap&&(D.bumpMap.value=F.bumpMap,D.bumpScale.value=F.bumpScale,F.side===1&&(D.bumpScale.value*=-1)),F.normalMap&&(D.normalMap.value=F.normalMap,D.normalScale.value.copy(F.normalScale),F.side===1&&D.normalScale.value.negate()),F.displacementMap&&(D.displacementMap.value=F.displacementMap,D.displacementScale.value=F.displacementScale,D.displacementBias.value=F.displacementBias)}(y,_)):_.isMeshStandardMaterial?(i(y,_),_.isMeshPhysicalMaterial?function(D,F,G){f(D,F),D.ior.value=F.ior,F.sheenTint&&D.sheenTint.value.copy(F.sheenTint),F.clearcoat>0&&(D.clearcoat.value=F.clearcoat,D.clearcoatRoughness.value=F.clearcoatRoughness,F.clearcoatMap&&(D.clearcoatMap.value=F.clearcoatMap),F.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=F.clearcoatRoughnessMap),F.clearcoatNormalMap&&(D.clearcoatNormalScale.value.copy(F.clearcoatNormalScale),D.clearcoatNormalMap.value=F.clearcoatNormalMap,F.side===1&&D.clearcoatNormalScale.value.negate())),F.transmission>0&&(D.transmission.value=F.transmission,D.transmissionSamplerMap.value=G.texture,D.transmissionSamplerSize.value.set(G.width,G.height),F.transmissionMap&&(D.transmissionMap.value=F.transmissionMap),D.thickness.value=F.thickness,F.thicknessMap&&(D.thicknessMap.value=F.thicknessMap),D.attenuationDistance.value=F.attenuationDistance,D.attenuationTint.value.copy(F.attenuationTint)),D.specularIntensity.value=F.specularIntensity,D.specularTint.value.copy(F.specularTint),F.specularIntensityMap&&(D.specularIntensityMap.value=F.specularIntensityMap),F.specularTintMap&&(D.specularTintMap.value=F.specularTintMap)}(y,_,R):f(y,_)):_.isMeshMatcapMaterial?(i(y,_),function(D,F){F.matcap&&(D.matcap.value=F.matcap),F.bumpMap&&(D.bumpMap.value=F.bumpMap,D.bumpScale.value=F.bumpScale,F.side===1&&(D.bumpScale.value*=-1)),F.normalMap&&(D.normalMap.value=F.normalMap,D.normalScale.value.copy(F.normalScale),F.side===1&&D.normalScale.value.negate()),F.displacementMap&&(D.displacementMap.value=F.displacementMap,D.displacementScale.value=F.displacementScale,D.displacementBias.value=F.displacementBias)}(y,_)):_.isMeshDepthMaterial?(i(y,_),function(D,F){F.displacementMap&&(D.displacementMap.value=F.displacementMap,D.displacementScale.value=F.displacementScale,D.displacementBias.value=F.displacementBias)}(y,_)):_.isMeshDistanceMaterial?(i(y,_),function(D,F){F.displacementMap&&(D.displacementMap.value=F.displacementMap,D.displacementScale.value=F.displacementScale,D.displacementBias.value=F.displacementBias),D.referencePosition.value.copy(F.referencePosition),D.nearDistance.value=F.nearDistance,D.farDistance.value=F.farDistance}(y,_)):_.isMeshNormalMaterial?(i(y,_),function(D,F){F.bumpMap&&(D.bumpMap.value=F.bumpMap,D.bumpScale.value=F.bumpScale,F.side===1&&(D.bumpScale.value*=-1)),F.normalMap&&(D.normalMap.value=F.normalMap,D.normalScale.value.copy(F.normalScale),F.side===1&&D.normalScale.value.negate()),F.displacementMap&&(D.displacementMap.value=F.displacementMap,D.displacementScale.value=F.displacementScale,D.displacementBias.value=F.displacementBias)}(y,_)):_.isLineBasicMaterial?(function(D,F){D.diffuse.value.copy(F.color),D.opacity.value=F.opacity}(y,_),_.isLineDashedMaterial&&function(D,F){D.dashSize.value=F.dashSize,D.totalSize.value=F.dashSize+F.gapSize,D.scale.value=F.scale}(y,_)):_.isPointsMaterial?function(D,F,G,W){D.diffuse.value.copy(F.color),D.opacity.value=F.opacity,D.size.value=F.size*G,D.scale.value=.5*W,F.map&&(D.map.value=F.map),F.alphaMap&&(D.alphaMap.value=F.alphaMap),F.alphaTest>0&&(D.alphaTest.value=F.alphaTest);let Z;F.map?Z=F.map:F.alphaMap&&(Z=F.alphaMap),Z!==void 0&&(Z.matrixAutoUpdate===!0&&Z.updateMatrix(),D.uvTransform.value.copy(Z.matrix))}(y,_,S,I):_.isSpriteMaterial?function(D,F){D.diffuse.value.copy(F.color),D.opacity.value=F.opacity,D.rotation.value=F.rotation,F.map&&(D.map.value=F.map),F.alphaMap&&(D.alphaMap.value=F.alphaMap),F.alphaTest>0&&(D.alphaTest.value=F.alphaTest);let G;F.map?G=F.map:F.alphaMap&&(G=F.alphaMap),G!==void 0&&(G.matrixAutoUpdate===!0&&G.updateMatrix(),D.uvTransform.value.copy(G.matrix))}(y,_):_.isShadowMaterial?(y.color.value.copy(_.color),y.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function zt(M={}){const i=M.canvas!==void 0?M.canvas:function(){const ft=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return ft.style.display="block",ft}(),f=M.context!==void 0?M.context:null,y=M.alpha!==void 0&&M.alpha,_=M.depth===void 0||M.depth,S=M.stencil===void 0||M.stencil,I=M.antialias!==void 0&&M.antialias,R=M.premultipliedAlpha===void 0||M.premultipliedAlpha,D=M.preserveDrawingBuffer!==void 0&&M.preserveDrawingBuffer,F=M.powerPreference!==void 0?M.powerPreference:"default",G=M.failIfMajorPerformanceCaveat!==void 0&&M.failIfMajorPerformanceCaveat;let W=null,Z=null;const K=[],oe=[];this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const de=this;let ke=!1,pe=0,Ve=0,Ye=null,$e=-1,_t=null;const bt=new Fe,Vt=new Fe;let qt=null,mn=i.width,sn=i.height,dn=1,wr=null,er=null;const Pn=new Fe(0,0,mn,sn),ir=new Fe(0,0,mn,sn);let Or=!1;const jr=[],si=new nu;let gi=!1,yi=!1,sr=null;const xt=new Nt,Pt=new me,Fn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ln(){return Ye===null?dn:1}let rn,yr,dr,hn,dt,an,Un,Kn,Hn,Wr,ci,Jr,Vr,Fi,ol,Ks,Lo,Tl,em,Sg,Tg,eh,Zu,hr=f;function h4(ft,Rn){for(let nn=0;nn<ft.length;nn++){const Cn=ft[nn],ar=i.getContext(Cn,Rn);if(ar!==null)return ar}return null}try{const ft={alpha:y,depth:_,stencil:S,antialias:I,premultipliedAlpha:R,preserveDrawingBuffer:D,powerPreference:F,failIfMajorPerformanceCaveat:G};if(i.addEventListener("webglcontextlost",f4,!1),i.addEventListener("webglcontextrestored",i1,!1),hr===null){const Rn=["webgl2","webgl","experimental-webgl"];if(de.isWebGL1Renderer===!0&&Rn.shift(),hr=h4(Rn,ft),hr===null)throw h4(Rn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}hr.getShaderPrecisionFormat===void 0&&(hr.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ft){throw console.error("THREE.WebGLRenderer: "+ft.message),ft}function d4(){rn=new ds(hr),yr=new gv(hr,rn,M),rn.init(yr),eh=new Ct(hr,rn,yr),dr=new it(hr,rn,yr),jr[0]=1029,hn=new m0,dt=new L,an=new lt(hr,rn,dr,dt,yr,eh,hn),Un=new m3(de),Kn=new p0(de),Hn=new s_(hr,yr),Zu=new c0(hr,rn,Hn,yr),Wr=new eg(hr,Hn,hn,Zu),ci=new kh(hr,Wr,Hn,hn),em=new g0(hr),Ks=new a_(dt),Jr=new C(de,Un,Kn,rn,yr,Zu,Ks),Vr=new Zn(dt),Fi=new ie(dt),ol=new Ge(rn,yr),Tl=new o_(de,Un,dr,ci,R),Lo=new Ue(de,ci,yr),Sg=new Ym(hr,rn,hn,yr),Tg=new vv(hr,rn,hn,yr),hn.programs=Jr.programs,de.capabilities=yr,de.extensions=rn,de.properties=dt,de.renderLists=Fi,de.shadowMap=Lo,de.state=dr,de.info=hn}d4();const xc=new Yt(de,hr);function f4(ft){ft.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ke=!0}function i1(){console.log("THREE.WebGLRenderer: Context Restored."),ke=!1;const ft=hn.autoReset,Rn=Lo.enabled,nn=Lo.autoUpdate,Cn=Lo.needsUpdate,ar=Lo.type;d4(),hn.autoReset=ft,Lo.enabled=Rn,Lo.autoUpdate=nn,Lo.needsUpdate=Cn,Lo.type=ar}function Mg(ft){const Rn=ft.target;Rn.removeEventListener("dispose",Mg),function(nn){(function(Cn){const ar=dt.get(Cn).programs;ar!==void 0&&ar.forEach(function(Ii){Jr.releaseProgram(Ii)})})(nn),dt.remove(nn)}(Rn)}this.xr=xc,this.getContext=function(){return hr},this.getContextAttributes=function(){return hr.getContextAttributes()},this.forceContextLoss=function(){const ft=rn.get("WEBGL_lose_context");ft&&ft.loseContext()},this.forceContextRestore=function(){const ft=rn.get("WEBGL_lose_context");ft&&ft.restoreContext()},this.getPixelRatio=function(){return dn},this.setPixelRatio=function(ft){ft!==void 0&&(dn=ft,this.setSize(mn,sn,!1))},this.getSize=function(ft){return ft.set(mn,sn)},this.setSize=function(ft,Rn,nn){xc.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(mn=ft,sn=Rn,i.width=Math.floor(ft*dn),i.height=Math.floor(Rn*dn),nn!==!1&&(i.style.width=ft+"px",i.style.height=Rn+"px"),this.setViewport(0,0,ft,Rn))},this.getDrawingBufferSize=function(ft){return ft.set(mn*dn,sn*dn).floor()},this.setDrawingBufferSize=function(ft,Rn,nn){mn=ft,sn=Rn,dn=nn,i.width=Math.floor(ft*nn),i.height=Math.floor(Rn*nn),this.setViewport(0,0,ft,Rn)},this.getCurrentViewport=function(ft){return ft.copy(bt)},this.getViewport=function(ft){return ft.copy(Pn)},this.setViewport=function(ft,Rn,nn,Cn){ft.isVector4?Pn.set(ft.x,ft.y,ft.z,ft.w):Pn.set(ft,Rn,nn,Cn),dr.viewport(bt.copy(Pn).multiplyScalar(dn).floor())},this.getScissor=function(ft){return ft.copy(ir)},this.setScissor=function(ft,Rn,nn,Cn){ft.isVector4?ir.set(ft.x,ft.y,ft.z,ft.w):ir.set(ft,Rn,nn,Cn),dr.scissor(Vt.copy(ir).multiplyScalar(dn).floor())},this.getScissorTest=function(){return Or},this.setScissorTest=function(ft){dr.setScissorTest(Or=ft)},this.setOpaqueSort=function(ft){wr=ft},this.setTransparentSort=function(ft){er=ft},this.getClearColor=function(ft){return ft.copy(Tl.getClearColor())},this.setClearColor=function(){Tl.setClearColor.apply(Tl,arguments)},this.getClearAlpha=function(){return Tl.getClearAlpha()},this.setClearAlpha=function(){Tl.setClearAlpha.apply(Tl,arguments)},this.clear=function(ft,Rn,nn){let Cn=0;(ft===void 0||ft)&&(Cn|=16384),(Rn===void 0||Rn)&&(Cn|=256),(nn===void 0||nn)&&(Cn|=1024),hr.clear(Cn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",f4,!1),i.removeEventListener("webglcontextrestored",i1,!1),Fi.dispose(),ol.dispose(),dt.dispose(),Un.dispose(),Kn.dispose(),ci.dispose(),Zu.dispose(),xc.dispose(),xc.removeEventListener("sessionstart",s1),xc.removeEventListener("sessionend",dx),sr&&(sr.dispose(),sr=null),kg.stop()},this.renderBufferImmediate=function(ft,Rn){Zu.initAttributes();const nn=dt.get(ft);ft.hasPositions&&!nn.position&&(nn.position=hr.createBuffer()),ft.hasNormals&&!nn.normal&&(nn.normal=hr.createBuffer()),ft.hasUvs&&!nn.uv&&(nn.uv=hr.createBuffer()),ft.hasColors&&!nn.color&&(nn.color=hr.createBuffer());const Cn=Rn.getAttributes();ft.hasPositions&&(hr.bindBuffer(34962,nn.position),hr.bufferData(34962,ft.positionArray,35048),Zu.enableAttribute(Cn.position.location),hr.vertexAttribPointer(Cn.position.location,3,5126,!1,0,0)),ft.hasNormals&&(hr.bindBuffer(34962,nn.normal),hr.bufferData(34962,ft.normalArray,35048),Zu.enableAttribute(Cn.normal.location),hr.vertexAttribPointer(Cn.normal.location,3,5126,!1,0,0)),ft.hasUvs&&(hr.bindBuffer(34962,nn.uv),hr.bufferData(34962,ft.uvArray,35048),Zu.enableAttribute(Cn.uv.location),hr.vertexAttribPointer(Cn.uv.location,2,5126,!1,0,0)),ft.hasColors&&(hr.bindBuffer(34962,nn.color),hr.bufferData(34962,ft.colorArray,35048),Zu.enableAttribute(Cn.color.location),hr.vertexAttribPointer(Cn.color.location,3,5126,!1,0,0)),Zu.disableUnusedAttributes(),hr.drawArrays(4,0,ft.count),ft.count=0},this.renderBufferDirect=function(ft,Rn,nn,Cn,ar,Ii){Rn===null&&(Rn=Fn);const hi=ar.isMesh&&ar.matrixWorld.determinant()<0,Wi=J3(ft,Rn,Cn,ar);dr.setMaterial(Cn,hi);let os=nn.index;const ho=nn.attributes.position;if(os===null){if(ho===void 0||ho.count===0)return}else if(os.count===0)return;let Rs,as=1;Cn.wireframe===!0&&(os=Wr.getWireframeAttribute(nn),as=2),nn.morphAttributes.position===void 0&&nn.morphAttributes.normal===void 0||em.update(ar,nn,Cn,Wi),Zu.setup(ar,Cn,Wi,nn,os);let Gi=Sg;os!==null&&(Rs=Hn.get(os),Gi=Tg,Gi.setIndex(Rs));const tm=os!==null?os.count:ho.count,xa=nn.drawRange.start*as,Wf=nn.drawRange.count*as,al=Ii!==null?Ii.start*as:0,nm=Ii!==null?Ii.count*as:1/0,qf=Math.max(xa,al),ll=Math.min(tm,xa+Wf,al+nm)-1,zh=Math.max(0,ll-qf+1);if(zh!==0){if(ar.isMesh)Cn.wireframe===!0?(dr.setLineWidth(Cn.wireframeLinewidth*ln()),Gi.setMode(1)):Gi.setMode(4);else if(ar.isLine){let ou=Cn.linewidth;ou===void 0&&(ou=1),dr.setLineWidth(ou*ln()),ar.isLineSegments?Gi.setMode(1):ar.isLineLoop?Gi.setMode(2):Gi.setMode(3)}else ar.isPoints?Gi.setMode(0):ar.isSprite&&Gi.setMode(4);if(ar.isInstancedMesh)Gi.renderInstances(qf,zh,ar.count);else if(nn.isInstancedBufferGeometry){const ou=Math.min(nn.instanceCount,nn._maxInstanceCount);Gi.renderInstances(qf,zh,ou)}else Gi.render(qf,zh)}},this.compile=function(ft,Rn){Z=ol.get(ft),Z.init(),oe.push(Z),ft.traverseVisible(function(nn){nn.isLight&&nn.layers.test(Rn.layers)&&(Z.pushLight(nn),nn.castShadow&&Z.pushShadow(nn))}),Z.setupLights(de.physicallyCorrectLights),ft.traverse(function(nn){const Cn=nn.material;if(Cn)if(Array.isArray(Cn))for(let ar=0;ar<Cn.length;ar++)ql(Cn[ar],ft,nn);else ql(Cn,ft,nn)}),oe.pop(),Z=null};let hx=null;function s1(){kg.stop()}function dx(){kg.start()}const kg=new Zm;function p4(ft,Rn,nn,Cn){if(ft.visible===!1)return;if(ft.layers.test(Rn.layers)){if(ft.isGroup)nn=ft.renderOrder;else if(ft.isLOD)ft.autoUpdate===!0&&ft.update(Rn);else if(ft.isLight)Z.pushLight(ft),ft.castShadow&&Z.pushShadow(ft);else if(ft.isSprite){if(!ft.frustumCulled||si.intersectsSprite(ft)){Cn&&Pt.setFromMatrixPosition(ft.matrixWorld).applyMatrix4(xt);const Ii=ci.update(ft),hi=ft.material;hi.visible&&W.push(ft,Ii,hi,nn,Pt.z,null)}}else if(ft.isImmediateRenderObject)Cn&&Pt.setFromMatrixPosition(ft.matrixWorld).applyMatrix4(xt),W.push(ft,null,ft.material,nn,Pt.z,null);else if((ft.isMesh||ft.isLine||ft.isPoints)&&(ft.isSkinnedMesh&&ft.skeleton.frame!==hn.render.frame&&(ft.skeleton.update(),ft.skeleton.frame=hn.render.frame),!ft.frustumCulled||si.intersectsObject(ft))){Cn&&Pt.setFromMatrixPosition(ft.matrixWorld).applyMatrix4(xt);const Ii=ci.update(ft),hi=ft.material;if(Array.isArray(hi)){const Wi=Ii.groups;for(let os=0,ho=Wi.length;os<ho;os++){const Rs=Wi[os],as=hi[Rs.materialIndex];as&&as.visible&&W.push(ft,Ii,as,nn,Pt.z,Rs)}}else hi.visible&&W.push(ft,Ii,hi,nn,Pt.z,null)}}const ar=ft.children;for(let Ii=0,hi=ar.length;Ii<hi;Ii++)p4(ar[Ii],Rn,nn,Cn)}function m4(ft,Rn,nn,Cn){const ar=ft.opaque,Ii=ft.transmissive,hi=ft.transparent;Z.setupLightsView(nn),Ii.length>0&&function(Wi,os,ho){if(sr===null){const Gi=I===!0&&yr.isWebGL2===!0;sr=new(Gi?Tt:nt)(1024,1024,{generateMipmaps:!0,type:eh.convert(1016)!==null?1016:1009,minFilter:1008,magFilter:1003,wrapS:1001,wrapT:1001})}const Rs=de.getRenderTarget();de.setRenderTarget(sr),de.clear();const as=de.toneMapping;de.toneMapping=0,o1(Wi,os,ho),de.toneMapping=as,an.updateMultisampleRenderTarget(sr),an.updateRenderTargetMipmap(sr),de.setRenderTarget(Rs)}(ar,Rn,nn),Cn&&dr.viewport(bt.copy(Cn)),ar.length>0&&o1(ar,Rn,nn),Ii.length>0&&o1(Ii,Rn,nn),hi.length>0&&o1(hi,Rn,nn)}function o1(ft,Rn,nn){const Cn=Rn.isScene===!0?Rn.overrideMaterial:null;for(let ar=0,Ii=ft.length;ar<Ii;ar++){const hi=ft[ar],Wi=hi.object,os=hi.geometry,ho=Cn===null?hi.material:Cn,Rs=hi.group;Wi.layers.test(nn.layers)&&K3(Wi,Rn,nn,os,ho,Rs)}}function K3(ft,Rn,nn,Cn,ar,Ii){if(ft.onBeforeRender(de,Rn,nn,Cn,ar,Ii),ft.modelViewMatrix.multiplyMatrices(nn.matrixWorldInverse,ft.matrixWorld),ft.normalMatrix.getNormalMatrix(ft.modelViewMatrix),ft.isImmediateRenderObject){const hi=J3(nn,Rn,ar,ft);dr.setMaterial(ar),Zu.reset(),function(Wi,os){Wi.render(function(ho){de.renderBufferImmediate(ho,os)})}(ft,hi)}else ar.transparent===!0&&ar.side===2?(ar.side=1,ar.needsUpdate=!0,de.renderBufferDirect(nn,Rn,Cn,ar,ft,Ii),ar.side=0,ar.needsUpdate=!0,de.renderBufferDirect(nn,Rn,Cn,ar,ft,Ii),ar.side=2):de.renderBufferDirect(nn,Rn,Cn,ar,ft,Ii);ft.onAfterRender(de,Rn,nn,Cn,ar,Ii)}function ql(ft,Rn,nn){Rn.isScene!==!0&&(Rn=Fn);const Cn=dt.get(ft),ar=Z.state.lights,Ii=Z.state.shadowsArray,hi=ar.state.version,Wi=Jr.getParameters(ft,ar.state,Ii,Rn,nn),os=Jr.getProgramCacheKey(Wi);let ho=Cn.programs;Cn.environment=ft.isMeshStandardMaterial?Rn.environment:null,Cn.fog=Rn.fog,Cn.envMap=(ft.isMeshStandardMaterial?Kn:Un).get(ft.envMap||Cn.environment),ho===void 0&&(ft.addEventListener("dispose",Mg),ho=new Map,Cn.programs=ho);let Rs=ho.get(os);if(Rs!==void 0){if(Cn.currentProgram===Rs&&Cn.lightsStateVersion===hi)return fx(ft,Wi),Rs}else Wi.uniforms=Jr.getUniforms(ft),ft.onBuild(Wi,de),ft.onBeforeCompile(Wi,de),Rs=Jr.acquireProgram(Wi,os),ho.set(os,Rs),Cn.uniforms=Wi.uniforms;const as=Cn.uniforms;(ft.isShaderMaterial||ft.isRawShaderMaterial)&&ft.clipping!==!0||(as.clippingPlanes=Ks.uniform),fx(ft,Wi),Cn.needsLights=function(xa){return xa.isMeshLambertMaterial||xa.isMeshToonMaterial||xa.isMeshPhongMaterial||xa.isMeshStandardMaterial||xa.isShadowMaterial||xa.isShaderMaterial&&xa.lights===!0}(ft),Cn.lightsStateVersion=hi,Cn.needsLights&&(as.ambientLightColor.value=ar.state.ambient,as.lightProbe.value=ar.state.probe,as.directionalLights.value=ar.state.directional,as.directionalLightShadows.value=ar.state.directionalShadow,as.spotLights.value=ar.state.spot,as.spotLightShadows.value=ar.state.spotShadow,as.rectAreaLights.value=ar.state.rectArea,as.ltc_1.value=ar.state.rectAreaLTC1,as.ltc_2.value=ar.state.rectAreaLTC2,as.pointLights.value=ar.state.point,as.pointLightShadows.value=ar.state.pointShadow,as.hemisphereLights.value=ar.state.hemi,as.directionalShadowMap.value=ar.state.directionalShadowMap,as.directionalShadowMatrix.value=ar.state.directionalShadowMatrix,as.spotShadowMap.value=ar.state.spotShadowMap,as.spotShadowMatrix.value=ar.state.spotShadowMatrix,as.pointShadowMap.value=ar.state.pointShadowMap,as.pointShadowMatrix.value=ar.state.pointShadowMatrix);const Gi=Rs.getUniforms(),tm=Wc.seqWithValue(Gi.seq,as);return Cn.currentProgram=Rs,Cn.uniformsList=tm,Rs}function fx(ft,Rn){const nn=dt.get(ft);nn.outputEncoding=Rn.outputEncoding,nn.instancing=Rn.instancing,nn.skinning=Rn.skinning,nn.morphTargets=Rn.morphTargets,nn.morphNormals=Rn.morphNormals,nn.numClippingPlanes=Rn.numClippingPlanes,nn.numIntersection=Rn.numClipIntersection,nn.vertexAlphas=Rn.vertexAlphas,nn.vertexTangents=Rn.vertexTangents}function J3(ft,Rn,nn,Cn){Rn.isScene!==!0&&(Rn=Fn),an.resetTextureUnits();const ar=Rn.fog,Ii=nn.isMeshStandardMaterial?Rn.environment:null,hi=Ye===null?de.outputEncoding:Ye.texture.encoding,Wi=(nn.isMeshStandardMaterial?Kn:Un).get(nn.envMap||Ii),os=nn.vertexColors===!0&&!!Cn.geometry&&!!Cn.geometry.attributes.color&&Cn.geometry.attributes.color.itemSize===4,ho=!!Cn.geometry&&!!Cn.geometry.attributes.tangent,Rs=!!Cn.geometry&&!!Cn.geometry.morphAttributes.position,as=!!Cn.geometry&&!!Cn.geometry.morphAttributes.normal,Gi=dt.get(nn),tm=Z.state.lights;if(gi===!0&&(yi===!0||ft!==_t)){const th=ft===_t&&nn.id===$e;Ks.setState(nn,ft,th)}let xa=!1;nn.version===Gi.__version?Gi.needsLights&&Gi.lightsStateVersion!==tm.state.version||Gi.outputEncoding!==hi||Cn.isInstancedMesh&&Gi.instancing===!1?xa=!0:Cn.isInstancedMesh||Gi.instancing!==!0?Cn.isSkinnedMesh&&Gi.skinning===!1?xa=!0:Cn.isSkinnedMesh||Gi.skinning!==!0?Gi.envMap!==Wi||nn.fog&&Gi.fog!==ar?xa=!0:Gi.numClippingPlanes===void 0||Gi.numClippingPlanes===Ks.numPlanes&&Gi.numIntersection===Ks.numIntersection?(Gi.vertexAlphas!==os||Gi.vertexTangents!==ho||Gi.morphTargets!==Rs||Gi.morphNormals!==as)&&(xa=!0):xa=!0:xa=!0:xa=!0:(xa=!0,Gi.__version=nn.version);let Wf=Gi.currentProgram;xa===!0&&(Wf=ql(nn,Rn,Cn));let al=!1,nm=!1,qf=!1;const ll=Wf.getUniforms(),zh=Gi.uniforms;if(dr.useProgram(Wf.program)&&(al=!0,nm=!0,qf=!0),nn.id!==$e&&($e=nn.id,nm=!0),al||_t!==ft){if(ll.setValue(hr,"projectionMatrix",ft.projectionMatrix),yr.logarithmicDepthBuffer&&ll.setValue(hr,"logDepthBufFC",2/(Math.log(ft.far+1)/Math.LN2)),_t!==ft&&(_t=ft,nm=!0,qf=!0),nn.isShaderMaterial||nn.isMeshPhongMaterial||nn.isMeshToonMaterial||nn.isMeshStandardMaterial||nn.envMap){const th=ll.map.cameraPosition;th!==void 0&&th.setValue(hr,Pt.setFromMatrixPosition(ft.matrixWorld))}(nn.isMeshPhongMaterial||nn.isMeshToonMaterial||nn.isMeshLambertMaterial||nn.isMeshBasicMaterial||nn.isMeshStandardMaterial||nn.isShaderMaterial)&&ll.setValue(hr,"isOrthographic",ft.isOrthographicCamera===!0),(nn.isMeshPhongMaterial||nn.isMeshToonMaterial||nn.isMeshLambertMaterial||nn.isMeshBasicMaterial||nn.isMeshStandardMaterial||nn.isShaderMaterial||nn.isShadowMaterial||Cn.isSkinnedMesh)&&ll.setValue(hr,"viewMatrix",ft.matrixWorldInverse)}if(Cn.isSkinnedMesh){ll.setOptional(hr,Cn,"bindMatrix"),ll.setOptional(hr,Cn,"bindMatrixInverse");const th=Cn.skeleton;th&&(yr.floatVertexTextures?(th.boneTexture===null&&th.computeBoneTexture(),ll.setValue(hr,"boneTexture",th.boneTexture,an),ll.setValue(hr,"boneTextureSize",th.boneTextureSize)):ll.setOptional(hr,th,"boneMatrices"))}var ou,Bh;return(nm||Gi.receiveShadow!==Cn.receiveShadow)&&(Gi.receiveShadow=Cn.receiveShadow,ll.setValue(hr,"receiveShadow",Cn.receiveShadow)),nm&&(ll.setValue(hr,"toneMappingExposure",de.toneMappingExposure),Gi.needsLights&&(Bh=qf,(ou=zh).ambientLightColor.needsUpdate=Bh,ou.lightProbe.needsUpdate=Bh,ou.directionalLights.needsUpdate=Bh,ou.directionalLightShadows.needsUpdate=Bh,ou.pointLights.needsUpdate=Bh,ou.pointLightShadows.needsUpdate=Bh,ou.spotLights.needsUpdate=Bh,ou.spotLightShadows.needsUpdate=Bh,ou.rectAreaLights.needsUpdate=Bh,ou.hemisphereLights.needsUpdate=Bh),ar&&nn.fog&&Vr.refreshFogUniforms(zh,ar),Vr.refreshMaterialUniforms(zh,nn,dn,sn,sr),Wc.upload(hr,Gi.uniformsList,zh,an)),nn.isShaderMaterial&&nn.uniformsNeedUpdate===!0&&(Wc.upload(hr,Gi.uniformsList,zh,an),nn.uniformsNeedUpdate=!1),nn.isSpriteMaterial&&ll.setValue(hr,"center",Cn.center),ll.setValue(hr,"modelViewMatrix",Cn.modelViewMatrix),ll.setValue(hr,"normalMatrix",Cn.normalMatrix),ll.setValue(hr,"modelMatrix",Cn.matrixWorld),Wf}kg.setAnimationLoop(function(ft){hx&&hx(ft)}),typeof window<"u"&&kg.setContext(window),this.setAnimationLoop=function(ft){hx=ft,xc.setAnimationLoop(ft),ft===null?kg.stop():kg.start()},xc.addEventListener("sessionstart",s1),xc.addEventListener("sessionend",dx),this.render=function(ft,Rn){if(Rn!==void 0&&Rn.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(ke===!0)return;ft.autoUpdate===!0&&ft.updateMatrixWorld(),Rn.parent===null&&Rn.updateMatrixWorld(),xc.enabled===!0&&xc.isPresenting===!0&&(xc.cameraAutoUpdate===!0&&xc.updateCamera(Rn),Rn=xc.getCamera()),ft.isScene===!0&&ft.onBeforeRender(de,ft,Rn,Ye),Z=ol.get(ft,oe.length),Z.init(),oe.push(Z),xt.multiplyMatrices(Rn.projectionMatrix,Rn.matrixWorldInverse),si.setFromProjectionMatrix(xt),yi=this.localClippingEnabled,gi=Ks.init(this.clippingPlanes,yi,Rn),W=Fi.get(ft,K.length),W.init(),K.push(W),p4(ft,Rn,0,de.sortObjects),W.finish(),de.sortObjects===!0&&W.sort(wr,er),gi===!0&&Ks.beginShadows();const nn=Z.state.shadowsArray;if(Lo.render(nn,ft,Rn),gi===!0&&Ks.endShadows(),this.info.autoReset===!0&&this.info.reset(),Tl.render(W,ft),Z.setupLights(de.physicallyCorrectLights),Rn.isArrayCamera){const Cn=Rn.cameras;for(let ar=0,Ii=Cn.length;ar<Ii;ar++){const hi=Cn[ar];m4(W,ft,hi,hi.viewport)}}else m4(W,ft,Rn);Ye!==null&&(an.updateMultisampleRenderTarget(Ye),an.updateRenderTargetMipmap(Ye)),ft.isScene===!0&&ft.onAfterRender(de,ft,Rn),dr.buffers.depth.setTest(!0),dr.buffers.depth.setMask(!0),dr.buffers.color.setMask(!0),dr.setPolygonOffset(!1),Zu.resetDefaultState(),$e=-1,_t=null,oe.pop(),Z=oe.length>0?oe[oe.length-1]:null,K.pop(),W=K.length>0?K[K.length-1]:null},this.getActiveCubeFace=function(){return pe},this.getActiveMipmapLevel=function(){return Ve},this.getRenderTarget=function(){return Ye},this.setRenderTarget=function(ft,Rn=0,nn=0){Ye=ft,pe=Rn,Ve=nn,ft&&dt.get(ft).__webglFramebuffer===void 0&&an.setupRenderTarget(ft);let Cn=null,ar=!1,Ii=!1;if(ft){const hi=ft.texture;(hi.isDataTexture3D||hi.isDataTexture2DArray)&&(Ii=!0);const Wi=dt.get(ft).__webglFramebuffer;ft.isWebGLCubeRenderTarget?(Cn=Wi[Rn],ar=!0):Cn=ft.isWebGLMultisampleRenderTarget?dt.get(ft).__webglMultisampledFramebuffer:Wi,bt.copy(ft.viewport),Vt.copy(ft.scissor),qt=ft.scissorTest}else bt.copy(Pn).multiplyScalar(dn).floor(),Vt.copy(ir).multiplyScalar(dn).floor(),qt=Or;if(dr.bindFramebuffer(36160,Cn)&&yr.drawBuffers){let hi=!1;if(ft)if(ft.isWebGLMultipleRenderTargets){const Wi=ft.texture;if(jr.length!==Wi.length||jr[0]!==36064){for(let os=0,ho=Wi.length;os<ho;os++)jr[os]=36064+os;jr.length=Wi.length,hi=!0}}else jr.length===1&&jr[0]===36064||(jr[0]=36064,jr.length=1,hi=!0);else jr.length===1&&jr[0]===1029||(jr[0]=1029,jr.length=1,hi=!0);hi&&(yr.isWebGL2?hr.drawBuffers(jr):rn.get("WEBGL_draw_buffers").drawBuffersWEBGL(jr))}if(dr.viewport(bt),dr.scissor(Vt),dr.setScissorTest(qt),ar){const hi=dt.get(ft.texture);hr.framebufferTexture2D(36160,36064,34069+Rn,hi.__webglTexture,nn)}else if(Ii){const hi=dt.get(ft.texture),Wi=Rn||0;hr.framebufferTextureLayer(36160,36064,hi.__webglTexture,nn||0,Wi)}$e=-1},this.readRenderTargetPixels=function(ft,Rn,nn,Cn,ar,Ii,hi){if(!ft||!ft.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Wi=dt.get(ft).__webglFramebuffer;if(ft.isWebGLCubeRenderTarget&&hi!==void 0&&(Wi=Wi[hi]),Wi){dr.bindFramebuffer(36160,Wi);try{const os=ft.texture,ho=os.format,Rs=os.type;if(ho!==1023&&eh.convert(ho)!==hr.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const as=Rs===1016&&(rn.has("EXT_color_buffer_half_float")||yr.isWebGL2&&rn.has("EXT_color_buffer_float"));if(!(Rs===1009||eh.convert(Rs)===hr.getParameter(35738)||Rs===1015&&(yr.isWebGL2||rn.has("OES_texture_float")||rn.has("WEBGL_color_buffer_float"))||as))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");hr.checkFramebufferStatus(36160)===36053?Rn>=0&&Rn<=ft.width-Cn&&nn>=0&&nn<=ft.height-ar&&hr.readPixels(Rn,nn,Cn,ar,eh.convert(ho),eh.convert(Rs),Ii):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const os=Ye!==null?dt.get(Ye).__webglFramebuffer:null;dr.bindFramebuffer(36160,os)}}},this.copyFramebufferToTexture=function(ft,Rn,nn=0){const Cn=Math.pow(2,-nn),ar=Math.floor(Rn.image.width*Cn),Ii=Math.floor(Rn.image.height*Cn);let hi=eh.convert(Rn.format);yr.isWebGL2&&(hi===6407&&(hi=32849),hi===6408&&(hi=32856)),an.setTexture2D(Rn,0),hr.copyTexImage2D(3553,nn,hi,ft.x,ft.y,ar,Ii,0),dr.unbindTexture()},this.copyTextureToTexture=function(ft,Rn,nn,Cn=0){const ar=Rn.image.width,Ii=Rn.image.height,hi=eh.convert(nn.format),Wi=eh.convert(nn.type);an.setTexture2D(nn,0),hr.pixelStorei(37440,nn.flipY),hr.pixelStorei(37441,nn.premultiplyAlpha),hr.pixelStorei(3317,nn.unpackAlignment),Rn.isDataTexture?hr.texSubImage2D(3553,Cn,ft.x,ft.y,ar,Ii,hi,Wi,Rn.image.data):Rn.isCompressedTexture?hr.compressedTexSubImage2D(3553,Cn,ft.x,ft.y,Rn.mipmaps[0].width,Rn.mipmaps[0].height,hi,Rn.mipmaps[0].data):hr.texSubImage2D(3553,Cn,ft.x,ft.y,hi,Wi,Rn.image),Cn===0&&nn.generateMipmaps&&hr.generateMipmap(3553),dr.unbindTexture()},this.copyTextureToTexture3D=function(ft,Rn,nn,Cn,ar=0){if(de.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ii=ft.max.x-ft.min.x+1,hi=ft.max.y-ft.min.y+1,Wi=ft.max.z-ft.min.z+1,os=eh.convert(Cn.format),ho=eh.convert(Cn.type);let Rs;if(Cn.isDataTexture3D)an.setTexture3D(Cn,0),Rs=32879;else{if(!Cn.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");an.setTexture2DArray(Cn,0),Rs=35866}hr.pixelStorei(37440,Cn.flipY),hr.pixelStorei(37441,Cn.premultiplyAlpha),hr.pixelStorei(3317,Cn.unpackAlignment);const as=hr.getParameter(3314),Gi=hr.getParameter(32878),tm=hr.getParameter(3316),xa=hr.getParameter(3315),Wf=hr.getParameter(32877),al=nn.isCompressedTexture?nn.mipmaps[0]:nn.image;hr.pixelStorei(3314,al.width),hr.pixelStorei(32878,al.height),hr.pixelStorei(3316,ft.min.x),hr.pixelStorei(3315,ft.min.y),hr.pixelStorei(32877,ft.min.z),nn.isDataTexture||nn.isDataTexture3D?hr.texSubImage3D(Rs,ar,Rn.x,Rn.y,Rn.z,Ii,hi,Wi,os,ho,al.data):nn.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),hr.compressedTexSubImage3D(Rs,ar,Rn.x,Rn.y,Rn.z,Ii,hi,Wi,os,al.data)):hr.texSubImage3D(Rs,ar,Rn.x,Rn.y,Rn.z,Ii,hi,Wi,os,ho,al),hr.pixelStorei(3314,as),hr.pixelStorei(32878,Gi),hr.pixelStorei(3316,tm),hr.pixelStorei(3315,xa),hr.pixelStorei(32877,Wf),ar===0&&Cn.generateMipmaps&&hr.generateMipmap(Rs),dr.unbindTexture()},this.initTexture=function(ft){an.setTexture2D(ft,0),dr.unbindTexture()},this.resetState=function(){pe=0,Ve=0,Ye=null,dr.reset(),Zu.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class wn extends zt{}wn.prototype.isWebGL1Renderer=!0;class Qt{constructor(i,f=25e-5){this.name="",this.color=new Xn(i),this.density=f}clone(){return new Qt(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Qt.prototype.isFogExp2=!0;class Gn{constructor(i,f=1,y=1e3){this.name="",this.color=new Xn(i),this.near=f,this.far=y}clone(){return new Gn(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Gn.prototype.isFog=!0;class $t extends Me{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(i,f){return super.copy(i,f),i.background!==null&&(this.background=i.background.clone()),i.environment!==null&&(this.environment=i.environment.clone()),i.fog!==null&&(this.fog=i.fog.clone()),i.overrideMaterial!==null&&(this.overrideMaterial=i.overrideMaterial.clone()),this.autoUpdate=i.autoUpdate,this.matrixAutoUpdate=i.matrixAutoUpdate,this}toJSON(i){const f=super.toJSON(i);return this.fog!==null&&(f.object.fog=this.fog.toJSON()),f}}$t.prototype.isScene=!0;class vn{constructor(i,f){this.array=i,this.stride=f,this.count=i!==void 0?i.length/f:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Dr()}onUploadCallback(){}set needsUpdate(i){i===!0&&this.version++}setUsage(i){return this.usage=i,this}copy(i){return this.array=new i.array.constructor(i.array),this.count=i.count,this.stride=i.stride,this.usage=i.usage,this}copyAt(i,f,y){i*=this.stride,y*=f.stride;for(let _=0,S=this.stride;_<S;_++)this.array[i+_]=f.array[y+_];return this}set(i,f=0){return this.array.set(i,f),this}clone(i){i.arrayBuffers===void 0&&(i.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Dr()),i.arrayBuffers[this.array.buffer._uuid]===void 0&&(i.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const f=new this.array.constructor(i.arrayBuffers[this.array.buffer._uuid]),y=new this.constructor(f,this.stride);return y.setUsage(this.usage),y}onUpload(i){return this.onUploadCallback=i,this}toJSON(i){return i.arrayBuffers===void 0&&(i.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Dr()),i.arrayBuffers[this.array.buffer._uuid]===void 0&&(i.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}vn.prototype.isInterleavedBuffer=!0;const Tn=new me;class kn{constructor(i,f,y,_=!1){this.name="",this.data=i,this.itemSize=f,this.offset=y,this.normalized=_===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(i){this.data.needsUpdate=i}applyMatrix4(i){for(let f=0,y=this.data.count;f<y;f++)Tn.x=this.getX(f),Tn.y=this.getY(f),Tn.z=this.getZ(f),Tn.applyMatrix4(i),this.setXYZ(f,Tn.x,Tn.y,Tn.z);return this}applyNormalMatrix(i){for(let f=0,y=this.count;f<y;f++)Tn.x=this.getX(f),Tn.y=this.getY(f),Tn.z=this.getZ(f),Tn.applyNormalMatrix(i),this.setXYZ(f,Tn.x,Tn.y,Tn.z);return this}transformDirection(i){for(let f=0,y=this.count;f<y;f++)Tn.x=this.getX(f),Tn.y=this.getY(f),Tn.z=this.getZ(f),Tn.transformDirection(i),this.setXYZ(f,Tn.x,Tn.y,Tn.z);return this}setX(i,f){return this.data.array[i*this.data.stride+this.offset]=f,this}setY(i,f){return this.data.array[i*this.data.stride+this.offset+1]=f,this}setZ(i,f){return this.data.array[i*this.data.stride+this.offset+2]=f,this}setW(i,f){return this.data.array[i*this.data.stride+this.offset+3]=f,this}getX(i){return this.data.array[i*this.data.stride+this.offset]}getY(i){return this.data.array[i*this.data.stride+this.offset+1]}getZ(i){return this.data.array[i*this.data.stride+this.offset+2]}getW(i){return this.data.array[i*this.data.stride+this.offset+3]}setXY(i,f,y){return i=i*this.data.stride+this.offset,this.data.array[i+0]=f,this.data.array[i+1]=y,this}setXYZ(i,f,y,_){return i=i*this.data.stride+this.offset,this.data.array[i+0]=f,this.data.array[i+1]=y,this.data.array[i+2]=_,this}setXYZW(i,f,y,_,S){return i=i*this.data.stride+this.offset,this.data.array[i+0]=f,this.data.array[i+1]=y,this.data.array[i+2]=_,this.data.array[i+3]=S,this}clone(i){if(i===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const f=[];for(let y=0;y<this.count;y++){const _=y*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)f.push(this.data.array[_+S])}return new xi(new this.array.constructor(f),this.itemSize,this.normalized)}return i.interleavedBuffers===void 0&&(i.interleavedBuffers={}),i.interleavedBuffers[this.data.uuid]===void 0&&(i.interleavedBuffers[this.data.uuid]=this.data.clone(i)),new kn(i.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(i){if(i===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const f=[];for(let y=0;y<this.count;y++){const _=y*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)f.push(this.data.array[_+S])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:f,normalized:this.normalized}}return i.interleavedBuffers===void 0&&(i.interleavedBuffers={}),i.interleavedBuffers[this.data.uuid]===void 0&&(i.interleavedBuffers[this.data.uuid]=this.data.toJSON(i)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}kn.prototype.isInterleavedBufferAttribute=!0;class Yn extends cn{constructor(i){super(),this.type="SpriteMaterial",this.color=new Xn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.rotation=i.rotation,this.sizeAttenuation=i.sizeAttenuation,this}}let Ur;Yn.prototype.isSpriteMaterial=!0;const ui=new me,Mr=new me,Xr=new me,ki=new Vn,Ci=new Vn,Hr=new Nt,fs=new me,bs=new me,Ts=new me,Os=new Vn,Ya=new Vn,Ra=new Vn;class Vl extends Me{constructor(i){if(super(),this.type="Sprite",Ur===void 0){Ur=new bi;const f=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),y=new vn(f,5);Ur.setIndex([0,1,2,0,2,3]),Ur.setAttribute("position",new kn(y,3,0,!1)),Ur.setAttribute("uv",new kn(y,2,3,!1))}this.geometry=Ur,this.material=i!==void 0?i:new Yn,this.center=new Vn(.5,.5)}raycast(i,f){i.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Mr.setFromMatrixScale(this.matrixWorld),Hr.copy(i.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(i.camera.matrixWorldInverse,this.matrixWorld),Xr.setFromMatrixPosition(this.modelViewMatrix),i.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Mr.multiplyScalar(-Xr.z);const y=this.material.rotation;let _,S;y!==0&&(S=Math.cos(y),_=Math.sin(y));const I=this.center;wu(fs.set(-.5,-.5,0),Xr,I,Mr,_,S),wu(bs.set(.5,-.5,0),Xr,I,Mr,_,S),wu(Ts.set(.5,.5,0),Xr,I,Mr,_,S),Os.set(0,0),Ya.set(1,0),Ra.set(1,1);let R=i.ray.intersectTriangle(fs,bs,Ts,!1,ui);if(R===null&&(wu(bs.set(-.5,.5,0),Xr,I,Mr,_,S),Ya.set(0,1),R=i.ray.intersectTriangle(fs,Ts,bs,!1,ui),R===null))return;const D=i.ray.origin.distanceTo(ui);D<i.near||D>i.far||f.push({distance:D,point:ui.clone(),uv:Bn.getUV(ui,fs,bs,Ts,Os,Ya,Ra,new Vn),face:null,object:this})}copy(i){return super.copy(i),i.center!==void 0&&this.center.copy(i.center),this.material=i.material,this}}function wu(M,i,f,y,_,S){ki.subVectors(M,f).addScalar(.5).multiply(y),_!==void 0?(Ci.x=S*ki.x-_*ki.y,Ci.y=_*ki.x+S*ki.y):Ci.copy(ki),M.copy(i),M.x+=Ci.x,M.y+=Ci.y,M.applyMatrix4(Hr)}Vl.prototype.isSprite=!0;const Hs=new me,Fs=new me;class ps extends Me{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(i){super.copy(i,!1);const f=i.levels;for(let y=0,_=f.length;y<_;y++){const S=f[y];this.addLevel(S.object.clone(),S.distance)}return this.autoUpdate=i.autoUpdate,this}addLevel(i,f=0){f=Math.abs(f);const y=this.levels;let _;for(_=0;_<y.length&&!(f<y[_].distance);_++);return y.splice(_,0,{distance:f,object:i}),this.add(i),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(i){const f=this.levels;if(f.length>0){let y,_;for(y=1,_=f.length;y<_&&!(i<f[y].distance);y++);return f[y-1].object}return null}raycast(i,f){if(this.levels.length>0){Hs.setFromMatrixPosition(this.matrixWorld);const y=i.ray.origin.distanceTo(Hs);this.getObjectForDistance(y).raycast(i,f)}}update(i){const f=this.levels;if(f.length>1){Hs.setFromMatrixPosition(i.matrixWorld),Fs.setFromMatrixPosition(this.matrixWorld);const y=Hs.distanceTo(Fs)/i.zoom;let _,S;for(f[0].object.visible=!0,_=1,S=f.length;_<S&&y>=f[_].distance;_++)f[_-1].object.visible=!1,f[_].object.visible=!0;for(this._currentLevel=_-1;_<S;_++)f[_].object.visible=!1}}toJSON(i){const f=super.toJSON(i);this.autoUpdate===!1&&(f.object.autoUpdate=!1),f.object.levels=[];const y=this.levels;for(let _=0,S=y.length;_<S;_++){const I=y[_];f.object.levels.push({object:I.object.uuid,distance:I.distance})}return f}}const Go=new me,wl=new Fe,Ys=new Fe,iu=new me,ag=new Nt;class qc extends Vo{constructor(i,f){super(i,f),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Nt,this.bindMatrixInverse=new Nt}copy(i){return super.copy(i),this.bindMode=i.bindMode,this.bindMatrix.copy(i.bindMatrix),this.bindMatrixInverse.copy(i.bindMatrixInverse),this.skeleton=i.skeleton,this}bind(i,f){this.skeleton=i,f===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),f=this.matrixWorld),this.bindMatrix.copy(f),this.bindMatrixInverse.copy(f).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const i=new Fe,f=this.geometry.attributes.skinWeight;for(let y=0,_=f.count;y<_;y++){i.x=f.getX(y),i.y=f.getY(y),i.z=f.getZ(y),i.w=f.getW(y);const S=1/i.manhattanLength();S!==1/0?i.multiplyScalar(S):i.set(1,0,0,0),f.setXYZW(y,i.x,i.y,i.z,i.w)}}updateMatrixWorld(i){super.updateMatrixWorld(i),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(i,f){const y=this.skeleton,_=this.geometry;wl.fromBufferAttribute(_.attributes.skinIndex,i),Ys.fromBufferAttribute(_.attributes.skinWeight,i),Go.fromBufferAttribute(_.attributes.position,i).applyMatrix4(this.bindMatrix),f.set(0,0,0);for(let S=0;S<4;S++){const I=Ys.getComponent(S);if(I!==0){const R=wl.getComponent(S);ag.multiplyMatrices(y.bones[R].matrixWorld,y.boneInverses[R]),f.addScaledVector(iu.copy(Go).applyMatrix4(ag),I)}}return f.applyMatrix4(this.bindMatrixInverse)}}qc.prototype.isSkinnedMesh=!0;class kd extends Me{constructor(){super(),this.type="Bone"}}kd.prototype.isBone=!0;class Gl extends le{constructor(i=null,f=1,y=1,_,S,I,R,D,F=1003,G=1003,W,Z){super(null,I,R,D,F,G,_,S,W,Z),this.image={data:i,width:f,height:y},this.magFilter=F,this.minFilter=G,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Gl.prototype.isDataTexture=!0;const Ih=new Nt,Lf=new Nt;class Pf{constructor(i=[],f=[]){this.uuid=Dr(),this.bones=i.slice(0),this.boneInverses=f,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const i=this.bones,f=this.boneInverses;if(this.boneMatrices=new Float32Array(16*i.length),f.length===0)this.calculateInverses();else if(i.length!==f.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let y=0,_=this.bones.length;y<_;y++)this.boneInverses.push(new Nt)}}calculateInverses(){this.boneInverses.length=0;for(let i=0,f=this.bones.length;i<f;i++){const y=new Nt;this.bones[i]&&y.copy(this.bones[i].matrixWorld).invert(),this.boneInverses.push(y)}}pose(){for(let i=0,f=this.bones.length;i<f;i++){const y=this.bones[i];y&&y.matrixWorld.copy(this.boneInverses[i]).invert()}for(let i=0,f=this.bones.length;i<f;i++){const y=this.bones[i];y&&(y.parent&&y.parent.isBone?(y.matrix.copy(y.parent.matrixWorld).invert(),y.matrix.multiply(y.matrixWorld)):y.matrix.copy(y.matrixWorld),y.matrix.decompose(y.position,y.quaternion,y.scale))}}update(){const i=this.bones,f=this.boneInverses,y=this.boneMatrices,_=this.boneTexture;for(let S=0,I=i.length;S<I;S++){const R=i[S]?i[S].matrixWorld:Lf;Ih.multiplyMatrices(R,f[S]),Ih.toArray(y,16*S)}_!==null&&(_.needsUpdate=!0)}clone(){return new Pf(this.bones,this.boneInverses)}computeBoneTexture(){let i=Math.sqrt(4*this.bones.length);i=$i(i),i=Math.max(i,4);const f=new Float32Array(i*i*4);f.set(this.boneMatrices);const y=new Gl(f,i,i,1023,1015);return this.boneMatrices=f,this.boneTexture=y,this.boneTextureSize=i,this}getBoneByName(i){for(let f=0,y=this.bones.length;f<y;f++){const _=this.bones[f];if(_.name===i)return _}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(i,f){this.uuid=i.uuid;for(let y=0,_=i.bones.length;y<_;y++){const S=i.bones[y];let I=f[S];I===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",S),I=new kd),this.bones.push(I),this.boneInverses.push(new Nt().fromArray(i.boneInverses[y]))}return this.init(),this}toJSON(){const i={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};i.uuid=this.uuid;const f=this.bones,y=this.boneInverses;for(let _=0,S=f.length;_<S;_++){const I=f[_];i.bones.push(I.uuid);const R=y[_];i.boneInverses.push(R.toArray())}return i}}class yc extends xi{constructor(i,f,y,_=1){typeof y=="number"&&(_=y,y=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(i,f,y),this.meshPerAttribute=_}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}toJSON(){const i=super.toJSON();return i.meshPerAttribute=this.meshPerAttribute,i.isInstancedBufferAttribute=!0,i}}yc.prototype.isInstancedBufferAttribute=!0;const E0=new Nt,S3=new Nt,C_=[],I_=new Vo;class A_ extends Vo{constructor(i,f,y){super(i,f),this.instanceMatrix=new yc(new Float32Array(16*y),16),this.instanceColor=null,this.count=y,this.frustumCulled=!1}copy(i){return super.copy(i),this.instanceMatrix.copy(i.instanceMatrix),i.instanceColor!==null&&(this.instanceColor=i.instanceColor.clone()),this.count=i.count,this}getColorAt(i,f){f.fromArray(this.instanceColor.array,3*i)}getMatrixAt(i,f){f.fromArray(this.instanceMatrix.array,16*i)}raycast(i,f){const y=this.matrixWorld,_=this.count;if(I_.geometry=this.geometry,I_.material=this.material,I_.material!==void 0)for(let S=0;S<_;S++){this.getMatrixAt(S,E0),S3.multiplyMatrices(y,E0),I_.matrixWorld=S3,I_.raycast(i,C_);for(let I=0,R=C_.length;I<R;I++){const D=C_[I];D.instanceId=S,D.object=this,f.push(D)}C_.length=0}}setColorAt(i,f){this.instanceColor===null&&(this.instanceColor=new yc(new Float32Array(3*this.instanceMatrix.count),3)),f.toArray(this.instanceColor.array,3*i)}setMatrixAt(i,f){f.toArray(this.instanceMatrix.array,16*i)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}A_.prototype.isInstancedMesh=!0;class Na extends cn{constructor(i){super(),this.type="LineBasicMaterial",this.color=new Xn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.linewidth=i.linewidth,this.linecap=i.linecap,this.linejoin=i.linejoin,this}}Na.prototype.isLineBasicMaterial=!0;const T3=new me,Rv=new me,L_=new Nt,Ah=new rl,lg=new tl;class Cd extends Me{constructor(i=new bi,f=new Na){super(),this.type="Line",this.geometry=i,this.material=f,this.updateMorphTargets()}copy(i){return super.copy(i),this.material=i.material,this.geometry=i.geometry,this}computeLineDistances(){const i=this.geometry;if(i.isBufferGeometry)if(i.index===null){const f=i.attributes.position,y=[0];for(let _=1,S=f.count;_<S;_++)T3.fromBufferAttribute(f,_-1),Rv.fromBufferAttribute(f,_),y[_]=y[_-1],y[_]+=T3.distanceTo(Rv);i.setAttribute("lineDistance",new Pr(y,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else i.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(i,f){const y=this.geometry,_=this.matrixWorld,S=i.params.Line.threshold,I=y.drawRange;if(y.boundingSphere===null&&y.computeBoundingSphere(),lg.copy(y.boundingSphere),lg.applyMatrix4(_),lg.radius+=S,i.ray.intersectsSphere(lg)===!1)return;L_.copy(_).invert(),Ah.copy(i.ray).applyMatrix4(L_);const R=S/((this.scale.x+this.scale.y+this.scale.z)/3),D=R*R,F=new me,G=new me,W=new me,Z=new me,K=this.isLineSegments?2:1;if(y.isBufferGeometry){const oe=y.index,de=y.attributes.position;if(oe!==null)for(let ke=Math.max(0,I.start),pe=Math.min(oe.count,I.start+I.count)-1;ke<pe;ke+=K){const Ve=oe.getX(ke),Ye=oe.getX(ke+1);if(F.fromBufferAttribute(de,Ve),G.fromBufferAttribute(de,Ye),Ah.distanceSqToSegment(F,G,Z,W)>D)continue;Z.applyMatrix4(this.matrixWorld);const $e=i.ray.origin.distanceTo(Z);$e<i.near||$e>i.far||f.push({distance:$e,point:W.clone().applyMatrix4(this.matrixWorld),index:ke,face:null,faceIndex:null,object:this})}else for(let ke=Math.max(0,I.start),pe=Math.min(de.count,I.start+I.count)-1;ke<pe;ke+=K){if(F.fromBufferAttribute(de,ke),G.fromBufferAttribute(de,ke+1),Ah.distanceSqToSegment(F,G,Z,W)>D)continue;Z.applyMatrix4(this.matrixWorld);const Ve=i.ray.origin.distanceTo(Z);Ve<i.near||Ve>i.far||f.push({distance:Ve,point:W.clone().applyMatrix4(this.matrixWorld),index:ke,face:null,faceIndex:null,object:this})}}else y.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const i=this.geometry;if(i.isBufferGeometry){const f=i.morphAttributes,y=Object.keys(f);if(y.length>0){const _=f[y[0]];if(_!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,I=_.length;S<I;S++){const R=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[R]=S}}}}else{const f=i.morphTargets;f!==void 0&&f.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Cd.prototype.isLine=!0;const M3=new me,O9=new me;class qu extends Cd{constructor(i,f){super(i,f),this.type="LineSegments"}computeLineDistances(){const i=this.geometry;if(i.isBufferGeometry)if(i.index===null){const f=i.attributes.position,y=[];for(let _=0,S=f.count;_<S;_+=2)M3.fromBufferAttribute(f,_),O9.fromBufferAttribute(f,_+1),y[_]=_===0?0:y[_-1],y[_+1]=y[_]+M3.distanceTo(O9);i.setAttribute("lineDistance",new Pr(y,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else i.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}qu.prototype.isLineSegments=!0;class k3 extends Cd{constructor(i,f){super(i,f),this.type="LineLoop"}}k3.prototype.isLineLoop=!0;class Rf extends cn{constructor(i){super(),this.type="PointsMaterial",this.color=new Xn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.size=i.size,this.sizeAttenuation=i.sizeAttenuation,this}}Rf.prototype.isPointsMaterial=!0;const S0=new Nt,Wp=new rl,$c=new tl,$u=new me;class Xc extends Me{constructor(i=new bi,f=new Rf){super(),this.type="Points",this.geometry=i,this.material=f,this.updateMorphTargets()}copy(i){return super.copy(i),this.material=i.material,this.geometry=i.geometry,this}raycast(i,f){const y=this.geometry,_=this.matrixWorld,S=i.params.Points.threshold,I=y.drawRange;if(y.boundingSphere===null&&y.computeBoundingSphere(),$c.copy(y.boundingSphere),$c.applyMatrix4(_),$c.radius+=S,i.ray.intersectsSphere($c)===!1)return;S0.copy(_).invert(),Wp.copy(i.ray).applyMatrix4(S0);const R=S/((this.scale.x+this.scale.y+this.scale.z)/3),D=R*R;if(y.isBufferGeometry){const F=y.index,G=y.attributes.position;if(F!==null)for(let W=Math.max(0,I.start),Z=Math.min(F.count,I.start+I.count);W<Z;W++){const K=F.getX(W);$u.fromBufferAttribute(G,K),Nf($u,K,D,_,i,f,this)}else for(let W=Math.max(0,I.start),Z=Math.min(G.count,I.start+I.count);W<Z;W++)$u.fromBufferAttribute(G,W),Nf($u,W,D,_,i,f,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const i=this.geometry;if(i.isBufferGeometry){const f=i.morphAttributes,y=Object.keys(f);if(y.length>0){const _=f[y[0]];if(_!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,I=_.length;S<I;S++){const R=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[R]=S}}}}else{const f=i.morphTargets;f!==void 0&&f.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Nf(M,i,f,y,_,S,I){const R=Wp.distanceSqToPoint(M);if(R<f){const D=new me;Wp.closestPointToPoint(M,D),D.applyMatrix4(y);const F=_.ray.origin.distanceTo(D);if(F<_.near||F>_.far)return;S.push({distance:F,distanceToRay:Math.sqrt(R),point:D,index:i,face:null,object:I})}}Xc.prototype.isPoints=!0;class qp extends le{constructor(i,f,y,_,S,I,R,D,F){super(i,f,y,_,S,I,R,D,F),this.format=R!==void 0?R:1022,this.minFilter=I!==void 0?I:1006,this.magFilter=S!==void 0?S:1006,this.generateMipmaps=!1;const G=this;"requestVideoFrameCallback"in i&&i.requestVideoFrameCallback(function W(){G.needsUpdate=!0,i.requestVideoFrameCallback(W)})}clone(){return new this.constructor(this.image).copy(this)}update(){const i=this.image;!("requestVideoFrameCallback"in i)&&i.readyState>=i.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}qp.prototype.isVideoTexture=!0;class C3 extends le{constructor(i,f,y,_,S,I,R,D,F,G,W,Z){super(null,I,R,D,F,G,_,S,W,Z),this.image={width:f,height:y},this.mipmaps=i,this.flipY=!1,this.generateMipmaps=!1}}C3.prototype.isCompressedTexture=!0;class F9 extends le{constructor(i,f,y,_,S,I,R,D,F){super(i,f,y,_,S,I,R,D,F),this.needsUpdate=!0}}F9.prototype.isCanvasTexture=!0;class z9 extends le{constructor(i,f,y,_,S,I,R,D,F,G){if((G=G!==void 0?G:1026)!==1026&&G!==1027)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");y===void 0&&G===1026&&(y=1012),y===void 0&&G===1027&&(y=1020),super(null,_,S,I,R,D,G,y,F),this.image={width:i,height:f},this.magFilter=R!==void 0?R:1003,this.minFilter=D!==void 0?D:1003,this.flipY=!1,this.generateMipmaps=!1}}z9.prototype.isDepthTexture=!0;class T0 extends bi{constructor(i=1,f=8,y=0,_=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:i,segments:f,thetaStart:y,thetaLength:_},f=Math.max(3,f);const S=[],I=[],R=[],D=[],F=new me,G=new Vn;I.push(0,0,0),R.push(0,0,1),D.push(.5,.5);for(let W=0,Z=3;W<=f;W++,Z+=3){const K=y+W/f*_;F.x=i*Math.cos(K),F.y=i*Math.sin(K),I.push(F.x,F.y,F.z),R.push(0,0,1),G.x=(I[Z]/i+1)/2,G.y=(I[Z+1]/i+1)/2,D.push(G.x,G.y)}for(let W=1;W<=f;W++)S.push(W,W+1,0);this.setIndex(S),this.setAttribute("position",new Pr(I,3)),this.setAttribute("normal",new Pr(R,3)),this.setAttribute("uv",new Pr(D,2))}static fromJSON(i){return new T0(i.radius,i.segments,i.thetaStart,i.thetaLength)}}class Df extends bi{constructor(i=1,f=1,y=1,_=8,S=1,I=!1,R=0,D=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:i,radiusBottom:f,height:y,radialSegments:_,heightSegments:S,openEnded:I,thetaStart:R,thetaLength:D};const F=this;_=Math.floor(_),S=Math.floor(S);const G=[],W=[],Z=[],K=[];let oe=0;const de=[],ke=y/2;let pe=0;function Ve(Ye){const $e=oe,_t=new Vn,bt=new me;let Vt=0;const qt=Ye===!0?i:f,mn=Ye===!0?1:-1;for(let dn=1;dn<=_;dn++)W.push(0,ke*mn,0),Z.push(0,mn,0),K.push(.5,.5),oe++;const sn=oe;for(let dn=0;dn<=_;dn++){const wr=dn/_*D+R,er=Math.cos(wr),Pn=Math.sin(wr);bt.x=qt*Pn,bt.y=ke*mn,bt.z=qt*er,W.push(bt.x,bt.y,bt.z),Z.push(0,mn,0),_t.x=.5*er+.5,_t.y=.5*Pn*mn+.5,K.push(_t.x,_t.y),oe++}for(let dn=0;dn<_;dn++){const wr=$e+dn,er=sn+dn;Ye===!0?G.push(er,er+1,wr):G.push(er+1,er,wr),Vt+=3}F.addGroup(pe,Vt,Ye===!0?1:2),pe+=Vt}(function(){const Ye=new me,$e=new me;let _t=0;const bt=(f-i)/y;for(let Vt=0;Vt<=S;Vt++){const qt=[],mn=Vt/S,sn=mn*(f-i)+i;for(let dn=0;dn<=_;dn++){const wr=dn/_,er=wr*D+R,Pn=Math.sin(er),ir=Math.cos(er);$e.x=sn*Pn,$e.y=-mn*y+ke,$e.z=sn*ir,W.push($e.x,$e.y,$e.z),Ye.set(Pn,bt,ir).normalize(),Z.push(Ye.x,Ye.y,Ye.z),K.push(wr,1-mn),qt.push(oe++)}de.push(qt)}for(let Vt=0;Vt<_;Vt++)for(let qt=0;qt<S;qt++){const mn=de[qt][Vt],sn=de[qt+1][Vt],dn=de[qt+1][Vt+1],wr=de[qt][Vt+1];G.push(mn,sn,wr),G.push(sn,dn,wr),_t+=6}F.addGroup(pe,_t,0),pe+=_t})(),I===!1&&(i>0&&Ve(!0),f>0&&Ve(!1)),this.setIndex(G),this.setAttribute("position",new Pr(W,3)),this.setAttribute("normal",new Pr(Z,3)),this.setAttribute("uv",new Pr(K,2))}static fromJSON(i){return new Df(i.radiusTop,i.radiusBottom,i.height,i.radialSegments,i.heightSegments,i.openEnded,i.thetaStart,i.thetaLength)}}class ug extends Df{constructor(i=1,f=1,y=8,_=1,S=!1,I=0,R=2*Math.PI){super(0,i,f,y,_,S,I,R),this.type="ConeGeometry",this.parameters={radius:i,height:f,radialSegments:y,heightSegments:_,openEnded:S,thetaStart:I,thetaLength:R}}static fromJSON(i){return new ug(i.radius,i.height,i.radialSegments,i.heightSegments,i.openEnded,i.thetaStart,i.thetaLength)}}class Ka extends bi{constructor(i,f,y=1,_=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:i,indices:f,radius:y,detail:_};const S=[],I=[];function R(Z,K,oe,de){const ke=de+1,pe=[];for(let Ve=0;Ve<=ke;Ve++){pe[Ve]=[];const Ye=Z.clone().lerp(oe,Ve/ke),$e=K.clone().lerp(oe,Ve/ke),_t=ke-Ve;for(let bt=0;bt<=_t;bt++)pe[Ve][bt]=bt===0&&Ve===ke?Ye:Ye.clone().lerp($e,bt/_t)}for(let Ve=0;Ve<ke;Ve++)for(let Ye=0;Ye<2*(ke-Ve)-1;Ye++){const $e=Math.floor(Ye/2);Ye%2==0?(D(pe[Ve][$e+1]),D(pe[Ve+1][$e]),D(pe[Ve][$e])):(D(pe[Ve][$e+1]),D(pe[Ve+1][$e+1]),D(pe[Ve+1][$e]))}}function D(Z){S.push(Z.x,Z.y,Z.z)}function F(Z,K){const oe=3*Z;K.x=i[oe+0],K.y=i[oe+1],K.z=i[oe+2]}function G(Z,K,oe,de){de<0&&Z.x===1&&(I[K]=Z.x-1),oe.x===0&&oe.z===0&&(I[K]=de/2/Math.PI+.5)}function W(Z){return Math.atan2(Z.z,-Z.x)}(function(Z){const K=new me,oe=new me,de=new me;for(let ke=0;ke<f.length;ke+=3)F(f[ke+0],K),F(f[ke+1],oe),F(f[ke+2],de),R(K,oe,de,Z)})(_),function(Z){const K=new me;for(let oe=0;oe<S.length;oe+=3)K.x=S[oe+0],K.y=S[oe+1],K.z=S[oe+2],K.normalize().multiplyScalar(Z),S[oe+0]=K.x,S[oe+1]=K.y,S[oe+2]=K.z}(y),function(){const Z=new me;for(let oe=0;oe<S.length;oe+=3){Z.x=S[oe+0],Z.y=S[oe+1],Z.z=S[oe+2];const de=W(Z)/2/Math.PI+.5,ke=(K=Z,Math.atan2(-K.y,Math.sqrt(K.x*K.x+K.z*K.z))/Math.PI+.5);I.push(de,1-ke)}var K;(function(){const oe=new me,de=new me,ke=new me,pe=new me,Ve=new Vn,Ye=new Vn,$e=new Vn;for(let _t=0,bt=0;_t<S.length;_t+=9,bt+=6){oe.set(S[_t+0],S[_t+1],S[_t+2]),de.set(S[_t+3],S[_t+4],S[_t+5]),ke.set(S[_t+6],S[_t+7],S[_t+8]),Ve.set(I[bt+0],I[bt+1]),Ye.set(I[bt+2],I[bt+3]),$e.set(I[bt+4],I[bt+5]),pe.copy(oe).add(de).add(ke).divideScalar(3);const Vt=W(pe);G(Ve,bt+0,oe,Vt),G(Ye,bt+2,de,Vt),G($e,bt+4,ke,Vt)}})(),function(){for(let oe=0;oe<I.length;oe+=6){const de=I[oe+0],ke=I[oe+2],pe=I[oe+4],Ve=Math.max(de,ke,pe),Ye=Math.min(de,ke,pe);Ve>.9&&Ye<.1&&(de<.2&&(I[oe+0]+=1),ke<.2&&(I[oe+2]+=1),pe<.2&&(I[oe+4]+=1))}}()}(),this.setAttribute("position",new Pr(S,3)),this.setAttribute("normal",new Pr(S.slice(),3)),this.setAttribute("uv",new Pr(I,2)),_===0?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(i){return new Ka(i.vertices,i.indices,i.radius,i.details)}}class M0 extends Ka{constructor(i=1,f=0){const y=(1+Math.sqrt(5))/2,_=1/y;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_,-y,0,-_,y,0,_,-y,0,_,y,-_,-y,0,-_,y,0,_,-y,0,_,y,0,-y,0,-_,y,0,-_,-y,0,_,y,0,_],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],i,f),this.type="DodecahedronGeometry",this.parameters={radius:i,detail:f}}static fromJSON(i){return new M0(i.radius,i.detail)}}const Nv=new me,Co=new me,Yr=new me,Lh=new Bn;class k0 extends bi{constructor(i,f){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:f},f=f!==void 0?f:1,i.isGeometry===!0)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const y=Math.pow(10,4),_=Math.cos(Er*f),S=i.getIndex(),I=i.getAttribute("position"),R=S?S.count:I.count,D=[0,0,0],F=["a","b","c"],G=new Array(3),W={},Z=[];for(let K=0;K<R;K+=3){S?(D[0]=S.getX(K),D[1]=S.getX(K+1),D[2]=S.getX(K+2)):(D[0]=K,D[1]=K+1,D[2]=K+2);const{a:oe,b:de,c:ke}=Lh;if(oe.fromBufferAttribute(I,D[0]),de.fromBufferAttribute(I,D[1]),ke.fromBufferAttribute(I,D[2]),Lh.getNormal(Yr),G[0]=`${Math.round(oe.x*y)},${Math.round(oe.y*y)},${Math.round(oe.z*y)}`,G[1]=`${Math.round(de.x*y)},${Math.round(de.y*y)},${Math.round(de.z*y)}`,G[2]=`${Math.round(ke.x*y)},${Math.round(ke.y*y)},${Math.round(ke.z*y)}`,G[0]!==G[1]&&G[1]!==G[2]&&G[2]!==G[0])for(let pe=0;pe<3;pe++){const Ve=(pe+1)%3,Ye=G[pe],$e=G[Ve],_t=Lh[F[pe]],bt=Lh[F[Ve]],Vt=`${Ye}_${$e}`,qt=`${$e}_${Ye}`;qt in W&&W[qt]?(Yr.dot(W[qt].normal)<=_&&(Z.push(_t.x,_t.y,_t.z),Z.push(bt.x,bt.y,bt.z)),W[qt]=null):Vt in W||(W[Vt]={index0:D[pe],index1:D[Ve],normal:Yr.clone()})}}for(const K in W)if(W[K]){const{index0:oe,index1:de}=W[K];Nv.fromBufferAttribute(I,oe),Co.fromBufferAttribute(I,de),Z.push(Nv.x,Nv.y,Nv.z),Z.push(Co.x,Co.y,Co.z)}this.setAttribute("position",new Pr(Z,3))}}class Io{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(i,f){const y=this.getUtoTmapping(i);return this.getPoint(y,f)}getPoints(i=5){const f=[];for(let y=0;y<=i;y++)f.push(this.getPoint(y/i));return f}getSpacedPoints(i=5){const f=[];for(let y=0;y<=i;y++)f.push(this.getPointAt(y/i));return f}getLength(){const i=this.getLengths();return i[i.length-1]}getLengths(i=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===i+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const f=[];let y,_=this.getPoint(0),S=0;f.push(0);for(let I=1;I<=i;I++)y=this.getPoint(I/i),S+=y.distanceTo(_),f.push(S),_=y;return this.cacheArcLengths=f,f}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(i,f){const y=this.getLengths();let _=0;const S=y.length;let I;I=f||i*y[S-1];let R,D=0,F=S-1;for(;D<=F;)if(_=Math.floor(D+(F-D)/2),R=y[_]-I,R<0)D=_+1;else{if(!(R>0)){F=_;break}F=_-1}if(_=F,y[_]===I)return _/(S-1);const G=y[_];return(_+(I-G)/(y[_+1]-G))/(S-1)}getTangent(i,f){let _=i-1e-4,S=i+1e-4;_<0&&(_=0),S>1&&(S=1);const I=this.getPoint(_),R=this.getPoint(S),D=f||(I.isVector2?new Vn:new me);return D.copy(R).sub(I).normalize(),D}getTangentAt(i,f){const y=this.getUtoTmapping(i);return this.getTangent(y,f)}computeFrenetFrames(i,f){const y=new me,_=[],S=[],I=[],R=new me,D=new Nt;for(let K=0;K<=i;K++){const oe=K/i;_[K]=this.getTangentAt(oe,new me),_[K].normalize()}S[0]=new me,I[0]=new me;let F=Number.MAX_VALUE;const G=Math.abs(_[0].x),W=Math.abs(_[0].y),Z=Math.abs(_[0].z);G<=F&&(F=G,y.set(1,0,0)),W<=F&&(F=W,y.set(0,1,0)),Z<=F&&y.set(0,0,1),R.crossVectors(_[0],y).normalize(),S[0].crossVectors(_[0],R),I[0].crossVectors(_[0],S[0]);for(let K=1;K<=i;K++){if(S[K]=S[K-1].clone(),I[K]=I[K-1].clone(),R.crossVectors(_[K-1],_[K]),R.length()>Number.EPSILON){R.normalize();const oe=Math.acos(Fr(_[K-1].dot(_[K]),-1,1));S[K].applyMatrix4(D.makeRotationAxis(R,oe))}I[K].crossVectors(_[K],S[K])}if(f===!0){let K=Math.acos(Fr(S[0].dot(S[i]),-1,1));K/=i,_[0].dot(R.crossVectors(S[0],S[i]))>0&&(K=-K);for(let oe=1;oe<=i;oe++)S[oe].applyMatrix4(D.makeRotationAxis(_[oe],K*oe)),I[oe].crossVectors(_[oe],S[oe])}return{tangents:_,normals:S,binormals:I}}clone(){return new this.constructor().copy(this)}copy(i){return this.arcLengthDivisions=i.arcLengthDivisions,this}toJSON(){const i={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return i.arcLengthDivisions=this.arcLengthDivisions,i.type=this.type,i}fromJSON(i){return this.arcLengthDivisions=i.arcLengthDivisions,this}}class C0 extends Io{constructor(i=0,f=0,y=1,_=1,S=0,I=2*Math.PI,R=!1,D=0){super(),this.type="EllipseCurve",this.aX=i,this.aY=f,this.xRadius=y,this.yRadius=_,this.aStartAngle=S,this.aEndAngle=I,this.aClockwise=R,this.aRotation=D}getPoint(i,f){const y=f||new Vn,_=2*Math.PI;let S=this.aEndAngle-this.aStartAngle;const I=Math.abs(S)<Number.EPSILON;for(;S<0;)S+=_;for(;S>_;)S-=_;S<Number.EPSILON&&(S=I?0:_),this.aClockwise!==!0||I||(S===_?S=-_:S-=_);const R=this.aStartAngle+i*S;let D=this.aX+this.xRadius*Math.cos(R),F=this.aY+this.yRadius*Math.sin(R);if(this.aRotation!==0){const G=Math.cos(this.aRotation),W=Math.sin(this.aRotation),Z=D-this.aX,K=F-this.aY;D=Z*G-K*W+this.aX,F=Z*W+K*G+this.aY}return y.set(D,F)}copy(i){return super.copy(i),this.aX=i.aX,this.aY=i.aY,this.xRadius=i.xRadius,this.yRadius=i.yRadius,this.aStartAngle=i.aStartAngle,this.aEndAngle=i.aEndAngle,this.aClockwise=i.aClockwise,this.aRotation=i.aRotation,this}toJSON(){const i=super.toJSON();return i.aX=this.aX,i.aY=this.aY,i.xRadius=this.xRadius,i.yRadius=this.yRadius,i.aStartAngle=this.aStartAngle,i.aEndAngle=this.aEndAngle,i.aClockwise=this.aClockwise,i.aRotation=this.aRotation,i}fromJSON(i){return super.fromJSON(i),this.aX=i.aX,this.aY=i.aY,this.xRadius=i.xRadius,this.yRadius=i.yRadius,this.aStartAngle=i.aStartAngle,this.aEndAngle=i.aEndAngle,this.aClockwise=i.aClockwise,this.aRotation=i.aRotation,this}}C0.prototype.isEllipseCurve=!0;class Dv extends C0{constructor(i,f,y,_,S,I){super(i,f,y,y,_,S,I),this.type="ArcCurve"}}function _c(){let M=0,i=0,f=0,y=0;function _(S,I,R,D){M=S,i=R,f=-3*S+3*I-2*R-D,y=2*S-2*I+R+D}return{initCatmullRom:function(S,I,R,D,F){_(I,R,F*(R-S),F*(D-I))},initNonuniformCatmullRom:function(S,I,R,D,F,G,W){let Z=(I-S)/F-(R-S)/(F+G)+(R-I)/G,K=(R-I)/G-(D-I)/(G+W)+(D-R)/W;Z*=G,K*=G,_(I,R,Z,K)},calc:function(S){const I=S*S;return M+i*S+f*I+y*(I*S)}}}Dv.prototype.isArcCurve=!0;const I0=new me,Of=new _c,cg=new _c,Ff=new _c;class P_ extends Io{constructor(i=[],f=!1,y="centripetal",_=.5){super(),this.type="CatmullRomCurve3",this.points=i,this.closed=f,this.curveType=y,this.tension=_}getPoint(i,f=new me){const y=f,_=this.points,S=_.length,I=(S-(this.closed?0:1))*i;let R,D,F=Math.floor(I),G=I-F;this.closed?F+=F>0?0:(Math.floor(Math.abs(F)/S)+1)*S:G===0&&F===S-1&&(F=S-2,G=1),this.closed||F>0?R=_[(F-1)%S]:(I0.subVectors(_[0],_[1]).add(_[0]),R=I0);const W=_[F%S],Z=_[(F+1)%S];if(this.closed||F+2<S?D=_[(F+2)%S]:(I0.subVectors(_[S-1],_[S-2]).add(_[S-1]),D=I0),this.curveType==="centripetal"||this.curveType==="chordal"){const K=this.curveType==="chordal"?.5:.25;let oe=Math.pow(R.distanceToSquared(W),K),de=Math.pow(W.distanceToSquared(Z),K),ke=Math.pow(Z.distanceToSquared(D),K);de<1e-4&&(de=1),oe<1e-4&&(oe=de),ke<1e-4&&(ke=de),Of.initNonuniformCatmullRom(R.x,W.x,Z.x,D.x,oe,de,ke),cg.initNonuniformCatmullRom(R.y,W.y,Z.y,D.y,oe,de,ke),Ff.initNonuniformCatmullRom(R.z,W.z,Z.z,D.z,oe,de,ke)}else this.curveType==="catmullrom"&&(Of.initCatmullRom(R.x,W.x,Z.x,D.x,this.tension),cg.initCatmullRom(R.y,W.y,Z.y,D.y,this.tension),Ff.initCatmullRom(R.z,W.z,Z.z,D.z,this.tension));return y.set(Of.calc(G),cg.calc(G),Ff.calc(G)),y}copy(i){super.copy(i),this.points=[];for(let f=0,y=i.points.length;f<y;f++){const _=i.points[f];this.points.push(_.clone())}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}toJSON(){const i=super.toJSON();i.points=[];for(let f=0,y=this.points.length;f<y;f++){const _=this.points[f];i.points.push(_.toArray())}return i.closed=this.closed,i.curveType=this.curveType,i.tension=this.tension,i}fromJSON(i){super.fromJSON(i),this.points=[];for(let f=0,y=i.points.length;f<y;f++){const _=i.points[f];this.points.push(new me().fromArray(_))}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}}function R_(M,i,f,y,_){const S=.5*(y-i),I=.5*(_-f),R=M*M;return(2*f-2*y+S+I)*(M*R)+(-3*f+3*y-2*S-I)*R+S*M+f}function A0(M,i,f,y){return function(_,S){const I=1-_;return I*I*S}(M,i)+function(_,S){return 2*(1-_)*_*S}(M,f)+function(_,S){return _*_*S}(M,y)}function L0(M,i,f,y,_){return function(S,I){const R=1-S;return R*R*R*I}(M,i)+function(S,I){const R=1-S;return 3*R*R*S*I}(M,f)+function(S,I){return 3*(1-S)*S*S*I}(M,y)+function(S,I){return S*S*S*I}(M,_)}P_.prototype.isCatmullRomCurve3=!0;class Ov extends Io{constructor(i=new Vn,f=new Vn,y=new Vn,_=new Vn){super(),this.type="CubicBezierCurve",this.v0=i,this.v1=f,this.v2=y,this.v3=_}getPoint(i,f=new Vn){const y=f,_=this.v0,S=this.v1,I=this.v2,R=this.v3;return y.set(L0(i,_.x,S.x,I.x,R.x),L0(i,_.y,S.y,I.y,R.y)),y}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this.v3.copy(i.v3),this}toJSON(){const i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i.v3=this.v3.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this.v3.fromArray(i.v3),this}}Ov.prototype.isCubicBezierCurve=!0;class N_ extends Io{constructor(i=new me,f=new me,y=new me,_=new me){super(),this.type="CubicBezierCurve3",this.v0=i,this.v1=f,this.v2=y,this.v3=_}getPoint(i,f=new me){const y=f,_=this.v0,S=this.v1,I=this.v2,R=this.v3;return y.set(L0(i,_.x,S.x,I.x,R.x),L0(i,_.y,S.y,I.y,R.y),L0(i,_.z,S.z,I.z,R.z)),y}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this.v3.copy(i.v3),this}toJSON(){const i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i.v3=this.v3.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this.v3.fromArray(i.v3),this}}N_.prototype.isCubicBezierCurve3=!0;class P0 extends Io{constructor(i=new Vn,f=new Vn){super(),this.type="LineCurve",this.v1=i,this.v2=f}getPoint(i,f=new Vn){const y=f;return i===1?y.copy(this.v2):(y.copy(this.v2).sub(this.v1),y.multiplyScalar(i).add(this.v1)),y}getPointAt(i,f){return this.getPoint(i,f)}getTangent(i,f){const y=f||new Vn;return y.copy(this.v2).sub(this.v1).normalize(),y}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}}P0.prototype.isLineCurve=!0;class R0 extends Io{constructor(i=new me,f=new me){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=i,this.v2=f}getPoint(i,f=new me){const y=f;return i===1?y.copy(this.v2):(y.copy(this.v2).sub(this.v1),y.multiplyScalar(i).add(this.v1)),y}getPointAt(i,f){return this.getPoint(i,f)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}}class zf extends Io{constructor(i=new Vn,f=new Vn,y=new Vn){super(),this.type="QuadraticBezierCurve",this.v0=i,this.v1=f,this.v2=y}getPoint(i,f=new Vn){const y=f,_=this.v0,S=this.v1,I=this.v2;return y.set(A0(i,_.x,S.x,I.x),A0(i,_.y,S.y,I.y)),y}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}}zf.prototype.isQuadraticBezierCurve=!0;class Ph extends Io{constructor(i=new me,f=new me,y=new me){super(),this.type="QuadraticBezierCurve3",this.v0=i,this.v1=f,this.v2=y}getPoint(i,f=new me){const y=f,_=this.v0,S=this.v1,I=this.v2;return y.set(A0(i,_.x,S.x,I.x),A0(i,_.y,S.y,I.y),A0(i,_.z,S.z,I.z)),y}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){const i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}}Ph.prototype.isQuadraticBezierCurve3=!0;class N0 extends Io{constructor(i=[]){super(),this.type="SplineCurve",this.points=i}getPoint(i,f=new Vn){const y=f,_=this.points,S=(_.length-1)*i,I=Math.floor(S),R=S-I,D=_[I===0?I:I-1],F=_[I],G=_[I>_.length-2?_.length-1:I+1],W=_[I>_.length-3?_.length-1:I+2];return y.set(R_(R,D.x,F.x,G.x,W.x),R_(R,D.y,F.y,G.y,W.y)),y}copy(i){super.copy(i),this.points=[];for(let f=0,y=i.points.length;f<y;f++){const _=i.points[f];this.points.push(_.clone())}return this}toJSON(){const i=super.toJSON();i.points=[];for(let f=0,y=this.points.length;f<y;f++){const _=this.points[f];i.points.push(_.toArray())}return i}fromJSON(i){super.fromJSON(i),this.points=[];for(let f=0,y=i.points.length;f<y;f++){const _=i.points[f];this.points.push(new Vn().fromArray(_))}return this}}N0.prototype.isSplineCurve=!0;var Fv=Object.freeze({__proto__:null,ArcCurve:Dv,CatmullRomCurve3:P_,CubicBezierCurve:Ov,CubicBezierCurve3:N_,EllipseCurve:C0,LineCurve:P0,LineCurve3:R0,QuadraticBezierCurve:zf,QuadraticBezierCurve3:Ph,SplineCurve:N0});const D_=function(M,i,f=2){const y=i&&i.length,_=y?i[0]*f:M.length;let S=D0(M,0,_,f,!0);const I=[];if(!S||S.next===S.prev)return I;let R,D,F,G,W,Z,K;if(y&&(S=function(oe,de,ke,pe){const Ve=[];let Ye,$e,_t,bt,Vt;for(Ye=0,$e=de.length;Ye<$e;Ye++)_t=de[Ye]*pe,bt=Ye<$e-1?de[Ye+1]*pe:oe.length,Vt=D0(oe,_t,bt,pe,!1),Vt===Vt.next&&(Vt.steiner=!0),Ve.push(VM(Vt));for(Ve.sort(B9),Ye=0;Ye<Ve.length;Ye++)O_(Ve[Ye],ke),ke=Ja(ke,ke.next);return ke}(M,i,S,f)),M.length>80*f){R=F=M[0],D=G=M[1];for(let oe=f;oe<_;oe+=f)W=M[oe],Z=M[oe+1],W<R&&(R=W),Z<D&&(D=Z),W>F&&(F=W),Z>G&&(G=Z);K=Math.max(F-R,G-D),K=K!==0?1/K:0}return Bf(S,I,f,R,D,K),I};function D0(M,i,f,y,_){let S,I;if(_===function(R,D,F,G){let W=0;for(let Z=D,K=F-G;Z<F;Z+=G)W+=(R[K]-R[Z])*(R[Z+1]+R[K+1]),K=Z;return W}(M,i,f,y)>0)for(S=i;S<f;S+=y)I=P3(S,M[S],M[S+1],I);else for(S=f-y;S>=i;S-=y)I=P3(S,M[S],M[S+1],I);return I&&F_(I,I.next)&&(O0(I),I=I.next),I}function Ja(M,i){if(!M)return M;i||(i=M);let f,y=M;do if(f=!1,y.steiner||!F_(y,y.next)&&no(y.prev,y,y.next)!==0)y=y.next;else{if(O0(y),y=i=y.prev,y===y.next)break;f=!0}while(f||y!==i);return i}function Bf(M,i,f,y,_,S,I){if(!M)return;!I&&S&&function(G,W,Z,K){let oe=G;do oe.z===null&&(oe.z=A3(oe.x,oe.y,W,Z,K)),oe.prevZ=oe.prev,oe.nextZ=oe.next,oe=oe.next;while(oe!==G);oe.prevZ.nextZ=null,oe.prevZ=null,function(de){let ke,pe,Ve,Ye,$e,_t,bt,Vt,qt=1;do{for(pe=de,de=null,$e=null,_t=0;pe;){for(_t++,Ve=pe,bt=0,ke=0;ke<qt&&(bt++,Ve=Ve.nextZ,Ve);ke++);for(Vt=qt;bt>0||Vt>0&&Ve;)bt!==0&&(Vt===0||!Ve||pe.z<=Ve.z)?(Ye=pe,pe=pe.nextZ,bt--):(Ye=Ve,Ve=Ve.nextZ,Vt--),$e?$e.nextZ=Ye:de=Ye,Ye.prevZ=$e,$e=Ye;pe=Ve}$e.nextZ=null,qt*=2}while(_t>1)}(oe)}(M,y,_,S);let R,D,F=M;for(;M.prev!==M.next;)if(R=M.prev,D=M.next,S?Zc(M,y,_,S):su(M))i.push(R.i/f),i.push(M.i/f),i.push(D.i/f),O0(M),M=D.next,F=D.next;else if((M=D)===F){I?I===1?Bf(M=I3(Ja(M),i,f),i,f,y,_,S,2):I===2&&Ho(M,i,f,y,_,S):Bf(Ja(M),i,f,y,_,S,1);break}}function su(M){const i=M.prev,f=M,y=M.next;if(no(i,f,y)>=0)return!1;let _=M.next.next;for(;_!==M.prev;){if(hg(i.x,i.y,f.x,f.y,y.x,y.y,_.x,_.y)&&no(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Zc(M,i,f,y){const _=M.prev,S=M,I=M.next;if(no(_,S,I)>=0)return!1;const R=_.x<S.x?_.x<I.x?_.x:I.x:S.x<I.x?S.x:I.x,D=_.y<S.y?_.y<I.y?_.y:I.y:S.y<I.y?S.y:I.y,F=_.x>S.x?_.x>I.x?_.x:I.x:S.x>I.x?S.x:I.x,G=_.y>S.y?_.y>I.y?_.y:I.y:S.y>I.y?S.y:I.y,W=A3(R,D,i,f,y),Z=A3(F,G,i,f,y);let K=M.prevZ,oe=M.nextZ;for(;K&&K.z>=W&&oe&&oe.z<=Z;){if(K!==M.prev&&K!==M.next&&hg(_.x,_.y,S.x,S.y,I.x,I.y,K.x,K.y)&&no(K.prev,K,K.next)>=0||(K=K.prevZ,oe!==M.prev&&oe!==M.next&&hg(_.x,_.y,S.x,S.y,I.x,I.y,oe.x,oe.y)&&no(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;K&&K.z>=W;){if(K!==M.prev&&K!==M.next&&hg(_.x,_.y,S.x,S.y,I.x,I.y,K.x,K.y)&&no(K.prev,K,K.next)>=0)return!1;K=K.prevZ}for(;oe&&oe.z<=Z;){if(oe!==M.prev&&oe!==M.next&&hg(_.x,_.y,S.x,S.y,I.x,I.y,oe.x,oe.y)&&no(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function I3(M,i,f){let y=M;do{const _=y.prev,S=y.next.next;!F_(_,S)&&L3(_,y,y.next,S)&&U_(_,S)&&U_(S,_)&&(i.push(_.i/f),i.push(y.i/f),i.push(S.i/f),O0(y),O0(y.next),y=M=S),y=y.next}while(y!==M);return Ja(y)}function Ho(M,i,f,y,_,S){let I=M;do{let R=I.next.next;for(;R!==I.prev;){if(I.i!==R.i&&U9(I,R)){let D=j9(I,R);return I=Ja(I,I.next),D=Ja(D,D.next),Bf(I,i,f,y,_,S),void Bf(D,i,f,y,_,S)}R=R.next}I=I.next}while(I!==M)}function B9(M,i){return M.x-i.x}function O_(M,i){if(i=function(f,y){let _=y;const S=f.x,I=f.y;let R,D=-1/0;do{if(I<=_.y&&I>=_.next.y&&_.next.y!==_.y){const oe=_.x+(I-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(oe<=S&&oe>D){if(D=oe,oe===S){if(I===_.y)return _;if(I===_.next.y)return _.next}R=_.x<_.next.x?_:_.next}}_=_.next}while(_!==y);if(!R)return null;if(S===D)return R;const F=R,G=R.x,W=R.y;let Z,K=1/0;_=R;do S>=_.x&&_.x>=G&&S!==_.x&&hg(I<W?S:D,I,G,W,I<W?D:S,I,_.x,_.y)&&(Z=Math.abs(I-_.y)/(S-_.x),U_(_,f)&&(Z<K||Z===K&&(_.x>R.x||_.x===R.x&&Rh(R,_)))&&(R=_,K=Z)),_=_.next;while(_!==F);return R}(M,i)){const f=j9(i,M);Ja(i,i.next),Ja(f,f.next)}}function Rh(M,i){return no(M.prev,M,i.prev)<0&&no(i.next,M,M.next)<0}function A3(M,i,f,y,_){return(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-f)*_)|M<<8))|M<<4))|M<<2))|M<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-y)*_)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function VM(M){let i=M,f=M;do(i.x<f.x||i.x===f.x&&i.y<f.y)&&(f=i),i=i.next;while(i!==M);return f}function hg(M,i,f,y,_,S,I,R){return(_-I)*(i-R)-(M-I)*(S-R)>=0&&(M-I)*(y-R)-(f-I)*(i-R)>=0&&(f-I)*(S-R)-(_-I)*(y-R)>=0}function U9(M,i){return M.next.i!==i.i&&M.prev.i!==i.i&&!function(f,y){let _=f;do{if(_.i!==f.i&&_.next.i!==f.i&&_.i!==y.i&&_.next.i!==y.i&&L3(_,_.next,f,y))return!0;_=_.next}while(_!==f);return!1}(M,i)&&(U_(M,i)&&U_(i,M)&&function(f,y){let _=f,S=!1;const I=(f.x+y.x)/2,R=(f.y+y.y)/2;do _.y>R!=_.next.y>R&&_.next.y!==_.y&&I<(_.next.x-_.x)*(R-_.y)/(_.next.y-_.y)+_.x&&(S=!S),_=_.next;while(_!==f);return S}(M,i)&&(no(M.prev,M,i.prev)||no(M,i.prev,i))||F_(M,i)&&no(M.prev,M,M.next)>0&&no(i.prev,i,i.next)>0)}function no(M,i,f){return(i.y-M.y)*(f.x-i.x)-(i.x-M.x)*(f.y-i.y)}function F_(M,i){return M.x===i.x&&M.y===i.y}function L3(M,i,f,y){const _=B_(no(M,i,f)),S=B_(no(M,i,y)),I=B_(no(f,y,M)),R=B_(no(f,y,i));return _!==S&&I!==R||!(_!==0||!z_(M,f,i))||!(S!==0||!z_(M,y,i))||!(I!==0||!z_(f,M,y))||!(R!==0||!z_(f,i,y))}function z_(M,i,f){return i.x<=Math.max(M.x,f.x)&&i.x>=Math.min(M.x,f.x)&&i.y<=Math.max(M.y,f.y)&&i.y>=Math.min(M.y,f.y)}function B_(M){return M>0?1:M<0?-1:0}function U_(M,i){return no(M.prev,M,M.next)<0?no(M,i,M.next)>=0&&no(M,M.prev,i)>=0:no(M,i,M.prev)<0||no(M,M.next,i)<0}function j9(M,i){const f=new dg(M.i,M.x,M.y),y=new dg(i.i,i.x,i.y),_=M.next,S=i.prev;return M.next=i,i.prev=M,f.next=_,_.prev=f,y.next=f,f.prev=y,S.next=y,y.prev=S,y}function P3(M,i,f,y){const _=new dg(M,i,f);return y?(_.next=y.next,_.prev=y,y.next.prev=_,y.next=_):(_.prev=_,_.next=_),_}function O0(M){M.next.prev=M.prev,M.prev.next=M.next,M.prevZ&&(M.prevZ.nextZ=M.nextZ),M.nextZ&&(M.nextZ.prevZ=M.prevZ)}function dg(M,i,f){this.i=M,this.x=i,this.y=f,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Yc{static area(i){const f=i.length;let y=0;for(let _=f-1,S=0;S<f;_=S++)y+=i[_].x*i[S].y-i[S].x*i[_].y;return .5*y}static isClockWise(i){return Yc.area(i)<0}static triangulateShape(i,f){const y=[],_=[],S=[];zv(i),Bv(y,i);let I=i.length;f.forEach(zv);for(let D=0;D<f.length;D++)_.push(I),I+=f[D].length,Bv(y,f[D]);const R=D_(y,_);for(let D=0;D<R.length;D+=3)S.push(R.slice(D,D+3));return S}}function zv(M){const i=M.length;i>2&&M[i-1].equals(M[0])&&M.pop()}function Bv(M,i){for(let f=0;f<i.length;f++)M.push(i[f].x),M.push(i[f].y)}class Ao extends bi{constructor(i,f){super(),this.type="ExtrudeGeometry",this.parameters={shapes:i,options:f},i=Array.isArray(i)?i:[i];const y=this,_=[],S=[];for(let R=0,D=i.length;R<D;R++)I(i[R]);function I(R){const D=[],F=f.curveSegments!==void 0?f.curveSegments:12,G=f.steps!==void 0?f.steps:1;let W=f.depth!==void 0?f.depth:100,Z=f.bevelEnabled===void 0||f.bevelEnabled,K=f.bevelThickness!==void 0?f.bevelThickness:6,oe=f.bevelSize!==void 0?f.bevelSize:K-2,de=f.bevelOffset!==void 0?f.bevelOffset:0,ke=f.bevelSegments!==void 0?f.bevelSegments:3;const pe=f.extrudePath,Ve=f.UVGenerator!==void 0?f.UVGenerator:R3;f.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),W=f.amount);let Ye,$e,_t,bt,Vt,qt=!1;pe&&(Ye=pe.getSpacedPoints(G),qt=!0,Z=!1,$e=pe.computeFrenetFrames(G,!1),_t=new me,bt=new me,Vt=new me),Z||(ke=0,K=0,oe=0,de=0);const mn=R.extractPoints(F);let sn=mn.shape;const dn=mn.holes;if(!Yc.isClockWise(sn)){sn=sn.reverse();for(let hn=0,dt=dn.length;hn<dt;hn++){const an=dn[hn];Yc.isClockWise(an)&&(dn[hn]=an.reverse())}}const wr=Yc.triangulateShape(sn,dn),er=sn;for(let hn=0,dt=dn.length;hn<dt;hn++){const an=dn[hn];sn=sn.concat(an)}function Pn(hn,dt,an){return dt||console.error("THREE.ExtrudeGeometry: vec does not exist"),dt.clone().multiplyScalar(an).add(hn)}const ir=sn.length,Or=wr.length;function jr(hn,dt,an){let Un,Kn,Hn;const Wr=hn.x-dt.x,ci=hn.y-dt.y,Jr=an.x-hn.x,Vr=an.y-hn.y,Fi=Wr*Wr+ci*ci,ol=Wr*Vr-ci*Jr;if(Math.abs(ol)>Number.EPSILON){const Ks=Math.sqrt(Fi),Lo=Math.sqrt(Jr*Jr+Vr*Vr),Tl=dt.x-ci/Ks,em=dt.y+Wr/Ks,Sg=((an.x-Vr/Lo-Tl)*Vr-(an.y+Jr/Lo-em)*Jr)/(Wr*Vr-ci*Jr);Un=Tl+Wr*Sg-hn.x,Kn=em+ci*Sg-hn.y;const Tg=Un*Un+Kn*Kn;if(Tg<=2)return new Vn(Un,Kn);Hn=Math.sqrt(Tg/2)}else{let Ks=!1;Wr>Number.EPSILON?Jr>Number.EPSILON&&(Ks=!0):Wr<-Number.EPSILON?Jr<-Number.EPSILON&&(Ks=!0):Math.sign(ci)===Math.sign(Vr)&&(Ks=!0),Ks?(Un=-ci,Kn=Wr,Hn=Math.sqrt(Fi)):(Un=Wr,Kn=ci,Hn=Math.sqrt(Fi/2))}return new Vn(Un/Hn,Kn/Hn)}const si=[];for(let hn=0,dt=er.length,an=dt-1,Un=hn+1;hn<dt;hn++,an++,Un++)an===dt&&(an=0),Un===dt&&(Un=0),si[hn]=jr(er[hn],er[an],er[Un]);const gi=[];let yi,sr=si.concat();for(let hn=0,dt=dn.length;hn<dt;hn++){const an=dn[hn];yi=[];for(let Un=0,Kn=an.length,Hn=Kn-1,Wr=Un+1;Un<Kn;Un++,Hn++,Wr++)Hn===Kn&&(Hn=0),Wr===Kn&&(Wr=0),yi[Un]=jr(an[Un],an[Hn],an[Wr]);gi.push(yi),sr=sr.concat(yi)}for(let hn=0;hn<ke;hn++){const dt=hn/ke,an=K*Math.cos(dt*Math.PI/2),Un=oe*Math.sin(dt*Math.PI/2)+de;for(let Kn=0,Hn=er.length;Kn<Hn;Kn++){const Wr=Pn(er[Kn],si[Kn],Un);Fn(Wr.x,Wr.y,-an)}for(let Kn=0,Hn=dn.length;Kn<Hn;Kn++){const Wr=dn[Kn];yi=gi[Kn];for(let ci=0,Jr=Wr.length;ci<Jr;ci++){const Vr=Pn(Wr[ci],yi[ci],Un);Fn(Vr.x,Vr.y,-an)}}}const xt=oe+de;for(let hn=0;hn<ir;hn++){const dt=Z?Pn(sn[hn],sr[hn],xt):sn[hn];qt?(bt.copy($e.normals[0]).multiplyScalar(dt.x),_t.copy($e.binormals[0]).multiplyScalar(dt.y),Vt.copy(Ye[0]).add(bt).add(_t),Fn(Vt.x,Vt.y,Vt.z)):Fn(dt.x,dt.y,0)}for(let hn=1;hn<=G;hn++)for(let dt=0;dt<ir;dt++){const an=Z?Pn(sn[dt],sr[dt],xt):sn[dt];qt?(bt.copy($e.normals[hn]).multiplyScalar(an.x),_t.copy($e.binormals[hn]).multiplyScalar(an.y),Vt.copy(Ye[hn]).add(bt).add(_t),Fn(Vt.x,Vt.y,Vt.z)):Fn(an.x,an.y,W/G*hn)}for(let hn=ke-1;hn>=0;hn--){const dt=hn/ke,an=K*Math.cos(dt*Math.PI/2),Un=oe*Math.sin(dt*Math.PI/2)+de;for(let Kn=0,Hn=er.length;Kn<Hn;Kn++){const Wr=Pn(er[Kn],si[Kn],Un);Fn(Wr.x,Wr.y,W+an)}for(let Kn=0,Hn=dn.length;Kn<Hn;Kn++){const Wr=dn[Kn];yi=gi[Kn];for(let ci=0,Jr=Wr.length;ci<Jr;ci++){const Vr=Pn(Wr[ci],yi[ci],Un);qt?Fn(Vr.x,Vr.y+Ye[G-1].y,Ye[G-1].x+an):Fn(Vr.x,Vr.y,W+an)}}}function Pt(hn,dt){let an=hn.length;for(;--an>=0;){const Un=an;let Kn=an-1;Kn<0&&(Kn=hn.length-1);for(let Hn=0,Wr=G+2*ke;Hn<Wr;Hn++){const ci=ir*Hn,Jr=ir*(Hn+1);rn(dt+Un+ci,dt+Kn+ci,dt+Kn+Jr,dt+Un+Jr)}}}function Fn(hn,dt,an){D.push(hn),D.push(dt),D.push(an)}function ln(hn,dt,an){yr(hn),yr(dt),yr(an);const Un=_.length/3,Kn=Ve.generateTopUV(y,_,Un-3,Un-2,Un-1);dr(Kn[0]),dr(Kn[1]),dr(Kn[2])}function rn(hn,dt,an,Un){yr(hn),yr(dt),yr(Un),yr(dt),yr(an),yr(Un);const Kn=_.length/3,Hn=Ve.generateSideWallUV(y,_,Kn-6,Kn-3,Kn-2,Kn-1);dr(Hn[0]),dr(Hn[1]),dr(Hn[3]),dr(Hn[1]),dr(Hn[2]),dr(Hn[3])}function yr(hn){_.push(D[3*hn+0]),_.push(D[3*hn+1]),_.push(D[3*hn+2])}function dr(hn){S.push(hn.x),S.push(hn.y)}(function(){const hn=_.length/3;if(Z){let dt=0,an=ir*dt;for(let Un=0;Un<Or;Un++){const Kn=wr[Un];ln(Kn[2]+an,Kn[1]+an,Kn[0]+an)}dt=G+2*ke,an=ir*dt;for(let Un=0;Un<Or;Un++){const Kn=wr[Un];ln(Kn[0]+an,Kn[1]+an,Kn[2]+an)}}else{for(let dt=0;dt<Or;dt++){const an=wr[dt];ln(an[2],an[1],an[0])}for(let dt=0;dt<Or;dt++){const an=wr[dt];ln(an[0]+ir*G,an[1]+ir*G,an[2]+ir*G)}}y.addGroup(hn,_.length/3-hn,0)})(),function(){const hn=_.length/3;let dt=0;Pt(er,dt),dt+=er.length;for(let an=0,Un=dn.length;an<Un;an++){const Kn=dn[an];Pt(Kn,dt),dt+=Kn.length}y.addGroup(hn,_.length/3-hn,1)}()}this.setAttribute("position",new Pr(_,3)),this.setAttribute("uv",new Pr(S,2)),this.computeVertexNormals()}toJSON(){const i=super.toJSON();return function(f,y,_){if(_.shapes=[],Array.isArray(f))for(let S=0,I=f.length;S<I;S++){const R=f[S];_.shapes.push(R.uuid)}else _.shapes.push(f.uuid);return y.extrudePath!==void 0&&(_.options.extrudePath=y.extrudePath.toJSON()),_}(this.parameters.shapes,this.parameters.options,i)}static fromJSON(i,f){const y=[];for(let S=0,I=i.shapes.length;S<I;S++){const R=f[i.shapes[S]];y.push(R)}const _=i.options.extrudePath;return _!==void 0&&(i.options.extrudePath=new Fv[_.type]().fromJSON(_)),new Ao(y,i.options)}}const R3={generateTopUV:function(M,i,f,y,_){const S=i[3*f],I=i[3*f+1],R=i[3*y],D=i[3*y+1],F=i[3*_],G=i[3*_+1];return[new Vn(S,I),new Vn(R,D),new Vn(F,G)]},generateSideWallUV:function(M,i,f,y,_,S){const I=i[3*f],R=i[3*f+1],D=i[3*f+2],F=i[3*y],G=i[3*y+1],W=i[3*y+2],Z=i[3*_],K=i[3*_+1],oe=i[3*_+2],de=i[3*S],ke=i[3*S+1],pe=i[3*S+2];return Math.abs(R-G)<Math.abs(I-F)?[new Vn(I,1-D),new Vn(F,1-W),new Vn(Z,1-oe),new Vn(de,1-pe)]:[new Vn(R,1-D),new Vn(G,1-W),new Vn(K,1-oe),new Vn(ke,1-pe)]}};class fg extends Ka{constructor(i=1,f=0){const y=(1+Math.sqrt(5))/2;super([-1,y,0,1,y,0,-1,-y,0,1,-y,0,0,-1,y,0,1,y,0,-1,-y,0,1,-y,y,0,-1,y,0,1,-y,0,-1,-y,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],i,f),this.type="IcosahedronGeometry",this.parameters={radius:i,detail:f}}static fromJSON(i){return new fg(i.radius,i.detail)}}class Eu extends bi{constructor(i,f=12,y=0,_=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:i,segments:f,phiStart:y,phiLength:_},f=Math.floor(f),_=Fr(_,0,2*Math.PI);const S=[],I=[],R=[],D=1/f,F=new me,G=new Vn;for(let W=0;W<=f;W++){const Z=y+W*D*_,K=Math.sin(Z),oe=Math.cos(Z);for(let de=0;de<=i.length-1;de++)F.x=i[de].x*K,F.y=i[de].y,F.z=i[de].x*oe,I.push(F.x,F.y,F.z),G.x=W/f,G.y=de/(i.length-1),R.push(G.x,G.y)}for(let W=0;W<f;W++)for(let Z=0;Z<i.length-1;Z++){const K=Z+W*i.length,oe=K,de=K+i.length,ke=K+i.length+1,pe=K+1;S.push(oe,de,pe),S.push(de,ke,pe)}if(this.setIndex(S),this.setAttribute("position",new Pr(I,3)),this.setAttribute("uv",new Pr(R,2)),this.computeVertexNormals(),_===2*Math.PI){const W=this.attributes.normal.array,Z=new me,K=new me,oe=new me,de=f*i.length*3;for(let ke=0,pe=0;ke<i.length;ke++,pe+=3)Z.x=W[pe+0],Z.y=W[pe+1],Z.z=W[pe+2],K.x=W[de+pe+0],K.y=W[de+pe+1],K.z=W[de+pe+2],oe.addVectors(Z,K).normalize(),W[pe+0]=W[de+pe+0]=oe.x,W[pe+1]=W[de+pe+1]=oe.y,W[pe+2]=W[de+pe+2]=oe.z}}static fromJSON(i){return new Eu(i.points,i.segments,i.phiStart,i.phiLength)}}class pg extends Ka{constructor(i=1,f=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],i,f),this.type="OctahedronGeometry",this.parameters={radius:i,detail:f}}static fromJSON(i){return new pg(i.radius,i.detail)}}class Id extends bi{constructor(i,f,y){super(),this.type="ParametricGeometry",this.parameters={func:i,slices:f,stacks:y};const _=[],S=[],I=[],R=[],D=1e-5,F=new me,G=new me,W=new me,Z=new me,K=new me;i.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const oe=f+1;for(let de=0;de<=y;de++){const ke=de/y;for(let pe=0;pe<=f;pe++){const Ve=pe/f;i(Ve,ke,G),S.push(G.x,G.y,G.z),Ve-D>=0?(i(Ve-D,ke,W),Z.subVectors(G,W)):(i(Ve+D,ke,W),Z.subVectors(W,G)),ke-D>=0?(i(Ve,ke-D,W),K.subVectors(G,W)):(i(Ve,ke+D,W),K.subVectors(W,G)),F.crossVectors(Z,K).normalize(),I.push(F.x,F.y,F.z),R.push(Ve,ke)}}for(let de=0;de<y;de++)for(let ke=0;ke<f;ke++){const pe=de*oe+ke,Ve=de*oe+ke+1,Ye=(de+1)*oe+ke+1,$e=(de+1)*oe+ke;_.push(pe,Ve,$e),_.push(Ve,Ye,$e)}this.setIndex(_),this.setAttribute("position",new Pr(S,3)),this.setAttribute("normal",new Pr(I,3)),this.setAttribute("uv",new Pr(R,2))}}class Ad extends bi{constructor(i=.5,f=1,y=8,_=1,S=0,I=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:i,outerRadius:f,thetaSegments:y,phiSegments:_,thetaStart:S,thetaLength:I},y=Math.max(3,y);const R=[],D=[],F=[],G=[];let W=i;const Z=(f-i)/(_=Math.max(1,_)),K=new me,oe=new Vn;for(let de=0;de<=_;de++){for(let ke=0;ke<=y;ke++){const pe=S+ke/y*I;K.x=W*Math.cos(pe),K.y=W*Math.sin(pe),D.push(K.x,K.y,K.z),F.push(0,0,1),oe.x=(K.x/f+1)/2,oe.y=(K.y/f+1)/2,G.push(oe.x,oe.y)}W+=Z}for(let de=0;de<_;de++){const ke=de*(y+1);for(let pe=0;pe<y;pe++){const Ve=pe+ke,Ye=Ve,$e=Ve+y+1,_t=Ve+y+2,bt=Ve+1;R.push(Ye,$e,bt),R.push($e,_t,bt)}}this.setIndex(R),this.setAttribute("position",new Pr(D,3)),this.setAttribute("normal",new Pr(F,3)),this.setAttribute("uv",new Pr(G,2))}static fromJSON(i){return new Ad(i.innerRadius,i.outerRadius,i.thetaSegments,i.phiSegments,i.thetaStart,i.thetaLength)}}class El extends bi{constructor(i,f=12){super(),this.type="ShapeGeometry",this.parameters={shapes:i,curveSegments:f};const y=[],_=[],S=[],I=[];let R=0,D=0;if(Array.isArray(i)===!1)F(i);else for(let G=0;G<i.length;G++)F(i[G]),this.addGroup(R,D,G),R+=D,D=0;function F(G){const W=_.length/3,Z=G.extractPoints(f);let K=Z.shape;const oe=Z.holes;Yc.isClockWise(K)===!1&&(K=K.reverse());for(let ke=0,pe=oe.length;ke<pe;ke++){const Ve=oe[ke];Yc.isClockWise(Ve)===!0&&(oe[ke]=Ve.reverse())}const de=Yc.triangulateShape(K,oe);for(let ke=0,pe=oe.length;ke<pe;ke++){const Ve=oe[ke];K=K.concat(Ve)}for(let ke=0,pe=K.length;ke<pe;ke++){const Ve=K[ke];_.push(Ve.x,Ve.y,0),S.push(0,0,1),I.push(Ve.x,Ve.y)}for(let ke=0,pe=de.length;ke<pe;ke++){const Ve=de[ke],Ye=Ve[0]+W,$e=Ve[1]+W,_t=Ve[2]+W;y.push(Ye,$e,_t),D+=3}}this.setIndex(y),this.setAttribute("position",new Pr(_,3)),this.setAttribute("normal",new Pr(S,3)),this.setAttribute("uv",new Pr(I,2))}toJSON(){const i=super.toJSON();return function(f,y){if(y.shapes=[],Array.isArray(f))for(let _=0,S=f.length;_<S;_++){const I=f[_];y.shapes.push(I.uuid)}else y.shapes.push(f.uuid);return y}(this.parameters.shapes,i)}static fromJSON(i,f){const y=[];for(let _=0,S=i.shapes.length;_<S;_++){const I=f[i.shapes[_]];y.push(I)}return new El(y,i.curveSegments)}}class Sl extends bi{constructor(i=1,f=32,y=16,_=0,S=2*Math.PI,I=0,R=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:i,widthSegments:f,heightSegments:y,phiStart:_,phiLength:S,thetaStart:I,thetaLength:R},f=Math.max(3,Math.floor(f)),y=Math.max(2,Math.floor(y));const D=Math.min(I+R,Math.PI);let F=0;const G=[],W=new me,Z=new me,K=[],oe=[],de=[],ke=[];for(let pe=0;pe<=y;pe++){const Ve=[],Ye=pe/y;let $e=0;pe==0&&I==0?$e=.5/f:pe==y&&D==Math.PI&&($e=-.5/f);for(let _t=0;_t<=f;_t++){const bt=_t/f;W.x=-i*Math.cos(_+bt*S)*Math.sin(I+Ye*R),W.y=i*Math.cos(I+Ye*R),W.z=i*Math.sin(_+bt*S)*Math.sin(I+Ye*R),oe.push(W.x,W.y,W.z),Z.copy(W).normalize(),de.push(Z.x,Z.y,Z.z),ke.push(bt+$e,1-Ye),Ve.push(F++)}G.push(Ve)}for(let pe=0;pe<y;pe++)for(let Ve=0;Ve<f;Ve++){const Ye=G[pe][Ve+1],$e=G[pe][Ve],_t=G[pe+1][Ve],bt=G[pe+1][Ve+1];(pe!==0||I>0)&&K.push(Ye,$e,bt),(pe!==y-1||D<Math.PI)&&K.push($e,_t,bt)}this.setIndex(K),this.setAttribute("position",new Pr(oe,3)),this.setAttribute("normal",new Pr(de,3)),this.setAttribute("uv",new Pr(ke,2))}static fromJSON(i){return new Sl(i.radius,i.widthSegments,i.heightSegments,i.phiStart,i.phiLength,i.thetaStart,i.thetaLength)}}class F0 extends Ka{constructor(i=1,f=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],i,f),this.type="TetrahedronGeometry",this.parameters={radius:i,detail:f}}static fromJSON(i){return new F0(i.radius,i.detail)}}class mg extends Ao{constructor(i,f={}){const y=f.font;if(!y||!y.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new bi;const _=y.generateShapes(i,f.size);f.depth=f.height!==void 0?f.height:50,f.bevelThickness===void 0&&(f.bevelThickness=10),f.bevelSize===void 0&&(f.bevelSize=8),f.bevelEnabled===void 0&&(f.bevelEnabled=!1),super(_,f),this.type="TextGeometry"}}class gg extends bi{constructor(i=1,f=.4,y=8,_=6,S=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:i,tube:f,radialSegments:y,tubularSegments:_,arc:S},y=Math.floor(y),_=Math.floor(_);const I=[],R=[],D=[],F=[],G=new me,W=new me,Z=new me;for(let K=0;K<=y;K++)for(let oe=0;oe<=_;oe++){const de=oe/_*S,ke=K/y*Math.PI*2;W.x=(i+f*Math.cos(ke))*Math.cos(de),W.y=(i+f*Math.cos(ke))*Math.sin(de),W.z=f*Math.sin(ke),R.push(W.x,W.y,W.z),G.x=i*Math.cos(de),G.y=i*Math.sin(de),Z.subVectors(W,G).normalize(),D.push(Z.x,Z.y,Z.z),F.push(oe/_),F.push(K/y)}for(let K=1;K<=y;K++)for(let oe=1;oe<=_;oe++){const de=(_+1)*K+oe-1,ke=(_+1)*(K-1)+oe-1,pe=(_+1)*(K-1)+oe,Ve=(_+1)*K+oe;I.push(de,ke,Ve),I.push(ke,pe,Ve)}this.setIndex(I),this.setAttribute("position",new Pr(R,3)),this.setAttribute("normal",new Pr(D,3)),this.setAttribute("uv",new Pr(F,2))}static fromJSON(i){return new gg(i.radius,i.tube,i.radialSegments,i.tubularSegments,i.arc)}}class z0 extends bi{constructor(i=1,f=.4,y=64,_=8,S=2,I=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:i,tube:f,tubularSegments:y,radialSegments:_,p:S,q:I},y=Math.floor(y),_=Math.floor(_);const R=[],D=[],F=[],G=[],W=new me,Z=new me,K=new me,oe=new me,de=new me,ke=new me,pe=new me;for(let Ye=0;Ye<=y;++Ye){const $e=Ye/y*S*Math.PI*2;Ve($e,S,I,i,K),Ve($e+.01,S,I,i,oe),ke.subVectors(oe,K),pe.addVectors(oe,K),de.crossVectors(ke,pe),pe.crossVectors(de,ke),de.normalize(),pe.normalize();for(let _t=0;_t<=_;++_t){const bt=_t/_*Math.PI*2,Vt=-f*Math.cos(bt),qt=f*Math.sin(bt);W.x=K.x+(Vt*pe.x+qt*de.x),W.y=K.y+(Vt*pe.y+qt*de.y),W.z=K.z+(Vt*pe.z+qt*de.z),D.push(W.x,W.y,W.z),Z.subVectors(W,K).normalize(),F.push(Z.x,Z.y,Z.z),G.push(Ye/y),G.push(_t/_)}}for(let Ye=1;Ye<=y;Ye++)for(let $e=1;$e<=_;$e++){const _t=(_+1)*(Ye-1)+($e-1),bt=(_+1)*Ye+($e-1),Vt=(_+1)*Ye+$e,qt=(_+1)*(Ye-1)+$e;R.push(_t,bt,qt),R.push(bt,Vt,qt)}function Ve(Ye,$e,_t,bt,Vt){const qt=Math.cos(Ye),mn=Math.sin(Ye),sn=_t/$e*Ye,dn=Math.cos(sn);Vt.x=bt*(2+dn)*.5*qt,Vt.y=bt*(2+dn)*mn*.5,Vt.z=bt*Math.sin(sn)*.5}this.setIndex(R),this.setAttribute("position",new Pr(D,3)),this.setAttribute("normal",new Pr(F,3)),this.setAttribute("uv",new Pr(G,2))}static fromJSON(i){return new z0(i.radius,i.tube,i.tubularSegments,i.radialSegments,i.p,i.q)}}class $p extends bi{constructor(i,f=64,y=1,_=8,S=!1){super(),this.type="TubeGeometry",this.parameters={path:i,tubularSegments:f,radius:y,radialSegments:_,closed:S};const I=i.computeFrenetFrames(f,S);this.tangents=I.tangents,this.normals=I.normals,this.binormals=I.binormals;const R=new me,D=new me,F=new Vn;let G=new me;const W=[],Z=[],K=[],oe=[];function de(ke){G=i.getPointAt(ke/f,G);const pe=I.normals[ke],Ve=I.binormals[ke];for(let Ye=0;Ye<=_;Ye++){const $e=Ye/_*Math.PI*2,_t=Math.sin($e),bt=-Math.cos($e);D.x=bt*pe.x+_t*Ve.x,D.y=bt*pe.y+_t*Ve.y,D.z=bt*pe.z+_t*Ve.z,D.normalize(),Z.push(D.x,D.y,D.z),R.x=G.x+y*D.x,R.y=G.y+y*D.y,R.z=G.z+y*D.z,W.push(R.x,R.y,R.z)}}(function(){for(let ke=0;ke<f;ke++)de(ke);de(S===!1?f:0),function(){for(let ke=0;ke<=f;ke++)for(let pe=0;pe<=_;pe++)F.x=ke/f,F.y=pe/_,K.push(F.x,F.y)}(),function(){for(let ke=1;ke<=f;ke++)for(let pe=1;pe<=_;pe++){const Ve=(_+1)*(ke-1)+(pe-1),Ye=(_+1)*ke+(pe-1),$e=(_+1)*ke+pe,_t=(_+1)*(ke-1)+pe;oe.push(Ve,Ye,_t),oe.push(Ye,$e,_t)}}()})(),this.setIndex(oe),this.setAttribute("position",new Pr(W,3)),this.setAttribute("normal",new Pr(Z,3)),this.setAttribute("uv",new Pr(K,2))}toJSON(){const i=super.toJSON();return i.path=this.parameters.path.toJSON(),i}static fromJSON(i){return new $p(new Fv[i.path.type]().fromJSON(i.path),i.tubularSegments,i.radius,i.radialSegments,i.closed)}}class Kc extends bi{constructor(i){if(super(),this.type="WireframeGeometry",i.isGeometry===!0)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const f=[],y=new Set,_=new me,S=new me;if(i.index!==null){const I=i.attributes.position,R=i.index;let D=i.groups;D.length===0&&(D=[{start:0,count:R.count,materialIndex:0}]);for(let F=0,G=D.length;F<G;++F){const W=D[F],Z=W.start;for(let K=Z,oe=Z+W.count;K<oe;K+=3)for(let de=0;de<3;de++){const ke=R.getX(K+de),pe=R.getX(K+(de+1)%3);_.fromBufferAttribute(I,ke),S.fromBufferAttribute(I,pe),Xp(_,S,y)===!0&&(f.push(_.x,_.y,_.z),f.push(S.x,S.y,S.z))}}}else{const I=i.attributes.position;for(let R=0,D=I.count/3;R<D;R++)for(let F=0;F<3;F++){const G=3*R+F,W=3*R+(F+1)%3;_.fromBufferAttribute(I,G),S.fromBufferAttribute(I,W),Xp(_,S,y)===!0&&(f.push(_.x,_.y,_.z),f.push(S.x,S.y,S.z))}}this.setAttribute("position",new Pr(f,3))}}function Xp(M,i,f){const y=`${M.x},${M.y},${M.z}-${i.x},${i.y},${i.z}`,_=`${i.x},${i.y},${i.z}-${M.x},${M.y},${M.z}`;return f.has(y)!==!0&&f.has(_)!==!0&&(f.add(y,_),!0)}var N3=Object.freeze({__proto__:null,BoxGeometry:Ul,BoxBufferGeometry:Ul,CircleGeometry:T0,CircleBufferGeometry:T0,ConeGeometry:ug,ConeBufferGeometry:ug,CylinderGeometry:Df,CylinderBufferGeometry:Df,DodecahedronGeometry:M0,DodecahedronBufferGeometry:M0,EdgesGeometry:k0,ExtrudeGeometry:Ao,ExtrudeBufferGeometry:Ao,IcosahedronGeometry:fg,IcosahedronBufferGeometry:fg,LatheGeometry:Eu,LatheBufferGeometry:Eu,OctahedronGeometry:pg,OctahedronBufferGeometry:pg,ParametricGeometry:Id,ParametricBufferGeometry:Id,PlaneGeometry:Gc,PlaneBufferGeometry:Gc,PolyhedronGeometry:Ka,PolyhedronBufferGeometry:Ka,RingGeometry:Ad,RingBufferGeometry:Ad,ShapeGeometry:El,ShapeBufferGeometry:El,SphereGeometry:Sl,SphereBufferGeometry:Sl,TetrahedronGeometry:F0,TetrahedronBufferGeometry:F0,TextGeometry:mg,TextBufferGeometry:mg,TorusGeometry:gg,TorusBufferGeometry:gg,TorusKnotGeometry:z0,TorusKnotBufferGeometry:z0,TubeGeometry:$p,TubeBufferGeometry:$p,WireframeGeometry:Kc});class Uv extends cn{constructor(i){super(),this.type="ShadowMaterial",this.color=new Xn(0),this.transparent=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this}}Uv.prototype.isShadowMaterial=!0;class jv extends cn{constructor(i){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Xn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.defines={STANDARD:""},this.color.copy(i.color),this.roughness=i.roughness,this.metalness=i.metalness,this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.roughnessMap=i.roughnessMap,this.metalnessMap=i.metalnessMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.envMapIntensity=i.envMapIntensity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.flatShading=i.flatShading,this}}jv.prototype.isMeshStandardMaterial=!0;class B0 extends jv{constructor(i){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Fr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(f){this.ior=(1+.4*f)/(1-.4*f)}}),this.sheenTint=new Xn(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new Xn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new Xn(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(i)}get clearcoat(){return this._clearcoat}set clearcoat(i){this._clearcoat>0!=i>0&&this.version++,this._clearcoat=i}get transmission(){return this._transmission}set transmission(i){this._transmission>0!=i>0&&this.version++,this._transmission=i}copy(i){return super.copy(i),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=i.clearcoat,this.clearcoatMap=i.clearcoatMap,this.clearcoatRoughness=i.clearcoatRoughness,this.clearcoatRoughnessMap=i.clearcoatRoughnessMap,this.clearcoatNormalMap=i.clearcoatNormalMap,this.clearcoatNormalScale.copy(i.clearcoatNormalScale),this.ior=i.ior,this.sheenTint.copy(i.sheenTint),this.transmission=i.transmission,this.transmissionMap=i.transmissionMap,this.thickness=i.thickness,this.thicknessMap=i.thicknessMap,this.attenuationDistance=i.attenuationDistance,this.attenuationTint.copy(i.attenuationTint),this.specularIntensity=i.specularIntensity,this.specularIntensityMap=i.specularIntensityMap,this.specularTint.copy(i.specularTint),this.specularTintMap=i.specularTintMap,this}}B0.prototype.isMeshPhysicalMaterial=!0;class j_ extends cn{constructor(i){super(),this.type="MeshPhongMaterial",this.color=new Xn(16777215),this.specular=new Xn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.specular.copy(i.specular),this.shininess=i.shininess,this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.specularMap=i.specularMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.combine=i.combine,this.reflectivity=i.reflectivity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.flatShading=i.flatShading,this}}j_.prototype.isMeshPhongMaterial=!0;class Zp extends cn{constructor(i){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Xn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.gradientMap=i.gradientMap,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.alphaMap=i.alphaMap,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this}}Zp.prototype.isMeshToonMaterial=!0;class Yp extends cn{constructor(i){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.flatShading=i.flatShading,this}}Yp.prototype.isMeshNormalMaterial=!0;class yg extends cn{constructor(i){super(),this.type="MeshLambertMaterial",this.color=new Xn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.specularMap=i.specularMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.combine=i.combine,this.reflectivity=i.reflectivity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this}}yg.prototype.isMeshLambertMaterial=!0;class U0 extends cn{constructor(i){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Xn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.defines={MATCAP:""},this.color.copy(i.color),this.matcap=i.matcap,this.map=i.map,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.alphaMap=i.alphaMap,this.flatShading=i.flatShading,this}}U0.prototype.isMeshMatcapMaterial=!0;class Vv extends Na{constructor(i){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(i)}copy(i){return super.copy(i),this.scale=i.scale,this.dashSize=i.dashSize,this.gapSize=i.gapSize,this}}Vv.prototype.isLineDashedMaterial=!0;var V_=Object.freeze({__proto__:null,ShadowMaterial:Uv,SpriteMaterial:Yn,RawShaderMaterial:Mf,ShaderMaterial:Th,PointsMaterial:Rf,MeshPhysicalMaterial:B0,MeshStandardMaterial:jv,MeshPhongMaterial:j_,MeshToonMaterial:Zp,MeshNormalMaterial:Yp,MeshLambertMaterial:yg,MeshDepthMaterial:Xe,MeshDistanceMaterial:Ee,MeshBasicMaterial:es,MeshMatcapMaterial:U0,LineDashedMaterial:Vv,LineBasicMaterial:Na,Material:cn});const wo={arraySlice:function(M,i,f){return wo.isTypedArray(M)?new M.constructor(M.subarray(i,f!==void 0?f:M.length)):M.slice(i,f)},convertArray:function(M,i,f){return!M||!f&&M.constructor===i?M:typeof i.BYTES_PER_ELEMENT=="number"?new i(M):Array.prototype.slice.call(M)},isTypedArray:function(M){return ArrayBuffer.isView(M)&&!(M instanceof DataView)},getKeyframeOrder:function(M){const i=M.length,f=new Array(i);for(let y=0;y!==i;++y)f[y]=y;return f.sort(function(y,_){return M[y]-M[_]}),f},sortedArray:function(M,i,f){const y=M.length,_=new M.constructor(y);for(let S=0,I=0;I!==y;++S){const R=f[S]*i;for(let D=0;D!==i;++D)_[I++]=M[R+D]}return _},flattenJSON:function(M,i,f,y){let _=1,S=M[0];for(;S!==void 0&&S[y]===void 0;)S=M[_++];if(S===void 0)return;let I=S[y];if(I!==void 0)if(Array.isArray(I))do I=S[y],I!==void 0&&(i.push(S.time),f.push.apply(f,I)),S=M[_++];while(S!==void 0);else if(I.toArray!==void 0)do I=S[y],I!==void 0&&(i.push(S.time),I.toArray(f,f.length)),S=M[_++];while(S!==void 0);else do I=S[y],I!==void 0&&(i.push(S.time),f.push(I)),S=M[_++];while(S!==void 0)},subclip:function(M,i,f,y,_=30){const S=M.clone();S.name=i;const I=[];for(let D=0;D<S.tracks.length;++D){const F=S.tracks[D],G=F.getValueSize(),W=[],Z=[];for(let K=0;K<F.times.length;++K){const oe=F.times[K]*_;if(!(oe<f||oe>=y)){W.push(F.times[K]);for(let de=0;de<G;++de)Z.push(F.values[K*G+de])}}W.length!==0&&(F.times=wo.convertArray(W,F.times.constructor),F.values=wo.convertArray(Z,F.values.constructor),I.push(F))}S.tracks=I;let R=1/0;for(let D=0;D<S.tracks.length;++D)R>S.tracks[D].times[0]&&(R=S.tracks[D].times[0]);for(let D=0;D<S.tracks.length;++D)S.tracks[D].shift(-1*R);return S.resetDuration(),S},makeClipAdditive:function(M,i=0,f=M,y=30){y<=0&&(y=30);const _=f.tracks.length,S=i/y;for(let I=0;I<_;++I){const R=f.tracks[I],D=R.ValueTypeName;if(D==="bool"||D==="string")continue;const F=M.tracks.find(function(pe){return pe.name===R.name&&pe.ValueTypeName===D});if(F===void 0)continue;let G=0;const W=R.getValueSize();R.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(G=W/3);let Z=0;const K=F.getValueSize();F.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(Z=K/3);const oe=R.times.length-1;let de;if(S<=R.times[0]){const pe=G,Ve=W-G;de=wo.arraySlice(R.values,pe,Ve)}else if(S>=R.times[oe]){const pe=oe*W+G,Ve=pe+W-G;de=wo.arraySlice(R.values,pe,Ve)}else{const pe=R.createInterpolant(),Ve=G,Ye=W-G;pe.evaluate(S),de=wo.arraySlice(pe.resultBuffer,Ve,Ye)}D==="quaternion"&&new at().fromArray(de).normalize().conjugate().toArray(de);const ke=F.times.length;for(let pe=0;pe<ke;++pe){const Ve=pe*K+Z;if(D==="quaternion")at.multiplyQuaternionsFlat(F.values,Ve,de,0,F.values,Ve);else{const Ye=K-2*Z;for(let $e=0;$e<Ye;++$e)F.values[Ve+$e]-=de[$e]}}}return M.blendMode=2501,M}};class Ld{constructor(i,f,y,_){this.parameterPositions=i,this._cachedIndex=0,this.resultBuffer=_!==void 0?_:new f.constructor(y),this.sampleValues=f,this.valueSize=y,this.settings=null,this.DefaultSettings_={}}evaluate(i){const f=this.parameterPositions;let y=this._cachedIndex,_=f[y],S=f[y-1];e:{t:{let I;n:{r:if(!(i<_)){for(let R=y+2;;){if(_===void 0){if(i<S)break r;return y=f.length,this._cachedIndex=y,this.afterEnd_(y-1,i,S)}if(y===R)break;if(S=_,_=f[++y],i<_)break t}I=f.length;break n}if(i>=S)break e;{const R=f[1];i<R&&(y=2,S=R);for(let D=y-2;;){if(S===void 0)return this._cachedIndex=0,this.beforeStart_(0,i,_);if(y===D)break;if(_=S,S=f[--y-1],i>=S)break t}I=y,y=0}}for(;y<I;){const R=y+I>>>1;i<f[R]?I=R:y=R+1}if(_=f[y],S=f[y-1],S===void 0)return this._cachedIndex=0,this.beforeStart_(0,i,_);if(_===void 0)return y=f.length,this._cachedIndex=y,this.afterEnd_(y-1,S,i)}this._cachedIndex=y,this.intervalChanged_(y,S,_)}return this.interpolate_(y,S,i,_)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(i){const f=this.resultBuffer,y=this.sampleValues,_=this.valueSize,S=i*_;for(let I=0;I!==_;++I)f[I]=y[S+I];return f}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Ld.prototype.beforeStart_=Ld.prototype.copySampleValue_,Ld.prototype.afterEnd_=Ld.prototype.copySampleValue_;class _g extends Ld{constructor(i,f,y,_){super(i,f,y,_),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(i,f,y){const _=this.parameterPositions;let S=i-2,I=i+1,R=_[S],D=_[I];if(R===void 0)switch(this.getSettings_().endingStart){case 2401:S=i,R=2*f-y;break;case 2402:S=_.length-2,R=f+_[S]-_[S+1];break;default:S=i,R=y}if(D===void 0)switch(this.getSettings_().endingEnd){case 2401:I=i,D=2*y-f;break;case 2402:I=1,D=y+_[1]-_[0];break;default:I=i-1,D=f}const F=.5*(y-f),G=this.valueSize;this._weightPrev=F/(f-R),this._weightNext=F/(D-y),this._offsetPrev=S*G,this._offsetNext=I*G}interpolate_(i,f,y,_){const S=this.resultBuffer,I=this.sampleValues,R=this.valueSize,D=i*R,F=D-R,G=this._offsetPrev,W=this._offsetNext,Z=this._weightPrev,K=this._weightNext,oe=(y-f)/(_-f),de=oe*oe,ke=de*oe,pe=-Z*ke+2*Z*de-Z*oe,Ve=(1+Z)*ke+(-1.5-2*Z)*de+(-.5+Z)*oe+1,Ye=(-1-K)*ke+(1.5+K)*de+.5*oe,$e=K*ke-K*de;for(let _t=0;_t!==R;++_t)S[_t]=pe*I[G+_t]+Ve*I[F+_t]+Ye*I[D+_t]+$e*I[W+_t];return S}}class Gv extends Ld{constructor(i,f,y,_){super(i,f,y,_)}interpolate_(i,f,y,_){const S=this.resultBuffer,I=this.sampleValues,R=this.valueSize,D=i*R,F=D-R,G=(y-f)/(_-f),W=1-G;for(let Z=0;Z!==R;++Z)S[Z]=I[F+Z]*W+I[D+Z]*G;return S}}class Hv extends Ld{constructor(i,f,y,_){super(i,f,y,_)}interpolate_(i){return this.copySampleValue_(i-1)}}class Jc{constructor(i,f,y,_){if(i===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(f===void 0||f.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+i);this.name=i,this.times=wo.convertArray(f,this.TimeBufferType),this.values=wo.convertArray(y,this.ValueBufferType),this.setInterpolation(_||this.DefaultInterpolation)}static toJSON(i){const f=i.constructor;let y;if(f.toJSON!==this.toJSON)y=f.toJSON(i);else{y={name:i.name,times:wo.convertArray(i.times,Array),values:wo.convertArray(i.values,Array)};const _=i.getInterpolation();_!==i.DefaultInterpolation&&(y.interpolation=_)}return y.type=i.ValueTypeName,y}InterpolantFactoryMethodDiscrete(i){return new Hv(this.times,this.values,this.getValueSize(),i)}InterpolantFactoryMethodLinear(i){return new Gv(this.times,this.values,this.getValueSize(),i)}InterpolantFactoryMethodSmooth(i){return new _g(this.times,this.values,this.getValueSize(),i)}setInterpolation(i){let f;switch(i){case 2300:f=this.InterpolantFactoryMethodDiscrete;break;case 2301:f=this.InterpolantFactoryMethodLinear;break;case 2302:f=this.InterpolantFactoryMethodSmooth}if(f===void 0){const y="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(i===this.DefaultInterpolation)throw new Error(y);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",y),this}return this.createInterpolant=f,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(i){if(i!==0){const f=this.times;for(let y=0,_=f.length;y!==_;++y)f[y]+=i}return this}scale(i){if(i!==1){const f=this.times;for(let y=0,_=f.length;y!==_;++y)f[y]*=i}return this}trim(i,f){const y=this.times,_=y.length;let S=0,I=_-1;for(;S!==_&&y[S]<i;)++S;for(;I!==-1&&y[I]>f;)--I;if(++I,S!==0||I!==_){S>=I&&(I=Math.max(I,1),S=I-1);const R=this.getValueSize();this.times=wo.arraySlice(y,S,I),this.values=wo.arraySlice(this.values,S*R,I*R)}return this}validate(){let i=!0;const f=this.getValueSize();f-Math.floor(f)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),i=!1);const y=this.times,_=this.values,S=y.length;S===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),i=!1);let I=null;for(let R=0;R!==S;R++){const D=y[R];if(typeof D=="number"&&isNaN(D)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,R,D),i=!1;break}if(I!==null&&I>D){console.error("THREE.KeyframeTrack: Out of order keys.",this,R,D,I),i=!1;break}I=D}if(_!==void 0&&wo.isTypedArray(_))for(let R=0,D=_.length;R!==D;++R){const F=_[R];if(isNaN(F)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,R,F),i=!1;break}}return i}optimize(){const i=wo.arraySlice(this.times),f=wo.arraySlice(this.values),y=this.getValueSize(),_=this.getInterpolation()===2302,S=i.length-1;let I=1;for(let R=1;R<S;++R){let D=!1;const F=i[R];if(F!==i[R+1]&&(R!==1||F!==i[0]))if(_)D=!0;else{const G=R*y,W=G-y,Z=G+y;for(let K=0;K!==y;++K){const oe=f[G+K];if(oe!==f[W+K]||oe!==f[Z+K]){D=!0;break}}}if(D){if(R!==I){i[I]=i[R];const G=R*y,W=I*y;for(let Z=0;Z!==y;++Z)f[W+Z]=f[G+Z]}++I}}if(S>0){i[I]=i[S];for(let R=S*y,D=I*y,F=0;F!==y;++F)f[D+F]=f[R+F];++I}return I!==i.length?(this.times=wo.arraySlice(i,0,I),this.values=wo.arraySlice(f,0,I*y)):(this.times=i,this.values=f),this}clone(){const i=wo.arraySlice(this.times,0),f=wo.arraySlice(this.values,0),y=new this.constructor(this.name,i,f);return y.createInterpolant=this.createInterpolant,y}}Jc.prototype.TimeBufferType=Float32Array,Jc.prototype.ValueBufferType=Float32Array,Jc.prototype.DefaultInterpolation=2301;class vg extends Jc{}vg.prototype.ValueTypeName="bool",vg.prototype.ValueBufferType=Array,vg.prototype.DefaultInterpolation=2300,vg.prototype.InterpolantFactoryMethodLinear=void 0,vg.prototype.InterpolantFactoryMethodSmooth=void 0;class D3 extends Jc{}D3.prototype.ValueTypeName="color";class Uf extends Jc{}Uf.prototype.ValueTypeName="number";class O3 extends Ld{constructor(i,f,y,_){super(i,f,y,_)}interpolate_(i,f,y,_){const S=this.resultBuffer,I=this.sampleValues,R=this.valueSize,D=(y-f)/(_-f);let F=i*R;for(let G=F+R;F!==G;F+=4)at.slerpFlat(S,0,I,F-R,I,F,D);return S}}class vc extends Jc{InterpolantFactoryMethodLinear(i){return new O3(this.times,this.values,this.getValueSize(),i)}}vc.prototype.ValueTypeName="quaternion",vc.prototype.DefaultInterpolation=2301,vc.prototype.InterpolantFactoryMethodSmooth=void 0;class ms extends Jc{}ms.prototype.ValueTypeName="string",ms.prototype.ValueBufferType=Array,ms.prototype.DefaultInterpolation=2300,ms.prototype.InterpolantFactoryMethodLinear=void 0,ms.prototype.InterpolantFactoryMethodSmooth=void 0;class xg extends Jc{}xg.prototype.ValueTypeName="vector";class Xu{constructor(i,f=-1,y,_=2500){this.name=i,this.tracks=y,this.duration=f,this.blendMode=_,this.uuid=Dr(),this.duration<0&&this.resetDuration()}static parse(i){const f=[],y=i.tracks,_=1/(i.fps||1);for(let I=0,R=y.length;I!==R;++I)f.push(Pd(y[I]).scale(_));const S=new this(i.name,i.duration,f,i.blendMode);return S.uuid=i.uuid,S}static toJSON(i){const f=[],y=i.tracks,_={name:i.name,duration:i.duration,tracks:f,uuid:i.uuid,blendMode:i.blendMode};for(let S=0,I=y.length;S!==I;++S)f.push(Jc.toJSON(y[S]));return _}static CreateFromMorphTargetSequence(i,f,y,_){const S=f.length,I=[];for(let R=0;R<S;R++){let D=[],F=[];D.push((R+S-1)%S,R,(R+1)%S),F.push(0,1,0);const G=wo.getKeyframeOrder(D);D=wo.sortedArray(D,1,G),F=wo.sortedArray(F,1,G),_||D[0]!==0||(D.push(S),F.push(F[0])),I.push(new Uf(".morphTargetInfluences["+f[R].name+"]",D,F).scale(1/y))}return new this(i,-1,I)}static findByName(i,f){let y=i;if(!Array.isArray(i)){const _=i;y=_.geometry&&_.geometry.animations||_.animations}for(let _=0;_<y.length;_++)if(y[_].name===f)return y[_];return null}static CreateClipsFromMorphTargetSequences(i,f,y){const _={},S=/^([\w-]*?)([\d]+)$/;for(let R=0,D=i.length;R<D;R++){const F=i[R],G=F.name.match(S);if(G&&G.length>1){const W=G[1];let Z=_[W];Z||(_[W]=Z=[]),Z.push(F)}}const I=[];for(const R in _)I.push(this.CreateFromMorphTargetSequence(R,_[R],f,y));return I}static parseAnimation(i,f){if(!i)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const y=function(G,W,Z,K,oe){if(Z.length!==0){const de=[],ke=[];wo.flattenJSON(Z,de,ke,K),de.length!==0&&oe.push(new G(W,de,ke))}},_=[],S=i.name||"default",I=i.fps||30,R=i.blendMode;let D=i.length||-1;const F=i.hierarchy||[];for(let G=0;G<F.length;G++){const W=F[G].keys;if(W&&W.length!==0)if(W[0].morphTargets){const Z={};let K;for(K=0;K<W.length;K++)if(W[K].morphTargets)for(let oe=0;oe<W[K].morphTargets.length;oe++)Z[W[K].morphTargets[oe]]=-1;for(const oe in Z){const de=[],ke=[];for(let pe=0;pe!==W[K].morphTargets.length;++pe){const Ve=W[K];de.push(Ve.time),ke.push(Ve.morphTarget===oe?1:0)}_.push(new Uf(".morphTargetInfluence["+oe+"]",de,ke))}D=Z.length*(I||1)}else{const Z=".bones["+f[G].name+"]";y(xg,Z+".position",W,"pos",_),y(vc,Z+".quaternion",W,"rot",_),y(xg,Z+".scale",W,"scl",_)}}return _.length===0?null:new this(S,D,_,R)}resetDuration(){let i=0;for(let f=0,y=this.tracks.length;f!==y;++f){const _=this.tracks[f];i=Math.max(i,_.times[_.times.length-1])}return this.duration=i,this}trim(){for(let i=0;i<this.tracks.length;i++)this.tracks[i].trim(0,this.duration);return this}validate(){let i=!0;for(let f=0;f<this.tracks.length;f++)i=i&&this.tracks[f].validate();return i}optimize(){for(let i=0;i<this.tracks.length;i++)this.tracks[i].optimize();return this}clone(){const i=[];for(let f=0;f<this.tracks.length;f++)i.push(this.tracks[f].clone());return new this.constructor(this.name,this.duration,i,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Pd(M){if(M.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const i=function(f){switch(f.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Uf;case"vector":case"vector2":case"vector3":case"vector4":return xg;case"color":return D3;case"quaternion":return vc;case"bool":case"boolean":return vg;case"string":return ms}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+f)}(M.type);if(M.times===void 0){const f=[],y=[];wo.flattenJSON(M.keys,f,y,"value"),M.times=f,M.values=y}return i.parse!==void 0?i.parse(M):new i(M.name,M.times,M.values,M.interpolation)}const Hl={enabled:!1,files:{},add:function(M,i){this.enabled!==!1&&(this.files[M]=i)},get:function(M){if(this.enabled!==!1)return this.files[M]},remove:function(M){delete this.files[M]},clear:function(){this.files={}}};class Su{constructor(i,f,y){const _=this;let S,I=!1,R=0,D=0;const F=[];this.onStart=void 0,this.onLoad=i,this.onProgress=f,this.onError=y,this.itemStart=function(G){D++,I===!1&&_.onStart!==void 0&&_.onStart(G,R,D),I=!0},this.itemEnd=function(G){R++,_.onProgress!==void 0&&_.onProgress(G,R,D),R===D&&(I=!1,_.onLoad!==void 0&&_.onLoad())},this.itemError=function(G){_.onError!==void 0&&_.onError(G)},this.resolveURL=function(G){return S?S(G):G},this.setURLModifier=function(G){return S=G,this},this.addHandler=function(G,W){return F.push(G,W),this},this.removeHandler=function(G){const W=F.indexOf(G);return W!==-1&&F.splice(W,2),this},this.getHandler=function(G){for(let W=0,Z=F.length;W<Z;W+=2){const K=F[W],oe=F[W+1];if(K.global&&(K.lastIndex=0),K.test(G))return oe}return null}}}const sl=new Su;class Wl{constructor(i){this.manager=i!==void 0?i:sl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(i,f){const y=this;return new Promise(function(_,S){y.load(i,_,f,S)})}parse(){}setCrossOrigin(i){return this.crossOrigin=i,this}setWithCredentials(i){return this.withCredentials=i,this}setPath(i){return this.path=i,this}setResourcePath(i){return this.resourcePath=i,this}setRequestHeader(i){return this.requestHeader=i,this}}const co={};class Qc extends Wl{constructor(i){super(i)}load(i,f,y,_){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);const S=this,I=Hl.get(i);if(I!==void 0)return S.manager.itemStart(i),setTimeout(function(){f&&f(I),S.manager.itemEnd(i)},0),I;if(co[i]!==void 0)return void co[i].push({onLoad:f,onProgress:y,onError:_});const R=i.match(/^data:(.*?)(;base64)?,(.*)$/);let D;if(R){const F=R[1],G=!!R[2];let W=R[3];W=decodeURIComponent(W),G&&(W=atob(W));try{let Z;const K=(this.responseType||"").toLowerCase();switch(K){case"arraybuffer":case"blob":const oe=new Uint8Array(W.length);for(let ke=0;ke<W.length;ke++)oe[ke]=W.charCodeAt(ke);Z=K==="blob"?new Blob([oe.buffer],{type:F}):oe.buffer;break;case"document":Z=new DOMParser().parseFromString(W,F);break;case"json":Z=JSON.parse(W);break;default:Z=W}setTimeout(function(){f&&f(Z),S.manager.itemEnd(i)},0)}catch(Z){setTimeout(function(){_&&_(Z),S.manager.itemError(i),S.manager.itemEnd(i)},0)}}else{co[i]=[],co[i].push({onLoad:f,onProgress:y,onError:_}),D=new XMLHttpRequest,D.open("GET",i,!0),D.addEventListener("load",function(F){const G=this.response,W=co[i];if(delete co[i],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Hl.add(i,G);for(let Z=0,K=W.length;Z<K;Z++){const oe=W[Z];oe.onLoad&&oe.onLoad(G)}S.manager.itemEnd(i)}else{for(let Z=0,K=W.length;Z<K;Z++){const oe=W[Z];oe.onError&&oe.onError(F)}S.manager.itemError(i),S.manager.itemEnd(i)}},!1),D.addEventListener("progress",function(F){const G=co[i];for(let W=0,Z=G.length;W<Z;W++){const K=G[W];K.onProgress&&K.onProgress(F)}},!1),D.addEventListener("error",function(F){const G=co[i];delete co[i];for(let W=0,Z=G.length;W<Z;W++){const K=G[W];K.onError&&K.onError(F)}S.manager.itemError(i),S.manager.itemEnd(i)},!1),D.addEventListener("abort",function(F){const G=co[i];delete co[i];for(let W=0,Z=G.length;W<Z;W++){const K=G[W];K.onError&&K.onError(F)}S.manager.itemError(i),S.manager.itemEnd(i)},!1),this.responseType!==void 0&&(D.responseType=this.responseType),this.withCredentials!==void 0&&(D.withCredentials=this.withCredentials),D.overrideMimeType&&D.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const F in this.requestHeader)D.setRequestHeader(F,this.requestHeader[F]);D.send(null)}return S.manager.itemStart(i),D}setResponseType(i){return this.responseType=i,this}setMimeType(i){return this.mimeType=i,this}}class Rd extends Wl{constructor(i){super(i)}load(i,f,y,_){this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);const S=this,I=Hl.get(i);if(I!==void 0)return S.manager.itemStart(i),setTimeout(function(){f&&f(I),S.manager.itemEnd(i)},0),I;const R=document.createElementNS("http://www.w3.org/1999/xhtml","img");function D(){R.removeEventListener("load",D,!1),R.removeEventListener("error",F,!1),Hl.add(i,this),f&&f(this),S.manager.itemEnd(i)}function F(G){R.removeEventListener("load",D,!1),R.removeEventListener("error",F,!1),_&&_(G),S.manager.itemError(i),S.manager.itemEnd(i)}return R.addEventListener("load",D,!1),R.addEventListener("error",F,!1),i.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(R.crossOrigin=this.crossOrigin),S.manager.itemStart(i),R.src=i,R}}class Wv extends Wl{constructor(i){super(i)}load(i,f,y,_){const S=new Sf,I=new Rd(this.manager);I.setCrossOrigin(this.crossOrigin),I.setPath(this.path);let R=0;function D(F){I.load(i[F],function(G){S.images[F]=G,R++,R===6&&(S.needsUpdate=!0,f&&f(S))},void 0,_)}for(let F=0;F<i.length;++F)D(F);return S}}class F3 extends Wl{constructor(i){super(i)}load(i,f,y,_){const S=this,I=new Gl,R=new Qc(this.manager);return R.setResponseType("arraybuffer"),R.setRequestHeader(this.requestHeader),R.setPath(this.path),R.setWithCredentials(S.withCredentials),R.load(i,function(D){const F=S.parse(D);F&&(F.image!==void 0?I.image=F.image:F.data!==void 0&&(I.image.width=F.width,I.image.height=F.height,I.image.data=F.data),I.wrapS=F.wrapS!==void 0?F.wrapS:1001,I.wrapT=F.wrapT!==void 0?F.wrapT:1001,I.magFilter=F.magFilter!==void 0?F.magFilter:1006,I.minFilter=F.minFilter!==void 0?F.minFilter:1006,I.anisotropy=F.anisotropy!==void 0?F.anisotropy:1,F.encoding!==void 0&&(I.encoding=F.encoding),F.flipY!==void 0&&(I.flipY=F.flipY),F.format!==void 0&&(I.format=F.format),F.type!==void 0&&(I.type=F.type),F.mipmaps!==void 0&&(I.mipmaps=F.mipmaps,I.minFilter=1008),F.mipmapCount===1&&(I.minFilter=1006),F.generateMipmaps!==void 0&&(I.generateMipmaps=F.generateMipmaps),I.needsUpdate=!0,f&&f(I,F))},y,_),I}}class qv extends Wl{constructor(i){super(i)}load(i,f,y,_){const S=new le,I=new Rd(this.manager);return I.setCrossOrigin(this.crossOrigin),I.setPath(this.path),I.load(i,function(R){S.image=R;const D=i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0;S.format=D?1022:1023,S.needsUpdate=!0,f!==void 0&&f(S)},y,_),S}}class V9 extends Io{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(i){this.curves.push(i)}closePath(){const i=this.curves[0].getPoint(0),f=this.curves[this.curves.length-1].getPoint(1);i.equals(f)||this.curves.push(new P0(f,i))}getPoint(i){const f=i*this.getLength(),y=this.getCurveLengths();let _=0;for(;_<y.length;){if(y[_]>=f){const S=y[_]-f,I=this.curves[_],R=I.getLength(),D=R===0?0:1-S/R;return I.getPointAt(D)}_++}return null}getLength(){const i=this.getCurveLengths();return i[i.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const i=[];let f=0;for(let y=0,_=this.curves.length;y<_;y++)f+=this.curves[y].getLength(),i.push(f);return this.cacheLengths=i,i}getSpacedPoints(i=40){const f=[];for(let y=0;y<=i;y++)f.push(this.getPoint(y/i));return this.autoClose&&f.push(f[0]),f}getPoints(i=12){const f=[];let y;for(let _=0,S=this.curves;_<S.length;_++){const I=S[_],R=I&&I.isEllipseCurve?2*i:I&&(I.isLineCurve||I.isLineCurve3)?1:I&&I.isSplineCurve?i*I.points.length:i,D=I.getPoints(R);for(let F=0;F<D.length;F++){const G=D[F];y&&y.equals(G)||(f.push(G),y=G)}}return this.autoClose&&f.length>1&&!f[f.length-1].equals(f[0])&&f.push(f[0]),f}copy(i){super.copy(i),this.curves=[];for(let f=0,y=i.curves.length;f<y;f++){const _=i.curves[f];this.curves.push(_.clone())}return this.autoClose=i.autoClose,this}toJSON(){const i=super.toJSON();i.autoClose=this.autoClose,i.curves=[];for(let f=0,y=this.curves.length;f<y;f++){const _=this.curves[f];i.curves.push(_.toJSON())}return i}fromJSON(i){super.fromJSON(i),this.autoClose=i.autoClose,this.curves=[];for(let f=0,y=i.curves.length;f<y;f++){const _=i.curves[f];this.curves.push(new Fv[_.type]().fromJSON(_))}return this}}class bg extends V9{constructor(i){super(),this.type="Path",this.currentPoint=new Vn,i&&this.setFromPoints(i)}setFromPoints(i){this.moveTo(i[0].x,i[0].y);for(let f=1,y=i.length;f<y;f++)this.lineTo(i[f].x,i[f].y);return this}moveTo(i,f){return this.currentPoint.set(i,f),this}lineTo(i,f){const y=new P0(this.currentPoint.clone(),new Vn(i,f));return this.curves.push(y),this.currentPoint.set(i,f),this}quadraticCurveTo(i,f,y,_){const S=new zf(this.currentPoint.clone(),new Vn(i,f),new Vn(y,_));return this.curves.push(S),this.currentPoint.set(y,_),this}bezierCurveTo(i,f,y,_,S,I){const R=new Ov(this.currentPoint.clone(),new Vn(i,f),new Vn(y,_),new Vn(S,I));return this.curves.push(R),this.currentPoint.set(S,I),this}splineThru(i){const f=[this.currentPoint.clone()].concat(i),y=new N0(f);return this.curves.push(y),this.currentPoint.copy(i[i.length-1]),this}arc(i,f,y,_,S,I){const R=this.currentPoint.x,D=this.currentPoint.y;return this.absarc(i+R,f+D,y,_,S,I),this}absarc(i,f,y,_,S,I){return this.absellipse(i,f,y,y,_,S,I),this}ellipse(i,f,y,_,S,I,R,D){const F=this.currentPoint.x,G=this.currentPoint.y;return this.absellipse(i+F,f+G,y,_,S,I,R,D),this}absellipse(i,f,y,_,S,I,R,D){const F=new C0(i,f,y,_,S,I,R,D);if(this.curves.length>0){const W=F.getPoint(0);W.equals(this.currentPoint)||this.lineTo(W.x,W.y)}this.curves.push(F);const G=F.getPoint(1);return this.currentPoint.copy(G),this}copy(i){return super.copy(i),this.currentPoint.copy(i.currentPoint),this}toJSON(){const i=super.toJSON();return i.currentPoint=this.currentPoint.toArray(),i}fromJSON(i){return super.fromJSON(i),this.currentPoint.fromArray(i.currentPoint),this}}class jf extends bg{constructor(i){super(i),this.uuid=Dr(),this.type="Shape",this.holes=[]}getPointsHoles(i){const f=[];for(let y=0,_=this.holes.length;y<_;y++)f[y]=this.holes[y].getPoints(i);return f}extractPoints(i){return{shape:this.getPoints(i),holes:this.getPointsHoles(i)}}copy(i){super.copy(i),this.holes=[];for(let f=0,y=i.holes.length;f<y;f++){const _=i.holes[f];this.holes.push(_.clone())}return this}toJSON(){const i=super.toJSON();i.uuid=this.uuid,i.holes=[];for(let f=0,y=this.holes.length;f<y;f++){const _=this.holes[f];i.holes.push(_.toJSON())}return i}fromJSON(i){super.fromJSON(i),this.uuid=i.uuid,this.holes=[];for(let f=0,y=i.holes.length;f<y;f++){const _=i.holes[f];this.holes.push(new bg().fromJSON(_))}return this}}class Nh extends Me{constructor(i,f=1){super(),this.type="Light",this.color=new Xn(i),this.intensity=f}dispose(){}copy(i){return super.copy(i),this.color.copy(i.color),this.intensity=i.intensity,this}toJSON(i){const f=super.toJSON(i);return f.object.color=this.color.getHex(),f.object.intensity=this.intensity,this.groundColor!==void 0&&(f.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(f.object.distance=this.distance),this.angle!==void 0&&(f.object.angle=this.angle),this.decay!==void 0&&(f.object.decay=this.decay),this.penumbra!==void 0&&(f.object.penumbra=this.penumbra),this.shadow!==void 0&&(f.object.shadow=this.shadow.toJSON()),f}}Nh.prototype.isLight=!0;class Dh extends Nh{constructor(i,f,y){super(i,y),this.type="HemisphereLight",this.position.copy(Me.DefaultUp),this.updateMatrix(),this.groundColor=new Xn(f)}copy(i){return Nh.prototype.copy.call(this,i),this.groundColor.copy(i.groundColor),this}}Dh.prototype.isHemisphereLight=!0;const Kp=new Nt,G_=new me,H_=new me;class W_{constructor(i){this.camera=i,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vn(512,512),this.map=null,this.mapPass=null,this.matrix=new Nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new nu,this._frameExtents=new Vn(1,1),this._viewportCount=1,this._viewports=[new Fe(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(i){const f=this.camera,y=this.matrix;G_.setFromMatrixPosition(i.matrixWorld),f.position.copy(G_),H_.setFromMatrixPosition(i.target.matrixWorld),f.lookAt(H_),f.updateMatrixWorld(),Kp.multiplyMatrices(f.projectionMatrix,f.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Kp),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(f.projectionMatrix),y.multiply(f.matrixWorldInverse)}getViewport(i){return this._viewports[i]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(i){return this.camera=i.camera.clone(),this.bias=i.bias,this.radius=i.radius,this.mapSize.copy(i.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const i={};return this.bias!==0&&(i.bias=this.bias),this.normalBias!==0&&(i.normalBias=this.normalBias),this.radius!==1&&(i.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(i.mapSize=this.mapSize.toArray()),i.camera=this.camera.toJSON(!1).object,delete i.camera.matrix,i}}class z3 extends W_{constructor(){super(new ga(50,1,.5,500)),this.focus=1}updateMatrices(i){const f=this.camera,y=2*Sr*i.angle*this.focus,_=this.mapSize.width/this.mapSize.height,S=i.distance||f.far;y===f.fov&&_===f.aspect&&S===f.far||(f.fov=y,f.aspect=_,f.far=S,f.updateProjectionMatrix()),super.updateMatrices(i)}copy(i){return super.copy(i),this.focus=i.focus,this}}z3.prototype.isSpotLightShadow=!0;class B3 extends Nh{constructor(i,f,y=0,_=Math.PI/3,S=0,I=1){super(i,f),this.type="SpotLight",this.position.copy(Me.DefaultUp),this.updateMatrix(),this.target=new Me,this.distance=y,this.angle=_,this.penumbra=S,this.decay=I,this.shadow=new z3}get power(){return this.intensity*Math.PI}set power(i){this.intensity=i/Math.PI}dispose(){this.shadow.dispose()}copy(i){return super.copy(i),this.distance=i.distance,this.angle=i.angle,this.penumbra=i.penumbra,this.decay=i.decay,this.target=i.target.clone(),this.shadow=i.shadow.clone(),this}}B3.prototype.isSpotLight=!0;const U3=new Nt,q_=new me,$_=new me;class G9 extends W_{constructor(){super(new ga(90,1,.5,500)),this._frameExtents=new Vn(4,2),this._viewportCount=6,this._viewports=[new Fe(2,1,1,1),new Fe(0,1,1,1),new Fe(3,1,1,1),new Fe(1,1,1,1),new Fe(3,0,1,1),new Fe(1,0,1,1)],this._cubeDirections=[new me(1,0,0),new me(-1,0,0),new me(0,0,1),new me(0,0,-1),new me(0,1,0),new me(0,-1,0)],this._cubeUps=[new me(0,1,0),new me(0,1,0),new me(0,1,0),new me(0,1,0),new me(0,0,1),new me(0,0,-1)]}updateMatrices(i,f=0){const y=this.camera,_=this.matrix,S=i.distance||y.far;S!==y.far&&(y.far=S,y.updateProjectionMatrix()),q_.setFromMatrixPosition(i.matrixWorld),y.position.copy(q_),$_.copy(y.position),$_.add(this._cubeDirections[f]),y.up.copy(this._cubeUps[f]),y.lookAt($_),y.updateMatrixWorld(),_.makeTranslation(-q_.x,-q_.y,-q_.z),U3.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),this._frustum.setFromProjectionMatrix(U3)}}G9.prototype.isPointLightShadow=!0;class X_ extends Nh{constructor(i,f,y=0,_=1){super(i,f),this.type="PointLight",this.distance=y,this.decay=_,this.shadow=new G9}get power(){return 4*this.intensity*Math.PI}set power(i){this.intensity=i/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(i){return super.copy(i),this.distance=i.distance,this.decay=i.decay,this.shadow=i.shadow.clone(),this}}X_.prototype.isPointLight=!0;class j3 extends W_{constructor(){super(new Tf(-5,5,5,-5,.5,500))}}j3.prototype.isDirectionalLightShadow=!0;class $v extends Nh{constructor(i,f){super(i,f),this.type="DirectionalLight",this.position.copy(Me.DefaultUp),this.updateMatrix(),this.target=new Me,this.shadow=new j3}dispose(){this.shadow.dispose()}copy(i){return super.copy(i),this.target=i.target.clone(),this.shadow=i.shadow.clone(),this}}$v.prototype.isDirectionalLight=!0;class Vf extends Nh{constructor(i,f){super(i,f),this.type="AmbientLight"}}Vf.prototype.isAmbientLight=!0;class Xv extends Nh{constructor(i,f,y=10,_=10){super(i,f),this.type="RectAreaLight",this.width=y,this.height=_}get power(){return this.intensity*this.width*this.height*Math.PI}set power(i){this.intensity=i/(this.width*this.height*Math.PI)}copy(i){return super.copy(i),this.width=i.width,this.height=i.height,this}toJSON(i){const f=super.toJSON(i);return f.object.width=this.width,f.object.height=this.height,f}}Xv.prototype.isRectAreaLight=!0;class V3{constructor(){this.coefficients=[];for(let i=0;i<9;i++)this.coefficients.push(new me)}set(i){for(let f=0;f<9;f++)this.coefficients[f].copy(i[f]);return this}zero(){for(let i=0;i<9;i++)this.coefficients[i].set(0,0,0);return this}getAt(i,f){const y=i.x,_=i.y,S=i.z,I=this.coefficients;return f.copy(I[0]).multiplyScalar(.282095),f.addScaledVector(I[1],.488603*_),f.addScaledVector(I[2],.488603*S),f.addScaledVector(I[3],.488603*y),f.addScaledVector(I[4],y*_*1.092548),f.addScaledVector(I[5],_*S*1.092548),f.addScaledVector(I[6],.315392*(3*S*S-1)),f.addScaledVector(I[7],y*S*1.092548),f.addScaledVector(I[8],.546274*(y*y-_*_)),f}getIrradianceAt(i,f){const y=i.x,_=i.y,S=i.z,I=this.coefficients;return f.copy(I[0]).multiplyScalar(.886227),f.addScaledVector(I[1],1.023328*_),f.addScaledVector(I[2],1.023328*S),f.addScaledVector(I[3],1.023328*y),f.addScaledVector(I[4],.858086*y*_),f.addScaledVector(I[5],.858086*_*S),f.addScaledVector(I[6],.743125*S*S-.247708),f.addScaledVector(I[7],.858086*y*S),f.addScaledVector(I[8],.429043*(y*y-_*_)),f}add(i){for(let f=0;f<9;f++)this.coefficients[f].add(i.coefficients[f]);return this}addScaledSH(i,f){for(let y=0;y<9;y++)this.coefficients[y].addScaledVector(i.coefficients[y],f);return this}scale(i){for(let f=0;f<9;f++)this.coefficients[f].multiplyScalar(i);return this}lerp(i,f){for(let y=0;y<9;y++)this.coefficients[y].lerp(i.coefficients[y],f);return this}equals(i){for(let f=0;f<9;f++)if(!this.coefficients[f].equals(i.coefficients[f]))return!1;return!0}copy(i){return this.set(i.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(i,f=0){const y=this.coefficients;for(let _=0;_<9;_++)y[_].fromArray(i,f+3*_);return this}toArray(i=[],f=0){const y=this.coefficients;for(let _=0;_<9;_++)y[_].toArray(i,f+3*_);return i}static getBasisAt(i,f){const y=i.x,_=i.y,S=i.z;f[0]=.282095,f[1]=.488603*_,f[2]=.488603*S,f[3]=.488603*y,f[4]=1.092548*y*_,f[5]=1.092548*_*S,f[6]=.315392*(3*S*S-1),f[7]=1.092548*y*S,f[8]=.546274*(y*y-_*_)}}V3.prototype.isSphericalHarmonics3=!0;class Nd extends Nh{constructor(i=new V3,f=1){super(void 0,f),this.sh=i}copy(i){return super.copy(i),this.sh.copy(i.sh),this}fromJSON(i){return this.intensity=i.intensity,this.sh.fromArray(i.sh),this}toJSON(i){const f=super.toJSON(i);return f.object.sh=this.sh.toArray(),f}}Nd.prototype.isLightProbe=!0;class Z_ extends Wl{constructor(i){super(i),this.textures={}}load(i,f,y,_){const S=this,I=new Qc(S.manager);I.setPath(S.path),I.setRequestHeader(S.requestHeader),I.setWithCredentials(S.withCredentials),I.load(i,function(R){try{f(S.parse(JSON.parse(R)))}catch(D){_?_(D):console.error(D),S.manager.itemError(i)}},y,_)}parse(i){const f=this.textures;function y(S){return f[S]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",S),f[S]}const _=new V_[i.type];if(i.uuid!==void 0&&(_.uuid=i.uuid),i.name!==void 0&&(_.name=i.name),i.color!==void 0&&_.color!==void 0&&_.color.setHex(i.color),i.roughness!==void 0&&(_.roughness=i.roughness),i.metalness!==void 0&&(_.metalness=i.metalness),i.sheenTint!==void 0&&(_.sheenTint=new Xn().setHex(i.sheenTint)),i.emissive!==void 0&&_.emissive!==void 0&&_.emissive.setHex(i.emissive),i.specular!==void 0&&_.specular!==void 0&&_.specular.setHex(i.specular),i.specularIntensity!==void 0&&(_.specularIntensity=i.specularIntensity),i.specularTint!==void 0&&_.specularTint!==void 0&&_.specularTint.setHex(i.specularTint),i.shininess!==void 0&&(_.shininess=i.shininess),i.clearcoat!==void 0&&(_.clearcoat=i.clearcoat),i.clearcoatRoughness!==void 0&&(_.clearcoatRoughness=i.clearcoatRoughness),i.transmission!==void 0&&(_.transmission=i.transmission),i.thickness!==void 0&&(_.thickness=i.thickness),i.attenuationDistance!==void 0&&(_.attenuationDistance=i.attenuationDistance),i.attenuationTint!==void 0&&_.attenuationTint!==void 0&&_.attenuationTint.setHex(i.attenuationTint),i.fog!==void 0&&(_.fog=i.fog),i.flatShading!==void 0&&(_.flatShading=i.flatShading),i.blending!==void 0&&(_.blending=i.blending),i.combine!==void 0&&(_.combine=i.combine),i.side!==void 0&&(_.side=i.side),i.shadowSide!==void 0&&(_.shadowSide=i.shadowSide),i.opacity!==void 0&&(_.opacity=i.opacity),i.format!==void 0&&(_.format=i.format),i.transparent!==void 0&&(_.transparent=i.transparent),i.alphaTest!==void 0&&(_.alphaTest=i.alphaTest),i.depthTest!==void 0&&(_.depthTest=i.depthTest),i.depthWrite!==void 0&&(_.depthWrite=i.depthWrite),i.colorWrite!==void 0&&(_.colorWrite=i.colorWrite),i.stencilWrite!==void 0&&(_.stencilWrite=i.stencilWrite),i.stencilWriteMask!==void 0&&(_.stencilWriteMask=i.stencilWriteMask),i.stencilFunc!==void 0&&(_.stencilFunc=i.stencilFunc),i.stencilRef!==void 0&&(_.stencilRef=i.stencilRef),i.stencilFuncMask!==void 0&&(_.stencilFuncMask=i.stencilFuncMask),i.stencilFail!==void 0&&(_.stencilFail=i.stencilFail),i.stencilZFail!==void 0&&(_.stencilZFail=i.stencilZFail),i.stencilZPass!==void 0&&(_.stencilZPass=i.stencilZPass),i.wireframe!==void 0&&(_.wireframe=i.wireframe),i.wireframeLinewidth!==void 0&&(_.wireframeLinewidth=i.wireframeLinewidth),i.wireframeLinecap!==void 0&&(_.wireframeLinecap=i.wireframeLinecap),i.wireframeLinejoin!==void 0&&(_.wireframeLinejoin=i.wireframeLinejoin),i.rotation!==void 0&&(_.rotation=i.rotation),i.linewidth!==1&&(_.linewidth=i.linewidth),i.dashSize!==void 0&&(_.dashSize=i.dashSize),i.gapSize!==void 0&&(_.gapSize=i.gapSize),i.scale!==void 0&&(_.scale=i.scale),i.polygonOffset!==void 0&&(_.polygonOffset=i.polygonOffset),i.polygonOffsetFactor!==void 0&&(_.polygonOffsetFactor=i.polygonOffsetFactor),i.polygonOffsetUnits!==void 0&&(_.polygonOffsetUnits=i.polygonOffsetUnits),i.dithering!==void 0&&(_.dithering=i.dithering),i.alphaToCoverage!==void 0&&(_.alphaToCoverage=i.alphaToCoverage),i.premultipliedAlpha!==void 0&&(_.premultipliedAlpha=i.premultipliedAlpha),i.visible!==void 0&&(_.visible=i.visible),i.toneMapped!==void 0&&(_.toneMapped=i.toneMapped),i.userData!==void 0&&(_.userData=i.userData),i.vertexColors!==void 0&&(typeof i.vertexColors=="number"?_.vertexColors=i.vertexColors>0:_.vertexColors=i.vertexColors),i.uniforms!==void 0)for(const S in i.uniforms){const I=i.uniforms[S];switch(_.uniforms[S]={},I.type){case"t":_.uniforms[S].value=y(I.value);break;case"c":_.uniforms[S].value=new Xn().setHex(I.value);break;case"v2":_.uniforms[S].value=new Vn().fromArray(I.value);break;case"v3":_.uniforms[S].value=new me().fromArray(I.value);break;case"v4":_.uniforms[S].value=new Fe().fromArray(I.value);break;case"m3":_.uniforms[S].value=new Di().fromArray(I.value);break;case"m4":_.uniforms[S].value=new Nt().fromArray(I.value);break;default:_.uniforms[S].value=I.value}}if(i.defines!==void 0&&(_.defines=i.defines),i.vertexShader!==void 0&&(_.vertexShader=i.vertexShader),i.fragmentShader!==void 0&&(_.fragmentShader=i.fragmentShader),i.extensions!==void 0)for(const S in i.extensions)_.extensions[S]=i.extensions[S];if(i.shading!==void 0&&(_.flatShading=i.shading===1),i.size!==void 0&&(_.size=i.size),i.sizeAttenuation!==void 0&&(_.sizeAttenuation=i.sizeAttenuation),i.map!==void 0&&(_.map=y(i.map)),i.matcap!==void 0&&(_.matcap=y(i.matcap)),i.alphaMap!==void 0&&(_.alphaMap=y(i.alphaMap)),i.bumpMap!==void 0&&(_.bumpMap=y(i.bumpMap)),i.bumpScale!==void 0&&(_.bumpScale=i.bumpScale),i.normalMap!==void 0&&(_.normalMap=y(i.normalMap)),i.normalMapType!==void 0&&(_.normalMapType=i.normalMapType),i.normalScale!==void 0){let S=i.normalScale;Array.isArray(S)===!1&&(S=[S,S]),_.normalScale=new Vn().fromArray(S)}return i.displacementMap!==void 0&&(_.displacementMap=y(i.displacementMap)),i.displacementScale!==void 0&&(_.displacementScale=i.displacementScale),i.displacementBias!==void 0&&(_.displacementBias=i.displacementBias),i.roughnessMap!==void 0&&(_.roughnessMap=y(i.roughnessMap)),i.metalnessMap!==void 0&&(_.metalnessMap=y(i.metalnessMap)),i.emissiveMap!==void 0&&(_.emissiveMap=y(i.emissiveMap)),i.emissiveIntensity!==void 0&&(_.emissiveIntensity=i.emissiveIntensity),i.specularMap!==void 0&&(_.specularMap=y(i.specularMap)),i.specularIntensityMap!==void 0&&(_.specularIntensityMap=y(i.specularIntensityMap)),i.specularTintMap!==void 0&&(_.specularTintMap=y(i.specularTintMap)),i.envMap!==void 0&&(_.envMap=y(i.envMap)),i.envMapIntensity!==void 0&&(_.envMapIntensity=i.envMapIntensity),i.reflectivity!==void 0&&(_.reflectivity=i.reflectivity),i.refractionRatio!==void 0&&(_.refractionRatio=i.refractionRatio),i.lightMap!==void 0&&(_.lightMap=y(i.lightMap)),i.lightMapIntensity!==void 0&&(_.lightMapIntensity=i.lightMapIntensity),i.aoMap!==void 0&&(_.aoMap=y(i.aoMap)),i.aoMapIntensity!==void 0&&(_.aoMapIntensity=i.aoMapIntensity),i.gradientMap!==void 0&&(_.gradientMap=y(i.gradientMap)),i.clearcoatMap!==void 0&&(_.clearcoatMap=y(i.clearcoatMap)),i.clearcoatRoughnessMap!==void 0&&(_.clearcoatRoughnessMap=y(i.clearcoatRoughnessMap)),i.clearcoatNormalMap!==void 0&&(_.clearcoatNormalMap=y(i.clearcoatNormalMap)),i.clearcoatNormalScale!==void 0&&(_.clearcoatNormalScale=new Vn().fromArray(i.clearcoatNormalScale)),i.transmissionMap!==void 0&&(_.transmissionMap=y(i.transmissionMap)),i.thicknessMap!==void 0&&(_.thicknessMap=y(i.thicknessMap)),_}setTextures(i){return this.textures=i,this}}class Y_{static decodeText(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let f="";for(let y=0,_=i.length;y<_;y++)f+=String.fromCharCode(i[y]);try{return decodeURIComponent(escape(f))}catch{return f}}static extractUrlBase(i){const f=i.lastIndexOf("/");return f===-1?"./":i.substr(0,f+1)}}class Zv extends bi{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(i){return super.copy(i),this.instanceCount=i.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const i=super.toJSON(this);return i.instanceCount=this.instanceCount,i.isInstancedBufferGeometry=!0,i}}Zv.prototype.isInstancedBufferGeometry=!0;class H9 extends Wl{constructor(i){super(i)}load(i,f,y,_){const S=this,I=new Qc(S.manager);I.setPath(S.path),I.setRequestHeader(S.requestHeader),I.setWithCredentials(S.withCredentials),I.load(i,function(R){try{f(S.parse(JSON.parse(R)))}catch(D){_?_(D):console.error(D),S.manager.itemError(i)}},y,_)}parse(i){const f={},y={};function _(W,Z){if(f[Z]!==void 0)return f[Z];const K=W.interleavedBuffers[Z],oe=function(pe,Ve){if(y[Ve]!==void 0)return y[Ve];const Ye=pe.arrayBuffers[Ve],$e=new Uint32Array(Ye).buffer;return y[Ve]=$e,$e}(W,K.buffer),de=dc(K.type,oe),ke=new vn(de,K.stride);return ke.uuid=K.uuid,f[Z]=ke,ke}const S=i.isInstancedBufferGeometry?new Zv:new bi,I=i.data.index;if(I!==void 0){const W=dc(I.type,I.array);S.setIndex(new xi(W,1))}const R=i.data.attributes;for(const W in R){const Z=R[W];let K;if(Z.isInterleavedBufferAttribute){const oe=_(i.data,Z.data);K=new kn(oe,Z.itemSize,Z.offset,Z.normalized)}else{const oe=dc(Z.type,Z.array);K=new(Z.isInstancedBufferAttribute?yc:xi)(oe,Z.itemSize,Z.normalized)}Z.name!==void 0&&(K.name=Z.name),Z.usage!==void 0&&K.setUsage(Z.usage),Z.updateRange!==void 0&&(K.updateRange.offset=Z.updateRange.offset,K.updateRange.count=Z.updateRange.count),S.setAttribute(W,K)}const D=i.data.morphAttributes;if(D)for(const W in D){const Z=D[W],K=[];for(let oe=0,de=Z.length;oe<de;oe++){const ke=Z[oe];let pe;if(ke.isInterleavedBufferAttribute){const Ve=_(i.data,ke.data);pe=new kn(Ve,ke.itemSize,ke.offset,ke.normalized)}else{const Ve=dc(ke.type,ke.array);pe=new xi(Ve,ke.itemSize,ke.normalized)}ke.name!==void 0&&(pe.name=ke.name),K.push(pe)}S.morphAttributes[W]=K}i.data.morphTargetsRelative&&(S.morphTargetsRelative=!0);const F=i.data.groups||i.data.drawcalls||i.data.offsets;if(F!==void 0)for(let W=0,Z=F.length;W!==Z;++W){const K=F[W];S.addGroup(K.start,K.count,K.materialIndex)}const G=i.data.boundingSphere;if(G!==void 0){const W=new me;G.center!==void 0&&W.fromArray(G.center),S.boundingSphere=new tl(W,G.radius)}return i.name&&(S.name=i.name),i.userData&&(S.userData=i.userData),S}}const GM={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},G3={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},W9={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};class H3 extends Wl{constructor(i){super(i),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(i){return this.options=i,this}load(i,f,y,_){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);const S=this,I=Hl.get(i);if(I!==void 0)return S.manager.itemStart(i),setTimeout(function(){f&&f(I),S.manager.itemEnd(i)},0),I;const R={};R.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",R.headers=this.requestHeader,fetch(i,R).then(function(D){return D.blob()}).then(function(D){return createImageBitmap(D,Object.assign(S.options,{colorSpaceConversion:"none"}))}).then(function(D){Hl.add(i,D),f&&f(D),S.manager.itemEnd(i)}).catch(function(D){_&&_(D),S.manager.itemError(i),S.manager.itemEnd(i)}),S.manager.itemStart(i)}}H3.prototype.isImageBitmapLoader=!0;class q9{constructor(){this.type="ShapePath",this.color=new Xn,this.subPaths=[],this.currentPath=null}moveTo(i,f){return this.currentPath=new bg,this.subPaths.push(this.currentPath),this.currentPath.moveTo(i,f),this}lineTo(i,f){return this.currentPath.lineTo(i,f),this}quadraticCurveTo(i,f,y,_){return this.currentPath.quadraticCurveTo(i,f,y,_),this}bezierCurveTo(i,f,y,_,S,I){return this.currentPath.bezierCurveTo(i,f,y,_,S,I),this}splineThru(i){return this.currentPath.splineThru(i),this}toShapes(i,f){function y(Ve){const Ye=[];for(let $e=0,_t=Ve.length;$e<_t;$e++){const bt=Ve[$e],Vt=new jf;Vt.curves=bt.curves,Ye.push(Vt)}return Ye}function _(Ve,Ye){const $e=Ye.length;let _t=!1;for(let bt=$e-1,Vt=0;Vt<$e;bt=Vt++){let qt=Ye[bt],mn=Ye[Vt],sn=mn.x-qt.x,dn=mn.y-qt.y;if(Math.abs(dn)>Number.EPSILON){if(dn<0&&(qt=Ye[Vt],sn=-sn,mn=Ye[bt],dn=-dn),Ve.y<qt.y||Ve.y>mn.y)continue;if(Ve.y===qt.y){if(Ve.x===qt.x)return!0}else{const wr=dn*(Ve.x-qt.x)-sn*(Ve.y-qt.y);if(wr===0)return!0;if(wr<0)continue;_t=!_t}}else{if(Ve.y!==qt.y)continue;if(mn.x<=Ve.x&&Ve.x<=qt.x||qt.x<=Ve.x&&Ve.x<=mn.x)return!0}}return _t}const S=Yc.isClockWise,I=this.subPaths;if(I.length===0)return[];if(f===!0)return y(I);let R,D,F;const G=[];if(I.length===1)return D=I[0],F=new jf,F.curves=D.curves,G.push(F),G;let W=!S(I[0].getPoints());W=i?!W:W;const Z=[],K=[];let oe,de,ke=[],pe=0;K[pe]=void 0,ke[pe]=[];for(let Ve=0,Ye=I.length;Ve<Ye;Ve++)D=I[Ve],oe=D.getPoints(),R=S(oe),R=i?!R:R,R?(!W&&K[pe]&&pe++,K[pe]={s:new jf,p:oe},K[pe].s.curves=D.curves,W&&pe++,ke[pe]=[]):ke[pe].push({h:D,p:oe[0]});if(!K[0])return y(I);if(K.length>1){let Ve=!1;const Ye=[];for(let $e=0,_t=K.length;$e<_t;$e++)Z[$e]=[];for(let $e=0,_t=K.length;$e<_t;$e++){const bt=ke[$e];for(let Vt=0;Vt<bt.length;Vt++){const qt=bt[Vt];let mn=!0;for(let sn=0;sn<K.length;sn++)_(qt.p,K[sn].p)&&($e!==sn&&Ye.push({froms:$e,tos:sn,hole:Vt}),mn?(mn=!1,Z[sn].push(qt)):Ve=!0);mn&&Z[$e].push(qt)}}Ye.length>0&&(Ve||(ke=Z))}for(let Ve=0,Ye=K.length;Ve<Ye;Ve++){F=K[Ve].s,G.push(F),de=ke[Ve];for(let $e=0,_t=de.length;$e<_t;$e++)F.holes.push(de[$e].h)}return G}}class W3{constructor(i){this.type="Font",this.data=i}generateShapes(i,f=100){const y=[],_=function(S,I,R){const D=Array.from(S),F=I/R.resolution,G=(R.boundingBox.yMax-R.boundingBox.yMin+R.underlineThickness)*F,W=[];let Z=0,K=0;for(let oe=0;oe<D.length;oe++){const de=D[oe];if(de===`
`)Z=0,K-=G;else{const ke=$9(de,F,Z,K,R);Z+=ke.offsetX,W.push(ke.path)}}return W}(i,f,this.data);for(let S=0,I=_.length;S<I;S++)Array.prototype.push.apply(y,_[S].toShapes());return y}}function $9(M,i,f,y,_){const S=_.glyphs[M]||_.glyphs["?"];if(!S)return void console.error('THREE.Font: character "'+M+'" does not exists in font family '+_.familyName+".");const I=new q9;let R,D,F,G,W,Z,K,oe;if(S.o){const de=S._cachedOutline||(S._cachedOutline=S.o.split(" "));for(let ke=0,pe=de.length;ke<pe;)switch(de[ke++]){case"m":R=de[ke++]*i+f,D=de[ke++]*i+y,I.moveTo(R,D);break;case"l":R=de[ke++]*i+f,D=de[ke++]*i+y,I.lineTo(R,D);break;case"q":F=de[ke++]*i+f,G=de[ke++]*i+y,W=de[ke++]*i+f,Z=de[ke++]*i+y,I.quadraticCurveTo(W,Z,F,G);break;case"b":F=de[ke++]*i+f,G=de[ke++]*i+y,W=de[ke++]*i+f,Z=de[ke++]*i+y,K=de[ke++]*i+f,oe=de[ke++]*i+y,I.bezierCurveTo(W,Z,K,oe,F,G)}}return{offsetX:S.ha*i,path:I}}W3.prototype.isFont=!0;let K_;const Yv={getContext:function(){return K_===void 0&&(K_=new(window.AudioContext||window.webkitAudioContext)),K_},setContext:function(M){K_=M}};class Kv extends Wl{constructor(i){super(i)}load(i,f,y,_){const S=this,I=new Qc(this.manager);I.setResponseType("arraybuffer"),I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(i,function(R){try{const D=R.slice(0);Yv.getContext().decodeAudioData(D,function(F){f(F)})}catch(D){_?_(D):console.error(D),S.manager.itemError(i)}},y,_)}}class Dd extends Nd{constructor(i,f,y=1){super(void 0,y);const _=new Xn().set(i),S=new Xn().set(f),I=new me(_.r,_.g,_.b),R=new me(S.r,S.g,S.b),D=Math.sqrt(Math.PI),F=D*Math.sqrt(.75);this.sh.coefficients[0].copy(I).add(R).multiplyScalar(D),this.sh.coefficients[1].copy(I).sub(R).multiplyScalar(F)}}Dd.prototype.isHemisphereLightProbe=!0;class Tu extends Nd{constructor(i,f=1){super(void 0,f);const y=new Xn().set(i);this.sh.coefficients[0].set(y.r,y.g,y.b).multiplyScalar(2*Math.sqrt(Math.PI))}}Tu.prototype.isAmbientLightProbe=!0;const X9=new Nt,Jv=new Nt;class Z9{constructor(i=!0){this.autoStart=i,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Y9(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let i=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const f=Y9();i=(f-this.oldTime)/1e3,this.oldTime=f,this.elapsedTime+=i}return i}}function Y9(){return(typeof performance>"u"?Date:performance).now()}const wg=new me,Qv=new at,ex=new me,Jp=new me;class Gf extends Me{constructor(i){super(),this.type="Audio",this.listener=i,this.context=i.context,this.gain=this.context.createGain(),this.gain.connect(i.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(i){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=i,this.connect(),this}setMediaElementSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(i),this.connect(),this}setMediaStreamSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(i),this.connect(),this}setBuffer(i){return this.buffer=i,this.sourceType="buffer",this.autoplay&&this.play(),this}play(i=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+i;const f=this.context.createBufferSource();return f.buffer=this.buffer,f.loop=this.loop,f.loopStart=this.loopStart,f.loopEnd=this.loopEnd,f.onended=this.onEnded.bind(this),f.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=f,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let i=1,f=this.filters.length;i<f;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let i=1,f=this.filters.length;i<f;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(i){return i||(i=[]),this._connected===!0?(this.disconnect(),this.filters=i.slice(),this.connect()):this.filters=i.slice(),this}setDetune(i){if(this.detune=i,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(i){return this.setFilters(i?[i]:[])}setPlaybackRate(i){if(this.hasPlaybackControl!==!1)return this.playbackRate=i,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(i){if(this.hasPlaybackControl!==!1)return this.loop=i,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(i){return this.loopStart=i,this}setLoopEnd(i){return this.loopEnd=i,this}getVolume(){return this.gain.gain.value}setVolume(i){return this.gain.gain.setTargetAtTime(i,this.context.currentTime,.01),this}}const Oh=new me,K9=new at,HM=new me,Eg=new me;class J9{constructor(i,f=2048){this.analyser=i.context.createAnalyser(),this.analyser.fftSize=f,this.data=new Uint8Array(this.analyser.frequencyBinCount),i.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let i=0;const f=this.getFrequencyData();for(let y=0;y<f.length;y++)i+=f[y];return i/f.length}}class Q9{constructor(i,f,y){let _,S,I;switch(this.binding=i,this.valueSize=y,f){case"quaternion":_=this._slerp,S=this._slerpAdditive,I=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*y),this._workIndex=5;break;case"string":case"bool":_=this._select,S=this._select,I=this._setAdditiveIdentityOther,this.buffer=new Array(5*y);break;default:_=this._lerp,S=this._lerpAdditive,I=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*y)}this._mixBufferRegion=_,this._mixBufferRegionAdditive=S,this._setIdentity=I,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(i,f){const y=this.buffer,_=this.valueSize,S=i*_+_;let I=this.cumulativeWeight;if(I===0){for(let R=0;R!==_;++R)y[S+R]=y[R];I=f}else{I+=f;const R=f/I;this._mixBufferRegion(y,S,0,R,_)}this.cumulativeWeight=I}accumulateAdditive(i){const f=this.buffer,y=this.valueSize,_=y*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(f,_,0,i,y),this.cumulativeWeightAdditive+=i}apply(i){const f=this.valueSize,y=this.buffer,_=i*f+f,S=this.cumulativeWeight,I=this.cumulativeWeightAdditive,R=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,S<1){const D=f*this._origIndex;this._mixBufferRegion(y,_,D,1-S,f)}I>0&&this._mixBufferRegionAdditive(y,_,this._addIndex*f,1,f);for(let D=f,F=f+f;D!==F;++D)if(y[D]!==y[D+f]){R.setValue(y,_);break}}saveOriginalState(){const i=this.binding,f=this.buffer,y=this.valueSize,_=y*this._origIndex;i.getValue(f,_);for(let S=y,I=_;S!==I;++S)f[S]=f[_+S%y];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const i=3*this.valueSize;this.binding.setValue(this.buffer,i)}_setAdditiveIdentityNumeric(){const i=this._addIndex*this.valueSize,f=i+this.valueSize;for(let y=i;y<f;y++)this.buffer[y]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const i=this._origIndex*this.valueSize,f=this._addIndex*this.valueSize;for(let y=0;y<this.valueSize;y++)this.buffer[f+y]=this.buffer[i+y]}_select(i,f,y,_,S){if(_>=.5)for(let I=0;I!==S;++I)i[f+I]=i[y+I]}_slerp(i,f,y,_){at.slerpFlat(i,f,i,f,i,y,_)}_slerpAdditive(i,f,y,_,S){const I=this._workIndex*S;at.multiplyQuaternionsFlat(i,I,i,f,i,y),at.slerpFlat(i,f,i,f,i,I,_)}_lerp(i,f,y,_,S){const I=1-_;for(let R=0;R!==S;++R){const D=f+R;i[D]=i[D]*I+i[y+R]*_}}_lerpAdditive(i,f,y,_,S){for(let I=0;I!==S;++I){const R=f+I;i[R]=i[R]+i[y+I]*_}}}const WM="\\[\\]\\.:\\/",qM=new RegExp("[\\[\\]\\.:\\/]","g"),J_="[^\\[\\]\\.:\\/]",$M="[^"+WM.replace("\\.","")+"]",j0=/((?:WC+[\/:])*)/.source.replace("WC",J_),XM=/(WCOD+)?/.source.replace("WCOD",$M),ra=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",J_),tx=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",J_),e4=new RegExp("^"+j0+XM+ra+tx+"$"),nx=["material","materials","bones"];class ws{constructor(i,f,y){this.path=f,this.parsedPath=y||ws.parseTrackName(f),this.node=ws.findNode(i,this.parsedPath.nodeName)||i,this.rootNode=i,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(i,f,y){return i&&i.isAnimationObjectGroup?new ws.Composite(i,f,y):new ws(i,f,y)}static sanitizeNodeName(i){return i.replace(/\s/g,"_").replace(qM,"")}static parseTrackName(i){const f=e4.exec(i);if(!f)throw new Error("PropertyBinding: Cannot parse trackName: "+i);const y={nodeName:f[2],objectName:f[3],objectIndex:f[4],propertyName:f[5],propertyIndex:f[6]},_=y.nodeName&&y.nodeName.lastIndexOf(".");if(_!==void 0&&_!==-1){const S=y.nodeName.substring(_+1);nx.indexOf(S)!==-1&&(y.nodeName=y.nodeName.substring(0,_),y.objectName=S)}if(y.propertyName===null||y.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+i);return y}static findNode(i,f){if(!f||f===""||f==="."||f===-1||f===i.name||f===i.uuid)return i;if(i.skeleton){const y=i.skeleton.getBoneByName(f);if(y!==void 0)return y}if(i.children){const y=function(S){for(let I=0;I<S.length;I++){const R=S[I];if(R.name===f||R.uuid===f)return R;const D=y(R.children);if(D)return D}return null},_=y(i.children);if(_)return _}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(i,f){i[f]=this.targetObject[this.propertyName]}_getValue_array(i,f){const y=this.resolvedProperty;for(let _=0,S=y.length;_!==S;++_)i[f++]=y[_]}_getValue_arrayElement(i,f){i[f]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(i,f){this.resolvedProperty.toArray(i,f)}_setValue_direct(i,f){this.targetObject[this.propertyName]=i[f]}_setValue_direct_setNeedsUpdate(i,f){this.targetObject[this.propertyName]=i[f],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(i,f){this.targetObject[this.propertyName]=i[f],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(i,f){const y=this.resolvedProperty;for(let _=0,S=y.length;_!==S;++_)y[_]=i[f++]}_setValue_array_setNeedsUpdate(i,f){const y=this.resolvedProperty;for(let _=0,S=y.length;_!==S;++_)y[_]=i[f++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(i,f){const y=this.resolvedProperty;for(let _=0,S=y.length;_!==S;++_)y[_]=i[f++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(i,f){this.resolvedProperty[this.propertyIndex]=i[f]}_setValue_arrayElement_setNeedsUpdate(i,f){this.resolvedProperty[this.propertyIndex]=i[f],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(i,f){this.resolvedProperty[this.propertyIndex]=i[f],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(i,f){this.resolvedProperty.fromArray(i,f)}_setValue_fromArray_setNeedsUpdate(i,f){this.resolvedProperty.fromArray(i,f),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(i,f){this.resolvedProperty.fromArray(i,f),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(i,f){this.bind(),this.getValue(i,f)}_setValue_unbound(i,f){this.bind(),this.setValue(i,f)}bind(){let i=this.node;const f=this.parsedPath,y=f.objectName,_=f.propertyName;let S=f.propertyIndex;if(i||(i=ws.findNode(this.rootNode,f.nodeName)||this.rootNode,this.node=i),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!i)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(y){let F=f.objectIndex;switch(y){case"materials":if(!i.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!i.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);i=i.material.materials;break;case"bones":if(!i.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);i=i.skeleton.bones;for(let G=0;G<i.length;G++)if(i[G].name===F){F=G;break}break;default:if(i[y]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);i=i[y]}if(F!==void 0){if(i[F]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,i);i=i[F]}}const I=i[_];if(I===void 0){const F=f.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+F+"."+_+" but it wasn't found.",i)}let R=this.Versioning.None;this.targetObject=i,i.needsUpdate!==void 0?R=this.Versioning.NeedsUpdate:i.matrixWorldNeedsUpdate!==void 0&&(R=this.Versioning.MatrixWorldNeedsUpdate);let D=this.BindingType.Direct;if(S!==void 0){if(_==="morphTargetInfluences"){if(!i.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!i.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!i.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);i.morphTargetDictionary[S]!==void 0&&(S=i.morphTargetDictionary[S])}D=this.BindingType.ArrayElement,this.resolvedProperty=I,this.propertyIndex=S}else I.fromArray!==void 0&&I.toArray!==void 0?(D=this.BindingType.HasFromToArray,this.resolvedProperty=I):Array.isArray(I)?(D=this.BindingType.EntireArray,this.resolvedProperty=I):this.propertyName=_;this.getValue=this.GetterByBindingType[D],this.setValue=this.SetterByBindingTypeAndVersioning[D][R]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ws.Composite=class{constructor(M,i,f){const y=f||ws.parseTrackName(i);this._targetGroup=M,this._bindings=M.subscribe_(i,y)}getValue(M,i){this.bind();const f=this._targetGroup.nCachedObjects_,y=this._bindings[f];y!==void 0&&y.getValue(M,i)}setValue(M,i){const f=this._bindings;for(let y=this._targetGroup.nCachedObjects_,_=f.length;y!==_;++y)f[y].setValue(M,i)}bind(){const M=this._bindings;for(let i=this._targetGroup.nCachedObjects_,f=M.length;i!==f;++i)M[i].bind()}unbind(){const M=this._bindings;for(let i=this._targetGroup.nCachedObjects_,f=M.length;i!==f;++i)M[i].unbind()}},ws.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ws.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ws.prototype.GetterByBindingType=[ws.prototype._getValue_direct,ws.prototype._getValue_array,ws.prototype._getValue_arrayElement,ws.prototype._getValue_toArray],ws.prototype.SetterByBindingTypeAndVersioning=[[ws.prototype._setValue_direct,ws.prototype._setValue_direct_setNeedsUpdate,ws.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ws.prototype._setValue_array,ws.prototype._setValue_array_setNeedsUpdate,ws.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ws.prototype._setValue_arrayElement,ws.prototype._setValue_arrayElement_setNeedsUpdate,ws.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ws.prototype._setValue_fromArray,ws.prototype._setValue_fromArray_setNeedsUpdate,ws.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class V0{constructor(){this.uuid=Dr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const i={};this._indicesByUUID=i;for(let y=0,_=arguments.length;y!==_;++y)i[arguments[y].uuid]=y;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const f=this;this.stats={objects:{get total(){return f._objects.length},get inUse(){return this.total-f.nCachedObjects_}},get bindingsPerObject(){return f._bindings.length}}}add(){const i=this._objects,f=this._indicesByUUID,y=this._paths,_=this._parsedPaths,S=this._bindings,I=S.length;let R,D=i.length,F=this.nCachedObjects_;for(let G=0,W=arguments.length;G!==W;++G){const Z=arguments[G],K=Z.uuid;let oe=f[K];if(oe===void 0){oe=D++,f[K]=oe,i.push(Z);for(let de=0,ke=I;de!==ke;++de)S[de].push(new ws(Z,y[de],_[de]))}else if(oe<F){R=i[oe];const de=--F,ke=i[de];f[ke.uuid]=oe,i[oe]=ke,f[K]=de,i[de]=Z;for(let pe=0,Ve=I;pe!==Ve;++pe){const Ye=S[pe],$e=Ye[de];let _t=Ye[oe];Ye[oe]=$e,_t===void 0&&(_t=new ws(Z,y[pe],_[pe])),Ye[de]=_t}}else i[oe]!==R&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=F}remove(){const i=this._objects,f=this._indicesByUUID,y=this._bindings,_=y.length;let S=this.nCachedObjects_;for(let I=0,R=arguments.length;I!==R;++I){const D=arguments[I],F=D.uuid,G=f[F];if(G!==void 0&&G>=S){const W=S++,Z=i[W];f[Z.uuid]=G,i[G]=Z,f[F]=W,i[W]=D;for(let K=0,oe=_;K!==oe;++K){const de=y[K],ke=de[W],pe=de[G];de[G]=ke,de[W]=pe}}}this.nCachedObjects_=S}uncache(){const i=this._objects,f=this._indicesByUUID,y=this._bindings,_=y.length;let S=this.nCachedObjects_,I=i.length;for(let R=0,D=arguments.length;R!==D;++R){const F=arguments[R].uuid,G=f[F];if(G!==void 0)if(delete f[F],G<S){const W=--S,Z=i[W],K=--I,oe=i[K];f[Z.uuid]=G,i[G]=Z,f[oe.uuid]=W,i[W]=oe,i.pop();for(let de=0,ke=_;de!==ke;++de){const pe=y[de],Ve=pe[W],Ye=pe[K];pe[G]=Ve,pe[W]=Ye,pe.pop()}}else{const W=--I,Z=i[W];W>0&&(f[Z.uuid]=G),i[G]=Z,i.pop();for(let K=0,oe=_;K!==oe;++K){const de=y[K];de[G]=de[W],de.pop()}}}this.nCachedObjects_=S}subscribe_(i,f){const y=this._bindingsIndicesByPath;let _=y[i];const S=this._bindings;if(_!==void 0)return S[_];const I=this._paths,R=this._parsedPaths,D=this._objects,F=D.length,G=this.nCachedObjects_,W=new Array(F);_=S.length,y[i]=_,I.push(i),R.push(f),S.push(W);for(let Z=G,K=D.length;Z!==K;++Z){const oe=D[Z];W[Z]=new ws(oe,i,f)}return W}unsubscribe_(i){const f=this._bindingsIndicesByPath,y=f[i];if(y!==void 0){const _=this._paths,S=this._parsedPaths,I=this._bindings,R=I.length-1,D=I[R];f[i[R]]=y,I[y]=D,I.pop(),S[y]=S[R],S.pop(),_[y]=_[R],_.pop()}}}V0.prototype.isAnimationObjectGroup=!0;class t4{constructor(i,f,y=null,_=f.blendMode){this._mixer=i,this._clip=f,this._localRoot=y,this.blendMode=_;const S=f.tracks,I=S.length,R=new Array(I),D={endingStart:2400,endingEnd:2400};for(let F=0;F!==I;++F){const G=S[F].createInterpolant(null);R[F]=G,G.settings=D}this._interpolantSettings=D,this._interpolants=R,this._propertyBindings=new Array(I),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(i){return this._startTime=i,this}setLoop(i,f){return this.loop=i,this.repetitions=f,this}setEffectiveWeight(i){return this.weight=i,this._effectiveWeight=this.enabled?i:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(i){return this._scheduleFading(i,0,1)}fadeOut(i){return this._scheduleFading(i,1,0)}crossFadeFrom(i,f,y){if(i.fadeOut(f),this.fadeIn(f),y){const _=this._clip.duration,S=i._clip.duration,I=S/_,R=_/S;i.warp(1,I,f),this.warp(R,1,f)}return this}crossFadeTo(i,f,y){return i.crossFadeFrom(this,f,y)}stopFading(){const i=this._weightInterpolant;return i!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}setEffectiveTimeScale(i){return this.timeScale=i,this._effectiveTimeScale=this.paused?0:i,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(i){return this.timeScale=this._clip.duration/i,this.stopWarping()}syncWith(i){return this.time=i.time,this.timeScale=i.timeScale,this.stopWarping()}halt(i){return this.warp(this._effectiveTimeScale,0,i)}warp(i,f,y){const _=this._mixer,S=_.time,I=this.timeScale;let R=this._timeScaleInterpolant;R===null&&(R=_._lendControlInterpolant(),this._timeScaleInterpolant=R);const D=R.parameterPositions,F=R.sampleValues;return D[0]=S,D[1]=S+y,F[0]=i/I,F[1]=f/I,this}stopWarping(){const i=this._timeScaleInterpolant;return i!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,f,y,_){if(!this.enabled)return void this._updateWeight(i);const S=this._startTime;if(S!==null){const D=(i-S)*y;if(D<0||y===0)return;this._startTime=null,f=y*D}f*=this._updateTimeScale(i);const I=this._updateTime(f),R=this._updateWeight(i);if(R>0){const D=this._interpolants,F=this._propertyBindings;switch(this.blendMode){case 2501:for(let G=0,W=D.length;G!==W;++G)D[G].evaluate(I),F[G].accumulateAdditive(R);break;case 2500:default:for(let G=0,W=D.length;G!==W;++G)D[G].evaluate(I),F[G].accumulate(_,R)}}}_updateWeight(i){let f=0;if(this.enabled){f=this.weight;const y=this._weightInterpolant;if(y!==null){const _=y.evaluate(i)[0];f*=_,i>y.parameterPositions[1]&&(this.stopFading(),_===0&&(this.enabled=!1))}}return this._effectiveWeight=f,f}_updateTimeScale(i){let f=0;if(!this.paused){f=this.timeScale;const y=this._timeScaleInterpolant;y!==null&&(f*=y.evaluate(i)[0],i>y.parameterPositions[1]&&(this.stopWarping(),f===0?this.paused=!0:this.timeScale=f))}return this._effectiveTimeScale=f,f}_updateTime(i){const f=this._clip.duration,y=this.loop;let _=this.time+i,S=this._loopCount;const I=y===2202;if(i===0)return S===-1?_:I&&(1&S)==1?f-_:_;if(y===2200){S===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_>=f)_=f;else{if(!(_<0)){this.time=_;break e}_=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:i<0?-1:1})}}else{if(S===-1&&(i>=0?(S=0,this._setEndings(!0,this.repetitions===0,I)):this._setEndings(this.repetitions===0,!0,I)),_>=f||_<0){const R=Math.floor(_/f);_-=f*R,S+=Math.abs(R);const D=this.repetitions-S;if(D<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,_=i>0?f:0,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:i>0?1:-1});else{if(D===1){const F=i<0;this._setEndings(F,!F,I)}else this._setEndings(!1,!1,I);this._loopCount=S,this.time=_,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:R})}}else this.time=_;if(I&&(1&S)==1)return f-_}return _}_setEndings(i,f,y){const _=this._interpolantSettings;y?(_.endingStart=2401,_.endingEnd=2401):(_.endingStart=i?this.zeroSlopeAtStart?2401:2400:2402,_.endingEnd=f?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(i,f,y){const _=this._mixer,S=_.time;let I=this._weightInterpolant;I===null&&(I=_._lendControlInterpolant(),this._weightInterpolant=I);const R=I.parameterPositions,D=I.sampleValues;return R[0]=S,D[0]=f,R[1]=S+i,D[1]=y,this}}class q3 extends en{constructor(i){super(),this._root=i,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(i,f){const y=i._localRoot||this._root,_=i._clip.tracks,S=_.length,I=i._propertyBindings,R=i._interpolants,D=y.uuid,F=this._bindingsByRootAndName;let G=F[D];G===void 0&&(G={},F[D]=G);for(let W=0;W!==S;++W){const Z=_[W],K=Z.name;let oe=G[K];if(oe!==void 0)I[W]=oe;else{if(oe=I[W],oe!==void 0){oe._cacheIndex===null&&(++oe.referenceCount,this._addInactiveBinding(oe,D,K));continue}const de=f&&f._propertyBindings[W].binding.parsedPath;oe=new Q9(ws.create(y,K,de),Z.ValueTypeName,Z.getValueSize()),++oe.referenceCount,this._addInactiveBinding(oe,D,K),I[W]=oe}R[W].resultBuffer=oe.buffer}}_activateAction(i){if(!this._isActiveAction(i)){if(i._cacheIndex===null){const y=(i._localRoot||this._root).uuid,_=i._clip.uuid,S=this._actionsByClip[_];this._bindAction(i,S&&S.knownActions[0]),this._addInactiveAction(i,_,y)}const f=i._propertyBindings;for(let y=0,_=f.length;y!==_;++y){const S=f[y];S.useCount++==0&&(this._lendBinding(S),S.saveOriginalState())}this._lendAction(i)}}_deactivateAction(i){if(this._isActiveAction(i)){const f=i._propertyBindings;for(let y=0,_=f.length;y!==_;++y){const S=f[y];--S.useCount==0&&(S.restoreOriginalState(),this._takeBackBinding(S))}this._takeBackAction(i)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const i=this;this.stats={actions:{get total(){return i._actions.length},get inUse(){return i._nActiveActions}},bindings:{get total(){return i._bindings.length},get inUse(){return i._nActiveBindings}},controlInterpolants:{get total(){return i._controlInterpolants.length},get inUse(){return i._nActiveControlInterpolants}}}}_isActiveAction(i){const f=i._cacheIndex;return f!==null&&f<this._nActiveActions}_addInactiveAction(i,f,y){const _=this._actions,S=this._actionsByClip;let I=S[f];if(I===void 0)I={knownActions:[i],actionByRoot:{}},i._byClipCacheIndex=0,S[f]=I;else{const R=I.knownActions;i._byClipCacheIndex=R.length,R.push(i)}i._cacheIndex=_.length,_.push(i),I.actionByRoot[y]=i}_removeInactiveAction(i){const f=this._actions,y=f[f.length-1],_=i._cacheIndex;y._cacheIndex=_,f[_]=y,f.pop(),i._cacheIndex=null;const S=i._clip.uuid,I=this._actionsByClip,R=I[S],D=R.knownActions,F=D[D.length-1],G=i._byClipCacheIndex;F._byClipCacheIndex=G,D[G]=F,D.pop(),i._byClipCacheIndex=null,delete R.actionByRoot[(i._localRoot||this._root).uuid],D.length===0&&delete I[S],this._removeInactiveBindingsForAction(i)}_removeInactiveBindingsForAction(i){const f=i._propertyBindings;for(let y=0,_=f.length;y!==_;++y){const S=f[y];--S.referenceCount==0&&this._removeInactiveBinding(S)}}_lendAction(i){const f=this._actions,y=i._cacheIndex,_=this._nActiveActions++,S=f[_];i._cacheIndex=_,f[_]=i,S._cacheIndex=y,f[y]=S}_takeBackAction(i){const f=this._actions,y=i._cacheIndex,_=--this._nActiveActions,S=f[_];i._cacheIndex=_,f[_]=i,S._cacheIndex=y,f[y]=S}_addInactiveBinding(i,f,y){const _=this._bindingsByRootAndName,S=this._bindings;let I=_[f];I===void 0&&(I={},_[f]=I),I[y]=i,i._cacheIndex=S.length,S.push(i)}_removeInactiveBinding(i){const f=this._bindings,y=i.binding,_=y.rootNode.uuid,S=y.path,I=this._bindingsByRootAndName,R=I[_],D=f[f.length-1],F=i._cacheIndex;D._cacheIndex=F,f[F]=D,f.pop(),delete R[S],Object.keys(R).length===0&&delete I[_]}_lendBinding(i){const f=this._bindings,y=i._cacheIndex,_=this._nActiveBindings++,S=f[_];i._cacheIndex=_,f[_]=i,S._cacheIndex=y,f[y]=S}_takeBackBinding(i){const f=this._bindings,y=i._cacheIndex,_=--this._nActiveBindings,S=f[_];i._cacheIndex=_,f[_]=i,S._cacheIndex=y,f[y]=S}_lendControlInterpolant(){const i=this._controlInterpolants,f=this._nActiveControlInterpolants++;let y=i[f];return y===void 0&&(y=new Gv(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),y.__cacheIndex=f,i[f]=y),y}_takeBackControlInterpolant(i){const f=this._controlInterpolants,y=i.__cacheIndex,_=--this._nActiveControlInterpolants,S=f[_];i.__cacheIndex=_,f[_]=i,S.__cacheIndex=y,f[y]=S}clipAction(i,f,y){const _=f||this._root,S=_.uuid;let I=typeof i=="string"?Xu.findByName(_,i):i;const R=I!==null?I.uuid:i,D=this._actionsByClip[R];let F=null;if(y===void 0&&(y=I!==null?I.blendMode:2500),D!==void 0){const W=D.actionByRoot[S];if(W!==void 0&&W.blendMode===y)return W;F=D.knownActions[0],I===null&&(I=F._clip)}if(I===null)return null;const G=new t4(this,I,f,y);return this._bindAction(G,F),this._addInactiveAction(G,R,S),G}existingAction(i,f){const y=f||this._root,_=y.uuid,S=typeof i=="string"?Xu.findByName(y,i):i,I=S?S.uuid:i,R=this._actionsByClip[I];return R!==void 0&&R.actionByRoot[_]||null}stopAllAction(){const i=this._actions;for(let f=this._nActiveActions-1;f>=0;--f)i[f].stop();return this}update(i){i*=this.timeScale;const f=this._actions,y=this._nActiveActions,_=this.time+=i,S=Math.sign(i),I=this._accuIndex^=1;for(let F=0;F!==y;++F)f[F]._update(_,i,S,I);const R=this._bindings,D=this._nActiveBindings;for(let F=0;F!==D;++F)R[F].apply(I);return this}setTime(i){this.time=0;for(let f=0;f<this._actions.length;f++)this._actions[f].time=0;return this.update(i)}getRoot(){return this._root}uncacheClip(i){const f=this._actions,y=i.uuid,_=this._actionsByClip,S=_[y];if(S!==void 0){const I=S.knownActions;for(let R=0,D=I.length;R!==D;++R){const F=I[R];this._deactivateAction(F);const G=F._cacheIndex,W=f[f.length-1];F._cacheIndex=null,F._byClipCacheIndex=null,W._cacheIndex=G,f[G]=W,f.pop(),this._removeInactiveBindingsForAction(F)}delete _[y]}}uncacheRoot(i){const f=i.uuid,y=this._actionsByClip;for(const S in y){const I=y[S].actionByRoot[f];I!==void 0&&(this._deactivateAction(I),this._removeInactiveAction(I))}const _=this._bindingsByRootAndName[f];if(_!==void 0)for(const S in _){const I=_[S];I.restoreOriginalState(),this._removeInactiveBinding(I)}}uncacheAction(i,f){const y=this.existingAction(i,f);y!==null&&(this._deactivateAction(y),this._removeInactiveAction(y))}}q3.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Qp{constructor(i){typeof i=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),i=arguments[1]),this.value=i}clone(){return new Qp(this.value.clone===void 0?this.value:this.value.clone())}}class rx extends vn{constructor(i,f,y=1){super(i,f),this.meshPerAttribute=y}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}clone(i){const f=super.clone(i);return f.meshPerAttribute=this.meshPerAttribute,f}toJSON(i){const f=super.toJSON(i);return f.isInstancedInterleavedBuffer=!0,f.meshPerAttribute=this.meshPerAttribute,f}}rx.prototype.isInstancedInterleavedBuffer=!0;class ix{constructor(i,f,y,_,S){this.buffer=i,this.type=f,this.itemSize=y,this.elementSize=_,this.count=S,this.version=0}set needsUpdate(i){i===!0&&this.version++}setBuffer(i){return this.buffer=i,this}setType(i,f){return this.type=i,this.elementSize=f,this}setItemSize(i){return this.itemSize=i,this}setCount(i){return this.count=i,this}}ix.prototype.isGLBufferAttribute=!0;function sx(M,i){return M.distance-i.distance}function $3(M,i,f,y){if(M.layers.test(i.layers)&&M.raycast(i,f),y===!0){const _=M.children;for(let S=0,I=_.length;S<I;S++)$3(_[S],i,f,!0)}}const X3=new Vn;class Od{constructor(i=new Vn(1/0,1/0),f=new Vn(-1/0,-1/0)){this.min=i,this.max=f}set(i,f){return this.min.copy(i),this.max.copy(f),this}setFromPoints(i){this.makeEmpty();for(let f=0,y=i.length;f<y;f++)this.expandByPoint(i[f]);return this}setFromCenterAndSize(i,f){const y=X3.copy(f).multiplyScalar(.5);return this.min.copy(i).sub(y),this.max.copy(i).add(y),this}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(i){return this.isEmpty()?i.set(0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return this.isEmpty()?i.set(0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y}getParameter(i,f){return f.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y)}clampPoint(i,f){return f.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return X3.copy(i).clamp(this.min,this.max).sub(i).length()}intersect(i){return this.min.max(i.min),this.max.min(i.max),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}Od.prototype.isBox2=!0;const n4=new me,G0=new me;class r4{constructor(i=new me,f=new me){this.start=i,this.end=f}set(i,f){return this.start.copy(i),this.end.copy(f),this}copy(i){return this.start.copy(i.start),this.end.copy(i.end),this}getCenter(i){return i.addVectors(this.start,this.end).multiplyScalar(.5)}delta(i){return i.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(i,f){return this.delta(f).multiplyScalar(i).add(this.start)}closestPointToPointParameter(i,f){n4.subVectors(i,this.start),G0.subVectors(this.end,this.start);const y=G0.dot(G0);let _=G0.dot(n4)/y;return f&&(_=Fr(_,0,1)),_}closestPointToPoint(i,f,y){const _=this.closestPointToPointParameter(i,f);return this.delta(y).multiplyScalar(_).add(this.start)}applyMatrix4(i){return this.start.applyMatrix4(i),this.end.applyMatrix4(i),this}equals(i){return i.start.equals(this.start)&&i.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class ox extends Me{constructor(i){super(),this.material=i,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}ox.prototype.isImmediateRenderObject=!0;const ax=new me,Fh=new me,lx=new Nt,Z3=new Nt;class i4 extends qu{constructor(i){const f=s4(i),y=new bi,_=[],S=[],I=new Xn(0,0,1),R=new Xn(0,1,0);for(let D=0;D<f.length;D++){const F=f[D];F.parent&&F.parent.isBone&&(_.push(0,0,0),_.push(0,0,0),S.push(I.r,I.g,I.b),S.push(R.r,R.g,R.b))}y.setAttribute("position",new Pr(_,3)),y.setAttribute("color",new Pr(S,3)),super(y,new Na({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=f,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const f=this.bones,y=this.geometry,_=y.getAttribute("position");Z3.copy(this.root.matrixWorld).invert();for(let S=0,I=0;S<f.length;S++){const R=f[S];R.parent&&R.parent.isBone&&(lx.multiplyMatrices(Z3,R.matrixWorld),Fh.setFromMatrixPosition(lx),_.setXYZ(I,Fh.x,Fh.y,Fh.z),lx.multiplyMatrices(Z3,R.parent.matrixWorld),Fh.setFromMatrixPosition(lx),_.setXYZ(I+1,Fh.x,Fh.y,Fh.z),I+=2)}y.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}function s4(M){const i=[];M&&M.isBone&&i.push(M);for(let f=0;f<M.children.length;f++)i.push.apply(i,s4(M.children[f]));return i}const ZM=new me,o4=new Xn,Q_=new Xn;class a4 extends qu{constructor(i=10,f=10,y=4473924,_=8947848){y=new Xn(y),_=new Xn(_);const S=f/2,I=i/f,R=i/2,D=[],F=[];for(let W=0,Z=0,K=-R;W<=f;W++,K+=I){D.push(-R,0,K,R,0,K),D.push(K,0,-R,K,0,R);const oe=W===S?y:_;oe.toArray(F,Z),Z+=3,oe.toArray(F,Z),Z+=3,oe.toArray(F,Z),Z+=3,oe.toArray(F,Z),Z+=3}const G=new bi;G.setAttribute("position",new Pr(D,3)),G.setAttribute("color",new Pr(F,3)),super(G,new Na({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}const Y3=new me,Hf=new me,l4=new me,ux=new me,_a=new wf;function va(M,i,f,y,_,S,I){ux.set(_,S,I).unproject(y);const R=i[M];if(R!==void 0){const D=f.getAttribute("position");for(let F=0,G=R.length;F<G;F++)D.setXYZ(R[F],ux.x,ux.y,ux.z)}}const e1=new Jt;class u4 extends qu{constructor(i,f=16776960){const y=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new Float32Array(24),S=new bi;S.setIndex(new xi(y,1)),S.setAttribute("position",new xi(_,3)),super(S,new Na({color:f,toneMapped:!1})),this.object=i,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(i){if(i!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&e1.setFromObject(this.object),e1.isEmpty())return;const f=e1.min,y=e1.max,_=this.geometry.attributes.position,S=_.array;S[0]=y.x,S[1]=y.y,S[2]=y.z,S[3]=f.x,S[4]=y.y,S[5]=y.z,S[6]=f.x,S[7]=f.y,S[8]=y.z,S[9]=y.x,S[10]=f.y,S[11]=y.z,S[12]=y.x,S[13]=y.y,S[14]=f.z,S[15]=f.x,S[16]=y.y,S[17]=f.z,S[18]=f.x,S[19]=f.y,S[20]=f.z,S[21]=y.x,S[22]=f.y,S[23]=f.z,_.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(i){return this.object=i,this.update(),this}copy(i){return qu.prototype.copy.call(this,i),this.object=i.object,this}}const c4=new me;let cx,t1;class n1 extends qu{constructor(i=1){const f=[0,0,0,i,0,0,0,0,0,0,i,0,0,0,0,0,0,i],y=new bi;y.setAttribute("position",new Pr(f,3)),y.setAttribute("color",new Pr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(y,new Na({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(i,f,y){const _=new Xn,S=this.geometry.attributes.color.array;return _.set(i),_.toArray(S,0),_.toArray(S,3),_.set(f),_.toArray(S,6),_.toArray(S,9),_.set(y),_.toArray(S,12),_.toArray(S,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const r1=new Float32Array(1),YM=new Int32Array(r1.buffer);Io.create=function(M,i){return console.log("THREE.Curve.create() has been deprecated"),M.prototype=Object.create(Io.prototype),M.prototype.constructor=M,M.prototype.getPoint=i,M},bg.prototype.fromPoints=function(M){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(M)},a4.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},i4.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Wl.prototype.extractUrlBase=function(M){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Y_.extractUrlBase(M)},Wl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Od.prototype.center=function(M){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(M)},Od.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Od.prototype.isIntersectionBox=function(M){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(M)},Od.prototype.size=function(M){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(M)},Jt.prototype.center=function(M){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(M)},Jt.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Jt.prototype.isIntersectionBox=function(M){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(M)},Jt.prototype.isIntersectionSphere=function(M){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(M)},Jt.prototype.size=function(M){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(M)},tl.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},nu.prototype.setFromMatrix=function(M){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(M)},r4.prototype.center=function(M){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(M)},Di.prototype.flattenToArrayOffset=function(M,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(M,i)},Di.prototype.multiplyVector3=function(M){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),M.applyMatrix3(this)},Di.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Di.prototype.applyToBufferAttribute=function(M){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),M.applyMatrix3(this)},Di.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Di.prototype.getInverse=function(M){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(M).invert()},Nt.prototype.extractPosition=function(M){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(M)},Nt.prototype.flattenToArrayOffset=function(M,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(M,i)},Nt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new me().setFromMatrixColumn(this,3)},Nt.prototype.setRotationFromQuaternion=function(M){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(M)},Nt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Nt.prototype.multiplyVector3=function(M){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),M.applyMatrix4(this)},Nt.prototype.multiplyVector4=function(M){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),M.applyMatrix4(this)},Nt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Nt.prototype.rotateAxis=function(M){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),M.transformDirection(this)},Nt.prototype.crossVector=function(M){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),M.applyMatrix4(this)},Nt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Nt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Nt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Nt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Nt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Nt.prototype.applyToBufferAttribute=function(M){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),M.applyMatrix4(this)},Nt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Nt.prototype.makeFrustum=function(M,i,f,y,_,S){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(M,i,y,f,_,S)},Nt.prototype.getInverse=function(M){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(M).invert()},Vu.prototype.isIntersectionLine=function(M){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(M)},at.prototype.multiplyVector3=function(M){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),M.applyQuaternion(this)},at.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},rl.prototype.isIntersectionBox=function(M){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(M)},rl.prototype.isIntersectionPlane=function(M){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(M)},rl.prototype.isIntersectionSphere=function(M){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(M)},Bn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Bn.prototype.barycoordFromPoint=function(M,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(M,i)},Bn.prototype.midpoint=function(M){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(M)},Bn.prototypenormal=function(M){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(M)},Bn.prototype.plane=function(M){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(M)},Bn.barycoordFromPoint=function(M,i,f,y,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Bn.getBarycoord(M,i,f,y,_)},Bn.normal=function(M,i,f,y){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Bn.getNormal(M,i,f,y)},jf.prototype.extractAllPoints=function(M){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(M)},jf.prototype.extrude=function(M){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ao(this,M)},jf.prototype.makeGeometry=function(M){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new El(this,M)},Vn.prototype.fromAttribute=function(M,i,f){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(M,i,f)},Vn.prototype.distanceToManhattan=function(M){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(M)},Vn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},me.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},me.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},me.prototype.getPositionFromMatrix=function(M){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(M)},me.prototype.getScaleFromMatrix=function(M){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(M)},me.prototype.getColumnFromMatrix=function(M,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,M)},me.prototype.applyProjection=function(M){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(M)},me.prototype.fromAttribute=function(M,i,f){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(M,i,f)},me.prototype.distanceToManhattan=function(M){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(M)},me.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Fe.prototype.fromAttribute=function(M,i,f){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(M,i,f)},Fe.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Me.prototype.getChildByName=function(M){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(M)},Me.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Me.prototype.translate=function(M,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,M)},Me.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Me.prototype.applyMatrix=function(M){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(M)},Object.defineProperties(Me.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(M){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=M}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Vo.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Vo.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),qc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},ga.prototype.setLens=function(M,i){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),i!==void 0&&(this.filmGauge=i),this.setFocalLength(M)},Object.defineProperties(Nh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(M){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=M}},shadowCameraLeft:{set:function(M){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=M}},shadowCameraRight:{set:function(M){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=M}},shadowCameraTop:{set:function(M){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=M}},shadowCameraBottom:{set:function(M){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=M}},shadowCameraNear:{set:function(M){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=M}},shadowCameraFar:{set:function(M){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=M}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(M){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=M}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(M){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=M}},shadowMapHeight:{set:function(M){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=M}}}),Object.defineProperties(xi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),xi.prototype.setDynamic=function(M){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(M===!0?35048:35044),this},xi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},xi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},bi.prototype.addIndex=function(M){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(M)},bi.prototype.addAttribute=function(M,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),i&&i.isBufferAttribute||i&&i.isInterleavedBufferAttribute?M==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(M,i):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(M,new xi(arguments[1],arguments[2])))},bi.prototype.addDrawCall=function(M,i,f){f!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(M,i)},bi.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},bi.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},bi.prototype.removeAttribute=function(M){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(M)},bi.prototype.applyMatrix=function(M){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(M)},Object.defineProperties(bi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),vn.prototype.setDynamic=function(M){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(M===!0?35048:35044),this},vn.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ao.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ao.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ao.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},$t.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Qp.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(cn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Xn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(M){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=M===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(M){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=M}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Th.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(M){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=M}}}),zt.prototype.clearTarget=function(M,i,f,y){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(M),this.clear(i,f,y)},zt.prototype.animate=function(M){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(M)},zt.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},zt.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},zt.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},zt.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},zt.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},zt.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},zt.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},zt.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},zt.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},zt.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},zt.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},zt.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},zt.prototype.enableScissorTest=function(M){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(M)},zt.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},zt.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},zt.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},zt.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},zt.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},zt.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},zt.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},zt.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},zt.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},zt.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(zt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(M){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=M}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(M){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=M}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(M){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=M===!0?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Ue.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(nt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(M){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=M}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(M){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=M}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(M){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=M}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(M){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=M}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(M){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=M}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(M){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=M}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(M){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=M}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(M){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=M}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(M){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=M}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(M){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=M}}}),Gf.prototype.load=function(M){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const i=this;return new Kv().load(M,function(f){i.setBuffer(f)}),this},J9.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ef.prototype.updateCubeMap=function(M,i){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(M,i)},Ef.prototype.clear=function(M,i,f,y){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(M,i,f,y)},ct.crossOrigin=void 0,ct.loadTexture=function(M,i,f,y){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const _=new qv;_.setCrossOrigin(this.crossOrigin);const S=_.load(M,f,void 0,y);return i&&(S.mapping=i),S},ct.loadTextureCube=function(M,i,f,y){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const _=new Wv;_.setCrossOrigin(this.crossOrigin);const S=_.load(M,f,void 0,y);return i&&(S.mapping=i),S},ct.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ct.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const KM={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r),n.ACESFilmicToneMapping=4,n.AddEquation=100,n.AddOperation=2,n.AdditiveAnimationBlendMode=2501,n.AdditiveBlending=2,n.AlphaFormat=1021,n.AlwaysDepth=1,n.AlwaysStencilFunc=519,n.AmbientLight=Vf,n.AmbientLightProbe=Tu,n.AnimationClip=Xu,n.AnimationLoader=class extends Wl{constructor(M){super(M)}load(M,i,f,y){const _=this,S=new Qc(this.manager);S.setPath(this.path),S.setRequestHeader(this.requestHeader),S.setWithCredentials(this.withCredentials),S.load(M,function(I){try{i(_.parse(JSON.parse(I)))}catch(R){y?y(R):console.error(R),_.manager.itemError(M)}},f,y)}parse(M){const i=[];for(let f=0;f<M.length;f++){const y=Xu.parse(M[f]);i.push(y)}return i}},n.AnimationMixer=q3,n.AnimationObjectGroup=V0,n.AnimationUtils=wo,n.ArcCurve=Dv,n.ArrayCamera=It,n.ArrowHelper=class extends Me{constructor(M=new me(0,0,1),i=new me(0,0,0),f=1,y=16776960,_=.2*f,S=.2*_){super(),this.type="ArrowHelper",cx===void 0&&(cx=new bi,cx.setAttribute("position",new Pr([0,0,0,0,1,0],3)),t1=new Df(0,.5,1,5,1),t1.translate(0,-.5,0)),this.position.copy(i),this.line=new Cd(cx,new Na({color:y,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Vo(t1,new es({color:y,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(M),this.setLength(f,_,S)}setDirection(M){if(M.y>.99999)this.quaternion.set(0,0,0,1);else if(M.y<-.99999)this.quaternion.set(1,0,0,0);else{c4.set(M.z,0,-M.x).normalize();const i=Math.acos(M.y);this.quaternion.setFromAxisAngle(c4,i)}}setLength(M,i=.2*M,f=.2*i){this.line.scale.set(1,Math.max(1e-4,M-i),1),this.line.updateMatrix(),this.cone.scale.set(f,i,f),this.cone.position.y=M,this.cone.updateMatrix()}setColor(M){this.line.material.color.set(M),this.cone.material.color.set(M)}copy(M){return super.copy(M,!1),this.line.copy(M.line),this.cone.copy(M.cone),this}},n.Audio=Gf,n.AudioAnalyser=J9,n.AudioContext=Yv,n.AudioListener=class extends Me{constructor(){super(),this.type="AudioListener",this.context=Yv.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Z9}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(M){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=M,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(M){return this.gain.gain.setTargetAtTime(M,this.context.currentTime,.01),this}updateMatrixWorld(M){super.updateMatrixWorld(M);const i=this.context.listener,f=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(wg,Qv,ex),Jp.set(0,0,-1).applyQuaternion(Qv),i.positionX){const y=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(wg.x,y),i.positionY.linearRampToValueAtTime(wg.y,y),i.positionZ.linearRampToValueAtTime(wg.z,y),i.forwardX.linearRampToValueAtTime(Jp.x,y),i.forwardY.linearRampToValueAtTime(Jp.y,y),i.forwardZ.linearRampToValueAtTime(Jp.z,y),i.upX.linearRampToValueAtTime(f.x,y),i.upY.linearRampToValueAtTime(f.y,y),i.upZ.linearRampToValueAtTime(f.z,y)}else i.setPosition(wg.x,wg.y,wg.z),i.setOrientation(Jp.x,Jp.y,Jp.z,f.x,f.y,f.z)}},n.AudioLoader=Kv,n.AxesHelper=n1,n.AxisHelper=function(M){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new n1(M)},n.BackSide=1,n.BasicDepthPacking=3200,n.BasicShadowMap=0,n.BinaryTextureLoader=function(M){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new F3(M)},n.Bone=kd,n.BooleanKeyframeTrack=vg,n.BoundingBoxHelper=function(M,i){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new u4(M,i)},n.Box2=Od,n.Box3=Jt,n.Box3Helper=class extends qu{constructor(M,i=16776960){const f=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),y=new bi;y.setIndex(new xi(f,1)),y.setAttribute("position",new Pr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(y,new Na({color:i,toneMapped:!1})),this.box=M,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(M){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(M))}},n.BoxBufferGeometry=Ul,n.BoxGeometry=Ul,n.BoxHelper=u4,n.BufferAttribute=xi,n.BufferGeometry=bi,n.BufferGeometryLoader=H9,n.ByteType=1010,n.Cache=Hl,n.Camera=wf,n.CameraHelper=class extends qu{constructor(M){const i=new bi,f=new Na({color:16777215,vertexColors:!0,toneMapped:!1}),y=[],_=[],S={},I=new Xn(16755200),R=new Xn(16711680),D=new Xn(43775),F=new Xn(16777215),G=new Xn(3355443);function W(K,oe,de){Z(K,de),Z(oe,de)}function Z(K,oe){y.push(0,0,0),_.push(oe.r,oe.g,oe.b),S[K]===void 0&&(S[K]=[]),S[K].push(y.length/3-1)}W("n1","n2",I),W("n2","n4",I),W("n4","n3",I),W("n3","n1",I),W("f1","f2",I),W("f2","f4",I),W("f4","f3",I),W("f3","f1",I),W("n1","f1",I),W("n2","f2",I),W("n3","f3",I),W("n4","f4",I),W("p","n1",R),W("p","n2",R),W("p","n3",R),W("p","n4",R),W("u1","u2",D),W("u2","u3",D),W("u3","u1",D),W("c","t",F),W("p","c",G),W("cn1","cn2",G),W("cn3","cn4",G),W("cf1","cf2",G),W("cf3","cf4",G),i.setAttribute("position",new Pr(y,3)),i.setAttribute("color",new Pr(_,3)),super(i,f),this.type="CameraHelper",this.camera=M,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=M.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=S,this.update()}update(){const M=this.geometry,i=this.pointMap;_a.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),va("c",i,M,_a,0,0,-1),va("t",i,M,_a,0,0,1),va("n1",i,M,_a,-1,-1,-1),va("n2",i,M,_a,1,-1,-1),va("n3",i,M,_a,-1,1,-1),va("n4",i,M,_a,1,1,-1),va("f1",i,M,_a,-1,-1,1),va("f2",i,M,_a,1,-1,1),va("f3",i,M,_a,-1,1,1),va("f4",i,M,_a,1,1,1),va("u1",i,M,_a,.7,1.1,-1),va("u2",i,M,_a,-.7,1.1,-1),va("u3",i,M,_a,0,2,-1),va("cf1",i,M,_a,-1,0,1),va("cf2",i,M,_a,1,0,1),va("cf3",i,M,_a,0,-1,1),va("cf4",i,M,_a,0,1,1),va("cn1",i,M,_a,-1,0,-1),va("cn2",i,M,_a,1,0,-1),va("cn3",i,M,_a,0,-1,-1),va("cn4",i,M,_a,0,1,-1),M.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},n.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},n.CanvasTexture=F9,n.CatmullRomCurve3=P_,n.CineonToneMapping=3,n.CircleBufferGeometry=T0,n.CircleGeometry=T0,n.ClampToEdgeWrapping=1001,n.Clock=Z9,n.Color=Xn,n.ColorKeyframeTrack=D3,n.CompressedTexture=C3,n.CompressedTextureLoader=class extends Wl{constructor(M){super(M)}load(M,i,f,y){const _=this,S=[],I=new C3,R=new Qc(this.manager);R.setPath(this.path),R.setResponseType("arraybuffer"),R.setRequestHeader(this.requestHeader),R.setWithCredentials(_.withCredentials);let D=0;function F(G){R.load(M[G],function(W){const Z=_.parse(W,!0);S[G]={width:Z.width,height:Z.height,format:Z.format,mipmaps:Z.mipmaps},D+=1,D===6&&(Z.mipmapCount===1&&(I.minFilter=1006),I.image=S,I.format=Z.format,I.needsUpdate=!0,i&&i(I))},f,y)}if(Array.isArray(M))for(let G=0,W=M.length;G<W;++G)F(G);else R.load(M,function(G){const W=_.parse(G,!0);if(W.isCubemap){const Z=W.mipmaps.length/W.mipmapCount;for(let K=0;K<Z;K++){S[K]={mipmaps:[]};for(let oe=0;oe<W.mipmapCount;oe++)S[K].mipmaps.push(W.mipmaps[K*W.mipmapCount+oe]),S[K].format=W.format,S[K].width=W.width,S[K].height=W.height}I.image=S}else I.image.width=W.width,I.image.height=W.height,I.mipmaps=W.mipmaps;W.mipmapCount===1&&(I.minFilter=1006),I.format=W.format,I.needsUpdate=!0,i&&i(I)},f,y);return I}},n.ConeBufferGeometry=ug,n.ConeGeometry=ug,n.CubeCamera=Ef,n.CubeReflectionMapping=301,n.CubeRefractionMapping=302,n.CubeTexture=Sf,n.CubeTextureLoader=Wv,n.CubeUVReflectionMapping=306,n.CubeUVRefractionMapping=307,n.CubicBezierCurve=Ov,n.CubicBezierCurve3=N_,n.CubicInterpolant=_g,n.CullFaceBack=1,n.CullFaceFront=2,n.CullFaceFrontBack=3,n.CullFaceNone=0,n.Curve=Io,n.CurvePath=V9,n.CustomBlending=5,n.CustomToneMapping=5,n.CylinderBufferGeometry=Df,n.CylinderGeometry=Df,n.Cylindrical=class{constructor(M=1,i=0,f=0){return this.radius=M,this.theta=i,this.y=f,this}set(M,i,f){return this.radius=M,this.theta=i,this.y=f,this}copy(M){return this.radius=M.radius,this.theta=M.theta,this.y=M.y,this}setFromVector3(M){return this.setFromCartesianCoords(M.x,M.y,M.z)}setFromCartesianCoords(M,i,f){return this.radius=Math.sqrt(M*M+f*f),this.theta=Math.atan2(M,f),this.y=i,this}clone(){return new this.constructor().copy(this)}},n.DataTexture=Gl,n.DataTexture2DArray=y0,n.DataTexture3D=zp,n.DataTextureLoader=F3,n.DataUtils=class{static toHalfFloat(M){r1[0]=M;const i=YM[0];let f=i>>16&32768,y=i>>12&2047;const _=i>>23&255;return _<103?f:_>142?(f|=31744,f|=(_==255?0:1)&&8388607&i,f):_<113?(y|=2048,f|=(y>>114-_)+(y>>113-_&1),f):(f|=_-112<<10|y>>1,f+=1&y,f)}},n.DecrementStencilOp=7683,n.DecrementWrapStencilOp=34056,n.DefaultLoadingManager=sl,n.DepthFormat=1026,n.DepthStencilFormat=1027,n.DepthTexture=z9,n.DirectionalLight=$v,n.DirectionalLightHelper=class extends Me{constructor(M,i,f){super(),this.light=M,this.light.updateMatrixWorld(),this.matrix=M.matrixWorld,this.matrixAutoUpdate=!1,this.color=f,i===void 0&&(i=1);let y=new bi;y.setAttribute("position",new Pr([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const _=new Na({fog:!1,toneMapped:!1});this.lightPlane=new Cd(y,_),this.add(this.lightPlane),y=new bi,y.setAttribute("position",new Pr([0,0,0,0,0,1],3)),this.targetLine=new Cd(y,_),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Y3.setFromMatrixPosition(this.light.matrixWorld),Hf.setFromMatrixPosition(this.light.target.matrixWorld),l4.subVectors(Hf,Y3),this.lightPlane.lookAt(Hf),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Hf),this.targetLine.scale.z=l4.length()}},n.DiscreteInterpolant=Hv,n.DodecahedronBufferGeometry=M0,n.DodecahedronGeometry=M0,n.DoubleSide=2,n.DstAlphaFactor=206,n.DstColorFactor=208,n.DynamicBufferAttribute=function(M,i){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new xi(M,i).setUsage(35048)},n.DynamicCopyUsage=35050,n.DynamicDrawUsage=35048,n.DynamicReadUsage=35049,n.EdgesGeometry=k0,n.EdgesHelper=function(M,i){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new qu(new k0(M.geometry),new Na({color:i!==void 0?i:16777215}))},n.EllipseCurve=C0,n.EqualDepth=4,n.EqualStencilFunc=514,n.EquirectangularReflectionMapping=303,n.EquirectangularRefractionMapping=304,n.Euler=Ei,n.EventDispatcher=en,n.ExtrudeBufferGeometry=Ao,n.ExtrudeGeometry=Ao,n.FaceColors=1,n.FileLoader=Qc,n.FlatShading=1,n.Float16BufferAttribute=jc,n.Float32Attribute=function(M,i){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Pr(M,i)},n.Float32BufferAttribute=Pr,n.Float64Attribute=function(M,i){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new vu(M,i)},n.Float64BufferAttribute=vu,n.FloatType=1015,n.Fog=Gn,n.FogExp2=Qt,n.Font=W3,n.FontLoader=class extends Wl{constructor(M){super(M)}load(M,i,f,y){const _=this,S=new Qc(this.manager);S.setPath(this.path),S.setRequestHeader(this.requestHeader),S.setWithCredentials(_.withCredentials),S.load(M,function(I){let R;try{R=JSON.parse(I)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),R=JSON.parse(I.substring(65,I.length-2))}const D=_.parse(R);i&&i(D)},f,y)}parse(M){return new W3(M)}},n.FrontSide=0,n.Frustum=nu,n.GLBufferAttribute=ix,n.GLSL1="100",n.GLSL3=At,n.GammaEncoding=3007,n.GreaterDepth=6,n.GreaterEqualDepth=5,n.GreaterEqualStencilFunc=518,n.GreaterStencilFunc=516,n.GridHelper=a4,n.Group=Mt,n.HalfFloatType=1016,n.HemisphereLight=Dh,n.HemisphereLightHelper=class extends Me{constructor(M,i,f){super(),this.light=M,this.light.updateMatrixWorld(),this.matrix=M.matrixWorld,this.matrixAutoUpdate=!1,this.color=f;const y=new pg(i);y.rotateY(.5*Math.PI),this.material=new es({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const _=y.getAttribute("position"),S=new Float32Array(3*_.count);y.setAttribute("color",new xi(S,3)),this.add(new Vo(y,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const M=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=M.geometry.getAttribute("color");o4.copy(this.light.color),Q_.copy(this.light.groundColor);for(let f=0,y=i.count;f<y;f++){const _=f<y/2?o4:Q_;i.setXYZ(f,_.r,_.g,_.b)}i.needsUpdate=!0}M.lookAt(ZM.setFromMatrixPosition(this.light.matrixWorld).negate())}},n.HemisphereLightProbe=Dd,n.IcosahedronBufferGeometry=fg,n.IcosahedronGeometry=fg,n.ImageBitmapLoader=H3,n.ImageLoader=Rd,n.ImageUtils=ct,n.ImmediateRenderObject=ox,n.IncrementStencilOp=7682,n.IncrementWrapStencilOp=34055,n.InstancedBufferAttribute=yc,n.InstancedBufferGeometry=Zv,n.InstancedInterleavedBuffer=rx,n.InstancedMesh=A_,n.Int16Attribute=function(M,i){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Za(M,i)},n.Int16BufferAttribute=Za,n.Int32Attribute=function(M,i){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new na(M,i)},n.Int32BufferAttribute=na,n.Int8Attribute=function(M,i){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new pa(M,i)},n.Int8BufferAttribute=pa,n.IntType=1013,n.InterleavedBuffer=vn,n.InterleavedBufferAttribute=kn,n.Interpolant=Ld,n.InterpolateDiscrete=2300,n.InterpolateLinear=2301,n.InterpolateSmooth=2302,n.InvertStencilOp=5386,n.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},n.KeepStencilOp=7680,n.KeyframeTrack=Jc,n.LOD=ps,n.LatheBufferGeometry=Eu,n.LatheGeometry=Eu,n.Layers=Si,n.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},n.LessDepth=2,n.LessEqualDepth=3,n.LessEqualStencilFunc=515,n.LessStencilFunc=513,n.Light=Nh,n.LightProbe=Nd,n.Line=Cd,n.Line3=r4,n.LineBasicMaterial=Na,n.LineCurve=P0,n.LineCurve3=R0,n.LineDashedMaterial=Vv,n.LineLoop=k3,n.LinePieces=1,n.LineSegments=qu,n.LineStrip=0,n.LinearEncoding=3e3,n.LinearFilter=1006,n.LinearInterpolant=Gv,n.LinearMipMapLinearFilter=1008,n.LinearMipMapNearestFilter=1007,n.LinearMipmapLinearFilter=1008,n.LinearMipmapNearestFilter=1007,n.LinearToneMapping=1,n.Loader=Wl,n.LoaderUtils=Y_,n.LoadingManager=Su,n.LogLuvEncoding=3003,n.LoopOnce=2200,n.LoopPingPong=2202,n.LoopRepeat=2201,n.LuminanceAlphaFormat=1025,n.LuminanceFormat=1024,n.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},n.Material=cn,n.MaterialLoader=Z_,n.Math=vo,n.MathUtils=vo,n.Matrix3=Di,n.Matrix4=Nt,n.MaxEquation=104,n.Mesh=Vo,n.MeshBasicMaterial=es,n.MeshDepthMaterial=Xe,n.MeshDistanceMaterial=Ee,n.MeshFaceMaterial=function(M){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),M},n.MeshLambertMaterial=yg,n.MeshMatcapMaterial=U0,n.MeshNormalMaterial=Yp,n.MeshPhongMaterial=j_,n.MeshPhysicalMaterial=B0,n.MeshStandardMaterial=jv,n.MeshToonMaterial=Zp,n.MinEquation=103,n.MirroredRepeatWrapping=1002,n.MixOperation=1,n.MultiMaterial=function(M=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),M.isMultiMaterial=!0,M.materials=M,M.clone=function(){return M.slice()},M},n.MultiplyBlending=4,n.MultiplyOperation=0,n.NearestFilter=1003,n.NearestMipMapLinearFilter=1005,n.NearestMipMapNearestFilter=1004,n.NearestMipmapLinearFilter=1005,n.NearestMipmapNearestFilter=1004,n.NeverDepth=0,n.NeverStencilFunc=512,n.NoBlending=0,n.NoColors=0,n.NoToneMapping=0,n.NormalAnimationBlendMode=2500,n.NormalBlending=1,n.NotEqualDepth=7,n.NotEqualStencilFunc=517,n.NumberKeyframeTrack=Uf,n.Object3D=Me,n.ObjectLoader=class extends Wl{constructor(M){super(M)}load(M,i,f,y){const _=this,S=this.path===""?Y_.extractUrlBase(M):this.path;this.resourcePath=this.resourcePath||S;const I=new Qc(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(M,function(R){let D=null;try{D=JSON.parse(R)}catch(G){return y!==void 0&&y(G),void console.error("THREE:ObjectLoader: Can't parse "+M+".",G.message)}const F=D.metadata;F!==void 0&&F.type!==void 0&&F.type.toLowerCase()!=="geometry"?_.parse(D,i):console.error("THREE.ObjectLoader: Can't load "+M)},f,y)}async loadAsync(M,i){const f=this.path===""?Y_.extractUrlBase(M):this.path;this.resourcePath=this.resourcePath||f;const y=new Qc(this.manager);y.setPath(this.path),y.setRequestHeader(this.requestHeader),y.setWithCredentials(this.withCredentials);const _=await y.loadAsync(M,i),S=JSON.parse(_),I=S.metadata;if(I===void 0||I.type===void 0||I.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+M);return await this.parseAsync(S)}parse(M,i){const f=this.parseAnimations(M.animations),y=this.parseShapes(M.shapes),_=this.parseGeometries(M.geometries,y),S=this.parseImages(M.images,function(){i!==void 0&&i(D)}),I=this.parseTextures(M.textures,S),R=this.parseMaterials(M.materials,I),D=this.parseObject(M.object,_,R,I,f),F=this.parseSkeletons(M.skeletons,D);if(this.bindSkeletons(D,F),i!==void 0){let G=!1;for(const W in S)if(S[W]instanceof HTMLImageElement){G=!0;break}G===!1&&i(D)}return D}async parseAsync(M){const i=this.parseAnimations(M.animations),f=this.parseShapes(M.shapes),y=this.parseGeometries(M.geometries,f),_=await this.parseImagesAsync(M.images),S=this.parseTextures(M.textures,_),I=this.parseMaterials(M.materials,S),R=this.parseObject(M.object,y,I,S,i),D=this.parseSkeletons(M.skeletons,R);return this.bindSkeletons(R,D),R}parseShapes(M){const i={};if(M!==void 0)for(let f=0,y=M.length;f<y;f++){const _=new jf().fromJSON(M[f]);i[_.uuid]=_}return i}parseSkeletons(M,i){const f={},y={};if(i.traverse(function(_){_.isBone&&(y[_.uuid]=_)}),M!==void 0)for(let _=0,S=M.length;_<S;_++){const I=new Pf().fromJSON(M[_],y);f[I.uuid]=I}return f}parseGeometries(M,i){const f={};if(M!==void 0){const y=new H9;for(let _=0,S=M.length;_<S;_++){let I;const R=M[_];switch(R.type){case"BufferGeometry":case"InstancedBufferGeometry":I=y.parse(R);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:R.type in N3?I=N3[R.type].fromJSON(R,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${R.type}"`)}I.uuid=R.uuid,R.name!==void 0&&(I.name=R.name),I.isBufferGeometry===!0&&R.userData!==void 0&&(I.userData=R.userData),f[R.uuid]=I}}return f}parseMaterials(M,i){const f={},y={};if(M!==void 0){const _=new Z_;_.setTextures(i);for(let S=0,I=M.length;S<I;S++){const R=M[S];if(R.type==="MultiMaterial"){const D=[];for(let F=0;F<R.materials.length;F++){const G=R.materials[F];f[G.uuid]===void 0&&(f[G.uuid]=_.parse(G)),D.push(f[G.uuid])}y[R.uuid]=D}else f[R.uuid]===void 0&&(f[R.uuid]=_.parse(R)),y[R.uuid]=f[R.uuid]}}return y}parseAnimations(M){const i={};if(M!==void 0)for(let f=0;f<M.length;f++){const y=M[f],_=Xu.parse(y);i[_.uuid]=_}return i}parseImages(M,i){const f=this,y={};let _;function S(I){if(typeof I=="string"){const R=I;return function(D){return f.manager.itemStart(D),_.load(D,function(){f.manager.itemEnd(D)},void 0,function(){f.manager.itemError(D),f.manager.itemEnd(D)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(R)?R:f.resourcePath+R)}return I.data?{data:dc(I.type,I.data),width:I.width,height:I.height}:null}if(M!==void 0&&M.length>0){const I=new Su(i);_=new Rd(I),_.setCrossOrigin(this.crossOrigin);for(let R=0,D=M.length;R<D;R++){const F=M[R],G=F.url;if(Array.isArray(G)){y[F.uuid]=[];for(let W=0,Z=G.length;W<Z;W++){const K=S(G[W]);K!==null&&(K instanceof HTMLImageElement?y[F.uuid].push(K):y[F.uuid].push(new Gl(K.data,K.width,K.height)))}}else{const W=S(F.url);W!==null&&(y[F.uuid]=W)}}}return y}async parseImagesAsync(M){const i=this,f={};let y;async function _(S){if(typeof S=="string"){const I=S,R=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(I)?I:i.resourcePath+I;return await y.loadAsync(R)}return S.data?{data:dc(S.type,S.data),width:S.width,height:S.height}:null}if(M!==void 0&&M.length>0){y=new Rd(this.manager),y.setCrossOrigin(this.crossOrigin);for(let S=0,I=M.length;S<I;S++){const R=M[S],D=R.url;if(Array.isArray(D)){f[R.uuid]=[];for(let F=0,G=D.length;F<G;F++){const W=D[F],Z=await _(W);Z!==null&&(Z instanceof HTMLImageElement?f[R.uuid].push(Z):f[R.uuid].push(new Gl(Z.data,Z.width,Z.height)))}}else{const F=await _(R.url);F!==null&&(f[R.uuid]=F)}}}return f}parseTextures(M,i){function f(_,S){return typeof _=="number"?_:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",_),S[_])}const y={};if(M!==void 0)for(let _=0,S=M.length;_<S;_++){const I=M[_];let R;I.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',I.uuid),i[I.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",I.image);const D=i[I.image];Array.isArray(D)?(R=new Sf(D),D.length===6&&(R.needsUpdate=!0)):(R=D&&D.data?new Gl(D.data,D.width,D.height):new le(D),D&&(R.needsUpdate=!0)),R.uuid=I.uuid,I.name!==void 0&&(R.name=I.name),I.mapping!==void 0&&(R.mapping=f(I.mapping,GM)),I.offset!==void 0&&R.offset.fromArray(I.offset),I.repeat!==void 0&&R.repeat.fromArray(I.repeat),I.center!==void 0&&R.center.fromArray(I.center),I.rotation!==void 0&&(R.rotation=I.rotation),I.wrap!==void 0&&(R.wrapS=f(I.wrap[0],G3),R.wrapT=f(I.wrap[1],G3)),I.format!==void 0&&(R.format=I.format),I.type!==void 0&&(R.type=I.type),I.encoding!==void 0&&(R.encoding=I.encoding),I.minFilter!==void 0&&(R.minFilter=f(I.minFilter,W9)),I.magFilter!==void 0&&(R.magFilter=f(I.magFilter,W9)),I.anisotropy!==void 0&&(R.anisotropy=I.anisotropy),I.flipY!==void 0&&(R.flipY=I.flipY),I.premultiplyAlpha!==void 0&&(R.premultiplyAlpha=I.premultiplyAlpha),I.unpackAlignment!==void 0&&(R.unpackAlignment=I.unpackAlignment),y[I.uuid]=R}return y}parseObject(M,i,f,y,_){let S,I,R;function D(W){return i[W]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",W),i[W]}function F(W){if(W!==void 0){if(Array.isArray(W)){const Z=[];for(let K=0,oe=W.length;K<oe;K++){const de=W[K];f[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",de),Z.push(f[de])}return Z}return f[W]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",W),f[W]}}function G(W){return y[W]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",W),y[W]}switch(M.type){case"Scene":S=new $t,M.background!==void 0&&(Number.isInteger(M.background)?S.background=new Xn(M.background):S.background=G(M.background)),M.environment!==void 0&&(S.environment=G(M.environment)),M.fog!==void 0&&(M.fog.type==="Fog"?S.fog=new Gn(M.fog.color,M.fog.near,M.fog.far):M.fog.type==="FogExp2"&&(S.fog=new Qt(M.fog.color,M.fog.density)));break;case"PerspectiveCamera":S=new ga(M.fov,M.aspect,M.near,M.far),M.focus!==void 0&&(S.focus=M.focus),M.zoom!==void 0&&(S.zoom=M.zoom),M.filmGauge!==void 0&&(S.filmGauge=M.filmGauge),M.filmOffset!==void 0&&(S.filmOffset=M.filmOffset),M.view!==void 0&&(S.view=Object.assign({},M.view));break;case"OrthographicCamera":S=new Tf(M.left,M.right,M.top,M.bottom,M.near,M.far),M.zoom!==void 0&&(S.zoom=M.zoom),M.view!==void 0&&(S.view=Object.assign({},M.view));break;case"AmbientLight":S=new Vf(M.color,M.intensity);break;case"DirectionalLight":S=new $v(M.color,M.intensity);break;case"PointLight":S=new X_(M.color,M.intensity,M.distance,M.decay);break;case"RectAreaLight":S=new Xv(M.color,M.intensity,M.width,M.height);break;case"SpotLight":S=new B3(M.color,M.intensity,M.distance,M.angle,M.penumbra,M.decay);break;case"HemisphereLight":S=new Dh(M.color,M.groundColor,M.intensity);break;case"LightProbe":S=new Nd().fromJSON(M);break;case"SkinnedMesh":I=D(M.geometry),R=F(M.material),S=new qc(I,R),M.bindMode!==void 0&&(S.bindMode=M.bindMode),M.bindMatrix!==void 0&&S.bindMatrix.fromArray(M.bindMatrix),M.skeleton!==void 0&&(S.skeleton=M.skeleton);break;case"Mesh":I=D(M.geometry),R=F(M.material),S=new Vo(I,R);break;case"InstancedMesh":I=D(M.geometry),R=F(M.material);const W=M.count,Z=M.instanceMatrix,K=M.instanceColor;S=new A_(I,R,W),S.instanceMatrix=new yc(new Float32Array(Z.array),16),K!==void 0&&(S.instanceColor=new yc(new Float32Array(K.array),K.itemSize));break;case"LOD":S=new ps;break;case"Line":S=new Cd(D(M.geometry),F(M.material));break;case"LineLoop":S=new k3(D(M.geometry),F(M.material));break;case"LineSegments":S=new qu(D(M.geometry),F(M.material));break;case"PointCloud":case"Points":S=new Xc(D(M.geometry),F(M.material));break;case"Sprite":S=new Vl(F(M.material));break;case"Group":S=new Mt;break;case"Bone":S=new kd;break;default:S=new Me}if(S.uuid=M.uuid,M.name!==void 0&&(S.name=M.name),M.matrix!==void 0?(S.matrix.fromArray(M.matrix),M.matrixAutoUpdate!==void 0&&(S.matrixAutoUpdate=M.matrixAutoUpdate),S.matrixAutoUpdate&&S.matrix.decompose(S.position,S.quaternion,S.scale)):(M.position!==void 0&&S.position.fromArray(M.position),M.rotation!==void 0&&S.rotation.fromArray(M.rotation),M.quaternion!==void 0&&S.quaternion.fromArray(M.quaternion),M.scale!==void 0&&S.scale.fromArray(M.scale)),M.castShadow!==void 0&&(S.castShadow=M.castShadow),M.receiveShadow!==void 0&&(S.receiveShadow=M.receiveShadow),M.shadow&&(M.shadow.bias!==void 0&&(S.shadow.bias=M.shadow.bias),M.shadow.normalBias!==void 0&&(S.shadow.normalBias=M.shadow.normalBias),M.shadow.radius!==void 0&&(S.shadow.radius=M.shadow.radius),M.shadow.mapSize!==void 0&&S.shadow.mapSize.fromArray(M.shadow.mapSize),M.shadow.camera!==void 0&&(S.shadow.camera=this.parseObject(M.shadow.camera))),M.visible!==void 0&&(S.visible=M.visible),M.frustumCulled!==void 0&&(S.frustumCulled=M.frustumCulled),M.renderOrder!==void 0&&(S.renderOrder=M.renderOrder),M.userData!==void 0&&(S.userData=M.userData),M.layers!==void 0&&(S.layers.mask=M.layers),M.children!==void 0){const W=M.children;for(let Z=0;Z<W.length;Z++)S.add(this.parseObject(W[Z],i,f,y,_))}if(M.animations!==void 0){const W=M.animations;for(let Z=0;Z<W.length;Z++){const K=W[Z];S.animations.push(_[K])}}if(M.type==="LOD"){M.autoUpdate!==void 0&&(S.autoUpdate=M.autoUpdate);const W=M.levels;for(let Z=0;Z<W.length;Z++){const K=W[Z],oe=S.getObjectByProperty("uuid",K.object);oe!==void 0&&S.addLevel(oe,K.distance)}}return S}bindSkeletons(M,i){Object.keys(i).length!==0&&M.traverse(function(f){if(f.isSkinnedMesh===!0&&f.skeleton!==void 0){const y=i[f.skeleton];y===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",f.skeleton):f.bind(y,f.bindMatrix)}})}setTexturePath(M){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(M)}},n.ObjectSpaceNormalMap=1,n.OctahedronBufferGeometry=pg,n.OctahedronGeometry=pg,n.OneFactor=201,n.OneMinusDstAlphaFactor=207,n.OneMinusDstColorFactor=209,n.OneMinusSrcAlphaFactor=205,n.OneMinusSrcColorFactor=203,n.OrthographicCamera=Tf,n.PCFShadowMap=1,n.PCFSoftShadowMap=2,n.PMREMGenerator=h_,n.ParametricBufferGeometry=Id,n.ParametricGeometry=Id,n.Particle=function(M){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Vl(M)},n.ParticleBasicMaterial=function(M){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Rf(M)},n.ParticleSystem=function(M,i){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Xc(M,i)},n.ParticleSystemMaterial=function(M){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Rf(M)},n.Path=bg,n.PerspectiveCamera=ga,n.Plane=Vu,n.PlaneBufferGeometry=Gc,n.PlaneGeometry=Gc,n.PlaneHelper=class extends Cd{constructor(M,i=1,f=16776960){const y=f,_=new bi;_.setAttribute("position",new Pr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),_.computeBoundingSphere(),super(_,new Na({color:y,toneMapped:!1})),this.type="PlaneHelper",this.plane=M,this.size=i;const S=new bi;S.setAttribute("position",new Pr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),S.computeBoundingSphere(),this.add(new Vo(S,new es({color:y,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(M){let i=-this.plane.constant;Math.abs(i)<1e-8&&(i=1e-8),this.scale.set(.5*this.size,.5*this.size,i),this.children[0].material.side=i<0?1:0,this.lookAt(this.plane.normal),super.updateMatrixWorld(M)}},n.PointCloud=function(M,i){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Xc(M,i)},n.PointCloudMaterial=function(M){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Rf(M)},n.PointLight=X_,n.PointLightHelper=class extends Vo{constructor(M,i,f){super(new Sl(i,4,2),new es({wireframe:!0,fog:!1,toneMapped:!1})),this.light=M,this.light.updateMatrixWorld(),this.color=f,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},n.Points=Xc,n.PointsMaterial=Rf,n.PolarGridHelper=class extends qu{constructor(M=10,i=16,f=8,y=64,_=4473924,S=8947848){_=new Xn(_),S=new Xn(S);const I=[],R=[];for(let F=0;F<=i;F++){const G=F/i*(2*Math.PI),W=Math.sin(G)*M,Z=Math.cos(G)*M;I.push(0,0,0),I.push(W,0,Z);const K=1&F?_:S;R.push(K.r,K.g,K.b),R.push(K.r,K.g,K.b)}for(let F=0;F<=f;F++){const G=1&F?_:S,W=M-M/f*F;for(let Z=0;Z<y;Z++){let K=Z/y*(2*Math.PI),oe=Math.sin(K)*W,de=Math.cos(K)*W;I.push(oe,0,de),R.push(G.r,G.g,G.b),K=(Z+1)/y*(2*Math.PI),oe=Math.sin(K)*W,de=Math.cos(K)*W,I.push(oe,0,de),R.push(G.r,G.g,G.b)}}const D=new bi;D.setAttribute("position",new Pr(I,3)),D.setAttribute("color",new Pr(R,3)),super(D,new Na({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}},n.PolyhedronBufferGeometry=Ka,n.PolyhedronGeometry=Ka,n.PositionalAudio=class extends Gf{constructor(M){super(M),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(M){return this.panner.refDistance=M,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(M){return this.panner.rolloffFactor=M,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(M){return this.panner.distanceModel=M,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(M){return this.panner.maxDistance=M,this}setDirectionalCone(M,i,f){return this.panner.coneInnerAngle=M,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=f,this}updateMatrixWorld(M){if(super.updateMatrixWorld(M),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Oh,K9,HM),Eg.set(0,0,1).applyQuaternion(K9);const i=this.panner;if(i.positionX){const f=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(Oh.x,f),i.positionY.linearRampToValueAtTime(Oh.y,f),i.positionZ.linearRampToValueAtTime(Oh.z,f),i.orientationX.linearRampToValueAtTime(Eg.x,f),i.orientationY.linearRampToValueAtTime(Eg.y,f),i.orientationZ.linearRampToValueAtTime(Eg.z,f)}else i.setPosition(Oh.x,Oh.y,Oh.z),i.setOrientation(Eg.x,Eg.y,Eg.z)}},n.PropertyBinding=ws,n.PropertyMixer=Q9,n.QuadraticBezierCurve=zf,n.QuadraticBezierCurve3=Ph,n.Quaternion=at,n.QuaternionKeyframeTrack=vc,n.QuaternionLinearInterpolant=O3,n.REVISION=r,n.RGBADepthPacking=3201,n.RGBAFormat=1023,n.RGBAIntegerFormat=1033,n.RGBA_ASTC_10x10_Format=37819,n.RGBA_ASTC_10x5_Format=37816,n.RGBA_ASTC_10x6_Format=37817,n.RGBA_ASTC_10x8_Format=37818,n.RGBA_ASTC_12x10_Format=37820,n.RGBA_ASTC_12x12_Format=37821,n.RGBA_ASTC_4x4_Format=37808,n.RGBA_ASTC_5x4_Format=37809,n.RGBA_ASTC_5x5_Format=37810,n.RGBA_ASTC_6x5_Format=37811,n.RGBA_ASTC_6x6_Format=37812,n.RGBA_ASTC_8x5_Format=37813,n.RGBA_ASTC_8x6_Format=37814,n.RGBA_ASTC_8x8_Format=37815,n.RGBA_BPTC_Format=36492,n.RGBA_ETC2_EAC_Format=37496,n.RGBA_PVRTC_2BPPV1_Format=35843,n.RGBA_PVRTC_4BPPV1_Format=35842,n.RGBA_S3TC_DXT1_Format=33777,n.RGBA_S3TC_DXT3_Format=33778,n.RGBA_S3TC_DXT5_Format=33779,n.RGBDEncoding=3006,n.RGBEEncoding=3002,n.RGBEFormat=1023,n.RGBFormat=1022,n.RGBIntegerFormat=1032,n.RGBM16Encoding=3005,n.RGBM7Encoding=3004,n.RGB_ETC1_Format=36196,n.RGB_ETC2_Format=37492,n.RGB_PVRTC_2BPPV1_Format=35841,n.RGB_PVRTC_4BPPV1_Format=35840,n.RGB_S3TC_DXT1_Format=33776,n.RGFormat=1030,n.RGIntegerFormat=1031,n.RawShaderMaterial=Mf,n.Ray=rl,n.Raycaster=class{constructor(M,i,f=0,y=1/0){this.ray=new rl(M,i),this.near=f,this.far=y,this.camera=null,this.layers=new Si,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(M,i){this.ray.set(M,i)}setFromCamera(M,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(M.x,M.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(M.x,M.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(M,i=!1,f=[]){return $3(M,this,f,i),f.sort(sx),f}intersectObjects(M,i=!1,f=[]){for(let y=0,_=M.length;y<_;y++)$3(M[y],this,f,i);return f.sort(sx),f}},n.RectAreaLight=Xv,n.RedFormat=1028,n.RedIntegerFormat=1029,n.ReinhardToneMapping=2,n.RepeatWrapping=1e3,n.ReplaceStencilOp=7681,n.ReverseSubtractEquation=102,n.RingBufferGeometry=Ad,n.RingGeometry=Ad,n.SRGB8_ALPHA8_ASTC_10x10_Format=37851,n.SRGB8_ALPHA8_ASTC_10x5_Format=37848,n.SRGB8_ALPHA8_ASTC_10x6_Format=37849,n.SRGB8_ALPHA8_ASTC_10x8_Format=37850,n.SRGB8_ALPHA8_ASTC_12x10_Format=37852,n.SRGB8_ALPHA8_ASTC_12x12_Format=37853,n.SRGB8_ALPHA8_ASTC_4x4_Format=37840,n.SRGB8_ALPHA8_ASTC_5x4_Format=37841,n.SRGB8_ALPHA8_ASTC_5x5_Format=37842,n.SRGB8_ALPHA8_ASTC_6x5_Format=37843,n.SRGB8_ALPHA8_ASTC_6x6_Format=37844,n.SRGB8_ALPHA8_ASTC_8x5_Format=37845,n.SRGB8_ALPHA8_ASTC_8x6_Format=37846,n.SRGB8_ALPHA8_ASTC_8x8_Format=37847,n.Scene=$t,n.SceneUtils=KM,n.ShaderChunk=ts,n.ShaderLib=pc,n.ShaderMaterial=Th,n.ShadowMaterial=Uv,n.Shape=jf,n.ShapeBufferGeometry=El,n.ShapeGeometry=El,n.ShapePath=q9,n.ShapeUtils=Yc,n.ShortType=1011,n.Skeleton=Pf,n.SkeletonHelper=i4,n.SkinnedMesh=qc,n.SmoothShading=2,n.Sphere=tl,n.SphereBufferGeometry=Sl,n.SphereGeometry=Sl,n.Spherical=class{constructor(M=1,i=0,f=0){return this.radius=M,this.phi=i,this.theta=f,this}set(M,i,f){return this.radius=M,this.phi=i,this.theta=f,this}copy(M){return this.radius=M.radius,this.phi=M.phi,this.theta=M.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(M){return this.setFromCartesianCoords(M.x,M.y,M.z)}setFromCartesianCoords(M,i,f){return this.radius=Math.sqrt(M*M+i*i+f*f),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(M,f),this.phi=Math.acos(Fr(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},n.SphericalHarmonics3=V3,n.SplineCurve=N0,n.SpotLight=B3,n.SpotLightHelper=class extends Me{constructor(M,i){super(),this.light=M,this.light.updateMatrixWorld(),this.matrix=M.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const f=new bi,y=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let S=0,I=1,R=32;S<R;S++,I++){const D=S/R*Math.PI*2,F=I/R*Math.PI*2;y.push(Math.cos(D),Math.sin(D),1,Math.cos(F),Math.sin(F),1)}f.setAttribute("position",new Pr(y,3));const _=new Na({fog:!1,toneMapped:!1});this.cone=new qu(f,_),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const M=this.light.distance?this.light.distance:1e3,i=M*Math.tan(this.light.angle);this.cone.scale.set(i,i,M),ax.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ax),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},n.Sprite=Vl,n.SpriteMaterial=Yn,n.SrcAlphaFactor=204,n.SrcAlphaSaturateFactor=210,n.SrcColorFactor=202,n.StaticCopyUsage=35046,n.StaticDrawUsage=35044,n.StaticReadUsage=35045,n.StereoCamera=class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ga,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ga,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(M){const i=this._cache;if(i.focus!==M.focus||i.fov!==M.fov||i.aspect!==M.aspect*this.aspect||i.near!==M.near||i.far!==M.far||i.zoom!==M.zoom||i.eyeSep!==this.eyeSep){i.focus=M.focus,i.fov=M.fov,i.aspect=M.aspect*this.aspect,i.near=M.near,i.far=M.far,i.zoom=M.zoom,i.eyeSep=this.eyeSep;const f=M.projectionMatrix.clone(),y=i.eyeSep/2,_=y*i.near/i.focus,S=i.near*Math.tan(Er*i.fov*.5)/i.zoom;let I,R;Jv.elements[12]=-y,X9.elements[12]=y,I=-S*i.aspect+_,R=S*i.aspect+_,f.elements[0]=2*i.near/(R-I),f.elements[8]=(R+I)/(R-I),this.cameraL.projectionMatrix.copy(f),I=-S*i.aspect-_,R=S*i.aspect-_,f.elements[0]=2*i.near/(R-I),f.elements[8]=(R+I)/(R-I),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(M.matrixWorld).multiply(Jv),this.cameraR.matrixWorld.copy(M.matrixWorld).multiply(X9)}},n.StreamCopyUsage=35042,n.StreamDrawUsage=35040,n.StreamReadUsage=35041,n.StringKeyframeTrack=ms,n.SubtractEquation=101,n.SubtractiveBlending=3,n.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},n.TangentSpaceNormalMap=0,n.TetrahedronBufferGeometry=F0,n.TetrahedronGeometry=F0,n.TextBufferGeometry=mg,n.TextGeometry=mg,n.Texture=le,n.TextureLoader=qv,n.TorusBufferGeometry=gg,n.TorusGeometry=gg,n.TorusKnotBufferGeometry=z0,n.TorusKnotGeometry=z0,n.Triangle=Bn,n.TriangleFanDrawMode=2,n.TriangleStripDrawMode=1,n.TrianglesDrawMode=0,n.TubeBufferGeometry=$p,n.TubeGeometry=$p,n.UVMapping=300,n.Uint16Attribute=function(M,i){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Oo(M,i)},n.Uint16BufferAttribute=Oo,n.Uint32Attribute=function(M,i){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Gs(M,i)},n.Uint32BufferAttribute=Gs,n.Uint8Attribute=function(M,i){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new jo(M,i)},n.Uint8BufferAttribute=jo,n.Uint8ClampedAttribute=function(M,i){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Xa(M,i)},n.Uint8ClampedBufferAttribute=Xa,n.Uniform=Qp,n.UniformsLib=Lr,n.UniformsUtils=mv,n.UnsignedByteType=1009,n.UnsignedInt248Type=1020,n.UnsignedIntType=1014,n.UnsignedShort4444Type=1017,n.UnsignedShort5551Type=1018,n.UnsignedShort565Type=1019,n.UnsignedShortType=1012,n.VSMShadowMap=3,n.Vector2=Vn,n.Vector3=me,n.Vector4=Fe,n.VectorKeyframeTrack=xg,n.Vertex=function(M,i,f){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new me(M,i,f)},n.VertexColors=2,n.VideoTexture=qp,n.WebGL1Renderer=wn,n.WebGLCubeRenderTarget=$m,n.WebGLMultipleRenderTargets=kt,n.WebGLMultisampleRenderTarget=Tt,n.WebGLRenderTarget=nt,n.WebGLRenderTargetCube=function(M,i,f){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new $m(M,f)},n.WebGLRenderer=zt,n.WebGLUtils=Ct,n.WireframeGeometry=Kc,n.WireframeHelper=function(M,i){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new qu(new Kc(M.geometry),new Na({color:i!==void 0?i:16777215}))},n.WrapAroundEnding=2402,n.XHRLoader=function(M){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Qc(M)},n.ZeroCurvatureEnding=2400,n.ZeroFactor=200,n.ZeroSlopeEnding=2401,n.ZeroStencilOp=0,n.sRGBEncoding=3001,Object.defineProperty(n,"__esModule",{value:!0})})})(Kk,Kk.exports);var ju=Kk.exports,SV={exports:{}},TV={exports:{}},MV={exports:{}};(function(t,e){const r=.0005555555555555556*Math.PI,s=Math.atan(3/4),u=63710088e-1,p=40075017;t.exports={WORLD_SIZE:1024e3,PROJECTION_WORLD_SIZE:1024e3/(u*Math.PI*2),MERCATOR_A:u,DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,EARTH_RADIUS:u,EARTH_CIRCUMFERENCE:2*Math.PI*u,EARTH_CIRCUMFERENCE_EQUATOR:p,FOV_ORTHO:r,FOV:s,FOV_DEGREES:s*180/Math.PI,TILE_SIZE:512}})(MV);var OI=MV.exports,kV={exports:{}};(function(t,e){function n(){}n.prototype={Coords:function(r){if(r.constructor!==Array){console.error("Coords must be an array");return}if(r.length<2){console.error("Coords length must be at least 2");return}for(const s of r)if(s.constructor!==Number){console.error("Coords values must be numbers");return}if(Math.abs(r[1])>90){console.error("Latitude must be between -90 and 90");return}return r},Line:function(r){var s=this;if(r.constructor!==Array){console.error("Line must be an array");return}for(const u of r)if(!s.Coords(u)){console.error("Each coordinate in a line must be a valid Coords type");return}return r},Rotation:function(r){if(r.constructor===Number)r={z:r};else if(r.constructor===Object)for(const s of Object.keys(r)){if(!["x","y","z"].includes(s)){console.error("Rotation parameters must be x, y, or z");return}if(r[s].constructor!==Number){console.error("Individual rotation values must be numbers");return}}else{console.error("Rotation must be an object or a number");return}return r},Scale:function(r){if(r.constructor===Number)r={x:r,y:r,z:r};else if(r.constructor===Object)for(const s of Object.keys(r)){if(!["x","y","z"].includes(s)){console.error("Scale parameters must be x, y, or z");return}if(r[s].constructor!==Number){console.error("Individual scale values must be numbers");return}}else{console.error("Scale must be an object or a number");return}return r}},t.exports=n})(kV);var are=kV.exports;(function(t,e){var n=ju,r=OI,s=are,u={prettyPrintMatrix:function(p){for(var g=0;g<4;g++){var l=[p[g],p[g+4],p[g+8],p[g+12]];console.log(l.map(function(E){return E.toFixed(4)}))}},makePerspectiveMatrix:function(p,g,l,E){var P=new n.Matrix4,O=1/Math.tan(p/2),j=1/(l-E),$=[O/g,0,0,0,0,O,0,0,0,0,(E+l)*j,-1,0,0,2*E*l*j,0];return P.elements=$,P},makeOrthographicMatrix:function(p,g,l,E,P,O){var j=new n.Matrix4;const $=1/(g-p),Y=1/(l-E),re=1/(O-P),_e=(g+p)*$,J=(l+E)*Y,H=P*re;var te=[2*$,0,0,0,0,2*Y,0,0,0,0,-1*re,0,-_e,-J,-H,1];return j.elements=te,j},radify:function(p){function g(l){return l=l||0,Math.PI*2*l/360}return typeof p=="object"?p.length>0?p.map(function(l){return g(l)}):[g(p.x),g(p.y),g(p.z)]:g(p)},degreeify:function(p){function g(l){return l=l||0,l*360/(Math.PI*2)}return typeof p=="object"?[g(p.x),g(p.y),g(p.z)]:g(p)},projectToWorld:function(p){var g=[-r.MERCATOR_A*r.DEG2RAD*p[0]*r.PROJECTION_WORLD_SIZE,-r.MERCATOR_A*Math.log(Math.tan(Math.PI*.25+.5*r.DEG2RAD*p[1]))*r.PROJECTION_WORLD_SIZE];if(!p[2])g.push(0);else{var l=this.projectedUnitsPerMeter(p[1]);g.push(p[2]*l)}var E=new n.Vector3(g[0],g[1],g[2]);return E},projectedUnitsPerMeter:function(p){return Math.abs(r.WORLD_SIZE/Math.cos(r.DEG2RAD*p)/r.EARTH_CIRCUMFERENCE)},_circumferenceAtLatitude:function(p){return r.EARTH_CIRCUMFERENCE*Math.cos(p*Math.PI/180)},mercatorZfromAltitude:function(p,g){return p/this._circumferenceAtLatitude(g)},_scaleVerticesToMeters:function(p,g){var l=this.projectedUnitsPerMeter(p[1]);this.projectToWorld(p);for(var E=0;E<g.length;E++)g[E].multiplyScalar(l);return g},projectToScreen:function(p){console.log("WARNING: Projecting to screen coordinates is not yet implemented")},unprojectFromScreen:function(p){console.log("WARNING: unproject is not yet implemented")},unprojectFromWorld:function(p){var g=[-p.x/(r.MERCATOR_A*r.DEG2RAD*r.PROJECTION_WORLD_SIZE),2*(Math.atan(Math.exp(p.y/(r.PROJECTION_WORLD_SIZE*-r.MERCATOR_A)))-Math.PI/4)/r.DEG2RAD],l=this.projectedUnitsPerMeter(g[1]),E=p.z||0;return g.push(E/l),g},toScreenPosition:function(p,g){var l=new n.Vector3,E=.5*renderer.context.canvas.width,P=.5*renderer.context.canvas.height;return p.updateMatrixWorld(),l.setFromMatrixPosition(p.matrixWorld),l.project(g),l.x=l.x*E+E,l.y=-(l.y*P)+P,{x:l.x,y:l.y}},getFeatureCenter:function(g,l,E){let P=[],O=0,j=0,$=0,Y=[...g.geometry.coordinates[0]];return g.geometry.type==="Point"?P=[...Y[0]]:(g.geometry.type==="MultiPolygon"&&(Y=Y[0]),Y.splice(-1,1),Y.forEach(function(re){O+=re[0],j+=re[1]}),P=[O/Y.length,j/Y.length]),$=this.getObjectHeightOnFloor(g,l,E),P.length<3?P.push($):P[2]=$,P},getObjectHeightOnFloor:function(p,g,l=p.properties.level||0){let E=l*(p.properties.levelHeight||0),P=p.properties.base_height||p.properties.min_height||0,j=(g&&g.model?0:p.properties.height-P)+P;return E+j},_flipMaterialSides:function(p){},normalizeVertices(p){let g=new n.BufferGeometry,l=[];for(var E=0;E<p.length;E++){let j=p[E];l.push(j.x,j.y,j.z),l.push(j.x,j.y,j.z)}g.setAttribute("position",new n.BufferAttribute(new Float32Array(l),3)),g.computeBoundingSphere();var P=g.boundingSphere.center,O=p.map(function(j){var $=j.sub(P);return $});return{vertices:O,position:P}},flattenVectors(p){var g=[];for(let l of p)g.push(l.x,l.y,l.z);return g},lnglatsToWorld:function(p){var g=p.map(function(l){var E=u.projectToWorld(l),P=new n.Vector3(E.x,E.y,E.z);return P});return g},extend:function(p,g){for(let l in g)p[l]=g[l]},clone:function(p){var g={};for(let l in p)g[l]=p[l];return g},clamp:function(p,g,l){return Math.min(l,Math.max(g,p))},types:{rotation:function(p,g){p||(p=0),typeof p=="number"&&(p={z:p});var l=this.applyDefault([p.x,p.y,p.z],g),E=u.radify(l);return E},scale:function(p,g){return p||(p=1),typeof p=="number"?p=[p,p,p]:this.applyDefault([p.x,p.y,p.z],g)},applyDefault:function(p,g){var l=p.map(function(E,P){return E=E||g[P],E});return l}},toDecimal:function(p,g){return Number(p.toFixed(g))},equal:function(p,g){const l=Object.keys(p),E=Object.keys(g);if(l.length!==E.length||l.length==0&&E.length==0&&l!==E)return!1;for(const P of l){const O=p[P],j=g[P],$=this.isObject(O)&&this.isObject(j);if($&&!equal(O,j)||!$&&O!==j)return!1}return!0},isObject:function(p){return p!=null&&typeof p=="object"},curveToLine:(p,g)=>{let{width:l,color:E}=g,P=new n.BufferGeometry().setFromPoints(p.getPoints(100)),O=new n.LineBasicMaterial({color:E,linewidth:l});return new n.Line(P,O)},curvesToLines:p=>{var g=[16711680,2031360,2490623],l=p.map((E,P)=>{let O={width:3,color:g[P]||"purple"};return curveToLine(E,O)});return l},_validate:function(p,g){p=p||{};var l={};u.extend(l,p);for(let E of Object.keys(g))if(p[E]===void 0)if(g[E]===null){console.error(E+" is required");return}else l[E]=g[E];else l[E]=p[E];return l},Validator:new s,exposedMethods:["projectToWorld","projectedUnitsPerMeter","extend","unprojectFromWorld"]};t.exports=u})(TV);var gd=TV.exports;(function(t,e){const n=ju,r=gd,s=OI;function u(p,g,l){this.map=p,this.camera=g,this.active=!0,this.camera.matrixAutoUpdate=!1,this.world=l||new n.Group,this.world.position.x=this.world.position.y=s.WORLD_SIZE/2,this.world.matrixAutoUpdate=!1,this.state={translateCenter:new n.Matrix4().makeTranslation(s.WORLD_SIZE/2,-s.WORLD_SIZE/2,0),worldSizeRatio:s.TILE_SIZE/s.WORLD_SIZE,worldSize:s.TILE_SIZE*this.map.transform.scale};let E=this;this.map.on("move",function(){E.updateCamera()}).on("resize",function(){E.setupCamera()}),this.setupCamera()}u.prototype={setupCamera:function(){const p=this.map.transform;this.camera.aspect=p.width/p.height,this.halfFov=p._fov/2,this.cameraToCenterDistance=.5/Math.tan(this.halfFov)*p.height;const g=p._maxPitch*Math.PI/180;this.acuteAngle=Math.PI/2-g,this.updateCamera()},updateCamera:function(p){if(!this.camera){console.log("nocamera");return}const g=this.map.transform;this.camera.aspect=g.width/g.height;const l=g.centerOffset||new n.Vector3;let E=0,P=0;this.halfFov=g._fov/2;const O=Math.PI/2+g._pitch,j=Math.cos(Math.PI/2-g._pitch);this.cameraToCenterDistance=.5/Math.tan(this.halfFov)*g.height;let $=1;const Y=this.worldSize();if(this.map.tb.mapboxVersion>=2){$=this.mercatorZfromAltitude(1,g.center.lat)*Y;const We=g._fov*(.5+g.centerOffset.y/g.height),Ot=g.elevation?g.elevation.getMinElevationBelowMSL()*$:0,st=(g._camera.position[2]*Y-Ot)/Math.cos(g._pitch),qe=Math.sin(We)*st/Math.sin(r.clamp(Math.PI-O-We,.01,Math.PI-.01));P=j*qe+st;const et=st*(1/g._horizonShift);E=Math.min(P*1.01,et)}else{const We=Math.sin(this.halfFov)*this.cameraToCenterDistance/Math.sin(Math.PI-O-this.halfFov);P=j*We+this.cameraToCenterDistance,E=P*1.01}this.cameraTranslateZ=new n.Matrix4().makeTranslation(0,0,this.cameraToCenterDistance);const re=g.height/50,_e=Math.max(re*j,re),J=g.height,H=g.width;this.camera instanceof n.OrthographicCamera?this.camera.projectionMatrix=r.makeOrthographicMatrix(H/-2,H/2,J/2,J/-2,_e,E):this.camera.projectionMatrix=r.makePerspectiveMatrix(g._fov,H/J,_e,E),this.camera.projectionMatrix.elements[8]=-l.x*2/g.width,this.camera.projectionMatrix.elements[9]=l.y*2/g.height;let te=this.calcCameraMatrix(g._pitch,g.angle);g.elevation&&(te.elements[14]=g._camera.position[2]*Y),this.camera.matrixWorld.copy(te);let ce=g.scale*this.state.worldSizeRatio,Se=new n.Matrix4,Ie=new n.Matrix4,Ne=new n.Matrix4;Se.makeScale(ce,ce,ce);let ut=g.x||g.point.x,mt=g.y||g.point.y;Ie.makeTranslation(-ut,mt,0),Ne.makeRotationZ(Math.PI),this.world.matrix=new n.Matrix4().premultiply(Ne).premultiply(this.state.translateCenter).premultiply(Se).premultiply(Ie),this.map.fire("CameraSynced",{detail:{nearZ:_e,farZ:E,pitch:g._pitch,angle:g.angle,furthestDistance:P,cameraToCenterDistance:this.cameraToCenterDistance,t:this.map.transform,tbProjMatrix:this.camera.projectionMatrix.elements,tbWorldMatrix:this.world.matrix.elements,cameraSyn:u}})},worldSize(){let p=this.map.transform;return p.tileSize*p.scale},worldSizeFromZoom(){let p=this.map.transform;return Math.pow(2,p.zoom)*p.tileSize},mercatorZfromAltitude(p,g){return p/this.circumferenceAtLatitude(g)},mercatorZfromZoom(){return this.cameraToCenterDistance/this.worldSizeFromZoom()},circumferenceAtLatitude(p){return s.EARTH_CIRCUMFERENCE*Math.cos(p*Math.PI/180)},calcCameraMatrix(p,g,l){const E=this.map.transform,P=p===void 0?E._pitch:p,O=g===void 0?E.angle:g,j=l===void 0?this.cameraTranslateZ:l;return new n.Matrix4().premultiply(j).premultiply(new n.Matrix4().makeRotationX(P)).premultiply(new n.Matrix4().makeRotationZ(O))},updateCameraState(){let p=this.map.transform;if(!p.height)return;const g=p._camera.forward(),l=p.cameraToCenterDistance,E=p.point;p._cameraZoom?p._cameraZoom:p._zoom;const O=this.mercatorZfromZoom(p)-this.mercatorZfromAltitude(p._centerAltitude,p.center.lat),j=p.cameraToCenterDistance/O;return[E.x/this.worldSize()-g[0]*l/j,E.y/this.worldSize()-g[1]*l/j,this.mercatorZfromAltitude(p._centerAltitude,p._center.lat)+-g[2]*l/j]},getWorldToCamera(p,g){let l=this.map.transform;const E=new n.Matrix4,P=new n.Matrix4,O=l._camera._orientation,j=l._camera.position,$=new n.Vector3(j[0],j[1],j[2]),Y=new n.Quaternion;Y.set(O[0],O[1],O[2],O[3]);const re=Y.conjugate();return $.multiplyScalar(-p),P.makeTranslation($.x,$.y,$.z),E.makeRotationFromQuaternion(re).premultiply(P),E.elements[1]*=-1,E.elements[5]*=-1,E.elements[9]*=-1,E.elements[13]*=-1,E.elements[8]*=g,E.elements[9]*=g,E.elements[10]*=g,E.elements[11]*=g,E},translate(p,g,l){let E=l[0]||l.x,P=l[1]||l.y,O=l[2]||l.z,j,$,Y,re,_e,J,H,te,ce,Se,Ie,Ne;return g===p?(p[12]=g[0]*E+g[4]*P+g[8]*O+g[12],p[13]=g[1]*E+g[5]*P+g[9]*O+g[13],p[14]=g[2]*E+g[6]*P+g[10]*O+g[14],p[15]=g[3]*E+g[7]*P+g[11]*O+g[15]):(j=g[0],$=g[1],Y=g[2],re=g[3],_e=g[4],J=g[5],H=g[6],te=g[7],ce=g[8],Se=g[9],Ie=g[10],Ne=g[11],p[0]=j,p[1]=$,p[2]=Y,p[3]=re,p[4]=_e,p[5]=J,p[6]=H,p[7]=te,p[8]=ce,p[9]=Se,p[10]=Ie,p[11]=Ne,p[12]=j*E+_e*P+ce*O+g[12],p[13]=$*E+J*P+Se*O+g[13],p[14]=Y*E+H*P+Ie*O+g[14],p[15]=re*E+te*P+Ne*O+g[15]),p}},t.exports=u})(SV);var lre=SV.exports,CV={exports:{}};(function(t,e){(function(){var n=Math.PI,r=Math.sin,s=Math.cos,u=Math.tan,p=Math.asin,g=Math.atan2,l=Math.acos,E=n/180,P=1e3*60*60*24,O=2440588,j=2451545;function $(Je){return Je.valueOf()/P-.5+O}function Y(Je){return new Date((Je+.5-O)*P)}function re(Je){return $(Je)-j}var _e=E*23.4397;function J(Je,rt){return g(r(Je)*s(_e)-u(rt)*r(_e),s(Je))}function H(Je,rt){return p(r(rt)*s(_e)+s(rt)*r(_e)*r(Je))}function te(Je,rt,Ut){return g(r(Je),s(Je)*r(rt)-u(Ut)*s(rt))}function ce(Je,rt,Ut){return p(r(rt)*r(Ut)+s(rt)*s(Ut)*s(Je))}function Se(Je,rt){return E*(280.16+360.9856235*Je)-rt}function Ie(Je){return Je<0&&(Je=0),2967e-7/Math.tan(Je+.00312536/(Je+.08901179))}function Ne(Je){return E*(357.5291+.98560028*Je)}function ut(Je){var rt=E*(1.9148*r(Je)+.02*r(2*Je)+3e-4*r(3*Je)),Ut=E*102.9372;return Je+rt+Ut+n}function mt(Je){var rt=Ne(Je),Ut=ut(rt);return{dec:H(Ut,0),ra:J(Ut,0)}}var We={};We.getPosition=function(Je,rt,Ut){var ht=E*-Ut,Ft=E*rt,Nn=re(Je),zn=mt(Nn),rr=Se(Nn,ht)-zn.ra;return{azimuth:te(rr,Ft,zn.dec),altitude:ce(rr,Ft,zn.dec)}},We.toJulian=function(Je){return $(Je)};var Ot=We.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];We.addTime=function(Je,rt,Ut){Ot.push([Je,rt,Ut])};var st=9e-4;function qe(Je,rt){return Math.round(Je-st-rt/(2*n))}function et(Je,rt,Ut){return st+(Je+rt)/(2*n)+Ut}function Q(Je,rt,Ut){return j+Je+.0053*r(rt)-.0069*r(2*Ut)}function ye(Je,rt,Ut){return l((r(Je)-r(rt)*r(Ut))/(s(rt)*s(Ut)))}function ge(Je){return-2.076*Math.sqrt(Je)/60}function xe(Je,rt,Ut,ht,Ft,Nn,zn){var rr=ye(Je,Ut,ht),Gr=et(rr,rt,Ft);return Q(Gr,Nn,zn)}We.getTimes=function(Je,rt,Ut,ht){ht=ht||0;var Ft=E*-Ut,Nn=E*rt,zn=ge(ht),rr=re(Je),Gr=qe(rr,Ft),Li=et(0,Ft,Gr),wi=Ne(Li),Nr=ut(wi),fi=H(Nr,0),Mi=Q(Li,wi,Nr),jn,Be,ze,vt,Qe,gt,St={solarNoon:Y(Mi),nadir:Y(Mi-.5)};for(jn=0,Be=Ot.length;jn<Be;jn+=1)ze=Ot[jn],vt=(ze[0]+zn)*E,Qe=xe(vt,Ft,Nn,fi,Gr,wi,Nr),gt=Mi-(Qe-Mi),St[ze[1]]=Y(gt),St[ze[2]]=Y(Qe);return St};function Ce(Je){var rt=E*(218.316+13.176396*Je),Ut=E*(134.963+13.064993*Je),ht=E*(93.272+13.22935*Je),Ft=rt+E*6.289*r(Ut),Nn=E*5.128*r(ht),zn=385001-20905*s(Ut);return{ra:J(Ft,Nn),dec:H(Ft,Nn),dist:zn}}We.getMoonPosition=function(Je,rt,Ut){var ht=E*-Ut,Ft=E*rt,Nn=re(Je),zn=Ce(Nn),rr=Se(Nn,ht)-zn.ra,Gr=ce(rr,Ft,zn.dec),Li=g(r(rr),u(Ft)*s(zn.dec)-r(zn.dec)*s(rr));return Gr=Gr+Ie(Gr),{azimuth:te(rr,Ft,zn.dec),altitude:Gr,distance:zn.dist,parallacticAngle:Li}},We.getMoonIllumination=function(Je){var rt=re(Je||new Date),Ut=mt(rt),ht=Ce(rt),Ft=149598e3,Nn=l(r(Ut.dec)*r(ht.dec)+s(Ut.dec)*s(ht.dec)*s(Ut.ra-ht.ra)),zn=g(Ft*r(Nn),ht.dist-Ft*s(Nn)),rr=g(s(Ut.dec)*r(Ut.ra-ht.ra),r(Ut.dec)*s(ht.dec)-s(Ut.dec)*r(ht.dec)*s(Ut.ra-ht.ra));return{fraction:(1+s(zn))/2,phase:.5+.5*zn*(rr<0?-1:1)/Math.PI,angle:rr}};function tt(Je,rt){return new Date(Je.valueOf()+rt*P/24)}We.getMoonTimes=function(Je,rt,Ut,ht){var Ft=new Date(Je);ht?Ft.setUTCHours(0,0,0,0):Ft.setHours(0,0,0,0);for(var Nn=.133*E,zn=We.getMoonPosition(Ft,rt,Ut).altitude-Nn,rr,Gr,Li,wi,Nr,fi,Mi,jn,Be,ze,vt,Qe,gt,St=1;St<=24&&(rr=We.getMoonPosition(tt(Ft,St),rt,Ut).altitude-Nn,Gr=We.getMoonPosition(tt(Ft,St+1),rt,Ut).altitude-Nn,Nr=(zn+Gr)/2-rr,fi=(Gr-zn)/2,Mi=-fi/(2*Nr),jn=(Nr*Mi+fi)*Mi+rr,Be=fi*fi-4*Nr*rr,ze=0,Be>=0&&(gt=Math.sqrt(Be)/(Math.abs(Nr)*2),vt=Mi-gt,Qe=Mi+gt,Math.abs(vt)<=1&&ze++,Math.abs(Qe)<=1&&ze++,vt<-1&&(vt=Qe)),ze===1?zn<0?Li=St+vt:wi=St+vt:ze===2&&(Li=St+(jn<0?Qe:vt),wi=St+(jn<0?vt:Qe)),!(Li&&wi));St+=2)zn=Gr;var Rt={};return Li&&(Rt.rise=tt(Ft,Li)),wi&&(Rt.set=tt(Ft,wi)),!Li&&!wi&&(Rt[jn>0?"alwaysUp":"alwaysDown"]=!0),Rt},t.exports=We})()})(CV);var ure=CV.exports,IV={exports:{}},AV={exports:{}};(function(t,e){var n=gd,r=ju,s={material:"MeshBasicMaterial",color:"black",opacity:1};function u(p){var g;p?(p=n._validate(p,s),p.material&&p.material.isMaterial?g=p.material:p.material||p.color||p.opacity?g=new r[p.material]({color:p.color,transparent:p.opacity<1}):g=l(),g.opacity=p.opacity,p.side&&(g.side=p.side)):g=l();function l(){return new r[s.material]({color:s.color})}return g}t.exports=u})(AV);var FI=AV.exports,LV={exports:{}};(function(t,e){const n=ju,r=gd;function s(p){this.map=p,this.enrolledObjects=[],this.previousFrameTime}s.prototype={unenroll:function(p){this.enrolledObjects.splice(this.enrolledObjects.indexOf(p),1)},enroll:function(p){if(p.clock=new n.Clock,p.hasDefaultAnimation=!1,p.defaultAction,p.actions=[],p.mixer,p.animations&&p.animations.length>0){p.hasDefaultAnimation=!0;let E=p.userData.defaultAnimation?p.userData.defaultAnimation:0;p.mixer=new n.AnimationMixer(p),g(E)}function g(E){for(let P=0;P<p.animations.length;P++){E>p.animations.length&&console.log("The animation index "+E+" doesn't exist for this object");let O=p.animations[P],j=p.mixer.clipAction(O);p.actions.push(j),E===P?(p.defaultAction=j,j.setEffectiveWeight(1)):j.setEffectiveWeight(0),j.play()}}let l=!1;Object.defineProperty(p,"isPlaying",{get(){return l},set(E){l!=E&&(l=E,p.dispatchEvent({type:"IsPlayingChanged",detail:p}))}}),this.enrolledObjects.push(p),p.animationQueue=[],p.set=function(E){if(E.duration>0){let P={start:Date.now(),expiration:Date.now()+E.duration,endState:{}};r.extend(E,P);let O=E.coords,j=E.rotation,$=E.scale||E.scaleX||E.scaleY||E.scaleZ;if(j){let re=p.rotation;E.startRotation=[re.x,re.y,re.z],E.endState.rotation=r.types.rotation(E.rotation,E.startRotation),E.rotationPerMs=E.endState.rotation.map(function(_e,J){return(_e-E.startRotation[J])/E.duration})}if($){let re=p.scale;E.startScale=[re.x,re.y,re.z],E.endState.scale=r.types.scale(E.scale,E.startScale),E.scalePerMs=E.endState.scale.map(function(_e,J){return(_e-E.startScale[J])/E.duration})}O&&(E.pathCurve=new n.CatmullRomCurve3(r.lnglatsToWorld([p.coordinates,E.coords])));let Y={type:"set",parameters:E};this.animationQueue.push(Y),tb.map.repaint=!0}else this.stop(),E.rotation=r.radify(E.rotation),this._setObject(E);return this},p.animationMethod=null,p.stop=function(E){return p.mixer&&(p.isPlaying=!1,cancelAnimationFrame(p.animationMethod)),this.animationQueue=[],this},p.followPath=function(E,P){let O={type:"followPath",parameters:r._validate(E,u.followPath)};return r.extend(O.parameters,{pathCurve:new n.CatmullRomCurve3(r.lnglatsToWorld(E.path)),start:Date.now(),expiration:Date.now()+O.parameters.duration,cb:P}),this.animationQueue.push(O),tb.map.repaint=!0,this},p._setObject=function(E){p.setScale();let P=E.position,O=E.rotation,j=E.scale,$=E.worldCoordinates,Y=E.quaternion,re=E.translate,_e=E.worldTranslate;if(P){this.coordinates=P;let H=r.projectToWorld(P);this.position.copy(H)}if(re){this.coordinates=[this.coordinates[0]+re[0],this.coordinates[1]+re[1],this.coordinates[2]+re[2]];let H=r.projectToWorld(re);this.position.copy(H),E.position=this.coordinates}if(_e){this.translateX(_e.x),this.translateY(_e.y),this.translateZ(_e.z);let H=r.unprojectFromWorld(this.position);this.coordinates=E.position=H}if(O&&(this.rotation.set(O[0],O[1],O[2]),E.rotation=new n.Vector3(O[0],O[1],O[2])),j&&(this.scale.set(j[0],j[1],j[2]),E.scale=this.scale),Y&&(this.quaternion.setFromAxisAngle(Y[0],Y[1]),E.rotation=Y[0].multiplyScalar(Y[1])),$){this.position.copy($);let H=r.unprojectFromWorld($);this.coordinates=E.position=H}this.setBoundingBoxShadowFloor(),this.setReceiveShadowFloor(),this.updateMatrixWorld(),tb.map.repaint=!0;let J={type:"ObjectChanged",detail:{object:this,action:{position:E.position,rotation:E.rotation,scale:E.scale}}};this.dispatchEvent(J)},p.playDefault=function(E){if(p.mixer&&p.hasDefaultAnimation){let P={start:Date.now(),expiration:Date.now()+E.duration,endState:{}};r.extend(E,P),p.mixer.timeScale=E.speed||1;let O={type:"playDefault",parameters:E};return this.animationQueue.push(O),tb.map.repaint=!0,this}},p.playAnimation=function(E){p.mixer&&(E.animation&&g(E.animation),p.playDefault(E))},p.pauseAllActions=function(){p.mixer&&p.actions.forEach(function(E){E.paused=!0})},p.unPauseAllActions=function(){p.mixer&&p.actions.forEach(function(E){E.paused=!1})},p.deactivateAllActions=function(){p.mixer&&p.actions.forEach(function(E){E.stop()})},p.activateAllActions=function(){p.mixer&&p.actions.forEach(function(E){E.play()})},p.idle=function(){return p.mixer&&p.mixer.update(.01),tb.map.repaint=!0,this}},update:function(p){if(this.previousFrameTime===void 0&&(this.previousFrameTime=p),!this.enrolledObjects)return!1;for(let g=this.enrolledObjects.length-1;g>=0;g--){let l=this.enrolledObjects[g];if(!(!l.animationQueue||l.animationQueue.length===0))for(let E=l.animationQueue.length-1;E>=0;E--){let P=l.animationQueue[E];if(!P)continue;let O=P.parameters;if(!O.expiration){l.animationQueue.splice(E,1),l.animationQueue[E]&&(l.animationQueue[E].parameters.start=p);return}if(p>=O.expiration)O.expiration=!1,P.type==="playDefault"?l.stop():(O.endState&&l._setObject(O.endState),typeof O.cb<"u"&&O.cb());else{let $=(p-O.start)/O.duration;if(P.type==="set"){let Y={};O.pathCurve&&(Y.worldCoordinates=O.pathCurve.getPoint($)),O.rotationPerMs&&(Y.rotation=O.startRotation.map(function(re,_e){return re+O.rotationPerMs[_e]*$*O.duration})),O.scalePerMs&&(Y.scale=O.startScale.map(function(re,_e){return re+O.scalePerMs[_e]*$*O.duration})),l._setObject(Y)}if(P.type==="followPath"){let re={worldCoordinates:O.pathCurve.getPointAt($)};if(O.trackHeading){let _e=O.pathCurve.getTangentAt($).normalize(),J=new n.Vector3(0,0,0),H=new n.Vector3(0,1,0);J.crossVectors(H,_e).normalize();let te=Math.acos(H.dot(_e));re.quaternion=[J,te]}l._setObject(re)}P.type==="playDefault"&&(l.activateAllActions(),l.isPlaying=!0,l.animationMethod=requestAnimationFrame(this.update),l.mixer.update(l.clock.getDelta()),tb.map.repaint=!0)}}}this.previousFrameTime=p}};const u={followPath:{path:null,duration:1e3,trackHeading:!0}};t.exports=s})(LV);var cre=LV.exports,PV={exports:{}};(function(t,e){const n=ju;(function(){class r extends n.Object3D{constructor(O){super(),this.element=O||document.createElement("div"),this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.alwaysVisible=!1,Object.defineProperty(this,"layer",{get(){return this.parent&&this.parent.parent?this.parent.parent.layer:null}}),this.dispose=function(){this.remove(),this.element=null},this.remove=function(){this.element instanceof Element&&this.element.parentNode!==null&&this.element.parentNode.removeChild(this.element)},this.addEventListener("removed",function(){this.remove()})}copy(O,j){return super.copy(O,j),this.element=O.element.cloneNode(!0),this}}r.prototype.isCSS2DObject=!0;const s=new n.Vector3,u=new n.Matrix4,p=new n.Matrix4,g=new n.Vector3,l=new n.Vector3;class E{constructor(){const O=this;let j,$,Y,re;const _e={objects:new WeakMap,list:new Map};this.cacheList=_e.list;const J=document.createElement("div");J.style.overflow="hidden",this.domElement=J,this.getSize=function(){return{width:j,height:$}},this.render=function(Ie,Ne){Ie.autoUpdate===!0&&Ie.updateMatrixWorld(),Ne.parent===null&&Ne.updateMatrixWorld(),u.copy(Ne.matrixWorldInverse),p.multiplyMatrices(Ne.projectionMatrix,u),H(Ie,Ie,Ne),Se(Ie)},this.setSize=function(Ie,Ne){j=Ie,$=Ne,Y=j/2,re=$/2,J.style.width=Ie+"px",J.style.height=Ne+"px"};function H(Ie,Ne,ut){if(Ie.isCSS2DObject)if(!Ie.visible)_e.objects.delete({key:Ie.uuid}),_e.list.delete(Ie.uuid),Ie.remove();else{Ie.onBeforeRender(O,Ne,ut),s.setFromMatrixPosition(Ie.matrixWorld),s.applyMatrix4(p);const We=Ie.element;var mt;/apple/i.test(navigator.vendor)?mt="translate(-50%,-50%) translate("+Math.round(s.x*Y+Y)+"px,"+Math.round(-s.y*re+re)+"px)":mt="translate(-50%,-50%) translate("+(s.x*Y+Y)+"px,"+(-s.y*re+re)+"px)",We.style.WebkitTransform=mt,We.style.MozTransform=mt,We.style.oTransform=mt,We.style.transform=mt,We.style.display=Ie.visible&&s.z>=-1&&s.z<=1?"":"none";const Ot={distanceToCameraSquared:te(ut,Ie)};_e.objects.set({key:Ie.uuid},Ot),_e.list.set(Ie.uuid,Ie),We.parentNode!==J&&J.appendChild(We),Ie.onAfterRender(O,Ne,ut)}for(let We=0,Ot=Ie.children.length;We<Ot;We++)H(Ie.children[We],Ne,ut)}function te(Ie,Ne){return g.setFromMatrixPosition(Ie.matrixWorld),l.setFromMatrixPosition(Ne.matrixWorld),g.distanceToSquared(l)}function ce(Ie){const Ne=[];return Ie.traverse(function(ut){ut.isCSS2DObject&&Ne.push(ut)}),Ne}function Se(Ie){const Ne=ce(Ie).sort(function(mt,We){let Ot=_e.objects.get({key:mt.uuid}),st=_e.objects.get({key:We.uuid});if(Ot&&st){const qe=Ot.distanceToCameraSquared,et=st.distanceToCameraSquared;return qe-et}}),ut=Ne.length;for(let mt=0,We=Ne.length;mt<We;mt++)Ne[mt].element.style.zIndex=ut-mt}}}n.CSS2DObject=r,n.CSS2DRenderer=E})(),t.exports={CSS2DRenderer:n.CSS2DRenderer,CSS2DObject:n.CSS2DObject}})(PV);var pM=PV.exports;(function(t,e){const n=gd,r=ju,s=cre,u=pM;function p(){}p.prototype={line:function(g){g=n._validate(g,this._defaults.line);var l=n.lnglatsToWorld(g.geometry),E=n.normalizeVertices(l),P=n.flattenVectors(E.vertices),O=new Float32Array(P),j=new r.BufferGeometry;j.setAttribute("position",new r.BufferAttribute(O,3));var $=new r.LineBasicMaterial({color:16711680,linewidth:21}),Y=new r.Line(j,$);return Y.options=options||{},Y.position.copy(E.position),Y},extrusion:function(g){},unenroll:function(g,l){var E=this;l||E.animationManager.unenroll(g)},_addMethods:function(g,l){var E=this;const P="label",O="tooltip",j="help",$="shadowPlane";if(!l){let J=function(st,qe,et,Q){let ye=n.radify(Q);st.position.sub(qe),st.position.applyAxisAngle(et,ye),st.position.add(qe),st.rotateOnAxis(et,ye),tb.map.repaint=!0},Ot=function(st){return Math.pow(2,st)};var re=J,_e=Ot;g.coordinates||(g.coordinates=[0,0,0]),Object.defineProperty(g,"model",{get(){return g.getObjectByName("model")}}),Object.defineProperty(g,"animations",{get(){const st=g.model;return st?st.animations:null}}),E.animationManager.enroll(g),g.setCoords=function(st){return g.userData.topMargin&&g.userData.feature&&(st[2]+=((g.userData.feature.properties.height||0)-(g.userData.feature.properties.base_height||g.userData.feature.properties.min_height||0))*(g.userData.topMargin||0)),g.coordinates=st,g.set({position:st}),g},g.setTranslate=function(st){return g.set({translate:st}),g},g.setRotation=function(st){typeof st=="number"&&(st={z:st});var qe={x:n.radify(st.x)||g.rotation.x,y:n.radify(st.y)||g.rotation.y,z:n.radify(st.z)||g.rotation.z};g._setObject({rotation:[qe.x,qe.y,qe.z]})},g.calculateAdjustedPosition=function(st,qe,et){let Q=st.slice(),ye=n.unprojectFromWorld(g.modelSize);return et?(Q[0]-=qe.x!=0?ye[0]/qe.x:0,Q[1]-=qe.y!=0?ye[1]/qe.y:0,Q[2]-=qe.z!=0?ye[2]/qe.z:0):(Q[0]+=qe.x!=0?ye[0]/qe.x:0,Q[1]+=qe.y!=0?ye[1]/qe.y:0,Q[2]+=qe.z!=0?ye[2]/qe.z:0),Q},g.setRotationAxis=function(st){typeof st=="number"&&(st={z:st});let qe=g.modelBox(),et=new r.Vector3(qe.max.x,qe.max.y,qe.min.z);st.x!=0&&J(g,et,new r.Vector3(0,0,1),st.x),st.y!=0&&J(g,et,new r.Vector3(0,0,1),st.y),st.z!=0&&J(g,et,new r.Vector3(0,0,1),st.z)},Object.defineProperty(g,"scaleGroup",{get(){return g.getObjectByName("scaleGroup")}}),Object.defineProperty(g,"boxGroup",{get(){return g.getObjectByName("boxGroup")}}),Object.defineProperty(g,"boundingBox",{get(){return g.getObjectByName("boxModel")}}),Object.defineProperty(g,"boundingBoxShadow",{get(){return g.getObjectByName("boxShadow")}}),g.drawBoundingBox=function(){let st=g.box3(),qe=new r.Group;qe.name="boxGroup",qe.updateMatrixWorld(!0);let et=new r.Box3Helper(st,p.prototype._defaults.colors.yellow);et.name="boxModel",qe.add(et),et.layers.disable(0);let Q=st.clone();Q.max.z=Q.min.z;let ye=new r.Box3Helper(Q,p.prototype._defaults.colors.black);ye.name="boxShadow",qe.add(ye),ye.layers.disable(0),qe.visible=!1,g.scaleGroup.add(qe),g.setBoundingBoxShadowFloor()},g.setBoundingBoxShadowFloor=function(){if(g.boundingBoxShadow){let st=-g.modelHeight,qe=g.rotation,et=g.boundingBoxShadow;et.box.max.z=et.box.min.z=st,et.rotation.y=qe.y,et.rotation.x=-qe.x}},g.setAnchor=function(st){const qe=g.box3(),et=qe.getCenter(new r.Vector3);switch(g.none={x:0,y:0,z:0},g.center={x:et.x,y:et.y,z:qe.min.z},g.bottom={x:et.x,y:qe.max.y,z:qe.min.z},g.bottomLeft={x:qe.max.x,y:qe.max.y,z:qe.min.z},g.bottomRight={x:qe.min.x,y:qe.max.y,z:qe.min.z},g.top={x:et.x,y:qe.min.y,z:qe.min.z},g.topLeft={x:qe.max.x,y:qe.min.y,z:qe.min.z},g.topRight={x:qe.min.x,y:qe.min.y,z:qe.min.z},g.left={x:qe.max.x,y:et.y,z:qe.min.z},g.right={x:qe.min.x,y:et.y,z:qe.min.z},st){case"center":g.anchor=g.center;break;case"top":g.anchor=g.top;break;case"top-left":g.anchor=g.topLeft;break;case"top-right":g.anchor=g.topRight;break;case"left":g.anchor=g.left;break;case"right":g.anchor=g.right;break;case"bottom":g.anchor=g.bottom;break;case"bottom-left":default:g.anchor=g.bottomLeft;break;case"bottom-right":g.anchor=g.bottomRight;break;case"auto":case"none":g.anchor=g.none}g.model.position.set(-g.anchor.x,-g.anchor.y,-g.anchor.z)},g.setCenter=function(st){if(st&&(st.x!=0||st.y!=0||st.z!=0)){let qe=g.getSize();g.anchor={x:g.anchor.x-qe.x*st.x,y:g.anchor.y-qe.y*st.y,z:g.anchor.z-qe.z*st.z},g.model.position.set(-g.anchor.x,-g.anchor.y,-g.anchor.z)}},Object.defineProperty(g,"label",{get(){return g.getObjectByName(P)}}),Object.defineProperty(g,"tooltip",{get(){return g.getObjectByName(O)}}),Object.defineProperty(g,"help",{get(){return g.getObjectByName(j)}});let H=!1;Object.defineProperty(g,"hidden",{get(){return H},set(st){H!=st&&(H=st,g.visibility=!H)}}),Object.defineProperty(g,"visibility",{get(){return g.visible},set(st){let qe=st;if(st=="visible"||st==!0)qe=!0,g.label&&(g.label.visible=qe);else if(st=="none"||st==!1)qe=!1,g.label&&g.label.alwaysVisible&&(g.label.visible=qe),g.tooltip&&(g.tooltip.visible=qe);else return;if(g.visible!=qe){if(g.hidden&&qe)return;g.visible=qe,g.model&&g.model.traverse(function(et){(et.type=="Mesh"||et.type=="SkinnedMesh")&&(qe&&g.raycasted?et.layers.enable(0):et.layers.disable(0)),et.type=="LineSegments"&&et.layers.disableAll()})}}}),g.addLabel=function(st,qe,et,Q){st&&g.drawLabelHTML(st,qe,et,Q)},g.removeLabel=function(){g.removeCSS2D(P)},g.drawLabelHTML=function(st,qe=!1,et=g.anchor,Q=.5){let ye=E.drawLabelHTML(st,p.prototype._defaults.label.cssClass),ge=g.addCSS2D(ye,P,et,Q);return ge.alwaysVisible=qe,ge.visible=qe,ge},g.addTooltip=function(st,qe,et,Q=!0,ye=1){let ge=g.addHelp(st,O,qe,et,ye);ge.visible=!1,ge.custom=Q},g.removeTooltip=function(){g.removeCSS2D(O)},g.addHelp=function(st,qe=j,et=!1,Q=g.anchor,ye=0){let ge=E.drawTooltip(st,et),xe=g.addCSS2D(ge,qe,Q,ye);return xe.visible=!0,xe},g.removeHelp=function(){g.removeCSS2D(j)},g.addCSS2D=function(st,qe,et=g.anchor,Q=1){if(st){const ye=g.box3(),ge=ye.getSize(new r.Vector3);let xe={x:ye.max.x,y:ye.max.y,z:ye.min.z};g.removeCSS2D(qe);let Ce=new u.CSS2DObject(st);return Ce.name=qe,Ce.position.set(-ge.x*.5-g.model.position.x-et.x+xe.x,-ge.y*.5-g.model.position.y-et.y+xe.y,ge.z*Q),Ce.visible=!1,g.scaleGroup.add(Ce),Ce}},g.removeCSS2D=function(st){let qe=g.getObjectByName(st);if(qe){qe.dispose();let et=g.scaleGroup.children;et.splice(et.indexOf(qe),1)}},Object.defineProperty(g,"shadowPlane",{get(){return g.getObjectByName($)}});let te=!1;Object.defineProperty(g,"castShadow",{get(){return te},set(st){if(!(!g.model||te===st)){if(g.model.traverse(function(qe){qe.isMesh&&(qe.castShadow=!0)}),st){const qe=g.modelSize,et=[qe.x,qe.y,qe.z,g.modelHeight],Q=Math.max(...et)*10,ye=new r.PlaneBufferGeometry(Q,Q),ge=new r.ShadowMaterial;ge.opacity=.5;let xe=new r.Mesh(ye,ge);xe.name=$,xe.layers.enable(1),xe.layers.disable(0),xe.receiveShadow=st,g.add(xe)}else g.traverse(function(qe){qe.isMesh&&qe.material instanceof r.ShadowMaterial&&g.remove(qe)});te=st}}}),g.setReceiveShadowFloor=function(){if(g.castShadow){let st=g.shadowPlane,qe=st.position,et=st.rotation;if(qe.z=-g.modelHeight,et.y=g.rotation.y,et.x=-g.rotation.x,g.userData.units==="meters"){const Q=g.modelSize,ye=[Q.x,Q.y,Q.z,-qe.z],xe=Math.max(...ye)*10/st.geometry.parameters.width;st.scale.set(xe,xe,xe)}}};let ce=!1;Object.defineProperty(g,"receiveShadow",{get(){return ce},set(st){!g.model||ce===st||(g.model.traverse(function(qe){qe.isMesh&&(qe.receiveShadow=!0)}),ce=st)}});let Se=!1;Object.defineProperty(g,"wireframe",{get(){return Se},set(st){!g.model||Se===st||(g.model.traverse(function(qe){if(qe.type=="Mesh"||qe.type=="SkinnedMesh"){let et=[];Array.isArray(qe.material)?et=qe.material:et.push(qe.material);let Q=et[0];st?(qe.userData.materials=Q,qe.material=Q.clone(),qe.material.wireframe=qe.material.transparent=st,qe.material.opacity=.3):(qe.material.dispose(),qe.material=qe.userData.materials,qe.userData.materials.dispose(),qe.userData.materials=null),st?(qe.layers.disable(0),qe.layers.enable(1)):(qe.layers.disable(1),qe.layers.enable(0))}qe.type=="LineSegments"&&qe.layers.disableAll()}),Se=st,g.dispatchEvent({type:"Wireframed",detail:g}))}});let Ie=null;Object.defineProperty(g,"color",{get(){return Ie},set(st){!g.model||Ie===st||(g.model.traverse(function(qe){if(qe.type=="Mesh"||qe.type=="SkinnedMesh"){let et=[];Array.isArray(qe.material)?et=qe.material:et.push(qe.material);let Q=et[0];st?(qe.userData.materials=Q,qe.material=new r.MeshStandardMaterial,qe.material.color.setHex(st)):(qe.material.dispose(),qe.material=qe.userData.materials,qe.userData.materials.dispose(),qe.userData.materials=null)}}),Ie=st)}});let Ne=!1;Object.defineProperty(g,"selected",{get(){return Ne},set(st){st?(g.userData.bbox&&!g.boundingBox&&g.drawBoundingBox(),g.boxGroup&&(g.boundingBox.material=p.prototype._defaults.materials.boxSelectedMaterial,g.boundingBox.parent.visible=!0,g.boundingBox.layers.enable(1),g.boundingBoxShadow.layers.enable(1)),g.label&&!g.label.alwaysVisible&&(g.label.visible=!0)):(g.boxGroup&&g.remove(g.boxGroup),g.label&&!g.label.alwaysVisible&&(g.label.visible=!1),g.removeHelp()),g.tooltip&&(g.tooltip.visible=st),Ne!=st&&(Ne=st,g.dispatchEvent({type:"SelectedChange",detail:g}))}});let ut=!0;Object.defineProperty(g,"raycasted",{get(){return ut},set(st){!g.model||ut===st||(g.model.traverse(function(qe){(qe.type=="Mesh"||qe.type=="SkinnedMesh")&&(st?(qe.layers.disable(1),qe.layers.enable(0)):(qe.layers.disable(0),qe.layers.enable(1)))}),ut=st)}});let mt=!1;Object.defineProperty(g,"over",{get(){return mt},set(st){st?(g.selected||(g.userData.bbox&&!g.boundingBox&&g.drawBoundingBox(),g.userData.tooltip&&!g.tooltip&&g.addTooltip(g.uuid,!0,g.anchor,!1),g.boxGroup&&(g.boundingBox.material=p.prototype._defaults.materials.boxOverMaterial,g.boundingBox.parent.visible=!0,g.boundingBox.layers.enable(1),g.boundingBoxShadow.layers.enable(1))),g.label&&!g.label.alwaysVisible&&(g.label.visible=!0),g.dispatchEvent({type:"ObjectMouseOver",detail:g})):(g.selected||(g.boxGroup&&(g.remove(g.boxGroup),g.tooltip&&!g.tooltip.custom&&g.removeTooltip()),g.label&&!g.label.alwaysVisible&&(g.label.visible=!1)),g.dispatchEvent({type:"ObjectMouseOut",detail:g})),g.tooltip&&(g.tooltip.visible=st||g.selected),mt=st}}),g.box3=function(){g.updateMatrix(),g.updateMatrixWorld(!0,!0);let st;if(g.model){let qe=g.clone(!0),et=g.model.clone();if(st=new r.Box3().setFromObject(et),g.parent){let Q=new r.Matrix4,ye=new r.Matrix4;g.matrix.extractRotation(Q),ye.copy(Q).invert(),qe.setRotationFromMatrix(ye),st=new r.Box3().setFromObject(et)}}return st},g.modelBox=function(){return g.box3()},g.getSize=function(){return g.box3().getSize(new r.Vector3(0,0,0))};let We=!1;Object.defineProperty(g,"modelSize",{get(){return We=g.getSize(),We},set(st){We!=st&&(We=st)}}),Object.defineProperty(g,"modelHeight",{get(){let st=g.coordinates[2]||0;return g.userData.units==="scene"&&(st*=g.unitsPerMeter/g.scale.x),st}}),Object.defineProperty(g,"unitsPerMeter",{get(){return Number(n.projectedUnitsPerMeter(g.coordinates[1]).toFixed(7))}}),Object.defineProperty(g,"fixedZoom",{get(){return g.userData.fixedZoom},set(st){g.userData.fixedZoom!==st&&(g.userData.fixedZoom=st,g.userData.units=st?"scene":"meters")}}),g.setFixedZoom=function(st){if(g.fixedZoom!=null&&g.fixedZoom!=0){st||(st=g.userData.mapScale);let qe=Ot(g.fixedZoom);if(qe>st){let et=qe/st;g.scale.set(et,et,et)}else g.scale.set(1,1,1)}},g.setScale=function(st){if(g.userData.units!="scene"){let qe=g.unitsPerMeter;g.scale.set(qe,qe,qe)}else g.fixedZoom?(st&&(g.userData.mapScale=st),g.setFixedZoom(g.userData.mapScale)):g.scale.set(1,1,1)},g.setObjectScale=function(st){g.setScale(st),g.setBoundingBoxShadowFloor(),g.setReceiveShadowFloor()}}g.add=function(J){return g.scaleGroup.add(J),J.position.z=g.coordinates[2]?-g.coordinates[2]:0,J},g.remove=function(J){J&&(J.traverse(H=>{if(H.geometry&&H.geometry.dispose(),H.material)if(H.material.isMaterial)Y(H.material);else for(const te of H.material)Y(te);H.dispose&&H.dispose()}),g.scaleGroup.remove(J),tb.map.repaint=!0)},g.duplicate=function(J){let H=g.clone(!0);if(H.getObjectByName("model").animations=g.animations,H.userData.feature&&(J&&J.feature&&(H.userData.feature=J.feature),H.userData.feature.properties.uuid=H.uuid),E._addMethods(H),!J||n.equal(J.scale,g.userData.scale))return H.copyAnchor(g),H;{H.userData=J,H.userData.isGeoGroup=!0,H.remove(H.boxGroup);const te=n.types.rotation(J.rotation,[0,0,0]),ce=n.types.scale(J.scale,[1,1,1]);return H.model.position.set(0,0,0),H.model.rotation.set(te[0],te[1],te[2]),H.model.scale.set(ce[0],ce[1],ce[2]),H.setAnchor(J.anchor),H.setCenter(J.adjustment),H}},g.copyAnchor=function(J){g.anchor=J.anchor,g.none={x:0,y:0,z:0},g.center=J.center,g.bottom=J.bottom,g.bottomLeft=J.bottomLeft,g.bottomRight=J.bottomRight,g.top=J.top,g.topLeft=J.topLeft,g.topRight=J.topRight,g.left=J.left,g.right=J.right},g.dispose=function(){p.prototype.unenroll(g),g.traverse(J=>{if(!(J.parent&&J.parent.name=="world")&&J.name!=="threeboxObject"){if(J.geometry&&J.geometry.dispose(),J.material)if(J.material.isMaterial)Y(J.material);else for(const H of J.material)Y(H);J.dispose&&J.dispose()}}),g.children=[]};const Y=J=>{J.dispose();for(const ce of Object.keys(J)){const Se=J[ce];Se&&typeof Se=="object"&&"minFilter"in Se&&Se.dispose()}let H=J;(H.map||H.alphaMap||H.aoMap||H.bumpMap||H.displacementMap||H.emissiveMap||H.envMap||H.lightMap||H.metalnessMap||H.normalMap||H.roughnessMap)&&(H.map&&H.map.dispose(),H.alphaMap&&H.alphaMap.dispose(),H.aoMap&&H.aoMap.dispose(),H.bumpMap&&H.bumpMap.dispose(),H.displacementMap&&H.displacementMap.dispose(),H.emissiveMap&&H.emissiveMap.dispose(),H.envMap&&H.envMap.dispose(),H.lightMap&&H.lightMap.dispose(),H.metalnessMap&&H.metalnessMap.dispose(),H.normalMap&&H.normalMap.dispose(),H.roughnessMap&&H.roughnessMap.dispose())};return g},_makeGroup:function(g,l){let E=new r.Group;E.name="scaleGroup",E.add(g);var P=new r.Group;P.userData=l||{},P.userData.isGeoGroup=!0,P.userData.feature&&(P.userData.feature.properties.uuid=P.uuid);var O=E.length;if(O)for(o of E)P.add(o);else P.add(E);return P.name="threeboxObject",P},animationManager:new s,drawTooltip:function(g,l=!1){if(g){let E;if(l){let P=document.createElement("div");P.className="mapboxgl-popup-content";let O=document.createElement("strong");O.innerHTML=g,P.appendChild(O);let j=document.createElement("div");j.className="mapboxgl-popup-tip";let $=document.createElement("div");$.className="marker mapboxgl-popup-anchor-bottom",$.appendChild(j),$.appendChild(P),E=document.createElement("div"),E.className+="label3D",E.appendChild($)}else E=document.createElement("span"),E.className=this._defaults.tooltip.cssClass,E.innerHTML=g;return E}},drawLabelHTML:function(g,l){let E=document.createElement("div");return E.className+=l,typeof g=="string"?E.innerHTML=g:E.innerHTML=g.outerHTML,E},_defaults:{colors:{red:new r.Color(16711680),yellow:new r.Color(16776960),green:new r.Color(65280),black:new r.Color(0)},materials:{boxNormalMaterial:new r.LineBasicMaterial({color:new r.Color(16711680)}),boxOverMaterial:new r.LineBasicMaterial({color:new r.Color(16776960)}),boxSelectedMaterial:new r.LineBasicMaterial({color:new r.Color(65280)})},line:{geometry:null,color:"black",width:1,opacity:1},label:{htmlElement:null,cssClass:" label3D",alwaysVisible:!1,topMargin:-.5},tooltip:{text:"",cssClass:"toolTip text-xs",mapboxStyle:!1,topMargin:0},sphere:{position:[0,0,0],radius:1,sides:20,units:"scene",material:"MeshBasicMaterial",anchor:"bottom-left",bbox:!0,tooltip:!0,raycasted:!0},tube:{geometry:null,radius:1,sides:6,units:"scene",material:"MeshBasicMaterial",anchor:"center",bbox:!0,tooltip:!0,raycasted:!0},loadObj:{type:null,obj:null,units:"scene",scale:1,rotation:0,defaultAnimation:0,anchor:"bottom-left",bbox:!0,tooltip:!0,raycasted:!0,clone:!0},Object3D:{obj:null,units:"scene",anchor:"bottom-left",bbox:!0,tooltip:!0,raycasted:!0},extrusion:{coordinates:[[[]]],geometryOptions:{},height:100,materials:new r.MeshPhongMaterial({color:6684672,side:r.DoubleSide}),scale:1,rotation:0,units:"scene",anchor:"center",bbox:!0,tooltip:!0,raycasted:!0}},geometries:{line:["LineString"],tube:["LineString"],sphere:["Point"]}},t.exports=p})(IV);var o0=IV.exports,RV={exports:{}},NV={exports:{}};(function(t,e){const n=o0,r=gd;function s(u){u=r._validate(u,n.prototype._defaults.Object3D);let p=u.obj;const g=r.types.rotation(u.rotation,[0,0,0]),l=r.types.scale(u.scale,[1,1,1]);p.rotation.set(g[0],g[1],g[2]),p.scale.set(l[0],l[1],l[2]),p.name="model";let E=n.prototype._makeGroup(p,u);return u.obj.name="model",n.prototype._addMethods(E),E.setAnchor(u.anchor),E.setCenter(u.adjustment),E.raycasted=u.raycasted,E.visibility=!0,E}t.exports=s})(NV);var mM=NV.exports;(function(t,e){const n=gd,r=FI,s=ju,u=o0,p=mM;function g(l){l=n._validate(l,u.prototype._defaults.sphere);let E=new s.SphereBufferGeometry(l.radius,l.sides,l.sides),P=r(l),O=new s.Mesh(E,P);return new p({obj:O,units:l.units,anchor:l.anchor,adjustment:l.adjustment,bbox:l.bbox,tooltip:l.tooltip,raycasted:l.raycasted})}t.exports=g})(RV);var hre=RV.exports,DV={exports:{}};(function(t,e){const n=o0,r=gd,s=ju,u=mM;function p(g){g=r._validate(g,n.prototype._defaults.extrusion);let l=p.prototype.buildShape(g.coordinates),E=p.prototype.buildGeometry(l,g.geometryOptions),P=new s.Mesh(E,g.materials);return g.obj=P,new u(g)}p.prototype={buildShape:function(g){if(g[0]instanceof(s.Vector2||s.Vector3))return new s.Shape(g);let l=new s.Shape;for(let E=0;E<g.length;E++)E===0?l=new s.Shape(this.buildPoints(g[0],g[0])):l.holes.push(new s.Path(this.buildPoints(g[E],g[0])));return l},buildPoints:function(g,l){const E=[];let P=r.projectToWorld([l[0][0],l[0][1],0]);for(let O=0;O<g.length;O++){let j=r.projectToWorld([g[O][0],g[O][1],0]);E.push(new s.Vector2(r.toDecimal(j.x-P.x,9),r.toDecimal(j.y-P.y,9)))}return E},buildGeometry:function(g,l){let E=new s.ExtrudeBufferGeometry(g,l);return E.computeBoundingBox(),E}},t.exports=p})(DV);var dre=DV.exports,OV={exports:{}};(function(t,e){const n=gd,r=o0,s=pM;function u(p){p=n._validate(p,r.prototype._defaults.label);let g=r.prototype.drawLabelHTML(p.htmlElement,p.cssClass),l=new s.CSS2DObject(g);l.name="label",l.visible=p.alwaysVisible,l.alwaysVisible=p.alwaysVisible;var E=r.prototype._makeGroup(l,p);return r.prototype._addMethods(E),E.visibility=p.alwaysVisible,E}t.exports=u})(OV);var fre=OV.exports,FV={exports:{}};(function(t,e){const n=gd,r=o0,s=pM;function u(p){if(p=n._validate(p,r.prototype._defaults.tooltip),p.text){let l=r.prototype.drawTooltip(p.text,p.mapboxStyle),E=new s.CSS2DObject(l);E.visible=!1,E.name="tooltip";var g=r.prototype._makeGroup(E,p);return r.prototype._addMethods(g),g}}t.exports=u})(FV);var pre=FV.exports,zV={exports:{}},BV={exports:{}};(function(t,e){const n=ju;(function(){const r=/^[og]\s*(.+)?/,s=/^mtllib /,u=/^usemtl /,p=/^usemap /,g=new n.Vector3,l=new n.Vector3,E=new n.Vector3,P=new n.Vector3,O=new n.Vector3;function j(){const Y={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(re,_e){if(this.object&&this.object.fromDeclaration===!1){this.object.name=re,this.object.fromDeclaration=_e!==!1;return}const J=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:re||"",fromDeclaration:_e!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(H,te){const ce=this._finalize(!1);ce&&(ce.inherited||ce.groupCount<=0)&&this.materials.splice(ce.index,1);const Se={index:this.materials.length,name:H||"",mtllib:Array.isArray(te)&&te.length>0?te[te.length-1]:"",smooth:ce!==void 0?ce.smooth:this.smooth,groupStart:ce!==void 0?ce.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(Ie){const Ne={index:typeof Ie=="number"?Ie:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return Ne.clone=this.clone.bind(Ne),Ne}};return this.materials.push(Se),Se},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(H){const te=this.currentMaterial();if(te&&te.groupEnd===-1&&(te.groupEnd=this.geometry.vertices.length/3,te.groupCount=te.groupEnd-te.groupStart,te.inherited=!1),H&&this.materials.length>1)for(let ce=this.materials.length-1;ce>=0;ce--)this.materials[ce].groupCount<=0&&this.materials.splice(ce,1);return H&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),te}},J&&J.name&&typeof J.clone=="function"){const H=J.clone(0);H.inherited=!0,this.object.materials.push(H)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(re,_e){const J=parseInt(re,10);return(J>=0?J-1:J+_e/3)*3},parseNormalIndex:function(re,_e){const J=parseInt(re,10);return(J>=0?J-1:J+_e/3)*3},parseUVIndex:function(re,_e){const J=parseInt(re,10);return(J>=0?J-1:J+_e/2)*2},addVertex:function(re,_e,J){const H=this.vertices,te=this.object.geometry.vertices;te.push(H[re+0],H[re+1],H[re+2]),te.push(H[_e+0],H[_e+1],H[_e+2]),te.push(H[J+0],H[J+1],H[J+2])},addVertexPoint:function(re){const _e=this.vertices;this.object.geometry.vertices.push(_e[re+0],_e[re+1],_e[re+2])},addVertexLine:function(re){const _e=this.vertices;this.object.geometry.vertices.push(_e[re+0],_e[re+1],_e[re+2])},addNormal:function(re,_e,J){const H=this.normals,te=this.object.geometry.normals;te.push(H[re+0],H[re+1],H[re+2]),te.push(H[_e+0],H[_e+1],H[_e+2]),te.push(H[J+0],H[J+1],H[J+2])},addFaceNormal:function(re,_e,J){const H=this.vertices,te=this.object.geometry.normals;g.fromArray(H,re),l.fromArray(H,_e),E.fromArray(H,J),O.subVectors(E,l),P.subVectors(g,l),O.cross(P),O.normalize(),te.push(O.x,O.y,O.z),te.push(O.x,O.y,O.z),te.push(O.x,O.y,O.z)},addColor:function(re,_e,J){const H=this.colors,te=this.object.geometry.colors;H[re]!==void 0&&te.push(H[re+0],H[re+1],H[re+2]),H[_e]!==void 0&&te.push(H[_e+0],H[_e+1],H[_e+2]),H[J]!==void 0&&te.push(H[J+0],H[J+1],H[J+2])},addUV:function(re,_e,J){const H=this.uvs,te=this.object.geometry.uvs;te.push(H[re+0],H[re+1]),te.push(H[_e+0],H[_e+1]),te.push(H[J+0],H[J+1])},addDefaultUV:function(){const re=this.object.geometry.uvs;re.push(0,0),re.push(0,0),re.push(0,0)},addUVLine:function(re){const _e=this.uvs;this.object.geometry.uvs.push(_e[re+0],_e[re+1])},addFace:function(re,_e,J,H,te,ce,Se,Ie,Ne){const ut=this.vertices.length;let mt=this.parseVertexIndex(re,ut),We=this.parseVertexIndex(_e,ut),Ot=this.parseVertexIndex(J,ut);if(this.addVertex(mt,We,Ot),this.addColor(mt,We,Ot),Se!==void 0&&Se!==""){const st=this.normals.length;mt=this.parseNormalIndex(Se,st),We=this.parseNormalIndex(Ie,st),Ot=this.parseNormalIndex(Ne,st),this.addNormal(mt,We,Ot)}else this.addFaceNormal(mt,We,Ot);if(H!==void 0&&H!==""){const st=this.uvs.length;mt=this.parseUVIndex(H,st),We=this.parseUVIndex(te,st),Ot=this.parseUVIndex(ce,st),this.addUV(mt,We,Ot),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(re){this.object.geometry.type="Points";const _e=this.vertices.length;for(let J=0,H=re.length;J<H;J++){const te=this.parseVertexIndex(re[J],_e);this.addVertexPoint(te),this.addColor(te)}},addLineGeometry:function(re,_e){this.object.geometry.type="Line";const J=this.vertices.length,H=this.uvs.length;for(let te=0,ce=re.length;te<ce;te++)this.addVertexLine(this.parseVertexIndex(re[te],J));for(let te=0,ce=_e.length;te<ce;te++)this.addUVLine(this.parseUVIndex(_e[te],H))}};return Y.startObject("",!1),Y}class $ extends n.Loader{constructor(re){super(re),this.materials=null}load(re,_e,J,H){const te=this,ce=new n.FileLoader(this.manager);ce.setPath(this.path),ce.setRequestHeader(this.requestHeader),ce.setWithCredentials(this.withCredentials),ce.load(re,function(Se){try{_e(te.parse(Se))}catch(Ie){H?H(Ie):console.error(Ie),te.manager.itemError(re)}},J,H)}setMaterials(re){return this.materials=re,this}parse(re){const _e=new j;re.indexOf(`\r
`)!==-1&&(re=re.replace(/\r\n/g,`
`)),re.indexOf(`\\
`)!==-1&&(re=re.replace(/\\\n/g,""));const J=re.split(`
`);let H="",te="",ce=0,Se=[];const Ie=typeof"".trimLeft=="function";for(let mt=0,We=J.length;mt<We;mt++)if(H=J[mt],H=Ie?H.trimLeft():H.trim(),ce=H.length,ce!==0&&(te=H.charAt(0),te!=="#"))if(te==="v"){const Ot=H.split(/\s+/);switch(Ot[0]){case"v":_e.vertices.push(parseFloat(Ot[1]),parseFloat(Ot[2]),parseFloat(Ot[3])),Ot.length>=7?_e.colors.push(parseFloat(Ot[4]),parseFloat(Ot[5]),parseFloat(Ot[6])):_e.colors.push(void 0,void 0,void 0);break;case"vn":_e.normals.push(parseFloat(Ot[1]),parseFloat(Ot[2]),parseFloat(Ot[3]));break;case"vt":_e.uvs.push(parseFloat(Ot[1]),parseFloat(Ot[2]));break}}else if(te==="f"){const st=H.substr(1).trim().split(/\s+/),qe=[];for(let Q=0,ye=st.length;Q<ye;Q++){const ge=st[Q];if(ge.length>0){const xe=ge.split("/");qe.push(xe)}}const et=qe[0];for(let Q=1,ye=qe.length-1;Q<ye;Q++){const ge=qe[Q],xe=qe[Q+1];_e.addFace(et[0],ge[0],xe[0],et[1],ge[1],xe[1],et[2],ge[2],xe[2])}}else if(te==="l"){const Ot=H.substring(1).trim().split(" ");let st=[];const qe=[];if(H.indexOf("/")===-1)st=Ot;else for(let et=0,Q=Ot.length;et<Q;et++){const ye=Ot[et].split("/");ye[0]!==""&&st.push(ye[0]),ye[1]!==""&&qe.push(ye[1])}_e.addLineGeometry(st,qe)}else if(te==="p"){const st=H.substr(1).trim().split(" ");_e.addPointGeometry(st)}else if((Se=r.exec(H))!==null){const Ot=(" "+Se[0].substr(1).trim()).substr(1);_e.startObject(Ot)}else if(u.test(H))_e.object.startMaterial(H.substring(7).trim(),_e.materialLibraries);else if(s.test(H))_e.materialLibraries.push(H.substring(7).trim());else if(p.test(H))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(te==="s"){if(Se=H.split(" "),Se.length>1){const st=Se[1].trim().toLowerCase();_e.object.smooth=st!=="0"&&st!=="off"}else _e.object.smooth=!0;const Ot=_e.object.currentMaterial();Ot&&(Ot.smooth=_e.object.smooth)}else{if(H==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+H+'"')}_e.finalize();const Ne=new n.Group;if(Ne.materialLibraries=[].concat(_e.materialLibraries),!(_e.objects.length===1&&_e.objects[0].geometry.vertices.length===0)===!0)for(let mt=0,We=_e.objects.length;mt<We;mt++){const Ot=_e.objects[mt],st=Ot.geometry,qe=Ot.materials,et=st.type==="Line",Q=st.type==="Points";let ye=!1;if(st.vertices.length===0)continue;const ge=new n.BufferGeometry;ge.setAttribute("position",new n.Float32BufferAttribute(st.vertices,3)),st.normals.length>0&&ge.setAttribute("normal",new n.Float32BufferAttribute(st.normals,3)),st.colors.length>0&&(ye=!0,ge.setAttribute("color",new n.Float32BufferAttribute(st.colors,3))),st.hasUVIndices===!0&&ge.setAttribute("uv",new n.Float32BufferAttribute(st.uvs,2));const xe=[];for(let tt=0,Je=qe.length;tt<Je;tt++){const rt=qe[tt],Ut=rt.name+"_"+rt.smooth+"_"+ye;let ht=_e.materials[Ut];if(this.materials!==null){if(ht=this.materials.create(rt.name),et&&ht&&!(ht instanceof n.LineBasicMaterial)){const Ft=new n.LineBasicMaterial;n.Material.prototype.copy.call(Ft,ht),Ft.color.copy(ht.color),ht=Ft}else if(Q&&ht&&!(ht instanceof n.PointsMaterial)){const Ft=new n.PointsMaterial({size:10,sizeAttenuation:!1});n.Material.prototype.copy.call(Ft,ht),Ft.color.copy(ht.color),Ft.map=ht.map,ht=Ft}}ht===void 0&&(et?ht=new n.LineBasicMaterial:Q?ht=new n.PointsMaterial({size:1,sizeAttenuation:!1}):ht=new n.MeshPhongMaterial,ht.name=rt.name,ht.flatShading=!rt.smooth,ht.vertexColors=ye,_e.materials[Ut]=ht),xe.push(ht)}let Ce;if(xe.length>1){for(let tt=0,Je=qe.length;tt<Je;tt++){const rt=qe[tt];ge.addGroup(rt.groupStart,rt.groupCount,tt)}et?Ce=new n.LineSegments(ge,xe):Q?Ce=new n.Points(ge,xe):Ce=new n.Mesh(ge,xe)}else et?Ce=new n.LineSegments(ge,xe[0]):Q?Ce=new n.Points(ge,xe[0]):Ce=new n.Mesh(ge,xe[0]);Ce.name=Ot.name,Ne.add(Ce)}else if(_e.vertices.length>0){const mt=new n.PointsMaterial({size:1,sizeAttenuation:!1}),We=new n.BufferGeometry;We.setAttribute("position",new n.Float32BufferAttribute(_e.vertices,3)),_e.colors.length>0&&_e.colors[0]!==void 0&&(We.setAttribute("color",new n.Float32BufferAttribute(_e.colors,3)),mt.vertexColors=!0);const Ot=new n.Points(We,mt);Ne.add(Ot)}return Ne}}n.OBJLoader=$})(),t.exports=n.OBJLoader})(BV);var mre=BV.exports,UV={exports:{}};(function(t,e){const n=ju;(function(){class r extends n.Loader{constructor(p){super(p)}load(p,g,l,E){const P=this,O=this.path===""?n.LoaderUtils.extractUrlBase(p||""):this.path,j=new n.FileLoader(this.manager);j.setPath(this.path),j.setRequestHeader(this.requestHeader),j.setWithCredentials(this.withCredentials),j.load(p,function($){try{g(P.parse($,O))}catch(Y){E?E(Y):console.error(Y),P.manager.itemError(p)}},l,E)}setMaterialOptions(p){return this.materialOptions=p,this}parse(p,g){const l=p.split(`
`);let E={};const P=/\s+/,O={};for(let $=0;$<l.length;$++){let Y=l[$];if(Y=Y.trim(),Y.length===0||Y.charAt(0)==="#")continue;const re=Y.indexOf(" ");let _e=re>=0?Y.substring(0,re):Y;_e=_e.toLowerCase();let J=re>=0?Y.substring(re+1):"";if(J=J.trim(),_e==="newmtl")E={name:J},O[J]=E;else if(_e==="ka"||_e==="kd"||_e==="ks"||_e==="ke"){const H=J.split(P,3);E[_e]=[parseFloat(H[0]),parseFloat(H[1]),parseFloat(H[2])]}else E[_e]=J}const j=new s(this.resourcePath||g,this.materialOptions);return j.setCrossOrigin(this.crossOrigin),j.setManager(this.manager),j.setMaterials(O),j}}class s{constructor(p="",g={}){this.baseUrl=p,this.options=g,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:n.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:n.RepeatWrapping}setCrossOrigin(p){return this.crossOrigin=p,this}setManager(p){this.manager=p}setMaterials(p){this.materialsInfo=this.convert(p),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(p){if(!this.options)return p;const g={};for(const l in p){const E=p[l],P={};g[l]=P;for(const O in E){let j=!0,$=E[O];const Y=O.toLowerCase();switch(Y){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&($=[$[0]/255,$[1]/255,$[2]/255]),this.options&&this.options.ignoreZeroRGBs&&$[0]===0&&$[1]===0&&$[2]===0&&(j=!1);break}j&&(P[Y]=$)}}return g}preload(){for(const p in this.materialsInfo)this.create(p)}getIndex(p){return this.nameLookup[p]}getAsArray(){let p=0;for(const g in this.materialsInfo)this.materialsArray[p]=this.create(g),this.nameLookup[g]=p,p++;return this.materialsArray}create(p){return this.materials[p]===void 0&&this.createMaterial_(p),this.materials[p]}createMaterial_(p){const g=this,l=this.materialsInfo[p],E={name:p,side:this.side};function P(j,$){return typeof $!="string"||$===""?"":/^https?:\/\//i.test($)?$:j+$}function O(j,$){if(E[j])return;const Y=g.getTextureParams($,E),re=g.loadTexture(P(g.baseUrl,Y.url));re.repeat.copy(Y.scale),re.offset.copy(Y.offset),re.wrapS=g.wrap,re.wrapT=g.wrap,E[j]=re}for(const j in l){const $=l[j];let Y;if($!=="")switch(j.toLowerCase()){case"kd":E.color=new n.Color().fromArray($);break;case"ks":E.specular=new n.Color().fromArray($);break;case"ke":E.emissive=new n.Color().fromArray($);break;case"map_kd":O("map",$);break;case"map_ks":O("specularMap",$);break;case"map_ke":O("emissiveMap",$);break;case"norm":O("normalMap",$);break;case"map_bump":case"bump":O("bumpMap",$);break;case"map_d":O("alphaMap",$),E.transparent=!0;break;case"ns":E.shininess=parseFloat($);break;case"d":Y=parseFloat($),Y<1&&(E.opacity=Y,E.transparent=!0);break;case"tr":Y=parseFloat($),this.options&&this.options.invertTrProperty&&(Y=1-Y),Y>0&&(E.opacity=1-Y,E.transparent=!0);break}}return this.materials[p]=new n.MeshPhongMaterial(E),this.materials[p]}getTextureParams(p,g){const l={scale:new n.Vector2(1,1),offset:new n.Vector2(0,0)},E=p.split(/\s+/);let P;return P=E.indexOf("-bm"),P>=0&&(g.bumpScale=parseFloat(E[P+1]),E.splice(P,2)),P=E.indexOf("-s"),P>=0&&(l.scale.set(parseFloat(E[P+1]),parseFloat(E[P+2])),E.splice(P,4)),P=E.indexOf("-o"),P>=0&&(l.offset.set(parseFloat(E[P+1]),parseFloat(E[P+2])),E.splice(P,4)),l.url=E.join(" ").trim(),l}loadTexture(p,g,l,E,P){const O=this.manager!==void 0?this.manager:n.DefaultLoadingManager;let j=O.getHandler(p);j===null&&(j=new n.TextureLoader(O)),j.setCrossOrigin&&j.setCrossOrigin(this.crossOrigin);const $=j.load(p,l,E,P);return g!==void 0&&($.mapping=g),$}}n.MTLLoader=r})(),t.exports=n.MTLLoader})(UV);var gre=UV.exports,jV={exports:{}},Jk={exports:{}};/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){var n={};n.__esModule=!0;var r=function(we){var ve;try{ve("require('worker_threads')").Worker}catch{}return e.default=function(Le,ot,Gt,yn,Ht){setImmediate(function(){return Ht(Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var En=function(){};return{terminate:En,postMessage:En}},we}({}),s=Uint8Array,u=Uint16Array,p=Uint32Array,g=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),E=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),P=function(we,ve){for(var Le=new u(31),ot=0;ot<31;++ot)Le[ot]=ve+=1<<we[ot-1];var Gt=new p(Le[30]);for(ot=1;ot<30;++ot)for(var yn=Le[ot];yn<Le[ot+1];++yn)Gt[yn]=yn-Le[ot]<<5|ot;return[Le,Gt]},O=P(g,2),j=O[0],$=O[1];j[28]=258,$[258]=28;for(var Y=P(l,0),re=Y[0],_e=Y[1],J=new u(32768),H=0;H<32768;++H){var te=(43690&H)>>>1|(21845&H)<<1;J[H]=((65280&(te=(61680&(te=(52428&te)>>>2|(13107&te)<<2))>>>4|(3855&te)<<4))>>>8|(255&te)<<8)>>>1}var ce=function(we,ve,Le){for(var ot=we.length,Gt=0,yn=new u(ve);Gt<ot;++Gt)++yn[we[Gt]-1];var Ht,En=new u(ve);for(Gt=0;Gt<ve;++Gt)En[Gt]=En[Gt-1]+yn[Gt-1]<<1;if(Le){Ht=new u(1<<ve);var fe=15-ve;for(Gt=0;Gt<ot;++Gt)if(we[Gt])for(var ue=Gt<<4|we[Gt],Me=ve-we[Gt],De=En[we[Gt]-1]++<<Me,Pe=De|(1<<Me)-1;De<=Pe;++De)Ht[J[De]>>>fe]=ue}else for(Ht=new u(ot),Gt=0;Gt<ot;++Gt)we[Gt]&&(Ht[Gt]=J[En[we[Gt]-1]++]>>>15-we[Gt]);return Ht},Se=new s(288);for(H=0;H<144;++H)Se[H]=8;for(H=144;H<256;++H)Se[H]=9;for(H=256;H<280;++H)Se[H]=7;for(H=280;H<288;++H)Se[H]=8;var Ie=new s(32);for(H=0;H<32;++H)Ie[H]=5;var Ne=ce(Se,9,0),ut=ce(Se,9,1),mt=ce(Ie,5,0),We=ce(Ie,5,1),Ot=function(we){for(var ve=we[0],Le=1;Le<we.length;++Le)we[Le]>ve&&(ve=we[Le]);return ve},st=function(we,ve,Le){var ot=ve/8|0;return(we[ot]|we[ot+1]<<8)>>(7&ve)&Le},qe=function(we,ve){var Le=ve/8|0;return(we[Le]|we[Le+1]<<8|we[Le+2]<<16)>>(7&ve)},et=function(we){return(we/8|0)+(7&we&&1)},Q=function(we,ve,Le){(ve==null||ve<0)&&(ve=0),(Le==null||Le>we.length)&&(Le=we.length);var ot=new(we instanceof u?u:we instanceof p?p:s)(Le-ve);return ot.set(we.subarray(ve,Le)),ot},ye=function(we,ve,Le){var ot=we.length;if(!ot||Le&&!Le.l&&ot<5)return ve||new s(0);var Gt=!ve||Le,yn=!Le||Le.i;Le||(Le={}),ve||(ve=new s(3*ot));var Ht=function(jc){var Pr=ve.length;if(jc>Pr){var vu=new s(Math.max(2*Pr,jc));vu.set(ve),ve=vu}},En=Le.f||0,fe=Le.p||0,ue=Le.b||0,Me=Le.l,De=Le.d,Pe=Le.m,Dt=Le.n,Zt=8*ot;do{if(!Me){Le.f=En=st(we,fe,1);var pn=st(we,fe+1,3);if(fe+=3,!pn){var Sn=we[(Br=et(fe)+4)-4]|we[Br-3]<<8,lr=Br+Sn;if(lr>ot){if(yn)throw"unexpected EOF";break}Gt&&Ht(ue+Sn),ve.set(we.subarray(Br,lr),ue),Le.b=ue+=Sn,Le.p=fe=8*lr;continue}if(pn==1)Me=ut,De=We,Pe=9,Dt=5;else{if(pn!=2)throw"invalid block type";var In=st(we,fe,31)+257,un=st(we,fe+10,15)+4,cr=In+st(we,fe+5,31)+1;fe+=14;for(var Bn=new s(cr),fr=new s(19),cn=0;cn<un;++cn)fr[E[cn]]=st(we,fe+3*cn,7);fe+=3*un;var Ar=Ot(fr),$r=(1<<Ar)-1;if(!yn&&fe+cr*(Ar+7)>Zt)break;var ei=ce(fr,Ar,1);for(cn=0;cn<cr;){var Br,qi=ei[st(we,fe,$r)];if(fe+=15&qi,(Br=qi>>>4)<16)Bn[cn++]=Br;else{var Oi=0,Xn=0;for(Br==16?(Xn=3+st(we,fe,3),fe+=2,Oi=Bn[cn-1]):Br==17?(Xn=3+st(we,fe,7),fe+=3):Br==18&&(Xn=11+st(we,fe,127),fe+=7);Xn--;)Bn[cn++]=Oi}}var es=Bn.subarray(0,In),li=Bn.subarray(In);Pe=Ot(es),Dt=Ot(li),Me=ce(es,Pe,1),De=ce(li,Dt,1)}if(fe>Zt)throw"unexpected EOF"}Gt&&Ht(ue+131072);for(var Do=(1<<Pe)-1,xi=(1<<Dt)-1,pa=Pe+Dt+18;yn||fe+pa<Zt;){var jo=(Oi=Me[qe(we,fe)&Do])>>>4;if((fe+=15&Oi)>Zt)throw"unexpected EOF";if(!Oi)throw"invalid length/literal";if(jo<256)ve[ue++]=jo;else{if(jo==256){Me=null;break}var Xa=jo-254;jo>264&&(Xa=st(we,fe,(1<<(na=g[cn=jo-257]))-1)+j[cn],fe+=na);var Za=De[qe(we,fe)&xi],Oo=Za>>>4;if(!Za)throw"invalid distance";if(fe+=15&Za,li=re[Oo],Oo>3){var na=l[Oo];li+=qe(we,fe)&(1<<na)-1,fe+=na}if(fe>Zt)throw"unexpected EOF";Gt&&Ht(ue+131072);for(var Gs=ue+Xa;ue<Gs;ue+=4)ve[ue]=ve[ue-li],ve[ue+1]=ve[ue+1-li],ve[ue+2]=ve[ue+2-li],ve[ue+3]=ve[ue+3-li];ue=Gs}}Le.l=Me,Le.p=fe,Le.b=ue,Me&&(En=1,Le.m=Pe,Le.d=De,Le.n=Dt)}while(!En);return ue==ve.length?ve:Q(ve,0,ue)},ge=function(we,ve,Le){var ot=ve/8|0;we[ot]|=Le<<=7&ve,we[ot+1]|=Le>>>8},xe=function(we,ve,Le){var ot=ve/8|0;we[ot]|=Le<<=7&ve,we[ot+1]|=Le>>>8,we[ot+2]|=Le>>>16},Ce=function(we,ve){for(var Le=[],ot=0;ot<we.length;++ot)we[ot]&&Le.push({s:ot,f:we[ot]});var Gt=Le.length,yn=Le.slice();if(!Gt)return[Nn,0];if(Gt==1){var Ht=new s(Le[0].s+1);return Ht[Le[0].s]=1,[Ht,1]}Le.sort(function(Bn,fr){return Bn.f-fr.f}),Le.push({s:-1,f:25001});var En=Le[0],fe=Le[1],ue=0,Me=1,De=2;for(Le[0]={s:-1,f:En.f+fe.f,l:En,r:fe};Me!=Gt-1;)En=Le[Le[ue].f<Le[De].f?ue++:De++],fe=Le[ue!=Me&&Le[ue].f<Le[De].f?ue++:De++],Le[Me++]={s:-1,f:En.f+fe.f,l:En,r:fe};var Pe=yn[0].s;for(ot=1;ot<Gt;++ot)yn[ot].s>Pe&&(Pe=yn[ot].s);var Dt=new u(Pe+1),Zt=tt(Le[Me-1],Dt,0);if(Zt>ve){ot=0;var pn=0,Sn=Zt-ve,lr=1<<Sn;for(yn.sort(function(Bn,fr){return Dt[fr.s]-Dt[Bn.s]||Bn.f-fr.f});ot<Gt;++ot){var In=yn[ot].s;if(!(Dt[In]>ve))break;pn+=lr-(1<<Zt-Dt[In]),Dt[In]=ve}for(pn>>>=Sn;pn>0;){var un=yn[ot].s;Dt[un]<ve?pn-=1<<ve-Dt[un]++-1:++ot}for(;ot>=0&&pn;--ot){var cr=yn[ot].s;Dt[cr]==ve&&(--Dt[cr],++pn)}Zt=ve}return[new s(Dt),Zt]},tt=function(we,ve,Le){return we.s==-1?Math.max(tt(we.l,ve,Le+1),tt(we.r,ve,Le+1)):ve[we.s]=Le},Je=function(we){for(var ve=we.length;ve&&!we[--ve];);for(var Le=new u(++ve),ot=0,Gt=we[0],yn=1,Ht=function(fe){Le[ot++]=fe},En=1;En<=ve;++En)if(we[En]==Gt&&En!=ve)++yn;else{if(!Gt&&yn>2){for(;yn>138;yn-=138)Ht(32754);yn>2&&(Ht(yn>10?yn-11<<5|28690:yn-3<<5|12305),yn=0)}else if(yn>3){for(Ht(Gt),--yn;yn>6;yn-=6)Ht(8304);yn>2&&(Ht(yn-3<<5|8208),yn=0)}for(;yn--;)Ht(Gt);yn=1,Gt=we[En]}return[Le.subarray(0,ot),ve]},rt=function(we,ve){for(var Le=0,ot=0;ot<ve.length;++ot)Le+=we[ot]*ve[ot];return Le},Ut=function(we,ve,Le){var ot=Le.length,Gt=et(ve+2);we[Gt]=255&ot,we[Gt+1]=ot>>>8,we[Gt+2]=255^we[Gt],we[Gt+3]=255^we[Gt+1];for(var yn=0;yn<ot;++yn)we[Gt+yn+4]=Le[yn];return 8*(Gt+4+ot)},ht=function(we,ve,Le,ot,Gt,yn,Ht,En,fe,ue,Me){ge(ve,Me++,Le),++Gt[256];for(var De=Ce(Gt,15),Pe=De[0],Dt=De[1],Zt=Ce(yn,15),pn=Zt[0],Sn=Zt[1],lr=Je(Pe),In=lr[0],un=lr[1],cr=Je(pn),Bn=cr[0],fr=cr[1],cn=new u(19),Ar=0;Ar<In.length;++Ar)cn[31&In[Ar]]++;for(Ar=0;Ar<Bn.length;++Ar)cn[31&Bn[Ar]]++;for(var $r=Ce(cn,7),ei=$r[0],Br=$r[1],qi=19;qi>4&&!ei[E[qi-1]];--qi);var Oi,Xn,es,li,Do=ue+5<<3,xi=rt(Gt,Se)+rt(yn,Ie)+Ht,pa=rt(Gt,Pe)+rt(yn,pn)+Ht+14+3*qi+rt(cn,ei)+(2*cn[16]+3*cn[17]+7*cn[18]);if(Do<=xi&&Do<=pa)return Ut(ve,Me,we.subarray(fe,fe+ue));if(ge(ve,Me,1+(pa<xi)),Me+=2,pa<xi){Oi=ce(Pe,Dt,0),Xn=Pe,es=ce(pn,Sn,0),li=pn;var jo=ce(ei,Br,0);for(ge(ve,Me,un-257),ge(ve,Me+5,fr-1),ge(ve,Me+10,qi-4),Me+=14,Ar=0;Ar<qi;++Ar)ge(ve,Me+3*Ar,ei[E[Ar]]);Me+=3*qi;for(var Xa=[In,Bn],Za=0;Za<2;++Za){var Oo=Xa[Za];for(Ar=0;Ar<Oo.length;++Ar)ge(ve,Me,jo[na=31&Oo[Ar]]),Me+=ei[na],na>15&&(ge(ve,Me,Oo[Ar]>>>5&127),Me+=Oo[Ar]>>>12)}}else Oi=Ne,Xn=Se,es=mt,li=Ie;for(Ar=0;Ar<En;++Ar)if(ot[Ar]>255){var na;xe(ve,Me,Oi[257+(na=ot[Ar]>>>18&31)]),Me+=Xn[na+257],na>7&&(ge(ve,Me,ot[Ar]>>>23&31),Me+=g[na]);var Gs=31&ot[Ar];xe(ve,Me,es[Gs]),Me+=li[Gs],Gs>3&&(xe(ve,Me,ot[Ar]>>>5&8191),Me+=l[Gs])}else xe(ve,Me,Oi[ot[Ar]]),Me+=Xn[ot[Ar]];return xe(ve,Me,Oi[256]),Me+Xn[256]},Ft=new p([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Nn=new s(0),zn=function(we,ve,Le,ot,Gt,yn){var Ht=we.length,En=new s(ot+Ht+5*(1+Math.ceil(Ht/7e3))+Gt),fe=En.subarray(ot,En.length-Gt),ue=0;if(!ve||Ht<8)for(var Me=0;Me<=Ht;Me+=65535){var De=Me+65535;De<Ht?ue=Ut(fe,ue,we.subarray(Me,De)):(fe[Me]=yn,ue=Ut(fe,ue,we.subarray(Me,Ht)))}else{for(var Pe=Ft[ve-1],Dt=Pe>>>13,Zt=8191&Pe,pn=(1<<Le)-1,Sn=new u(32768),lr=new u(pn+1),In=Math.ceil(Le/3),un=2*In,cr=function(yf){return(we[yf]^we[yf+1]<<In^we[yf+2]<<un)&pn},Bn=new p(25e3),fr=new u(288),cn=new u(32),Ar=0,$r=0,ei=(Me=0,0),Br=0,qi=0;Me<Ht;++Me){var Oi=cr(Me),Xn=32767&Me,es=lr[Oi];if(Sn[Xn]=es,lr[Oi]=Xn,Br<=Me){var li=Ht-Me;if((Ar>7e3||ei>24576)&&li>423){ue=ht(we,fe,0,Bn,fr,cn,$r,ei,qi,Me-qi,ue),ei=Ar=$r=0,qi=Me;for(var Do=0;Do<286;++Do)fr[Do]=0;for(Do=0;Do<30;++Do)cn[Do]=0}var xi=2,pa=0,jo=Zt,Xa=Xn-es&32767;if(li>2&&Oi==cr(Me-Xa))for(var Za=Math.min(Dt,li)-1,Oo=Math.min(32767,Me),na=Math.min(258,li);Xa<=Oo&&--jo&&Xn!=es;){if(we[Me+xi]==we[Me+xi-Xa]){for(var Gs=0;Gs<na&&we[Me+Gs]==we[Me+Gs-Xa];++Gs);if(Gs>xi){if(xi=Gs,pa=Xa,Gs>Za)break;var jc=Math.min(Xa,Gs-2),Pr=0;for(Do=0;Do<jc;++Do){var vu=Me-Xa+Do+32768&32767,Mp=vu-Sn[vu]+32768&32767;Mp>Pr&&(Pr=Mp,es=vu)}}}Xa+=(Xn=es)-(es=Sn[Xn])+32768&32767}if(pa){Bn[ei++]=268435456|$[xi]<<18|_e[pa];var gf=31&$[xi],dc=31&_e[pa];$r+=g[gf]+l[dc],++fr[257+gf],++cn[dc],Br=Me+xi,++Ar}else Bn[ei++]=we[Me],++fr[we[Me]]}}ue=ht(we,fe,yn,Bn,fr,cn,$r,ei,qi,Me-qi,ue),!yn&&7&ue&&(ue=Ut(fe,ue+1,Nn))}return Q(En,0,ot+et(ue)+Gt)},rr=function(){for(var we=new p(256),ve=0;ve<256;++ve){for(var Le=ve,ot=9;--ot;)Le=(1&Le&&3988292384)^Le>>>1;we[ve]=Le}return we}(),Gr=function(){var we=-1;return{p:function(ve){for(var Le=we,ot=0;ot<ve.length;++ot)Le=rr[255&Le^ve[ot]]^Le>>>8;we=Le},d:function(){return~we}}},Li=function(){var we=1,ve=0;return{p:function(Le){for(var ot=we,Gt=ve,yn=Le.length,Ht=0;Ht!=yn;){for(var En=Math.min(Ht+2655,yn);Ht<En;++Ht)Gt+=ot+=Le[Ht];ot=(65535&ot)+15*(ot>>16),Gt=(65535&Gt)+15*(Gt>>16)}we=ot,ve=Gt},d:function(){return((we%=65521)>>>8<<16|(255&(ve%=65521))<<8|ve>>>8)+2*((255&we)<<23)}}},wi=function(we,ve,Le,ot,Gt){return zn(we,ve.level==null?6:ve.level,ve.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(we.length)))):12+ve.mem,Le,ot,!Gt)},Nr=function(we,ve){var Le={};for(var ot in we)Le[ot]=we[ot];for(var ot in ve)Le[ot]=ve[ot];return Le},fi=function(we,ve,Le){for(var ot=we(),Gt=""+we,yn=Gt.slice(Gt.indexOf("[")+1,Gt.lastIndexOf("]")).replace(/ /g,"").split(","),Ht=0;Ht<ot.length;++Ht){var En=ot[Ht],fe=yn[Ht];if(typeof En=="function"){ve+=";"+fe+"=";var ue=""+En;if(En.prototype)if(ue.indexOf("[native code]")!=-1){var Me=ue.indexOf(" ",8)+1;ve+=ue.slice(Me,ue.indexOf("(",Me))}else for(var De in ve+=ue,En.prototype)ve+=";"+fe+".prototype."+De+"="+En.prototype[De];else ve+=ue}else Le[fe]=En}return[ve,Le]},Mi=[],jn=function(we){var ve=[];for(var Le in we)(we[Le]instanceof s||we[Le]instanceof u||we[Le]instanceof p)&&ve.push((we[Le]=new we[Le].constructor(we[Le])).buffer);return ve},Be=function(we,ve,Le,ot){var Gt;if(!Mi[Le]){for(var yn="",Ht={},En=we.length-1,fe=0;fe<En;++fe)yn=(Gt=fi(we[fe],yn,Ht))[0],Ht=Gt[1];Mi[Le]=fi(we[En],yn,Ht)}var ue=Nr({},Mi[Le][1]);return r.default(Mi[Le][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+ve+"}",Le,ue,jn(ue),ot)},ze=function(){return[s,u,p,g,l,E,j,re,ut,We,J,ce,Ot,st,qe,et,Q,ye,kt,At,en]},vt=function(){return[s,u,p,g,l,E,$,_e,Ne,Se,mt,Ie,J,Ft,Nn,ce,ge,xe,Ce,tt,Je,rt,Ut,ht,et,Q,zn,wi,le,At]},Qe=function(){return[Zr,Xs,Tr,Gr,rr]},gt=function(){return[is,$i]},St=function(){return[vo,Tr,Li]},Rt=function(){return[Vn]},At=function(we){return postMessage(we,[we.buffer])},en=function(we){return we&&we.size&&new s(we.size)},On=function(we,ve,Le,ot,Gt,yn){var Ht=Be(Le,ot,Gt,function(En,fe){Ht.terminate(),yn(En,fe)});return Ht.postMessage([we,ve],ve.consume?[we.buffer]:[]),function(){Ht.terminate()}},qn=function(we){return we.ondata=function(ve,Le){return postMessage([ve,Le],[ve.buffer])},function(ve){return we.push(ve.data[0],ve.data[1])}},Er=function(we,ve,Le,ot,Gt){var yn,Ht=Be(we,ot,Gt,function(En,fe){En?(Ht.terminate(),ve.ondata.call(ve,En)):(fe[1]&&Ht.terminate(),ve.ondata.call(ve,En,fe[0],fe[1]))});Ht.postMessage(Le),ve.push=function(En,fe){if(yn)throw"stream finished";if(!ve.ondata)throw"no stream handler";Ht.postMessage([En,yn=fe],[En.buffer])},ve.terminate=function(){Ht.terminate()}},Sr=function(we,ve){return we[ve]|we[ve+1]<<8},Dr=function(we,ve){return(we[ve]|we[ve+1]<<8|we[ve+2]<<16)+2*(we[ve+3]<<23)},Fr=function(we,ve){return Dr(we,ve)|4294967296*Dr(we,ve)},Tr=function(we,ve,Le){for(;Le;++ve)we[ve]=Le,Le>>>=8},Zr=function(we,ve){var Le=ve.filename;if(we[0]=31,we[1]=139,we[2]=8,we[8]=ve.level<2?4:ve.level==9?2:0,we[9]=3,ve.mtime!=0&&Tr(we,4,Math.floor(new Date(ve.mtime||Date.now())/1e3)),Le){we[3]=8;for(var ot=0;ot<=Le.length;++ot)we[ot+10]=Le.charCodeAt(ot)}},is=function(we){if(we[0]!=31||we[1]!=139||we[2]!=8)throw"invalid gzip data";var ve=we[3],Le=10;4&ve&&(Le+=we[10]|2+(we[11]<<8));for(var ot=(ve>>3&1)+(ve>>4&1);ot>0;ot-=!we[Le++]);return Le+(2&ve)},$i=function(we){var ve=we.length;return(we[ve-4]|we[ve-3]<<8|we[ve-2]<<16)+2*(we[ve-1]<<23)},Xs=function(we){return 10+(we.filename&&we.filename.length+1||0)},vo=function(we,ve){var Le=ve.level,ot=Le==0?0:Le<6?1:Le==9?3:2;we[0]=120,we[1]=ot<<6|(ot?32-2*ot:1)},Vn=function(we){if((15&we[0])!=8||we[0]>>>4>7||(we[0]<<8|we[1])%31)throw"invalid zlib data";if(32&we[1])throw"invalid zlib data: preset dictionaries not supported"};function Di(we,ve){return ve||typeof we!="function"||(ve=we,we={}),this.ondata=ve,we}var Ps=function(){function we(ve,Le){Le||typeof ve!="function"||(Le=ve,ve={}),this.ondata=Le,this.o=ve||{}}return we.prototype.p=function(ve,Le){this.ondata(wi(ve,this.o,0,0,!Le),Le)},we.prototype.push=function(ve,Le){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=Le,this.p(ve,Le||!1)},we}();n.Deflate=Ps;var ct=function(){return function(we,ve){Er([vt,function(){return[qn,Ps]}],this,Di.call(this,we,ve),function(Le){var ot=new Ps(Le.data);onmessage=qn(ot)},6)}}();function se(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return On(we,ve,[vt],function(ot){return At(le(ot.data[0],ot.data[1]))},0,Le)}function le(we,ve){return wi(we,ve||{},0,0)}n.AsyncDeflate=ct,n.deflate=se,n.deflateSync=le;var Ae=function(){function we(ve){this.s={},this.p=new s(0),this.ondata=ve}return we.prototype.e=function(ve){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var Le=this.p.length,ot=new s(Le+ve.length);ot.set(this.p),ot.set(ve,Le),this.p=ot},we.prototype.c=function(ve){this.d=this.s.i=ve||!1;var Le=this.s.b,ot=ye(this.p,this.o,this.s);this.ondata(Q(ot,Le,this.s.b),this.d),this.o=Q(ot,this.s.b-32768),this.s.b=this.o.length,this.p=Q(this.p,this.s.p/8|0),this.s.p&=7},we.prototype.push=function(ve,Le){this.e(ve),this.c(Le)},we}();n.Inflate=Ae;var Fe=function(){return function(we){this.ondata=we,Er([ze,function(){return[qn,Ae]}],this,0,function(){var ve=new Ae;onmessage=qn(ve)},7)}}();function nt(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return On(we,ve,[ze],function(ot){return At(kt(ot.data[0],en(ot.data[1])))},1,Le)}function kt(we,ve){return ye(we,ve)}n.AsyncInflate=Fe,n.inflate=nt,n.inflateSync=kt;var Tt=function(){function we(ve,Le){this.c=Gr(),this.l=0,this.v=1,Ps.call(this,ve,Le)}return we.prototype.push=function(ve,Le){Ps.prototype.push.call(this,ve,Le)},we.prototype.p=function(ve,Le){this.c.p(ve),this.l+=ve.length;var ot=wi(ve,this.o,this.v&&Xs(this.o),Le&&8,!Le);this.v&&(Zr(ot,this.o),this.v=0),Le&&(Tr(ot,ot.length-8,this.c.d()),Tr(ot,ot.length-4,this.l)),this.ondata(ot,Le)},we}();n.Gzip=Tt,n.Compress=Tt;var at=function(){return function(we,ve){Er([vt,Qe,function(){return[qn,Ps,Tt]}],this,Di.call(this,we,ve),function(Le){var ot=new Tt(Le.data);onmessage=qn(ot)},8)}}();function me(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return On(we,ve,[vt,Qe,function(){return[fn]}],function(ot){return At(fn(ot.data[0],ot.data[1]))},2,Le)}function fn(we,ve){ve||(ve={});var Le=Gr(),ot=we.length;Le.p(we);var Gt=wi(we,ve,Xs(ve),8),yn=Gt.length;return Zr(Gt,ve),Tr(Gt,yn-8,Le.d()),Tr(Gt,yn-4,ot),Gt}n.AsyncGzip=at,n.AsyncCompress=at,n.gzip=me,n.compress=me,n.gzipSync=fn,n.compressSync=fn;var Mn=function(){function we(ve){this.v=1,Ae.call(this,ve)}return we.prototype.push=function(ve,Le){if(Ae.prototype.e.call(this,ve),this.v){var ot=this.p.length>3?is(this.p):4;if(ot>=this.p.length&&!Le)return;this.p=this.p.subarray(ot),this.v=0}if(Le){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Ae.prototype.c.call(this,Le)},we}();n.Gunzip=Mn;var Jt=function(){return function(we){this.ondata=we,Er([ze,gt,function(){return[qn,Ae,Mn]}],this,0,function(){var ve=new Mn;onmessage=qn(ve)},9)}}();function mr(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return On(we,ve,[ze,gt,function(){return[Cr]}],function(ot){return At(Cr(ot.data[0]))},3,Le)}function Cr(we,ve){return ye(we.subarray(is(we),-8),ve||new s($i(we)))}n.AsyncGunzip=Jt,n.gunzip=mr,n.gunzipSync=Cr;var zr=function(){function we(ve,Le){this.c=Li(),this.v=1,Ps.call(this,ve,Le)}return we.prototype.push=function(ve,Le){Ps.prototype.push.call(this,ve,Le)},we.prototype.p=function(ve,Le){this.c.p(ve);var ot=wi(ve,this.o,this.v&&2,Le&&4,!Le);this.v&&(vo(ot,this.o),this.v=0),Le&&Tr(ot,ot.length-4,this.c.d()),this.ondata(ot,Le)},we}();n.Zlib=zr;var Kr=function(){return function(we,ve){Er([vt,St,function(){return[qn,Ps,zr]}],this,Di.call(this,we,ve),function(Le){var ot=new zr(Le.data);onmessage=qn(ot)},10)}}();function pi(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return On(we,ve,[vt,St,function(){return[Xi]}],function(ot){return At(Xi(ot.data[0],ot.data[1]))},4,Le)}function Xi(we,ve){ve||(ve={});var Le=Li();Le.p(we);var ot=wi(we,ve,2,4);return vo(ot,ve),Tr(ot,ot.length-4,Le.d()),ot}n.AsyncZlib=Kr,n.zlib=pi,n.zlibSync=Xi;var Hi=function(){function we(ve){this.v=1,Ae.call(this,ve)}return we.prototype.push=function(ve,Le){if(Ae.prototype.e.call(this,ve),this.v){if(this.p.length<2&&!Le)return;this.p=this.p.subarray(2),this.v=0}if(Le){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Ae.prototype.c.call(this,Le)},we}();n.Unzlib=Hi;var Zi=function(){return function(we){this.ondata=we,Er([ze,Rt,function(){return[qn,Ae,Hi]}],this,0,function(){var ve=new Hi;onmessage=qn(ve)},11)}}();function ss(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return On(we,ve,[ze,Rt,function(){return[xo]}],function(ot){return At(xo(ot.data[0],en(ot.data[1])))},5,Le)}function xo(we,ve){return ye((Vn(we),we.subarray(2,-4)),ve)}n.AsyncUnzlib=Zi,n.unzlib=ss,n.unzlibSync=xo;var Us=function(){function we(ve){this.G=Mn,this.I=Ae,this.Z=Hi,this.ondata=ve}return we.prototype.push=function(ve,Le){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(ve,Le);else{if(this.p&&this.p.length){var ot=new s(this.p.length+ve.length);ot.set(this.p),ot.set(ve,this.p.length)}else this.p=ve;if(this.p.length>2){var Gt=this,yn=function(){Gt.ondata.apply(Gt,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(yn):(15&this.p[0])!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(yn):new this.Z(yn),this.s.push(this.p,Le),this.p=null}}},we}();n.Decompress=Us;var uo=function(){function we(ve){this.G=Jt,this.I=Fe,this.Z=Zi,this.ondata=ve}return we.prototype.push=function(ve,Le){Us.prototype.push.call(this,ve,Le)},we}();function No(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";return we[0]==31&&we[1]==139&&we[2]==8?mr(we,ve,Le):(15&we[0])!=8||we[0]>>4>7||(we[0]<<8|we[1])%31?nt(we,ve,Le):ss(we,ve,Le)}function xs(we,ve){return we[0]==31&&we[1]==139&&we[2]==8?Cr(we,ve):(15&we[0])!=8||we[0]>>4>7||(we[0]<<8|we[1])%31?kt(we,ve):xo(we,ve)}n.AsyncDecompress=uo,n.decompress=No,n.decompressSync=xs;var ea=function(we,ve,Le,ot){for(var Gt in we){var yn=we[Gt],Ht=ve+Gt;yn instanceof s?Le[Ht]=[yn,ot]:Array.isArray(yn)?Le[Ht]=[yn[0],Nr(ot,yn[1])]:ea(yn,Ht+"/",Le,ot)}},ri=typeof TextEncoder<"u"&&new TextEncoder,Ia=typeof TextDecoder<"u"&&new TextDecoder,zl=0;try{Ia.decode(Nn,{stream:!0}),zl=1}catch{}var tl=function(we){for(var ve="",Le=0;;){var ot=we[Le++],Gt=(ot>127)+(ot>223)+(ot>239);if(Le+Gt>we.length)return[ve,Q(we,Le-1)];Gt?Gt==3?(ot=((15&ot)<<18|(63&we[Le++])<<12|(63&we[Le++])<<6|63&we[Le++])-65536,ve+=String.fromCharCode(55296|ot>>10,56320|1023&ot)):ve+=String.fromCharCode(1&Gt?(31&ot)<<6|63&we[Le++]:(15&ot)<<12|(63&we[Le++])<<6|63&we[Le++]):ve+=String.fromCharCode(ot)}},Zs=function(){function we(ve){this.ondata=ve,zl?this.t=new TextDecoder:this.p=Nn}return we.prototype.push=function(ve,Le){if(!this.ondata)throw"no callback";if(Le||(Le=!1),this.t)return this.ondata(this.t.decode(ve,{stream:!Le}),Le);var ot=new s(this.p.length+ve.length);ot.set(this.p),ot.set(ve,this.p.length);var Gt=tl(ot),yn=Gt[0],Ht=Gt[1];if(Le&&Ht.length)throw"invalid utf-8 data";this.p=Ht,this.ondata(yn,Le)},we}();n.DecodeUTF8=Zs;var ta=function(){function we(ve){this.ondata=ve}return we.prototype.push=function(ve,Le){if(!this.ondata)throw"no callback";this.ondata(bo(ve),Le||!1)},we}();function bo(we,ve){if(ve){for(var Le=new s(we.length),ot=0;ot<we.length;++ot)Le[ot]=we.charCodeAt(ot);return Le}if(ri)return ri.encode(we);var Gt=we.length,yn=new s(we.length+(we.length>>1)),Ht=0,En=function(Me){yn[Ht++]=Me};for(ot=0;ot<Gt;++ot){if(Ht+5>yn.length){var fe=new s(Ht+8+(Gt-ot<<1));fe.set(yn),yn=fe}var ue=we.charCodeAt(ot);ue<128||ve?En(ue):ue<2048?(En(192|ue>>>6),En(128|63&ue)):ue>55295&&ue<57344?(En(240|(ue=65536+(1047552&ue)|1023&we.charCodeAt(++ot))>>>18),En(128|ue>>>12&63),En(128|ue>>>6&63),En(128|63&ue)):(En(224|ue>>>12),En(128|ue>>>6&63),En(128|63&ue))}return Q(yn,0,Ht)}function nl(we,ve){if(ve){for(var Le="",ot=0;ot<we.length;ot+=16384)Le+=String.fromCharCode.apply(null,we.subarray(ot,ot+16384));return Le}if(Ia)return Ia.decode(we);var Gt=tl(we);if(Gt[1].length)throw"invalid utf-8 data";return Gt[0]}n.EncodeUTF8=ta,n.strToU8=bo,n.strFromU8=nl;var Bc=function(we){return we==1?3:we<6?2:we==9?1:0},yl=function(we,ve){return ve+30+Sr(we,ve+26)+Sr(we,ve+28)},_l=function(we,ve,Le){var ot=Sr(we,ve+28),Gt=nl(we.subarray(ve+46,ve+46+ot),!(2048&Sr(we,ve+8))),yn=ve+46+ot,Ht=Dr(we,ve+20),En=Le&&Ht==4294967295?rl(we,yn):[Ht,Dr(we,ve+24),Dr(we,ve+42)],fe=En[0],ue=En[1],Me=En[2];return[Sr(we,ve+10),fe,ue,Gt,yn+Sr(we,ve+30)+Sr(we,ve+32),Me]},rl=function(we,ve){for(;Sr(we,ve)!=1;ve+=4+Sr(we,ve+2));return[Fr(we,ve+12),Fr(we,ve+4),Fr(we,ve+20)]},Nt=function(we){var ve=0;if(we)for(var Le in we){var ot=we[Le].length;if(ot>65535)throw"extra field too long";ve+=ot+4}return ve},ko=function(we,ve,Le,ot,Gt,yn,Ht,En){var fe=ot.length,ue=Le.extra,Me=En&&En.length,De=Nt(ue);Tr(we,ve,Ht!=null?33639248:67324752),ve+=4,Ht!=null&&(we[ve++]=20,we[ve++]=Le.os),we[ve]=20,ve+=2,we[ve++]=Le.flag<<1|(yn==null&&8),we[ve++]=Gt&&8,we[ve++]=255&Le.compression,we[ve++]=Le.compression>>8;var Pe=new Date(Le.mtime==null?Date.now():Le.mtime),Dt=Pe.getFullYear()-1980;if(Dt<0||Dt>119)throw"date not in range 1980-2099";if(Tr(we,ve,2*(Dt<<24)|Pe.getMonth()+1<<21|Pe.getDate()<<16|Pe.getHours()<<11|Pe.getMinutes()<<5|Pe.getSeconds()>>>1),ve+=4,yn!=null&&(Tr(we,ve,Le.crc),Tr(we,ve+4,yn),Tr(we,ve+8,Le.size)),Tr(we,ve+12,fe),Tr(we,ve+14,De),ve+=16,Ht!=null&&(Tr(we,ve,Me),Tr(we,ve+6,Le.attrs),Tr(we,ve+10,Ht),ve+=14),we.set(ot,ve),ve+=fe,De)for(var Zt in ue){var pn=ue[Zt],Sn=pn.length;Tr(we,ve,+Zt),Tr(we,ve+2,Sn),we.set(pn,ve+4),ve+=4+Sn}return Me&&(we.set(En,ve),ve+=Me),ve},ns=function(we,ve,Le,ot,Gt){Tr(we,ve,101010256),Tr(we,ve+8,Le),Tr(we,ve+10,Le),Tr(we,ve+12,ot),Tr(we,ve+16,Gt)},Ds=function(){function we(ve){this.filename=ve,this.c=Gr(),this.size=0,this.compression=0}return we.prototype.process=function(ve,Le){this.ondata(null,ve,Le)},we.prototype.push=function(ve,Le){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(ve),this.size+=ve.length,Le&&(this.crc=this.c.d()),this.process(ve,Le||!1)},we}();n.ZipPassThrough=Ds;var Tp=function(){function we(ve,Le){var ot=this;Le||(Le={}),Ds.call(this,ve),this.d=new Ps(Le,function(Gt,yn){ot.ondata(null,Gt,yn)}),this.compression=8,this.flag=Bc(Le.level)}return we.prototype.process=function(ve,Le){try{this.d.push(ve,Le)}catch(ot){this.ondata(ot,null,Le)}},we.prototype.push=function(ve,Le){Ds.prototype.push.call(this,ve,Le)},we}();n.ZipDeflate=Tp;var Uo=function(){function we(ve,Le){var ot=this;Le||(Le={}),Ds.call(this,ve),this.d=new ct(Le,function(Gt,yn,Ht){ot.ondata(Gt,yn,Ht)}),this.compression=8,this.flag=Bc(Le.level),this.terminate=this.d.terminate}return we.prototype.process=function(ve,Le){this.d.push(ve,Le)},we.prototype.push=function(ve,Le){Ds.prototype.push.call(this,ve,Le)},we}();n.AsyncZipDeflate=Uo;var Uc=function(){function we(ve){this.ondata=ve,this.u=[],this.d=1}return we.prototype.add=function(ve){var Le=this;if(2&this.d)throw"stream finished";var ot=bo(ve.filename),Gt=ot.length,yn=ve.comment,Ht=yn&&bo(yn),En=Gt!=ve.filename.length||Ht&&yn.length!=Ht.length,fe=Gt+Nt(ve.extra)+30;if(Gt>65535)throw"filename too long";var ue=new s(fe);ko(ue,0,ve,ot,En);var Me=[ue],De=function(){for(var Sn=0,lr=Me;Sn<lr.length;Sn++)Le.ondata(null,lr[Sn],!1);Me=[]},Pe=this.d;this.d=0;var Dt=this.u.length,Zt=Nr(ve,{f:ot,u:En,o:Ht,t:function(){ve.terminate&&ve.terminate()},r:function(){if(De(),Pe){var Sn=Le.u[Dt+1];Sn?Sn.r():Le.d=1}Pe=1}}),pn=0;ve.ondata=function(Sn,lr,In){if(Sn)Le.ondata(Sn,lr,In),Le.terminate();else if(pn+=lr.length,Me.push(lr),In){var un=new s(16);Tr(un,0,134695760),Tr(un,4,ve.crc),Tr(un,8,pn),Tr(un,12,ve.size),Me.push(un),Zt.c=pn,Zt.b=fe+pn+16,Zt.crc=ve.crc,Zt.size=ve.size,Pe&&Zt.r(),Pe=1}else Pe&&De()},this.u.push(Zt)},we.prototype.end=function(){var ve=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){1&ve.d&&(ve.u.splice(-1,1),ve.e())},t:function(){}}),this.d=3},we.prototype.e=function(){for(var ve=0,Le=0,ot=0,Gt=0,yn=this.u;Gt<yn.length;Gt++)ot+=46+(ue=yn[Gt]).f.length+Nt(ue.extra)+(ue.o?ue.o.length:0);for(var Ht=new s(ot+22),En=0,fe=this.u;En<fe.length;En++){var ue;ko(Ht,ve,ue=fe[En],ue.f,ue.u,ue.c,Le,ue.o),ve+=46+ue.f.length+Nt(ue.extra)+(ue.o?ue.o.length:0),Le+=ue.b}ns(Ht,ve,this.u.length,ot,Le),this.ondata(null,Ht,!0),this.d=2},we.prototype.terminate=function(){for(var ve=0,Le=this.u;ve<Le.length;ve++)Le[ve].t();this.d=2},we}();function Aa(we,ve,Le){if(Le||(Le=ve,ve={}),typeof Le!="function")throw"no callback";var ot={};ea(we,"",ot,ve);var Gt=Object.keys(ot),yn=Gt.length,Ht=0,En=0,fe=yn,ue=Array(yn),Me=[],De=function(){for(var pn=0;pn<Me.length;++pn)Me[pn]()},Pe=function(){var pn=new s(En+22),Sn=Ht,lr=En-Ht;En=0;for(var In=0;In<fe;++In){var un=ue[In];try{var cr=un.c.length;ko(pn,En,un,un.f,un.u,cr);var Bn=30+un.f.length+Nt(un.extra),fr=En+Bn;pn.set(un.c,fr),ko(pn,Ht,un,un.f,un.u,cr,En,un.m),Ht+=16+Bn+(un.m?un.m.length:0),En=fr+cr}catch(cn){return Le(cn,null)}}ns(pn,Ht,ue.length,lr,Sn),Le(null,pn)};yn||Pe();for(var Dt=function(pn){var Sn=Gt[pn],lr=ot[Sn],In=lr[0],un=lr[1],cr=Gr(),Bn=In.length;cr.p(In);var fr=bo(Sn),cn=fr.length,Ar=un.comment,$r=Ar&&bo(Ar),ei=$r&&$r.length,Br=Nt(un.extra),qi=un.level==0?0:8,Oi=function(Xn,es){if(Xn)De(),Le(Xn,null);else{var li=es.length;ue[pn]=Nr(un,{size:Bn,crc:cr.d(),c:es,f:fr,m:$r,u:cn!=Sn.length||$r&&Ar.length!=ei,compression:qi}),Ht+=30+cn+Br+li,En+=76+2*(cn+Br)+(ei||0)+li,--yn||Pe()}};if(cn>65535&&Oi("filename too long",null),qi)if(Bn<16e4)try{Oi(null,le(In,un))}catch(Xn){Oi(Xn,null)}else Me.push(se(In,un,Oi));else Oi(null,In)},Zt=0;Zt<fe;++Zt)Dt(Zt);return De}function hc(we,ve){ve||(ve={});var Le={},ot=[];ea(we,"",Le,ve);var Gt=0,yn=0;for(var Ht in Le){var En=Le[Ht],fe=En[0],ue=En[1],Me=ue.level==0?0:8,De=(cn=bo(Ht)).length,Pe=ue.comment,Dt=Pe&&bo(Pe),Zt=Dt&&Dt.length,pn=Nt(ue.extra);if(De>65535)throw"filename too long";var Sn=Me?le(fe,ue):fe,lr=Sn.length,In=Gr();In.p(fe),ot.push(Nr(ue,{size:fe.length,crc:In.d(),c:Sn,f:cn,m:Dt,u:De!=Ht.length||Dt&&Pe.length!=Zt,o:Gt,compression:Me})),Gt+=30+De+pn+lr,yn+=76+2*(De+pn)+(Zt||0)+lr}for(var un=new s(yn+22),cr=Gt,Bn=yn-Gt,fr=0;fr<ot.length;++fr){var cn;ko(un,(cn=ot[fr]).o,cn,cn.f,cn.u,cn.c.length);var Ar=30+cn.f.length+Nt(cn.extra);un.set(cn.c,cn.o+Ar),ko(un,Gt,cn,cn.f,cn.u,cn.c.length,cn.o,cn.m),Gt+=16+Ar+(cn.m?cn.m.length:0)}return ns(un,Gt,ot.length,Bn,cr),un}n.Zip=Uc,n.zip=Aa,n.zipSync=hc;var ur=function(){function we(){}return we.prototype.push=function(ve,Le){this.ondata(null,ve,Le)},we.compression=0,we}();n.UnzipPassThrough=ur;var Ei=function(){function we(){var ve=this;this.i=new Ae(function(Le,ot){ve.ondata(null,Le,ot)})}return we.prototype.push=function(ve,Le){try{this.i.push(ve,Le)}catch(ot){this.ondata(ot,ve,Le)}},we.compression=8,we}();n.UnzipInflate=Ei;var Si=function(){function we(ve,Le){var ot=this;Le<32e4?this.i=new Ae(function(Gt,yn){ot.ondata(null,Gt,yn)}):(this.i=new Fe(function(Gt,yn,Ht){ot.ondata(Gt,yn,Ht)}),this.terminate=this.i.terminate)}return we.prototype.push=function(ve,Le){this.i.terminate&&(ve=Q(ve,0)),this.i.push(ve,Le)},we.compression=8,we}();n.AsyncUnzipInflate=Si;var ys=function(){function we(ve){this.onfile=ve,this.k=[],this.o={0:ur},this.p=Nn}return we.prototype.push=function(ve,Le){var ot=this;if(!this.onfile)throw"no callback";if(this.c>0){var Gt=Math.min(this.c,ve.length),yn=ve.subarray(0,Gt);if(this.c-=Gt,this.d?this.d.push(yn,!this.c):this.k[0].push(yn),(ve=ve.subarray(Gt)).length)return this.push(ve,Le)}else{var Ht=0,En=0,fe=void 0,ue=void 0;this.p.length?ve.length?((ue=new s(this.p.length+ve.length)).set(this.p),ue.set(ve,this.p.length)):ue=this.p:ue=ve;for(var Me=ue.length,De=this.c,Pe=De&&this.d,Dt=function(){var Sn,lr=Dr(ue,En);if(lr==67324752){Ht=1,fe=En,Zt.d=null,Zt.c=0;var In=Sr(ue,En+6),un=Sr(ue,En+8),cr=2048&In,Bn=8&In,fr=Sr(ue,En+26),cn=Sr(ue,En+28);if(Me>En+30+fr+cn){var Ar=[];Zt.k.unshift(Ar),Ht=2;var $r=Dr(ue,En+18),ei=Dr(ue,En+22),Br=nl(ue.subarray(En+30,En+=30+fr),!cr);$r==4294967295?(Sn=Bn?[-2]:rl(ue,En),$r=Sn[0],ei=Sn[1]):Bn&&($r=-1),En+=cn,Zt.c=$r;var qi={name:Br,compression:un,start:function(){if(!qi.ondata)throw"no callback";if($r){var Oi=ot.o[un];if(!Oi)throw"unknown compression type "+un;var Xn=$r<0?new Oi(Br):new Oi(Br,$r,ei);Xn.ondata=function(Do,xi,pa){qi.ondata(Do,xi,pa)};for(var es=0,li=Ar;es<li.length;es++)Xn.push(li[es],!1);ot.k[0]==Ar?ot.d=Xn:Xn.push(Nn,!0)}else qi.ondata(null,Nn,!0)},terminate:function(){ot.k[0]==Ar&&ot.d.terminate&&ot.d.terminate()}};$r>=0&&(qi.size=$r,qi.originalSize=ei),Zt.onfile(qi)}return"break"}if(De){if(lr==134695760)return fe=En+=12+(De==-2&&8),Ht=2,Zt.c=0,"break";if(lr==33639248)return fe=En-=4,Ht=2,Zt.c=0,"break"}},Zt=this;En<Me-4&&Dt()!=="break";++En);if(this.p=Nn,De<0){var pn=ue.subarray(0,Ht?fe-12-(De==-2&&8)-(Dr(ue,fe-16)==134695760&&4):En);Pe?Pe.push(pn,!!Ht):this.k[+(Ht==2)].push(pn)}if(2&Ht)return this.push(ue.subarray(En),Le);this.p=ue.subarray(En)}if(Le&&this.c)throw"invalid zip file"},we.prototype.register=function(ve){this.o[ve.compression]=ve},we}();function $a(we,ve){if(typeof ve!="function")throw"no callback";for(var Le=[],ot=function(){for(var Pe=0;Pe<Le.length;++Pe)Le[Pe]()},Gt={},yn=we.length-22;Dr(we,yn)!=101010256;--yn)if(!yn||we.length-yn>65558)return void ve("invalid zip file",null);var Ht=Sr(we,yn+8);Ht||ve(null,{});var En=Ht,fe=Dr(we,yn+16),ue=fe==4294967295;if(ue){if(yn=Dr(we,yn-12),Dr(we,yn)!=101075792)return void ve("invalid zip file",null);En=Ht=Dr(we,yn+32),fe=Dr(we,yn+48)}for(var Me=function(Pe){var Dt=_l(we,fe,ue),Zt=Dt[0],pn=Dt[1],Sn=Dt[2],lr=Dt[3],In=Dt[4],un=yl(we,Dt[5]);fe=In;var cr=function(fr,cn){fr?(ot(),ve(fr,null)):(Gt[lr]=cn,--Ht||ve(null,Gt))};if(Zt)if(Zt==8){var Bn=we.subarray(un,un+pn);if(pn<32e4)try{cr(null,kt(Bn,new s(Sn)))}catch(fr){cr(fr,null)}else Le.push(nt(Bn,{size:Sn},cr))}else cr("unknown compression type "+Zt,null);else cr(null,Q(we,un,un+pn))},De=0;De<En;++De)Me();return ot}function vi(we){for(var ve={},Le=we.length-22;Dr(we,Le)!=101010256;--Le)if(!Le||we.length-Le>65558)throw"invalid zip file";var ot=Sr(we,Le+8);if(!ot)return{};var Gt=Dr(we,Le+16),yn=Gt==4294967295;if(yn){if(Le=Dr(we,Le-12),Dr(we,Le)!=101075792)throw"invalid zip file";ot=Dr(we,Le+32),Gt=Dr(we,Le+48)}for(var Ht=0;Ht<ot;++Ht){var En=_l(we,Gt,yn),fe=En[0],ue=En[1],Me=En[2],De=En[3],Pe=En[4],Dt=yl(we,En[5]);if(Gt=Pe,fe){if(fe!=8)throw"unknown compression type "+fe;ve[De]=kt(we.subarray(Dt,Dt+ue),new s(Me))}else ve[De]=Q(we,Dt,Dt+ue)}return ve}return n.Unzip=ys,n.unzip=$a,n.unzipSync=vi,n})})(Jk,Jk.exports);var yre=Jk.exports;(function(t,e){const n=ju,r=yre;(function(){let s,u,p;class g extends n.Loader{constructor(Q){super(Q)}load(Q,ye,ge,xe){const Ce=this,tt=Ce.path===""?n.LoaderUtils.extractUrlBase(Q):Ce.path,Je=new n.FileLoader(this.manager);Je.setPath(Ce.path),Je.setResponseType("arraybuffer"),Je.setRequestHeader(Ce.requestHeader),Je.setWithCredentials(Ce.withCredentials),Je.load(Q,function(rt){try{ye(Ce.parse(rt,tt))}catch(Ut){xe?xe(Ut):console.error(Ut),Ce.manager.itemError(Q)}},ge,xe)}parse(Q,ye){if(re(Q))s=new j().parse(Q);else{const xe=We(Q);if(!_e(xe))throw new Error("THREE.FBXLoader: Unknown format.");if(J(xe)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+J(xe));s=new O().parse(xe)}const ge=new n.TextureLoader(this.manager).setPath(this.resourcePath||ye).setCrossOrigin(this.crossOrigin);return new l(ge,this.manager).parse(s)}}class l{constructor(Q,ye){this.textureLoader=Q,this.manager=ye}parse(){u=this.parseConnections();const Q=this.parseImages(),ye=this.parseTextures(Q),ge=this.parseMaterials(ye),xe=this.parseDeformers(),Ce=new E().parse(xe);return this.parseScene(xe,Ce,ge),p}parseConnections(){const Q=new Map;return"Connections"in s&&s.Connections.connections.forEach(function(ge){const xe=ge[0],Ce=ge[1],tt=ge[2];Q.has(xe)||Q.set(xe,{parents:[],children:[]});const Je={ID:Ce,relationship:tt};Q.get(xe).parents.push(Je),Q.has(Ce)||Q.set(Ce,{parents:[],children:[]});const rt={ID:xe,relationship:tt};Q.get(Ce).children.push(rt)}),Q}parseImages(){const Q={},ye={};if("Video"in s.Objects){const ge=s.Objects.Video;for(const xe in ge){const Ce=ge[xe],tt=parseInt(xe);if(Q[tt]=Ce.RelativeFilename||Ce.Filename,"Content"in Ce){const Je=Ce.Content instanceof ArrayBuffer&&Ce.Content.byteLength>0,rt=typeof Ce.Content=="string"&&Ce.Content!=="";if(Je||rt){const Ut=this.parseImage(ge[xe]);ye[Ce.RelativeFilename||Ce.Filename]=Ut}}}}for(const ge in Q){const xe=Q[ge];ye[xe]!==void 0?Q[ge]=ye[xe]:Q[ge]=Q[ge].split("\\").pop()}return Q}parseImage(Q){const ye=Q.Content,ge=Q.RelativeFilename||Q.Filename,xe=ge.slice(ge.lastIndexOf(".")+1).toLowerCase();let Ce;switch(xe){case"bmp":Ce="image/bmp";break;case"jpg":case"jpeg":Ce="image/jpeg";break;case"png":Ce="image/png";break;case"tif":Ce="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",ge),Ce="image/tga";break;default:console.warn('FBXLoader: Image type "'+xe+'" is not supported.');return}if(typeof ye=="string")return"data:"+Ce+";base64,"+ye;{const tt=new Uint8Array(ye);return window.URL.createObjectURL(new Blob([tt],{type:Ce}))}}parseTextures(Q){const ye=new Map;if("Texture"in s.Objects){const ge=s.Objects.Texture;for(const xe in ge){const Ce=this.parseTexture(ge[xe],Q);ye.set(parseInt(xe),Ce)}}return ye}parseTexture(Q,ye){const ge=this.loadTexture(Q,ye);ge.ID=Q.id,ge.name=Q.attrName;const xe=Q.WrapModeU,Ce=Q.WrapModeV,tt=xe!==void 0?xe.value:0,Je=Ce!==void 0?Ce.value:0;if(ge.wrapS=tt===0?n.RepeatWrapping:n.ClampToEdgeWrapping,ge.wrapT=Je===0?n.RepeatWrapping:n.ClampToEdgeWrapping,"Scaling"in Q){const rt=Q.Scaling.value;ge.repeat.x=rt[0],ge.repeat.y=rt[1]}return ge}loadTexture(Q,ye){let ge;const xe=this.textureLoader.path,Ce=u.get(Q.id).children;Ce!==void 0&&Ce.length>0&&ye[Ce[0].ID]!==void 0&&(ge=ye[Ce[0].ID],(ge.indexOf("blob:")===0||ge.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let tt;const Je=Q.FileName.slice(-3).toLowerCase();if(Je==="tga"){const rt=this.manager.getHandler(".tga");rt===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",Q.RelativeFilename),tt=new n.Texture):(rt.setPath(this.textureLoader.path),tt=rt.load(ge))}else Je==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",Q.RelativeFilename),tt=new n.Texture):tt=this.textureLoader.load(ge);return this.textureLoader.setPath(xe),tt}parseMaterials(Q){const ye=new Map;if("Material"in s.Objects){const ge=s.Objects.Material;for(const xe in ge){const Ce=this.parseMaterial(ge[xe],Q);Ce!==null&&ye.set(parseInt(xe),Ce)}}return ye}parseMaterial(Q,ye){const ge=Q.id,xe=Q.attrName;let Ce=Q.ShadingModel;if(typeof Ce=="object"&&(Ce=Ce.value),!u.has(ge))return null;const tt=this.parseParameters(Q,ye,ge);let Je;switch(Ce.toLowerCase()){case"phong":Je=new n.MeshPhongMaterial;break;case"lambert":Je=new n.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to THREE.MeshPhongMaterial.',Ce),Je=new n.MeshPhongMaterial;break}return Je.setValues(tt),Je.name=xe,Je}parseParameters(Q,ye,ge){const xe={};Q.BumpFactor&&(xe.bumpScale=Q.BumpFactor.value),Q.Diffuse?xe.color=new n.Color().fromArray(Q.Diffuse.value):Q.DiffuseColor&&(Q.DiffuseColor.type==="Color"||Q.DiffuseColor.type==="ColorRGB")&&(xe.color=new n.Color().fromArray(Q.DiffuseColor.value)),Q.DisplacementFactor&&(xe.displacementScale=Q.DisplacementFactor.value),Q.Emissive?xe.emissive=new n.Color().fromArray(Q.Emissive.value):Q.EmissiveColor&&(Q.EmissiveColor.type==="Color"||Q.EmissiveColor.type==="ColorRGB")&&(xe.emissive=new n.Color().fromArray(Q.EmissiveColor.value)),Q.EmissiveFactor&&(xe.emissiveIntensity=parseFloat(Q.EmissiveFactor.value)),Q.Opacity&&(xe.opacity=parseFloat(Q.Opacity.value)),xe.opacity<1&&(xe.transparent=!0),Q.ReflectionFactor&&(xe.reflectivity=Q.ReflectionFactor.value),Q.Shininess&&(xe.shininess=Q.Shininess.value),Q.Specular?xe.specular=new n.Color().fromArray(Q.Specular.value):Q.SpecularColor&&Q.SpecularColor.type==="Color"&&(xe.specular=new n.Color().fromArray(Q.SpecularColor.value));const Ce=this;return u.get(ge).children.forEach(function(tt){const Je=tt.relationship;switch(Je){case"Bump":xe.bumpMap=Ce.getTexture(ye,tt.ID);break;case"Maya|TEX_ao_map":xe.aoMap=Ce.getTexture(ye,tt.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":xe.map=Ce.getTexture(ye,tt.ID),xe.map!==void 0&&(xe.map.encoding=n.sRGBEncoding);break;case"DisplacementColor":xe.displacementMap=Ce.getTexture(ye,tt.ID);break;case"EmissiveColor":xe.emissiveMap=Ce.getTexture(ye,tt.ID),xe.emissiveMap!==void 0&&(xe.emissiveMap.encoding=n.sRGBEncoding);break;case"NormalMap":case"Maya|TEX_normal_map":xe.normalMap=Ce.getTexture(ye,tt.ID);break;case"ReflectionColor":xe.envMap=Ce.getTexture(ye,tt.ID),xe.envMap!==void 0&&(xe.envMap.mapping=n.EquirectangularReflectionMapping,xe.envMap.encoding=n.sRGBEncoding);break;case"SpecularColor":xe.specularMap=Ce.getTexture(ye,tt.ID),xe.specularMap!==void 0&&(xe.specularMap.encoding=n.sRGBEncoding);break;case"TransparentColor":case"TransparencyFactor":xe.alphaMap=Ce.getTexture(ye,tt.ID),xe.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",Je);break}}),xe}getTexture(Q,ye){return"LayeredTexture"in s.Objects&&ye in s.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),ye=u.get(ye).children[0].ID),Q.get(ye)}parseDeformers(){const Q={},ye={};if("Deformer"in s.Objects){const ge=s.Objects.Deformer;for(const xe in ge){const Ce=ge[xe],tt=u.get(parseInt(xe));if(Ce.attrType==="Skin"){const Je=this.parseSkeleton(tt,ge);Je.ID=xe,tt.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),Je.geometryID=tt.parents[0].ID,Q[xe]=Je}else if(Ce.attrType==="BlendShape"){const Je={id:xe};Je.rawTargets=this.parseMorphTargets(tt,ge),Je.id=xe,tt.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),ye[xe]=Je}}}return{skeletons:Q,morphTargets:ye}}parseSkeleton(Q,ye){const ge=[];return Q.children.forEach(function(xe){const Ce=ye[xe.ID];if(Ce.attrType!=="Cluster")return;const tt={ID:xe.ID,indices:[],weights:[],transformLink:new n.Matrix4().fromArray(Ce.TransformLink.a)};"Indexes"in Ce&&(tt.indices=Ce.Indexes.a,tt.weights=Ce.Weights.a),ge.push(tt)}),{rawBones:ge,bones:[]}}parseMorphTargets(Q,ye){const ge=[];for(let xe=0;xe<Q.children.length;xe++){const Ce=Q.children[xe],tt=ye[Ce.ID],Je={name:tt.attrName,initialWeight:tt.DeformPercent,id:tt.id,fullWeights:tt.FullWeights.a};if(tt.attrType!=="BlendShapeChannel")return;Je.geoID=u.get(parseInt(Ce.ID)).children.filter(function(rt){return rt.relationship===void 0})[0].ID,ge.push(Je)}return ge}parseScene(Q,ye,ge){p=new n.Group;const xe=this.parseModels(Q.skeletons,ye,ge),Ce=s.Objects.Model,tt=this;xe.forEach(function(rt){const Ut=Ce[rt.ID];tt.setLookAtProperties(rt,Ut),u.get(rt.ID).parents.forEach(function(Ft){const Nn=xe.get(Ft.ID);Nn!==void 0&&Nn.add(rt)}),rt.parent===null&&p.add(rt)}),this.bindSkeleton(Q.skeletons,ye,xe),this.createAmbientLight(),p.traverse(function(rt){if(rt.userData.transformData){rt.parent&&(rt.userData.transformData.parentMatrix=rt.parent.matrix,rt.userData.transformData.parentMatrixWorld=rt.parent.matrixWorld);const Ut=Ne(rt.userData.transformData);rt.applyMatrix4(Ut),rt.updateWorldMatrix()}});const Je=new P().parse();p.children.length===1&&p.children[0].isGroup&&(p.children[0].animations=Je,p=p.children[0]),p.animations=Je}parseModels(Q,ye,ge){const xe=new Map,Ce=s.Objects.Model;for(const tt in Ce){const Je=parseInt(tt),rt=Ce[tt],Ut=u.get(Je);let ht=this.buildSkeleton(Ut,Q,Je,rt.attrName);if(!ht){switch(rt.attrType){case"Camera":ht=this.createCamera(Ut);break;case"Light":ht=this.createLight(Ut);break;case"Mesh":ht=this.createMesh(Ut,ye,ge);break;case"NurbsCurve":ht=this.createCurve(Ut,ye);break;case"LimbNode":case"Root":ht=new n.Bone;break;case"Null":default:ht=new n.Group;break}ht.name=rt.attrName?n.PropertyBinding.sanitizeNodeName(rt.attrName):"",ht.ID=Je}this.getTransformData(ht,rt),xe.set(Je,ht)}return xe}buildSkeleton(Q,ye,ge,xe){let Ce=null;return Q.parents.forEach(function(tt){for(const Je in ye){const rt=ye[Je];rt.rawBones.forEach(function(Ut,ht){if(Ut.ID===tt.ID){const Ft=Ce;Ce=new n.Bone,Ce.matrixWorld.copy(Ut.transformLink),Ce.name=xe?n.PropertyBinding.sanitizeNodeName(xe):"",Ce.ID=ge,rt.bones[ht]=Ce,Ft!==null&&Ce.add(Ft)}})}}),Ce}createCamera(Q){let ye,ge;if(Q.children.forEach(function(xe){const Ce=s.Objects.NodeAttribute[xe.ID];Ce!==void 0&&(ge=Ce)}),ge===void 0)ye=new n.Object3D;else{let xe=0;ge.CameraProjectionType!==void 0&&ge.CameraProjectionType.value===1&&(xe=1);let Ce=1;ge.NearPlane!==void 0&&(Ce=ge.NearPlane.value/1e3);let tt=1e3;ge.FarPlane!==void 0&&(tt=ge.FarPlane.value/1e3);let Je=window.innerWidth,rt=window.innerHeight;ge.AspectWidth!==void 0&&ge.AspectHeight!==void 0&&(Je=ge.AspectWidth.value,rt=ge.AspectHeight.value);const Ut=Je/rt;let ht=45;ge.FieldOfView!==void 0&&(ht=ge.FieldOfView.value);const Ft=ge.FocalLength?ge.FocalLength.value:null;switch(xe){case 0:ye=new n.PerspectiveCamera(ht,Ut,Ce,tt),Ft!==null&&ye.setFocalLength(Ft);break;case 1:ye=new n.OrthographicCamera(-Je/2,Je/2,rt/2,-rt/2,Ce,tt);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+xe+"."),ye=new n.Object3D;break}}return ye}createLight(Q){let ye,ge;if(Q.children.forEach(function(xe){const Ce=s.Objects.NodeAttribute[xe.ID];Ce!==void 0&&(ge=Ce)}),ge===void 0)ye=new n.Object3D;else{let xe;ge.LightType===void 0?xe=0:xe=ge.LightType.value;let Ce=16777215;ge.Color!==void 0&&(Ce=new n.Color().fromArray(ge.Color.value));let tt=ge.Intensity===void 0?1:ge.Intensity.value/100;ge.CastLightOnObject!==void 0&&ge.CastLightOnObject.value===0&&(tt=0);let Je=0;ge.FarAttenuationEnd!==void 0&&(ge.EnableFarAttenuation!==void 0&&ge.EnableFarAttenuation.value===0?Je=0:Je=ge.FarAttenuationEnd.value);const rt=1;switch(xe){case 0:ye=new n.PointLight(Ce,tt,Je,rt);break;case 1:ye=new n.DirectionalLight(Ce,tt);break;case 2:let Ut=Math.PI/3;ge.InnerAngle!==void 0&&(Ut=n.MathUtils.degToRad(ge.InnerAngle.value));let ht=0;ge.OuterAngle!==void 0&&(ht=n.MathUtils.degToRad(ge.OuterAngle.value),ht=Math.max(ht,1)),ye=new n.SpotLight(Ce,tt,Je,Ut,ht,rt);break;default:console.warn("THREE.FBXLoader: Unknown light type "+ge.LightType.value+", defaulting to a THREE.PointLight."),ye=new n.PointLight(Ce,tt);break}ge.CastShadows!==void 0&&ge.CastShadows.value===1&&(ye.castShadow=!0)}return ye}createMesh(Q,ye,ge){let xe,Ce=null,tt=null;const Je=[];return Q.children.forEach(function(rt){ye.has(rt.ID)&&(Ce=ye.get(rt.ID)),ge.has(rt.ID)&&Je.push(ge.get(rt.ID))}),Je.length>1?tt=Je:Je.length>0?tt=Je[0]:(tt=new n.MeshPhongMaterial({color:13421772}),Je.push(tt)),"color"in Ce.attributes&&Je.forEach(function(rt){rt.vertexColors=!0}),Ce.FBX_Deformer?(xe=new n.SkinnedMesh(Ce,tt),xe.normalizeSkinWeights()):xe=new n.Mesh(Ce,tt),xe}createCurve(Q,ye){const ge=Q.children.reduce(function(Ce,tt){return ye.has(tt.ID)&&(Ce=ye.get(tt.ID)),Ce},null),xe=new n.LineBasicMaterial({color:3342591,linewidth:1});return new n.Line(ge,xe)}getTransformData(Q,ye){const ge={};"InheritType"in ye&&(ge.inheritType=parseInt(ye.InheritType.value)),"RotationOrder"in ye?ge.eulerOrder=ut(ye.RotationOrder.value):ge.eulerOrder="ZYX","Lcl_Translation"in ye&&(ge.translation=ye.Lcl_Translation.value),"PreRotation"in ye&&(ge.preRotation=ye.PreRotation.value),"Lcl_Rotation"in ye&&(ge.rotation=ye.Lcl_Rotation.value),"PostRotation"in ye&&(ge.postRotation=ye.PostRotation.value),"Lcl_Scaling"in ye&&(ge.scale=ye.Lcl_Scaling.value),"ScalingOffset"in ye&&(ge.scalingOffset=ye.ScalingOffset.value),"ScalingPivot"in ye&&(ge.scalingPivot=ye.ScalingPivot.value),"RotationOffset"in ye&&(ge.rotationOffset=ye.RotationOffset.value),"RotationPivot"in ye&&(ge.rotationPivot=ye.RotationPivot.value),Q.userData.transformData=ge}setLookAtProperties(Q,ye){"LookAtProperty"in ye&&u.get(Q.ID).children.forEach(function(xe){if(xe.relationship==="LookAtProperty"){const Ce=s.Objects.Model[xe.ID];if("Lcl_Translation"in Ce){const tt=Ce.Lcl_Translation.value;Q.target!==void 0?(Q.target.position.fromArray(tt),p.add(Q.target)):Q.lookAt(new n.Vector3().fromArray(tt))}}})}bindSkeleton(Q,ye,ge){const xe=this.parsePoseNodes();for(const Ce in Q){const tt=Q[Ce];u.get(parseInt(tt.ID)).parents.forEach(function(rt){if(ye.has(rt.ID)){const Ut=rt.ID;u.get(Ut).parents.forEach(function(Ft){ge.has(Ft.ID)&&ge.get(Ft.ID).bind(new n.Skeleton(tt.bones),xe[Ft.ID])})}})}}parsePoseNodes(){const Q={};if("Pose"in s.Objects){const ye=s.Objects.Pose;for(const ge in ye)if(ye[ge].attrType==="BindPose"){const xe=ye[ge].PoseNode;Array.isArray(xe)?xe.forEach(function(Ce){Q[Ce.Node]=new n.Matrix4().fromArray(Ce.Matrix.a)}):Q[xe.Node]=new n.Matrix4().fromArray(xe.Matrix.a)}}return Q}createAmbientLight(){if("GlobalSettings"in s&&"AmbientColor"in s.GlobalSettings){const Q=s.GlobalSettings.AmbientColor.value,ye=Q[0],ge=Q[1],xe=Q[2];if(ye!==0||ge!==0||xe!==0){const Ce=new n.Color(ye,ge,xe);p.add(new n.AmbientLight(Ce,1))}}}}class E{parse(Q){const ye=new Map;if("Geometry"in s.Objects){const ge=s.Objects.Geometry;for(const xe in ge){const Ce=u.get(parseInt(xe)),tt=this.parseGeometry(Ce,ge[xe],Q);ye.set(parseInt(xe),tt)}}return ye}parseGeometry(Q,ye,ge){switch(ye.attrType){case"Mesh":return this.parseMeshGeometry(Q,ye,ge);case"NurbsCurve":return this.parseNurbsGeometry(ye)}}parseMeshGeometry(Q,ye,ge){const xe=ge.skeletons,Ce=[],tt=Q.parents.map(function(Ft){return s.Objects.Model[Ft.ID]});if(tt.length===0)return;const Je=Q.children.reduce(function(Ft,Nn){return xe[Nn.ID]!==void 0&&(Ft=xe[Nn.ID]),Ft},null);Q.children.forEach(function(Ft){ge.morphTargets[Ft.ID]!==void 0&&Ce.push(ge.morphTargets[Ft.ID])});const rt=tt[0],Ut={};"RotationOrder"in rt&&(Ut.eulerOrder=ut(rt.RotationOrder.value)),"InheritType"in rt&&(Ut.inheritType=parseInt(rt.InheritType.value)),"GeometricTranslation"in rt&&(Ut.translation=rt.GeometricTranslation.value),"GeometricRotation"in rt&&(Ut.rotation=rt.GeometricRotation.value),"GeometricScaling"in rt&&(Ut.scale=rt.GeometricScaling.value);const ht=Ne(Ut);return this.genGeometry(ye,Je,Ce,ht)}genGeometry(Q,ye,ge,xe){const Ce=new n.BufferGeometry;Q.attrName&&(Ce.name=Q.attrName);const tt=this.parseGeoNode(Q,ye),Je=this.genBuffers(tt),rt=new n.Float32BufferAttribute(Je.vertex,3);if(rt.applyMatrix4(xe),Ce.setAttribute("position",rt),Je.colors.length>0&&Ce.setAttribute("color",new n.Float32BufferAttribute(Je.colors,3)),ye&&(Ce.setAttribute("skinIndex",new n.Uint16BufferAttribute(Je.weightsIndices,4)),Ce.setAttribute("skinWeight",new n.Float32BufferAttribute(Je.vertexWeights,4)),Ce.FBX_Deformer=ye),Je.normal.length>0){const Ut=new n.Matrix3().getNormalMatrix(xe),ht=new n.Float32BufferAttribute(Je.normal,3);ht.applyNormalMatrix(Ut),Ce.setAttribute("normal",ht)}if(Je.uvs.forEach(function(Ut,ht){let Ft="uv"+(ht+1).toString();ht===0&&(Ft="uv"),Ce.setAttribute(Ft,new n.Float32BufferAttribute(Je.uvs[ht],2))}),tt.material&&tt.material.mappingType!=="AllSame"){let Ut=Je.materialIndex[0],ht=0;if(Je.materialIndex.forEach(function(Ft,Nn){Ft!==Ut&&(Ce.addGroup(ht,Nn-ht,Ut),Ut=Ft,ht=Nn)}),Ce.groups.length>0){const Ft=Ce.groups[Ce.groups.length-1],Nn=Ft.start+Ft.count;Nn!==Je.materialIndex.length&&Ce.addGroup(Nn,Je.materialIndex.length-Nn,Ut)}Ce.groups.length===0&&Ce.addGroup(0,Je.materialIndex.length,Je.materialIndex[0])}return this.addMorphTargets(Ce,Q,ge,xe),Ce}parseGeoNode(Q,ye){const ge={};if(ge.vertexPositions=Q.Vertices!==void 0?Q.Vertices.a:[],ge.vertexIndices=Q.PolygonVertexIndex!==void 0?Q.PolygonVertexIndex.a:[],Q.LayerElementColor&&(ge.color=this.parseVertexColors(Q.LayerElementColor[0])),Q.LayerElementMaterial&&(ge.material=this.parseMaterialIndices(Q.LayerElementMaterial[0])),Q.LayerElementNormal&&(ge.normal=this.parseNormals(Q.LayerElementNormal[0])),Q.LayerElementUV){ge.uv=[];let xe=0;for(;Q.LayerElementUV[xe];)Q.LayerElementUV[xe].UV&&ge.uv.push(this.parseUVs(Q.LayerElementUV[xe])),xe++}return ge.weightTable={},ye!==null&&(ge.skeleton=ye,ye.rawBones.forEach(function(xe,Ce){xe.indices.forEach(function(tt,Je){ge.weightTable[tt]===void 0&&(ge.weightTable[tt]=[]),ge.weightTable[tt].push({id:Ce,weight:xe.weights[Je]})})})),ge}genBuffers(Q){const ye={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let ge=0,xe=0,Ce=!1,tt=[],Je=[],rt=[],Ut=[],ht=[],Ft=[];const Nn=this;return Q.vertexIndices.forEach(function(zn,rr){let Gr,Li=!1;zn<0&&(zn=zn^-1,Li=!0);let wi=[],Nr=[];if(tt.push(zn*3,zn*3+1,zn*3+2),Q.color){const fi=ce(rr,ge,zn,Q.color);rt.push(fi[0],fi[1],fi[2])}if(Q.skeleton){if(Q.weightTable[zn]!==void 0&&Q.weightTable[zn].forEach(function(fi){Nr.push(fi.weight),wi.push(fi.id)}),Nr.length>4){Ce||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),Ce=!0);const fi=[0,0,0,0],Mi=[0,0,0,0];Nr.forEach(function(jn,Be){let ze=jn,vt=wi[Be];Mi.forEach(function(Qe,gt,St){if(ze>Qe){St[gt]=ze,ze=Qe;const Rt=fi[gt];fi[gt]=vt,vt=Rt}})}),wi=fi,Nr=Mi}for(;Nr.length<4;)Nr.push(0),wi.push(0);for(let fi=0;fi<4;++fi)ht.push(Nr[fi]),Ft.push(wi[fi])}if(Q.normal){const fi=ce(rr,ge,zn,Q.normal);Je.push(fi[0],fi[1],fi[2])}Q.material&&Q.material.mappingType!=="AllSame"&&(Gr=ce(rr,ge,zn,Q.material)[0]),Q.uv&&Q.uv.forEach(function(fi,Mi){const jn=ce(rr,ge,zn,fi);Ut[Mi]===void 0&&(Ut[Mi]=[]),Ut[Mi].push(jn[0]),Ut[Mi].push(jn[1])}),xe++,Li&&(Nn.genFace(ye,Q,tt,Gr,Je,rt,Ut,ht,Ft,xe),ge++,xe=0,tt=[],Je=[],rt=[],Ut=[],ht=[],Ft=[])}),ye}genFace(Q,ye,ge,xe,Ce,tt,Je,rt,Ut,ht){for(let Ft=2;Ft<ht;Ft++)Q.vertex.push(ye.vertexPositions[ge[0]]),Q.vertex.push(ye.vertexPositions[ge[1]]),Q.vertex.push(ye.vertexPositions[ge[2]]),Q.vertex.push(ye.vertexPositions[ge[(Ft-1)*3]]),Q.vertex.push(ye.vertexPositions[ge[(Ft-1)*3+1]]),Q.vertex.push(ye.vertexPositions[ge[(Ft-1)*3+2]]),Q.vertex.push(ye.vertexPositions[ge[Ft*3]]),Q.vertex.push(ye.vertexPositions[ge[Ft*3+1]]),Q.vertex.push(ye.vertexPositions[ge[Ft*3+2]]),ye.skeleton&&(Q.vertexWeights.push(rt[0]),Q.vertexWeights.push(rt[1]),Q.vertexWeights.push(rt[2]),Q.vertexWeights.push(rt[3]),Q.vertexWeights.push(rt[(Ft-1)*4]),Q.vertexWeights.push(rt[(Ft-1)*4+1]),Q.vertexWeights.push(rt[(Ft-1)*4+2]),Q.vertexWeights.push(rt[(Ft-1)*4+3]),Q.vertexWeights.push(rt[Ft*4]),Q.vertexWeights.push(rt[Ft*4+1]),Q.vertexWeights.push(rt[Ft*4+2]),Q.vertexWeights.push(rt[Ft*4+3]),Q.weightsIndices.push(Ut[0]),Q.weightsIndices.push(Ut[1]),Q.weightsIndices.push(Ut[2]),Q.weightsIndices.push(Ut[3]),Q.weightsIndices.push(Ut[(Ft-1)*4]),Q.weightsIndices.push(Ut[(Ft-1)*4+1]),Q.weightsIndices.push(Ut[(Ft-1)*4+2]),Q.weightsIndices.push(Ut[(Ft-1)*4+3]),Q.weightsIndices.push(Ut[Ft*4]),Q.weightsIndices.push(Ut[Ft*4+1]),Q.weightsIndices.push(Ut[Ft*4+2]),Q.weightsIndices.push(Ut[Ft*4+3])),ye.color&&(Q.colors.push(tt[0]),Q.colors.push(tt[1]),Q.colors.push(tt[2]),Q.colors.push(tt[(Ft-1)*3]),Q.colors.push(tt[(Ft-1)*3+1]),Q.colors.push(tt[(Ft-1)*3+2]),Q.colors.push(tt[Ft*3]),Q.colors.push(tt[Ft*3+1]),Q.colors.push(tt[Ft*3+2])),ye.material&&ye.material.mappingType!=="AllSame"&&(Q.materialIndex.push(xe),Q.materialIndex.push(xe),Q.materialIndex.push(xe)),ye.normal&&(Q.normal.push(Ce[0]),Q.normal.push(Ce[1]),Q.normal.push(Ce[2]),Q.normal.push(Ce[(Ft-1)*3]),Q.normal.push(Ce[(Ft-1)*3+1]),Q.normal.push(Ce[(Ft-1)*3+2]),Q.normal.push(Ce[Ft*3]),Q.normal.push(Ce[Ft*3+1]),Q.normal.push(Ce[Ft*3+2])),ye.uv&&ye.uv.forEach(function(Nn,zn){Q.uvs[zn]===void 0&&(Q.uvs[zn]=[]),Q.uvs[zn].push(Je[zn][0]),Q.uvs[zn].push(Je[zn][1]),Q.uvs[zn].push(Je[zn][(Ft-1)*2]),Q.uvs[zn].push(Je[zn][(Ft-1)*2+1]),Q.uvs[zn].push(Je[zn][Ft*2]),Q.uvs[zn].push(Je[zn][Ft*2+1])})}addMorphTargets(Q,ye,ge,xe){if(ge.length===0)return;Q.morphTargetsRelative=!0,Q.morphAttributes.position=[];const Ce=this;ge.forEach(function(tt){tt.rawTargets.forEach(function(Je){const rt=s.Objects.Geometry[Je.geoID];rt!==void 0&&Ce.genMorphGeometry(Q,ye,rt,xe,Je.name)})})}genMorphGeometry(Q,ye,ge,xe,Ce){const tt=ye.PolygonVertexIndex!==void 0?ye.PolygonVertexIndex.a:[],Je=ge.Vertices!==void 0?ge.Vertices.a:[],rt=ge.Indexes!==void 0?ge.Indexes.a:[],Ut=Q.attributes.position.count*3,ht=new Float32Array(Ut);for(let rr=0;rr<rt.length;rr++){const Gr=rt[rr]*3;ht[Gr]=Je[rr*3],ht[Gr+1]=Je[rr*3+1],ht[Gr+2]=Je[rr*3+2]}const Ft={vertexIndices:tt,vertexPositions:ht},Nn=this.genBuffers(Ft),zn=new n.Float32BufferAttribute(Nn.vertex,3);zn.name=Ce||ge.attrName,zn.applyMatrix4(xe),Q.morphAttributes.position.push(zn)}parseNormals(Q){const ye=Q.MappingInformationType,ge=Q.ReferenceInformationType,xe=Q.Normals.a;let Ce=[];return ge==="IndexToDirect"&&("NormalIndex"in Q?Ce=Q.NormalIndex.a:"NormalsIndex"in Q&&(Ce=Q.NormalsIndex.a)),{dataSize:3,buffer:xe,indices:Ce,mappingType:ye,referenceType:ge}}parseUVs(Q){const ye=Q.MappingInformationType,ge=Q.ReferenceInformationType,xe=Q.UV.a;let Ce=[];return ge==="IndexToDirect"&&(Ce=Q.UVIndex.a),{dataSize:2,buffer:xe,indices:Ce,mappingType:ye,referenceType:ge}}parseVertexColors(Q){const ye=Q.MappingInformationType,ge=Q.ReferenceInformationType,xe=Q.Colors.a;let Ce=[];return ge==="IndexToDirect"&&(Ce=Q.ColorIndex.a),{dataSize:4,buffer:xe,indices:Ce,mappingType:ye,referenceType:ge}}parseMaterialIndices(Q){const ye=Q.MappingInformationType,ge=Q.ReferenceInformationType;if(ye==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:ge};const xe=Q.Materials.a,Ce=[];for(let tt=0;tt<xe.length;++tt)Ce.push(tt);return{dataSize:1,buffer:xe,indices:Ce,mappingType:ye,referenceType:ge}}parseNurbsGeometry(Q){if(n.NURBSCurve===void 0)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new n.BufferGeometry;const ye=parseInt(Q.Order);if(isNaN(ye))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",Q.Order,Q.id),new n.BufferGeometry;const ge=ye-1,xe=Q.KnotVector.a,Ce=[],tt=Q.Points.a;for(let Ft=0,Nn=tt.length;Ft<Nn;Ft+=4)Ce.push(new n.Vector4().fromArray(tt,Ft));let Je,rt;if(Q.Form==="Closed")Ce.push(Ce[0]);else if(Q.Form==="Periodic"){Je=ge,rt=xe.length-1-Je;for(let Ft=0;Ft<ge;++Ft)Ce.push(Ce[Ft])}const ht=new n.NURBSCurve(ge,xe,Ce,Je,rt).getPoints(Ce.length*12);return new n.BufferGeometry().setFromPoints(ht)}}class P{parse(){const Q=[],ye=this.parseClips();if(ye!==void 0)for(const ge in ye){const xe=ye[ge],Ce=this.addClip(xe);Q.push(Ce)}return Q}parseClips(){if(s.Objects.AnimationCurve===void 0)return;const Q=this.parseAnimationCurveNodes();this.parseAnimationCurves(Q);const ye=this.parseAnimationLayers(Q);return this.parseAnimStacks(ye)}parseAnimationCurveNodes(){const Q=s.Objects.AnimationCurveNode,ye=new Map;for(const ge in Q){const xe=Q[ge];if(xe.attrName.match(/S|R|T|DeformPercent/)!==null){const Ce={id:xe.id,attr:xe.attrName,curves:{}};ye.set(Ce.id,Ce)}}return ye}parseAnimationCurves(Q){const ye=s.Objects.AnimationCurve;for(const ge in ye){const xe={id:ye[ge].id,times:ye[ge].KeyTime.a.map(H),values:ye[ge].KeyValueFloat.a},Ce=u.get(xe.id);if(Ce!==void 0){const tt=Ce.parents[0].ID,Je=Ce.parents[0].relationship;Je.match(/X/)?Q.get(tt).curves.x=xe:Je.match(/Y/)?Q.get(tt).curves.y=xe:Je.match(/Z/)?Q.get(tt).curves.z=xe:Je.match(/d|DeformPercent/)&&Q.has(tt)&&(Q.get(tt).curves.morph=xe)}}}parseAnimationLayers(Q){const ye=s.Objects.AnimationLayer,ge=new Map;for(const xe in ye){const Ce=[],tt=u.get(parseInt(xe));tt!==void 0&&(tt.children.forEach(function(rt,Ut){if(Q.has(rt.ID)){const ht=Q.get(rt.ID);if(ht.curves.x!==void 0||ht.curves.y!==void 0||ht.curves.z!==void 0){if(Ce[Ut]===void 0){const Ft=u.get(rt.ID).parents.filter(function(Nn){return Nn.relationship!==void 0})[0].ID;if(Ft!==void 0){const Nn=s.Objects.Model[Ft.toString()];if(Nn===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",rt);return}const zn={modelName:Nn.attrName?n.PropertyBinding.sanitizeNodeName(Nn.attrName):"",ID:Nn.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};p.traverse(function(rr){rr.ID===Nn.id&&(zn.transform=rr.matrix,rr.userData.transformData&&(zn.eulerOrder=rr.userData.transformData.eulerOrder))}),zn.transform||(zn.transform=new n.Matrix4),"PreRotation"in Nn&&(zn.preRotation=Nn.PreRotation.value),"PostRotation"in Nn&&(zn.postRotation=Nn.PostRotation.value),Ce[Ut]=zn}}Ce[Ut]&&(Ce[Ut][ht.attr]=ht)}else if(ht.curves.morph!==void 0){if(Ce[Ut]===void 0){const Ft=u.get(rt.ID).parents.filter(function(wi){return wi.relationship!==void 0})[0].ID,Nn=u.get(Ft).parents[0].ID,zn=u.get(Nn).parents[0].ID,rr=u.get(zn).parents[0].ID,Gr=s.Objects.Model[rr],Li={modelName:Gr.attrName?n.PropertyBinding.sanitizeNodeName(Gr.attrName):"",morphName:s.Objects.Deformer[Ft].attrName};Ce[Ut]=Li}Ce[Ut][ht.attr]=ht}}}),ge.set(parseInt(xe),Ce))}return ge}parseAnimStacks(Q){const ye=s.Objects.AnimationStack,ge={};for(const xe in ye){const Ce=u.get(parseInt(xe)).children;Ce.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const tt=Q.get(Ce[0].ID);ge[xe]={name:ye[xe].attrName,layer:tt}}return ge}addClip(Q){let ye=[];const ge=this;return Q.layer.forEach(function(xe){ye=ye.concat(ge.generateTracks(xe))}),new n.AnimationClip(Q.name,-1,ye)}generateTracks(Q){const ye=[];let ge=new n.Vector3,xe=new n.Quaternion,Ce=new n.Vector3;if(Q.transform&&Q.transform.decompose(ge,xe,Ce),ge=ge.toArray(),xe=new n.Euler().setFromQuaternion(xe,Q.eulerOrder).toArray(),Ce=Ce.toArray(),Q.T!==void 0&&Object.keys(Q.T.curves).length>0){const tt=this.generateVectorTrack(Q.modelName,Q.T.curves,ge,"position");tt!==void 0&&ye.push(tt)}if(Q.R!==void 0&&Object.keys(Q.R.curves).length>0){const tt=this.generateRotationTrack(Q.modelName,Q.R.curves,xe,Q.preRotation,Q.postRotation,Q.eulerOrder);tt!==void 0&&ye.push(tt)}if(Q.S!==void 0&&Object.keys(Q.S.curves).length>0){const tt=this.generateVectorTrack(Q.modelName,Q.S.curves,Ce,"scale");tt!==void 0&&ye.push(tt)}if(Q.DeformPercent!==void 0){const tt=this.generateMorphTrack(Q);tt!==void 0&&ye.push(tt)}return ye}generateVectorTrack(Q,ye,ge,xe){const Ce=this.getTimesForAllAxes(ye),tt=this.getKeyframeTrackValues(Ce,ye,ge);return new n.VectorKeyframeTrack(Q+"."+xe,Ce,tt)}generateRotationTrack(Q,ye,ge,xe,Ce,tt){ye.x!==void 0&&(this.interpolateRotations(ye.x),ye.x.values=ye.x.values.map(n.MathUtils.degToRad)),ye.y!==void 0&&(this.interpolateRotations(ye.y),ye.y.values=ye.y.values.map(n.MathUtils.degToRad)),ye.z!==void 0&&(this.interpolateRotations(ye.z),ye.z.values=ye.z.values.map(n.MathUtils.degToRad));const Je=this.getTimesForAllAxes(ye),rt=this.getKeyframeTrackValues(Je,ye,ge);xe!==void 0&&(xe=xe.map(n.MathUtils.degToRad),xe.push(tt),xe=new n.Euler().fromArray(xe),xe=new n.Quaternion().setFromEuler(xe)),Ce!==void 0&&(Ce=Ce.map(n.MathUtils.degToRad),Ce.push(tt),Ce=new n.Euler().fromArray(Ce),Ce=new n.Quaternion().setFromEuler(Ce).invert());const Ut=new n.Quaternion,ht=new n.Euler,Ft=[];for(let Nn=0;Nn<rt.length;Nn+=3)ht.set(rt[Nn],rt[Nn+1],rt[Nn+2],tt),Ut.setFromEuler(ht),xe!==void 0&&Ut.premultiply(xe),Ce!==void 0&&Ut.multiply(Ce),Ut.toArray(Ft,Nn/3*4);return new n.QuaternionKeyframeTrack(Q+".quaternion",Je,Ft)}generateMorphTrack(Q){const ye=Q.DeformPercent.curves.morph,ge=ye.values.map(function(Ce){return Ce/100}),xe=p.getObjectByName(Q.modelName).morphTargetDictionary[Q.morphName];return new n.NumberKeyframeTrack(Q.modelName+".morphTargetInfluences["+xe+"]",ye.times,ge)}getTimesForAllAxes(Q){let ye=[];if(Q.x!==void 0&&(ye=ye.concat(Q.x.times)),Q.y!==void 0&&(ye=ye.concat(Q.y.times)),Q.z!==void 0&&(ye=ye.concat(Q.z.times)),ye=ye.sort(function(ge,xe){return ge-xe}),ye.length>1){let ge=1,xe=ye[0];for(let Ce=1;Ce<ye.length;Ce++){const tt=ye[Ce];tt!==xe&&(ye[ge]=tt,xe=tt,ge++)}ye=ye.slice(0,ge)}return ye}getKeyframeTrackValues(Q,ye,ge){const xe=ge,Ce=[];let tt=-1,Je=-1,rt=-1;return Q.forEach(function(Ut){if(ye.x&&(tt=ye.x.times.indexOf(Ut)),ye.y&&(Je=ye.y.times.indexOf(Ut)),ye.z&&(rt=ye.z.times.indexOf(Ut)),tt!==-1){const ht=ye.x.values[tt];Ce.push(ht),xe[0]=ht}else Ce.push(xe[0]);if(Je!==-1){const ht=ye.y.values[Je];Ce.push(ht),xe[1]=ht}else Ce.push(xe[1]);if(rt!==-1){const ht=ye.z.values[rt];Ce.push(ht),xe[2]=ht}else Ce.push(xe[2])}),Ce}interpolateRotations(Q){for(let ye=1;ye<Q.values.length;ye++){const ge=Q.values[ye-1],xe=Q.values[ye]-ge,Ce=Math.abs(xe);if(Ce>=180){const tt=Ce/180,Je=xe/tt;let rt=ge+Je;const Ut=Q.times[ye-1],Ft=(Q.times[ye]-Ut)/tt;let Nn=Ut+Ft;const zn=[],rr=[];for(;Nn<Q.times[ye];)zn.push(Nn),Nn+=Ft,rr.push(rt),rt+=Je;Q.times=qe(Q.times,ye,zn),Q.values=qe(Q.values,ye,rr)}}}}class O{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(Q){this.nodeStack.push(Q),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(Q,ye){this.currentProp=Q,this.currentPropName=ye}parse(Q){this.currentIndent=0,this.allNodes=new Y,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const ye=this,ge=Q.split(/[\r\n]+/);return ge.forEach(function(xe,Ce){const tt=xe.match(/^[\s\t]*;/),Je=xe.match(/^[\s\t]*$/);if(tt||Je)return;const rt=xe.match("^\\t{"+ye.currentIndent+"}(\\w+):(.*){",""),Ut=xe.match("^\\t{"+ye.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),ht=xe.match("^\\t{"+(ye.currentIndent-1)+"}}");rt?ye.parseNodeBegin(xe,rt):Ut?ye.parseNodeProperty(xe,Ut,ge[++Ce]):ht?ye.popStack():xe.match(/^[^\s\t}]/)&&ye.parseNodePropertyContinued(xe)}),this.allNodes}parseNodeBegin(Q,ye){const ge=ye[1].trim().replace(/^"/,"").replace(/"$/,""),xe=ye[2].split(",").map(function(rt){return rt.trim().replace(/^"/,"").replace(/"$/,"")}),Ce={name:ge},tt=this.parseNodeAttr(xe),Je=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(ge,Ce):ge in Je?(ge==="PoseNode"?Je.PoseNode.push(Ce):Je[ge].id!==void 0&&(Je[ge]={},Je[ge][Je[ge].id]=Je[ge]),tt.id!==""&&(Je[ge][tt.id]=Ce)):typeof tt.id=="number"?(Je[ge]={},Je[ge][tt.id]=Ce):ge!=="Properties70"&&(ge==="PoseNode"?Je[ge]=[Ce]:Je[ge]=Ce),typeof tt.id=="number"&&(Ce.id=tt.id),tt.name!==""&&(Ce.attrName=tt.name),tt.type!==""&&(Ce.attrType=tt.type),this.pushStack(Ce)}parseNodeAttr(Q){let ye=Q[0];Q[0]!==""&&(ye=parseInt(Q[0]),isNaN(ye)&&(ye=Q[0]));let ge="",xe="";return Q.length>1&&(ge=Q[1].replace(/^(\w+)::/,""),xe=Q[2]),{id:ye,name:ge,type:xe}}parseNodeProperty(Q,ye,ge){let xe=ye[1].replace(/^"/,"").replace(/"$/,"").trim(),Ce=ye[2].replace(/^"/,"").replace(/"$/,"").trim();xe==="Content"&&Ce===","&&(Ce=ge.replace(/"/g,"").replace(/,$/,"").trim());const tt=this.getCurrentNode();if(tt.name==="Properties70"){this.parseNodeSpecialProperty(Q,xe,Ce);return}if(xe==="C"){const rt=Ce.split(",").slice(1),Ut=parseInt(rt[0]),ht=parseInt(rt[1]);let Ft=Ce.split(",").slice(3);Ft=Ft.map(function(Nn){return Nn.trim().replace(/^"/,"")}),xe="connections",Ce=[Ut,ht],Ot(Ce,Ft),tt[xe]===void 0&&(tt[xe]=[])}xe==="Node"&&(tt.id=Ce),xe in tt&&Array.isArray(tt[xe])?tt[xe].push(Ce):xe!=="a"?tt[xe]=Ce:tt.a=Ce,this.setCurrentProp(tt,xe),xe==="a"&&Ce.slice(-1)!==","&&(tt.a=mt(Ce))}parseNodePropertyContinued(Q){const ye=this.getCurrentNode();ye.a+=Q,Q.slice(-1)!==","&&(ye.a=mt(ye.a))}parseNodeSpecialProperty(Q,ye,ge){const xe=ge.split('",').map(function(ht){return ht.trim().replace(/^\"/,"").replace(/\s/,"_")}),Ce=xe[0],tt=xe[1],Je=xe[2],rt=xe[3];let Ut=xe[4];switch(tt){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":Ut=parseFloat(Ut);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":Ut=mt(Ut);break}this.getPrevNode()[Ce]={type:tt,type2:Je,flag:rt,value:Ut},this.setCurrentProp(this.getPrevNode(),Ce)}}class j{parse(Q){const ye=new $(Q);ye.skip(23);const ge=ye.getUint32();if(ge<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+ge);const xe=new Y;for(;!this.endOfContent(ye);){const Ce=this.parseNode(ye,ge);Ce!==null&&xe.add(Ce.name,Ce)}return xe}endOfContent(Q){return Q.size()%16===0?(Q.getOffset()+160+16&-16)>=Q.size():Q.getOffset()+160+16>=Q.size()}parseNode(Q,ye){const ge={},xe=ye>=7500?Q.getUint64():Q.getUint32(),Ce=ye>=7500?Q.getUint64():Q.getUint32();ye>=7500?Q.getUint64():Q.getUint32();const tt=Q.getUint8(),Je=Q.getString(tt);if(xe===0)return null;const rt=[];for(let Nn=0;Nn<Ce;Nn++)rt.push(this.parseProperty(Q));const Ut=rt.length>0?rt[0]:"",ht=rt.length>1?rt[1]:"",Ft=rt.length>2?rt[2]:"";for(ge.singleProperty=Ce===1&&Q.getOffset()===xe;xe>Q.getOffset();){const Nn=this.parseNode(Q,ye);Nn!==null&&this.parseSubNode(Je,ge,Nn)}return ge.propertyList=rt,typeof Ut=="number"&&(ge.id=Ut),ht!==""&&(ge.attrName=ht),Ft!==""&&(ge.attrType=Ft),Je!==""&&(ge.name=Je),ge}parseSubNode(Q,ye,ge){if(ge.singleProperty===!0){const xe=ge.propertyList[0];Array.isArray(xe)?(ye[ge.name]=ge,ge.a=xe):ye[ge.name]=xe}else if(Q==="Connections"&&ge.name==="C"){const xe=[];ge.propertyList.forEach(function(Ce,tt){tt!==0&&xe.push(Ce)}),ye.connections===void 0&&(ye.connections=[]),ye.connections.push(xe)}else if(ge.name==="Properties70")Object.keys(ge).forEach(function(Ce){ye[Ce]=ge[Ce]});else if(Q==="Properties70"&&ge.name==="P"){let xe=ge.propertyList[0],Ce=ge.propertyList[1];const tt=ge.propertyList[2],Je=ge.propertyList[3];let rt;xe.indexOf("Lcl ")===0&&(xe=xe.replace("Lcl ","Lcl_")),Ce.indexOf("Lcl ")===0&&(Ce=Ce.replace("Lcl ","Lcl_")),Ce==="Color"||Ce==="ColorRGB"||Ce==="Vector"||Ce==="Vector3D"||Ce.indexOf("Lcl_")===0?rt=[ge.propertyList[4],ge.propertyList[5],ge.propertyList[6]]:rt=ge.propertyList[4],ye[xe]={type:Ce,type2:tt,flag:Je,value:rt}}else ye[ge.name]===void 0?typeof ge.id=="number"?(ye[ge.name]={},ye[ge.name][ge.id]=ge):ye[ge.name]=ge:ge.name==="PoseNode"?(Array.isArray(ye[ge.name])||(ye[ge.name]=[ye[ge.name]]),ye[ge.name].push(ge)):ye[ge.name][ge.id]===void 0&&(ye[ge.name][ge.id]=ge)}parseProperty(Q){const ye=Q.getString(1);let ge;switch(ye){case"C":return Q.getBoolean();case"D":return Q.getFloat64();case"F":return Q.getFloat32();case"I":return Q.getInt32();case"L":return Q.getInt64();case"R":return ge=Q.getUint32(),Q.getArrayBuffer(ge);case"S":return ge=Q.getUint32(),Q.getString(ge);case"Y":return Q.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const xe=Q.getUint32(),Ce=Q.getUint32(),tt=Q.getUint32();if(Ce===0)switch(ye){case"b":case"c":return Q.getBooleanArray(xe);case"d":return Q.getFloat64Array(xe);case"f":return Q.getFloat32Array(xe);case"i":return Q.getInt32Array(xe);case"l":return Q.getInt64Array(xe)}typeof r>"u"&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const Je=r.unzlibSync(new Uint8Array(Q.getArrayBuffer(tt))),rt=new $(Je.buffer);switch(ye){case"b":case"c":return rt.getBooleanArray(xe);case"d":return rt.getFloat64Array(xe);case"f":return rt.getFloat32Array(xe);case"i":return rt.getInt32Array(xe);case"l":return rt.getInt64Array(xe)}default:throw new Error("THREE.FBXLoader: Unknown property type "+ye)}}}class ${constructor(Q,ye){this.dv=new DataView(Q),this.offset=0,this.littleEndian=ye!==void 0?ye:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(Q){this.offset+=Q}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(Q){const ye=[];for(let ge=0;ge<Q;ge++)ye.push(this.getBoolean());return ye}getUint8(){const Q=this.dv.getUint8(this.offset);return this.offset+=1,Q}getInt16(){const Q=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,Q}getInt32(){const Q=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,Q}getInt32Array(Q){const ye=[];for(let ge=0;ge<Q;ge++)ye.push(this.getInt32());return ye}getUint32(){const Q=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,Q}getInt64(){let Q,ye;return this.littleEndian?(Q=this.getUint32(),ye=this.getUint32()):(ye=this.getUint32(),Q=this.getUint32()),ye&2147483648?(ye=~ye&4294967295,Q=~Q&4294967295,Q===4294967295&&(ye=ye+1&4294967295),Q=Q+1&4294967295,-(ye*4294967296+Q)):ye*4294967296+Q}getInt64Array(Q){const ye=[];for(let ge=0;ge<Q;ge++)ye.push(this.getInt64());return ye}getUint64(){let Q,ye;return this.littleEndian?(Q=this.getUint32(),ye=this.getUint32()):(ye=this.getUint32(),Q=this.getUint32()),ye*4294967296+Q}getFloat32(){const Q=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,Q}getFloat32Array(Q){const ye=[];for(let ge=0;ge<Q;ge++)ye.push(this.getFloat32());return ye}getFloat64(){const Q=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,Q}getFloat64Array(Q){const ye=[];for(let ge=0;ge<Q;ge++)ye.push(this.getFloat64());return ye}getArrayBuffer(Q){const ye=this.dv.buffer.slice(this.offset,this.offset+Q);return this.offset+=Q,ye}getString(Q){let ye=[];for(let xe=0;xe<Q;xe++)ye[xe]=this.getUint8();const ge=ye.indexOf(0);return ge>=0&&(ye=ye.slice(0,ge)),n.LoaderUtils.decodeText(new Uint8Array(ye))}}class Y{add(Q,ye){this[Q]=ye}}function re(et){const Q="Kaydara FBX Binary  \0";return et.byteLength>=Q.length&&Q===We(et,0,Q.length)}function _e(et){const Q=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let ye=0;function ge(xe){const Ce=et[xe-1];return et=et.slice(ye+xe),ye++,Ce}for(let xe=0;xe<Q.length;++xe)if(ge(1)===Q[xe])return!1;return!0}function J(et){const Q=/FBXVersion: (\d+)/,ye=et.match(Q);if(ye)return parseInt(ye[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function H(et){return et/46186158e3}const te=[];function ce(et,Q,ye,ge){let xe;switch(ge.mappingType){case"ByPolygonVertex":xe=et;break;case"ByPolygon":xe=Q;break;case"ByVertice":xe=ye;break;case"AllSame":xe=ge.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+ge.mappingType)}ge.referenceType==="IndexToDirect"&&(xe=ge.indices[xe]);const Ce=xe*ge.dataSize,tt=Ce+ge.dataSize;return st(te,ge.buffer,Ce,tt)}const Se=new n.Euler,Ie=new n.Vector3;function Ne(et){const Q=new n.Matrix4,ye=new n.Matrix4,ge=new n.Matrix4,xe=new n.Matrix4,Ce=new n.Matrix4,tt=new n.Matrix4,Je=new n.Matrix4,rt=new n.Matrix4,Ut=new n.Matrix4,ht=new n.Matrix4,Ft=new n.Matrix4,Nn=new n.Matrix4,zn=et.inheritType?et.inheritType:0;if(et.translation&&Q.setPosition(Ie.fromArray(et.translation)),et.preRotation){const gt=et.preRotation.map(n.MathUtils.degToRad);gt.push(et.eulerOrder),ye.makeRotationFromEuler(Se.fromArray(gt))}if(et.rotation){const gt=et.rotation.map(n.MathUtils.degToRad);gt.push(et.eulerOrder),ge.makeRotationFromEuler(Se.fromArray(gt))}if(et.postRotation){const gt=et.postRotation.map(n.MathUtils.degToRad);gt.push(et.eulerOrder),xe.makeRotationFromEuler(Se.fromArray(gt)),xe.invert()}et.scale&&Ce.scale(Ie.fromArray(et.scale)),et.scalingOffset&&Je.setPosition(Ie.fromArray(et.scalingOffset)),et.scalingPivot&&tt.setPosition(Ie.fromArray(et.scalingPivot)),et.rotationOffset&&rt.setPosition(Ie.fromArray(et.rotationOffset)),et.rotationPivot&&Ut.setPosition(Ie.fromArray(et.rotationPivot)),et.parentMatrixWorld&&(Ft.copy(et.parentMatrix),ht.copy(et.parentMatrixWorld));const rr=ye.clone().multiply(ge).multiply(xe),Gr=new n.Matrix4;Gr.extractRotation(ht);const Li=new n.Matrix4;Li.copyPosition(ht);const wi=Li.clone().invert().multiply(ht),Nr=Gr.clone().invert().multiply(wi),fi=Ce,Mi=new n.Matrix4;if(zn===0)Mi.copy(Gr).multiply(rr).multiply(Nr).multiply(fi);else if(zn===1)Mi.copy(Gr).multiply(Nr).multiply(rr).multiply(fi);else{const St=new n.Matrix4().scale(new n.Vector3().setFromMatrixScale(Ft)).clone().invert(),Rt=Nr.clone().multiply(St);Mi.copy(Gr).multiply(rr).multiply(Rt).multiply(fi)}const jn=Ut.clone().invert(),Be=tt.clone().invert();let ze=Q.clone().multiply(rt).multiply(Ut).multiply(ye).multiply(ge).multiply(xe).multiply(jn).multiply(Je).multiply(tt).multiply(Ce).multiply(Be);const vt=new n.Matrix4().copyPosition(ze),Qe=ht.clone().multiply(vt);return Nn.copyPosition(Qe),ze=Nn.clone().multiply(Mi),ze.premultiply(ht.invert()),ze}function ut(et){et=et||0;const Q=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return et===6?(console.warn("THREE.FBXLoader: unsupported THREE.Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),Q[0]):Q[et]}function mt(et){return et.split(",").map(function(ye){return parseFloat(ye)})}function We(et,Q,ye){return Q===void 0&&(Q=0),ye===void 0&&(ye=et.byteLength),n.LoaderUtils.decodeText(new Uint8Array(et,Q,ye))}function Ot(et,Q){for(let ye=0,ge=et.length,xe=Q.length;ye<xe;ye++,ge++)et[ge]=Q[ye]}function st(et,Q,ye,ge){for(let xe=ye,Ce=0;xe<ge;xe++,Ce++)et[Ce]=Q[xe];return et}function qe(et,Q,ye){return et.slice(0,Q).concat(ye).concat(et.slice(Q))}n.FBXLoader=g})(),t.exports=n.FBXLoader})(jV);var _re=jV.exports,VV={exports:{}};(function(t,e){const n=ju;(function(){class r extends n.Loader{constructor(Be){super(Be),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ze){return new l(ze)}),this.register(function(ze){return new $(ze)}),this.register(function(ze){return new Y(ze)}),this.register(function(ze){return new E(ze)}),this.register(function(ze){return new P(ze)}),this.register(function(ze){return new O(ze)}),this.register(function(ze){return new j(ze)}),this.register(function(ze){return new p(ze)}),this.register(function(ze){return new re(ze)})}load(Be,ze,vt,Qe){const gt=this;let St;this.resourcePath!==""?St=this.resourcePath:this.path!==""?St=this.path:St=n.LoaderUtils.extractUrlBase(Be),this.manager.itemStart(Be);const Rt=function(en){Qe?Qe(en):console.error(en),gt.manager.itemError(Be),gt.manager.itemEnd(Be)},At=new n.FileLoader(this.manager);At.setPath(this.path),At.setResponseType("arraybuffer"),At.setRequestHeader(this.requestHeader),At.setWithCredentials(this.withCredentials),At.load(Be,function(en){try{gt.parse(en,St,function(On){ze(On),gt.manager.itemEnd(Be)},Rt)}catch(On){Rt(On)}},vt,Rt)}setDRACOLoader(Be){return this.dracoLoader=Be,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(Be){return this.ktx2Loader=Be,this}setMeshoptDecoder(Be){return this.meshoptDecoder=Be,this}register(Be){return this.pluginCallbacks.indexOf(Be)===-1&&this.pluginCallbacks.push(Be),this}unregister(Be){return this.pluginCallbacks.indexOf(Be)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(Be),1),this}parse(Be,ze,vt,Qe){let gt;const St={},Rt={};if(typeof Be=="string")gt=Be;else if(n.LoaderUtils.decodeText(new Uint8Array(Be,0,4))===_e){try{St[u.KHR_BINARY_GLTF]=new te(Be)}catch(qn){Qe&&Qe(qn);return}gt=St[u.KHR_BINARY_GLTF].content}else gt=n.LoaderUtils.decodeText(new Uint8Array(Be));const At=JSON.parse(gt);if(At.asset===void 0||At.asset.version[0]<2){Qe&&Qe(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const en=new Li(At,{path:ze||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});en.fileLoader.setRequestHeader(this.requestHeader);for(let On=0;On<this.pluginCallbacks.length;On++){const qn=this.pluginCallbacks[On](en);Rt[qn.name]=qn,St[qn.name]=!0}if(At.extensionsUsed)for(let On=0;On<At.extensionsUsed.length;++On){const qn=At.extensionsUsed[On],Er=At.extensionsRequired||[];switch(qn){case u.KHR_MATERIALS_UNLIT:St[qn]=new g;break;case u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:St[qn]=new Ne;break;case u.KHR_DRACO_MESH_COMPRESSION:St[qn]=new ce(At,this.dracoLoader);break;case u.KHR_TEXTURE_TRANSFORM:St[qn]=new Se;break;case u.KHR_MESH_QUANTIZATION:St[qn]=new ut;break;default:Er.indexOf(qn)>=0&&Rt[qn]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+qn+'".')}}en.setExtensions(St),en.setPlugins(Rt),en.parse(vt,Qe)}}function s(){let jn={};return{get:function(Be){return jn[Be]},add:function(Be,ze){jn[Be]=ze},remove:function(Be){delete jn[Be]},removeAll:function(){jn={}}}}const u={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class p{constructor(Be){this.parser=Be,this.name=u.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const Be=this.parser,ze=this.parser.json.nodes||[];for(let vt=0,Qe=ze.length;vt<Qe;vt++){const gt=ze[vt];gt.extensions&&gt.extensions[this.name]&&gt.extensions[this.name].light!==void 0&&Be._addNodeRef(this.cache,gt.extensions[this.name].light)}}_loadLight(Be){const ze=this.parser,vt="light:"+Be;let Qe=ze.cache.get(vt);if(Qe)return Qe;const gt=ze.json,At=((gt.extensions&&gt.extensions[this.name]||{}).lights||[])[Be];let en;const On=new n.Color(16777215);At.color!==void 0&&On.fromArray(At.color);const qn=At.range!==void 0?At.range:0;switch(At.type){case"directional":en=new n.DirectionalLight(On),en.target.position.set(0,0,-1),en.add(en.target);break;case"point":en=new n.PointLight(On),en.distance=qn;break;case"spot":en=new n.SpotLight(On),en.distance=qn,At.spot=At.spot||{},At.spot.innerConeAngle=At.spot.innerConeAngle!==void 0?At.spot.innerConeAngle:0,At.spot.outerConeAngle=At.spot.outerConeAngle!==void 0?At.spot.outerConeAngle:Math.PI/4,en.angle=At.spot.outerConeAngle,en.penumbra=1-At.spot.innerConeAngle/At.spot.outerConeAngle,en.target.position.set(0,0,-1),en.add(en.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+At.type)}return en.position.set(0,0,0),en.decay=2,At.intensity!==void 0&&(en.intensity=At.intensity),en.name=ze.createUniqueName(At.name||"light_"+Be),Qe=Promise.resolve(en),ze.cache.add(vt,Qe),Qe}createNodeAttachment(Be){const ze=this,vt=this.parser,gt=vt.json.nodes[Be],Rt=(gt.extensions&&gt.extensions[this.name]||{}).light;return Rt===void 0?null:this._loadLight(Rt).then(function(At){return vt._getNodeRef(ze.cache,Rt,At)})}}class g{constructor(){this.name=u.KHR_MATERIALS_UNLIT}getMaterialType(){return n.MeshBasicMaterial}extendParams(Be,ze,vt){const Qe=[];Be.color=new n.Color(1,1,1),Be.opacity=1;const gt=ze.pbrMetallicRoughness;if(gt){if(Array.isArray(gt.baseColorFactor)){const St=gt.baseColorFactor;Be.color.fromArray(St),Be.opacity=St[3]}gt.baseColorTexture!==void 0&&Qe.push(vt.assignTexture(Be,"map",gt.baseColorTexture))}return Promise.all(Qe)}}class l{constructor(Be){this.parser=Be,this.name=u.KHR_MATERIALS_CLEARCOAT}getMaterialType(Be){const vt=this.parser.json.materials[Be];return!vt.extensions||!vt.extensions[this.name]?null:n.MeshPhysicalMaterial}extendMaterialParams(Be,ze){const vt=this.parser,Qe=vt.json.materials[Be];if(!Qe.extensions||!Qe.extensions[this.name])return Promise.resolve();const gt=[],St=Qe.extensions[this.name];if(St.clearcoatFactor!==void 0&&(ze.clearcoat=St.clearcoatFactor),St.clearcoatTexture!==void 0&&gt.push(vt.assignTexture(ze,"clearcoatMap",St.clearcoatTexture)),St.clearcoatRoughnessFactor!==void 0&&(ze.clearcoatRoughness=St.clearcoatRoughnessFactor),St.clearcoatRoughnessTexture!==void 0&&gt.push(vt.assignTexture(ze,"clearcoatRoughnessMap",St.clearcoatRoughnessTexture)),St.clearcoatNormalTexture!==void 0&&(gt.push(vt.assignTexture(ze,"clearcoatNormalMap",St.clearcoatNormalTexture)),St.clearcoatNormalTexture.scale!==void 0)){const Rt=St.clearcoatNormalTexture.scale;ze.clearcoatNormalScale=new n.Vector2(Rt,-Rt)}return Promise.all(gt)}}class E{constructor(Be){this.parser=Be,this.name=u.KHR_MATERIALS_TRANSMISSION}getMaterialType(Be){const vt=this.parser.json.materials[Be];return!vt.extensions||!vt.extensions[this.name]?null:n.MeshPhysicalMaterial}extendMaterialParams(Be,ze){const vt=this.parser,Qe=vt.json.materials[Be];if(!Qe.extensions||!Qe.extensions[this.name])return Promise.resolve();const gt=[],St=Qe.extensions[this.name];return St.transmissionFactor!==void 0&&(ze.transmission=St.transmissionFactor),St.transmissionTexture!==void 0&&gt.push(vt.assignTexture(ze,"transmissionMap",St.transmissionTexture)),Promise.all(gt)}}class P{constructor(Be){this.parser=Be,this.name=u.KHR_MATERIALS_VOLUME}getMaterialType(Be){const vt=this.parser.json.materials[Be];return!vt.extensions||!vt.extensions[this.name]?null:n.MeshPhysicalMaterial}extendMaterialParams(Be,ze){const vt=this.parser,Qe=vt.json.materials[Be];if(!Qe.extensions||!Qe.extensions[this.name])return Promise.resolve();const gt=[],St=Qe.extensions[this.name];ze.thickness=St.thicknessFactor!==void 0?St.thicknessFactor:0,St.thicknessTexture!==void 0&&gt.push(vt.assignTexture(ze,"thicknessMap",St.thicknessTexture)),ze.attenuationDistance=St.attenuationDistance||0;const Rt=St.attenuationColor||[1,1,1];return ze.attenuationTint=new n.Color(Rt[0],Rt[1],Rt[2]),Promise.all(gt)}}class O{constructor(Be){this.parser=Be,this.name=u.KHR_MATERIALS_IOR}getMaterialType(Be){const vt=this.parser.json.materials[Be];return!vt.extensions||!vt.extensions[this.name]?null:n.MeshPhysicalMaterial}extendMaterialParams(Be,ze){const Qe=this.parser.json.materials[Be];if(!Qe.extensions||!Qe.extensions[this.name])return Promise.resolve();const gt=Qe.extensions[this.name];return ze.ior=gt.ior!==void 0?gt.ior:1.5,Promise.resolve()}}class j{constructor(Be){this.parser=Be,this.name=u.KHR_MATERIALS_SPECULAR}getMaterialType(Be){const vt=this.parser.json.materials[Be];return!vt.extensions||!vt.extensions[this.name]?null:n.MeshPhysicalMaterial}extendMaterialParams(Be,ze){const vt=this.parser,Qe=vt.json.materials[Be];if(!Qe.extensions||!Qe.extensions[this.name])return Promise.resolve();const gt=[],St=Qe.extensions[this.name];ze.specularIntensity=St.specularFactor!==void 0?St.specularFactor:1,St.specularTexture!==void 0&&gt.push(vt.assignTexture(ze,"specularIntensityMap",St.specularTexture));const Rt=St.specularColorFactor||[1,1,1];return ze.specularTint=new n.Color(Rt[0],Rt[1],Rt[2]),St.specularColorTexture!==void 0&&gt.push(vt.assignTexture(ze,"specularTintMap",St.specularColorTexture).then(function(At){At.encoding=n.sRGBEncoding})),Promise.all(gt)}}class ${constructor(Be){this.parser=Be,this.name=u.KHR_TEXTURE_BASISU}loadTexture(Be){const ze=this.parser,vt=ze.json,Qe=vt.textures[Be];if(!Qe.extensions||!Qe.extensions[this.name])return null;const gt=Qe.extensions[this.name],St=vt.images[gt.source],Rt=ze.options.ktx2Loader;if(!Rt){if(vt.extensionsRequired&&vt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ze.loadTextureImage(Be,St,Rt)}}class Y{constructor(Be){this.parser=Be,this.name=u.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(Be){const ze=this.name,vt=this.parser,Qe=vt.json,gt=Qe.textures[Be];if(!gt.extensions||!gt.extensions[ze])return null;const St=gt.extensions[ze],Rt=Qe.images[St.source];let At=vt.textureLoader;if(Rt.uri){const en=vt.options.manager.getHandler(Rt.uri);en!==null&&(At=en)}return this.detectSupport().then(function(en){if(en)return vt.loadTextureImage(Be,Rt,At);if(Qe.extensionsRequired&&Qe.extensionsRequired.indexOf(ze)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return vt.loadTexture(Be)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Be){const ze=new Image;ze.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ze.onload=ze.onerror=function(){Be(ze.height===1)}})),this.isSupported}}class re{constructor(Be){this.name=u.EXT_MESHOPT_COMPRESSION,this.parser=Be}loadBufferView(Be){const ze=this.parser.json,vt=ze.bufferViews[Be];if(vt.extensions&&vt.extensions[this.name]){const Qe=vt.extensions[this.name],gt=this.parser.getDependency("buffer",Qe.buffer),St=this.parser.options.meshoptDecoder;if(!St||!St.supported){if(ze.extensionsRequired&&ze.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([gt,St.ready]).then(function(Rt){const At=Qe.byteOffset||0,en=Qe.byteLength||0,On=Qe.count,qn=Qe.byteStride,Er=new ArrayBuffer(On*qn),Sr=new Uint8Array(Rt[0],At,en);return St.decodeGltfBuffer(new Uint8Array(Er),On,qn,Sr,Qe.mode,Qe.filter),Er})}else return null}}const _e="glTF",J=12,H={JSON:1313821514,BIN:5130562};class te{constructor(Be){this.name=u.KHR_BINARY_GLTF,this.content=null,this.body=null;const ze=new DataView(Be,0,J);if(this.header={magic:n.LoaderUtils.decodeText(new Uint8Array(Be.slice(0,4))),version:ze.getUint32(4,!0),length:ze.getUint32(8,!0)},this.header.magic!==_e)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const vt=this.header.length-J,Qe=new DataView(Be,J);let gt=0;for(;gt<vt;){const St=Qe.getUint32(gt,!0);gt+=4;const Rt=Qe.getUint32(gt,!0);if(gt+=4,Rt===H.JSON){const At=new Uint8Array(Be,J+gt,St);this.content=n.LoaderUtils.decodeText(At)}else if(Rt===H.BIN){const At=J+gt;this.body=Be.slice(At,At+St)}gt+=St}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ce{constructor(Be,ze){if(!ze)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=u.KHR_DRACO_MESH_COMPRESSION,this.json=Be,this.dracoLoader=ze,this.dracoLoader.preload()}decodePrimitive(Be,ze){const vt=this.json,Qe=this.dracoLoader,gt=Be.extensions[this.name].bufferView,St=Be.extensions[this.name].attributes,Rt={},At={},en={};for(const On in St){const qn=ge[On]||On.toLowerCase();Rt[qn]=St[On]}for(const On in Be.attributes){const qn=ge[On]||On.toLowerCase();if(St[On]!==void 0){const Er=vt.accessors[Be.attributes[On]],Sr=qe[Er.componentType];en[qn]=Sr,At[qn]=Er.normalized===!0}}return ze.getDependency("bufferView",gt).then(function(On){return new Promise(function(qn){Qe.decodeDracoFile(On,function(Er){for(const Sr in Er.attributes){const Dr=Er.attributes[Sr],Fr=At[Sr];Fr!==void 0&&(Dr.normalized=Fr)}qn(Er)},Rt,en)})})}}class Se{constructor(){this.name=u.KHR_TEXTURE_TRANSFORM}extendTexture(Be,ze){return ze.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),ze.offset===void 0&&ze.rotation===void 0&&ze.scale===void 0||(Be=Be.clone(),ze.offset!==void 0&&Be.offset.fromArray(ze.offset),ze.rotation!==void 0&&(Be.rotation=ze.rotation),ze.scale!==void 0&&Be.repeat.fromArray(ze.scale),Be.needsUpdate=!0),Be}}class Ie extends n.MeshStandardMaterial{constructor(Be){super(),this.isGLTFSpecularGlossinessMaterial=!0;const ze=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),vt=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),Qe=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),gt=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),St=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),Rt={specular:{value:new n.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Rt,this.onBeforeCompile=function(At){for(const en in Rt)At.uniforms[en]=Rt[en];At.fragmentShader=At.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",ze).replace("#include <metalnessmap_pars_fragment>",vt).replace("#include <roughnessmap_fragment>",Qe).replace("#include <metalnessmap_fragment>",gt).replace("#include <lights_physical_fragment>",St)},Object.defineProperties(this,{specular:{get:function(){return Rt.specular.value},set:function(At){Rt.specular.value=At}},specularMap:{get:function(){return Rt.specularMap.value},set:function(At){Rt.specularMap.value=At,At?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return Rt.glossiness.value},set:function(At){Rt.glossiness.value=At}},glossinessMap:{get:function(){return Rt.glossinessMap.value},set:function(At){Rt.glossinessMap.value=At,At?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(Be)}copy(Be){return super.copy(Be),this.specularMap=Be.specularMap,this.specular.copy(Be.specular),this.glossinessMap=Be.glossinessMap,this.glossiness=Be.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Ne{constructor(){this.name=u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return Ie}extendParams(Be,ze,vt){const Qe=ze.extensions[this.name];Be.color=new n.Color(1,1,1),Be.opacity=1;const gt=[];if(Array.isArray(Qe.diffuseFactor)){const St=Qe.diffuseFactor;Be.color.fromArray(St),Be.opacity=St[3]}if(Qe.diffuseTexture!==void 0&&gt.push(vt.assignTexture(Be,"map",Qe.diffuseTexture)),Be.emissive=new n.Color(0,0,0),Be.glossiness=Qe.glossinessFactor!==void 0?Qe.glossinessFactor:1,Be.specular=new n.Color(1,1,1),Array.isArray(Qe.specularFactor)&&Be.specular.fromArray(Qe.specularFactor),Qe.specularGlossinessTexture!==void 0){const St=Qe.specularGlossinessTexture;gt.push(vt.assignTexture(Be,"glossinessMap",St)),gt.push(vt.assignTexture(Be,"specularMap",St))}return Promise.all(gt)}createMaterial(Be){const ze=new Ie(Be);return ze.fog=!0,ze.color=Be.color,ze.map=Be.map===void 0?null:Be.map,ze.lightMap=null,ze.lightMapIntensity=1,ze.aoMap=Be.aoMap===void 0?null:Be.aoMap,ze.aoMapIntensity=1,ze.emissive=Be.emissive,ze.emissiveIntensity=1,ze.emissiveMap=Be.emissiveMap===void 0?null:Be.emissiveMap,ze.bumpMap=Be.bumpMap===void 0?null:Be.bumpMap,ze.bumpScale=1,ze.normalMap=Be.normalMap===void 0?null:Be.normalMap,ze.normalMapType=n.TangentSpaceNormalMap,Be.normalScale&&(ze.normalScale=Be.normalScale),ze.displacementMap=null,ze.displacementScale=1,ze.displacementBias=0,ze.specularMap=Be.specularMap===void 0?null:Be.specularMap,ze.specular=Be.specular,ze.glossinessMap=Be.glossinessMap===void 0?null:Be.glossinessMap,ze.glossiness=Be.glossiness,ze.alphaMap=null,ze.envMap=Be.envMap===void 0?null:Be.envMap,ze.envMapIntensity=1,ze.refractionRatio=.98,ze}}class ut{constructor(){this.name=u.KHR_MESH_QUANTIZATION}}class mt extends n.Interpolant{constructor(Be,ze,vt,Qe){super(Be,ze,vt,Qe)}copySampleValue_(Be){const ze=this.resultBuffer,vt=this.sampleValues,Qe=this.valueSize,gt=Be*Qe*3+Qe;for(let St=0;St!==Qe;St++)ze[St]=vt[gt+St];return ze}}mt.prototype.beforeStart_=mt.prototype.copySampleValue_,mt.prototype.afterEnd_=mt.prototype.copySampleValue_,mt.prototype.interpolate_=function(jn,Be,ze,vt){const Qe=this.resultBuffer,gt=this.sampleValues,St=this.valueSize,Rt=St*2,At=St*3,en=vt-Be,On=(ze-Be)/en,qn=On*On,Er=qn*On,Sr=jn*At,Dr=Sr-At,Fr=-2*Er+3*qn,Tr=Er-qn,Zr=1-Fr,is=Tr-qn+On;for(let $i=0;$i!==St;$i++){const Xs=gt[Dr+$i+St],vo=gt[Dr+$i+Rt]*en,Vn=gt[Sr+$i+St],Di=gt[Sr+$i]*en;Qe[$i]=Zr*Xs+is*vo+Fr*Vn+Tr*Di}return Qe};const We=new n.Quaternion;class Ot extends mt{interpolate_(Be,ze,vt,Qe){const gt=super.interpolate_(Be,ze,vt,Qe);return We.fromArray(gt).normalize().toArray(gt),gt}}const st={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},qe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},et={9728:n.NearestFilter,9729:n.LinearFilter,9984:n.NearestMipmapNearestFilter,9985:n.LinearMipmapNearestFilter,9986:n.NearestMipmapLinearFilter,9987:n.LinearMipmapLinearFilter},Q={33071:n.ClampToEdgeWrapping,33648:n.MirroredRepeatWrapping,10497:n.RepeatWrapping},ye={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ge={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},xe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ce={CUBICSPLINE:void 0,LINEAR:n.InterpolateLinear,STEP:n.InterpolateDiscrete},tt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Je(jn,Be){return typeof jn!="string"||jn===""?"":(/^https?:\/\//i.test(Be)&&/^\//.test(jn)&&(Be=Be.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(jn)||/^data:.*,.*$/i.test(jn)||/^blob:.*$/i.test(jn)?jn:Be+jn)}function rt(jn){return jn.DefaultMaterial===void 0&&(jn.DefaultMaterial=new n.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.FrontSide})),jn.DefaultMaterial}function Ut(jn,Be,ze){for(const vt in ze.extensions)jn[vt]===void 0&&(Be.userData.gltfExtensions=Be.userData.gltfExtensions||{},Be.userData.gltfExtensions[vt]=ze.extensions[vt])}function ht(jn,Be){Be.extras!==void 0&&(typeof Be.extras=="object"?Object.assign(jn.userData,Be.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+Be.extras))}function Ft(jn,Be,ze){let vt=!1,Qe=!1;for(let Rt=0,At=Be.length;Rt<At;Rt++){const en=Be[Rt];if(en.POSITION!==void 0&&(vt=!0),en.NORMAL!==void 0&&(Qe=!0),vt&&Qe)break}if(!vt&&!Qe)return Promise.resolve(jn);const gt=[],St=[];for(let Rt=0,At=Be.length;Rt<At;Rt++){const en=Be[Rt];if(vt){const On=en.POSITION!==void 0?ze.getDependency("accessor",en.POSITION):jn.attributes.position;gt.push(On)}if(Qe){const On=en.NORMAL!==void 0?ze.getDependency("accessor",en.NORMAL):jn.attributes.normal;St.push(On)}}return Promise.all([Promise.all(gt),Promise.all(St)]).then(function(Rt){const At=Rt[0],en=Rt[1];return vt&&(jn.morphAttributes.position=At),Qe&&(jn.morphAttributes.normal=en),jn.morphTargetsRelative=!0,jn})}function Nn(jn,Be){if(jn.updateMorphTargets(),Be.weights!==void 0)for(let ze=0,vt=Be.weights.length;ze<vt;ze++)jn.morphTargetInfluences[ze]=Be.weights[ze];if(Be.extras&&Array.isArray(Be.extras.targetNames)){const ze=Be.extras.targetNames;if(jn.morphTargetInfluences.length===ze.length){jn.morphTargetDictionary={};for(let vt=0,Qe=ze.length;vt<Qe;vt++)jn.morphTargetDictionary[ze[vt]]=vt}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function zn(jn){const Be=jn.extensions&&jn.extensions[u.KHR_DRACO_MESH_COMPRESSION];let ze;return Be?ze="draco:"+Be.bufferView+":"+Be.indices+":"+rr(Be.attributes):ze=jn.indices+":"+rr(jn.attributes)+":"+jn.mode,ze}function rr(jn){let Be="";const ze=Object.keys(jn).sort();for(let vt=0,Qe=ze.length;vt<Qe;vt++)Be+=ze[vt]+":"+jn[ze[vt]]+";";return Be}function Gr(jn){switch(jn){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class Li{constructor(Be={},ze={}){this.json=Be,this.extensions={},this.plugins={},this.options=ze,this.cache=new s,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new n.ImageBitmapLoader(this.options.manager):this.textureLoader=new n.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(Be){this.extensions=Be}setPlugins(Be){this.plugins=Be}parse(Be,ze){const vt=this,Qe=this.json,gt=this.extensions;this.cache.removeAll(),this._invokeAll(function(St){return St._markDefs&&St._markDefs()}),Promise.all(this._invokeAll(function(St){return St.beforeRoot&&St.beforeRoot()})).then(function(){return Promise.all([vt.getDependencies("scene"),vt.getDependencies("animation"),vt.getDependencies("camera")])}).then(function(St){const Rt={scene:St[0][Qe.scene||0],scenes:St[0],animations:St[1],cameras:St[2],asset:Qe.asset,parser:vt,userData:{}};Ut(gt,Rt,Qe),ht(Rt,Qe),Promise.all(vt._invokeAll(function(At){return At.afterRoot&&At.afterRoot(Rt)})).then(function(){Be(Rt)})}).catch(ze)}_markDefs(){const Be=this.json.nodes||[],ze=this.json.skins||[],vt=this.json.meshes||[];for(let Qe=0,gt=ze.length;Qe<gt;Qe++){const St=ze[Qe].joints;for(let Rt=0,At=St.length;Rt<At;Rt++)Be[St[Rt]].isBone=!0}for(let Qe=0,gt=Be.length;Qe<gt;Qe++){const St=Be[Qe];St.mesh!==void 0&&(this._addNodeRef(this.meshCache,St.mesh),St.skin!==void 0&&(vt[St.mesh].isSkinnedMesh=!0)),St.camera!==void 0&&this._addNodeRef(this.cameraCache,St.camera)}}_addNodeRef(Be,ze){ze!==void 0&&(Be.refs[ze]===void 0&&(Be.refs[ze]=Be.uses[ze]=0),Be.refs[ze]++)}_getNodeRef(Be,ze,vt){if(Be.refs[ze]<=1)return vt;const Qe=vt.clone();return Qe.name+="_instance_"+Be.uses[ze]++,Qe}_invokeOne(Be){const ze=Object.values(this.plugins);ze.push(this);for(let vt=0;vt<ze.length;vt++){const Qe=Be(ze[vt]);if(Qe)return Qe}return null}_invokeAll(Be){const ze=Object.values(this.plugins);ze.unshift(this);const vt=[];for(let Qe=0;Qe<ze.length;Qe++){const gt=Be(ze[Qe]);gt&&vt.push(gt)}return vt}getDependency(Be,ze){const vt=Be+":"+ze;let Qe=this.cache.get(vt);if(!Qe){switch(Be){case"scene":Qe=this.loadScene(ze);break;case"node":Qe=this.loadNode(ze);break;case"mesh":Qe=this._invokeOne(function(gt){return gt.loadMesh&&gt.loadMesh(ze)});break;case"accessor":Qe=this.loadAccessor(ze);break;case"bufferView":Qe=this._invokeOne(function(gt){return gt.loadBufferView&&gt.loadBufferView(ze)});break;case"buffer":Qe=this.loadBuffer(ze);break;case"material":Qe=this._invokeOne(function(gt){return gt.loadMaterial&&gt.loadMaterial(ze)});break;case"texture":Qe=this._invokeOne(function(gt){return gt.loadTexture&&gt.loadTexture(ze)});break;case"skin":Qe=this.loadSkin(ze);break;case"animation":Qe=this.loadAnimation(ze);break;case"camera":Qe=this.loadCamera(ze);break;default:throw new Error("Unknown type: "+Be)}this.cache.add(vt,Qe)}return Qe}getDependencies(Be){let ze=this.cache.get(Be);if(!ze){const vt=this,Qe=this.json[Be+(Be==="mesh"?"es":"s")]||[];ze=Promise.all(Qe.map(function(gt,St){return vt.getDependency(Be,St)})),this.cache.add(Be,ze)}return ze}loadBuffer(Be){const ze=this.json.buffers[Be],vt=this.fileLoader;if(ze.type&&ze.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ze.type+" buffer type is not supported.");if(ze.uri===void 0&&Be===0)return Promise.resolve(this.extensions[u.KHR_BINARY_GLTF].body);const Qe=this.options;return new Promise(function(gt,St){vt.load(Je(ze.uri,Qe.path),gt,void 0,function(){St(new Error('THREE.GLTFLoader: Failed to load buffer "'+ze.uri+'".'))})})}loadBufferView(Be){const ze=this.json.bufferViews[Be];return this.getDependency("buffer",ze.buffer).then(function(vt){const Qe=ze.byteLength||0,gt=ze.byteOffset||0;return vt.slice(gt,gt+Qe)})}loadAccessor(Be){const ze=this,vt=this.json,Qe=this.json.accessors[Be];if(Qe.bufferView===void 0&&Qe.sparse===void 0)return Promise.resolve(null);const gt=[];return Qe.bufferView!==void 0?gt.push(this.getDependency("bufferView",Qe.bufferView)):gt.push(null),Qe.sparse!==void 0&&(gt.push(this.getDependency("bufferView",Qe.sparse.indices.bufferView)),gt.push(this.getDependency("bufferView",Qe.sparse.values.bufferView))),Promise.all(gt).then(function(St){const Rt=St[0],At=ye[Qe.type],en=qe[Qe.componentType],On=en.BYTES_PER_ELEMENT,qn=On*At,Er=Qe.byteOffset||0,Sr=Qe.bufferView!==void 0?vt.bufferViews[Qe.bufferView].byteStride:void 0,Dr=Qe.normalized===!0;let Fr,Tr;if(Sr&&Sr!==qn){const Zr=Math.floor(Er/Sr),is="InterleavedBuffer:"+Qe.bufferView+":"+Qe.componentType+":"+Zr+":"+Qe.count;let $i=ze.cache.get(is);$i||(Fr=new en(Rt,Zr*Sr,Qe.count*Sr/On),$i=new n.InterleavedBuffer(Fr,Sr/On),ze.cache.add(is,$i)),Tr=new n.InterleavedBufferAttribute($i,At,Er%Sr/On,Dr)}else Rt===null?Fr=new en(Qe.count*At):Fr=new en(Rt,Er,Qe.count*At),Tr=new n.BufferAttribute(Fr,At,Dr);if(Qe.sparse!==void 0){const Zr=ye.SCALAR,is=qe[Qe.sparse.indices.componentType],$i=Qe.sparse.indices.byteOffset||0,Xs=Qe.sparse.values.byteOffset||0,vo=new is(St[1],$i,Qe.sparse.count*Zr),Vn=new en(St[2],Xs,Qe.sparse.count*At);Rt!==null&&(Tr=new n.BufferAttribute(Tr.array.slice(),Tr.itemSize,Tr.normalized));for(let Di=0,Ps=vo.length;Di<Ps;Di++){const ct=vo[Di];if(Tr.setX(ct,Vn[Di*At]),At>=2&&Tr.setY(ct,Vn[Di*At+1]),At>=3&&Tr.setZ(ct,Vn[Di*At+2]),At>=4&&Tr.setW(ct,Vn[Di*At+3]),At>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse THREE.BufferAttribute.")}}return Tr})}loadTexture(Be){const ze=this.json,vt=this.options,Qe=ze.textures[Be],gt=ze.images[Qe.source];let St=this.textureLoader;if(gt.uri){const Rt=vt.manager.getHandler(gt.uri);Rt!==null&&(St=Rt)}return this.loadTextureImage(Be,gt,St)}loadTextureImage(Be,ze,vt){const Qe=this,gt=this.json,St=this.options,Rt=gt.textures[Be],At=(ze.uri||ze.bufferView)+":"+Rt.sampler;if(this.textureCache[At])return this.textureCache[At];const en=self.URL||self.webkitURL;let On=ze.uri||"",qn=!1,Er=!0;const Sr=On.search(/\.jpe?g($|\?)/i)>0||On.search(/^data\:image\/jpeg/)===0;if((ze.mimeType==="image/jpeg"||Sr)&&(Er=!1),ze.bufferView!==void 0)On=Qe.getDependency("bufferView",ze.bufferView).then(function(Fr){if(ze.mimeType==="image/png"){const Zr=new DataView(Fr,25,1).getUint8(0,!1);Er=Zr===6||Zr===4||Zr===3}qn=!0;const Tr=new Blob([Fr],{type:ze.mimeType});return On=en.createObjectURL(Tr),On});else if(ze.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+Be+" is missing URI and bufferView");const Dr=Promise.resolve(On).then(function(Fr){return new Promise(function(Tr,Zr){let is=Tr;vt.isImageBitmapLoader===!0&&(is=function($i){const Xs=new n.Texture($i);Xs.needsUpdate=!0,Tr(Xs)}),vt.load(Je(Fr,St.path),is,void 0,Zr)})}).then(function(Fr){qn===!0&&en.revokeObjectURL(On),Fr.flipY=!1,Rt.name&&(Fr.name=Rt.name),Er||(Fr.format=n.RGBFormat);const Zr=(gt.samplers||{})[Rt.sampler]||{};return Fr.magFilter=et[Zr.magFilter]||n.LinearFilter,Fr.minFilter=et[Zr.minFilter]||n.LinearMipmapLinearFilter,Fr.wrapS=Q[Zr.wrapS]||n.RepeatWrapping,Fr.wrapT=Q[Zr.wrapT]||n.RepeatWrapping,Qe.associations.set(Fr,{type:"textures",index:Be}),Fr}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",On),null});return this.textureCache[At]=Dr,Dr}assignTexture(Be,ze,vt){const Qe=this;return this.getDependency("texture",vt.index).then(function(gt){if(vt.texCoord!==void 0&&vt.texCoord!=0&&!(ze==="aoMap"&&vt.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+vt.texCoord+" for texture "+ze+" not yet supported."),Qe.extensions[u.KHR_TEXTURE_TRANSFORM]){const St=vt.extensions!==void 0?vt.extensions[u.KHR_TEXTURE_TRANSFORM]:void 0;if(St){const Rt=Qe.associations.get(gt);gt=Qe.extensions[u.KHR_TEXTURE_TRANSFORM].extendTexture(gt,St),Qe.associations.set(gt,Rt)}}return Be[ze]=gt,gt})}assignFinalMaterial(Be){const ze=Be.geometry;let vt=Be.material;const Qe=ze.attributes.tangent!==void 0,gt=ze.attributes.color!==void 0,St=ze.attributes.normal===void 0;if(Be.isPoints){const Rt="PointsMaterial:"+vt.uuid;let At=this.cache.get(Rt);At||(At=new n.PointsMaterial,n.Material.prototype.copy.call(At,vt),At.color.copy(vt.color),At.map=vt.map,At.sizeAttenuation=!1,this.cache.add(Rt,At)),vt=At}else if(Be.isLine){const Rt="LineBasicMaterial:"+vt.uuid;let At=this.cache.get(Rt);At||(At=new n.LineBasicMaterial,n.Material.prototype.copy.call(At,vt),At.color.copy(vt.color),this.cache.add(Rt,At)),vt=At}if(Qe||gt||St){let Rt="ClonedMaterial:"+vt.uuid+":";vt.isGLTFSpecularGlossinessMaterial&&(Rt+="specular-glossiness:"),Qe&&(Rt+="vertex-tangents:"),gt&&(Rt+="vertex-colors:"),St&&(Rt+="flat-shading:");let At=this.cache.get(Rt);At||(At=vt.clone(),gt&&(At.vertexColors=!0),St&&(At.flatShading=!0),Qe&&(At.normalScale&&(At.normalScale.y*=-1),At.clearcoatNormalScale&&(At.clearcoatNormalScale.y*=-1)),this.cache.add(Rt,At),this.associations.set(At,this.associations.get(vt))),vt=At}vt.aoMap&&ze.attributes.uv2===void 0&&ze.attributes.uv!==void 0&&ze.setAttribute("uv2",ze.attributes.uv),Be.material=vt}getMaterialType(){return n.MeshStandardMaterial}loadMaterial(Be){const ze=this,vt=this.json,Qe=this.extensions,gt=vt.materials[Be];let St;const Rt={},At=gt.extensions||{},en=[];if(At[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const qn=Qe[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];St=qn.getMaterialType(),en.push(qn.extendParams(Rt,gt,ze))}else if(At[u.KHR_MATERIALS_UNLIT]){const qn=Qe[u.KHR_MATERIALS_UNLIT];St=qn.getMaterialType(),en.push(qn.extendParams(Rt,gt,ze))}else{const qn=gt.pbrMetallicRoughness||{};if(Rt.color=new n.Color(1,1,1),Rt.opacity=1,Array.isArray(qn.baseColorFactor)){const Er=qn.baseColorFactor;Rt.color.fromArray(Er),Rt.opacity=Er[3]}qn.baseColorTexture!==void 0&&en.push(ze.assignTexture(Rt,"map",qn.baseColorTexture)),Rt.metalness=qn.metallicFactor!==void 0?qn.metallicFactor:1,Rt.roughness=qn.roughnessFactor!==void 0?qn.roughnessFactor:1,qn.metallicRoughnessTexture!==void 0&&(en.push(ze.assignTexture(Rt,"metalnessMap",qn.metallicRoughnessTexture)),en.push(ze.assignTexture(Rt,"roughnessMap",qn.metallicRoughnessTexture))),St=this._invokeOne(function(Er){return Er.getMaterialType&&Er.getMaterialType(Be)}),en.push(Promise.all(this._invokeAll(function(Er){return Er.extendMaterialParams&&Er.extendMaterialParams(Be,Rt)})))}gt.doubleSided===!0&&(Rt.side=n.DoubleSide);const On=gt.alphaMode||tt.OPAQUE;return On===tt.BLEND?(Rt.transparent=!0,Rt.depthWrite=!1):(Rt.format=n.RGBFormat,Rt.transparent=!1,On===tt.MASK&&(Rt.alphaTest=gt.alphaCutoff!==void 0?gt.alphaCutoff:.5)),gt.normalTexture!==void 0&&St!==n.MeshBasicMaterial&&(en.push(ze.assignTexture(Rt,"normalMap",gt.normalTexture)),Rt.normalScale=new n.Vector2(1,-1),gt.normalTexture.scale!==void 0&&Rt.normalScale.set(gt.normalTexture.scale,-gt.normalTexture.scale)),gt.occlusionTexture!==void 0&&St!==n.MeshBasicMaterial&&(en.push(ze.assignTexture(Rt,"aoMap",gt.occlusionTexture)),gt.occlusionTexture.strength!==void 0&&(Rt.aoMapIntensity=gt.occlusionTexture.strength)),gt.emissiveFactor!==void 0&&St!==n.MeshBasicMaterial&&(Rt.emissive=new n.Color().fromArray(gt.emissiveFactor)),gt.emissiveTexture!==void 0&&St!==n.MeshBasicMaterial&&en.push(ze.assignTexture(Rt,"emissiveMap",gt.emissiveTexture)),Promise.all(en).then(function(){let qn;return St===Ie?qn=Qe[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Rt):qn=new St(Rt),gt.name&&(qn.name=gt.name),qn.map&&(qn.map.encoding=n.sRGBEncoding),qn.emissiveMap&&(qn.emissiveMap.encoding=n.sRGBEncoding),ht(qn,gt),ze.associations.set(qn,{type:"materials",index:Be}),gt.extensions&&Ut(Qe,qn,gt),qn})}createUniqueName(Be){const ze=n.PropertyBinding.sanitizeNodeName(Be||"");let vt=ze;for(let Qe=1;this.nodeNamesUsed[vt];++Qe)vt=ze+"_"+Qe;return this.nodeNamesUsed[vt]=!0,vt}loadGeometries(Be){const ze=this,vt=this.extensions,Qe=this.primitiveCache;function gt(Rt){return vt[u.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Rt,ze).then(function(At){return fi(At,Rt,ze)})}const St=[];for(let Rt=0,At=Be.length;Rt<At;Rt++){const en=Be[Rt],On=zn(en),qn=Qe[On];if(qn)St.push(qn.promise);else{let Er;en.extensions&&en.extensions[u.KHR_DRACO_MESH_COMPRESSION]?Er=gt(en):Er=fi(new n.BufferGeometry,en,ze),Qe[On]={primitive:en,promise:Er},St.push(Er)}}return Promise.all(St)}loadMesh(Be){const ze=this,vt=this.json,Qe=this.extensions,gt=vt.meshes[Be],St=gt.primitives,Rt=[];for(let At=0,en=St.length;At<en;At++){const On=St[At].material===void 0?rt(this.cache):this.getDependency("material",St[At].material);Rt.push(On)}return Rt.push(ze.loadGeometries(St)),Promise.all(Rt).then(function(At){const en=At.slice(0,At.length-1),On=At[At.length-1],qn=[];for(let Sr=0,Dr=On.length;Sr<Dr;Sr++){const Fr=On[Sr],Tr=St[Sr];let Zr;const is=en[Sr];if(Tr.mode===st.TRIANGLES||Tr.mode===st.TRIANGLE_STRIP||Tr.mode===st.TRIANGLE_FAN||Tr.mode===void 0)Zr=gt.isSkinnedMesh===!0?new n.SkinnedMesh(Fr,is):new n.Mesh(Fr,is),Zr.isSkinnedMesh===!0&&!Zr.geometry.attributes.skinWeight.normalized&&Zr.normalizeSkinWeights(),Tr.mode===st.TRIANGLE_STRIP?Zr.geometry=Mi(Zr.geometry,n.TriangleStripDrawMode):Tr.mode===st.TRIANGLE_FAN&&(Zr.geometry=Mi(Zr.geometry,n.TriangleFanDrawMode));else if(Tr.mode===st.LINES)Zr=new n.LineSegments(Fr,is);else if(Tr.mode===st.LINE_STRIP)Zr=new n.Line(Fr,is);else if(Tr.mode===st.LINE_LOOP)Zr=new n.LineLoop(Fr,is);else if(Tr.mode===st.POINTS)Zr=new n.Points(Fr,is);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Tr.mode);Object.keys(Zr.geometry.morphAttributes).length>0&&Nn(Zr,gt),Zr.name=ze.createUniqueName(gt.name||"mesh_"+Be),ht(Zr,gt),Tr.extensions&&Ut(Qe,Zr,Tr),ze.assignFinalMaterial(Zr),qn.push(Zr)}if(qn.length===1)return qn[0];const Er=new n.Group;for(let Sr=0,Dr=qn.length;Sr<Dr;Sr++)Er.add(qn[Sr]);return Er})}loadCamera(Be){let ze;const vt=this.json.cameras[Be],Qe=vt[vt.type];if(!Qe){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return vt.type==="perspective"?ze=new n.PerspectiveCamera(n.MathUtils.radToDeg(Qe.yfov),Qe.aspectRatio||1,Qe.znear||1,Qe.zfar||2e6):vt.type==="orthographic"&&(ze=new n.OrthographicCamera(-Qe.xmag,Qe.xmag,Qe.ymag,-Qe.ymag,Qe.znear,Qe.zfar)),vt.name&&(ze.name=this.createUniqueName(vt.name)),ht(ze,vt),Promise.resolve(ze)}loadSkin(Be){const ze=this.json.skins[Be],vt={joints:ze.joints};return ze.inverseBindMatrices===void 0?Promise.resolve(vt):this.getDependency("accessor",ze.inverseBindMatrices).then(function(Qe){return vt.inverseBindMatrices=Qe,vt})}loadAnimation(Be){const vt=this.json.animations[Be],Qe=[],gt=[],St=[],Rt=[],At=[];for(let en=0,On=vt.channels.length;en<On;en++){const qn=vt.channels[en],Er=vt.samplers[qn.sampler],Sr=qn.target,Dr=Sr.node!==void 0?Sr.node:Sr.id,Fr=vt.parameters!==void 0?vt.parameters[Er.input]:Er.input,Tr=vt.parameters!==void 0?vt.parameters[Er.output]:Er.output;Qe.push(this.getDependency("node",Dr)),gt.push(this.getDependency("accessor",Fr)),St.push(this.getDependency("accessor",Tr)),Rt.push(Er),At.push(Sr)}return Promise.all([Promise.all(Qe),Promise.all(gt),Promise.all(St),Promise.all(Rt),Promise.all(At)]).then(function(en){const On=en[0],qn=en[1],Er=en[2],Sr=en[3],Dr=en[4],Fr=[];for(let Zr=0,is=On.length;Zr<is;Zr++){const $i=On[Zr],Xs=qn[Zr],vo=Er[Zr],Vn=Sr[Zr],Di=Dr[Zr];if($i===void 0)continue;$i.updateMatrix(),$i.matrixAutoUpdate=!0;let Ps;switch(xe[Di.path]){case xe.weights:Ps=n.NumberKeyframeTrack;break;case xe.rotation:Ps=n.QuaternionKeyframeTrack;break;case xe.position:case xe.scale:default:Ps=n.VectorKeyframeTrack;break}const ct=$i.name?$i.name:$i.uuid,se=Vn.interpolation!==void 0?Ce[Vn.interpolation]:n.InterpolateLinear,le=[];xe[Di.path]===xe.weights?$i.traverse(function(Fe){Fe.isMesh===!0&&Fe.morphTargetInfluences&&le.push(Fe.name?Fe.name:Fe.uuid)}):le.push(ct);let Ae=vo.array;if(vo.normalized){const Fe=Gr(Ae.constructor),nt=new Float32Array(Ae.length);for(let kt=0,Tt=Ae.length;kt<Tt;kt++)nt[kt]=Ae[kt]*Fe;Ae=nt}for(let Fe=0,nt=le.length;Fe<nt;Fe++){const kt=new Ps(le[Fe]+"."+xe[Di.path],Xs.array,Ae,se);Vn.interpolation==="CUBICSPLINE"&&(kt.createInterpolant=function(at){const me=this instanceof n.QuaternionKeyframeTrack?Ot:mt;return new me(this.times,this.values,this.getValueSize()/3,at)},kt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Fr.push(kt)}}const Tr=vt.name?vt.name:"animation_"+Be;return new n.AnimationClip(Tr,void 0,Fr)})}createNodeMesh(Be){const ze=this.json,vt=this,Qe=ze.nodes[Be];return Qe.mesh===void 0?null:vt.getDependency("mesh",Qe.mesh).then(function(gt){const St=vt._getNodeRef(vt.meshCache,Qe.mesh,gt);return Qe.weights!==void 0&&St.traverse(function(Rt){if(Rt.isMesh)for(let At=0,en=Qe.weights.length;At<en;At++)Rt.morphTargetInfluences[At]=Qe.weights[At]}),St})}loadNode(Be){const ze=this.json,vt=this.extensions,Qe=this,gt=ze.nodes[Be],St=gt.name?Qe.createUniqueName(gt.name):"";return function(){const Rt=[],At=Qe._invokeOne(function(en){return en.createNodeMesh&&en.createNodeMesh(Be)});return At&&Rt.push(At),gt.camera!==void 0&&Rt.push(Qe.getDependency("camera",gt.camera).then(function(en){return Qe._getNodeRef(Qe.cameraCache,gt.camera,en)})),Qe._invokeAll(function(en){return en.createNodeAttachment&&en.createNodeAttachment(Be)}).forEach(function(en){Rt.push(en)}),Promise.all(Rt)}().then(function(Rt){let At;if(gt.isBone===!0?At=new n.Bone:Rt.length>1?At=new n.Group:Rt.length===1?At=Rt[0]:At=new n.Object3D,At!==Rt[0])for(let en=0,On=Rt.length;en<On;en++)At.add(Rt[en]);if(gt.name&&(At.userData.name=gt.name,At.name=St),ht(At,gt),gt.extensions&&Ut(vt,At,gt),gt.matrix!==void 0){const en=new n.Matrix4;en.fromArray(gt.matrix),At.applyMatrix4(en)}else gt.translation!==void 0&&At.position.fromArray(gt.translation),gt.rotation!==void 0&&At.quaternion.fromArray(gt.rotation),gt.scale!==void 0&&At.scale.fromArray(gt.scale);return Qe.associations.set(At,{type:"nodes",index:Be}),At})}loadScene(Be){const ze=this.json,vt=this.extensions,Qe=this.json.scenes[Be],gt=this,St=new n.Group;Qe.name&&(St.name=gt.createUniqueName(Qe.name)),ht(St,Qe),Qe.extensions&&Ut(vt,St,Qe);const Rt=Qe.nodes||[],At=[];for(let en=0,On=Rt.length;en<On;en++)At.push(wi(Rt[en],St,ze,gt));return Promise.all(At).then(function(){return St})}}function wi(jn,Be,ze,vt){const Qe=ze.nodes[jn];return vt.getDependency("node",jn).then(function(gt){if(Qe.skin===void 0)return gt;let St;return vt.getDependency("skin",Qe.skin).then(function(Rt){St=Rt;const At=[];for(let en=0,On=St.joints.length;en<On;en++)At.push(vt.getDependency("node",St.joints[en]));return Promise.all(At)}).then(function(Rt){return gt.traverse(function(At){if(!At.isMesh)return;const en=[],On=[];for(let qn=0,Er=Rt.length;qn<Er;qn++){const Sr=Rt[qn];if(Sr){en.push(Sr);const Dr=new n.Matrix4;St.inverseBindMatrices!==void 0&&Dr.fromArray(St.inverseBindMatrices.array,qn*16),On.push(Dr)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',St.joints[qn])}At.bind(new n.Skeleton(en,On),At.matrixWorld)}),gt})}).then(function(gt){Be.add(gt);const St=[];if(Qe.children){const Rt=Qe.children;for(let At=0,en=Rt.length;At<en;At++){const On=Rt[At];St.push(wi(On,gt,ze,vt))}}return Promise.all(St)})}function Nr(jn,Be,ze){const vt=Be.attributes,Qe=new n.Box3;if(vt.POSITION!==void 0){const Rt=ze.json.accessors[vt.POSITION],At=Rt.min,en=Rt.max;if(At!==void 0&&en!==void 0){if(Qe.set(new n.Vector3(At[0],At[1],At[2]),new n.Vector3(en[0],en[1],en[2])),Rt.normalized){const On=Gr(qe[Rt.componentType]);Qe.min.multiplyScalar(On),Qe.max.multiplyScalar(On)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const gt=Be.targets;if(gt!==void 0){const Rt=new n.Vector3,At=new n.Vector3;for(let en=0,On=gt.length;en<On;en++){const qn=gt[en];if(qn.POSITION!==void 0){const Er=ze.json.accessors[qn.POSITION],Sr=Er.min,Dr=Er.max;if(Sr!==void 0&&Dr!==void 0){if(At.setX(Math.max(Math.abs(Sr[0]),Math.abs(Dr[0]))),At.setY(Math.max(Math.abs(Sr[1]),Math.abs(Dr[1]))),At.setZ(Math.max(Math.abs(Sr[2]),Math.abs(Dr[2]))),Er.normalized){const Fr=Gr(qe[Er.componentType]);At.multiplyScalar(Fr)}Rt.max(At)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Qe.expandByVector(Rt)}jn.boundingBox=Qe;const St=new n.Sphere;Qe.getCenter(St.center),St.radius=Qe.min.distanceTo(Qe.max)/2,jn.boundingSphere=St}function fi(jn,Be,ze){const vt=Be.attributes,Qe=[];function gt(St,Rt){return ze.getDependency("accessor",St).then(function(At){jn.setAttribute(Rt,At)})}for(const St in vt){const Rt=ge[St]||St.toLowerCase();Rt in jn.attributes||Qe.push(gt(vt[St],Rt))}if(Be.indices!==void 0&&!jn.index){const St=ze.getDependency("accessor",Be.indices).then(function(Rt){jn.setIndex(Rt)});Qe.push(St)}return ht(jn,Be),Nr(jn,Be,ze),Promise.all(Qe).then(function(){return Be.targets!==void 0?Ft(jn,Be.targets,ze):jn})}function Mi(jn,Be){let ze=jn.getIndex();if(ze===null){const St=[],Rt=jn.getAttribute("position");if(Rt!==void 0){for(let At=0;At<Rt.count;At++)St.push(At);jn.setIndex(St),ze=jn.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),jn}const vt=ze.count-2,Qe=[];if(Be===n.TriangleFanDrawMode)for(let St=1;St<=vt;St++)Qe.push(ze.getX(0)),Qe.push(ze.getX(St)),Qe.push(ze.getX(St+1));else for(let St=0;St<vt;St++)St%2===0?(Qe.push(ze.getX(St)),Qe.push(ze.getX(St+1)),Qe.push(ze.getX(St+2))):(Qe.push(ze.getX(St+2)),Qe.push(ze.getX(St+1)),Qe.push(ze.getX(St)));Qe.length/3!==vt&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const gt=jn.clone();return gt.setIndex(Qe),gt}n.GLTFLoader=r})(),t.exports=n.GLTFLoader})(VV);var vre=VV.exports,GV={exports:{}};(function(t,e){const n=ju;(function(){class r extends n.Loader{constructor(u){super(u)}load(u,p,g,l){const E=this,P=E.path===""?n.LoaderUtils.extractUrlBase(u):E.path,O=new n.FileLoader(E.manager);O.setPath(E.path),O.setRequestHeader(E.requestHeader),O.setWithCredentials(E.withCredentials),O.load(u,function(j){try{p(E.parse(j,P))}catch($){l?l($):console.error($),E.manager.itemError(u)}},g,l)}parse(u,p){function g(fe,ue){const Me=[],De=fe.childNodes;for(let Pe=0,Dt=De.length;Pe<Dt;Pe++){const Zt=De[Pe];Zt.nodeName===ue&&Me.push(Zt)}return Me}function l(fe){if(fe.length===0)return[];const ue=fe.trim().split(/\s+/),Me=new Array(ue.length);for(let De=0,Pe=ue.length;De<Pe;De++)Me[De]=ue[De];return Me}function E(fe){if(fe.length===0)return[];const ue=fe.trim().split(/\s+/),Me=new Array(ue.length);for(let De=0,Pe=ue.length;De<Pe;De++)Me[De]=parseFloat(ue[De]);return Me}function P(fe){if(fe.length===0)return[];const ue=fe.trim().split(/\s+/),Me=new Array(ue.length);for(let De=0,Pe=ue.length;De<Pe;De++)Me[De]=parseInt(ue[De]);return Me}function O(fe){return fe.substring(1)}function j(){return"three_default_"+yn++}function $(fe){return Object.keys(fe).length===0}function Y(fe){return{unit:re(g(fe,"unit")[0]),upAxis:_e(g(fe,"up_axis")[0])}}function re(fe){return fe!==void 0&&fe.hasAttribute("meter")===!0?parseFloat(fe.getAttribute("meter")):1}function _e(fe){return fe!==void 0?fe.textContent:"Y_UP"}function J(fe,ue,Me,De){const Pe=g(fe,ue)[0];if(Pe!==void 0){const Dt=g(Pe,Me);for(let Zt=0;Zt<Dt.length;Zt++)De(Dt[Zt])}}function H(fe,ue){for(const Me in fe){const De=fe[Me];De.build=ue(fe[Me])}}function te(fe,ue){return fe.build!==void 0||(fe.build=ue(fe)),fe.build}function ce(fe){const ue={sources:{},samplers:{},channels:{}};let Me=!1;for(let De=0,Pe=fe.childNodes.length;De<Pe;De++){const Dt=fe.childNodes[De];if(Dt.nodeType!==1)continue;let Zt;switch(Dt.nodeName){case"source":Zt=Dt.getAttribute("id"),ue.sources[Zt]=Fe(Dt);break;case"sampler":Zt=Dt.getAttribute("id"),ue.samplers[Zt]=Se(Dt);break;case"channel":Zt=Dt.getAttribute("target"),ue.channels[Zt]=Ie(Dt);break;case"animation":ce(Dt),Me=!0;break;default:console.log(Dt)}}Me===!1&&(Ht.animations[fe.getAttribute("id")||n.MathUtils.generateUUID()]=ue)}function Se(fe){const ue={inputs:{}};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"input":const Dt=O(Pe.getAttribute("source")),Zt=Pe.getAttribute("semantic");ue.inputs[Zt]=Dt;break}}return ue}function Ie(fe){const ue={};let De=fe.getAttribute("target").split("/");const Pe=De.shift();let Dt=De.shift();const Zt=Dt.indexOf("(")!==-1,pn=Dt.indexOf(".")!==-1;if(pn)De=Dt.split("."),Dt=De.shift(),ue.member=De.shift();else if(Zt){const Sn=Dt.split("(");Dt=Sn.shift();for(let lr=0;lr<Sn.length;lr++)Sn[lr]=parseInt(Sn[lr].replace(/\)/,""));ue.indices=Sn}return ue.id=Pe,ue.sid=Dt,ue.arraySyntax=Zt,ue.memberSyntax=pn,ue.sampler=O(fe.getAttribute("source")),ue}function Ne(fe){const ue=[],Me=fe.channels,De=fe.samplers,Pe=fe.sources;for(const Dt in Me)if(Me.hasOwnProperty(Dt)){const Zt=Me[Dt],pn=De[Zt.sampler],Sn=pn.inputs.INPUT,lr=pn.inputs.OUTPUT,In=Pe[Sn],un=Pe[lr],cr=mt(Zt,In,un);et(cr,ue)}return ue}function ut(fe){return te(Ht.animations[fe],Ne)}function mt(fe,ue,Me){const De=Ht.nodes[fe.id],Pe=Ds(De.id),Dt=De.transforms[fe.sid],Zt=De.matrix.clone().transpose();let pn,Sn,lr,In,un,cr;const Bn={};switch(Dt){case"matrix":for(lr=0,In=ue.array.length;lr<In;lr++)if(pn=ue.array[lr],Sn=lr*Me.stride,Bn[pn]===void 0&&(Bn[pn]={}),fe.arraySyntax===!0){const Ar=Me.array[Sn],$r=fe.indices[0]+4*fe.indices[1];Bn[pn][$r]=Ar}else for(un=0,cr=Me.stride;un<cr;un++)Bn[pn][un]=Me.array[Sn+un];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Dt);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Dt);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Dt);break}const fr=We(Bn,Zt);return{name:Pe.uuid,keyframes:fr}}function We(fe,ue){const Me=[];for(const Pe in fe)Me.push({time:parseFloat(Pe),value:fe[Pe]});Me.sort(De);for(let Pe=0;Pe<16;Pe++)Q(Me,Pe,ue.elements[Pe]);return Me;function De(Pe,Dt){return Pe.time-Dt.time}}const Ot=new n.Vector3,st=new n.Vector3,qe=new n.Quaternion;function et(fe,ue){const Me=fe.keyframes,De=fe.name,Pe=[],Dt=[],Zt=[],pn=[];for(let Sn=0,lr=Me.length;Sn<lr;Sn++){const In=Me[Sn],un=In.time,cr=In.value;Zs.fromArray(cr).transpose(),Zs.decompose(Ot,qe,st),Pe.push(un),Dt.push(Ot.x,Ot.y,Ot.z),Zt.push(qe.x,qe.y,qe.z,qe.w),pn.push(st.x,st.y,st.z)}return Dt.length>0&&ue.push(new n.VectorKeyframeTrack(De+".position",Pe,Dt)),Zt.length>0&&ue.push(new n.QuaternionKeyframeTrack(De+".quaternion",Pe,Zt)),pn.length>0&&ue.push(new n.VectorKeyframeTrack(De+".scale",Pe,pn)),ue}function Q(fe,ue,Me){let De,Pe=!0,Dt,Zt;for(Dt=0,Zt=fe.length;Dt<Zt;Dt++)De=fe[Dt],De.value[ue]===void 0?De.value[ue]=null:Pe=!1;if(Pe===!0)for(Dt=0,Zt=fe.length;Dt<Zt;Dt++)De=fe[Dt],De.value[ue]=Me;else ye(fe,ue)}function ye(fe,ue){let Me,De;for(let Pe=0,Dt=fe.length;Pe<Dt;Pe++){const Zt=fe[Pe];if(Zt.value[ue]===null){if(Me=ge(fe,Pe,ue),De=xe(fe,Pe,ue),Me===null){Zt.value[ue]=De.value[ue];continue}if(De===null){Zt.value[ue]=Me.value[ue];continue}Ce(Zt,Me,De,ue)}}}function ge(fe,ue,Me){for(;ue>=0;){const De=fe[ue];if(De.value[Me]!==null)return De;ue--}return null}function xe(fe,ue,Me){for(;ue<fe.length;){const De=fe[ue];if(De.value[Me]!==null)return De;ue++}return null}function Ce(fe,ue,Me,De){if(Me.time-ue.time===0){fe.value[De]=ue.value[De];return}fe.value[De]=(fe.time-ue.time)*(Me.value[De]-ue.value[De])/(Me.time-ue.time)+ue.value[De]}function tt(fe){const ue={name:fe.getAttribute("id")||"default",start:parseFloat(fe.getAttribute("start")||0),end:parseFloat(fe.getAttribute("end")||0),animations:[]};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"instance_animation":ue.animations.push(O(Pe.getAttribute("url")));break}}Ht.clips[fe.getAttribute("id")]=ue}function Je(fe){const ue=[],Me=fe.name,De=fe.end-fe.start||-1,Pe=fe.animations;for(let Dt=0,Zt=Pe.length;Dt<Zt;Dt++){const pn=ut(Pe[Dt]);for(let Sn=0,lr=pn.length;Sn<lr;Sn++)ue.push(pn[Sn])}return new n.AnimationClip(Me,De,ue)}function rt(fe){return te(Ht.clips[fe],Je)}function Ut(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"skin":ue.id=O(Pe.getAttribute("source")),ue.skin=ht(Pe);break;case"morph":ue.id=O(Pe.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Ht.controllers[fe.getAttribute("id")]=ue}function ht(fe){const ue={sources:{}};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"bind_shape_matrix":ue.bindShapeMatrix=E(Pe.textContent);break;case"source":const Dt=Pe.getAttribute("id");ue.sources[Dt]=Fe(Pe);break;case"joints":ue.joints=Ft(Pe);break;case"vertex_weights":ue.vertexWeights=Nn(Pe);break}}return ue}function Ft(fe){const ue={inputs:{}};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"input":const Dt=Pe.getAttribute("semantic"),Zt=O(Pe.getAttribute("source"));ue.inputs[Dt]=Zt;break}}return ue}function Nn(fe){const ue={inputs:{}};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"input":const Dt=Pe.getAttribute("semantic"),Zt=O(Pe.getAttribute("source")),pn=parseInt(Pe.getAttribute("offset"));ue.inputs[Dt]={id:Zt,offset:pn};break;case"vcount":ue.vcount=P(Pe.textContent);break;case"v":ue.v=P(Pe.textContent);break}}return ue}function zn(fe){const ue={id:fe.id},Me=Ht.geometries[ue.id];return fe.skin!==void 0&&(ue.skin=rr(fe.skin),Me.sources.skinIndices=ue.skin.indices,Me.sources.skinWeights=ue.skin.weights),ue}function rr(fe){const Me={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},De=fe.sources,Pe=fe.vertexWeights,Dt=Pe.vcount,Zt=Pe.v,pn=Pe.inputs.JOINT.offset,Sn=Pe.inputs.WEIGHT.offset,lr=fe.sources[fe.joints.inputs.JOINT],In=fe.sources[fe.joints.inputs.INV_BIND_MATRIX],un=De[Pe.inputs.WEIGHT.id].array;let cr=0,Bn,fr,cn;for(Bn=0,cn=Dt.length;Bn<cn;Bn++){const $r=Dt[Bn],ei=[];for(fr=0;fr<$r;fr++){const Br=Zt[cr+pn],qi=Zt[cr+Sn],Oi=un[qi];ei.push({index:Br,weight:Oi}),cr+=2}for(ei.sort(Ar),fr=0;fr<4;fr++){const Br=ei[fr];Br!==void 0?(Me.indices.array.push(Br.index),Me.weights.array.push(Br.weight)):(Me.indices.array.push(0),Me.weights.array.push(0))}}for(fe.bindShapeMatrix?Me.bindMatrix=new n.Matrix4().fromArray(fe.bindShapeMatrix).transpose():Me.bindMatrix=new n.Matrix4().identity(),Bn=0,cn=lr.array.length;Bn<cn;Bn++){const $r=lr.array[Bn],ei=new n.Matrix4().fromArray(In.array,Bn*In.stride).transpose();Me.joints.push({name:$r,boneInverse:ei})}return Me;function Ar($r,ei){return ei.weight-$r.weight}}function Gr(fe){return te(Ht.controllers[fe],zn)}function Li(fe){const ue={init_from:g(fe,"init_from")[0].textContent};Ht.images[fe.getAttribute("id")]=ue}function wi(fe){return fe.build!==void 0?fe.build:fe.init_from}function Nr(fe){const ue=Ht.images[fe];return ue!==void 0?te(ue,wi):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",fe),null)}function fi(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"profile_COMMON":ue.profile=Mi(Pe);break}}Ht.effects[fe.getAttribute("id")]=ue}function Mi(fe){const ue={surfaces:{},samplers:{}};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"newparam":jn(Pe,ue);break;case"technique":ue.technique=vt(Pe);break;case"extra":ue.extra=en(Pe);break}}return ue}function jn(fe,ue){const Me=fe.getAttribute("sid");for(let De=0,Pe=fe.childNodes.length;De<Pe;De++){const Dt=fe.childNodes[De];if(Dt.nodeType===1)switch(Dt.nodeName){case"surface":ue.surfaces[Me]=Be(Dt);break;case"sampler2D":ue.samplers[Me]=ze(Dt);break}}}function Be(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"init_from":ue.init_from=Pe.textContent;break}}return ue}function ze(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"source":ue.source=Pe.textContent;break}}return ue}function vt(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"constant":case"lambert":case"blinn":case"phong":ue.type=Pe.nodeName,ue.parameters=Qe(Pe);break}}return ue}function Qe(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":ue[Pe.nodeName]=gt(Pe);break;case"transparent":ue[Pe.nodeName]={opaque:Pe.getAttribute("opaque"),data:gt(Pe)};break}}return ue}function gt(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"color":ue[Pe.nodeName]=E(Pe.textContent);break;case"float":ue[Pe.nodeName]=parseFloat(Pe.textContent);break;case"texture":ue[Pe.nodeName]={id:Pe.getAttribute("texture"),extra:St(Pe)};break}}return ue}function St(fe){const ue={technique:{}};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"extra":Rt(Pe,ue);break}}return ue}function Rt(fe,ue){for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"technique":At(Pe,ue);break}}}function At(fe,ue){for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":ue.technique[Pe.nodeName]=parseFloat(Pe.textContent);break;case"wrapU":case"wrapV":Pe.textContent.toUpperCase()==="TRUE"?ue.technique[Pe.nodeName]=1:Pe.textContent.toUpperCase()==="FALSE"?ue.technique[Pe.nodeName]=0:ue.technique[Pe.nodeName]=parseInt(Pe.textContent);break}}}function en(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"technique":ue.technique=On(Pe);break}}return ue}function On(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"double_sided":ue[Pe.nodeName]=parseInt(Pe.textContent);break}}return ue}function qn(fe){return fe}function Er(fe){return te(Ht.effects[fe],qn)}function Sr(fe){const ue={name:fe.getAttribute("name")};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"instance_effect":ue.url=O(Pe.getAttribute("url"));break}}Ht.materials[fe.getAttribute("id")]=ue}function Dr(fe){let ue,Me=fe.slice((fe.lastIndexOf(".")-1>>>0)+2);switch(Me=Me.toLowerCase(),Me){case"tga":ue=Le;break;default:ue=ve}return ue}function Fr(fe){const ue=Er(fe.url),Me=ue.profile.technique,De=ue.profile.extra;let Pe;switch(Me.type){case"phong":case"blinn":Pe=new n.MeshPhongMaterial;break;case"lambert":Pe=new n.MeshLambertMaterial;break;default:Pe=new n.MeshBasicMaterial;break}Pe.name=fe.name||"";function Dt(lr){const In=ue.profile.samplers[lr.id];let un=null;if(In!==void 0){const cr=ue.profile.surfaces[In.source];un=Nr(cr.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),un=Nr(lr.id);if(un!==null){const cr=Dr(un);if(cr!==void 0){const Bn=cr.load(un),fr=lr.extra;if(fr!==void 0&&fr.technique!==void 0&&$(fr.technique)===!1){const cn=fr.technique;Bn.wrapS=cn.wrapU?n.RepeatWrapping:n.ClampToEdgeWrapping,Bn.wrapT=cn.wrapV?n.RepeatWrapping:n.ClampToEdgeWrapping,Bn.offset.set(cn.offsetU||0,cn.offsetV||0),Bn.repeat.set(cn.repeatU||1,cn.repeatV||1)}else Bn.wrapS=n.RepeatWrapping,Bn.wrapT=n.RepeatWrapping;return Bn}else return console.warn("THREE.ColladaLoader: THREE.Loader for texture %s not found.",un),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",lr.id),null}const Zt=Me.parameters;for(const lr in Zt){const In=Zt[lr];switch(lr){case"diffuse":In.color&&Pe.color.fromArray(In.color),In.texture&&(Pe.map=Dt(In.texture));break;case"specular":In.color&&Pe.specular&&Pe.specular.fromArray(In.color),In.texture&&(Pe.specularMap=Dt(In.texture));break;case"bump":In.texture&&(Pe.normalMap=Dt(In.texture));break;case"ambient":In.texture&&(Pe.lightMap=Dt(In.texture));break;case"shininess":In.float&&Pe.shininess&&(Pe.shininess=In.float);break;case"emission":In.color&&Pe.emissive&&Pe.emissive.fromArray(In.color),In.texture&&(Pe.emissiveMap=Dt(In.texture));break}}let pn=Zt.transparent,Sn=Zt.transparency;if(Sn===void 0&&pn&&(Sn={float:1}),pn===void 0&&Sn&&(pn={opaque:"A_ONE",data:{color:[1,1,1,1]}}),pn&&Sn)if(pn.data.texture)Pe.transparent=!0;else{const lr=pn.data.color;switch(pn.opaque){case"A_ONE":Pe.opacity=lr[3]*Sn.float;break;case"RGB_ZERO":Pe.opacity=1-lr[0]*Sn.float;break;case"A_ZERO":Pe.opacity=1-lr[3]*Sn.float;break;case"RGB_ONE":Pe.opacity=lr[0]*Sn.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',pn.opaque)}Pe.opacity<1&&(Pe.transparent=!0)}return De!==void 0&&De.technique!==void 0&&De.technique.double_sided===1&&(Pe.side=n.DoubleSide),Pe}function Tr(fe){return te(Ht.materials[fe],Fr)}function Zr(fe){const ue={name:fe.getAttribute("name")};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"optics":ue.optics=is(Pe);break}}Ht.cameras[fe.getAttribute("id")]=ue}function is(fe){for(let ue=0;ue<fe.childNodes.length;ue++){const Me=fe.childNodes[ue];switch(Me.nodeName){case"technique_common":return $i(Me)}}return{}}function $i(fe){const ue={};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];switch(De.nodeName){case"perspective":case"orthographic":ue.technique=De.nodeName,ue.parameters=Xs(De);break}}return ue}function Xs(fe){const ue={};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];switch(De.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":ue[De.nodeName]=parseFloat(De.textContent);break}}return ue}function vo(fe){let ue;switch(fe.optics.technique){case"perspective":ue=new n.PerspectiveCamera(fe.optics.parameters.yfov,fe.optics.parameters.aspect_ratio,fe.optics.parameters.znear,fe.optics.parameters.zfar);break;case"orthographic":let Me=fe.optics.parameters.ymag,De=fe.optics.parameters.xmag;const Pe=fe.optics.parameters.aspect_ratio;De=De===void 0?Me*Pe:De,Me=Me===void 0?De/Pe:Me,De*=.5,Me*=.5,ue=new n.OrthographicCamera(-De,De,Me,-Me,fe.optics.parameters.znear,fe.optics.parameters.zfar);break;default:ue=new n.PerspectiveCamera;break}return ue.name=fe.name||"",ue}function Vn(fe){const ue=Ht.cameras[fe];return ue!==void 0?te(ue,vo):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",fe),null)}function Di(fe){let ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"technique_common":ue=Ps(Pe);break}}Ht.lights[fe.getAttribute("id")]=ue}function Ps(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"directional":case"point":case"spot":case"ambient":ue.technique=Pe.nodeName,ue.parameters=ct(Pe)}}return ue}function ct(fe){const ue={};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"color":const Dt=E(Pe.textContent);ue.color=new n.Color().fromArray(Dt);break;case"falloff_angle":ue.falloffAngle=parseFloat(Pe.textContent);break;case"quadratic_attenuation":const Zt=parseFloat(Pe.textContent);ue.distance=Zt?Math.sqrt(1/Zt):0;break}}return ue}function se(fe){let ue;switch(fe.technique){case"directional":ue=new n.DirectionalLight;break;case"point":ue=new n.PointLight;break;case"spot":ue=new n.SpotLight;break;case"ambient":ue=new n.AmbientLight;break}return fe.parameters.color&&ue.color.copy(fe.parameters.color),fe.parameters.distance&&(ue.distance=fe.parameters.distance),ue}function le(fe){const ue=Ht.lights[fe];return ue!==void 0?te(ue,se):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",fe),null)}function Ae(fe){const ue={name:fe.getAttribute("name"),sources:{},vertices:{},primitives:[]},Me=g(fe,"mesh")[0];if(Me!==void 0){for(let De=0;De<Me.childNodes.length;De++){const Pe=Me.childNodes[De];if(Pe.nodeType!==1)continue;const Dt=Pe.getAttribute("id");switch(Pe.nodeName){case"source":ue.sources[Dt]=Fe(Pe);break;case"vertices":ue.vertices=nt(Pe);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Pe.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":ue.primitives.push(kt(Pe));break;default:console.log(Pe)}}Ht.geometries[fe.getAttribute("id")]=ue}}function Fe(fe){const ue={array:[],stride:3};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"float_array":ue.array=E(De.textContent);break;case"Name_array":ue.array=l(De.textContent);break;case"technique_common":const Pe=g(De,"accessor")[0];Pe!==void 0&&(ue.stride=parseInt(Pe.getAttribute("stride")));break}}return ue}function nt(fe){const ue={};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];De.nodeType===1&&(ue[De.getAttribute("semantic")]=O(De.getAttribute("source")))}return ue}function kt(fe){const ue={type:fe.nodeName,material:fe.getAttribute("material"),count:parseInt(fe.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let Me=0,De=fe.childNodes.length;Me<De;Me++){const Pe=fe.childNodes[Me];if(Pe.nodeType===1)switch(Pe.nodeName){case"input":const Dt=O(Pe.getAttribute("source")),Zt=Pe.getAttribute("semantic"),pn=parseInt(Pe.getAttribute("offset")),Sn=parseInt(Pe.getAttribute("set")),lr=Sn>0?Zt+Sn:Zt;ue.inputs[lr]={id:Dt,offset:pn},ue.stride=Math.max(ue.stride,pn+1),Zt==="TEXCOORD"&&(ue.hasUV=!0);break;case"vcount":ue.vcount=P(Pe.textContent);break;case"p":ue.p=P(Pe.textContent);break}}return ue}function Tt(fe){const ue={};for(let Me=0;Me<fe.length;Me++){const De=fe[Me];ue[De.type]===void 0&&(ue[De.type]=[]),ue[De.type].push(De)}return ue}function at(fe){let ue=0;for(let Me=0,De=fe.length;Me<De;Me++)fe[Me].hasUV===!0&&ue++;ue>0&&ue<fe.length&&(fe.uvsNeedsFix=!0)}function me(fe){const ue={},Me=fe.sources,De=fe.vertices,Pe=fe.primitives;if(Pe.length===0)return{};const Dt=Tt(Pe);for(const Zt in Dt){const pn=Dt[Zt];at(pn),ue[Zt]=fn(pn,Me,De)}return ue}function fn(fe,ue,Me){const De={},Pe={array:[],stride:0},Dt={array:[],stride:0},Zt={array:[],stride:0},pn={array:[],stride:0},Sn={array:[],stride:0},lr={array:[],stride:4},In={array:[],stride:4},un=new n.BufferGeometry,cr=[];let Bn=0;for(let fr=0;fr<fe.length;fr++){const cn=fe[fr],Ar=cn.inputs;let $r=0;switch(cn.type){case"lines":case"linestrips":$r=cn.count*2;break;case"triangles":$r=cn.count*3;break;case"polylist":for(let ei=0;ei<cn.count;ei++){const Br=cn.vcount[ei];switch(Br){case 3:$r+=3;break;case 4:$r+=6;break;default:$r+=(Br-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",cn.type)}un.addGroup(Bn,$r,fr),Bn+=$r,cn.material&&cr.push(cn.material);for(const ei in Ar){const Br=Ar[ei];switch(ei){case"VERTEX":for(const qi in Me){const Oi=Me[qi];switch(qi){case"POSITION":const Xn=Pe.array.length;if(Mn(cn,ue[Oi],Br.offset,Pe.array),Pe.stride=ue[Oi].stride,ue.skinWeights&&ue.skinIndices&&(Mn(cn,ue.skinIndices,Br.offset,lr.array),Mn(cn,ue.skinWeights,Br.offset,In.array)),cn.hasUV===!1&&fe.uvsNeedsFix===!0){const es=(Pe.array.length-Xn)/Pe.stride;for(let li=0;li<es;li++)Zt.array.push(0,0)}break;case"NORMAL":Mn(cn,ue[Oi],Br.offset,Dt.array),Dt.stride=ue[Oi].stride;break;case"COLOR":Mn(cn,ue[Oi],Br.offset,Sn.array),Sn.stride=ue[Oi].stride;break;case"TEXCOORD":Mn(cn,ue[Oi],Br.offset,Zt.array),Zt.stride=ue[Oi].stride;break;case"TEXCOORD1":Mn(cn,ue[Oi],Br.offset,pn.array),Zt.stride=ue[Oi].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',qi)}}break;case"NORMAL":Mn(cn,ue[Br.id],Br.offset,Dt.array),Dt.stride=ue[Br.id].stride;break;case"COLOR":Mn(cn,ue[Br.id],Br.offset,Sn.array),Sn.stride=ue[Br.id].stride;break;case"TEXCOORD":Mn(cn,ue[Br.id],Br.offset,Zt.array),Zt.stride=ue[Br.id].stride;break;case"TEXCOORD1":Mn(cn,ue[Br.id],Br.offset,pn.array),pn.stride=ue[Br.id].stride;break}}}return Pe.array.length>0&&un.setAttribute("position",new n.Float32BufferAttribute(Pe.array,Pe.stride)),Dt.array.length>0&&un.setAttribute("normal",new n.Float32BufferAttribute(Dt.array,Dt.stride)),Sn.array.length>0&&un.setAttribute("color",new n.Float32BufferAttribute(Sn.array,Sn.stride)),Zt.array.length>0&&un.setAttribute("uv",new n.Float32BufferAttribute(Zt.array,Zt.stride)),pn.array.length>0&&un.setAttribute("uv2",new n.Float32BufferAttribute(pn.array,pn.stride)),lr.array.length>0&&un.setAttribute("skinIndex",new n.Float32BufferAttribute(lr.array,lr.stride)),In.array.length>0&&un.setAttribute("skinWeight",new n.Float32BufferAttribute(In.array,In.stride)),De.data=un,De.type=fe[0].type,De.materialKeys=cr,De}function Mn(fe,ue,Me,De){const Pe=fe.p,Dt=fe.stride,Zt=fe.vcount;function pn(In){let un=Pe[In+Me]*lr;const cr=un+lr;for(;un<cr;un++)De.push(Sn[un])}const Sn=ue.array,lr=ue.stride;if(fe.vcount!==void 0){let In=0;for(let un=0,cr=Zt.length;un<cr;un++){const Bn=Zt[un];if(Bn===4){const fr=In+Dt*0,cn=In+Dt*1,Ar=In+Dt*2,$r=In+Dt*3;pn(fr),pn(cn),pn($r),pn(cn),pn(Ar),pn($r)}else if(Bn===3){const fr=In+Dt*0,cn=In+Dt*1,Ar=In+Dt*2;pn(fr),pn(cn),pn(Ar)}else if(Bn>4)for(let fr=1,cn=Bn-2;fr<=cn;fr++){const Ar=In+Dt*0,$r=In+Dt*fr,ei=In+Dt*(fr+1);pn(Ar),pn($r),pn(ei)}In+=Dt*Bn}}else for(let In=0,un=Pe.length;In<un;In+=Dt)pn(In)}function Jt(fe){return te(Ht.geometries[fe],me)}function mr(fe){const ue={name:fe.getAttribute("name")||"",joints:{},links:[]};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"technique_common":Kr(De,ue);break}}Ht.kinematicsModels[fe.getAttribute("id")]=ue}function Cr(fe){return fe.build!==void 0?fe.build:fe}function zr(fe){return te(Ht.kinematicsModels[fe],Cr)}function Kr(fe,ue){for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"joint":ue.joints[De.getAttribute("sid")]=pi(De);break;case"link":ue.links.push(Hi(De));break}}}function pi(fe){let ue;for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"prismatic":case"revolute":ue=Xi(De);break}}return ue}function Xi(fe){const ue={sid:fe.getAttribute("sid"),name:fe.getAttribute("name")||"",axis:new n.Vector3,limits:{min:0,max:0},type:fe.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"axis":const Pe=E(De.textContent);ue.axis.fromArray(Pe);break;case"limits":const Dt=De.getElementsByTagName("max")[0],Zt=De.getElementsByTagName("min")[0];ue.limits.max=parseFloat(Dt.textContent),ue.limits.min=parseFloat(Zt.textContent);break}}return ue.limits.min>=ue.limits.max&&(ue.static=!0),ue.middlePosition=(ue.limits.min+ue.limits.max)/2,ue}function Hi(fe){const ue={sid:fe.getAttribute("sid"),name:fe.getAttribute("name")||"",attachments:[],transforms:[]};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"attachment_full":ue.attachments.push(Zi(De));break;case"matrix":case"translate":case"rotate":ue.transforms.push(ss(De));break}}return ue}function Zi(fe){const ue={joint:fe.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"link":ue.links.push(Hi(De));break;case"matrix":case"translate":case"rotate":ue.transforms.push(ss(De));break}}return ue}function ss(fe){const ue={type:fe.nodeName},Me=E(fe.textContent);switch(ue.type){case"matrix":ue.obj=new n.Matrix4,ue.obj.fromArray(Me).transpose();break;case"translate":ue.obj=new n.Vector3,ue.obj.fromArray(Me);break;case"rotate":ue.obj=new n.Vector3,ue.obj.fromArray(Me),ue.angle=n.MathUtils.degToRad(Me[3]);break}return ue}function xo(fe){const ue={name:fe.getAttribute("name")||"",rigidBodies:{}};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"rigid_body":ue.rigidBodies[De.getAttribute("name")]={},Us(De,ue.rigidBodies[De.getAttribute("name")]);break}}Ht.physicsModels[fe.getAttribute("id")]=ue}function Us(fe,ue){for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"technique_common":uo(De,ue);break}}}function uo(fe,ue){for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"inertia":ue.inertia=E(De.textContent);break;case"mass":ue.mass=E(De.textContent)[0];break}}}function No(fe){const ue={bindJointAxis:[]};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"bind_joint_axis":ue.bindJointAxis.push(xs(De));break}}Ht.kinematicsScenes[O(fe.getAttribute("url"))]=ue}function xs(fe){const ue={target:fe.getAttribute("target").split("/").pop()};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType===1)switch(De.nodeName){case"axis":const Pe=De.getElementsByTagName("param")[0];ue.axis=Pe.textContent;const Dt=ue.axis.split("inst_").pop().split("axis")[0];ue.jointIndex=Dt.substr(0,Dt.length-1);break}}return ue}function ea(fe){return fe.build!==void 0?fe.build:fe}function ri(fe){return te(Ht.kinematicsScenes[fe],ea)}function Ia(){const fe=Object.keys(Ht.kinematicsModels)[0],ue=Object.keys(Ht.kinematicsScenes)[0],Me=Object.keys(Ht.visualScenes)[0];if(fe===void 0||ue===void 0)return;const De=zr(fe),Pe=ri(ue),Dt=Aa(Me),Zt=Pe.bindJointAxis,pn={};for(let In=0,un=Zt.length;In<un;In++){const cr=Zt[In],Bn=ys.querySelector('[sid="'+cr.target+'"]');if(Bn){const fr=Bn.parentElement;Sn(cr.jointIndex,fr)}}function Sn(In,un){const cr=un.getAttribute("name"),Bn=De.joints[In];Dt.traverse(function(fr){fr.name===cr&&(pn[In]={object:fr,transforms:zl(un),joint:Bn,position:Bn.zeroPosition})})}const lr=new n.Matrix4;Gt={joints:De&&De.joints,getJointValue:function(In){const un=pn[In];if(un)return un.position;console.warn("THREE.ColladaLoader: Joint "+In+" doesn't exist.")},setJointValue:function(In,un){const cr=pn[In];if(cr){const Bn=cr.joint;if(un>Bn.limits.max||un<Bn.limits.min)console.warn("THREE.ColladaLoader: Joint "+In+" value "+un+" outside of limits (min: "+Bn.limits.min+", max: "+Bn.limits.max+").");else if(Bn.static)console.warn("THREE.ColladaLoader: Joint "+In+" is static.");else{const fr=cr.object,cn=Bn.axis,Ar=cr.transforms;Zs.identity();for(let $r=0;$r<Ar.length;$r++){const ei=Ar[$r];if(ei.sid&&ei.sid.indexOf(In)!==-1)switch(Bn.type){case"revolute":Zs.multiply(lr.makeRotationAxis(cn,n.MathUtils.degToRad(un)));break;case"prismatic":Zs.multiply(lr.makeTranslation(cn.x*un,cn.y*un,cn.z*un));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Bn.type);break}else switch(ei.type){case"matrix":Zs.multiply(ei.obj);break;case"translate":Zs.multiply(lr.makeTranslation(ei.obj.x,ei.obj.y,ei.obj.z));break;case"scale":Zs.scale(ei.obj);break;case"rotate":Zs.multiply(lr.makeRotationAxis(ei.obj,ei.angle));break}}fr.matrix.copy(Zs),fr.matrix.decompose(fr.position,fr.quaternion,fr.scale),pn[In].position=un}}else console.log("THREE.ColladaLoader: "+In+" does not exist.")}}}function zl(fe){const ue=[],Me=ys.querySelector('[id="'+fe.id+'"]');for(let De=0;De<Me.childNodes.length;De++){const Pe=Me.childNodes[De];if(Pe.nodeType!==1)continue;let Dt,Zt;switch(Pe.nodeName){case"matrix":Dt=E(Pe.textContent);const pn=new n.Matrix4().fromArray(Dt).transpose();ue.push({sid:Pe.getAttribute("sid"),type:Pe.nodeName,obj:pn});break;case"translate":case"scale":Dt=E(Pe.textContent),Zt=new n.Vector3().fromArray(Dt),ue.push({sid:Pe.getAttribute("sid"),type:Pe.nodeName,obj:Zt});break;case"rotate":Dt=E(Pe.textContent),Zt=new n.Vector3().fromArray(Dt);const Sn=n.MathUtils.degToRad(Dt[3]);ue.push({sid:Pe.getAttribute("sid"),type:Pe.nodeName,obj:Zt,angle:Sn});break}}return ue}function tl(fe){const ue=fe.getElementsByTagName("node");for(let Me=0;Me<ue.length;Me++){const De=ue[Me];De.hasAttribute("id")===!1&&De.setAttribute("id",j())}}const Zs=new n.Matrix4,ta=new n.Vector3;function bo(fe){const ue={name:fe.getAttribute("name")||"",type:fe.getAttribute("type"),id:fe.getAttribute("id"),sid:fe.getAttribute("sid"),matrix:new n.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];if(De.nodeType!==1)continue;let Pe;switch(De.nodeName){case"node":ue.nodes.push(De.getAttribute("id")),bo(De);break;case"instance_camera":ue.instanceCameras.push(O(De.getAttribute("url")));break;case"instance_controller":ue.instanceControllers.push(nl(De));break;case"instance_light":ue.instanceLights.push(O(De.getAttribute("url")));break;case"instance_geometry":ue.instanceGeometries.push(nl(De));break;case"instance_node":ue.instanceNodes.push(O(De.getAttribute("url")));break;case"matrix":Pe=E(De.textContent),ue.matrix.multiply(Zs.fromArray(Pe).transpose()),ue.transforms[De.getAttribute("sid")]=De.nodeName;break;case"translate":Pe=E(De.textContent),ta.fromArray(Pe),ue.matrix.multiply(Zs.makeTranslation(ta.x,ta.y,ta.z)),ue.transforms[De.getAttribute("sid")]=De.nodeName;break;case"rotate":Pe=E(De.textContent);const Dt=n.MathUtils.degToRad(Pe[3]);ue.matrix.multiply(Zs.makeRotationAxis(ta.fromArray(Pe),Dt)),ue.transforms[De.getAttribute("sid")]=De.nodeName;break;case"scale":Pe=E(De.textContent),ue.matrix.scale(ta.fromArray(Pe)),ue.transforms[De.getAttribute("sid")]=De.nodeName;break;case"extra":break;default:console.log(De)}}return ns(ue.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",ue.id):Ht.nodes[ue.id]=ue,ue}function nl(fe){const ue={id:O(fe.getAttribute("url")),materials:{},skeletons:[]};for(let Me=0;Me<fe.childNodes.length;Me++){const De=fe.childNodes[Me];switch(De.nodeName){case"bind_material":const Pe=De.getElementsByTagName("instance_material");for(let Dt=0;Dt<Pe.length;Dt++){const Zt=Pe[Dt],pn=Zt.getAttribute("symbol"),Sn=Zt.getAttribute("target");ue.materials[pn]=O(Sn)}break;case"skeleton":ue.skeletons.push(O(De.textContent));break}}return ue}function Bc(fe,ue){const Me=[],De=[];let Pe,Dt,Zt;for(Pe=0;Pe<fe.length;Pe++){const lr=fe[Pe];let In;if(ns(lr))In=Ds(lr),yl(In,ue,Me);else if(Uc(lr)){const cr=Ht.visualScenes[lr].children;for(let Bn=0;Bn<cr.length;Bn++){const fr=cr[Bn];if(fr.type==="JOINT"){const cn=Ds(fr.id);yl(cn,ue,Me)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",lr)}for(Pe=0;Pe<ue.length;Pe++)for(Dt=0;Dt<Me.length;Dt++)if(Zt=Me[Dt],Zt.bone.name===ue[Pe].name){De[Pe]=Zt,Zt.processed=!0;break}for(Pe=0;Pe<Me.length;Pe++)Zt=Me[Pe],Zt.processed===!1&&(De.push(Zt),Zt.processed=!0);const pn=[],Sn=[];for(Pe=0;Pe<De.length;Pe++)Zt=De[Pe],pn.push(Zt.bone),Sn.push(Zt.boneInverse);return new n.Skeleton(pn,Sn)}function yl(fe,ue,Me){fe.traverse(function(De){if(De.isBone===!0){let Pe;for(let Dt=0;Dt<ue.length;Dt++){const Zt=ue[Dt];if(Zt.name===De.name){Pe=Zt.boneInverse;break}}Pe===void 0&&(Pe=new n.Matrix4),Me.push({bone:De,boneInverse:Pe,processed:!1})}})}function _l(fe){const ue=[],Me=fe.matrix,De=fe.nodes,Pe=fe.type,Dt=fe.instanceCameras,Zt=fe.instanceControllers,pn=fe.instanceLights,Sn=fe.instanceGeometries,lr=fe.instanceNodes;for(let un=0,cr=De.length;un<cr;un++)ue.push(Ds(De[un]));for(let un=0,cr=Dt.length;un<cr;un++){const Bn=Vn(Dt[un]);Bn!==null&&ue.push(Bn.clone())}for(let un=0,cr=Zt.length;un<cr;un++){const Bn=Zt[un],fr=Gr(Bn.id),cn=Jt(fr.id),Ar=ko(cn,Bn.materials),$r=Bn.skeletons,ei=fr.skin.joints,Br=Bc($r,ei);for(let qi=0,Oi=Ar.length;qi<Oi;qi++){const Xn=Ar[qi];Xn.isSkinnedMesh&&(Xn.bind(Br,fr.skin.bindMatrix),Xn.normalizeSkinWeights()),ue.push(Xn)}}for(let un=0,cr=pn.length;un<cr;un++){const Bn=le(pn[un]);Bn!==null&&ue.push(Bn.clone())}for(let un=0,cr=Sn.length;un<cr;un++){const Bn=Sn[un],fr=Jt(Bn.id),cn=ko(fr,Bn.materials);for(let Ar=0,$r=cn.length;Ar<$r;Ar++)ue.push(cn[Ar])}for(let un=0,cr=lr.length;un<cr;un++)ue.push(Ds(lr[un]).clone());let In;if(De.length===0&&ue.length===1)In=ue[0];else{In=Pe==="JOINT"?new n.Bone:new n.Group;for(let un=0;un<ue.length;un++)In.add(ue[un])}return In.name=Pe==="JOINT"?fe.sid:fe.name,In.matrix.copy(Me),In.matrix.decompose(In.position,In.quaternion,In.scale),In}const rl=new n.MeshBasicMaterial({color:16711935});function Nt(fe,ue){const Me=[];for(let De=0,Pe=fe.length;De<Pe;De++){const Dt=ue[fe[De]];Dt===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",fe[De]),Me.push(rl)):Me.push(Tr(Dt))}return Me}function ko(fe,ue){const Me=[];for(const De in fe){const Pe=fe[De],Dt=Nt(Pe.materialKeys,ue);Dt.length===0&&(De==="lines"||De==="linestrips"?Dt.push(new n.LineBasicMaterial):Dt.push(new n.MeshPhongMaterial));const Zt=Pe.data.attributes.skinIndex!==void 0,pn=Dt.length===1?Dt[0]:Dt;let Sn;switch(De){case"lines":Sn=new n.LineSegments(Pe.data,pn);break;case"linestrips":Sn=new n.Line(Pe.data,pn);break;case"triangles":case"polylist":Zt?Sn=new n.SkinnedMesh(Pe.data,pn):Sn=new n.Mesh(Pe.data,pn);break}Me.push(Sn)}return Me}function ns(fe){return Ht.nodes[fe]!==void 0}function Ds(fe){return te(Ht.nodes[fe],_l)}function Tp(fe){const ue={name:fe.getAttribute("name"),children:[]};tl(fe);const Me=g(fe,"node");for(let De=0;De<Me.length;De++)ue.children.push(bo(Me[De]));Ht.visualScenes[fe.getAttribute("id")]=ue}function Uo(fe){const ue=new n.Group;ue.name=fe.name;const Me=fe.children;for(let De=0;De<Me.length;De++){const Pe=Me[De];ue.add(Ds(Pe.id))}return ue}function Uc(fe){return Ht.visualScenes[fe]!==void 0}function Aa(fe){return te(Ht.visualScenes[fe],Uo)}function hc(fe){const ue=g(fe,"instance_visual_scene")[0];return Aa(O(ue.getAttribute("url")))}function ur(){const fe=Ht.clips;if($(fe)===!0){if($(Ht.animations)===!1){const ue=[];for(const Me in Ht.animations){const De=ut(Me);for(let Pe=0,Dt=De.length;Pe<Dt;Pe++)ue.push(De[Pe])}ot.push(new n.AnimationClip("default",-1,ue))}}else for(const ue in fe)ot.push(rt(ue))}function Ei(fe){let ue="";const Me=[fe];for(;Me.length;){const De=Me.shift();De.nodeType===Node.TEXT_NODE?ue+=De.textContent:(ue+=`
`,Me.push.apply(Me,De.childNodes))}return ue.trim()}if(u.length===0)return{scene:new n.Scene};const Si=new DOMParser().parseFromString(u,"application/xml"),ys=g(Si,"COLLADA")[0],$a=Si.getElementsByTagName("parsererror")[0];if($a!==void 0){const fe=g($a,"div")[0];let ue;return fe?ue=fe.textContent:ue=Ei($a),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,ue),null}const vi=ys.getAttribute("version");console.log("THREE.ColladaLoader: File version",vi);const we=Y(g(ys,"asset")[0]),ve=new n.TextureLoader(this.manager);ve.setPath(this.resourcePath||p).setCrossOrigin(this.crossOrigin);let Le;n.TGALoader&&(Le=new n.TGALoader(this.manager),Le.setPath(this.resourcePath||p));const ot=[];let Gt={},yn=0;const Ht={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};J(ys,"library_animations","animation",ce),J(ys,"library_animation_clips","animation_clip",tt),J(ys,"library_controllers","controller",Ut),J(ys,"library_images","image",Li),J(ys,"library_effects","effect",fi),J(ys,"library_materials","material",Sr),J(ys,"library_cameras","camera",Zr),J(ys,"library_lights","light",Di),J(ys,"library_geometries","geometry",Ae),J(ys,"library_nodes","node",bo),J(ys,"library_visual_scenes","visual_scene",Tp),J(ys,"library_kinematics_models","kinematics_model",mr),J(ys,"library_physics_models","physics_model",xo),J(ys,"scene","instance_kinematics_scene",No),H(Ht.animations,Ne),H(Ht.clips,Je),H(Ht.controllers,zn),H(Ht.images,wi),H(Ht.effects,qn),H(Ht.materials,Fr),H(Ht.cameras,vo),H(Ht.lights,se),H(Ht.geometries,me),H(Ht.visualScenes,Uo),ur(),Ia();const En=hc(g(ys,"scene")[0]);return En.animations=ot,we.upAxis==="Z_UP"&&En.quaternion.setFromEuler(new n.Euler(-Math.PI/2,0,0)),En.scale.multiplyScalar(we.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),ot},kinematics:Gt,library:Ht,scene:En}}}n.ColladaLoader=r})(),t.exports=n.ColladaLoader})(GV);var xre=GV.exports;(function(t,e){const n=gd,r=o0,s=mre,u=gre,p=_re,g=vre,l=xre,E=new s,P=new u,O=new g,j=new p,$=new l;function Y(re,_e,J){if(re===void 0)return console.error("Invalid options provided to loadObj()");re=n._validate(re,r.prototype._defaults.loadObj);let H;switch(re.type||(re.type="mtl"),re.type){case"mtl":H=E;break;case"gltf":case"glb":H=O;break;case"fbx":H=j;break;case"dae":H=$;break}P.load(re.mtl,te,()=>null,Se=>{console.warn("No material file found "+Se.stack)});function te(Se){Se&&re.type=="mtl"&&(Se.preload(),H.setMaterials(Se)),H.load(re.obj,Ie=>{let Ne=[];switch(re.type){case"mtl":Ie=Ie.children[0];break;case"gltf":case"glb":case"dae":Ne=Ie.animations,Ie=Ie.scene;break;case"fbx":Ne=Ie.animations;break}Ie.animations=Ne;const ut=n.types.rotation(re.rotation,[0,0,0]),mt=n.types.scale(re.scale,[1,1,1]);Ie.rotation.set(ut[0],ut[1],ut[2]),Ie.scale.set(mt[0],mt[1],mt[2]),re.normalize&&ce(Ie),Ie.name="model";let We=r.prototype._makeGroup(Ie,re);r.prototype._addMethods(We),We.setAnchor(re.anchor),We.setCenter(re.adjustment),We.raycasted=re.raycasted,J(We),_e(We),We.setFixedZoom(re.mapScale),We.idle()},()=>null,Ie=>{console.error("Could not load model file: "+re.obj+` 
 `+Ie.stack),J("Error loading the model")})}function ce(Se){Se.traverse(function(Ie){if(Ie.isMesh){let Ne;Ie.material.type=="MeshStandardMaterial"?(Ie.material.metalness&&(Ie.material.metalness*=.1),Ie.material.glossiness&&(Ie.material.glossiness*=.25),Ne=new THREE.Color(12,12,12)):Ie.material.type=="MeshPhongMaterial"&&(Ie.material.shininess=.1,Ne=new THREE.Color(20,20,20)),Ie.material.specular&&Ie.material.specular.isColor&&(Ie.material.specular=Ne)}})}}t.exports=Y})(zV);var bre=zV.exports,HV={exports:{}};(function(t,e){const n=ju,r=gd,s=o0;function u(p){p=r._validate(p,s.prototype._defaults.line);var g=r.lnglatsToWorld(p.geometry),l=r.normalizeVertices(g),E=r.flattenVectors(l.vertices),P=new n.LineGeometry;P.setPositions(E);let O=new n.LineMaterial({color:p.color,linewidth:p.width,dashed:!1,opacity:p.opacity});return O.resolution.set(window.innerWidth,window.innerHeight),O.isMaterial=!0,O.transparent=!0,O.depthWrite=!1,u=new n.Line2(P,O),u.position.copy(l.position),u.computeLineDistances(),u}t.exports=u,function(){const p=new n.Box3,g=new n.Vector3;class l extends n.InstancedBufferGeometry{constructor(){super(),this.type="LineSegmentsGeometry";const P=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],O=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],j=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(j),this.setAttribute("position",new n.Float32BufferAttribute(P,3)),this.setAttribute("uv",new n.Float32BufferAttribute(O,2))}applyMatrix4(P){const O=this.attributes.instanceStart,j=this.attributes.instanceEnd;return O!==void 0&&(O.applyMatrix4(P),j.applyMatrix4(P),O.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(P){let O;P instanceof Float32Array?O=P:Array.isArray(P)&&(O=new Float32Array(P));const j=new n.InstancedInterleavedBuffer(O,6,1);return this.setAttribute("instanceStart",new n.InterleavedBufferAttribute(j,3,0)),this.setAttribute("instanceEnd",new n.InterleavedBufferAttribute(j,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(P){let O;P instanceof Float32Array?O=P:Array.isArray(P)&&(O=new Float32Array(P));const j=new n.InstancedInterleavedBuffer(O,6,1);return this.setAttribute("instanceColorStart",new n.InterleavedBufferAttribute(j,3,0)),this.setAttribute("instanceColorEnd",new n.InterleavedBufferAttribute(j,3,3)),this}fromWireframeGeometry(P){return this.setPositions(P.attributes.position.array),this}fromEdgesGeometry(P){return this.setPositions(P.attributes.position.array),this}fromMesh(P){return this.fromWireframeGeometry(new n.WireframeGeometry(P.geometry)),this}fromLineSegments(P){const O=P.geometry;if(O.isGeometry){console.error("THREE.LineSegmentsGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.");return}else O.isBufferGeometry&&this.setPositions(O.attributes.position.array);return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new n.Box3);const P=this.attributes.instanceStart,O=this.attributes.instanceEnd;P!==void 0&&O!==void 0&&(this.boundingBox.setFromBufferAttribute(P),p.setFromBufferAttribute(O),this.boundingBox.union(p))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new n.Sphere),this.boundingBox===null&&this.computeBoundingBox();const P=this.attributes.instanceStart,O=this.attributes.instanceEnd;if(P!==void 0&&O!==void 0){const j=this.boundingSphere.center;this.boundingBox.getCenter(j);let $=0;for(let Y=0,re=P.count;Y<re;Y++)g.fromBufferAttribute(P,Y),$=Math.max($,j.distanceToSquared(g)),g.fromBufferAttribute(O,Y),$=Math.max($,j.distanceToSquared(g));this.boundingSphere.radius=Math.sqrt($),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(P){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(P)}}l.prototype.isLineSegmentsGeometry=!0,n.LineSegmentsGeometry=l}(),function(){class p extends n.LineSegmentsGeometry{constructor(){super(),this.type="LineGeometry"}setPositions(l){for(var E=l.length-3,P=new Float32Array(2*E),O=0;O<E;O+=3)P[2*O]=l[O],P[2*O+1]=l[O+1],P[2*O+2]=l[O+2],P[2*O+3]=l[O+3],P[2*O+4]=l[O+4],P[2*O+5]=l[O+5];return super.setPositions(P),this}setColors(l){for(var E=l.length-3,P=new Float32Array(2*E),O=0;O<E;O+=3)P[2*O]=l[O],P[2*O+1]=l[O+1],P[2*O+2]=l[O+2],P[2*O+3]=l[O+3],P[2*O+4]=l[O+4],P[2*O+5]=l[O+5];return super.setColors(P),this}fromLine(l){var E=l.geometry;if(E.isGeometry){console.error("THREE.LineGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.");return}else E.isBufferGeometry&&this.setPositions(E.attributes.position.array);return this}}p.prototype.isLineGeometry=!0,n.LineGeometry=p}(),function(){class p extends n.LineSegmentsGeometry{constructor(l){super(),this.type="WireframeGeometry2",this.fromWireframeGeometry(new n.WireframeGeometry(l))}}p.prototype.isWireframeGeometry2=!0,n.WireframeGeometry2=p}(),function(){n.UniformsLib.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new n.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},n.ShaderLib.line={uniforms:n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.fog,n.UniformsLib.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		varying vec2 vUv;
		varying vec4 worldPos;
		varying vec3 worldStart;
		varying vec3 worldEnd;

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;

			#endif

			float aspect = resolution.x / resolution.y;

			vUv = uv;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			worldStart = start.xyz;
			worldEnd = end.xyz;

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segements overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;
		varying vec4 worldPos;
		varying vec3 worldStart;
		varying vec3 worldEnd;

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		varying vec2 vUv;

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class p extends n.ShaderMaterial{constructor(l){super({type:"LineMaterial",uniforms:n.UniformsUtils.clone(n.ShaderLib.line.uniforms),vertexShader:n.ShaderLib.line.vertexShader,fragmentShader:n.ShaderLib.line.fragmentShader,clipping:!0}),Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(E){this.uniforms.diffuse.value=E}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(E){E===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(E){this.uniforms.linewidth.value=E}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(E){!!E!="USE_DASH"in this.defines&&(this.needsUpdate=!0),E===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(E){this.uniforms.dashScale.value=E}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(E){this.uniforms.dashSize.value=E}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(E){this.uniforms.dashOffset.value=E}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(E){this.uniforms.gapSize.value=E}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(E){this.uniforms.opacity.value=E}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(E){this.uniforms.resolution.value.copy(E)}},alphaToCoverage:{enumerable:!0,get:function(){return"ALPHA_TO_COVERAGE"in this.defines},set:function(E){!!E!="ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),E===!0?(this.defines.ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(l)}}p.prototype.isLineMaterial=!0,n.LineMaterial=p}(),function(){const p=new n.Vector3,g=new n.Vector3,l=new n.Vector4,E=new n.Vector4,P=new n.Vector4,O=new n.Vector3,j=new n.Matrix4,$=new n.Line3,Y=new n.Vector3,re=new n.Box3,_e=new n.Sphere,J=new n.Vector4;class H extends n.Mesh{constructor(ce=new n.LineSegmentsGeometry,Se=new n.LineMaterial({color:Math.random()*16777215})){super(ce,Se),this.type="LineSegments2"}computeLineDistances(){const ce=this.geometry,Se=ce.attributes.instanceStart,Ie=ce.attributes.instanceEnd,Ne=new Float32Array(2*Se.count);for(let mt=0,We=0,Ot=Se.count;mt<Ot;mt++,We+=2)p.fromBufferAttribute(Se,mt),g.fromBufferAttribute(Ie,mt),Ne[We]=We===0?0:Ne[We-1],Ne[We+1]=Ne[We]+p.distanceTo(g);const ut=new n.InstancedInterleavedBuffer(Ne,2,1);return ce.setAttribute("instanceDistanceStart",new n.InterleavedBufferAttribute(ut,1,0)),ce.setAttribute("instanceDistanceEnd",new n.InterleavedBufferAttribute(ut,1,1)),this}raycast(ce,Se){ce.camera===null&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');const Ie=ce.params.Line2!==void 0&&ce.params.Line2.threshold||0,Ne=ce.ray,ut=ce.camera,mt=ut.projectionMatrix,We=this.matrixWorld,Ot=this.geometry,st=this.material,qe=st.resolution,et=st.linewidth+Ie,Q=Ot.attributes.instanceStart,ye=Ot.attributes.instanceEnd,ge=-ut.near,xe=2*Math.max(et/qe.width,et/qe.height);Ot.boundingSphere===null&&Ot.computeBoundingSphere(),_e.copy(Ot.boundingSphere).applyMatrix4(We);const Ce=Math.max(ut.near,_e.distanceToPoint(Ne.origin));J.set(0,0,-Ce,1).applyMatrix4(ut.projectionMatrix),J.multiplyScalar(1/J.w),J.applyMatrix4(ut.projectionMatrixInverse);const tt=Math.abs(xe/J.w)*.5;if(_e.radius+=tt,ce.ray.intersectsSphere(_e)===!1)return;Ot.boundingBox===null&&Ot.computeBoundingBox(),re.copy(Ot.boundingBox).applyMatrix4(We);const Je=Math.max(ut.near,re.distanceToPoint(Ne.origin));J.set(0,0,-Je,1).applyMatrix4(ut.projectionMatrix),J.multiplyScalar(1/J.w),J.applyMatrix4(ut.projectionMatrixInverse);const rt=Math.abs(xe/J.w)*.5;if(re.max.x+=rt,re.max.y+=rt,re.max.z+=rt,re.min.x-=rt,re.min.y-=rt,re.min.z-=rt,ce.ray.intersectsBox(re)!==!1){Ne.at(1,P),P.w=1,P.applyMatrix4(ut.matrixWorldInverse),P.applyMatrix4(mt),P.multiplyScalar(1/P.w),P.x*=qe.x/2,P.y*=qe.y/2,P.z=0,O.copy(P),j.multiplyMatrices(ut.matrixWorldInverse,We);for(let ht=0,Ft=Q.count;ht<Ft;ht++){l.fromBufferAttribute(Q,ht),E.fromBufferAttribute(ye,ht),l.w=1,E.w=1,l.applyMatrix4(j),E.applyMatrix4(j);var Ut=l.z>ge&&E.z>ge;if(Ut)continue;if(l.z>ge){const Li=l.z-E.z,wi=(l.z-ge)/Li;l.lerp(E,wi)}else if(E.z>ge){const Li=E.z-l.z,wi=(E.z-ge)/Li;E.lerp(l,wi)}l.applyMatrix4(mt),E.applyMatrix4(mt),l.multiplyScalar(1/l.w),E.multiplyScalar(1/E.w),l.x*=qe.x/2,l.y*=qe.y/2,E.x*=qe.x/2,E.y*=qe.y/2,$.start.copy(l),$.start.z=0,$.end.copy(E),$.end.z=0;const Nn=$.closestPointToPointParameter(O,!0);$.at(Nn,Y);const zn=n.MathUtils.lerp(l.z,E.z,Nn),rr=zn>=-1&&zn<=1,Gr=O.distanceTo(Y)<et*.5;if(rr&&Gr){$.start.fromBufferAttribute(Q,ht),$.end.fromBufferAttribute(ye,ht),$.start.applyMatrix4(We),$.end.applyMatrix4(We);const Li=new n.Vector3,wi=new n.Vector3;Ne.distanceSqToSegment($.start,$.end,wi,Li),Se.push({point:wi,pointOnLine:Li,distance:Ne.origin.distanceTo(wi),object:this,face:null,faceIndex:ht,uv:null,uv2:null})}}}}}H.prototype.LineSegments2=!0,n.LineSegments2=H}(),function(){class p extends n.LineSegments2{constructor(l=new n.LineGeometry,E=new n.LineMaterial({color:Math.random()*16777215})){super(l,E),this.type="Line2"}}p.prototype.isLine2=!0,n.Line2=p}(),function(){const p=new n.Vector3,g=new n.Vector3;class l extends n.Mesh{constructor(P=new n.LineSegmentsGeometry,O=new n.LineMaterial({color:Math.random()*16777215})){super(P,O),this.type="Wireframe"}computeLineDistances(){const P=this.geometry,O=P.attributes.instanceStart,j=P.attributes.instanceEnd,$=new Float32Array(2*O.count);for(let re=0,_e=0,J=O.count;re<J;re++,_e+=2)p.fromBufferAttribute(O,re),g.fromBufferAttribute(j,re),$[_e]=_e===0?0:$[_e-1],$[_e+1]=$[_e]+p.distanceTo(g);const Y=new n.InstancedInterleavedBuffer($,2,1);return P.setAttribute("instanceDistanceStart",new n.InterleavedBufferAttribute(Y,1,0)),P.setAttribute("instanceDistanceEnd",new n.InterleavedBufferAttribute(Y,1,1)),this}}l.prototype.isWireframe=!0,n.Wireframe=l}()})(HV);var wre=HV.exports,WV={exports:{}};(function(t,e){const n=gd,r=FI,s=o0,u=ju,p=mM;function g(l,E){l=n._validate(l,s.prototype._defaults.tube);let P=[];l.geometry.forEach(re=>{P.push(new u.Vector3(re[0],re[1],re[2]))});const O=new u.CatmullRomCurve3(P);let j=new u.TubeGeometry(O,P.length,l.radius,l.sides,!1),$=r(l),Y=new u.Mesh(j,$);return new p({obj:Y,units:l.units,anchor:l.anchor,adjustment:l.adjustment,bbox:l.bbox,tooltip:l.tooltip,raycasted:l.raycasted})}t.exports=g})(WV);var Ere=WV.exports,qV={exports:{}};(function(t,e){const n=pM;function r(s){this.map=s,this.renderer=new n.CSS2DRenderer,this.renderer.setSize(this.map.getCanvas().clientWidth,this.map.getCanvas().clientHeight),this.renderer.domElement.style.position="absolute",this.renderer.domElement.id="labelCanvas",this.renderer.domElement.style.top=0,this.renderer.domElement.style.zIndex="0",this.map.getCanvasContainer().appendChild(this.renderer.domElement),this.scene,this.camera,this.dispose=function(){this.map.getCanvasContainer().removeChild(this.renderer.domElement),this.renderer.domElement.remove(),this.renderer={}},this.setSize=function(u,p){this.renderer.setSize(u,p)},this.map.on("resize",(function(){this.renderer.setSize(this.map.getCanvas().clientWidth,this.map.getCanvas().clientHeight)}).bind(this)),this.state={reset:function(){}},this.render=async function(u,p){return this.scene=u,this.camera=p,new Promise(g=>{g(this.renderer.render(u,p))})},this.toggleLabels=async function(u,p){return new Promise(g=>{g(this.setVisibility(u,p,this.scene,this.camera,this.renderer))})},this.setVisibility=function(u,p,g,l,E){var P=this.renderer.cacheList;P.forEach(function(O){O.visible!=p&&O.layer===u&&(p&&O.alwaysVisible||!p)&&(O.visible=p,E.renderObject(O,g,l))})}}t.exports=r})(qV);var Sre=qV.exports,$V={exports:{}};(function(t,e){class n{constructor(s,u){this.id=s.layerId,this.type="custom",this.renderingMode="3d",this.opacity=.5,this.buildingsLayerId=s.buildingsLayerId,this.minAltitude=s.minAltitude||.1,this.tb=u}onAdd(s,u){this.map=s;const p=`
			uniform mat4 u_matrix;
			uniform float u_height_factor;
			uniform float u_altitude;
			uniform float u_azimuth;
			attribute vec2 a_pos;
			attribute vec4 a_normal_ed;
			attribute lowp vec2 a_base;
			attribute lowp vec2 a_height;
			void main() {
				float base = max(0.0, a_base.x);
				float height = max(0.0, a_height.x);
				float t = mod(a_normal_ed.x, 2.0);
				vec4 pos = vec4(a_pos, t > 0.0 ? height : base, 1);
				float len = pos.z * u_height_factor / tan(u_altitude);
				pos.x += cos(u_azimuth) * len;
				pos.y += sin(u_azimuth) * len;
				pos.z = 0.0;
				gl_Position = u_matrix * pos;
			}
			`,g=`
			void main() {
				gl_FragColor = vec4(0.0, 0.0, 0.0, 0.7);
			}
			`,l=u.createShader(u.VERTEX_SHADER);u.shaderSource(l,p),u.compileShader(l);const E=u.createShader(u.FRAGMENT_SHADER);u.shaderSource(E,g),u.compileShader(E),this.program=u.createProgram(),u.attachShader(this.program,l),u.attachShader(this.program,E),u.linkProgram(this.program),u.validateProgram(this.program),this.uMatrix=u.getUniformLocation(this.program,"u_matrix"),this.uHeightFactor=u.getUniformLocation(this.program,"u_height_factor"),this.uAltitude=u.getUniformLocation(this.program,"u_altitude"),this.uAzimuth=u.getUniformLocation(this.program,"u_azimuth"),this.aPos=u.getAttribLocation(this.program,"a_pos"),this.aNormal=u.getAttribLocation(this.program,"a_normal_ed"),this.aBase=u.getAttribLocation(this.program,"a_base"),this.aHeight=u.getAttribLocation(this.program,"a_height")}render(s,u){s.useProgram(this.program);const p=this.map.style.sourceCaches.composite,g=p.getVisibleCoordinates().reverse(),l=this.map.getLayer(this.buildingsLayerId),E=this.map.painter.context,{lng:P,lat:O}=this.map.getCenter(),j=this.tb.getSunPosition(this.tb.lightDateTime,[P,O]);s.uniform1f(this.uAltitude,j.altitude>this.minAltitude?j.altitude:0),s.uniform1f(this.uAzimuth,j.azimuth+3*Math.PI/2),s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.getExtension("EXT_blend_minmax"),s.disable(s.DEPTH_TEST);for(const $ of g){const Y=p.getTile($),re=Y.getBucket(l);if(!re)continue;const[_e,J]=re.programConfigurations.programConfigurations[this.buildingsLayerId]._buffers;s.uniformMatrix4fv(this.uMatrix,!1,$.posMatrix),s.uniform1f(this.uHeightFactor,Math.pow(2,$.overscaledZ)/Y.tileSize/8);for(const H of re.segments.get()){const te=E.currentNumAttributes||0,ce=2;for(let Ie=ce;Ie<te;Ie++)s.disableVertexAttribArray(Ie);const Se=H.vertexOffset||0;s.enableVertexAttribArray(this.aPos),s.enableVertexAttribArray(this.aNormal),s.enableVertexAttribArray(this.aHeight),s.enableVertexAttribArray(this.aBase),re.layoutVertexBuffer.bind(),s.vertexAttribPointer(this.aPos,2,s.SHORT,!1,12,12*Se),s.vertexAttribPointer(this.aNormal,4,s.SHORT,!1,12,4+12*Se),_e.bind(),s.vertexAttribPointer(this.aHeight,1,s.FLOAT,!1,4,4*Se),J.bind(),s.vertexAttribPointer(this.aBase,1,s.FLOAT,!1,4,4*Se),re.indexBuffer.bind(),E.currentNumAttributes=ce,s.drawElements(s.TRIANGLES,H.primitiveLength*3,s.UNSIGNED_SHORT,H.primitiveOffset*3*2)}}}}t.exports=n})($V);var Tre=$V.exports;(function(t,e){const n=ju,r=lre,s=gd,u=ure,p=OI,g=o0,l=FI,E=hre,P=dre,O=fre,j=pre,$=bre,Y=mM,re=wre,_e=Ere,J=Sre,H=Tre;function te(Se,Ie,Ne){this.init(Se,Ie,Ne)}te.prototype={repaint:function(){this.map.repaint=!0},init:function(Se,Ie,Ne){this.options=s._validate(Ne||{},ce),this.map=Se,this.map.tb=this,this.objects=new g,this.mapboxVersion=parseFloat(this.map.version),this.renderer=new n.WebGLRenderer({alpha:!0,antialias:!0,preserveDrawingBuffer:Ne.preserveDrawingBuffer,canvas:Se.getCanvas(),context:Ie}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.map.getCanvas().clientWidth,this.map.getCanvas().clientHeight),this.renderer.outputEncoding=n.sRGBEncoding,this.renderer.autoClear=!1,this.labelRenderer=new J(this.map),this.scene=new n.Scene,this.world=new n.Group,this.world.name="world",this.scene.add(this.world),this.objectsCache=new Map,this.zoomLayers=[],this.fov=this.options.fov,this.orthographic=this.options.orthographic||!1,this.raycaster=new n.Raycaster,this.raycaster.layers.set(0),this.mapCenter=this.map.getCenter(),this.mapCenterUnits=s.projectToWorld([this.mapCenter.lng,this.mapCenter.lat]),this.lightDateTime=new Date,this.lightLng=this.mapCenter.lng,this.lightLat=this.mapCenter.lat,this.sunPosition,this.rotationStep=5,this.gridStep=6,this.altitudeStep=.1,this.defaultCursor="default",this.lights=this.initLights,this.options.defaultLights&&this.defaultLights(),this.options.realSunlight&&this.realSunlight(this.options.realSunlightHelper),this.skyLayerName="sky-layer",this.terrainSourceName="mapbox-dem",this.terrainExaggeration=1,this.terrainLayerName="",this.enableSelectingFeatures=this.options.enableSelectingFeatures||!1,this.enableSelectingObjects=this.options.enableSelectingObjects||!1,this.enableDraggingObjects=this.options.enableDraggingObjects||!1,this.enableRotatingObjects=this.options.enableRotatingObjects||!1,this.enableTooltips=this.options.enableTooltips||!1,this.multiLayer=this.options.multiLayer||!1,this.enableHelpTooltips=this.options.enableHelpTooltips||!1,this.map.on("style.load",function(){this.tb.zoomLayers=[],this.tb.options.multiLayer&&this.addLayer({id:"threebox_layer",type:"custom",renderingMode:"3d",map:this,onAdd:function(mt,We){},render:function(mt,We){this.map.tb.update()}}),this.once("idle",()=>{this.tb.setObjectsScale()}),this.tb.options.sky&&(this.tb.sky=!0),this.tb.options.terrain&&(this.tb.terrain=!0),["satellite","mapbox-mapbox-satellite","satelliteLayer"].forEach(mt=>{this.getLayer(mt)&&(this.tb.terrainLayerName=mt)})}),this.map.on("load",function(){this.selectedObject,this.selectedFeature,this.draggedObject;let ut;this.overedObject,this.overedFeature;let mt=this.getCanvasContainer();this.getCanvasContainer().style.cursor=this.tb.defaultCursor;let We,Ot=[],st,qe,et,Q;function ye(ht){var Ft=mt.getBoundingClientRect();return{x:ht.originalEvent.clientX-Ft.left-mt.clientLeft,y:ht.originalEvent.clientY-Ft.top-mt.clientTop}}this.unselectObject=function(){this.selectedObject.selected=!1,this.selectedObject=null},this.outObject=function(){this.overedObject.over=!1,this.overedObject=null},this.unselectFeature=function(ht){typeof ht.id>"u"||(this.setFeatureState({source:ht.source,sourceLayer:ht.sourceLayer,id:ht.id},{select:!1}),this.removeTooltip(ht),ht=this.queryRenderedFeatures({layers:[ht.layer.id],filter:["==",["id"],ht.id]})[0],ht&&this.fire("SelectedFeatureChange",{detail:ht}),this.selectedFeature=null)},this.selectFeature=function(ht){this.selectedFeature=ht,this.setFeatureState({source:this.selectedFeature.source,sourceLayer:this.selectedFeature.sourceLayer,id:this.selectedFeature.id},{select:!0}),this.selectedFeature=this.queryRenderedFeatures({layers:[this.selectedFeature.layer.id],filter:["==",["id"],this.selectedFeature.id]})[0],this.addTooltip(this.selectedFeature),this.fire("SelectedFeatureChange",{detail:this.selectedFeature})},this.outFeature=function(ht){this.overedFeature&&typeof this.overedFeature<"u"&&this.overedFeature.id!=ht&&(Se.setFeatureState({source:this.overedFeature.source,sourceLayer:this.overedFeature.sourceLayer,id:this.overedFeature.id},{hover:!1}),this.removeTooltip(this.overedFeature),this.overedFeature=null)},this.addTooltip=function(ht){if(!this.tb.enableTooltips)return;let Ft=this.tb.getFeatureCenter(ht),Nn=this.tb.tooltip({text:ht.properties.name||ht.id||ht.type,mapboxStyle:!0,feature:ht});Nn.setCoords(Ft),this.tb.add(Nn,ht.layer.id),ht.tooltip=Nn,ht.tooltip.tooltip.visible=!0},this.removeTooltip=function(ht){ht.tooltip&&(ht.tooltip.visibility=!1,this.tb.remove(ht.tooltip),ht.tooltip=null)},Se.onContextMenu=function(ht){alert("contextMenu")},this.onClick=function(ht){let Ft,Nn=[];if(Se.tb.enableSelectingObjects&&(Nn=this.tb.queryRenderedFeatures(ht.point)),Ft=typeof Nn[0]=="object",Ft){let zn=te.prototype.findParent3DObject(Nn[0]);if(zn){if(this.selectedFeature&&this.unselectFeature(this.selectedFeature),!this.selectedObject)this.selectedObject=zn,this.selectedObject.selected=!0;else if(this.selectedObject.uuid!=zn.uuid)this.selectedObject.selected=!1,zn.selected=!0,this.selectedObject=zn;else if(this.selectedObject.uuid==zn.uuid){this.unselectObject();return}this.selectedObject.dispatchEvent({type:"Wireframed",detail:this.selectedObject}),this.selectedObject.dispatchEvent({type:"IsPlayingChanged",detail:this.selectedObject}),this.repaint=!0,ht.preventDefault()}}else{let zn=[];if(Se.tb.enableSelectingFeatures&&(zn=this.queryRenderedFeatures(ht.point)),zn.length>0&&zn[0].layer.type=="fill-extrusion"&&typeof zn[0].id<"u"){if(this.selectedObject&&this.unselectObject(),!this.selectedFeature)this.selectFeature(zn[0]);else if(this.selectedFeature.id!=zn[0].id)this.unselectFeature(this.selectedFeature),this.selectFeature(zn[0]);else if(this.selectedFeature.id==zn[0].id){this.unselectFeature(this.selectedFeature);return}}}},this.onMouseMove=function(ht){let Ft=ye(ht);if(this.getCanvasContainer().style.cursor=this.tb.defaultCursor,ht.originalEvent.altKey&&this.draggedObject){if(!Se.tb.enableRotatingObjects)return;ut="rotate",this.getCanvasContainer().style.cursor="move",Math.min(We.x,Ft.x),Math.max(We.x,Ft.x),Math.min(We.y,Ft.y),Math.max(We.y,Ft.y);let rr={x:0,y:0,z:Math.round(Q[2]+~~((Ft.x-We.x)/this.tb.rotationStep)%360*this.tb.rotationStep%360)};this.draggedObject.setRotation(rr),Se.tb.enableHelpTooltips&&this.draggedObject.addHelp("rot: "+rr.z+"&#176;");return}if(ht.originalEvent.shiftKey&&this.draggedObject){if(!Se.tb.enableDraggingObjects)return;ut="translate",this.getCanvasContainer().style.cursor="move";let rr=ht.lngLat,Gr=[Number((rr.lng+st).toFixed(this.tb.gridStep)),Number((rr.lat+qe).toFixed(this.tb.gridStep)),this.draggedObject.modelHeight];this.draggedObject.setCoords(Gr),Se.tb.enableHelpTooltips&&this.draggedObject.addHelp("lng: "+Gr[0]+"&#176;, lat: "+Gr[1]+"&#176;");return}if(ht.originalEvent.ctrlKey&&this.draggedObject){if(!Se.tb.enableDraggingObjects)return;ut="altitude",this.getCanvasContainer().style.cursor="move";let rr=ht.point.y*this.tb.altitudeStep,Gr=[this.draggedObject.coordinates[0],this.draggedObject.coordinates[1],Number((-rr-et).toFixed(this.tb.gridStep))];this.draggedObject.setCoords(Gr),Se.tb.enableHelpTooltips&&this.draggedObject.addHelp("alt: "+Gr[2]+"m");return}let Nn,zn=[];if(Se.tb.enableSelectingObjects&&(zn=this.tb.queryRenderedFeatures(ht.point)),Nn=typeof zn[0]=="object",Nn){let rr=te.prototype.findParent3DObject(zn[0]);rr&&(this.outFeature(this.overedFeature),this.getCanvasContainer().style.cursor="pointer",!this.selectedObject||rr.uuid!=this.selectedObject.uuid?(this.overedObject&&this.overedObject.uuid!=rr.uuid&&this.outObject(),rr.over=!0,this.overedObject=rr):this.selectedObject&&rr.uuid==this.selectedObject.uuid&&(rr.over=!0,this.overedObject=rr),this.repaint=!0,ht.preventDefault())}else{this.overedObject&&this.outObject();let rr=[];Se.tb.enableSelectingFeatures&&(rr=this.queryRenderedFeatures(ht.point)),rr.length>0&&(this.outFeature(rr[0]),rr[0].layer.type=="fill-extrusion"&&typeof rr[0].id<"u"&&(!this.selectedFeature||this.selectedFeature.id!=rr[0].id)&&(this.getCanvasContainer().style.cursor="pointer",this.overedFeature=rr[0],this.setFeatureState({source:this.overedFeature.source,sourceLayer:this.overedFeature.sourceLayer,id:this.overedFeature.id},{hover:!0}),this.overedFeature=Se.queryRenderedFeatures({layers:[this.overedFeature.layer.id],filter:["==",["id"],this.overedFeature.id]})[0],this.addTooltip(this.overedFeature)))}},this.onMouseDown=function(ht){(ht.originalEvent.shiftKey||ht.originalEvent.altKey||ht.originalEvent.ctrlKey)&&ht.originalEvent.button===0&&this.selectedObject&&(!Se.tb.enableDraggingObjects&&!Se.tb.enableRotatingObjects||(ht.preventDefault(),Se.getCanvasContainer().style.cursor="move",Se.once("mouseup",this.onMouseUp),this.draggedObject=this.selectedObject,We=ye(ht),Ot=this.draggedObject.coordinates,Q=s.degreeify(this.draggedObject.rotation),st=Ot[0]-ht.lngLat.lng,qe=Ot[1]-ht.lngLat.lat,et=-this.draggedObject.modelHeight-ht.point.y*this.tb.altitudeStep))},this.onMouseUp=function(ht){this.getCanvasContainer().style.cursor=this.tb.defaultCursor,this.off("mouseup",this.onMouseUp),this.off("mouseout",this.onMouseUp),this.dragPan.enable(),this.draggedObject&&(this.draggedObject.dispatchEvent({type:"ObjectDragged",detail:{draggedObject:this.draggedObject,draggedAction:ut}}),this.draggedObject.removeHelp(),this.draggedObject=null,ut=null)},this.onMouseOut=function(ht){if(this.overedFeature){let Ft=this.queryRenderedFeatures(ht.point);Ft.length>0&&this.overedFeature.id!=Ft[0].id&&(this.getCanvasContainer().style.cursor=this.tb.defaultCursor,this.outFeature(Ft[0]))}},this.onZoom=function(ht){this.tb.zoomLayers.forEach(Ft=>{this.tb.toggleLayer(Ft)}),this.tb.setObjectsScale()};let ge=!1,xe=17,Ce=91,tt=16,Je=83;function rt(ht){ht.which===xe||ht.which,ht.which===tt&&(ge=!0);let Ft=this.selectedObject;if(ge&&ht.which===Je&&Ft){let Nn=s.toDecimal;if(Ft.help)Ft.removeHelp();else{let zn=Ft.modelSize,rr=1;Ft.userData.units!=="meters"&&(rr=s.projectedUnitsPerMeter(Ft.coordinates[1]),rr||(rr=1),rr=Nn(rr,7)),Se.tb.enableHelpTooltips&&Ft.addHelp("size(m): "+Nn(zn.x/rr,3)+" W, "+Nn(zn.y/rr,3)+" L, "+Nn(zn.z/rr,3)+" H"),this.repaint=!0}return!1}}function Ut(ht){ht.which==xe||ht.which==Ce,ht.which===tt&&(ge=!1)}this.on("click",this.onClick),this.on("mousemove",this.onMouseMove),this.on("mouseout",this.onMouseOut),this.on("mousedown",this.onMouseDown),this.on("zoom",this.onZoom),this.on("zoomend",this.onZoom),document.addEventListener("keydown",rt.bind(this),!0),document.addEventListener("keyup",Ut.bind(this))})},get sky(){return this.options.sky},set sky(Se){Se?this.createSkyLayer():this.removeLayer(this.skyLayerName),this.options.sky=Se},get terrain(){return this.options.terrain},set terrain(Se){if(this.terrainLayerName="",Se)this.createTerrainLayer();else{if(this.mapboxVersion<2){console.warn("Terrain layer are only supported by Mapbox-gl-js > v2.0");return}this.map.getTerrain()&&(this.map.setTerrain(null),this.map.removeSource(this.terrainSourceName))}this.options.terrain=Se},get fov(){return this.options.fov},set fov(Se){this.camera instanceof n.PerspectiveCamera&&this.options.fov!==Se&&(this.map.transform.fov=Se,this.camera.fov=this.map.transform.fov,this.cameraSync.setupCamera(),this.map.repaint=!0,this.options.fov=Se)},get orthographic(){return this.options.orthographic},set orthographic(Se){const Ie=this.map.getCanvas().clientHeight,Ne=this.map.getCanvas().clientWidth;Se?(this.map.transform.fov=0,this.camera=new n.OrthographicCamera(Ne/-2,Ne/2,Ie/2,Ie/-2,.1,1e21)):(this.map.transform.fov=this.fov,this.camera=new n.PerspectiveCamera(this.map.transform.fov,Ne/Ie,.1,1e21)),this.camera.layers.enable(0),this.camera.layers.enable(1),this.cameraSync=new r(this.map,this.camera,this.world),this.map.repaint=!0,this.options.orthographic=Se},createSkyLayer:function(){if(this.mapboxVersion<2){console.warn("Sky layer are only supported by Mapbox-gl-js > v2.0"),this.options.sky=!1;return}this.map.getLayer(this.skyLayerName)||(this.map.addLayer({id:this.skyLayerName,type:"sky",paint:{"sky-opacity":["interpolate",["linear"],["zoom"],0,0,5,.3,8,1],"sky-type":"atmosphere","sky-atmosphere-sun":this.getSunSky(this.lightDateTime),"sky-atmosphere-sun-intensity":10}}),this.map.once("idle",()=>{this.setSunlight(),this.repaint()}))},createTerrainLayer:function(){if(this.mapboxVersion<2){console.warn("Terrain layer are only supported by Mapbox-gl-js > v2.0"),this.options.terrain=!1;return}this.map.getTerrain()||(this.map.addSource(this.terrainSourceName,{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),this.map.setTerrain({source:this.terrainSourceName,exaggeration:this.terrainExaggeration}),this.map.once("idle",()=>{this.cameraSync.updateCamera(),this.repaint()}))},sphere:function(Se){return this.setDefaultView(Se,this.options),E(Se,this.world)},line:re,label:O,tooltip:j,tube:function(Se){return this.setDefaultView(Se,this.options),_e(Se,this.world)},extrusion:function(Se){return this.setDefaultView(Se,this.options),P(Se)},Object3D:function(Se){return this.setDefaultView(Se,this.options),Y(Se)},loadObj:async function(Ie,Ne){if(this.setDefaultView(Ie,this.options),Ie.clone===!1)return new Promise(async ut=>{$(Ie,Ne,async mt=>{ut(mt)})});{let ut=this.objectsCache.get(Ie.obj);ut?ut.promise.then(mt=>{Ne(mt.duplicate(Ie))}).catch(mt=>{this.objectsCache.delete(Ie.obj),console.error("Could not load model file: "+Ie.obj)}):this.objectsCache.set(Ie.obj,{promise:new Promise(async(mt,We)=>{$(Ie,Ne,async Ot=>{Ot.duplicate?mt(Ot.duplicate()):We(Ot)})})})}},material:function(Se){return l(Se)},initLights:{ambientLight:null,dirLight:null,dirLightBack:null,dirLightHelper:null,hemiLight:null,pointLight:null},utils:s,SunCalc:u,Constants:p,projectToWorld:function(Se){return this.utils.projectToWorld(Se)},unprojectFromWorld:function(Se){return this.utils.unprojectFromWorld(Se)},projectedUnitsPerMeter:function(Se){return this.utils.projectedUnitsPerMeter(Se)},getFeatureCenter:function(Ie,Ne,ut){return s.getFeatureCenter(Ie,Ne,ut)},getObjectHeightOnFloor:function(Se,Ie,Ne){return s.getObjectHeightOnFloor(Se,Ie,Ne)},queryRenderedFeatures:function(Se){let Ie=new n.Vector2;return Ie.x=Se.x/this.map.transform.width*2-1,Ie.y=1-Se.y/this.map.transform.height*2,this.raycaster.setFromCamera(Ie,this.camera),this.raycaster.intersectObjects(this.world.children,!0)},findParent3DObject:function(Se){var Ie;return Se.object.traverseAncestors(function(Ne){Ne.parent&&Ne.parent.type=="Group"&&Ne.userData.obj&&(Ie=Ne)}),Ie},setLayoutProperty:function(Se,Ie,Ne){this.map.setLayoutProperty(Se,Ie,Ne),Ne!=null&&Ie==="visibility"&&this.world.children.filter(ut=>ut.layer===Se).forEach(ut=>{ut.visibility=Ne})},setLayerZoomRange:function(Se,Ie,Ne){this.map.getLayer(Se)&&(this.map.setLayerZoomRange(Se,Ie,Ne),this.zoomLayers.includes(Se)||this.zoomLayers.push(Se),this.toggleLayer(Se))},setLayerHeigthProperty:function(Se,Ie){let Ne=this.map.getLayer(Se);if(Ne)if(Ne.type=="fill-extrusion"){let ut=this.map.getStyle().sources[Ne.source].data;ut.features.forEach(function(We){We.properties.level=Ie}),this.map.getSource(Ne.source).setData(ut)}else Ne.type=="custom"&&this.world.children.forEach(function(ut){let mt=ut.userData.feature;if(mt&&mt.layer===Se){let We=this.tb.getFeatureCenter(mt,ut,Ie);ut.setCoords(We)}})},setObjectsScale:function(){this.world.children.filter(Se=>Se.fixedZoom!=null).forEach(Se=>{Se.setObjectScale(this.map.transform.scale)})},setStyle:function(Se,Ie){this.clear().then(()=>{this.map.setStyle(Se,Ie)})},toggleLayer:function(Se,Ie=!0){let Ne=this.map.getLayer(Se);if(Ne){if(!Ie){this.toggle(Ne.id,!1);return}let ut=this.map.getZoom();if(Ne.minzoom&&ut<Ne.minzoom){this.toggle(Ne.id,!1);return}if(Ne.maxzoom&&ut>=Ne.maxzoom){this.toggle(Ne.id,!1);return}this.toggle(Ne.id,!0)}},toggle:function(Se,Ie){this.setLayoutProperty(Se,"visibility",Ie?"visible":"none"),this.labelRenderer.toggleLabels(Se,Ie)},update:function(){this.map.repaint&&(this.map.repaint=!1);var Se=Date.now();this.objects.animationManager.update(Se),this.updateLightHelper(),this.renderer.resetState(),this.renderer.render(this.scene,this.camera),this.labelRenderer.render(this.scene,this.camera),this.options.passiveRendering===!1&&this.map.triggerRepaint()},add:function(Se,Ie,Ne){if(!this.enableTooltips&&Se.tooltip&&(Se.tooltip.visibility=!1),this.world.add(Se),Ie){Se.layer=Ie,Se.source=Ne;let ut=this.map.getLayer(Ie);if(ut){let mt=ut.visibility,We=typeof mt>"u";Se.visibility=!!(We||mt==="visible")}}},removeByName:function(Se){let Ie=this.world.getObjectByName(Se);Ie&&this.remove(Ie)},remove:function(Se){this.map.selectedObject&&Se.uuid==this.map.selectedObject.uuid&&this.map.unselectObject(),this.map.draggedObject&&Se.uuid==this.map.draggedObject.uuid&&(this.map.draggedObject=null),Se.dispose&&Se.dispose(),this.world.remove(Se),Se=null},clear:async function(Se=null,Ie=!1){return new Promise((Ne,ut)=>{let mt=[];this.world.children.forEach(function(We){mt.push(We)});for(let We=0;We<mt.length;We++){let Ot=mt[We];(Ot.layer===Se||!Se)&&this.remove(Ot)}Ie&&this.objectsCache.forEach(We=>{We.promise.then(Ot=>{Ot.dispose(),Ot=null})}),Ne("clear")})},removeLayer:function(Se){this.clear(Se,!0).then(()=>{this.map.removeLayer(Se)})},getSunPosition:function(Se,Ie){return u.getPosition(Se||Date.now(),Ie[1],Ie[0])},getSunTimes:function(Se,Ie){return u.getTimes(Se,Ie[1],Ie[0],Ie[2]?Ie[2]:0)},setBuildingShadows:function(Se){if(this.map.getLayer(Se.buildingsLayerId)){let Ie=new H(Se,this);this.map.addLayer(Ie,Se.buildingsLayerId)}else console.warn("The layer '"+Se.buildingsLayerId+"' does not exist in the map.")},setSunlight:function(Se=new Date,Ie){if(!this.lights.dirLight||!this.options.realSunlight){console.warn("To use setSunlight it's required to set realSunlight : true in Threebox initial options.");return}var Ne=new Date(Se.getTime());if(Ie?Ie.lng&&Ie.lat?this.mapCenter=Ie:this.mapCenter={lng:Ie[0],lat:Ie[1]}:this.mapCenter=this.map.getCenter(),this.lightDateTime&&this.lightDateTime.getTime()===Ne.getTime()&&this.lightLng===this.mapCenter.lng&&this.lightLat===this.mapCenter.lat)return;this.lightDateTime=Ne,this.lightLng=this.mapCenter.lng,this.lightLat=this.mapCenter.lat,this.sunPosition=this.getSunPosition(Ne,[this.mapCenter.lng,this.mapCenter.lat]);let ut=this.sunPosition.altitude,mt=Math.PI+this.sunPosition.azimuth,We=p.WORLD_SIZE/2,Ot=Math.sin(ut),st=Math.cos(ut),qe=Math.cos(mt)*st,et=Math.sin(mt)*st;this.lights.dirLight.position.set(et,qe,Ot),this.lights.dirLight.position.multiplyScalar(We),this.lights.dirLight.intensity=Math.max(Ot,0),this.lights.hemiLight.intensity=Math.max(Ot*1,.1),this.lights.dirLight.updateMatrixWorld(),this.updateLightHelper(),this.map.loaded()&&(this.updateSunGround(this.sunPosition),this.map.setLight({anchor:"map",position:[3,180+this.sunPosition.azimuth*180/Math.PI,90-this.sunPosition.altitude*180/Math.PI],intensity:Math.cos(this.sunPosition.altitude),color:`hsl(40, ${50*Math.cos(this.sunPosition.altitude)}%, ${Math.max(20,20+96*Math.sin(this.sunPosition.altitude))}%)`},{duration:0}),this.sky&&this.updateSunSky(this.getSunSky(Ne,this.sunPosition)))},getSunSky:function(Se,Ie){if(!Ie){var Ne=this.map.getCenter();Ie=this.getSunPosition(Se||Date.now(),[Ne.lng,Ne.lat])}var ut=180+Ie.azimuth*180/Math.PI,mt=90-Ie.altitude*180/Math.PI;return[ut,mt]},updateSunSky:function(Se){this.sky&&this.map.setPaintProperty(this.skyLayerName,"sky-atmosphere-sun",Se)},updateSunGround:function(Se){this.terrainLayerName!=""&&this.map.setPaintProperty(this.terrainLayerName,"raster-opacity",Math.max(Math.min(1,Se.altitude*4),.25))},updateLightHelper:function(){this.lights.dirLightHelper&&(this.lights.dirLightHelper.position.setFromMatrixPosition(this.lights.dirLight.matrixWorld),this.lights.dirLightHelper.updateMatrix(),this.lights.dirLightHelper.update())},dispose:async function(){return console.log(this.memory()),new Promise(Se=>{Se(this.clear(null,!0).then(Ie=>(this.map.remove(),this.map={},this.scene.remove(this.world),this.world.children=[],this.world=null,this.objectsCache.clear(),this.labelRenderer.dispose(),console.log(this.memory()),this.renderer.dispose(),Ie)))})},defaultLights:function(){this.lights.ambientLight=new n.AmbientLight(new n.Color("hsl(0, 0%, 100%)"),.75),this.scene.add(this.lights.ambientLight),this.lights.dirLightBack=new n.DirectionalLight(new n.Color("hsl(0, 0%, 100%)"),.25),this.lights.dirLightBack.position.set(30,100,100),this.scene.add(this.lights.dirLightBack),this.lights.dirLight=new n.DirectionalLight(new n.Color("hsl(0, 0%, 100%)"),.25),this.lights.dirLight.position.set(-30,100,-100),this.scene.add(this.lights.dirLight)},realSunlight:function(Se=!1){this.renderer.shadowMap.enabled=!0,this.lights.dirLight=new n.DirectionalLight(16777215,1),this.scene.add(this.lights.dirLight),Se&&(this.lights.dirLightHelper=new n.DirectionalLightHelper(this.lights.dirLight,5),this.scene.add(this.lights.dirLightHelper));let Ie=1e3,Ne=2,ut=8192;this.lights.dirLight.castShadow=!0,this.lights.dirLight.shadow.radius=Ne,this.lights.dirLight.shadow.mapSize.width=ut,this.lights.dirLight.shadow.mapSize.height=ut,this.lights.dirLight.shadow.camera.top=this.lights.dirLight.shadow.camera.right=Ie,this.lights.dirLight.shadow.camera.bottom=this.lights.dirLight.shadow.camera.left=-Ie,this.lights.dirLight.shadow.camera.near=1,this.lights.dirLight.shadow.camera.visible=!0,this.lights.dirLight.shadow.camera.far=4e8,this.lights.hemiLight=new n.HemisphereLight(new n.Color(16777215),new n.Color(16777215),.6),this.lights.hemiLight.color.setHSL(.661,.96,.12),this.lights.hemiLight.groundColor.setHSL(.11,.96,.14),this.lights.hemiLight.position.set(0,0,50),this.scene.add(this.lights.hemiLight),this.setSunlight(),this.map.once("idle",()=>{this.setSunlight(),this.repaint()})},setDefaultView:function(Se,Ie){Se.bbox=(Se.bbox||Se.bbox==null)&&Ie.enableSelectingObjects,Se.tooltip=(Se.tooltip||Se.tooltip==null)&&Ie.enableTooltips,Se.mapScale=this.map.transform.scale},memory:function(){return this.renderer.info.memory},programs:function(){return this.renderer.info.programs.length},version:"2.2.7"};var ce={defaultLights:!1,realSunlight:!1,realSunlightHelper:!1,passiveRendering:!0,preserveDrawingBuffer:!1,enableSelectingFeatures:!1,enableSelectingObjects:!1,enableDraggingObjects:!1,enableRotatingObjects:!1,enableTooltips:!1,enableHelpTooltips:!1,multiLayer:!1,orthographic:!1,fov:p.FOV_DEGREES,sky:!1,terrain:!1};t.exports=te})(EV);var Mre=EV.exports;(function(t,e){t.exports={Threebox:Mre,THREE:ju}})(wV);var v1=wV.exports;const kre="FeatureCollection",Cre="utvalget_naturtyper_Ullevaal",Ire={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},Are=[{type:"Feature",properties:{identifika:"UN-BN00063736",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063736",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063736",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Havna all 13",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7126742076,59.9386939741],[10.7126055053,59.9386820261],[10.7125383361,59.9386831662],[10.7125001394,59.9386930726],[10.7124740881,59.9387434782],[10.7124925093,59.9387825634],[10.7125043299,59.9388186461],[10.7125523519,59.9388422398],[10.7125830136,59.9388476441],[10.7126397034,59.9388499394],[10.7126897824,59.9388396105],[10.7127316517,59.9388220907],[10.7127559994,59.9387945589],[10.7127594226,59.9387736292],[10.7127356318,59.9387400342],[10.7127123424,59.9387136491],[10.7126742076,59.9386939741]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064187",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064187",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064187",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Hartvig Halvorsens vei",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.704321832,59.9375244708],[10.7042790152,59.9375368318],[10.7042531102,59.9375555892],[10.7042451783,59.937596064],[10.7042383648,59.9376583358],[10.7042386665,59.9377320797],[10.7042384902,59.9377942982],[10.7042559314,59.9378712988],[10.7042475143,59.9379016868],[10.7043735087,59.938010823],[10.7044617479,59.9380365409],[10.7045138127,59.9380039799],[10.7045517491,59.9379615165],[10.7045296831,59.9379215918],[10.7045306812,59.9378779235],[10.7045864357,59.9378569925],[10.7046437183,59.9378629973],[10.7047269932,59.9378551031],[10.7047594409,59.9378328724],[10.7047675885,59.9377353956],[10.7047483143,59.9376836027],[10.7047154391,59.9376302871],[10.7045942839,59.9375529608],[10.7045024013,59.9375221785],[10.7044721427,59.9375192132],[10.7043984458,59.9375168092],[10.704321832,59.9375244708]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064243",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064243",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064243",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Nils Tollers vei 10",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7265524353,59.936700556],[10.7264421932,59.9366549865],[10.7263020646,59.9366828093],[10.7262180282,59.9367189266],[10.7262269167,59.9367709181],[10.7261184181,59.9367994076],[10.7260255398,59.936852682],[10.7260016826,59.9369321148],[10.7261001858,59.9369839576],[10.7261285211,59.9370296566],[10.7261190641,59.9370807829],[10.7262382231,59.9372184486],[10.7263354508,59.9372482199],[10.7264510637,59.9372437894],[10.7265950641,59.9371748195],[10.7267039401,59.9371573118],[10.7268405219,59.9371764906],[10.7269334643,59.9372353458],[10.7268274104,59.9373046482],[10.7267491906,59.9373289955],[10.7267505486,59.9373685137],[10.7268587078,59.9374010671],[10.7269810396,59.9374140285],[10.7271159225,59.9374005115],[10.7272744192,59.9373636625],[10.7274302142,59.9372309627],[10.7273088647,59.9370462898],[10.7270329014,59.9369587469],[10.7268373121,59.9368440486],[10.7270240702,59.9368256511],[10.72714395,59.9367519416],[10.7272496855,59.9366002636],[10.7272000195,59.9365629545],[10.7271312715,59.9365457973],[10.7265524353,59.936700556]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064245",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064245",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064245",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Blindern - biologibygget",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7225439637,59.9374630299],[10.7225709248,59.9374276685],[10.7224369535,59.9373660386],[10.7220306589,59.9375873475],[10.7217308658,59.9377956604],[10.7218376399,59.937840312],[10.7219967959,59.9378650848],[10.7221049433,59.9378393745],[10.72220645,59.9377817972],[10.7223191207,59.9377446343],[10.7224127055,59.9377804046],[10.7227597091,59.9378423001],[10.7228459843,59.9378361106],[10.7229003907,59.9378046978],[10.7229142804,59.9377789826],[10.7228944763,59.9377421922],[10.7227416724,59.9376431743],[10.7226760572,59.9375558902],[10.7225922845,59.9375135151],[10.7225439637,59.9374630299]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088702",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088702",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088702",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Jutulveien 8",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7379318043,59.9430257613],[10.7378963438,59.9430046521],[10.7378414984,59.9429991006],[10.7377664965,59.9430011692],[10.7376928366,59.9430304363],[10.7376825258,59.9430729933],[10.7377013127,59.9430927538],[10.7377494112,59.9431340539],[10.7378207056,59.9431357318],[10.7378917809,59.9431195989],[10.7379324855,59.9430985267],[10.7379251609,59.9430551292],[10.7379318043,59.9430257613]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063686",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063686",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063686",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Blindern Rehabiliteringshjem",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7273112327,59.9360336179],[10.7273015173,59.9360700792],[10.7273203956,59.9360973974],[10.7273978732,59.9361413636],[10.7273765138,59.9361750193],[10.7274421692,59.9362161741],[10.7275421401,59.9362482815],[10.7275999321,59.9362503364],[10.7276565796,59.9362278964],[10.727642918,59.936130881],[10.7275747221,59.9360969273],[10.7275679269,59.9360245025],[10.7274567818,59.9359998555],[10.7273563782,59.9360142217],[10.7273112327,59.9360336179]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063688",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063688",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063688",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Bergsalleen 6",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7348762627,59.9457473818],[10.734841965,59.9457172277],[10.7347760722,59.9457111375],[10.7347142223,59.9456931292],[10.7347121755,59.9456533193],[10.7346511941,59.9456494561],[10.7345909831,59.945661893],[10.734540968,59.9456884175],[10.7345619176,59.9457303682],[10.7346145544,59.9457531136],[10.734704773,59.9457777055],[10.7347987183,59.9457858731],[10.7348681019,59.9457731937],[10.7348762627,59.9457473818]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063691",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063691",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063691",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Bergsalleen 16",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7365463307,59.9467679779],[10.7364866542,59.9467609209],[10.7364507001,59.9467896096],[10.7364201237,59.9468322299],[10.7364316907,59.9468718983],[10.7364952991,59.9469250306],[10.7366092628,59.946958752],[10.7367068341,59.9469457251],[10.7366859386,59.9469061145],[10.7366556404,59.9468573875],[10.7365463307,59.9467679779]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063715",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063715",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063715",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Godals vei",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.752930701,59.9459370538],[10.7529204806,59.9459370839],[10.7529168877,59.9459371479],[10.7529134503,59.9459373967],[10.7529098574,59.9459374607],[10.75290661,59.9459376258],[10.7529031955,59.9459376955],[10.7528997352,59.9459381234],[10.7528962978,59.9459383722],[10.7528930389,59.9459386268],[10.7528896016,59.9459388756],[10.7528861527,59.945939214],[10.7528828823,59.9459395581],[10.752879422,59.9459399861],[10.7528761402,59.9459404197],[10.7528728583,59.9459408534],[10.752869565,59.9459413766],[10.7528660932,59.9459418941],[10.7528629899,59.9459423335],[10.7528596851,59.9459429463],[10.7528565359,59.9459437439],[10.752853254,59.9459441776],[10.7528501048,59.9459449752],[10.7528467886,59.9459456775],[10.7528438293,59.9459463913],[10.7528405131,59.9459470936],[10.7528375423,59.945947897],[10.7528343931,59.9459486946],[10.7528314338,59.9459494084],[10.7528284402,59.9459503909],[10.7528256479,59.9459512],[10.7528226543,59.9459521825],[10.752819672,59.9459530754],[10.7528168454,59.9459541532],[10.7528140417,59.9459550519],[10.7528110365,59.9459561239],[10.7528084228,59.9459569388],[10.7528057632,59.9459581118],[10.752803115,59.9459591954],[10.7528002998,59.9459601836],[10.7527976402,59.9459613566],[10.752795182,59.9459623564],[10.7527924995,59.9459637085],[10.7527900183,59.9459648874],[10.7527877157,59.9459660719],[10.7527850331,59.9459674241],[10.752782909,59.9459686144],[10.7527805949,59.9459698886],[10.7527781023,59.9459711569],[10.7527759667,59.9459724368],[10.7527736411,59.9459738005],[10.7527715055,59.9459750804],[10.7527697039,59.9459765509],[10.7527673898,59.945977825],[10.7527654098,59.9459792897],[10.7527634297,59.9459807545],[10.7527616282,59.945982225],[10.7527598381,59.9459836059],[10.752757858,59.9459850706],[10.7527562235,59.9459866364],[10.752754422,59.9459881069],[10.7527529545,59.945989768],[10.7527513314,59.9459912442],[10.7527496969,59.94599281],[10.7527484308,59.9459942978],[10.7527467963,59.9459958636],[10.7527455302,59.9459973513],[10.7527442297,59.9459991077],[10.7527429637,59.9460005955],[10.7527416747,59.9460022623],[10.7527405757,59.9460038454],[10.7527392866,59.9460055123],[10.7527385217,59.9460072859],[10.7527374112,59.9460089585],[10.7527364906,59.9460105473],[10.7527355701,59.9460121362],[10.7527348281,59.9460137307],[10.7527340631,59.9460155044],[10.7527334881,59.9460171943],[10.7527327231,59.9460189679],[10.7527321366,59.9460207474],[10.7527315616,59.9460224372],[10.7527313551,59.9460240491],[10.7527311371,59.9460257505],[10.7527305506,59.9460275299],[10.7527303211,59.9460293208],[10.7527301031,59.9460310222],[10.7527300521,59.9460328189],[10.7527298341,59.9460345203],[10.7527298061,59.9460361379],[10.7527299336,59.9460379403],[10.7527300726,59.9460396532],[10.7527300446,59.9460412708],[10.7527301721,59.9460430733],[10.7527306566,59.9460448872],[10.7527311641,59.9460465221],[10.7527313031,59.946048235],[10.7527317876,59.9460500489],[10.752732295,59.9460516838],[10.752732791,59.9460534082],[10.7527334655,59.9460551384],[10.7527343415,59.9460566952],[10.752735016,59.9460584254],[10.7527357019,59.946060066],[10.7527365549,59.9460618019],[10.7527376094,59.9460633645],[10.7527384509,59.94606519],[10.7527394939,59.9460668421],[10.7527407268,59.9460684104],[10.7527417698,59.9460700626],[10.7527430027,59.9460716309],[10.7527442242,59.9460732888],[10.7527454686,59.9460747676],[10.7527470356,59.9460765266],[10.7527482685,59.9460780949],[10.7527498699,59.9460795852],[10.7527512929,59.9460810698],[10.7527530613,59.9460826554],[10.7527546398,59.9460843248],[10.7527562641,59.946085636],[10.7527580441,59.946087132],[10.7527598125,59.9460887176],[10.7527617824,59.9460901299],[10.7527635738,59.9460915364],[10.7527655437,59.9460929487],[10.7527676921,59.9460943667],[10.752769662,59.946095779],[10.7527716433,59.9460971017],[10.7527737917,59.9460985198],[10.7527761416,59.9460997645],[10.7527781115,59.9461011767],[10.7527806398,59.9461024272],[10.7527829782,59.9461037614],[10.7527851495,59.9461050004],[10.7527876894,59.9461061613],[10.7527902292,59.9461073222],[10.7527925675,59.9461086564],[10.7527952973,59.9461097335],[10.7527978372,59.9461108944],[10.7528003884,59.9461119658],[10.7528030953,59.946113222],[10.7528058366,59.9461142095],[10.7528083993,59.9461151913],[10.7528113076,59.9461162742],[10.7528140489,59.9461172618],[10.7528167787,59.9461183389],[10.7528197099,59.9461192426],[10.7528226412,59.9461201464],[10.7528257394,59.9461211455],[10.7528285037,59.9461219539],[10.7528316249,59.9461227739],[10.7528347461,59.9461235939],[10.7528378558,59.9461245034],[10.752840643,59.9461251328],[10.7528439542,59.946125869],[10.7528470754,59.946126689],[10.7528502311,59.9461272403],[10.7528533637,59.9461279708],[10.7528566864,59.9461286174],[10.7528598306,59.9461292583],[10.7528631762,59.9461297258],[10.7528663204,59.9461303667],[10.752869833,59.9461309296],[10.7528728216,59.9461313856],[10.7528763457,59.9461318589],[10.7528795014,59.9461324103],[10.7528830484,59.9461327045],[10.752886417,59.9461329929],[10.7528897741,59.9461333709],[10.7528933097,59.9461337547],[10.7528966897,59.9461339536],[10.7529000583,59.946134242],[10.7529032598,59.9461344352],[10.7529066284,59.9461347237],[10.7529101984,59.9461348388],[10.7529135899,59.9461349481],[10.7529169699,59.946135147],[10.7529205514,59.9461351726],[10.7529239544,59.9461351924],[10.7529273574,59.9461352122],[10.7529307604,59.9461352321],[10.7529343533,59.9461351681],[10.7529377678,59.9461350983],[10.7529411937,59.9461349391],[10.7529444297,59.9461348636],[10.7529480341,59.9461347101],[10.752951483,59.9461343717],[10.7529549089,59.9461342124],[10.7529581678,59.9461339578],[10.7529616052,59.946133709],[10.7529652326,59.9461333764],[10.752968503,59.9461330322],[10.7529717734,59.9461326881],[10.7529752337,59.9461322602],[10.7529785156,59.9461318265],[10.7529818089,59.9461313033],[10.7529850907,59.9461308696],[10.7529883841,59.9461303464],[10.7529916889,59.9461297336],[10.7529949937,59.9461291209],[10.7529982755,59.9461286872],[10.7530014248,59.9461278896],[10.753004384,59.9461271757],[10.7530076773,59.9461266525],[10.7530110051,59.9461258606],[10.7530139644,59.9461251468],[10.7530169236,59.946124433],[10.7530200729,59.9461236354],[10.7530230551,59.9461227424],[10.7530262158,59.9461218553],[10.7530291865,59.9461210519],[10.7530319903,59.9461201532],[10.7530348054,59.946119165],[10.7530377877,59.9461182721],[10.7530406143,59.9461171943],[10.753043418,59.9461162956],[10.7530462562,59.9461151283],[10.7530490713,59.9461141401],[10.753051708,59.9461131461],[10.7530543791,59.9461118835],[10.7530568373,59.9461108837],[10.753059497,59.9461097107],[10.7530619781,59.9461085318],[10.7530646492,59.9461072692],[10.7530671188,59.9461061799],[10.7530692544,59.9461049],[10.7530717356,59.9461037212],[10.7530740612,59.9461023575],[10.7530761968,59.9461010776],[10.7530787008,59.9460997197],[10.7530808364,59.9460984398],[10.753082995,59.9460969809],[10.7530851306,59.946095701],[10.7530869321,59.9460942305],[10.7530890792,59.946092861],[10.7530910478,59.9460914858],[10.7530930278,59.9460900211],[10.7530948179,59.9460886402],[10.7530964639,59.9460869848],[10.7530984439,59.9460855201],[10.753100044,59.9460842229],[10.7531018685,59.9460825733],[10.7531033245,59.9460810018],[10.7531049476,59.9460795255],[10.7531062251,59.9460779482],[10.7531076696,59.9460764662],[10.7531091486,59.9460747156],[10.7531104147,59.9460732278],[10.7531117036,59.946071561],[10.7531128027,59.9460699779],[10.7531140916,59.946068311],[10.7531151907,59.946066728],[10.7531163012,59.9460650554],[10.7531170546,59.9460633713],[10.7531179752,59.9460617824],[10.7531189186,59.9460600145],[10.7531198506,59.9460583362],[10.7531204256,59.9460566463],[10.7531213576,59.9460549679],[10.7531217541,59.9460532723],[10.7531223291,59.9460515824],[10.7531227255,59.9460498868],[10.7531234905,59.9460481131],[10.7531237085,59.9460464117],[10.7531240935,59.9460448056],[10.7531243115,59.9460431043],[10.753124541,59.9460413133],[10.7531245804,59.9460396062],[10.7531247984,59.9460379048],[10.7531246709,59.9460361023],[10.7531248889,59.946034401],[10.7531245714,59.9460326823],[10.7531244438,59.9460308799],[10.7531243048,59.946029167],[10.7531241658,59.9460274541],[10.7531236813,59.9460256401],[10.7531233637,59.9460239214],[10.7531228448,59.9460223761],[10.7531223488,59.9460206517],[10.7531216743,59.9460189216],[10.7531211782,59.9460171971],[10.7531205152,59.9460153774],[10.7531198407,59.9460136473],[10.7531187862,59.9460120847],[10.7531181117,59.9460103545],[10.7531170458,59.9460088815],[10.7531161928,59.9460071456],[10.7531151498,59.9460054934],[10.7531141183,59.9460037518],[10.7531127068,59.9460021777],[10.7531118423,59.9460005313],[10.7531104309,59.9459989572],[10.7531088524,59.9459972878],[10.753107608,59.945995809],[10.753106018,59.9459942292],[10.753104785,59.9459926608],[10.7531031836,59.9459911705],[10.7531017607,59.945989686],[10.7530999922,59.9459881004],[10.7530984023,59.9459865205],[10.7530964438,59.9459850187],[10.7530946524,59.9459836122],[10.753092861,59.9459822057],[10.7530909026,59.9459807039],[10.7530889442,59.945979202],[10.7530869628,59.9459778793],[10.7530851714,59.9459764728],[10.7530828445,59.945975049],[10.7530806732,59.9459738101],[10.7530785248,59.9459723921],[10.7530761864,59.9459710578],[10.753074015,59.9459698189],[10.7530716767,59.9459684847],[10.7530691369,59.9459673238],[10.7530669655,59.9459660849],[10.7530644372,59.9459648344],[10.7530619088,59.945963584],[10.7530595475,59.9459624288],[10.7530566392,59.945961346],[10.7530541109,59.9459600955],[10.7530515481,59.9459591137],[10.7530488183,59.9459580366],[10.75304591,59.9459569538],[10.7530433358,59.9459560615],[10.7530404275,59.9459549786],[10.7530374963,59.9459540749],[10.7530347665,59.9459529978],[10.7530318352,59.945952094],[10.753028904,59.9459511902],[10.7530259613,59.945950376],[10.7530230415,59.9459493827],[10.7530199089,59.9459486523],[10.7530167877,59.9459478323],[10.7530136665,59.9459470123],[10.7530108908,59.9459462934],[10.7530075796,59.9459455572],[10.7530042569,59.9459449106],[10.7530013028,59.9459441859],[10.7529979686,59.9459436288],[10.7529948245,59.9459429879],[10.7529916803,59.9459423471],[10.7529881562,59.9459418737],[10.7529849891,59.945941412],[10.7529814765,59.9459408491],[10.7529783094,59.9459403873],[10.7529749523,59.9459400093],[10.7529716067,59.9459395418],[10.7529684282,59.9459391695],[10.7529648811,59.9459388753],[10.7529615011,59.9459386764],[10.752958144,59.9459382984],[10.752954764,59.9459380995],[10.7529512285,59.9459377158],[10.752947837,59.9459376064],[10.7529442784,59.9459374017],[10.7529408755,59.9459373819],[10.752930701,59.9459370538]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063899",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063899",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063899",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Bergsalleen 4",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.734667374,59.9454192512],[10.7345642628,59.9454182498],[10.7344663561,59.9454241606],[10.7343587479,59.9454232831],[10.734277755,59.9453938645],[10.7341368906,59.9453839969],[10.7339642933,59.9453909051],[10.7337918563,59.9454049217],[10.7336675581,59.945441808],[10.7336598682,59.9454723108],[10.7337778441,59.9454942957],[10.7339283298,59.9455087913],[10.7341108076,59.9455086773],[10.7342884315,59.9455086755],[10.7344797538,59.945503902],[10.7347323682,59.9455005736],[10.734667374,59.9454192512]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063901",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063901",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063901",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Havna all 6",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7146334077,59.9394733203],[10.7145999966,59.939454519],[10.7145116349,59.9394476871],[10.7144178772,59.9394520992],[10.7143639752,59.9394712063],[10.714323685,59.9394945328],[10.7143139445,59.9395282951],[10.7143158954,59.9395714298],[10.714319217,59.9396053474],[10.7143546376,59.9396404895],[10.7144129921,59.9396520998],[10.7144665378,59.9396496162],[10.7145406522,59.9396474422],[10.7146122747,59.9396271133],[10.7146430865,59.9396077943],[10.7146637077,59.9395730373],[10.7146694116,59.9395316804],[10.7146533372,59.9394910535],[10.7146334077,59.9394733203]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064172",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064172",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064172",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Diakonveien",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7063661904,59.9358272853],[10.7063761511,59.9357365217],[10.7063358932,59.9356170549],[10.7062481861,59.9355249948],[10.7061371352,59.9354554626],[10.7059055406,59.9354118526],[10.7057639229,59.9354137085],[10.7056248863,59.9354620468],[10.7055241817,59.9354952698],[10.7054581196,59.9355377153],[10.7054377207,59.935616359],[10.7054914691,59.9357160343],[10.7055192862,59.9357793457],[10.7055052569,59.9358849032],[10.7054511437,59.9359762051],[10.7055060679,59.9360930933],[10.7055867932,59.9362390577],[10.705665128,59.9363384556],[10.7058594506,59.9363212339],[10.706024204,59.9362971129],[10.7061325898,59.9362198097],[10.7061632132,59.936150761],[10.7061554805,59.9360970068],[10.7061734728,59.9360673805],[10.7062374091,59.9359832326],[10.7063211327,59.9359012585],[10.7063661904,59.9358272853]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064196",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064196",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064196",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Jutulveien",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7407656617,59.9430677151],[10.7407648091,59.9430631916],[10.7407647572,59.9430622009],[10.7407645153,59.9430612939],[10.7407640949,59.9430603811],[10.7407636745,59.9430594683],[10.7407634326,59.9430585613],[10.7407628337,59.9430576428],[10.7407624133,59.94305673],[10.7407619929,59.9430558172],[10.7407613825,59.9430549882],[10.7407607836,59.9430540697],[10.7407601848,59.9430531512],[10.7407597529,59.9430523279],[10.740759154,59.9430514094],[10.7407585551,59.9430504909],[10.7407577663,59.9430496561],[10.7407569774,59.9430488213],[10.7407562,59.943047897],[10.7407554112,59.9430470622],[10.7407546223,59.9430462275],[10.740753822,59.9430454822],[10.7407530446,59.9430445579],[10.7407520657,59.9430438069],[10.7407510984,59.9430429664],[10.7407501196,59.9430422154],[10.7407491522,59.9430413749],[10.7407481734,59.9430406239],[10.7407470275,59.9430397776],[10.7407460372,59.9430391161],[10.7407450699,59.9430382756],[10.7407439125,59.9430375188],[10.7407425652,59.9430368458],[10.7407414079,59.943036089],[10.7407404175,59.9430354276],[10.7407390817,59.943034665],[10.7407377344,59.943033992],[10.7407365656,59.9430333248],[10.7407352298,59.9430325623],[10.740733871,59.9430319788],[10.7407325236,59.9430313058],[10.7407311763,59.9430306328],[10.7407298175,59.9430300494],[10.7407284587,59.9430294659],[10.7407269214,59.9430288767],[10.7407255741,59.9430282037],[10.7407242038,59.9430277098],[10.740722488,59.9430271148],[10.7407211177,59.9430266209],[10.7407195804,59.9430260317],[10.7407180315,59.943025532],[10.7407164827,59.9430250324],[10.7407149339,59.9430245327],[10.7407132067,59.9430240272],[10.7407116579,59.9430235276],[10.7407099191,59.9430231117],[10.7407083703,59.943022612],[10.7407067984,59.9430222914],[10.7407050597,59.9430218755],[10.7407034993,59.9430214654],[10.7407015821,59.9430210437],[10.7407000218,59.9430206336],[10.7406982715,59.9430203072],[10.7406965212,59.9430199808],[10.7406947709,59.9430196545],[10.7406930091,59.9430194177],[10.7406910803,59.9430190855],[10.740689497,59.9430188545],[10.7406877352,59.9430186177],[10.7406859849,59.9430182913],[10.7406840446,59.9430180487],[10.7406822828,59.9430178119],[10.740680331,59.9430176589],[10.7406785577,59.9430175116],[10.7406767844,59.9430173644],[10.7406750111,59.9430172171],[10.7406732378,59.9430170698],[10.740671096,59.9430170005],[10.7406693227,59.9430168533],[10.7406675379,59.9430167956],[10.7406655746,59.9430167321],[10.7406637898,59.9430166743],[10.7406619935,59.9430167062],[10.7406600302,59.9430166427],[10.7406582454,59.9430165849],[10.7406562706,59.943016611],[10.7406544743,59.9430166428],[10.740652678,59.9430166746],[10.7406506917,59.9430167902],[10.7406488954,59.9430168221],[10.7406470876,59.9430169434],[10.7406452797,59.9430170648],[10.7406434719,59.9430171862],[10.7406414741,59.9430173913],[10.7406396663,59.9430175127],[10.740637847,59.9430177236],[10.7406362061,59.9430179403],[10.7406342083,59.9430181454],[10.740632389,59.9430183563],[10.7406305812,59.9430184777],[10.7406289288,59.9430187839],[10.740627098,59.9430190844],[10.7406252672,59.9430193848],[10.7406234363,59.9430196853],[10.740621784,59.9430199915],[10.7406201201,59.9430203873],[10.7406184678,59.9430206935],[10.7406166254,59.9430210835],[10.7406147946,59.943021384],[10.7406133092,59.9430217855],[10.7406114554,59.9430222651],[10.74060997,59.9430226666],[10.7406082946,59.943023152],[10.7406068093,59.9430235535],[10.7406049669,59.9430239435],[10.7406034586,59.9430245241],[10.7406017832,59.9430250095],[10.7406002863,59.9430255006],[10.7405987894,59.9430259917],[10.740597281,59.9430265723],[10.7405955942,59.9430271472],[10.7405942643,59.9430277336],[10.7405927674,59.9430282247],[10.740591259,59.9430288053],[10.7405899176,59.9430294813],[10.7405884092,59.9430300619],[10.7405870793,59.9430306483],[10.7405857379,59.9430313243],[10.7405843965,59.9430320002],[10.7405830666,59.9430325866],[10.7405817252,59.9430332626],[10.7405805507,59.9430340339],[10.7405792208,59.9430346203],[10.7405780464,59.9430353915],[10.7405768835,59.9430360733],[10.740575709,59.9430368445],[10.7405745346,59.9430376158],[10.7405735501,59.9430383033],[10.7405721972,59.9430390688],[10.7405712128,59.9430397563],[10.7405702053,59.9430406229],[10.7405692094,59.9430414],[10.7405682134,59.943042177],[10.7405672175,59.943042954],[10.74056621,59.9430438206],[10.7405653925,59.9430446035],[10.7405645635,59.9430454758],[10.7405637461,59.9430462586],[10.7405629286,59.9430470415],[10.7405620881,59.9430480034],[10.7405612706,59.9430487862],[10.7405606201,59.9430496643],[10.7405599696,59.9430505425],[10.7405593191,59.9430514206],[10.7405586801,59.9430522092],[10.7405580181,59.9430531769],[10.7405575461,59.9430540608],[10.7405568956,59.9430549389],[10.7405562336,59.9430559066],[10.7405557616,59.9430567905],[10.7405554681,59.9430576802],[10.7405549961,59.9430585641],[10.7405547025,59.9430594538],[10.740554219,59.9430604272],[10.7405539255,59.9430613169],[10.7405536319,59.9430622066],[10.7405535054,59.9430631916],[10.7405532118,59.9430640813],[10.7405530968,59.9430649767],[10.7405529702,59.9430659617],[10.7405528552,59.9430668572],[10.7405527401,59.9430677526],[10.7405526135,59.9430687376],[10.7405524985,59.9430696331],[10.7405523834,59.9430705285],[10.7405524353,59.9430715193],[10.7405524988,59.9430724205],[10.7405527292,59.9430734171],[10.7405527926,59.9430743183],[10.7405530345,59.9430752253],[10.7405532649,59.9430762218],[10.7405535068,59.9430771288],[10.7405537487,59.9430780358],[10.7405539791,59.9430790324],[10.740554411,59.9430798556],[10.7405546529,59.9430807626],[10.7405550618,59.9430817649],[10.7405554822,59.9430826777],[10.7405559141,59.9430835009],[10.7405563345,59.9430844137],[10.7405569334,59.9430853322],[10.7405573537,59.943086245],[10.7405579641,59.943087074],[10.740558563,59.9430879925],[10.7405593403,59.9430889168],[10.7405599507,59.9430897458],[10.7405605611,59.9430905748],[10.7405613384,59.9430914991],[10.7405621273,59.9430923339],[10.7405629162,59.9430931687],[10.740563705,59.9430940034],[10.7405646723,59.943094844],[10.7405654612,59.9430956788],[10.7405662501,59.9430965135],[10.7405672174,59.9430973541],[10.7405681962,59.9430981051],[10.7405691636,59.9430989456],[10.7405703209,59.9430997024],[10.7405711213,59.9431004476],[10.7405722786,59.9431012044],[10.7405734359,59.9431019611],[10.7405745933,59.9431027179],[10.7405755721,59.9431034689],[10.7405769079,59.9431042314],[10.7405780767,59.9431048987],[10.740579424,59.9431055717],[10.7405805814,59.9431063284],[10.7405817502,59.9431069957],[10.740583109,59.9431075791],[10.7405844448,59.9431083416],[10.7405858037,59.9431089251],[10.740587151,59.9431095981],[10.7405884983,59.9431102711],[10.7405900356,59.9431108603],[10.7405912159,59.943111438],[10.7405927647,59.9431119377],[10.740594112,59.9431126107],[10.7405956493,59.9431131999],[10.7405973766,59.9431137053],[10.7405987469,59.9431141992],[10.7406002842,59.9431147885],[10.7406018331,59.9431152881],[10.7406035603,59.9431157936],[10.7406051207,59.9431162037],[10.7406066695,59.9431167034],[10.7406082183,59.9431172031],[10.7406097786,59.9431176132],[10.7406116959,59.9431180349],[10.7406132562,59.943118445],[10.740614995,59.9431188609],[10.7406165668,59.9431191815],[10.7406183171,59.9431195079],[10.7406200444,59.9431200133],[10.7406217947,59.9431203397],[10.7406235565,59.9431205765],[10.7406254852,59.9431209086],[10.7406270686,59.9431211397],[10.7406288189,59.943121466],[10.7406305807,59.9431217028],[10.740632521,59.9431219454],[10.7406342828,59.9431221822],[10.7406360561,59.9431223295],[10.7406378179,59.9431225663],[10.7406395797,59.9431228031],[10.74064171,59.9431229619],[10.7406434833,59.9431231092],[10.7406452566,59.9431232565],[10.7406470414,59.9431233142],[10.7406490047,59.9431233777],[10.740650778,59.943123525],[10.7406525628,59.9431235827],[10.7406545376,59.9431235566],[10.7406563224,59.9431236144],[10.7406582857,59.9431236779],[10.740660082,59.943123646],[10.7406618784,59.9431236142],[10.7406638532,59.9431235882],[10.7406656495,59.9431235563],[10.7406676358,59.9431234407],[10.7406694436,59.9431233194],[10.7406712284,59.9431233771],[10.7406732147,59.9431232615],[10.7406748556,59.9431230448],[10.7406766634,59.9431229235],[10.7406786497,59.9431228079],[10.7406804691,59.9431225969],[10.7406822884,59.943122386],[10.7406841077,59.9431221751],[10.7406857486,59.9431219584],[10.7406877579,59.9431216637],[10.7406895772,59.9431214528],[10.7406914081,59.9431211524],[10.7406930604,59.9431208461],[10.7406948797,59.9431206352],[10.7406965436,59.9431202394],[10.740698196,59.9431199332],[10.7407000383,59.9431195432],[10.7407018691,59.9431192428],[10.7407033545,59.9431188412],[10.7407052084,59.9431183617],[10.7407066822,59.9431180496],[10.7407085246,59.9431176596],[10.7407100215,59.9431171686],[10.7407116968,59.9431166832],[10.7407131937,59.9431161921],[10.7407148576,59.9431157964],[10.7407163544,59.9431153053],[10.7407180413,59.9431147304],[10.7407195382,59.9431142393],[10.7407212251,59.9431136644],[10.7407225435,59.9431131676],[10.7407242303,59.9431125927],[10.7407255602,59.9431120063],[10.7407270686,59.9431114256],[10.740728577,59.943110845],[10.7407299184,59.9431101691],[10.7407312483,59.9431095826],[10.7407325782,59.9431089962],[10.7407339196,59.9431083203],[10.7407352611,59.9431076443],[10.7407366025,59.9431069684],[10.7407377654,59.9431062866],[10.7407389398,59.9431055154],[10.7407402697,59.9431049289],[10.7407414442,59.9431041577],[10.7407426071,59.9431034759],[10.74074396,59.9431027104],[10.740744956,59.9431019334],[10.7409002804,59.9431526346],[10.7409311811,59.9431562415],[10.7409192802,59.9432042321],[10.7409220211,59.9432568325],[10.7410259474,59.9432416704],[10.7410346348,59.9431880009],[10.7409761351,59.9431550876],[10.7409034408,59.9431489602],[10.7407481108,59.9430996976],[10.7407492967,59.9430988367],[10.7407501142,59.9430980539],[10.7407511102,59.9430972769],[10.7407519276,59.9430964941],[10.7407529351,59.9430956275],[10.740753931,59.9430948504],[10.7407547485,59.9430940676],[10.740755589,59.9430931057],[10.740756228,59.9430923171],[10.740757057,59.9430914447],[10.7407577075,59.9430905666],[10.7407583464,59.943089778],[10.7407590084,59.9430888103],[10.7407598374,59.943087938],[10.7407604764,59.9430871494],[10.7407609484,59.9430862655],[10.7407614319,59.943085292],[10.7407619039,59.9430844081],[10.740762376,59.9430835242],[10.740762848,59.9430826403],[10.7407633315,59.9430816668],[10.740763625,59.9430807771],[10.7407639185,59.9430798875],[10.7407643906,59.9430790035],[10.7407645171,59.9430780186],[10.7407649891,59.9430771346],[10.7407652827,59.943076245],[10.7407654207,59.9430751704],[10.7407655358,59.943074275],[10.7407656508,59.9430733795],[10.7407657774,59.9430723945],[10.7407656617,59.9430677151]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064206",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064206",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064206",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Pastor Fangens vei 33B",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7460864104,59.9458694852],[10.7461053313,59.9458491456],[10.7461206525,59.9458037827],[10.7461011521,59.9457671861],[10.7460270738,59.9457354806],[10.74593014,59.9457380145],[10.74584902,59.9457723503],[10.745885594,59.9457932234],[10.7458548807,59.945813272],[10.7458554798,59.9458141905],[10.7458663671,59.9458327054],[10.7459150966,59.94585523],[10.7459014885,59.9458690873],[10.745956074,59.9458920708],[10.7460129397,59.9458930982],[10.7460785013,59.9458780416],[10.7460864104,59.9458694852]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064235",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064235",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064235",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Bergsalleen 10",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7355362875,59.9462539497],[10.735535447,59.9462493367],[10.7355352052,59.9462484297],[10.7355349634,59.9462475227],[10.7355347101,59.9462467052],[10.7355343014,59.9462457029],[10.7355338811,59.9462447901],[10.7355334608,59.9462438773],[10.7355330405,59.9462429645],[10.7355324302,59.9462421355],[10.7355320099,59.9462412227],[10.7355313996,59.9462403937],[10.7355309678,59.9462395705],[10.735530369,59.9462386519],[10.7355297702,59.9462377333],[10.7355289699,59.9462369881],[10.7355283711,59.9462360695],[10.7355275939,59.9462351452],[10.7355267935,59.9462343999],[10.7355261832,59.9462335709],[10.7355253944,59.9462327361],[10.7355244271,59.9462318955],[10.7355236383,59.9462310607],[10.7355226595,59.9462303097],[10.7355218707,59.9462294749],[10.7355208919,59.9462287239],[10.7355199246,59.9462278833],[10.7355189458,59.9462271323],[10.7355177885,59.9462263754],[10.7355168097,59.9462256244],[10.7355158308,59.9462248734],[10.7355146735,59.9462241166],[10.7355135047,59.9462234493],[10.7355123474,59.9462226925],[10.7355111785,59.9462220252],[10.7355098427,59.9462212626],[10.7355088524,59.9462206011],[10.7355074935,59.9462200176],[10.7355061577,59.946219255],[10.7355049774,59.9462186773],[10.73550363,59.9462180043],[10.7355022827,59.9462173312],[10.7355009239,59.9462167477],[10.735499565,59.9462161642],[10.7354982062,59.9462155807],[10.7354966688,59.9462149914],[10.7354951315,59.9462144021],[10.7354937611,59.9462139082],[10.7354922122,59.9462134084],[10.7354908649,59.9462127354],[10.735489126,59.9462123194],[10.7354877556,59.9462118255],[10.7354862068,59.9462113257],[10.7354846579,59.946210826],[10.7354829305,59.9462103205],[10.7354813701,59.9462099103],[10.7354798097,59.9462095001],[10.7354780709,59.9462090841],[10.7354765105,59.9462086739],[10.7354747716,59.9462082579],[10.7354732112,59.9462078478],[10.7354716393,59.9462075271],[10.7354697104,59.9462071949],[10.7354681385,59.9462068742],[10.7354663881,59.9462065478],[10.7354646261,59.9462063109],[10.7354628872,59.946205895],[10.7354611253,59.9462056581],[10.7354593634,59.9462054212],[10.7354576015,59.9462051843],[10.7354558395,59.9462049474],[10.7354540661,59.9462048001],[10.7354523042,59.9462045632],[10.7354505307,59.9462044159],[10.7354485788,59.9462042627],[10.7354468053,59.9462041154],[10.7354450204,59.9462040576],[10.7354430684,59.9462039045],[10.735441295,59.9462037571],[10.73543951,59.9462036994],[10.735437725,59.9462036416],[10.7354359401,59.9462035838],[10.7354339766,59.9462035202],[10.7354321801,59.9462035519],[10.7354303951,59.9462034941],[10.7354285986,59.9462035259],[10.7354268021,59.9462035576],[10.7354248156,59.9462036732],[10.7354230192,59.9462037049],[10.7354212111,59.9462038262],[10.7354194031,59.9462039475],[10.7354174166,59.946204063],[10.7354157986,59.9462041005],[10.7354139906,59.9462042218],[10.7354121711,59.9462044327],[10.7354103631,59.946204554],[10.7354085435,59.9462047648],[10.735406724,59.9462049756],[10.735405083,59.9462051923],[10.7354032519,59.9462054926],[10.7354014324,59.9462057035],[10.7353997798,59.9462060096],[10.7353979603,59.9462062205],[10.7353961293,59.9462065209],[10.7353944767,59.946206827],[10.7353928126,59.9462072227],[10.7353909816,59.9462075231],[10.735389496,59.9462079246],[10.7353876534,59.9462083145],[10.7353860009,59.9462086207],[10.7353845153,59.9462090222],[10.7353826612,59.9462095017],[10.7353811756,59.9462099031],[10.7353795,59.9462103884],[10.7353780144,59.9462107899],[10.7353763388,59.9462112751],[10.7353748417,59.9462117662],[10.7353733331,59.9462123467],[10.735371836,59.9462128378],[10.7353701604,59.946213323],[10.7353688303,59.9462139094],[10.7353673332,59.9462144004],[10.735365813,59.9462150705],[10.7353643159,59.9462155616],[10.7353629858,59.9462161479],[10.7353616442,59.9462168238],[10.7353603256,59.9462173206],[10.7353589839,59.9462179965],[10.7353576423,59.9462186724],[10.7353563122,59.9462192588],[10.735355149,59.9462199405],[10.7353537958,59.9462207059],[10.7353524657,59.9462212923],[10.735351291,59.9462220635],[10.7353503179,59.9462226614],[10.7353489647,59.9462234268],[10.7353479801,59.9462241143],[10.7353468054,59.9462248855],[10.7353458092,59.9462256625],[10.7353446461,59.9462263442],[10.7353436384,59.9462272108],[10.7353426537,59.9462278982],[10.735341646,59.9462287648],[10.7353408399,59.946229458],[10.7353398437,59.946230235],[10.735338836,59.9462311015],[10.7353380183,59.9462318843],[10.7353371891,59.9462327567],[10.73533655,59.9462335452],[10.7353357208,59.9462344176],[10.7353349031,59.9462352003],[10.7353340739,59.9462360727],[10.7353334232,59.9462369508],[10.735332784,59.9462377393],[10.7353323118,59.9462386232],[10.7353316496,59.9462395909],[10.7353311889,59.9462403852],[10.7353305382,59.9462412633],[10.735330066,59.9462421472],[10.7353294038,59.9462431149],[10.7353291216,59.946243915],[10.7353286494,59.9462447989],[10.7353283557,59.9462456885],[10.735328062,59.9462465782],[10.7353275782,59.9462475516],[10.735327463,59.9462484471],[10.7353271578,59.9462494263],[10.7353268641,59.946250316],[10.7353267489,59.9462512114],[10.7353266337,59.9462521069],[10.7353265185,59.9462530023],[10.7353262247,59.946253892],[10.735326098,59.946254877],[10.7353261613,59.9462557782],[10.7353262246,59.9462566794],[10.7353262879,59.9462575806],[10.7353263396,59.9462585714],[10.7353264029,59.9462594726],[10.7353264662,59.9462603739],[10.735326708,59.9462612809],[10.7353269383,59.9462622774],[10.73532718,59.9462631844],[10.7353274333,59.9462640019],[10.7353276751,59.9462649089],[10.7353279169,59.9462658159],[10.7353283372,59.9462667287],[10.735328579,59.9462676357],[10.7353291893,59.9462684647],[10.7353296096,59.9462693775],[10.7353300298,59.9462702903],[10.7353306286,59.9462712088],[10.7353310604,59.9462720321],[10.7353316592,59.9462729506],[10.735332258,59.9462738692],[10.7353328683,59.9462746982],[10.7353334786,59.9462755272],[10.7353342558,59.9462764516],[10.7353348777,59.9462771911],[10.7353356549,59.9462781154],[10.7353364437,59.9462789502],[10.7353372325,59.946279785],[10.7353380213,59.9462806198],[10.7353390001,59.9462813708],[10.7353397889,59.9462822056],[10.7353407678,59.9462829567],[10.7353415566,59.9462837915],[10.7353427139,59.9462845483],[10.7353436812,59.9462853889],[10.7353446715,59.9462860504],[10.7353458173,59.9462868967],[10.7353468076,59.9462875582],[10.7353479649,59.946288315],[10.7353491222,59.9462890718],[10.7353501011,59.9462898229],[10.7353514484,59.9462904959],[10.7353526172,59.9462911632],[10.735353953,59.9462919258],[10.7353549549,59.9462924977],[10.7353563022,59.9462931708],[10.7353576496,59.9462938438],[10.7353589969,59.9462945169],[10.7353603557,59.9462951004],[10.7353615246,59.9462957677],[10.7353630619,59.9462963569],[10.7353646108,59.9462968567],[10.7353657912,59.9462974344],[10.735367317,59.9462981132],[10.7353686874,59.9462986072],[10.7353702362,59.9462991069],[10.7353717851,59.9462996067],[10.7353733225,59.946300196],[10.7353746928,59.9463006899],[10.7353764202,59.9463011954],[10.7353779806,59.9463016056],[10.7353795179,59.9463021949],[10.7353810783,59.9463026051],[10.7353828172,59.9463030211],[10.7353843776,59.9463034313],[10.735385938,59.9463038415],[10.7353876884,59.9463041679],[10.7353894388,59.9463044943],[10.7353911662,59.9463049999],[10.7353927381,59.9463053205],[10.7353944885,59.9463056469],[10.7353962389,59.9463059734],[10.7353980009,59.9463062103],[10.7353997513,59.9463065367],[10.7354013347,59.9463067678],[10.7354032751,59.9463070105],[10.7354050256,59.9463073369],[10.735406799,59.9463074842],[10.7354085609,59.9463077211],[10.7354103344,59.9463078684],[10.7354122748,59.9463081111],[10.7354140483,59.9463082584],[10.7354158217,59.9463084058],[10.7354176067,59.9463084636],[10.7354193802,59.9463086109],[10.7354211651,59.9463086687],[10.7354229501,59.9463087265],[10.7354249136,59.9463087901],[10.7354266986,59.9463088479],[10.735428472,59.9463089952],[10.7354302685,59.9463089635],[10.7354322435,59.9463089375],[10.73543404,59.9463089058],[10.7354358365,59.946308874],[10.735437633,59.9463088423],[10.7354394295,59.9463088105],[10.735441416,59.946308695],[10.735443224,59.9463085737],[10.735445032,59.9463084524],[10.73544684,59.9463083311],[10.7354486481,59.9463082098],[10.7354504676,59.946307999],[10.7354522641,59.9463079672],[10.7354540836,59.9463077564],[10.7354559032,59.9463075455],[10.7354575557,59.9463072394],[10.7354593753,59.9463070285],[10.7354612063,59.9463067282],[10.7354630258,59.9463065173],[10.7354644999,59.9463062054],[10.735466331,59.946305905],[10.7354681505,59.9463056942],[10.7354698146,59.9463052984],[10.7354714671,59.9463049923],[10.7354733097,59.9463046024],[10.7354747953,59.9463042009],[10.7354766379,59.9463038109],[10.735478135,59.9463033199],[10.7354797875,59.9463030137],[10.7354814516,59.946302618],[10.7354829487,59.946302127],[10.7354846243,59.9463016418],[10.7354861214,59.9463011507],[10.7354877855,59.946300755],[10.7354892941,59.9463001744],[10.7354909697,59.9462996892],[10.7354922999,59.9462991028],[10.7354936185,59.946298606],[10.7354953056,59.9462980312],[10.7354966357,59.9462974449],[10.7354981443,59.9462968643],[10.7354994629,59.9462963675],[10.7355008046,59.9462956916],[10.7355023247,59.9462950214],[10.7355036433,59.9462945246],[10.735504985,59.9462938487],[10.7355063266,59.9462931728],[10.7355074783,59.9462925807],[10.7355088314,59.9462918152],[10.7355099831,59.9462912231],[10.7355111577,59.9462904519],[10.7355123209,59.9462897702],[10.735513484,59.9462890885],[10.7355146587,59.9462883173],[10.7355156434,59.9462876298],[10.735516818,59.9462868586],[10.7355179927,59.9462860874],[10.7355189889,59.9462853104],[10.735519795,59.9462846171],[10.7355208027,59.9462837506],[10.7355219659,59.9462830689],[10.7355227951,59.9462821966],[10.7355236127,59.9462814138],[10.7355244419,59.9462805415],[10.7355252596,59.9462797587],[10.7355260773,59.9462789759],[10.7355269065,59.9462781036],[10.7355277241,59.9462773208],[10.7355283864,59.9462763531],[10.7355290255,59.9462755646],[10.7355296762,59.9462746865],[10.7355303269,59.9462738084],[10.7355307991,59.9462729245],[10.7355314383,59.9462721359],[10.735532089,59.9462712578],[10.7355325727,59.9462702844],[10.7355330449,59.9462694005],[10.7355335171,59.9462685166],[10.7355338108,59.9462676269],[10.735534283,59.946266743],[10.7355345882,59.9462657638],[10.735534882,59.9462648742],[10.7355351757,59.9462639845],[10.7355354694,59.9462630948],[10.7355355846,59.9462621994],[10.7355358783,59.9462613097],[10.735536172,59.94626042],[10.7355362872,59.9462595246],[10.7355362354,59.9462585338],[10.7355362875,59.9462539497]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064236",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064236",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064236",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Bergsalleen 11",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7365942164,59.9460919089],[10.7365934334,59.9460868481],[10.7365930476,59.9460856667],[10.7365928404,59.9460844911],[10.7365924661,59.9460832201],[10.7365920919,59.9460819492],[10.7365913606,59.9460806666],[10.7365909634,59.9460795748],[10.7365904106,59.946078298],[10.7365898579,59.9460770213],[10.7365892821,59.9460759236],[10.7365883724,59.9460746353],[10.7365878081,59.9460734482],[10.7365870538,59.9460723447],[10.7365863226,59.9460710622],[10.7365853898,59.946069953],[10.7365842901,59.9460687485],[10.7365835358,59.946067645],[10.7365826146,59.9460664463],[10.7365815033,59.9460653313],[10.7365805705,59.9460642221],[10.7365794593,59.9460631071],[10.736578181,59.9460618968],[10.7365770583,59.9460608714],[10.736575757,59.9460598402],[10.7365746457,59.9460587252],[10.736573356,59.9460576044],[10.7365720547,59.9460565732],[10.7365707534,59.946055542],[10.7365692736,59.946054505],[10.7365677939,59.946053468],[10.7365664926,59.9460524368],[10.7365648228,59.9460514836],[10.736563343,59.9460504466],[10.7365618517,59.9460494991],[10.736560182,59.9460485459],[10.7365585122,59.9460475927],[10.7365568424,59.9460466394],[10.7365551611,59.9460457758],[10.7365534913,59.9460448225],[10.73655181,59.9460439588],[10.7365499502,59.9460430894],[10.7365480789,59.9460423095],[10.7365462191,59.94604144],[10.7365443478,59.9460406601],[10.7365424764,59.9460398802],[10.7365406051,59.9460391003],[10.7365385553,59.9460383146],[10.7365365055,59.9460375289],[10.7365344442,59.9460368327],[10.7365325728,59.9460360528],[10.7365305115,59.9460353566],[10.7365284502,59.9460346605],[10.7365263773,59.9460340539],[10.7365241375,59.946033352],[10.7365218862,59.9460327396],[10.7365198133,59.946032133],[10.736517562,59.9460315206],[10.7365154776,59.9460310035],[10.7365132147,59.9460304807],[10.7365109519,59.9460299579],[10.736508689,59.946029435],[10.7365064262,59.9460289122],[10.7365039733,59.9460284731],[10.7365018889,59.9460279561],[10.7364994245,59.9460276065],[10.7364971501,59.9460271732],[10.7364946858,59.9460268237],[10.7364922329,59.9460263846],[10.7364899355,59.9460261304],[10.7364876496,59.9460257867],[10.7364850067,59.9460254314],[10.7364827093,59.9460251772],[10.7364802334,59.9460249172],[10.7364779244,59.9460247525],[10.73647527,59.9460244868],[10.7364729726,59.9460242326],[10.7364704852,59.9460240621],[10.7364679862,59.9460239812],[10.7364654988,59.9460238108],[10.7364629999,59.9460237299],[10.7364606909,59.9460235652],[10.7364581805,59.9460235739],[10.736455503,59.9460234872],[10.736453171,59.9460235016],[10.7364504821,59.9460235045],[10.7364481501,59.9460235189],[10.7364456397,59.9460235276],[10.7364431177,59.9460236258],[10.7364407857,59.9460236402],[10.7364382522,59.946023828],[10.7364357302,59.9460239262],[10.7364331967,59.9460241139],[10.7364306632,59.9460243016],[10.7364283082,59.9460244952],[10.7364259532,59.9460246887],[10.7364234197,59.9460248764],[10.7364208747,59.9460251537],[10.7364186752,59.9460255321],[10.7364161301,59.9460258094],[10.7364137636,59.9460260924],[10.7364113971,59.9460263755],[10.7364090075,59.9460268376],[10.7364066295,59.9460272103],[10.7364042515,59.9460275829],[10.7364018619,59.946028045],[10.7363996624,59.9460284234],[10.7363972728,59.9460288856],[10.7363950502,59.946029443],[10.7363926491,59.9460299947],[10.7363904381,59.9460304627],[10.736388394,59.9460310259],[10.7363859929,59.9460315776],[10.7363839488,59.9460321409],[10.7363815477,59.9460326926],[10.7363794921,59.9460333454],[10.7363774365,59.9460339981],[10.7363751909,59.9460347347],[10.7363731353,59.9460353875],[10.7363712467,59.9460361356],[10.7363690126,59.9460367827],[10.736367124,59.9460375308],[10.7363650568,59.9460382731],[10.7363631567,59.9460391108],[10.7363612681,59.9460398589],[10.7363591894,59.9460406908],[10.7363572893,59.9460415285],[10.7363555792,59.9460422823],[10.736353679,59.94604312],[10.7363519574,59.9460439635],[10.7363502242,59.9460448964],[10.7363485026,59.9460457399],[10.7363467694,59.9460466729],[10.7363452147,59.9460476116],[10.7363434816,59.9460485446],[10.7363417484,59.9460494776],[10.7363401822,59.9460505059],[10.7363386275,59.9460514447],[10.7363372398,59.9460524788],[10.7363356852,59.9460534176],[10.7363344644,59.946054547],[10.7363330768,59.9460555811],[10.7363317006,59.9460565256],[10.7363303014,59.9460576492],[10.7363290806,59.9460587786],[10.736327883,59.946059729],[10.7363266623,59.9460608584],[10.7363254415,59.9460619878],[10.7363242208,59.9460631172],[10.7363231901,59.9460641628],[10.7363223264,59.9460653038],[10.7363212842,59.946066439],[10.7363202304,59.9460676637],[10.7363191997,59.9460687094],[10.7363183245,59.9460699399],[10.7363174608,59.9460710809],[10.736316764,59.9460723172],[10.7363159003,59.9460734581],[10.7363152151,59.9460746049],[10.7363145068,59.9460759307],[10.7363140001,59.9460770832],[10.7363133149,59.94607823],[10.7363127851,59.9460795616],[10.7363120999,59.9460807083],[10.7363115816,59.9460819504],[10.7363114203,59.946083204],[10.7363109136,59.9460843566],[10.7363105623,59.946085694],[10.7363102226,59.9460869418],[10.7363100613,59.9460881954],[10.7363097331,59.9460893537],[10.7363095718,59.9460906074],[10.7363094106,59.946091861],[10.7363094278,59.9460931204],[10.7363092666,59.946094374],[10.7363092838,59.9460956334],[10.7363094795,59.9460968986],[10.7363095083,59.9460980685],[10.7363095255,59.9460993279],[10.7363097213,59.9461005931],[10.7363100955,59.946101864],[10.7363102912,59.9461031292],[10.7363104985,59.9461043048],[10.7363108727,59.9461055758],[10.7363112585,59.9461067572],[10.7363118112,59.946108034],[10.7363121854,59.9461093049],[10.7363127612,59.9461104026],[10.7363131354,59.9461116735],[10.7363138667,59.946112956],[10.7363146209,59.9461140595],[10.7363151737,59.9461153362],[10.7363159279,59.9461164396],[10.7363166707,59.9461176326],[10.7363175804,59.9461189209],[10.7363183347,59.9461200243],[10.7363192559,59.9461212231],[10.7363201887,59.9461223323],[10.7363211099,59.9461235311],[10.7363220427,59.9461246403],[10.7363233324,59.946125761],[10.7363244437,59.946126876],[10.7363255434,59.9461280805],[10.7363266662,59.946129106],[10.736327789,59.9461301314],[10.7363290672,59.9461313417],[10.7363303685,59.9461323729],[10.7363316697,59.9461334042],[10.7363329595,59.9461345249],[10.7363342723,59.9461354666],[10.736335752,59.9461365036],[10.7363372433,59.9461374511],[10.7363387116,59.9461385776],[10.7363402029,59.946139525],[10.7363418727,59.9461404783],[10.7363433639,59.9461414257],[10.7363450452,59.9461422894],[10.7363467035,59.9461433322],[10.7363483848,59.9461441959],[10.7363502331,59.9461451549],[10.7363519144,59.9461460186],[10.7363537742,59.946146888],[10.7363556455,59.9461476679],[10.7363573268,59.9461485316],[10.7363591981,59.9461493116],[10.736361248,59.9461500973],[10.7363631078,59.9461509667],[10.7363649906,59.9461516571],[10.7363670404,59.9461524428],[10.7363691017,59.9461531389],[10.7363711516,59.9461539246],[10.7363732129,59.9461546208],[10.7363752742,59.9461553169],[10.7363775256,59.9461559293],[10.7363794084,59.9461566197],[10.7363816598,59.9461572321],[10.7363839111,59.9461578445],[10.7363859955,59.9461583615],[10.7363882468,59.9461589739],[10.7363905097,59.9461594968],[10.7363927726,59.9461600196],[10.7363950354,59.9461605424],[10.7363972983,59.9461610653],[10.7363995612,59.9461615881],[10.7364020256,59.9461619376],[10.7364043,59.9461623709],[10.7364065744,59.9461628042],[10.7364090388,59.9461631538],[10.7364113131,59.9461635871],[10.7364137891,59.946163847],[10.7364162535,59.9461641966],[10.7364185394,59.9461645403],[10.7364210153,59.9461648003],[10.7364235027,59.9461649707],[10.7364259787,59.9461652307],[10.7364282761,59.9461654849],[10.736430752,59.9461657449],[10.736433251,59.9461658258],[10.7364357384,59.9461659963],[10.7364382258,59.9461661667],[10.7364407248,59.9461662476],[10.7364432237,59.9461663285],[10.7364457227,59.9461664094],[10.7364482217,59.9461664903],[10.7364505536,59.9461664758],[10.7364530641,59.9461664672],[10.7364555746,59.9461664585],[10.7364580851,59.9461664499],[10.736460607,59.9461663517],[10.736463129,59.9461662535],[10.7364654725,59.9461661495],[10.7364679945,59.9461660513],[10.7364703495,59.9461658578],[10.7364728831,59.9461656701],[10.7364754166,59.9461654823],[10.7364779501,59.9461652946],[10.7364803051,59.9461651011],[10.7364826831,59.9461647285],[10.7364852282,59.9461644512],[10.7364874162,59.9461641623],[10.7364899612,59.946163885],[10.7364923278,59.946163602],[10.7364947173,59.9461631398],[10.7364970954,59.9461627672],[10.7364992949,59.9461623888],[10.7365016845,59.9461619267],[10.736504241,59.9461615598],[10.7365064636,59.9461610024],[10.7365088532,59.9461605402],[10.7365108858,59.9461600665],[10.7365131084,59.946159509],[10.7365155094,59.9461589573],[10.7365175535,59.9461583941],[10.7365199546,59.9461578424],[10.7365219987,59.9461572791],[10.7365240543,59.9461566263],[10.7365262999,59.9461558898],[10.7365283555,59.946155237],[10.7365304112,59.9461545842],[10.7365326568,59.9461538476],[10.7365347124,59.9461531948],[10.736536601,59.9461524467],[10.7365384896,59.9461516985],[10.7365405683,59.9461508667],[10.7365424569,59.9461501185],[10.7365443571,59.9461492809],[10.7365462457,59.9461485327],[10.7365481574,59.9461476055],[10.7365498675,59.9461468516],[10.7365517676,59.946146014],[10.7365535008,59.946145081],[10.7365552224,59.9461442375],[10.7365569556,59.9461433045],[10.7365586888,59.9461423715],[10.736560255,59.9461413432],[10.7365617981,59.946140494],[10.7365633643,59.9461394657],[10.736564919,59.9461385269],[10.7365664852,59.9461374986],[10.7365678613,59.9461365541],[10.736569249,59.94613552],[10.7365708267,59.9461344021],[10.7365720244,59.9461334518],[10.7365734236,59.9461323281],[10.7365748113,59.9461312941],[10.736575842,59.9461302484],[10.7365770627,59.946129119],[10.7365782834,59.9461279896],[10.7365793256,59.9461268544],[10.7365805463,59.946125725],[10.736581577,59.9461246793],[10.7365826308,59.9461234546],[10.7365834945,59.9461223136],[10.7365843582,59.9461211726],[10.7365854004,59.9461200375],[10.7365862641,59.9461188965],[10.7365869609,59.9461176602],[10.7365878246,59.9461165192],[10.7365885213,59.9461152829],[10.736589218,59.9461140466],[10.7365899033,59.9461128999],[10.73659041,59.9461117474],[10.7365909397,59.9461104157],[10.7365914465,59.9461092632],[10.7365919647,59.9461080211],[10.7365924829,59.9461067791],[10.7365926442,59.9461055254],[10.7365931624,59.9461042834],[10.7365935022,59.9461030355],[10.7365938304,59.9461018772],[10.7365938132,59.9461006178],[10.7365939744,59.9460993642],[10.7365943141,59.9460981163],[10.7365942969,59.9460968569],[10.7365942164,59.9460919089]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064248",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064248",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064248",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Godalsvei 3",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7503569077,59.94629175],[10.750356013,59.9462861463],[10.7503556611,59.9462846963],[10.7503553093,59.9462832463],[10.7503547675,59.94628188],[10.7503544042,59.9462805196],[10.7503538739,59.9462790638],[10.7503531536,59.9462776918],[10.7503526118,59.9462763255],[10.7503517245,59.9462748583],[10.7503511713,59.9462735816],[10.7503504624,59.94627212],[10.7503493737,59.9462708261],[10.7503486648,59.9462693645],[10.7503475876,59.946267981],[10.7503466773,59.9462666928],[10.7503457785,59.9462653151],[10.7503445112,59.9462640153],[10.7503434224,59.9462627214],[10.7503423337,59.9462614274],[10.7503410664,59.9462601277],[10.7503397876,59.9462589175],[10.7503385318,59.9462575282],[10.7503372531,59.9462563181],[10.7503357958,59.9462551021],[10.75033435,59.9462537966],[10.7503330713,59.9462525865],[10.7503314355,59.9462513648],[10.7503299668,59.9462502384],[10.7503283425,59.9462489271],[10.7503266953,59.946247795],[10.750325048,59.9462466628],[10.7503232223,59.9462455249],[10.7503215751,59.9462443928],[10.7503197493,59.9462432549],[10.7503179121,59.9462422065],[10.7503158964,59.9462411524],[10.7503140706,59.9462400145],[10.7503120549,59.9462389603],[10.7503102062,59.9462380015],[10.7503081905,59.9462369474],[10.7503059848,59.9462359771],[10.7503039576,59.9462350125],[10.7503017519,59.9462340421],[10.7502997247,59.9462330776],[10.750297519,59.9462321072],[10.7502954803,59.9462312322],[10.7502930732,59.9462304352],[10.750290856,59.9462295544],[10.7502884603,59.9462286679],[10.7502860531,59.9462278709],[10.7502836575,59.9462269843],[10.7502814173,59.9462262826],[10.7502789987,59.9462255752],[10.7502765915,59.9462247782],[10.7502741729,59.9462240707],[10.7502715643,59.946223447],[10.7502689671,59.9462227338],[10.75026637,59.9462220206],[10.7502639399,59.9462214027],[10.7502613198,59.9462208686],[10.7502588896,59.9462202506],[10.7502561025,59.9462196212],[10.7502536494,59.9462191824],[10.7502508508,59.9462186425],[10.7502482192,59.9462181979],[10.7502454206,59.9462176581],[10.7502427891,59.9462172135],[10.7502399675,59.9462168527],[10.7502373359,59.9462164081],[10.7502345144,59.9462160473],[10.7502316928,59.9462156865],[10.7502290497,59.9462153315],[10.7502262052,59.9462151498],[10.7502233836,59.946214789],[10.7502205391,59.9462146073],[10.7502177061,59.9462143361],[10.75021504,59.9462141601],[10.7502121955,59.9462139784],[10.750209351,59.9462137967],[10.7502063165,59.9462136988],[10.7502034605,59.9462136067],[10.750200593,59.9462136041],[10.7501979155,59.9462135177],[10.7501950595,59.9462134255],[10.7501921805,59.9462135125],[10.7501893245,59.9462134203],[10.7501864341,59.9462135968],[10.7501837451,59.9462135999],[10.7501808546,59.9462137764],[10.7501779757,59.9462138634],[10.7501750852,59.9462140399],[10.7501722062,59.9462141268],[10.7501694943,59.946214309],[10.7501667709,59.9462145808],[10.7501638689,59.9462148469],[10.750160967,59.9462151129],[10.7501582436,59.9462153847],[10.7501555087,59.946215746],[10.7501525953,59.9462161016],[10.7501500503,59.9462163792],[10.7501471254,59.9462168243],[10.750144379,59.9462172752],[10.7501418226,59.9462176423],[10.7501390648,59.9462181827],[10.7501364969,59.9462186393],[10.7501337505,59.9462190902],[10.7501311596,59.946219726],[10.7501285802,59.9462202721],[10.7501258224,59.9462208126],[10.7501232315,59.9462214483],[10.7501206407,59.946222084],[10.7501182283,59.9462227255],[10.750115626,59.9462234508],[10.7501132136,59.9462240923],[10.7501106113,59.9462248176],[10.7501081874,59.9462255486],[10.7501059421,59.9462262854],[10.7501035068,59.946227106],[10.750100893,59.9462279209],[10.7500986476,59.9462286577],[10.7500963908,59.946229484],[10.7500941225,59.9462303999],[10.7500918542,59.9462313158],[10.7500897644,59.9462322374],[10.7500874961,59.9462331533],[10.7500854063,59.946234075],[10.7500833165,59.9462349966],[10.7500812152,59.9462360078],[10.750079114,59.946237019],[10.7500771912,59.946238036],[10.7500750899,59.9462390472],[10.7500731671,59.9462400642],[10.7500712329,59.9462411707],[10.7500693101,59.9462421876],[10.7500675543,59.9462432999],[10.7500656086,59.9462444959],[10.7500640428,59.9462455244],[10.750062287,59.9462466367],[10.7500606983,59.9462478443],[10.7500589311,59.9462490461],[10.7500573423,59.9462502536],[10.7500557536,59.9462514612],[10.7500543548,59.946252585],[10.7500527546,59.9462538821],[10.7500513443,59.9462550954],[10.7500501126,59.9462563145],[10.7500486909,59.9462576174],[10.7500474476,59.946258926],[10.7500460374,59.9462601394],[10.7500449727,59.9462614538],[10.750043718,59.946262852],[10.7500426647,59.9462640768],[10.7500415885,59.9462654808],[10.7500405353,59.9462667056],[10.7500394591,59.9462681095],[10.7500387513,59.9462694355],[10.7500376866,59.9462707499],[10.7500369674,59.9462721653],[10.7500362597,59.9462734912],[10.7500353505,59.9462749905],[10.7500348213,59.9462763222],[10.7500341021,59.9462777376],[10.7500335729,59.9462790693],[10.7500330207,59.9462805801],[10.7500324914,59.9462819117],[10.7500321292,59.9462833387],[10.7500315885,59.9462847599],[10.7500314163,59.9462861031],[10.7500310426,59.9462876197],[10.7500308589,59.9462890524],[10.7500304967,59.9462904794],[10.7500304915,59.9462919179],[10.7500303078,59.9462933506],[10.7500301241,59.9462947834],[10.7500303089,59.9462961381],[10.7500303037,59.9462975766],[10.750030477,59.9462990209],[10.7500304718,59.9463004594],[10.7500308236,59.9463019094],[10.7500310084,59.9463032641],[10.7500311817,59.9463047084],[10.750031712,59.9463061641],[10.7500320638,59.9463076142],[10.7500326055,59.9463089804],[10.7500329688,59.9463103409],[10.7500336776,59.9463118024],[10.7500342079,59.9463132582],[10.7500347612,59.9463145349],[10.75003547,59.9463159964],[10.7500361903,59.9463173684],[10.7500370891,59.9463187462],[10.7500378093,59.9463201182],[10.7500387196,59.9463214064],[10.7500396069,59.9463228737],[10.7500405172,59.9463241619],[10.7500415945,59.9463255454],[10.7500426832,59.9463268393],[10.750043772,59.9463281333],[10.7500448608,59.9463294273],[10.7500463065,59.9463307328],[10.7500473953,59.9463320267],[10.7500486626,59.9463333265],[10.7500499413,59.9463345366],[10.7500515656,59.9463358479],[10.7500528443,59.9463370581],[10.7500543016,59.946338274],[10.7500557588,59.9463394899],[10.7500573946,59.9463407116],[10.7500590303,59.9463419333],[10.7500606776,59.9463430655],[10.7500623248,59.9463441977],[10.750063972,59.9463453298],[10.7500657978,59.9463464677],[10.7500676235,59.9463476056],[10.7500694607,59.946348654],[10.7500712979,59.9463497024],[10.7500733137,59.9463507565],[10.7500751509,59.9463518049],[10.7500771666,59.946352859],[10.7500791823,59.9463539131],[10.7500812095,59.9463548777],[10.7500834152,59.946355848],[10.7500854424,59.9463568126],[10.7500876481,59.946357783],[10.7500898538,59.9463587533],[10.750092071,59.9463596341],[10.7500941097,59.9463605091],[10.7500965054,59.9463613957],[10.750098734,59.9463621869],[10.7501011412,59.9463629839],[10.7501035483,59.9463637809],[10.750105777,59.9463645722],[10.7501081842,59.9463653692],[10.7501107813,59.9463660824],[10.7501133785,59.9463667956],[10.7501156186,59.9463674973],[10.7501182273,59.946368121],[10.7501208244,59.9463688342],[10.7501232545,59.9463694521],[10.7501260531,59.946369992],[10.7501284833,59.9463706099],[10.7501310919,59.9463712336],[10.7501337235,59.9463716782],[10.7501365221,59.9463722181],[10.7501391422,59.9463727522],[10.7501419638,59.946373113],[10.7501445839,59.9463736471],[10.750147394,59.9463740975],[10.7501500371,59.9463744525],[10.7501526802,59.9463748075],[10.7501555132,59.9463750788],[10.7501583348,59.9463754396],[10.7501609779,59.9463757946],[10.7501639894,59.9463760716],[10.7501668225,59.9463763428],[10.7501694885,59.9463765188],[10.7501723331,59.9463767005],[10.7501751776,59.9463768822],[10.7501782006,59.9463770696],[10.7501808781,59.946377156],[10.7501837342,59.9463772482],[10.7501865902,59.9463773403],[10.7501894577,59.9463773429],[10.7501923137,59.9463774351],[10.7501951927,59.9463773482],[10.7501980602,59.9463773508],[10.7502009392,59.9463772638],[10.7502038067,59.9463772664],[10.7502065072,59.9463771737],[10.7502092191,59.9463769915],[10.7502120981,59.9463769045],[10.750215,59.9463766385],[10.750217879,59.9463765516],[10.750220781,59.9463762855],[10.7502235044,59.9463760137],[10.7502262164,59.9463758315],[10.7502291298,59.9463754759],[10.7502318532,59.9463752041],[10.7502345996,59.9463747532],[10.7502375131,59.9463743977],[10.7502400695,59.9463740306],[10.7502428159,59.9463735797],[10.7502455508,59.9463732183],[10.7502482972,59.9463727675],[10.7502508766,59.9463722213],[10.7502536345,59.9463716808],[10.7502562139,59.9463711346],[10.7502589718,59.9463705942],[10.7502615511,59.946370048],[10.750263952,59.9463694961],[10.7502667329,59.9463687765],[10.7502691452,59.946368135],[10.7502715576,59.9463674935],[10.7502741485,59.9463668578],[10.7502765838,59.9463660372],[10.7502790076,59.9463653062],[10.7502814315,59.9463645751],[10.7502840338,59.9463638498],[10.7502863021,59.9463629339],[10.7502885589,59.9463621076],[10.7502908158,59.9463612812],[10.7502930726,59.9463604549],[10.7502953294,59.9463596285],[10.7502975977,59.9463587126],[10.7502996875,59.946357791],[10.7503019673,59.9463567855],[10.7503040571,59.9463558639],[10.7503061584,59.9463548527],[10.7503080811,59.9463538357],[10.7503101824,59.9463528245],[10.7503121052,59.9463518075],[10.7503142065,59.9463507963],[10.7503161407,59.9463496898],[10.750317885,59.9463486671],[10.7503198193,59.9463475606],[10.750321575,59.9463464483],[10.7503233308,59.9463453361],[10.7503249081,59.946344218],[10.7503266753,59.9463430162],[10.750328264,59.9463418086],[10.7503300198,59.9463406964],[10.7503316085,59.9463394888],[10.7503330188,59.9463382755],[10.7503344405,59.9463369726],[10.7503358392,59.9463358488],[10.7503374395,59.9463345517],[10.7503385042,59.9463332373],[10.7503399144,59.946332024],[10.7503411576,59.9463307153],[10.7503422223,59.9463294009],[10.7503434656,59.9463280923],[10.7503447088,59.9463267836],[10.750345595,59.9463254635],[10.7503466712,59.9463240595],[10.7503477244,59.9463228347],[10.7503486221,59.946321425],[10.7503495083,59.9463201048],[10.750350406,59.9463186951],[10.7503511252,59.9463172796],[10.7503518329,59.9463159537],[10.7503525521,59.9463145383],[10.7503532713,59.9463131228],[10.7503538005,59.9463117911],[10.7503543412,59.9463103699],[10.7503548819,59.9463089487],[10.7503552441,59.9463075217],[10.7503557848,59.9463061005],[10.7503559685,59.9463046677],[10.7503563192,59.9463033303],[10.7503566814,59.9463019033],[10.750356698,59.9463003753],[10.7503570602,59.9462989483],[10.7503570654,59.9462975098],[10.7503569077,59.94629175]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064317",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064317",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064317",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Carl Grndals vei 13",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN01",utvalgtNaturtypeTekst:"Slttemark",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7524248317,59.9464186994],[10.7524283622,59.9464205217],[10.7524282985,59.9464196204],[10.7529085814,59.9466972153],[10.7531673321,59.9465159243],[10.7531284892,59.9464819422],[10.7530814764,59.946461364],[10.7530362715,59.9464406643],[10.7529751163,59.946418551],[10.7528474906,59.9463724446],[10.7526220436,59.9462798437],[10.7525514742,59.9462444787],[10.7524231651,59.9461869303],[10.7522647982,59.9461261646],[10.7521706151,59.9461142254],[10.752142848,59.9461225013],[10.7520673158,59.9462279653],[10.7521143246,59.946318499],[10.7521853549,59.9463936223],[10.7522433664,59.9464556475],[10.7524248317,59.9464186994]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064376",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064376",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064376",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Pastor Fangens vei",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN01",utvalgtNaturtypeTekst:"Slttemark",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7444763649,59.9451333846],[10.7443737852,59.9450598449],[10.7443350754,59.9448727354],[10.7442338197,59.9448740493],[10.7440278587,59.9449007533],[10.7440544796,59.9449418964],[10.7441019799,59.9449907278],[10.7442219131,59.9450924331],[10.7442857099,59.9451483549],[10.7443728776,59.9451492831],[10.7444634681,59.9451626406],[10.7444763649,59.9451333846]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064496",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064496",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064496",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Forskningsparken",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.720264324,59.9440303487],[10.7202449906,59.9439954615],[10.720164861,59.9439761327],[10.7200762618,59.9439349482],[10.7200286788,59.9438953663],[10.7199386023,59.9438281472],[10.7198360094,59.9437607011],[10.7196405193,59.9437048025],[10.7195152976,59.9436751958],[10.7193611,59.9437075901],[10.7192111681,59.9437513628],[10.7192026423,59.9437812983],[10.7192755116,59.9438096534],[10.7193610344,59.943830237],[10.7194591117,59.9438452041],[10.719544246,59.9438604698],[10.719636646,59.9438874812],[10.7197097543,59.9439223178],[10.7197678175,59.9439584639],[10.7198460153,59.9440052452],[10.7200041392,59.9440868148],[10.7201039734,59.9440909583],[10.7202018333,59.9440604189],[10.720264324,59.9440303487]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064693",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064693",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064693",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"John Collets all",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.740564448,59.9473285067],[10.7406061573,59.9473568307],[10.7406281706,59.947411493],[10.7406525683,59.947469919],[10.7406455137,59.9475192354],[10.7407377932,59.9475585461],[10.7408682741,59.9475558418],[10.7409348952,59.9475423505],[10.7409618517,59.9476143467],[10.7408267934,59.9476777772],[10.7407279711,59.9476280043],[10.7407872879,59.9475848739],[10.7405939591,59.9475633361],[10.7404423178,59.9476386385],[10.7404784574,59.947707515],[10.740503596,59.9477476218],[10.7405611244,59.9477825718],[10.7406372737,59.9478037372],[10.7406942389,59.9477914623],[10.7407545078,59.9477646377],[10.7408088514,59.9477378912],[10.7408599968,59.9476900006],[10.7412432821,59.9474928867],[10.7413276225,59.9474447205],[10.7412013432,59.9473798534],[10.7410352963,59.9472952671],[10.7409329339,59.9472493363],[10.740737676,59.9471535545],[10.7405679864,59.9470680406],[10.7404347682,59.9470892689],[10.7404435957,59.9471516873],[10.7404967977,59.9471770561],[10.7405398848,59.9472239477],[10.7405801845,59.9472646348],[10.7405780744,59.9472963973],[10.740564448,59.9473285067]]],[[[10.7401325618,59.9475983185],[10.7400524136,59.9475357514],[10.739989621,59.9474748246],[10.7400271111,59.9474550864],[10.7398258071,59.9472655037],[10.7397495398,59.9471839095],[10.7396854994,59.947208004],[10.7395463979,59.9472666267],[10.7395084144,59.9473125147],[10.7395703813,59.9473589384],[10.73969547,59.9473312437],[10.7397102239,59.9473503338],[10.7397458079,59.947406784],[10.7395316128,59.9474625281],[10.7395015212,59.9474735137],[10.7395438236,59.9475125575],[10.7396006527,59.9475320195],[10.7396554206,59.9475535729],[10.7397259489,59.947576625],[10.7399639333,59.9476830518],[10.7401325618,59.9475983185]]]]}},{type:"Feature",properties:{identifika:"UN-BN00064694",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00064694",faktaarkOp:"https://faktaark.naturbase.no?id=BN00064694",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Langlia",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7397502519,59.9441633364],[10.7396841787,59.944180981],[10.7396085373,59.9442117137],[10.739583473,59.944272856],[10.7394721552,59.9443622296],[10.739527065,59.9444286566],[10.7395448559,59.9445035938],[10.7395811402,59.9445740939],[10.7394090065,59.9446346149],[10.7390306648,59.9447920495],[10.7390237765,59.9448581857],[10.7390716364,59.9448846412],[10.7391090517,59.9449086907],[10.7391691983,59.9449260124],[10.739254102,59.9449236338],[10.7399006719,59.9446720094],[10.7400508072,59.9446390103],[10.74019221,59.9446307256],[10.7403105018,59.9446265489],[10.7404038303,59.9445864969],[10.7403583203,59.9444552742],[10.7403144461,59.9443880357],[10.7401223709,59.9443303905],[10.7400325479,59.9442901695],[10.7399919476,59.944253249],[10.7399236555,59.9441765884],[10.7398272077,59.9441558449],[10.7397502519,59.9441633364]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088701",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088701",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088701",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Hasselhaugveien 48",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7265938284,59.9395619289],[10.7265934997,59.93952694],[10.7265426458,59.9394849165],[10.7264813153,59.9394407546],[10.7263853144,59.939406977],[10.7262795082,59.9394145134],[10.726201584,59.9394337447],[10.7261332688,59.939467405],[10.7260972676,59.9395325963],[10.7261499384,59.9395799842],[10.7262121539,59.9396103275],[10.7263026115,59.9396259416],[10.7263949922,59.9396224655],[10.7264641527,59.9396100532],[10.7265371522,59.93958176],[10.7265938284,59.9395619289]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088704",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088704",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088704",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Ustvedts vei 10",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.756340795,59.9489979378],[10.7564066216,59.94902002],[10.7565000777,59.9490223115],[10.7565552084,59.9490103304],[10.7565973222,59.948983813],[10.7565903063,59.948940607],[10.7565593546,59.948881344],[10.7564227276,59.9488690297],[10.756344524,59.9489030162],[10.756306401,59.948950163],[10.756340795,59.9489979378]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088709",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088709",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088709",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Ustvedts vei 8",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.756651159,59.9492717514],[10.7566013669,59.9493050349],[10.7566000302,59.9493336752],[10.7566423128,59.949359045],[10.7566978386,59.9493817843],[10.756768994,59.9493762538],[10.7568349821,59.9493578786],[10.7568523328,59.9493189642],[10.7568222926,59.9492735778],[10.7567315382,59.9492543793],[10.756651159,59.9492717514]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088716",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088716",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088716",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Bjlsenparken",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7559975074,59.9402514011],[10.7559805737,59.9401666935],[10.755854719,59.9400425092],[10.7554511162,59.9399377867],[10.7552613661,59.9399655694],[10.7551019751,59.9400305668],[10.7553346136,59.9401045135],[10.7554373153,59.9401519727],[10.7555994463,59.9402503516],[10.7557498819,59.9403113078],[10.7558932869,59.9402983957],[10.7559975074,59.9402514011]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088735",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088735",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088735",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Tyrihansveien 17",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7281327289,59.9449035396],[10.7280876338,59.9449266246],[10.7280574716,59.9449590059],[10.7280650789,59.9449959392],[10.7281301235,59.9450197192],[10.7281673478,59.9450396296],[10.7282415346,59.9450467115],[10.7282869955,59.9450555593],[10.7283459906,59.9450511785],[10.728380317,59.9450129077],[10.7283815692,59.9449809374],[10.728378927,59.9449569335],[10.7283542907,59.9449311372],[10.7282952686,59.9449079123],[10.7282233585,59.9448929015],[10.7281327289,59.9449035396]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088744",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088744",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088744",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Sagene kirke",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.753630965,59.9374217776],[10.7537474904,59.9374269737],[10.7538390868,59.9374029522],[10.7539262238,59.9373941626],[10.754027578,59.9374604621],[10.7543076515,59.9374660754],[10.7543776005,59.9374151898],[10.7543765362,59.9373619249],[10.7543632721,59.9372723898],[10.7541055645,59.9372124689],[10.7538733909,59.9371588556],[10.7536831557,59.9371317709],[10.7534503268,59.9371924198],[10.7532614388,59.9372583518],[10.7531412053,59.9373436718],[10.7531821628,59.9374142285],[10.7533486432,59.9374085375],[10.7535102236,59.9374005303],[10.753630965,59.9374217776]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088748",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088748",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088748",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Universitetsbiblioteket",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7197195892,59.9392085637],[10.719619123,59.9391969357],[10.7195481865,59.9392119843],[10.7195092728,59.9392524417],[10.7195424357,59.939299558],[10.7196033064,59.9393347165],[10.7197029111,59.9393321992],[10.7197627011,59.9392979953],[10.7197527256,59.9392517226],[10.7197195892,59.9392085637]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088749",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088749",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088749",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Chr. Hansteens vei",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7272382731,59.9395450742],[10.7272048438,59.9394846435],[10.727157722,59.9394539811],[10.7270773183,59.9394298818],[10.727010614,59.9394315839],[10.7269765234,59.9394472026],[10.7269277612,59.9394737648],[10.7269214929,59.9395279619],[10.7269659592,59.9395639333],[10.7270417392,59.9395919289],[10.7271092627,59.9396047302],[10.7271859022,59.9395885139],[10.7272382731,59.9395450742]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088763",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088763",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088763",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"John Collets all 78",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7400670752,59.9452599666],[10.7400200195,59.9452272433],[10.7399314918,59.9452117914],[10.7398590936,59.9452172725],[10.7397727107,59.9452381266],[10.7397422041,59.9452900113],[10.7397805315,59.9453320736],[10.7398244026,59.945360288],[10.7399042196,59.9453835507],[10.7399808467,59.945403743],[10.7400622332,59.9453966643],[10.7401114879,59.945355097],[10.7401117133,59.9453003446],[10.7400670752,59.9452599666]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088764",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088764",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088764",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"John Collets all 3",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7311290684,59.9408194179],[10.7312209302,59.9408046817],[10.7312716931,59.940752826],[10.7312510371,59.9406849877],[10.7311341436,59.940638038],[10.7310266655,59.9406418374],[10.7309289764,59.9406656461],[10.7308829531,59.9406751241],[10.7308283217,59.9407236173],[10.7308170524,59.9407693799],[10.7308786704,59.9407974536],[10.730968752,59.9408215944],[10.7311290684,59.9408194179]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088768",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088768",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088768",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Berg skole",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7422786454,59.9496693578],[10.7422323483,59.9496432239],[10.7421777471,59.9496147535],[10.7421687283,59.9495691437],[10.7421476315,59.9495477807],[10.7420923887,59.9495410495],[10.7419924187,59.949532243],[10.7419488958,59.949492891],[10.7418641604,59.9494631765],[10.7417725353,59.9494577867],[10.741688081,59.9494621599],[10.7416452196,59.9495027656],[10.7416318273,59.9495637461],[10.7417135113,59.9495976781],[10.7417467599,59.9496304938],[10.7417455736,59.9496746048],[10.7417491079,59.9497070893],[10.7417673612,59.9497394202],[10.7418699943,59.9497637787],[10.7419302824,59.9497731009],[10.7419642592,59.9498225747],[10.7420317584,59.9498399528],[10.7421361442,59.9498353245],[10.7422250137,59.9498524041],[10.7423009977,59.9498455988],[10.7423568249,59.9498282509],[10.7423696957,59.9497922505],[10.7423475473,59.9497483743],[10.742300147,59.9497015238],[10.7422786454,59.9496693578]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088771",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088771",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088771",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Ustvedts vei",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7552043016,59.9489617673],[10.755114084,59.9490489562],[10.7550073833,59.9491654662],[10.7549320763,59.949257991],[10.7548134735,59.949466012],[10.7550068035,59.9494932831],[10.7552908056,59.9494088324],[10.7553956864,59.9494087054],[10.7555614015,59.9494416498],[10.755675979,59.9494609873],[10.7557814215,59.949518065],[10.7558349987,59.9495686159],[10.7557843893,59.9496670622],[10.7559125828,59.9497410579],[10.7560385598,59.9497329781],[10.7561416425,59.9496881041],[10.7561193895,59.9496239061],[10.7560792897,59.9495478936],[10.7559934701,59.9493851671],[10.7559288136,59.9492629555],[10.7558841157,59.9491906611],[10.7556918682,59.949098956],[10.7555324578,59.9490405888],[10.7554304905,59.9489955817],[10.7553171946,59.9489578524],[10.7552043016,59.9489617673]]]]}},{type:"Feature",properties:{identifika:"UN-BN00088779",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00088779",faktaarkOp:"https://faktaark.naturbase.no?id=BN00088779",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Kolonihagestien",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7302878546,59.9463992533],[10.7303006059,59.9464394104],[10.730382645,59.9464718328],[10.7304767641,59.9464786603],[10.7305402548,59.9464644433],[10.7305540767,59.94642254],[10.7305444094,59.9463918344],[10.7305330231,59.9463772582],[10.7304594755,59.9463526643],[10.7303493893,59.946348736],[10.7302878546,59.9463992533]]]]}},{type:"Feature",properties:{identifika:"UN-BN00093635",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00093635",faktaarkOp:"https://faktaark.naturbase.no?id=BN00093635",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Hartvig Halvorsens vei 5",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"A"},geometry:{type:"MultiPolygon",coordinates:[[[[10.705538769,59.9377651336],[10.7055027166,59.9377404889],[10.7054632854,59.937715644],[10.7053512483,59.9377090228],[10.7052510655,59.9377367777],[10.705212769,59.9377958646],[10.7052501348,59.9378435717],[10.7053331297,59.9378696575],[10.705445732,59.9378636185],[10.7054901414,59.9378472628],[10.705524412,59.9378081864],[10.705538769,59.9377651336]]]]}},{type:"Feature",properties:{identifika:"UN-BN00093637",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00093637",faktaarkOp:"https://faktaark.naturbase.no?id=BN00093637",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Diakkonveien 14",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7056168,59.9365026902],[10.7056532403,59.9365298653],[10.7057205028,59.9365473452],[10.7057759488,59.9365453767],[10.7058337569,59.9365348539],[10.7058955876,59.936507106],[10.7059134813,59.9364727109],[10.7058581111,59.9364367358],[10.7057601631,59.9364306642],[10.7056779046,59.9364390417],[10.7056443685,59.9364517057],[10.705619955,59.9364714121],[10.7056168,59.9365026902]]]]}},{type:"Feature",properties:{identifika:"UN-BN00108771",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00108771",faktaarkOp:"https://faktaark.naturbase.no?id=BN00108771",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Ivar Aasens vei 2B",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7101810487,59.9375340186],[10.7102004614,59.9375100132],[10.7102083979,59.937483296],[10.710198731,59.9374569054],[10.7101719756,59.9374420963],[10.7101527847,59.937433917],[10.7100904846,59.9374320672],[10.7100419088,59.9374432533],[10.7100193766,59.9374664386],[10.7100139846,59.9374928782],[10.71002992,59.937519294],[10.7100561794,59.9375351669],[10.7101240714,59.9375436721],[10.7101810487,59.9375340186]]]]}},{type:"Feature",properties:{identifika:"UN-BN00108775",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00108775",faktaarkOp:"https://faktaark.naturbase.no?id=BN00108775",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Hartvig Halvorsens vei 5 II",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7049837784,59.9372672225],[10.7049326407,59.9372594391],[10.7048426255,59.9372861774],[10.7047928597,59.9373300525],[10.7048260684,59.9374015427],[10.7050456869,59.9377369122],[10.7051068292,59.9377698387],[10.7051877983,59.9377589916],[10.7052888678,59.9377188577],[10.705346721,59.9376817185],[10.7052978444,59.9375956002],[10.7052923789,59.9375257343],[10.7052513205,59.9374691846],[10.7052070994,59.9374273685],[10.7051280029,59.9374071646],[10.7050869447,59.9373506157],[10.7050646707,59.9373233621],[10.7049837784,59.9372672225]]]]}},{type:"Feature",properties:{identifika:"UN-BN00108780",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00108780",faktaarkOp:"https://faktaark.naturbase.no?id=BN00108780",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Hafslundveien 5 I",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7090627058,59.9379035672],[10.7089928689,59.9379073161],[10.7089355877,59.9379123734],[10.708868376,59.9379110824],[10.7088203089,59.937918329],[10.7087878987,59.9379402913],[10.7088033582,59.9379703785],[10.7088621316,59.9379981006],[10.7089347082,59.9380202478],[10.7089804298,59.9380366643],[10.7090164042,59.9380411636],[10.7090553242,59.9380409032],[10.7091254282,59.9380323082],[10.7091657226,59.9380131187],[10.7091927006,59.9379957441],[10.709202828,59.9379728758],[10.7091909255,59.9379499174],[10.7091456211,59.9379233537],[10.7091133988,59.9379064788],[10.7090627058,59.9379035672]]]]}},{type:"Feature",properties:{identifika:"UN-BN00108786",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00108786",faktaarkOp:"https://faktaark.naturbase.no?id=BN00108786",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Villaveien 18",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"C"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7117864868,59.9369311592],[10.7116895569,59.9369075002],[10.7116104873,59.9369161651],[10.7115199294,59.9369457666],[10.7114410432,59.9369627109],[10.7114092932,59.9369754336],[10.7114133112,59.9370053277],[10.7114506356,59.9370423319],[10.7114946816,59.9370897142],[10.7115352426,59.9371100081],[10.7116188005,59.9371192934],[10.7117281152,59.9371095452],[10.7118037775,59.9370856629],[10.7118376283,59.937058081],[10.7118347462,59.9370401841],[10.7118197061,59.9369777392],[10.7117864868,59.9369311592]]]]}},{type:"Feature",properties:{identifika:"UN-BN00108789",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00108789",faktaarkOp:"https://faktaark.naturbase.no?id=BN00108789",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Slemdalsveien 37",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7101389219,59.9369205662],[10.7101700694,59.9368917286],[10.7101702935,59.9368636802],[10.7101588819,59.9368383109],[10.7101311744,59.9368197841],[10.7100943296,59.9368109415],[10.7100367002,59.9368076254],[10.7099807955,59.9368214491],[10.7099603542,59.9368437125],[10.7099462765,59.9368694204],[10.7099449514,59.9368921268],[10.7099550861,59.936930134],[10.7100034579,59.9369426792],[10.7100826417,59.936942831],[10.7101389219,59.9369205662]]]]}},{type:"Feature",properties:{identifika:"UN-BN00108799",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00108799",faktaarkOp:"https://faktaark.naturbase.no?id=BN00108799",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Villaveien 38",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN03",utvalgtNaturtypeTekst:"Hule eiker",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7154799511,59.9390561258],[10.7153878647,59.9390684168],[10.7153436047,59.9390988971],[10.7153445123,59.9391487426],[10.7153604012,59.9391810899],[10.715406752,59.9392023802],[10.7154651376,59.9392095859],[10.7155466697,59.9392193413],[10.7156256914,59.9392027595],[10.7156661178,59.9391714351],[10.71568257,59.9391453534],[10.7156712843,59.9391134247],[10.7156304357,59.9390939321],[10.715557729,59.9390574874],[10.7154799511,59.9390561258]]]]}},{type:"Feature",properties:{identifika:"UN-BN00063962",identifi_1:"http://www.miljodirektoratet.no/naturbase",faktaark:"https://faktaark.naturbase.no?id=UN-BN00063962",faktaarkOp:"https://faktaark.naturbase.no?id=BN00063962",lokalitets:"ikkeKvalitetsvurdert",naturmangf:null,nyaktigh:"1",omrdenav:"Halvor Blinderns plass",opphav:"Naturtyper - DN-hndbok 13",registreri:null,tilstand:null,utvalgtNaturtype:"UN07",utvalgtNaturtypeTekst:"pen grunnlendt kalkmark i boreonemoral sone",verdi:"B"},geometry:{type:"MultiPolygon",coordinates:[[[[10.7224785477,59.9371172365],[10.722436051,59.9371243983],[10.7223319889,59.9371601325],[10.7222418813,59.9371932627],[10.7221754976,59.9372216784],[10.7221615587,59.9372408279],[10.7221662501,59.9372669667],[10.722199485,59.9372857603],[10.7222370768,59.937293006],[10.7222939187,59.9372857708],[10.7223507348,59.9372717908],[10.7224266091,59.9372337022],[10.7224880615,59.9372004504],[10.7225306758,59.9371743196],[10.7225590582,59.9371529417],[10.7225589973,59.9371339669],[10.722540155,59.937124453],[10.7225212024,59.9371171833],[10.7224785477,59.9371172365]]]]}}],Lre={type:kre,name:Cre,crs:Ire,features:Are},Pre="FeatureCollection",Rre="Ullevaal_Oslo_25832_MatrikkelenEiendomskartTeig_eiendomsgrense",Nre={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},Dre=[{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73032055782367,59.940686810350705,0],[10.731361461991018,59.941167396639386,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731361461991018,59.941167396639386,0],[10.732439792874583,59.94166481744599,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73222514622362,59.94180864430197,0],[10.731554423145775,59.94225538335705,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73148875090015,59.94225929912846,0],[10.730800461525316,59.94202601485711,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730575901711001,59.94195235013076,0],[10.730356376366155,59.94188939664307,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730356376366155,59.94188939664307,0],[10.730080644953485,59.94182304860056,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73302675342225,59.94062200165439,0],[10.732344214861401,59.94095483672523,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732344214861401,59.94095483672523,0],[10.731855119667436,59.941194057082576,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731944743963586,59.93926080417605,0],[10.731935968811923,59.9392641527051,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732610239287641,59.94158991919228,0],[10.732474953905951,59.941679983234025,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731848534835397,59.94123940972821,0],[10.732610239287641,59.94158991919228,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731848534835397,59.94123940972821,0],[10.731233512194859,59.940989628028085,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730251636975924,59.940645501979404,0],[10.730070625380504,59.94075125209965,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732619262293557,59.94159407034305,0],[10.732610239287641,59.94158991919228,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730676590016621,59.93787734225299,0],[10.730660404943205,59.93787553831222,0],[10.730643991515512,59.937874366961154,0],[10.730627446647757,59.937873833215,0],[10.730610869089524,59.93787394296305,0],[10.730594358958122,59.93787469399351,0],[10.730578012653199,59.93787608144888,0],[10.73056192822282,59.937878097755764,0],[10.73054620169259,59.93788073087664,0],[10.73053092711247,59.937883965207355,0],[10.730516194721362,59.93788778070318,0],[10.730502092922835,59.93789215644526,0],[10.730488706122355,59.937897063484066,0],[10.730476115288576,59.93790247560958,0],[10.730464391979297,59.937908357753905,0],[10.730453609681394,59.93791467751818,0],[10.730443830729111,59.937921394566736,0],[10.730435114019775,59.93792847130337,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730171129970085,59.94031999496637,0],[10.731039225243244,59.940311927899685,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730207471024235,59.939437187098115,0],[10.730242808730528,59.93946267973109,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730242808730528,59.93946267973109,0],[10.730276728326233,59.93947813180791,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730276728326233,59.93947813180791,0],[10.730888304296421,59.939679643091566,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731944743963586,59.93926080417605,0],[10.731731634354887,59.93888467763415,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732172361569264,59.93961985485288,0],[10.731964379886758,59.93925291214832,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731964379886758,59.93925291214832,0],[10.731944743963586,59.93926080417605,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.733121857042637,59.940619584456236,0],[10.732611882482969,59.94032810237307,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730522438895683,59.93812383829921,0],[10.730445255617438,59.938425368177455,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730489388405534,59.938568132065754,0],[10.730568586186587,59.9387208542635,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731731634354887,59.93888467763415,0],[10.73128408138065,59.938093724399586,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73128408138065,59.938093724399586,0],[10.731275518277021,59.93807981505996,0],[10.73126571670169,59.938066114178326,0],[10.73125469411095,59.9380526475713,0],[10.731242475302839,59.938039444551684,0],[10.731229083099413,59.93802653086557,0],[10.731214547477272,59.93801393216524,0],[10.731198894882297,59.938001675047296,0],[10.73118215882133,59.93798978421947,0],[10.731164370965557,59.93797828351536,0],[10.7311455700939,59.9379671957772,0],[10.73112579503187,59.93795654474469,0],[10.731105082675795,59.937946351488435,0],[10.731083477029658,59.93793663608766,0],[10.73106102030862,59.937927418645025,0],[10.73103776183555,59.937918718271796,0],[10.731013743684892,59.937910552378135,0],[10.730989018616123,59.937902937335785,0],[10.730963633929004,59.93789588779197,0],[10.73093764417133,59.937889420095026,0],[10.730911100032793,59.93788354525515,0],[10.730884054131867,59.937878276951714,0],[10.730856564219065,59.937873624305965,0],[10.730828684560953,59.937869598281324,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730757376845276,59.940766761565094,0],[10.7302095144119,59.94051043565731,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730757376845276,59.940766761565094,0],[10.730821304762665,59.94073287119835,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731233512194859,59.940989628028085,0],[10.730757376845276,59.940766761565094,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731323272494974,59.94094650678214,0],[10.731233512194859,59.940989628028085,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731861495042157,59.9406882314993,0],[10.731323272494974,59.94094650678214,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730888304296421,59.939679643091566,0],[10.730850031201237,59.939704305279015,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731930535695337,59.940192989399414,0],[10.731415885946232,59.940484366374534,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730062545764762,59.94181924437598,0],[10.730068625614937,59.94181224896676,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730097206248113,59.94075638208666,0],[10.730144266178819,59.940728551207556,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730080644953485,59.94182304860056,0],[10.730062545764762,59.94181924437598,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730142899828763,59.93930753461848,0],[10.73007616326895,59.93972379904089,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730142899828763,59.93930753461848,0],[10.730161623075869,59.93936800317134,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730161623075869,59.93936800317134,0],[10.730207471024235,59.939437187098115,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.7302095144119,59.94051043565731,0],[10.730189534727769,59.94044648085661,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730189534727769,59.94044648085661,0],[10.730171129970085,59.94031999496637,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.729943404615042,59.94178640833288,0],[10.729926048159173,59.941782634764756,0],[10.729909265343153,59.9417782582054,0],[10.729893139531296,59.94177329821892,0],[10.729877749095218,59.94176778161995,0],[10.729863170570741,59.94176173434918,0],[10.729849477196293,59.94175518777934,0],[10.729836736796802,59.94174817245599,0],[10.729825012157631,59.941740725277874,0],[10.72981436422842,59.94173288226953,0],[10.729804841576737,59.94172468231238,0],[10.729796492863564,59.941716166082855,0],[10.729789361476579,59.941707376122785,0],[10.729783481952524,59.94169835688632,0],[10.729778883367878,59.94168915110301,0],[10.729775587877366,59.94167980608369,0],[10.72977361038661,59.94167036743799,0],[10.729772964152636,59.94166088349163,0],[10.729773651512154,59.94165139912082,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.729943404615042,59.94178640833288,0],[10.730068625614937,59.94181224896676,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.729846190660373,59.941140215541715,0],[10.72985002373156,59.94111751422711,0],[10.729855062776076,59.941094871641376,0],[10.729861306891053,59.94107230486091,0],[10.729868749760406,59.94104983013479,0],[10.72987738506808,59.941027463712125,0],[10.729887209982264,59.941005220000015,0],[10.729898214656078,59.94098311619193,0],[10.729910390938109,59.940961167662834,0],[10.729923732512562,59.94093939066171,0],[10.729938227603736,59.940917799712864,0],[10.729953866271583,59.94089641021455,0],[10.729970640411768,59.940875238439176,0],[10.72998853288238,59.94085429898136,0],[10.730007535532536,59.94083360721587,0],[10.730027631173806,59.94081317683974,0],[10.730048808077882,59.940793023274644,0],[10.730071050892159,59.9407731610916,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.7302095144119,59.94051043565731,0],[10.729783668530402,59.940775044199924,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730038016772923,59.94184781472972,0],[10.730044489762996,59.941840318008104,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73007616326895,59.93972379904089,0],[10.729981281056526,59.94023204266448,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732561413365385,59.94035229657,0],[10.732611882482969,59.94032810237307,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730850031201237,59.939704305279015,0],[10.731609945110668,59.94004882616368,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731280813610422,59.939524502368386,0],[10.730888304296421,59.939679643091566,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73152224514779,59.93965425759682,0],[10.731280813610422,59.939524502368386,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730336887152967,59.93825210198536,0],[10.730142899828763,59.93930753461848,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730793195820379,59.93789269710065,0],[10.730676590016621,59.93787734225299,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730435114019775,59.93792847130337,0],[10.730418746793264,59.937968582262485,0],[10.730403541789261,59.93800880820081,0],[10.730389502121508,59.93804914009651,0],[10.730376630997347,59.93808957072283,0],[10.730364931483855,59.93813009016035,0],[10.730354406788432,59.93817069118224,0],[10.73034505823639,59.93821136479011,0],[10.730336887152967,59.93825210198536,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.7304433931301,59.93790956330796,0],[10.730435114019775,59.93792847130337,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731731634354887,59.93888467763415,0],[10.731741088282272,59.938881136953945,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730445255617438,59.938425368177455,0],[10.730489388405534,59.938568132065754,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730568586186587,59.9387208542635,0],[10.731424956997598,59.93903456163276,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731424956997598,59.93903456163276,0],[10.731613540286595,59.93890607700242,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731613540286595,59.93890607700242,0],[10.731731634354887,59.93888467763415,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730828684560953,59.937869598281324,0],[10.730793195820379,59.93789269710065,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730793195820379,59.93789269710065,0],[10.730770310067735,59.93790155219908,0],[10.730748195668673,59.93791088665694,0],[10.730726891178325,59.937920684700224,0],[10.730706435011616,59.93793092786251,0],[10.73068686558364,59.9379415976773,0],[10.730668215943668,59.93795267574854,0],[10.730650522578108,59.93796414094067,0],[10.730633816654333,59.937975973086054,0],[10.730618127504394,59.93798815114298,0],[10.730603482578328,59.93800065229819,0],[10.730589911161687,59.93801345461244,0],[10.730577435338756,59.938026535342765,0],[10.730566078842296,59.93803986903026,0],[10.730555862014912,59.93805343385297,0],[10.730546801388174,59.938067203548236,0],[10.73053891721133,59.938081154498974,0],[10.730532220696885,59.93809526141044,0],[10.730526724752513,59.93810949716927,0],[10.730522438895683,59.93812383829921,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.729773651512154,59.94165139912082,0],[10.729846190660373,59.941140215541715,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730071050892159,59.9407731610916,0],[10.730097206248113,59.94075638208666,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730144266178819,59.940728551207556,0],[10.730200564733325,59.94070625739277,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730200564733325,59.94070625739277,0],[10.73032055782367,59.940686810350705,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732439792874583,59.94166481744599,0],[10.73222514622362,59.94180864430197,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730800461525316,59.94202601485711,0],[10.730575901711001,59.94195235013076,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732561413365385,59.94035229657,0],[10.73302675342225,59.94062200165439,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731855119667436,59.941194057082576,0],[10.731568922999704,59.9410608484429,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731568922999704,59.9410608484429,0],[10.731323272494974,59.94094650678214,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731861495042157,59.9406882314993,0],[10.73217164046296,59.94053937885755,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731935968811923,59.9392641527051,0],[10.731280813610422,59.939524502368386,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730044489762996,59.941840318008104,0],[10.730062545764762,59.94181924437598,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730484362464425,59.94195453906701,0],[10.730431032445825,59.94193871926565,0],[10.730377200553924,59.94192333264271,0],[10.730322883074315,59.94190838257646,0],[10.730268092761492,59.941893873389695,0],[10.730212844158709,59.94187980938172,0],[10.730157149879997,59.94186619218275,0],[10.730101028139778,59.941853027840324,0],[10.730044489762996,59.941840318008104,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730679545620776,59.942017542301606,0],[10.7306314656821,59.942001239651574,0],[10.730582901779682,59.9419853016913,0],[10.730533863184474,59.94196973458553,0],[10.730484362464425,59.94195453906701,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731528646616306,59.94231032855275,0],[10.730679545620776,59.942017542301606,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730070625380504,59.94075125209965,0],[10.729783668530402,59.940775044199924,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730071050892159,59.9407731610916,0],[10.730093940821002,59.94075393527971,0],[10.730117827736336,59.94073501791951,0],[10.730142697981334,59.940716421763476,0],[10.730168530743999,59.940698159658105,0],[10.730195310578937,59.94068024437931,0],[10.730223020205298,59.940662687828954,0],[10.730251636975924,59.940645501979404,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730484362464425,59.94195453906701,0],[10.730493330150036,59.94196775249603,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.733121857042637,59.940619584456236,0],[10.731848534835397,59.94123940972821,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.729981281056526,59.94023204266448,0],[10.730171129970085,59.94031999496637,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731039225243244,59.940311927899685,0],[10.73134363355183,59.940451275358875,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73134363355183,59.940451275358875,0],[10.731415885946232,59.940484366374534,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.7331304759793,59.94062457872484,0],[10.733121857042637,59.940619584456236,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.730821304762665,59.94073287119835,0],[10.73134363355183,59.940451275358875,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731531044850648,59.9405370123934,0],[10.731861495042157,59.9406882314993,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731560999065122,59.94228879759379,0],[10.731572867268381,59.942292890639585,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73248566489033,59.94168491091837,0],[10.732474953905951,59.941679983234025,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732474953905951,59.941679983234025,0],[10.731560999065122,59.94228879759379,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732172361569264,59.93961985485288,0],[10.731789202037085,59.93981349545905,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732350723759211,59.93992332860805,0],[10.732172361569264,59.93961985485288,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732556062518668,59.94024288372594,0],[10.732350723759211,59.93992332860805,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732195834016403,59.94031344866368,0],[10.732556062518668,59.94024288372594,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731930535695337,59.940192989399414,0],[10.732195834016403,59.94031344866368,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731609945110668,59.94004882616368,0],[10.731930535695337,59.940192989399414,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732611882482969,59.94032810237307,0],[10.732556062518668,59.94024288372594,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731415885946232,59.940484366374534,0],[10.731531044850648,59.9405370123934,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731554423145775,59.94225538335705,0],[10.73148875090015,59.94225929912846,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731560999065122,59.94228879759379,0],[10.731528646616306,59.94231032855275,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731528646616306,59.94231032855275,0],[10.73154053232257,59.942314427193736,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731789202037085,59.93981349545905,0],[10.731591142044808,59.93991480128343,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731591142044808,59.93991480128343,0],[10.731609945110668,59.94004882616368,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.731789202037085,59.93981349545905,0],[10.73152224514779,59.93965425759682,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.732425381733552,59.940417671603456,0],[10.732561413365385,59.94035229657,0]]]}},{type:"Feature",properties:[],geometry:{type:"MultiLineString",coordinates:[[[10.73217164046296,59.94053937885755,0],[10.732425381733552,59.940417671603456,0]]]}}],Ore={type:Pre,name:Rre,crs:Nre,features:Dre};var Xl=63710088e-1,zI={centimeters:Xl*100,centimetres:Xl*100,degrees:Xl/111325,feet:Xl*3.28084,inches:Xl*39.37,kilometers:Xl/1e3,kilometres:Xl/1e3,meters:Xl,metres:Xl,miles:Xl/1609.344,millimeters:Xl*1e3,millimetres:Xl*1e3,nauticalmiles:Xl/1852,radians:1,yards:Xl*1.0936},Fre={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Xl,yards:1.0936133},Qk={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function id(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function zre(t,e,n){switch(t){case"Point":return Zh(e).geometry;case"LineString":return rp(e).geometry;case"Polygon":return gM(e).geometry;case"MultiPoint":return XV(e).geometry;case"MultiLineString":return BI(e).geometry;case"MultiPolygon":return ZV(e).geometry;default:throw new Error(t+" is invalid")}}function Zh(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!CS(t[0])||!CS(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return id(r,e,n)}function Bre(t,e,n){return n===void 0&&(n={}),hp(t.map(function(r){return Zh(r,e)}),n)}function gM(t,e,n){n===void 0&&(n={});for(var r=0,s=t;r<s.length;r++){var u=s[r];if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var p=0;p<u[u.length-1].length;p++)if(u[u.length-1][p]!==u[0][p])throw new Error("First and last Position are not equivalent.")}var g={type:"Polygon",coordinates:t};return id(g,e,n)}function Ure(t,e,n){return n===void 0&&(n={}),hp(t.map(function(r){return gM(r,e)}),n)}function rp(t,e,n){if(n===void 0&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:t};return id(r,e,n)}function jre(t,e,n){return n===void 0&&(n={}),hp(t.map(function(r){return rp(r,e)}),n)}function hp(t,e){e===void 0&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function BI(t,e,n){n===void 0&&(n={});var r={type:"MultiLineString",coordinates:t};return id(r,e,n)}function XV(t,e,n){n===void 0&&(n={});var r={type:"MultiPoint",coordinates:t};return id(r,e,n)}function ZV(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return id(r,e,n)}function Vre(t,e,n){n===void 0&&(n={});var r={type:"GeometryCollection",geometries:t};return id(r,e,n)}function Gre(t,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function yM(t,e){e===void 0&&(e="kilometers");var n=zI[e];if(!n)throw new Error(e+" units is invalid");return t*n}function _M(t,e){e===void 0&&(e="kilometers");var n=zI[e];if(!n)throw new Error(e+" units is invalid");return t/n}function e2(t,e){return pb(_M(t,e))}function Hre(t){var e=t%360;return e<0&&(e+=360),e}function pb(t){var e=t%(2*Math.PI);return e*180/Math.PI}function D1(t){var e=t%360;return e*Math.PI/180}function UI(t,e,n){if(e===void 0&&(e="kilometers"),n===void 0&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return yM(_M(t,e),n)}function Wre(t,e,n){if(e===void 0&&(e="meters"),n===void 0&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=Qk[e];if(!r)throw new Error("invalid original units");var s=Qk[n];if(!s)throw new Error("invalid final units");return t/r*s}function CS(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function vM(t){return!!t&&t.constructor===Object}function qre(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(e){if(!CS(e))throw new Error("bbox must only contain numbers")})}function $re(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}const Xre=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Qk,bearingToAzimuth:Hre,convertArea:Wre,convertLength:UI,degreesToRadians:D1,earthRadius:Xl,factors:zI,feature:id,featureCollection:hp,geometry:zre,geometryCollection:Vre,isNumber:CS,isObject:vM,lengthToDegrees:e2,lengthToRadians:_M,lineString:rp,lineStrings:jre,multiLineString:BI,multiPoint:XV,multiPolygon:ZV,point:Zh,points:Bre,polygon:gM,polygons:Ure,radiansToDegrees:pb,radiansToLength:yM,round:Gre,unitsFactors:Fre,validateBBox:qre,validateId:$re},Symbol.toStringTag,{value:"Module"}));function e_(t,e,n){if(t!==null)for(var r,s,u,p,g,l,E,P=0,O=0,j,$=t.type,Y=$==="FeatureCollection",re=$==="Feature",_e=Y?t.features.length:1,J=0;J<_e;J++){E=Y?t.features[J].geometry:re?t.geometry:t,j=E?E.type==="GeometryCollection":!1,g=j?E.geometries.length:1;for(var H=0;H<g;H++){var te=0,ce=0;if(p=j?E.geometries[H]:E,p!==null){l=p.coordinates;var Se=p.type;switch(P=n&&(Se==="Polygon"||Se==="MultiPolygon")?1:0,Se){case null:break;case"Point":if(e(l,O,J,te,ce)===!1)return!1;O++,te++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(e(l[r],O,J,te,ce)===!1)return!1;O++,Se==="MultiPoint"&&te++}Se==="LineString"&&te++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(s=0;s<l[r].length-P;s++){if(e(l[r][s],O,J,te,ce)===!1)return!1;O++}Se==="MultiLineString"&&te++,Se==="Polygon"&&ce++}Se==="Polygon"&&te++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(ce=0,s=0;s<l[r].length;s++){for(u=0;u<l[r][s].length-P;u++){if(e(l[r][s][u],O,J,te,ce)===!1)return!1;O++}ce++}te++}break;case"GeometryCollection":for(r=0;r<p.geometries.length;r++)if(e_(p.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Zre(t,e,n,r){var s=n;return e_(t,function(u,p,g,l,E){p===0&&n===void 0?s=u:s=e(s,u,p,g,l,E)},r),s}function YV(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&e(t.features[n].properties,n)!==!1;n++);break;case"Feature":e(t.properties,0);break}}function Yre(t,e,n){var r=n;return YV(t,function(s,u){u===0&&n===void 0?r=s:r=e(r,s,u)}),r}function mb(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var n=0;n<t.features.length&&e(t.features[n],n)!==!1;n++);}function Kre(t,e,n){var r=n;return mb(t,function(s,u){u===0&&n===void 0?r=s:r=e(r,s,u)}),r}function Jre(t){var e=[];return e_(t,function(n){e.push(n)}),e}function M9(t,e){var n,r,s,u,p,g,l,E,P,O,j=0,$=t.type==="FeatureCollection",Y=t.type==="Feature",re=$?t.features.length:1;for(n=0;n<re;n++){for(g=$?t.features[n].geometry:Y?t.geometry:t,E=$?t.features[n].properties:Y?t.properties:{},P=$?t.features[n].bbox:Y?t.bbox:void 0,O=$?t.features[n].id:Y?t.id:void 0,l=g?g.type==="GeometryCollection":!1,p=l?g.geometries.length:1,s=0;s<p;s++){if(u=l?g.geometries[s]:g,u===null){if(e(null,j,E,P,O)===!1)return!1;continue}switch(u.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(u,j,E,P,O)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<u.geometries.length;r++)if(e(u.geometries[r],j,E,P,O)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}j++}}function Qre(t,e,n){var r=n;return M9(t,function(s,u,p,g,l){u===0&&n===void 0?r=s:r=e(r,s,u,p,g,l)}),r}function Zg(t,e){M9(t,function(n,r,s,u,p){var g=n===null?null:n.type;switch(g){case null:case"Point":case"LineString":case"Polygon":return e(id(n,s,{bbox:u,id:p}),r,0)===!1?!1:void 0}var l;switch(g){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var E=0;E<n.coordinates.length;E++){var P=n.coordinates[E],O={type:l,coordinates:P};if(e(id(O,s),r,E)===!1)return!1}})}function eie(t,e,n){var r=n;return Zg(t,function(s,u,p){u===0&&p===0&&n===void 0?r=s:r=e(r,s,u,p)}),r}function KV(t,e){Zg(t,function(n,r,s){var u=0;if(n.geometry){var p=n.geometry.type;if(!(p==="Point"||p==="MultiPoint")){var g,l=0,E=0,P=0;if(e_(n,function(O,j,$,Y,re){if(g===void 0||r>l||Y>E||re>P){g=O,l=r,E=Y,P=re,u=0;return}var _e=rp([g,O],n.properties);if(e(_e,r,s,re,u)===!1)return!1;u++,g=O})===!1)return!1}}})}function tie(t,e,n){var r=n,s=!1;return KV(t,function(u,p,g,l,E){s===!1&&n===void 0?r=u:r=e(r,u,p,g,l,E),s=!0}),r}function JV(t,e){if(!t)throw new Error("geojson is required");Zg(t,function(n,r,s){if(n.geometry!==null){var u=n.geometry.type,p=n.geometry.coordinates;switch(u){case"LineString":if(e(n,r,s,0,0)===!1)return!1;break;case"Polygon":for(var g=0;g<p.length;g++)if(e(rp(p[g],n.properties),r,s,g)===!1)return!1;break}}})}function nie(t,e,n){var r=n;return JV(t,function(s,u,p,g){u===0&&n===void 0?r=s:r=e(r,s,u,p,g)}),r}function rie(t,e){if(e=e||{},!vM(e))throw new Error("options is invalid");var n=e.featureIndex||0,r=e.multiFeatureIndex||0,s=e.geometryIndex||0,u=e.segmentIndex||0,p=e.properties,g;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),p=p||t.features[n].properties,g=t.features[n].geometry;break;case"Feature":p=p||t.properties,g=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=t;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var l=g.coordinates;switch(g.type){case"Point":case"MultiPoint":return null;case"LineString":return u<0&&(u=l.length+u-1),rp([l[u],l[u+1]],p,e);case"Polygon":return s<0&&(s=l.length+s),u<0&&(u=l[s].length+u-1),rp([l[s][u],l[s][u+1]],p,e);case"MultiLineString":return r<0&&(r=l.length+r),u<0&&(u=l[r].length+u-1),rp([l[r][u],l[r][u+1]],p,e);case"MultiPolygon":return r<0&&(r=l.length+r),s<0&&(s=l[r].length+s),u<0&&(u=l[r][s].length-u-1),rp([l[r][s][u],l[r][s][u+1]],p,e)}throw new Error("geojson is invalid")}function iie(t,e){if(e=e||{},!vM(e))throw new Error("options is invalid");var n=e.featureIndex||0,r=e.multiFeatureIndex||0,s=e.geometryIndex||0,u=e.coordIndex||0,p=e.properties,g;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),p=p||t.features[n].properties,g=t.features[n].geometry;break;case"Feature":p=p||t.properties,g=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=t;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var l=g.coordinates;switch(g.type){case"Point":return Zh(l,p,e);case"MultiPoint":return r<0&&(r=l.length+r),Zh(l[r],p,e);case"LineString":return u<0&&(u=l.length+u),Zh(l[u],p,e);case"Polygon":return s<0&&(s=l.length+s),u<0&&(u=l[s].length+u),Zh(l[s][u],p,e);case"MultiLineString":return r<0&&(r=l.length+r),u<0&&(u=l[r].length+u),Zh(l[r][u],p,e);case"MultiPolygon":return r<0&&(r=l.length+r),s<0&&(s=l[r].length+s),u<0&&(u=l[r][s].length-u),Zh(l[r][s][u],p,e)}throw new Error("geojson is invalid")}const sie=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Jre,coordEach:e_,coordReduce:Zre,featureEach:mb,featureReduce:Kre,findPoint:iie,findSegment:rie,flattenEach:Zg,flattenReduce:eie,geomEach:M9,geomReduce:Qre,lineEach:JV,lineReduce:nie,propEach:YV,propReduce:Yre,segmentEach:KV,segmentReduce:tie},Symbol.toStringTag,{value:"Module"}));function oie(t,e){e===void 0&&(e={});var n=0,r=0,s=0;return e_(t,function(u){n+=u[0],r+=u[1],s++},!0),Zh([n/s,r/s],e.properties)}function vy(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function gb(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function xM(t){return t.type==="Feature"?t.geometry:t}function aie(t,e,n){n===void 0&&(n={});var r;n.final?r=g8(vy(e),vy(t)):r=g8(vy(t),vy(e));var s=r>180?-(360-r):r;return s}function g8(t,e){var n=D1(t[1]),r=D1(e[1]),s=D1(e[0]-t[0]);s>Math.PI&&(s-=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI);var u=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),p=Math.atan2(s,u);return(pb(p)+360)%360}function lie(t,e,n){n===void 0&&(n={});var r=vy(t),s=vy(e);s[0]+=s[0]-r[0]>180?-360:r[0]-s[0]>180?360:0;var u=uie(r,s),p=UI(u,"meters",n.units);return p}function uie(t,e,n){n=n===void 0?Xl:Number(n);var r=n,s=t[1]*Math.PI/180,u=e[1]*Math.PI/180,p=u-s,g=Math.abs(e[0]-t[0])*Math.PI/180;g>Math.PI&&(g-=2*Math.PI);var l=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),E=Math.abs(l)>1e-11?p/l:Math.cos(s),P=Math.sqrt(p*p+E*E*g*g),O=P*r;return O}function cie(t,e,n,r){r===void 0&&(r={});var s=e<0,u=UI(Math.abs(e),r.units,"meters");s&&(u=-Math.abs(u));var p=vy(t),g=hie(p,u,n);return g[0]+=g[0]-p[0]>180?-360:p[0]-g[0]>180?360:0,Zh(g,r.properties)}function hie(t,e,n,r){r=r===void 0?Xl:Number(r);var s=e/r,u=t[0]*Math.PI/180,p=D1(t[1]),g=D1(n),l=s*Math.cos(g),E=p+l;Math.abs(E)>Math.PI/2&&(E=E>0?Math.PI-E:-Math.PI-E);var P=Math.log(Math.tan(E/2+Math.PI/4)/Math.tan(p/2+Math.PI/4)),O=Math.abs(P)>1e-11?l/P:Math.cos(p),j=s*Math.sin(g)/O,$=u+j;return[($*180/Math.PI+540)%360-180,E*180/Math.PI]}function die(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return QV(t);case"FeatureCollection":return fie(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return jI(t);default:throw new Error("unknown GeoJSON type")}}function QV(t){var e={type:"Feature"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}}),e.properties=eG(t.properties),e.geometry=jI(t.geometry),e}function eG(t){var e={};return t&&Object.keys(t).forEach(function(n){var r=t[n];typeof r=="object"?r===null?e[n]=null:Array.isArray(r)?e[n]=r.map(function(s){return s}):e[n]=eG(r):e[n]=r}),e}function fie(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}}),e.features=t.features.map(function(n){return QV(n)}),e}function jI(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),t.type==="GeometryCollection"?(e.geometries=t.geometries.map(function(n){return jI(n)}),e):(e.coordinates=tG(t.coordinates),e)}function tG(t){var e=t;return typeof e[0]!="object"?e.slice():e.map(function(n){return tG(n)})}function pie(t,e,n){if(n=n||{},!vM(n))throw new Error("options is invalid");var r=n.pivot,s=n.mutate;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("angle is required");return e===0||(r||(r=oie(t)),(s===!1||s===void 0)&&(t=die(t)),e_(t,function(u){var p=aie(r,u),g=p+e,l=lie(r,u),E=gb(cie(r,l,g));u[0]=E[0],u[1]=E[1]})),t}function IS(t){var e=[1/0,1/0,-1/0,-1/0];return e_(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}IS.default=IS;const mie=Object.freeze(Object.defineProperty({__proto__:null,default:IS},Symbol.toStringTag,{value:"Module"}));function gie(t,e){e===void 0&&(e={});var n=IS(t),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return Zh([r,s],e.properties,e)}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,s=1 in arguments&&parseInt(Number(arguments[1]),10)||0;s=s<0?Math.max(r+s,0):Math.min(s,r);var u=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(u=u<0?Math.max(r+arguments[2],0):Math.min(u,r);s<u;)n[s]=e,++s;return n},writable:!0});Number.isFinite=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)};Number.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(t){return t!==t};Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var q1=function(){};q1.prototype.interfaces_=function(){return[]};q1.prototype.getClass=function(){return q1};q1.prototype.equalsWithTolerance=function(e,n,r){return Math.abs(e-n)<=r};var Po=function(t){function e(n){t.call(this,n),this.name="IllegalArgumentException",this.message=n,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Ai=function(){},nG={MAX_VALUE:{configurable:!0}};Ai.isNaN=function(e){return Number.isNaN(e)};Ai.doubleToLongBits=function(e){return e};Ai.longBitsToDouble=function(e){return e};Ai.isInfinite=function(e){return!Number.isFinite(e)};nG.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Ai,nG);var Eh=function(){},bM=function(){},yb=function(){};function Sh(){}var Wt=function t(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},uv={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Wt.prototype.setOrdinate=function(e,n){switch(e){case Wt.X:this.x=n;break;case Wt.Y:this.y=n;break;case Wt.Z:this.z=n;break;default:throw new Po("Invalid ordinate index: "+e)}};Wt.prototype.equals2D=function(){if(arguments.length===1){var e=arguments[0];return!(this.x!==e.x||this.y!==e.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!q1.equalsWithTolerance(this.x,n.x,r)||!q1.equalsWithTolerance(this.y,n.y,r))}};Wt.prototype.getOrdinate=function(e){switch(e){case Wt.X:return this.x;case Wt.Y:return this.y;case Wt.Z:return this.z}throw new Po("Invalid ordinate index: "+e)};Wt.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||Ai.isNaN(this.z))&&Ai.isNaN(e.z)};Wt.prototype.equals=function(e){return e instanceof Wt?this.equals2D(e):!1};Wt.prototype.equalInZ=function(e,n){return q1.equalsWithTolerance(this.z,e.z,n)};Wt.prototype.compareTo=function(e){var n=e;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};Wt.prototype.clone=function(){};Wt.prototype.copy=function(){return new Wt(this)};Wt.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};Wt.prototype.distance3D=function(e){var n=this.x-e.x,r=this.y-e.y,s=this.z-e.z;return Math.sqrt(n*n+r*r+s*s)};Wt.prototype.distance=function(e){var n=this.x-e.x,r=this.y-e.y;return Math.sqrt(n*n+r*r)};Wt.prototype.hashCode=function(){var e=17;return e=37*e+Wt.hashCode(this.x),e=37*e+Wt.hashCode(this.y),e};Wt.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z};Wt.prototype.interfaces_=function(){return[Eh,bM,Sh]};Wt.prototype.getClass=function(){return Wt};Wt.hashCode=function(){if(arguments.length===1){var e=arguments[0],n=Ai.doubleToLongBits(e);return Math.trunc((n^n)>>>32)}};uv.DimensionalComparator.get=function(){return Og};uv.serialVersionUID.get=function(){return 6683108902428367e3};uv.NULL_ORDINATE.get=function(){return Ai.NaN};uv.X.get=function(){return 0};uv.Y.get=function(){return 1};uv.Z.get=function(){return 2};Object.defineProperties(Wt,uv);var Og=function(e){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new Po("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Og.prototype.compare=function(e,n){var r=e,s=n,u=Og.compare(r.x,s.x);if(u!==0)return u;var p=Og.compare(r.y,s.y);if(p!==0)return p;if(this._dimensionsToTest<=2)return 0;var g=Og.compare(r.z,s.z);return g};Og.prototype.interfaces_=function(){return[yb]};Og.prototype.getClass=function(){return Og};Og.compare=function(e,n){return e<n?-1:e>n?1:Ai.isNaN(e)?Ai.isNaN(n)?0:-1:Ai.isNaN(n)?1:0};var _b=function(){};_b.prototype.create=function(){};_b.prototype.interfaces_=function(){return[]};_b.prototype.getClass=function(){return _b};var tn=function(){},k9={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};tn.prototype.interfaces_=function(){return[]};tn.prototype.getClass=function(){return tn};tn.toLocationSymbol=function(e){switch(e){case tn.EXTERIOR:return"e";case tn.BOUNDARY:return"b";case tn.INTERIOR:return"i";case tn.NONE:return"-"}throw new Po("Unknown location value: "+e)};k9.INTERIOR.get=function(){return 0};k9.BOUNDARY.get=function(){return 1};k9.EXTERIOR.get=function(){return 2};k9.NONE.get=function(){return-1};Object.defineProperties(tn,k9);var _i=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},Ic=function(){},rG={LOG_10:{configurable:!0}};Ic.prototype.interfaces_=function(){return[]};Ic.prototype.getClass=function(){return Ic};Ic.log10=function(e){var n=Math.log(e);return Ai.isInfinite(n)||Ai.isNaN(n)?n:n/Ic.LOG_10};Ic.min=function(e,n,r,s){var u=e;return n<u&&(u=n),r<u&&(u=r),s<u&&(u=s),u};Ic.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1],r=arguments[2];return e<n?n:e>r?r:e}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],u=arguments[1],p=arguments[2];return s<u?u:s>p?p:s}};Ic.wrap=function(e,n){return e<0?n- -e%n:e%n};Ic.max=function(){if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2],s=e;return n>s&&(s=n),r>s&&(s=r),s}else if(arguments.length===4){var u=arguments[0],p=arguments[1],g=arguments[2],l=arguments[3],E=u;return p>E&&(E=p),g>E&&(E=g),l>E&&(E=l),E}};Ic.average=function(e,n){return(e+n)/2};rG.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(Ic,rG);var pf=function(e){this.str=e};pf.prototype.append=function(e){this.str+=e};pf.prototype.setCharAt=function(e,n){this.str=this.str.substr(0,e)+n+this.str.substr(e+1)};pf.prototype.toString=function(e){return this.str};var tf=function(e){this.value=e};tf.prototype.intValue=function(){return this.value};tf.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0};tf.isNaN=function(e){return Number.isNaN(e)};var G5=function(){};G5.isWhitespace=function(e){return e<=32&&e>=0||e===127};G5.toUpperCase=function(e){return e.toUpperCase()};var gn=function t(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];t.call(this,t.parse(r))}}else if(arguments.length===2){var s=arguments[0],u=arguments[1];this.init(s,u)}},yd={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};gn.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo};gn.prototype.extractSignificantDigits=function(e,n){var r=this.abs(),s=gn.magnitude(r._hi),u=gn.TEN.pow(s);r=r.divide(u),r.gt(gn.TEN)?(r=r.divide(gn.TEN),s+=1):r.lt(gn.ONE)&&(r=r.multiply(gn.TEN),s-=1);for(var p=s+1,g=new pf,l=gn.MAX_PRINT_DIGITS-1,E=0;E<=l;E++){e&&E===p&&g.append(".");var P=Math.trunc(r._hi);if(P<0)break;var O=!1,j=0;P>9?(O=!0,j="9"):j="0"+P,g.append(j),r=r.subtract(gn.valueOf(P)).multiply(gn.TEN),O&&r.selfAdd(gn.TEN);var $=!0,Y=gn.magnitude(r._hi);if(Y<0&&Math.abs(Y)>=l-E&&($=!1),!$)break}return n[0]=s,g.toString()};gn.prototype.sqr=function(){return this.multiply(this)};gn.prototype.doubleValue=function(){return this._hi+this._lo};gn.prototype.subtract=function(){if(arguments[0]instanceof gn){var e=arguments[0];return this.add(e.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};gn.prototype.equals=function(){if(arguments.length===1){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}};gn.prototype.isZero=function(){return this._hi===0&&this._lo===0};gn.prototype.selfSubtract=function(){if(arguments[0]instanceof gn){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};gn.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};gn.prototype.min=function(e){return this.le(e)?this:e};gn.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof gn){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1],u=null,p=null,g=null,l=null,E=null,P=null,O=null,j=null;return E=this._hi/r,P=gn.SPLIT*E,u=P-E,j=gn.SPLIT*r,u=P-u,p=E-u,g=j-r,O=E*r,g=j-g,l=r-g,j=u*g-O+u*l+p*g+p*l,P=(this._hi-O-j+this._lo-E*s)/r,j=E+P,this._hi=j,this._lo=E-j+P,this}};gn.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};gn.prototype.divide=function(){if(arguments[0]instanceof gn){var e=arguments[0],n=null,r=null,s=null,u=null,p=null,g=null,l=null,E=null;p=this._hi/e._hi,g=gn.SPLIT*p,n=g-p,E=gn.SPLIT*e._hi,n=g-n,r=p-n,s=E-e._hi,l=p*e._hi,s=E-s,u=e._hi-s,E=n*s-l+n*u+r*s+r*u,g=(this._hi-l-E+this._lo-p*e._lo)/e._hi,E=p+g;var P=E,O=p-E+g;return new gn(P,O)}else if(typeof arguments[0]=="number"){var j=arguments[0];return Ai.isNaN(j)?gn.createNaN():gn.copy(this).selfDivide(j,0)}};gn.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo};gn.prototype.pow=function(e){if(e===0)return gn.valueOf(1);var n=new gn(this),r=gn.valueOf(1),s=Math.abs(e);if(s>1)for(;s>0;)s%2===1&&r.selfMultiply(n),s/=2,s>0&&(n=n.sqr());else r=n;return e<0?r.reciprocal():r};gn.prototype.ceil=function(){if(this.isNaN())return gn.NaN;var e=Math.ceil(this._hi),n=0;return e===this._hi&&(n=Math.ceil(this._lo)),new gn(e,n)};gn.prototype.compareTo=function(e){var n=e;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};gn.prototype.rint=function(){if(this.isNaN())return this;var e=this.add(.5);return e.floor()};gn.prototype.setValue=function(){if(arguments[0]instanceof gn){var e=arguments[0];return this.init(e),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};gn.prototype.max=function(e){return this.ge(e)?this:e};gn.prototype.sqrt=function(){if(this.isZero())return gn.valueOf(0);if(this.isNegative())return gn.NaN;var e=1/Math.sqrt(this._hi),n=this._hi*e,r=gn.valueOf(n),s=this.subtract(r.sqr()),u=s._hi*(e*.5);return r.add(u)};gn.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof gn){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,s=null,u=null,p=null,g=null,l=null;return u=this._hi+n,g=u-this._hi,p=u-g,p=n-g+(this._hi-p),l=p+this._lo,r=u+l,s=l+(u-r),this._hi=r+s,this._lo=s+(r-this._hi),this}}else if(arguments.length===2){var E=arguments[0],P=arguments[1],O=null,j=null,$=null,Y=null,re=null,_e=null,J=null,H=null;re=this._hi+E,$=this._lo+P,J=re-this._hi,H=$-this._lo,_e=re-J,Y=$-H,_e=E-J+(this._hi-_e),Y=P-H+(this._lo-Y),J=_e+$,O=re+J,j=J+(re-O),J=Y+j;var te=O+J,ce=J+(O-te);return this._hi=te,this._lo=ce,this}};gn.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof gn){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1],u=null,p=null,g=null,l=null,E=null,P=null;E=gn.SPLIT*this._hi,u=E-this._hi,P=gn.SPLIT*r,u=E-u,p=this._hi-u,g=P-r,E=this._hi*r,g=P-g,l=r-g,P=u*g-E+u*l+p*g+p*l+(this._hi*s+this._lo*r);var O=E+P;u=E-O;var j=P+u;return this._hi=O,this._lo=j,this}};gn.prototype.selfSqr=function(){return this.selfMultiply(this)};gn.prototype.floor=function(){if(this.isNaN())return gn.NaN;var e=Math.floor(this._hi),n=0;return e===this._hi&&(n=Math.floor(this._lo)),new gn(e,n)};gn.prototype.negate=function(){return this.isNaN()?this:new gn(-this._hi,-this._lo)};gn.prototype.clone=function(){};gn.prototype.multiply=function(){if(arguments[0]instanceof gn){var e=arguments[0];return e.isNaN()?gn.createNaN():gn.copy(this).selfMultiply(e)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Ai.isNaN(n)?gn.createNaN():gn.copy(this).selfMultiply(n,0)}};gn.prototype.isNaN=function(){return Ai.isNaN(this._hi)};gn.prototype.intValue=function(){return Math.trunc(this._hi)};gn.prototype.toString=function(){var e=gn.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()};gn.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(e!==null)return e;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),s=n[0]+1,u=r;if(r.charAt(0)===".")u="0"+r;else if(s<0)u="0."+gn.stringOfChar("0",-s)+r;else if(r.indexOf(".")===-1){var p=s-r.length,g=gn.stringOfChar("0",p);u=r+g+".0"}return this.isNegative()?"-"+u:u};gn.prototype.reciprocal=function(){var e=null,n=null,r=null,s=null,u=null,p=null,g=null,l=null;u=1/this._hi,p=gn.SPLIT*u,e=p-u,l=gn.SPLIT*this._hi,e=p-e,n=u-e,r=l-this._hi,g=u*this._hi,r=l-r,s=this._hi-r,l=e*r-g+e*s+n*r+n*s,p=(1-g-l-u*this._lo)/this._hi;var E=u+p,P=u-E+p;return new gn(E,P)};gn.prototype.toSciNotation=function(){if(this.isZero())return gn.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),s=gn.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var u="";r.length>1&&(u=r.substring(1));var p=r.charAt(0)+"."+u;return this.isNegative()?"-"+p+s:p+s};gn.prototype.abs=function(){return this.isNaN()?gn.NaN:this.isNegative()?this.negate():new gn(this)};gn.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};gn.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo};gn.prototype.add=function(){if(arguments[0]instanceof gn){var e=arguments[0];return gn.copy(this).selfAdd(e)}else if(typeof arguments[0]=="number"){var n=arguments[0];return gn.copy(this).selfAdd(n)}};gn.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof gn){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this._hi=r,this._lo=s}};gn.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo};gn.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};gn.prototype.trunc=function(){return this.isNaN()?gn.NaN:this.isPositive()?this.floor():this.ceil()};gn.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};gn.prototype.interfaces_=function(){return[Sh,Eh,bM]};gn.prototype.getClass=function(){return gn};gn.sqr=function(e){return gn.valueOf(e).selfMultiply(e)};gn.valueOf=function(){if(typeof arguments[0]=="string"){var e=arguments[0];return gn.parse(e)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new gn(n)}};gn.sqrt=function(e){return gn.valueOf(e).sqrt()};gn.parse=function(e){for(var n=0,r=e.length;G5.isWhitespace(e.charAt(n));)n++;var s=!1;if(n<r){var u=e.charAt(n);(u==="-"||u==="+")&&(n++,u==="-"&&(s=!0))}for(var p=new gn,g=0,l=0,E=0;!(n>=r);){var P=e.charAt(n);if(n++,G5.isDigit(P)){var O=P-"0";p.selfMultiply(gn.TEN),p.selfAdd(O),g++;continue}if(P==="."){l=g;continue}if(P==="e"||P==="E"){var j=e.substring(n);try{E=tf.parseInt(j)}catch(J){throw J instanceof Error?new Error("Invalid exponent "+j+" in string "+e):J}finally{}break}throw new Error("Unexpected character '"+P+"' at position "+n+" in string "+e)}var $=p,Y=g-l-E;if(Y===0)$=p;else if(Y>0){var re=gn.TEN.pow(Y);$=p.divide(re)}else if(Y<0){var _e=gn.TEN.pow(-Y);$=p.multiply(_e)}return s?$.negate():$};gn.createNaN=function(){return new gn(Ai.NaN,Ai.NaN)};gn.copy=function(e){return new gn(e)};gn.magnitude=function(e){var n=Math.abs(e),r=Math.log(n)/Math.log(10),s=Math.trunc(Math.floor(r)),u=Math.pow(10,s);return u*10<=n&&(s+=1),s};gn.stringOfChar=function(e,n){for(var r=new pf,s=0;s<n;s++)r.append(e);return r.toString()};yd.PI.get=function(){return new gn(3.141592653589793,12246467991473532e-32)};yd.TWO_PI.get=function(){return new gn(6.283185307179586,24492935982947064e-32)};yd.PI_2.get=function(){return new gn(1.5707963267948966,6123233995736766e-32)};yd.E.get=function(){return new gn(2.718281828459045,14456468917292502e-32)};yd.NaN.get=function(){return new gn(Ai.NaN,Ai.NaN)};yd.EPS.get=function(){return 123259516440783e-46};yd.SPLIT.get=function(){return 134217729};yd.MAX_PRINT_DIGITS.get=function(){return 32};yd.TEN.get=function(){return gn.valueOf(10)};yd.ONE.get=function(){return gn.valueOf(1)};yd.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};yd.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(gn,yd);var Au=function(){},iG={DP_SAFE_EPSILON:{configurable:!0}};Au.prototype.interfaces_=function(){return[]};Au.prototype.getClass=function(){return Au};Au.orientationIndex=function(e,n,r){var s=Au.orientationIndexFilter(e,n,r);if(s<=1)return s;var u=gn.valueOf(n.x).selfAdd(-e.x),p=gn.valueOf(n.y).selfAdd(-e.y),g=gn.valueOf(r.x).selfAdd(-n.x),l=gn.valueOf(r.y).selfAdd(-n.y);return u.selfMultiply(l).selfSubtract(p.selfMultiply(g)).signum()};Au.signOfDet2x2=function(e,n,r,s){var u=e.multiply(s).selfSubtract(n.multiply(r));return u.signum()};Au.intersection=function(e,n,r,s){var u=gn.valueOf(s.y).selfSubtract(r.y).selfMultiply(gn.valueOf(n.x).selfSubtract(e.x)),p=gn.valueOf(s.x).selfSubtract(r.x).selfMultiply(gn.valueOf(n.y).selfSubtract(e.y)),g=u.subtract(p),l=gn.valueOf(s.x).selfSubtract(r.x).selfMultiply(gn.valueOf(e.y).selfSubtract(r.y)),E=gn.valueOf(s.y).selfSubtract(r.y).selfMultiply(gn.valueOf(e.x).selfSubtract(r.x)),P=l.subtract(E),O=P.selfDivide(g).doubleValue(),j=gn.valueOf(e.x).selfAdd(gn.valueOf(n.x).selfSubtract(e.x).selfMultiply(O)).doubleValue(),$=gn.valueOf(n.x).selfSubtract(e.x).selfMultiply(gn.valueOf(e.y).selfSubtract(r.y)),Y=gn.valueOf(n.y).selfSubtract(e.y).selfMultiply(gn.valueOf(e.x).selfSubtract(r.x)),re=$.subtract(Y),_e=re.selfDivide(g).doubleValue(),J=gn.valueOf(r.y).selfAdd(gn.valueOf(s.y).selfSubtract(r.y).selfMultiply(_e)).doubleValue();return new Wt(j,J)};Au.orientationIndexFilter=function(e,n,r){var s=null,u=(e.x-r.x)*(n.y-r.y),p=(e.y-r.y)*(n.x-r.x),g=u-p;if(u>0){if(p<=0)return Au.signum(g);s=u+p}else if(u<0){if(p>=0)return Au.signum(g);s=-u-p}else return Au.signum(g);var l=Au.DP_SAFE_EPSILON*s;return g>=l||-g>=l?Au.signum(g):2};Au.signum=function(e){return e>0?1:e<0?-1:0};iG.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Au,iG);var gs=function(){},C9={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};C9.X.get=function(){return 0};C9.Y.get=function(){return 1};C9.Z.get=function(){return 2};C9.M.get=function(){return 3};gs.prototype.setOrdinate=function(e,n,r){};gs.prototype.size=function(){};gs.prototype.getOrdinate=function(e,n){};gs.prototype.getCoordinate=function(){};gs.prototype.getCoordinateCopy=function(e){};gs.prototype.getDimension=function(){};gs.prototype.getX=function(e){};gs.prototype.clone=function(){};gs.prototype.expandEnvelope=function(e){};gs.prototype.copy=function(){};gs.prototype.getY=function(e){};gs.prototype.toCoordinateArray=function(){};gs.prototype.interfaces_=function(){return[bM]};gs.prototype.getClass=function(){return gs};Object.defineProperties(gs,C9);var sG=function(){},o3=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(sG),Rl=function(){};Rl.arraycopy=function(e,n,r,s,u){for(var p=0,g=n;g<n+u;g++)r[s+p]=e[g],p++};Rl.getProperty=function(e){return{"line.separator":`
`}[e]};var Qh=function t(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var s=arguments[0],u=arguments[1];this.x=s.y*u.w-u.y*s.w,this.y=u.x*s.w-s.x*u.w,this.w=s.x*u.y-u.x*s.y}else if(arguments[0]instanceof Wt&&arguments[1]instanceof Wt){var p=arguments[0],g=arguments[1];this.x=p.y-g.y,this.y=g.x-p.x,this.w=p.x*g.y-g.x*p.y}}else if(arguments.length===3){var l=arguments[0],E=arguments[1],P=arguments[2];this.x=l,this.y=E,this.w=P}else if(arguments.length===4){var O=arguments[0],j=arguments[1],$=arguments[2],Y=arguments[3],re=O.y-j.y,_e=j.x-O.x,J=O.x*j.y-j.x*O.y,H=$.y-Y.y,te=Y.x-$.x,ce=$.x*Y.y-Y.x*$.y;this.x=_e*ce-te*J,this.y=H*J-re*ce,this.w=re*te-H*_e}};Qh.prototype.getY=function(){var e=this.y/this.w;if(Ai.isNaN(e)||Ai.isInfinite(e))throw new o3;return e};Qh.prototype.getX=function(){var e=this.x/this.w;if(Ai.isNaN(e)||Ai.isInfinite(e))throw new o3;return e};Qh.prototype.getCoordinate=function(){var e=new Wt;return e.x=this.getX(),e.y=this.getY(),e};Qh.prototype.interfaces_=function(){return[]};Qh.prototype.getClass=function(){return Qh};Qh.intersection=function(e,n,r,s){var u=e.y-n.y,p=n.x-e.x,g=e.x*n.y-n.x*e.y,l=r.y-s.y,E=s.x-r.x,P=r.x*s.y-s.x*r.y,O=p*P-E*g,j=l*g-u*P,$=u*E-l*p,Y=O/$,re=j/$;if(Ai.isNaN(Y)||Ai.isInfinite(Y)||Ai.isNaN(re)||Ai.isInfinite(re))throw new o3;return new Wt(Y,re)};var ni=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Wt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r.x,s.x,r.y,s.y)}else if(arguments.length===4){var u=arguments[0],p=arguments[1],g=arguments[2],l=arguments[3];this.init(u,p,g,l)}},oG={serialVersionUID:{configurable:!0}};ni.prototype.getArea=function(){return this.getWidth()*this.getHeight()};ni.prototype.equals=function(e){if(!(e instanceof ni))return!1;var n=e;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};ni.prototype.intersection=function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new ni;var n=this._minx>e._minx?this._minx:e._minx,r=this._miny>e._miny?this._miny:e._miny,s=this._maxx<e._maxx?this._maxx:e._maxx,u=this._maxy<e._maxy?this._maxy:e._maxy;return new ni(n,s,r,u)};ni.prototype.isNull=function(){return this._maxx<this._minx};ni.prototype.getMaxX=function(){return this._maxx};ni.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof Wt){var e=arguments[0];return this.covers(e.x,e.y)}else if(arguments[0]instanceof ni){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&s>=this._miny&&s<=this._maxy}};ni.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof ni){var e=arguments[0];return this.isNull()||e.isNull()?!1:!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}else if(arguments[0]instanceof Wt){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||s>this._maxy||s<this._miny)}};ni.prototype.getMinY=function(){return this._miny};ni.prototype.getMinX=function(){return this._minx};ni.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof Wt){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof ni){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=s,this._maxy=s):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),s<this._miny&&(this._miny=s),s>this._maxy&&(this._maxy=s))}};ni.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),n=this.getHeight();return e<n?e:n};ni.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};ni.prototype.compareTo=function(e){var n=e;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};ni.prototype.translate=function(e,n){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+n,this.getMaxY()+n)};ni.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};ni.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};ni.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};ni.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),n=this.getHeight();return e>n?e:n};ni.prototype.expandBy=function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};ni.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof ni){var e=arguments[0];return this.covers(e)}else if(arguments[0]instanceof Wt){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.covers(r,s)}};ni.prototype.centre=function(){return this.isNull()?null:new Wt((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};ni.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Wt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof ni){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r.x,s.x,r.y,s.y)}else if(arguments.length===4){var u=arguments[0],p=arguments[1],g=arguments[2],l=arguments[3];u<p?(this._minx=u,this._maxx=p):(this._minx=p,this._maxx=u),g<l?(this._miny=g,this._maxy=l):(this._miny=l,this._maxy=g)}};ni.prototype.getMaxY=function(){return this._maxy};ni.prototype.distance=function(e){if(this.intersects(e))return 0;var n=0;this._maxx<e._minx?n=e._minx-this._maxx:this._minx>e._maxx&&(n=this._minx-e._maxx);var r=0;return this._maxy<e._miny?r=e._miny-this._maxy:this._miny>e._maxy&&(r=this._miny-e._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};ni.prototype.hashCode=function(){var e=17;return e=37*e+Wt.hashCode(this._minx),e=37*e+Wt.hashCode(this._maxx),e=37*e+Wt.hashCode(this._miny),e=37*e+Wt.hashCode(this._maxy),e};ni.prototype.interfaces_=function(){return[Eh,Sh]};ni.prototype.getClass=function(){return ni};ni.intersects=function(){if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(e.x<n.x?e.x:n.x)&&r.x<=(e.x>n.x?e.x:n.x)&&r.y>=(e.y<n.y?e.y:n.y)&&r.y<=(e.y>n.y?e.y:n.y)}else if(arguments.length===4){var s=arguments[0],u=arguments[1],p=arguments[2],g=arguments[3],l=Math.min(p.x,g.x),E=Math.max(p.x,g.x),P=Math.min(s.x,u.x),O=Math.max(s.x,u.x);return!(P>E||O<l||(l=Math.min(p.y,g.y),E=Math.max(p.y,g.y),P=Math.min(s.y,u.y),O=Math.max(s.y,u.y),P>E)||O<l)}};oG.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(ni,oG);var Bd={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},wM=function(e){this.geometryFactory=e||new Ji};wM.prototype.read=function(e){var n,r,s;e=e.replace(/[\n\r]/g," ");var u=Bd.typeStr.exec(e);if(e.search("EMPTY")!==-1&&(u=Bd.emptyTypeStr.exec(e),u[2]=void 0),u&&(r=u[1].toLowerCase(),s=u[2],Hx[r]&&(n=Hx[r].apply(this,[s]))),n===void 0)throw new Error("Could not parse WKT "+e);return n};wM.prototype.write=function(e){return this.extractGeometry(e)};wM.prototype.extractGeometry=function(e){var n=e.getGeometryType().toLowerCase();if(!ym[n])return null;var r=n.toUpperCase(),s;return e.isEmpty()?s=r+" EMPTY":s=r+"("+ym[n].apply(this,[e])+")",s};var ym={coordinate:function(e){return e.x+" "+e.y},point:function(e){return ym.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var n=this,r=[],s=0,u=e._geometries.length;s<u;++s)r.push("("+ym.point.apply(n,[e._geometries[s]])+")");return r.join(",")},linestring:function(e){for(var n=this,r=[],s=0,u=e._points._coordinates.length;s<u;++s)r.push(ym.coordinate.apply(n,[e._points._coordinates[s]]));return r.join(",")},linearring:function(e){for(var n=this,r=[],s=0,u=e._points._coordinates.length;s<u;++s)r.push(ym.coordinate.apply(n,[e._points._coordinates[s]]));return r.join(",")},multilinestring:function(e){for(var n=this,r=[],s=0,u=e._geometries.length;s<u;++s)r.push("("+ym.linestring.apply(n,[e._geometries[s]])+")");return r.join(",")},polygon:function(e){var n=this,r=[];r.push("("+ym.linestring.apply(this,[e._shell])+")");for(var s=0,u=e._holes.length;s<u;++s)r.push("("+ym.linestring.apply(n,[e._holes[s]])+")");return r.join(",")},multipolygon:function(e){for(var n=this,r=[],s=0,u=e._geometries.length;s<u;++s)r.push("("+ym.polygon.apply(n,[e._geometries[s]])+")");return r.join(",")},geometrycollection:function(e){for(var n=this,r=[],s=0,u=e._geometries.length;s<u;++s)r.push(n.extractGeometry(e._geometries[s]));return r.join(",")}},Hx={point:function(e){if(e===void 0)return this.geometryFactory.createPoint();var n=e.trim().split(Bd.spaces);return this.geometryFactory.createPoint(new Wt(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(e){var n=this;if(e===void 0)return this.geometryFactory.createMultiPoint();for(var r,s=e.trim().split(","),u=[],p=0,g=s.length;p<g;++p)r=s[p].replace(Bd.trimParens,"$1"),u.push(Hx.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(u)},linestring:function(e){if(e===void 0)return this.geometryFactory.createLineString();for(var n=e.trim().split(","),r=[],s,u=0,p=n.length;u<p;++u)s=n[u].trim().split(Bd.spaces),r.push(new Wt(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLineString(r)},linearring:function(e){if(e===void 0)return this.geometryFactory.createLinearRing();for(var n=e.trim().split(","),r=[],s,u=0,p=n.length;u<p;++u)s=n[u].trim().split(Bd.spaces),r.push(new Wt(Number.parseFloat(s[0]),Number.parseFloat(s[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(e){var n=this;if(e===void 0)return this.geometryFactory.createMultiLineString();for(var r,s=e.trim().split(Bd.parenComma),u=[],p=0,g=s.length;p<g;++p)r=s[p].replace(Bd.trimParens,"$1"),u.push(Hx.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(u)},polygon:function(e){var n=this;if(e===void 0)return this.geometryFactory.createPolygon();for(var r,s,u,p=e.trim().split(Bd.parenComma),g,l=[],E=0,P=p.length;E<P;++E)r=p[E].replace(Bd.trimParens,"$1"),s=Hx.linestring.apply(n,[r]),u=n.geometryFactory.createLinearRing(s._points),E===0?g=u:l.push(u);return this.geometryFactory.createPolygon(g,l)},multipolygon:function(e){var n=this;if(e===void 0)return this.geometryFactory.createMultiPolygon();for(var r,s=e.trim().split(Bd.doubleParenComma),u=[],p=0,g=s.length;p<g;++p)r=s[p].replace(Bd.trimParens,"$1"),u.push(Hx.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(u)},geometrycollection:function(e){var n=this;if(e===void 0)return this.geometryFactory.createGeometryCollection();e=e.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=e.trim().split("|"),s=[],u=0,p=r.length;u<p;++u)s.push(n.read(r[u]));return this.geometryFactory.createGeometryCollection(s)}},sd=function(e){this.parser=new wM(e)};sd.prototype.write=function(e){return this.parser.write(e)};sd.toLineString=function(e,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+n.x+" "+n.y+" )"};var Nm=function(t){function e(n){t.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),AS=function(t){function e(){if(t.call(this),arguments.length===0)t.call(this);else if(arguments.length===1){var n=arguments[0];t.call(this,n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Nm),Vi=function(){};Vi.prototype.interfaces_=function(){return[]};Vi.prototype.getClass=function(){return Vi};Vi.shouldNeverReachHere=function(){if(arguments.length===0)Vi.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new AS("Should never reach here"+(e!==null?": "+e:""))}};Vi.isTrue=function(){var e,n;if(arguments.length===1)e=arguments[0],Vi.isTrue(e,null);else if(arguments.length===2&&(e=arguments[0],n=arguments[1],!e))throw n===null?new AS:new AS(n)};Vi.equals=function(){var e,n,r;if(arguments.length===2)e=arguments[0],n=arguments[1],Vi.equals(e,n,null);else if(arguments.length===3&&(e=arguments[0],n=arguments[1],r=arguments[2],!n.equals(e)))throw new AS("Expected "+e+" but encountered "+n+(r!==null?": "+r:""))};var zo=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Wt,this._intPt[1]=new Wt,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},cv={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};zo.prototype.getIndexAlongSegment=function(e,n){return this.computeIntLineIndex(),this._intLineIndex[e][n]};zo.prototype.getTopologySummary=function(){var e=new pf;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()};zo.prototype.computeIntersection=function(e,n,r,s){this._inputLines[0][0]=e,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=s,this._result=this.computeIntersect(e,n,r,s)};zo.prototype.getIntersectionNum=function(){return this._result};zo.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0],n=this.getEdgeDistance(e,0),r=this.getEdgeDistance(e,1);n>r?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}};zo.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};zo.prototype.setPrecisionModel=function(e){this._precisionModel=e};zo.prototype.isInteriorIntersection=function(){var e=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(e._intPt[r].equals2D(e._inputLines[n][0])||e._intPt[r].equals2D(e._inputLines[n][1])))return!0;return!1}};zo.prototype.getIntersection=function(e){return this._intPt[e]};zo.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};zo.prototype.hasIntersection=function(){return this._result!==zo.NO_INTERSECTION};zo.prototype.getEdgeDistance=function(e,n){var r=zo.computeEdgeDistance(this._intPt[n],this._inputLines[e][0],this._inputLines[e][1]);return r};zo.prototype.isCollinear=function(){return this._result===zo.COLLINEAR_INTERSECTION};zo.prototype.toString=function(){return sd.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+sd.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};zo.prototype.getEndpoint=function(e,n){return this._inputLines[e][n]};zo.prototype.isIntersection=function(e){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(e))return!0;return!1};zo.prototype.getIntersectionAlongSegment=function(e,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][n]]};zo.prototype.interfaces_=function(){return[]};zo.prototype.getClass=function(){return zo};zo.computeEdgeDistance=function(e,n,r){var s=Math.abs(r.x-n.x),u=Math.abs(r.y-n.y),p=-1;if(e.equals(n))p=0;else if(e.equals(r))s>u?p=s:p=u;else{var g=Math.abs(e.x-n.x),l=Math.abs(e.y-n.y);s>u?p=g:p=l,p===0&&!e.equals(n)&&(p=Math.max(g,l))}return Vi.isTrue(!(p===0&&!e.equals(n)),"Bad distance calculation"),p};zo.nonRobustComputeEdgeDistance=function(e,n,r){var s=e.x-n.x,u=e.y-n.y,p=Math.sqrt(s*s+u*u);return Vi.isTrue(!(p===0&&!e.equals(n)),"Invalid distance calculation"),p};cv.DONT_INTERSECT.get=function(){return 0};cv.DO_INTERSECT.get=function(){return 1};cv.COLLINEAR.get=function(){return 2};cv.NO_INTERSECTION.get=function(){return 0};cv.POINT_INTERSECTION.get=function(){return 1};cv.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(zo,cv);var t_=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(r){var s=new ni(this._inputLines[0][0],this._inputLines[0][1]),u=new ni(this._inputLines[1][0],this._inputLines[1][1]);return s.contains(r)&&u.contains(r)},e.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];if(this._isProper=!1,ni.intersects(s,u,r)&&kr.orientationIndex(s,u,r)===0&&kr.orientationIndex(u,s,r)===0)return this._isProper=!0,(r.equals(s)||r.equals(u))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION}else return t.prototype.computeIntersection.apply(this,arguments)},e.prototype.normalizeToMinimum=function(r,s,u,p,g){g.x=this.smallestInAbsValue(r.x,s.x,u.x,p.x),g.y=this.smallestInAbsValue(r.y,s.y,u.y,p.y),r.x-=g.x,r.y-=g.y,s.x-=g.x,s.y-=g.y,u.x-=g.x,u.y-=g.y,p.x-=g.x,p.y-=g.y},e.prototype.safeHCoordinateIntersection=function(r,s,u,p){var g=null;try{g=Qh.intersection(r,s,u,p)}catch(l){if(l instanceof o3)g=e.nearestEndpoint(r,s,u,p);else throw l}finally{}return g},e.prototype.intersection=function(r,s,u,p){var g=this.intersectionWithNormalization(r,s,u,p);return this.isInSegmentEnvelopes(g)||(g=new Wt(e.nearestEndpoint(r,s,u,p))),this._precisionModel!==null&&this._precisionModel.makePrecise(g),g},e.prototype.smallestInAbsValue=function(r,s,u,p){var g=r,l=Math.abs(g);return Math.abs(s)<l&&(g=s,l=Math.abs(s)),Math.abs(u)<l&&(g=u,l=Math.abs(u)),Math.abs(p)<l&&(g=p),g},e.prototype.checkDD=function(r,s,u,p,g){var l=Au.intersection(r,s,u,p),E=this.isInSegmentEnvelopes(l);Rl.out.println("DD in env = "+E+"  --------------------- "+l),g.distance(l)>1e-4&&Rl.out.println("Distance = "+g.distance(l))},e.prototype.intersectionWithNormalization=function(r,s,u,p){var g=new Wt(r),l=new Wt(s),E=new Wt(u),P=new Wt(p),O=new Wt;this.normalizeToEnvCentre(g,l,E,P,O);var j=this.safeHCoordinateIntersection(g,l,E,P);return j.x+=O.x,j.y+=O.y,j},e.prototype.computeCollinearIntersection=function(r,s,u,p){var g=ni.intersects(r,s,u),l=ni.intersects(r,s,p),E=ni.intersects(u,p,r),P=ni.intersects(u,p,s);return g&&l?(this._intPt[0]=u,this._intPt[1]=p,t.COLLINEAR_INTERSECTION):E&&P?(this._intPt[0]=r,this._intPt[1]=s,t.COLLINEAR_INTERSECTION):g&&E?(this._intPt[0]=u,this._intPt[1]=r,u.equals(r)&&!l&&!P?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):g&&P?(this._intPt[0]=u,this._intPt[1]=s,u.equals(s)&&!l&&!E?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):l&&E?(this._intPt[0]=p,this._intPt[1]=r,p.equals(r)&&!g&&!P?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):l&&P?(this._intPt[0]=p,this._intPt[1]=s,p.equals(s)&&!g&&!E?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(r,s,u,p,g){var l=r.x<s.x?r.x:s.x,E=r.y<s.y?r.y:s.y,P=r.x>s.x?r.x:s.x,O=r.y>s.y?r.y:s.y,j=u.x<p.x?u.x:p.x,$=u.y<p.y?u.y:p.y,Y=u.x>p.x?u.x:p.x,re=u.y>p.y?u.y:p.y,_e=l>j?l:j,J=P<Y?P:Y,H=E>$?E:$,te=O<re?O:re,ce=(_e+J)/2,Se=(H+te)/2;g.x=ce,g.y=Se,r.x-=g.x,r.y-=g.y,s.x-=g.x,s.y-=g.y,u.x-=g.x,u.y-=g.y,p.x-=g.x,p.y-=g.y},e.prototype.computeIntersect=function(r,s,u,p){if(this._isProper=!1,!ni.intersects(r,s,u,p))return t.NO_INTERSECTION;var g=kr.orientationIndex(r,s,u),l=kr.orientationIndex(r,s,p);if(g>0&&l>0||g<0&&l<0)return t.NO_INTERSECTION;var E=kr.orientationIndex(u,p,r),P=kr.orientationIndex(u,p,s);if(E>0&&P>0||E<0&&P<0)return t.NO_INTERSECTION;var O=g===0&&l===0&&E===0&&P===0;return O?this.computeCollinearIntersection(r,s,u,p):(g===0||l===0||E===0||P===0?(this._isProper=!1,r.equals2D(u)||r.equals2D(p)?this._intPt[0]=r:s.equals2D(u)||s.equals2D(p)?this._intPt[0]=s:g===0?this._intPt[0]=new Wt(u):l===0?this._intPt[0]=new Wt(p):E===0?this._intPt[0]=new Wt(r):P===0&&(this._intPt[0]=new Wt(s))):(this._isProper=!0,this._intPt[0]=this.intersection(r,s,u,p)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(r,s,u,p){var g=r,l=kr.distancePointLine(r,u,p),E=kr.distancePointLine(s,u,p);return E<l&&(l=E,g=s),E=kr.distancePointLine(u,r,s),E<l&&(l=E,g=u),E=kr.distancePointLine(p,r,s),E<l&&(l=E,g=p),g},e}(zo),$1=function(){};$1.prototype.interfaces_=function(){return[]};$1.prototype.getClass=function(){return $1};$1.orientationIndex=function(e,n,r){var s=n.x-e.x,u=n.y-e.y,p=r.x-n.x,g=r.y-n.y;return $1.signOfDet2x2(s,u,p,g)};$1.signOfDet2x2=function(e,n,r,s){var u=null,p=null,g=null;if(u=1,e===0||s===0)return n===0||r===0?0:n>0?r>0?-u:u:r>0?u:-u;if(n===0||r===0)return s>0?e>0?u:-u:e>0?-u:u;if(n>0?s>0?n<=s||(u=-u,p=e,e=r,r=p,p=n,n=s,s=p):n<=-s?(u=-u,r=-r,s=-s):(p=e,e=-r,r=p,p=n,n=-s,s=p):s>0?-n<=s?(u=-u,e=-e,n=-n):(p=-e,e=r,r=p,p=-n,n=s,s=p):n>=s?(e=-e,n=-n,r=-r,s=-s):(u=-u,p=-e,e=-r,r=p,p=-n,n=-s,s=p),e>0)if(r>0){if(!(e<=r))return u}else return u;else{if(r>0)return-u;if(e>=r)u=-u,e=-e,r=-r;else return-u}for(;;){if(g=Math.floor(r/e),r=r-g*e,s=s-g*n,s<0)return-u;if(s>n)return u;if(e>r+r){if(n<s+s)return u}else{if(n>s+s)return-u;r=e-r,s=n-s,u=-u}if(s===0)return r===0?0:-u;if(r===0||(g=Math.floor(e/r),e=e-g*r,n=n-g*s,n<0))return u;if(n>s)return-u;if(r>e+e){if(s<n+n)return-u}else{if(s>n+n)return u;e=r-e,n=s-n,u=-u}if(n===0)return e===0?0:u;if(e===0)return-u}};var Yd=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e};Yd.prototype.countSegment=function(e,n){if(e.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&n.y===this._p.y){var r=e.x,s=n.x;return r>s&&(r=n.x,s=e.x),this._p.x>=r&&this._p.x<=s&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&e.y<=this._p.y){var u=e.x-this._p.x,p=e.y-this._p.y,g=n.x-this._p.x,l=n.y-this._p.y,E=$1.signOfDet2x2(u,p,g,l);if(E===0)return this._isPointOnSegment=!0,null;l<p&&(E=-E),E>0&&this._crossingCount++}};Yd.prototype.isPointInPolygon=function(){return this.getLocation()!==tn.EXTERIOR};Yd.prototype.getLocation=function(){return this._isPointOnSegment?tn.BOUNDARY:this._crossingCount%2===1?tn.INTERIOR:tn.EXTERIOR};Yd.prototype.isOnSegment=function(){return this._isPointOnSegment};Yd.prototype.interfaces_=function(){return[]};Yd.prototype.getClass=function(){return Yd};Yd.locatePointInRing=function(){if(arguments[0]instanceof Wt&&_i(arguments[1],gs)){for(var e=arguments[0],n=arguments[1],r=new Yd(e),s=new Wt,u=new Wt,p=1;p<n.size();p++)if(n.getCoordinate(p,s),n.getCoordinate(p-1,u),r.countSegment(s,u),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof Wt&&arguments[1]instanceof Array){for(var g=arguments[0],l=arguments[1],E=new Yd(g),P=1;P<l.length;P++){var O=l[P],j=l[P-1];if(E.countSegment(O,j),E.isOnSegment())return E.getLocation()}return E.getLocation()}};var kr=function(){},hv={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};kr.prototype.interfaces_=function(){return[]};kr.prototype.getClass=function(){return kr};kr.orientationIndex=function(e,n,r){return Au.orientationIndex(e,n,r)};kr.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var n=0,r=e[0].x,s=1;s<e.length-1;s++){var u=e[s].x-r,p=e[s+1].y,g=e[s-1].y;n+=u*(g-p)}return n/2}else if(_i(arguments[0],gs)){var l=arguments[0],E=l.size();if(E<3)return 0;var P=new Wt,O=new Wt,j=new Wt;l.getCoordinate(0,O),l.getCoordinate(1,j);var $=O.x;j.x-=$;for(var Y=0,re=1;re<E-1;re++)P.y=O.y,O.x=j.x,O.y=j.y,l.getCoordinate(re+1,j),j.x-=$,Y+=O.x*(P.y-j.y);return Y/2}};kr.distanceLineLine=function(e,n,r,s){if(e.equals(n))return kr.distancePointLine(e,r,s);if(r.equals(s))return kr.distancePointLine(s,e,n);var u=!1;if(!ni.intersects(e,n,r,s))u=!0;else{var p=(n.x-e.x)*(s.y-r.y)-(n.y-e.y)*(s.x-r.x);if(p===0)u=!0;else{var g=(e.y-r.y)*(s.x-r.x)-(e.x-r.x)*(s.y-r.y),l=(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y),E=l/p,P=g/p;(P<0||P>1||E<0||E>1)&&(u=!0)}}return u?Ic.min(kr.distancePointLine(e,r,s),kr.distancePointLine(n,r,s),kr.distancePointLine(r,e,n),kr.distancePointLine(s,e,n)):0};kr.isPointInRing=function(e,n){return kr.locatePointInRing(e,n)!==tn.EXTERIOR};kr.computeLength=function(e){var n=e.size();if(n<=1)return 0;var r=0,s=new Wt;e.getCoordinate(0,s);for(var u=s.x,p=s.y,g=1;g<n;g++){e.getCoordinate(g,s);var l=s.x,E=s.y,P=l-u,O=E-p;r+=Math.sqrt(P*P+O*O),u=l,p=E}return r};kr.isCCW=function(e){var n=e.length-1;if(n<3)throw new Po("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=e[0],s=0,u=1;u<=n;u++){var p=e[u];p.y>r.y&&(r=p,s=u)}var g=s;do g=g-1,g<0&&(g=n);while(e[g].equals2D(r)&&g!==s);var l=s;do l=(l+1)%n;while(e[l].equals2D(r)&&l!==s);var E=e[g],P=e[l];if(E.equals2D(r)||P.equals2D(r)||E.equals2D(P))return!1;var O=kr.computeOrientation(E,r,P),j=!1;return O===0?j=E.x>P.x:j=O>0,j};kr.locatePointInRing=function(e,n){return Yd.locatePointInRing(e,n)};kr.distancePointLinePerpendicular=function(e,n,r){var s=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),u=((n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y))/s;return Math.abs(u)*Math.sqrt(s)};kr.computeOrientation=function(e,n,r){return kr.orientationIndex(e,n,r)};kr.distancePointLine=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];if(n.length===0)throw new Po("Line array must contain at least one vertex");for(var r=e.distance(n[0]),s=0;s<n.length-1;s++){var u=kr.distancePointLine(e,n[s],n[s+1]);u<r&&(r=u)}return r}else if(arguments.length===3){var p=arguments[0],g=arguments[1],l=arguments[2];if(g.x===l.x&&g.y===l.y)return p.distance(g);var E=(l.x-g.x)*(l.x-g.x)+(l.y-g.y)*(l.y-g.y),P=((p.x-g.x)*(l.x-g.x)+(p.y-g.y)*(l.y-g.y))/E;if(P<=0)return p.distance(g);if(P>=1)return p.distance(l);var O=((g.y-p.y)*(l.x-g.x)-(g.x-p.x)*(l.y-g.y))/E;return Math.abs(O)*Math.sqrt(E)}};kr.isOnLine=function(e,n){for(var r=new t_,s=1;s<n.length;s++){var u=n[s-1],p=n[s];if(r.computeIntersection(e,u,p),r.hasIntersection())return!0}return!1};hv.CLOCKWISE.get=function(){return-1};hv.RIGHT.get=function(){return kr.CLOCKWISE};hv.COUNTERCLOCKWISE.get=function(){return 1};hv.LEFT.get=function(){return kr.COUNTERCLOCKWISE};hv.COLLINEAR.get=function(){return 0};hv.STRAIGHT.get=function(){return kr.COLLINEAR};Object.defineProperties(kr,hv);var Dm=function(){};Dm.prototype.filter=function(e){};Dm.prototype.interfaces_=function(){return[]};Dm.prototype.getClass=function(){return Dm};var mi=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},Sp={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};mi.prototype.isGeometryCollection=function(){return this.getSortIndex()===mi.SORTINDEX_GEOMETRYCOLLECTION};mi.prototype.getFactory=function(){return this._factory};mi.prototype.getGeometryN=function(e){return this};mi.prototype.getArea=function(){return 0};mi.prototype.isRectangle=function(){return!1};mi.prototype.equals=function(){if(arguments[0]instanceof mi){var e=arguments[0];return e===null?!1:this.equalsTopo(e)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof mi))return!1;var r=n;return this.equalsExact(r)}};mi.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)};mi.prototype.geometryChanged=function(){this.apply(mi.geometryChangedFilter)};mi.prototype.geometryChangedAction=function(){this._envelope=null};mi.prototype.equalsNorm=function(e){return e===null?!1:this.norm().equalsExact(e.norm())};mi.prototype.getLength=function(){return 0};mi.prototype.getNumGeometries=function(){return 1};mi.prototype.compareTo=function(){if(arguments.length===1){var e=arguments[0],n=e;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(e)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,s)}};mi.prototype.getUserData=function(){return this._userData};mi.prototype.getSRID=function(){return this._SRID};mi.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};mi.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===mi.SORTINDEX_GEOMETRYCOLLECTION)throw new Po("This method does not support GeometryCollection arguments")};mi.prototype.equal=function(e,n,r){return r===0?e.equals(n):e.distance(n)<=r};mi.prototype.norm=function(){var e=this.copy();return e.normalize(),e};mi.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};mi.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new ni(this._envelope)};mi.prototype.setSRID=function(e){this._SRID=e};mi.prototype.setUserData=function(e){this._userData=e};mi.prototype.compare=function(e,n){for(var r=e.iterator(),s=n.iterator();r.hasNext()&&s.hasNext();){var u=r.next(),p=s.next(),g=u.compareTo(p);if(g!==0)return g}return r.hasNext()?1:s.hasNext()?-1:0};mi.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};mi.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===mi.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===mi.SORTINDEX_MULTIPOINT||this.getSortIndex()===mi.SORTINDEX_MULTILINESTRING||this.getSortIndex()===mi.SORTINDEX_MULTIPOLYGON};mi.prototype.interfaces_=function(){return[bM,Eh,Sh]};mi.prototype.getClass=function(){return mi};mi.hasNonEmptyElements=function(e){for(var n=0;n<e.length;n++)if(!e[n].isEmpty())return!0;return!1};mi.hasNullElements=function(e){for(var n=0;n<e.length;n++)if(e[n]===null)return!0;return!1};Sp.serialVersionUID.get=function(){return 8763622679187377e3};Sp.SORTINDEX_POINT.get=function(){return 0};Sp.SORTINDEX_MULTIPOINT.get=function(){return 1};Sp.SORTINDEX_LINESTRING.get=function(){return 2};Sp.SORTINDEX_LINEARRING.get=function(){return 3};Sp.SORTINDEX_MULTILINESTRING.get=function(){return 4};Sp.SORTINDEX_POLYGON.get=function(){return 5};Sp.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Sp.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Sp.geometryChangedFilter.get=function(){return VI};Object.defineProperties(mi,Sp);var VI=function(){};VI.interfaces_=function(){return[Dm]};VI.filter=function(e){e.geometryChangedAction()};var dp=function(){};dp.prototype.filter=function(e){};dp.prototype.interfaces_=function(){return[]};dp.prototype.getClass=function(){return dp};var xh=function(){},Um={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};xh.prototype.isInBoundary=function(e){};xh.prototype.interfaces_=function(){return[]};xh.prototype.getClass=function(){return xh};Um.Mod2BoundaryNodeRule.get=function(){return vb};Um.EndPointBoundaryNodeRule.get=function(){return xb};Um.MultiValentEndPointBoundaryNodeRule.get=function(){return bb};Um.MonoValentEndPointBoundaryNodeRule.get=function(){return wb};Um.MOD2_BOUNDARY_RULE.get=function(){return new vb};Um.ENDPOINT_BOUNDARY_RULE.get=function(){return new xb};Um.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new bb};Um.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new wb};Um.OGC_SFS_BOUNDARY_RULE.get=function(){return xh.MOD2_BOUNDARY_RULE};Object.defineProperties(xh,Um);var vb=function(){};vb.prototype.isInBoundary=function(e){return e%2===1};vb.prototype.interfaces_=function(){return[xh]};vb.prototype.getClass=function(){return vb};var xb=function(){};xb.prototype.isInBoundary=function(e){return e>0};xb.prototype.interfaces_=function(){return[xh]};xb.prototype.getClass=function(){return xb};var bb=function(){};bb.prototype.isInBoundary=function(e){return e>1};bb.prototype.interfaces_=function(){return[xh]};bb.prototype.getClass=function(){return bb};var wb=function(){};wb.prototype.isInBoundary=function(e){return e===1};wb.prototype.interfaces_=function(){return[xh]};wb.prototype.getClass=function(){return wb};var Ua=function(){};Ua.prototype.add=function(){};Ua.prototype.addAll=function(){};Ua.prototype.isEmpty=function(){};Ua.prototype.iterator=function(){};Ua.prototype.size=function(){};Ua.prototype.toArray=function(){};Ua.prototype.remove=function(){};function GI(t){this.message=t||""}GI.prototype=new Error;GI.prototype.name="IndexOutOfBoundsException";var a3=function(){};a3.prototype.hasNext=function(){};a3.prototype.next=function(){};a3.prototype.remove=function(){};var ed=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Ua);function l3(t){this.message=t||""}l3.prototype=new Error;l3.prototype.name="NoSuchElementException";var vr=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ua&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Ua]},e.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(r){for(var s=this,u=r.iterator();u.hasNext();)s.add(u.next());return!0},e.prototype.set=function(r,s){var u=this.array_[r];return this.array_[r]=s,u},e.prototype.iterator=function(){return new yie(this)},e.prototype.get=function(r){if(r<0||r>=this.size())throw new GI;return this.array_[r]},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var r=this,s=[],u=0,p=this.array_.length;u<p;u++)s.push(r.array_[u]);return s},e.prototype.remove=function(r){for(var s=this,u=!1,p=0,g=this.array_.length;p<g;p++)if(s.array_[p]===r){s.array_.splice(p,1),u=!0;break}return u},e}(ed),yie=function(t){function e(n){t.call(this),this.arrayList_=n,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new l3;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(a3),I9=function(t){function e(){if(t.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var s=arguments[0],u=arguments[1];this.ensureCapacity(s.length),this.add(s,u)}}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(s){return this.get(s)},e.prototype.addAll=function(){var s=this;if(arguments.length===2){for(var u=arguments[0],p=arguments[1],g=!1,l=u.iterator();l.hasNext();)s.add(l.next(),p),g=!0;return g}else return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var s=this,u=t.prototype.clone.call(this),p=0;p<this.size();p++)u.add(p,s.get(p).copy());return u},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var s=this;if(arguments.length===1){var u=arguments[0];t.prototype.add.call(this,u)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],g=arguments[1];return this.add(p,g,!0),!0}else if(arguments[0]instanceof Wt&&typeof arguments[1]=="boolean"){var l=arguments[0],E=arguments[1];if(!E&&this.size()>=1){var P=this.get(this.size()-1);if(P.equals2D(l))return null}t.prototype.add.call(this,l)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var O=arguments[0],j=arguments[1];return this.add(O,j),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var $=arguments[0],Y=arguments[1],re=arguments[2];if(re)for(var _e=0;_e<$.length;_e++)s.add($[_e],Y);else for(var J=$.length-1;J>=0;J--)s.add($[J],Y);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Wt){var H=arguments[0],te=arguments[1],ce=arguments[2];if(!ce){var Se=this.size();if(Se>0){if(H>0){var Ie=this.get(H-1);if(Ie.equals2D(te))return null}if(H<Se){var Ne=this.get(H);if(Ne.equals2D(te))return null}}}t.prototype.add.call(this,H,te)}}else if(arguments.length===4){var ut=arguments[0],mt=arguments[1],We=arguments[2],Ot=arguments[3],st=1;We>Ot&&(st=-1);for(var qe=We;qe!==Ot;qe+=st)s.add(ut[qe],mt);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new Wt(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(vr),Qi=function(){},EM={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};EM.ForwardComparator.get=function(){return H5};EM.BidirectionalComparator.get=function(){return Eb};EM.coordArrayType.get=function(){return new Array(0).fill(null)};Qi.prototype.interfaces_=function(){return[]};Qi.prototype.getClass=function(){return Qi};Qi.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))};Qi.ptNotInList=function(e,n){for(var r=0;r<e.length;r++){var s=e[r];if(Qi.indexOf(s,n)<0)return s}return null};Qi.scroll=function(e,n){var r=Qi.indexOf(n,e);if(r<0)return null;var s=new Array(e.length).fill(null);Rl.arraycopy(e,r,s,0,e.length-r),Rl.arraycopy(e,0,s,e.length-r,r),Rl.arraycopy(s,0,e,0,e.length)};Qi.equals=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];if(e===n)return!0;if(e===null||n===null||e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2];if(s===u)return!0;if(s===null||u===null||s.length!==u.length)return!1;for(var g=0;g<s.length;g++)if(p.compare(s[g],u[g])!==0)return!1;return!0}};Qi.intersection=function(e,n){for(var r=new I9,s=0;s<e.length;s++)n.intersects(e[s])&&r.add(e[s],!0);return r.toCoordinateArray()};Qi.hasRepeatedPoints=function(e){for(var n=1;n<e.length;n++)if(e[n-1].equals(e[n]))return!0;return!1};Qi.removeRepeatedPoints=function(e){if(!Qi.hasRepeatedPoints(e))return e;var n=new I9(e,!1);return n.toCoordinateArray()};Qi.reverse=function(e){for(var n=e.length-1,r=Math.trunc(n/2),s=0;s<=r;s++){var u=e[s];e[s]=e[n-s],e[n-s]=u}};Qi.removeNull=function(e){for(var n=0,r=0;r<e.length;r++)e[r]!==null&&n++;var s=new Array(n).fill(null);if(n===0)return s;for(var u=0,p=0;p<e.length;p++)e[p]!==null&&(s[u++]=e[p]);return s};Qi.copyDeep=function(){if(arguments.length===1){for(var e=arguments[0],n=new Array(e.length).fill(null),r=0;r<e.length;r++)n[r]=new Wt(e[r]);return n}else if(arguments.length===5)for(var s=arguments[0],u=arguments[1],p=arguments[2],g=arguments[3],l=arguments[4],E=0;E<l;E++)p[g+E]=new Wt(s[u+E])};Qi.isEqualReversed=function(e,n){for(var r=0;r<e.length;r++){var s=e[r],u=n[e.length-r-1];if(s.compareTo(u)!==0)return!1}return!0};Qi.envelope=function(e){for(var n=new ni,r=0;r<e.length;r++)n.expandToInclude(e[r]);return n};Qi.toCoordinateArray=function(e){return e.toArray(Qi.coordArrayType)};Qi.atLeastNCoordinatesOrNothing=function(e,n){return n.length>=e?n:[]};Qi.indexOf=function(e,n){for(var r=0;r<n.length;r++)if(e.equals(n[r]))return r;return-1};Qi.increasingDirection=function(e){for(var n=0;n<Math.trunc(e.length/2);n++){var r=e.length-1-n,s=e[n].compareTo(e[r]);if(s!==0)return s}return 1};Qi.compare=function(e,n){for(var r=0;r<e.length&&r<n.length;){var s=e[r].compareTo(n[r]);if(s!==0)return s;r++}return r<n.length?-1:r<e.length?1:0};Qi.minCoordinate=function(e){for(var n=null,r=0;r<e.length;r++)(n===null||n.compareTo(e[r])>0)&&(n=e[r]);return n};Qi.extract=function(e,n,r){n=Ic.clamp(n,0,e.length),r=Ic.clamp(r,-1,e.length);var s=r-n+1;r<0&&(s=0),n>=e.length&&(s=0),r<n&&(s=0);var u=new Array(s).fill(null);if(s===0)return u;for(var p=0,g=n;g<=r;g++)u[p++]=e[g];return u};Object.defineProperties(Qi,EM);var H5=function(){};H5.prototype.compare=function(e,n){var r=e,s=n;return Qi.compare(r,s)};H5.prototype.interfaces_=function(){return[yb]};H5.prototype.getClass=function(){return H5};var Eb=function(){};Eb.prototype.compare=function(e,n){var r=e,s=n;if(r.length<s.length)return-1;if(r.length>s.length)return 1;if(r.length===0)return 0;var u=Qi.compare(r,s),p=Qi.isEqualReversed(r,s);return p?0:u};Eb.prototype.OLDcompare=function(e,n){var r=e,s=n;if(r.length<s.length)return-1;if(r.length>s.length)return 1;if(r.length===0)return 0;for(var u=Qi.increasingDirection(r),p=Qi.increasingDirection(s),g=u>0?0:r.length-1,l=p>0?0:r.length-1,E=0;E<r.length;E++){var P=r[g].compareTo(s[l]);if(P!==0)return P;g+=u,l+=p}return 0};Eb.prototype.interfaces_=function(){return[yb]};Eb.prototype.getClass=function(){return Eb};var dv=function(){};dv.prototype.get=function(){};dv.prototype.put=function(){};dv.prototype.size=function(){};dv.prototype.values=function(){};dv.prototype.entrySet=function(){};var _ie=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(dv);function A9(t){this.message=t||""}A9.prototype=new Error;A9.prototype.name="OperationNotSupported";function SM(){}SM.prototype=new Ua;SM.prototype.contains=function(){};var HI=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Ua&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(r){for(var s=this,u=0,p=this.array_.length;u<p;u++){var g=s.array_[u];if(g===r)return!0}return!1},e.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},e.prototype.addAll=function(r){for(var s=this,u=r.iterator();u.hasNext();)s.add(u.next());return!0},e.prototype.remove=function(r){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.toArray=function(){for(var r=this,s=[],u=0,p=this.array_.length;u<p;u++)s.push(r.array_[u]);return s},e.prototype.iterator=function(){return new vie(this)},e}(SM),vie=function(t){function e(n){t.call(this),this.hashSet_=n,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new l3;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new A9},e}(a3),xm=0,iy=1;function y8(t){return t===null?xm:t.color}function oo(t){return t===null?null:t.parent}function cm(t,e){t!==null&&(t.color=e)}function M7(t){return t===null?null:t.left}function _8(t){return t===null?null:t.right}function Jl(){this.root_=null,this.size_=0}Jl.prototype=new _ie;Jl.prototype.get=function(t){for(var e=this.root_;e!==null;){var n=t.compareTo(e.key);if(n<0)e=e.left;else if(n>0)e=e.right;else return e.value}return null};Jl.prototype.put=function(t,e){if(this.root_===null)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:xm,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,s;do if(r=n,s=t.compareTo(n.key),s<0)n=n.left;else if(s>0)n=n.right;else{var u=n.value;return n.value=e,u}while(n!==null);var p={key:t,left:null,right:null,value:e,parent:r,color:xm,getValue:function(){return this.value},getKey:function(){return this.key}};return s<0?r.left=p:r.right=p,this.fixAfterInsertion(p),this.size_++,null};Jl.prototype.fixAfterInsertion=function(t){var e=this;for(t.color=iy;t!=null&&t!==this.root_&&t.parent.color===iy;)if(oo(t)===M7(oo(oo(t)))){var n=_8(oo(oo(t)));y8(n)===iy?(cm(oo(t),xm),cm(n,xm),cm(oo(oo(t)),iy),t=oo(oo(t))):(t===_8(oo(t))&&(t=oo(t),e.rotateLeft(t)),cm(oo(t),xm),cm(oo(oo(t)),iy),e.rotateRight(oo(oo(t))))}else{var r=M7(oo(oo(t)));y8(r)===iy?(cm(oo(t),xm),cm(r,xm),cm(oo(oo(t)),iy),t=oo(oo(t))):(t===M7(oo(t))&&(t=oo(t),e.rotateRight(t)),cm(oo(t),xm),cm(oo(oo(t)),iy),e.rotateLeft(oo(oo(t))))}this.root_.color=xm};Jl.prototype.values=function(){var t=new vr,e=this.getFirstEntry();if(e!==null)for(t.add(e.value);(e=Jl.successor(e))!==null;)t.add(e.value);return t};Jl.prototype.entrySet=function(){var t=new HI,e=this.getFirstEntry();if(e!==null)for(t.add(e);(e=Jl.successor(e))!==null;)t.add(e);return t};Jl.prototype.rotateLeft=function(t){if(t!=null){var e=t.right;t.right=e.left,e.left!=null&&(e.left.parent=t),e.parent=t.parent,t.parent===null?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}};Jl.prototype.rotateRight=function(t){if(t!=null){var e=t.left;t.left=e.right,e.right!=null&&(e.right.parent=t),e.parent=t.parent,t.parent===null?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}};Jl.prototype.getFirstEntry=function(){var t=this.root_;if(t!=null)for(;t.left!=null;)t=t.left;return t};Jl.successor=function(t){if(t===null)return null;if(t.right!==null){for(var e=t.right;e.left!==null;)e=e.left;return e}else{for(var n=t.parent,r=t;n!==null&&r===n.right;)r=n,n=n.parent;return n}};Jl.prototype.size=function(){return this.size_};var W5=function(){};W5.prototype.interfaces_=function(){return[]};W5.prototype.getClass=function(){return W5};function aG(){}aG.prototype=new SM;function nf(){this.array_=[],arguments[0]instanceof Ua&&this.addAll(arguments[0])}nf.prototype=new aG;nf.prototype.contains=function(t){for(var e=this,n=0,r=this.array_.length;n<r;n++){var s=e.array_[n];if(s.compareTo(t)===0)return!0}return!1};nf.prototype.add=function(t){var e=this;if(this.contains(t))return!1;for(var n=0,r=this.array_.length;n<r;n++){var s=e.array_[n];if(s.compareTo(t)===1)return e.array_.splice(n,0,t),!0}return this.array_.push(t),!0};nf.prototype.addAll=function(t){for(var e=this,n=t.iterator();n.hasNext();)e.add(n.next());return!0};nf.prototype.remove=function(t){throw new A9};nf.prototype.size=function(){return this.array_.length};nf.prototype.isEmpty=function(){return this.array_.length===0};nf.prototype.toArray=function(){for(var t=this,e=[],n=0,r=this.array_.length;n<r;n++)e.push(t.array_[n]);return e};nf.prototype.iterator=function(){return new TM(this)};var TM=function(t){this.treeSet_=t,this.position_=0};TM.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new l3;return this.treeSet_.array_[this.position_++]};TM.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};TM.prototype.remove=function(){throw new A9};var Ay=function(){};Ay.sort=function(){var e=arguments[0],n,r,s,u;if(arguments.length===1)u=function(g,l){return g.compareTo(l)},e.sort(u);else if(arguments.length===2)s=arguments[1],u=function(g,l){return s.compare(g,l)},e.sort(u);else if(arguments.length===3){r=e.slice(arguments[1],arguments[2]),r.sort();var p=e.slice(0,arguments[1]).concat(r,e.slice(arguments[2],e.length));for(e.splice(0,e.length),n=0;n<p.length;n++)e.push(p[n])}else if(arguments.length===4)for(r=e.slice(arguments[1],arguments[2]),s=arguments[3],u=function(g,l){return s.compare(g,l)},r.sort(u),p=e.slice(0,arguments[1]).concat(r,e.slice(arguments[2],e.length)),e.splice(0,e.length),n=0;n<p.length;n++)e.push(p[n])};Ay.asList=function(e){for(var n=new vr,r=0,s=e.length;r<s;r++)n.add(e[r]);return n};var ks=function(){},_d={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};_d.P.get=function(){return 0};_d.L.get=function(){return 1};_d.A.get=function(){return 2};_d.FALSE.get=function(){return-1};_d.TRUE.get=function(){return-2};_d.DONTCARE.get=function(){return-3};_d.SYM_FALSE.get=function(){return"F"};_d.SYM_TRUE.get=function(){return"T"};_d.SYM_DONTCARE.get=function(){return"*"};_d.SYM_P.get=function(){return"0"};_d.SYM_L.get=function(){return"1"};_d.SYM_A.get=function(){return"2"};ks.prototype.interfaces_=function(){return[]};ks.prototype.getClass=function(){return ks};ks.toDimensionSymbol=function(e){switch(e){case ks.FALSE:return ks.SYM_FALSE;case ks.TRUE:return ks.SYM_TRUE;case ks.DONTCARE:return ks.SYM_DONTCARE;case ks.P:return ks.SYM_P;case ks.L:return ks.SYM_L;case ks.A:return ks.SYM_A}throw new Po("Unknown dimension value: "+e)};ks.toDimensionValue=function(e){switch(G5.toUpperCase(e)){case ks.SYM_FALSE:return ks.FALSE;case ks.SYM_TRUE:return ks.TRUE;case ks.SYM_DONTCARE:return ks.DONTCARE;case ks.SYM_P:return ks.P;case ks.SYM_L:return ks.L;case ks.SYM_A:return ks.A}throw new Po("Unknown dimension symbol: "+e)};Object.defineProperties(ks,_d);var rf=function(){};rf.prototype.filter=function(e){};rf.prototype.interfaces_=function(){return[]};rf.prototype.getClass=function(){return rf};var od=function(){};od.prototype.filter=function(e,n){};od.prototype.isDone=function(){};od.prototype.isGeometryChanged=function(){};od.prototype.interfaces_=function(){return[]};od.prototype.getClass=function(){return od};var pu=function(t){function e(r,s){if(t.call(this,s),this._geometries=r||[],t.hasNullElements(this._geometries))throw new Po("geometries must not contain null elements")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var s=this,u=new ni,p=0;p<this._geometries.length;p++)u.expandToInclude(s._geometries[p].getEnvelopeInternal());return u},e.prototype.getGeometryN=function(s){return this._geometries[s]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var s=this,u=new Array(this.getNumPoints()).fill(null),p=-1,g=0;g<this._geometries.length;g++)for(var l=s._geometries[g].getCoordinates(),E=0;E<l.length;E++)p++,u[p]=l[E];return u},e.prototype.getArea=function(){for(var s=this,u=0,p=0;p<this._geometries.length;p++)u+=s._geometries[p].getArea();return u},e.prototype.equalsExact=function(){var s=this;if(arguments.length===2){var u=arguments[0],p=arguments[1];if(!this.isEquivalentClass(u))return!1;var g=u;if(this._geometries.length!==g._geometries.length)return!1;for(var l=0;l<this._geometries.length;l++)if(!s._geometries[l].equalsExact(g._geometries[l],p))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var s=this,u=0;u<this._geometries.length;u++)s._geometries[u].normalize();Ay.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var s=this,u=ks.FALSE,p=0;p<this._geometries.length;p++)u=Math.max(u,s._geometries[p].getBoundaryDimension());return u},e.prototype.getDimension=function(){for(var s=this,u=ks.FALSE,p=0;p<this._geometries.length;p++)u=Math.max(u,s._geometries[p].getDimension());return u},e.prototype.getLength=function(){for(var s=this,u=0,p=0;p<this._geometries.length;p++)u+=s._geometries[p].getLength();return u},e.prototype.getNumPoints=function(){for(var s=this,u=0,p=0;p<this._geometries.length;p++)u+=s._geometries[p].getNumPoints();return u},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var s=this,u=this._geometries.length,p=new Array(u).fill(null),g=0;g<this._geometries.length;g++)p[g]=s._geometries[g].reverse();return this.getFactory().createGeometryCollection(p)},e.prototype.compareToSameClass=function(){var s=this;if(arguments.length===1){var u=arguments[0],p=new nf(Ay.asList(this._geometries)),g=new nf(Ay.asList(u._geometries));return this.compare(p,g)}else if(arguments.length===2){for(var l=arguments[0],E=arguments[1],P=l,O=this.getNumGeometries(),j=P.getNumGeometries(),$=0;$<O&&$<j;){var Y=s.getGeometryN($),re=P.getGeometryN($),_e=Y.compareToSameClass(re,E);if(_e!==0)return _e;$++}return $<O?1:$<j?-1:0}},e.prototype.apply=function(){var s=this;if(_i(arguments[0],dp))for(var u=arguments[0],p=0;p<this._geometries.length;p++)s._geometries[p].apply(u);else if(_i(arguments[0],od)){var g=arguments[0];if(this._geometries.length===0)return null;for(var l=0;l<this._geometries.length&&(s._geometries[l].apply(g),!g.isDone());l++);g.isGeometryChanged()&&this.geometryChanged()}else if(_i(arguments[0],rf)){var E=arguments[0];E.filter(this);for(var P=0;P<this._geometries.length;P++)s._geometries[P].apply(E)}else if(_i(arguments[0],Dm)){var O=arguments[0];O.filter(this);for(var j=0;j<this._geometries.length;j++)s._geometries[j].apply(O)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Vi.shouldNeverReachHere(),null},e.prototype.clone=function(){var s=this,u=t.prototype.clone.call(this);u._geometries=new Array(this._geometries.length).fill(null);for(var p=0;p<this._geometries.length;p++)u._geometries[p]=s._geometries[p].clone();return u},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var s=this,u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=s._geometries[p].copy();return new e(u,this._factory)},e.prototype.isEmpty=function(){for(var s=this,u=0;u<this._geometries.length;u++)if(!s._geometries[u].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(e,n),e}(mi),Fy=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],u=arguments[1];return this.isEquivalentClass(s)?t.prototype.equalsExact.call(this,s,u):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?ks.FALSE:0},e.prototype.isClosed=function(){var s=this;if(this.isEmpty())return!1;for(var u=0;u<this._geometries.length;u++)if(!s._geometries[u].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var s=this,u=this._geometries.length,p=new Array(u).fill(null),g=0;g<this._geometries.length;g++)p[u-1-g]=s._geometries[g].reverse();return this.getFactory().createMultiLineString(p)},e.prototype.getBoundary=function(){return new gh(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var s=this,u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=s._geometries[p].copy();return new e(u,this._factory)},e.prototype.interfaces_=function(){return[W5]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(e,n),e}(pu),gh=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var e=arguments[0],n=xh.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=s}};gh.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(e);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};gh.prototype.getBoundary=function(){return this._geom instanceof Jo?this.boundaryLineString(this._geom):this._geom instanceof Fy?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};gh.prototype.boundaryLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(e.isClosed()){var n=this._bnRule.isInBoundary(2);return n?e.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])};gh.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};gh.prototype.computeBoundaryCoordinates=function(e){var n=this,r=new vr;this._endpointMap=new Jl;for(var s=0;s<e.getNumGeometries();s++){var u=e.getGeometryN(s);u.getNumPoints()!==0&&(n.addEndpoint(u.getCoordinateN(0)),n.addEndpoint(u.getCoordinateN(u.getNumPoints()-1)))}for(var p=this._endpointMap.entrySet().iterator();p.hasNext();){var g=p.next(),l=g.getValue(),E=l.count;n._bnRule.isInBoundary(E)&&r.add(g.getKey())}return Qi.toCoordinateArray(r)};gh.prototype.addEndpoint=function(e){var n=this._endpointMap.get(e);n===null&&(n=new LS,this._endpointMap.put(e,n)),n.count++};gh.prototype.interfaces_=function(){return[]};gh.prototype.getClass=function(){return gh};gh.getBoundary=function(){if(arguments.length===1){var e=arguments[0],n=new gh(e);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],s=arguments[1],u=new gh(r,s);return u.getBoundary()}};var LS=function(){this.count=null};LS.prototype.interfaces_=function(){return[]};LS.prototype.getClass=function(){return LS};function xie(){}function bie(){}var wie=function(){};function Eie(){}function Sie(){}function Tie(){}var yh=function(){},WI={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};yh.prototype.interfaces_=function(){return[]};yh.prototype.getClass=function(){return yh};yh.chars=function(e,n){for(var r=new Array(n).fill(null),s=0;s<n;s++)r[s]=e;return String(r)};yh.getStackTrace=function(){if(arguments.length===1){var e=arguments[0],n=new Eie,r=new xie;return e.printStackTrace(r),n.toString()}else if(arguments.length===2){var s=arguments[0],u=arguments[1],p="";new bie(yh.getStackTrace(s));for(var g=new Tie,l=0;l<u;l++)try{p+=g.readLine()+yh.NEWLINE}catch(E){if(E instanceof Sie)Vi.shouldNeverReachHere();else throw E}finally{}return p}};yh.split=function(e,n){for(var r=n.length,s=new vr,u=""+e,p=u.indexOf(n);p>=0;){var g=u.substring(0,p);s.add(g),u=u.substring(p+r),p=u.indexOf(n)}u.length>0&&s.add(u);for(var l=new Array(s.size()).fill(null),E=0;E<l.length;E++)l[E]=s.get(E);return l};yh.toString=function(){if(arguments.length===1){var e=arguments[0];return yh.SIMPLE_ORDINATE_FORMAT.format(e)}};yh.spaces=function(e){return yh.chars(" ",e)};WI.NEWLINE.get=function(){return Rl.getProperty("line.separator")};WI.SIMPLE_ORDINATE_FORMAT.get=function(){return new wie};Object.defineProperties(yh,WI);var da=function(){};da.prototype.interfaces_=function(){return[]};da.prototype.getClass=function(){return da};da.copyCoord=function(e,n,r,s){for(var u=Math.min(e.getDimension(),r.getDimension()),p=0;p<u;p++)r.setOrdinate(s,p,e.getOrdinate(n,p))};da.isRing=function(e){var n=e.size();return n===0?!0:n<=3?!1:e.getOrdinate(0,gs.X)===e.getOrdinate(n-1,gs.X)&&e.getOrdinate(0,gs.Y)===e.getOrdinate(n-1,gs.Y)};da.isEqual=function(e,n){var r=e.size(),s=n.size();if(r!==s)return!1;for(var u=Math.min(e.getDimension(),n.getDimension()),p=0;p<r;p++)for(var g=0;g<u;g++){var l=e.getOrdinate(p,g),E=n.getOrdinate(p,g);if(e.getOrdinate(p,g)!==n.getOrdinate(p,g)&&!(Ai.isNaN(l)&&Ai.isNaN(E)))return!1}return!0};da.extend=function(e,n,r){var s=e.create(r,n.getDimension()),u=n.size();if(da.copy(n,0,s,0,u),u>0)for(var p=u;p<r;p++)da.copy(n,u-1,s,p,1);return s};da.reverse=function(e){for(var n=e.size()-1,r=Math.trunc(n/2),s=0;s<=r;s++)da.swap(e,s,n-s)};da.swap=function(e,n,r){if(n===r)return null;for(var s=0;s<e.getDimension();s++){var u=e.getOrdinate(n,s);e.setOrdinate(n,s,e.getOrdinate(r,s)),e.setOrdinate(r,s,u)}};da.copy=function(e,n,r,s,u){for(var p=0;p<u;p++)da.copyCoord(e,n+p,r,s+p)};da.toString=function(){if(arguments.length===1){var e=arguments[0],n=e.size();if(n===0)return"()";var r=e.getDimension(),s=new pf;s.append("(");for(var u=0;u<n;u++){u>0&&s.append(" ");for(var p=0;p<r;p++)p>0&&s.append(","),s.append(yh.toString(e.getOrdinate(u,p)))}return s.append(")"),s.toString()}};da.ensureValidRing=function(e,n){var r=n.size();if(r===0)return n;if(r<=3)return da.createClosedRing(e,n,4);var s=n.getOrdinate(0,gs.X)===n.getOrdinate(r-1,gs.X)&&n.getOrdinate(0,gs.Y)===n.getOrdinate(r-1,gs.Y);return s?n:da.createClosedRing(e,n,r+1)};da.createClosedRing=function(e,n,r){var s=e.create(r,n.getDimension()),u=n.size();da.copy(n,0,s,0,u);for(var p=u;p<r;p++)da.copy(n,0,s,p,1);return s};var Jo=function(t){function e(r,s){t.call(this,s),this._points=null,this.init(r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new ni:this._points.expandEnvelope(new ni)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var s=this;if(arguments.length===2){var u=arguments[0],p=arguments[1];if(!this.isEquivalentClass(u))return!1;var g=u;if(this._points.size()!==g._points.size())return!1;for(var l=0;l<this._points.size();l++)if(!s.equal(s._points.getCoordinate(l),g._points.getCoordinate(l),p))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var s=this,u=0;u<Math.trunc(this._points.size()/2);u++){var p=s._points.size()-1-u;if(!s._points.getCoordinate(u).equals(s._points.getCoordinate(p)))return s._points.getCoordinate(u).compareTo(s._points.getCoordinate(p))>0&&da.reverse(s._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?ks.FALSE:0},e.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return kr.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var s=this._points.copy();da.reverse(s);var u=this.getFactory().createLineString(s);return u},e.prototype.compareToSameClass=function(){var s=this;if(arguments.length===1){for(var u=arguments[0],p=u,g=0,l=0;g<this._points.size()&&l<p._points.size();){var E=s._points.getCoordinate(g).compareTo(p._points.getCoordinate(l));if(E!==0)return E;g++,l++}return g<this._points.size()?1:l<p._points.size()?-1:0}else if(arguments.length===2){var P=arguments[0],O=arguments[1],j=P;return O.compare(this._points,j._points)}},e.prototype.apply=function(){var s=this;if(_i(arguments[0],dp))for(var u=arguments[0],p=0;p<this._points.size();p++)u.filter(s._points.getCoordinate(p));else if(_i(arguments[0],od)){var g=arguments[0];if(this._points.size()===0)return null;for(var l=0;l<this._points.size()&&(g.filter(s._points,l),!g.isDone());l++);g.isGeometryChanged()&&this.geometryChanged()}else if(_i(arguments[0],rf)){var E=arguments[0];E.filter(this)}else if(_i(arguments[0],Dm)){var P=arguments[0];P.filter(this)}},e.prototype.getBoundary=function(){return new gh(this).getBoundary()},e.prototype.isEquivalentClass=function(s){return s instanceof e},e.prototype.clone=function(){var s=t.prototype.clone.call(this);return s._points=this._points.clone(),s},e.prototype.getCoordinateN=function(s){return this._points.getCoordinate(s)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return this._points.size()===0},e.prototype.init=function(s){if(s===null&&(s=this.getFactory().getCoordinateSequenceFactory().create([])),s.size()===1)throw new Po("Invalid number of points in LineString (found "+s.size()+" - must be 0 or >= 2)");this._points=s},e.prototype.isCoordinate=function(s){for(var u=this,p=0;p<this._points.size();p++)if(u._points.getCoordinate(p).equals(s))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(s){return this.getFactory().createPoint(this._points.getCoordinate(s))},e.prototype.interfaces_=function(){return[W5]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(mi),q5=function(){};q5.prototype.interfaces_=function(){return[]};q5.prototype.getClass=function(){return q5};var ac=function(t){function e(r,s){t.call(this,s),this._coordinates=r||null,this.init(this._coordinates)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new ni;var s=new ni;return s.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),s},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],u=arguments[1];return this.isEquivalentClass(s)?this.isEmpty()&&s.isEmpty()?!0:this.isEmpty()!==s.isEmpty()?!1:this.equal(s.getCoordinate(),this.getCoordinate(),u):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return ks.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(arguments.length===1){var s=arguments[0],u=s;return this.getCoordinate().compareTo(u.getCoordinate())}else if(arguments.length===2){var p=arguments[0],g=arguments[1],l=p;return g.compare(this._coordinates,l._coordinates)}},e.prototype.apply=function(){if(_i(arguments[0],dp)){var s=arguments[0];if(this.isEmpty())return null;s.filter(this.getCoordinate())}else if(_i(arguments[0],od)){var u=arguments[0];if(this.isEmpty())return null;u.filter(this._coordinates,0),u.isGeometryChanged()&&this.geometryChanged()}else if(_i(arguments[0],rf)){var p=arguments[0];p.filter(this)}else if(_i(arguments[0],Dm)){var g=arguments[0];g.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var s=t.prototype.clone.call(this);return s._coordinates=this._coordinates.clone(),s},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return this._coordinates.size()===0},e.prototype.init=function(s){s===null&&(s=this.getFactory().getCoordinateSequenceFactory().create([])),Vi.isTrue(s.size()<=1),this._coordinates=s},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[q5]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(e,n),e}(mi),Yg=function(){};Yg.prototype.interfaces_=function(){return[]};Yg.prototype.getClass=function(){return Yg};var qa=function(t){function e(r,s,u){if(t.call(this,u),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),s===null&&(s=[]),t.hasNullElements(s))throw new Po("holes must not contain null elements");if(r.isEmpty()&&t.hasNonEmptyElements(s))throw new Po("shell is empty but holes are not");this._shell=r,this._holes=s}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){var s=this;if(this.isEmpty())return[];for(var u=new Array(this.getNumPoints()).fill(null),p=-1,g=this._shell.getCoordinates(),l=0;l<g.length;l++)p++,u[p]=g[l];for(var E=0;E<this._holes.length;E++)for(var P=s._holes[E].getCoordinates(),O=0;O<P.length;O++)p++,u[p]=P[O];return u},e.prototype.getArea=function(){var s=this,u=0;u+=Math.abs(kr.signedArea(this._shell.getCoordinateSequence()));for(var p=0;p<this._holes.length;p++)u-=Math.abs(kr.signedArea(s._holes[p].getCoordinateSequence()));return u},e.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var s=this._shell.getCoordinateSequence(),u=this.getEnvelopeInternal(),p=0;p<5;p++){var g=s.getX(p);if(!(g===u.getMinX()||g===u.getMaxX()))return!1;var l=s.getY(p);if(!(l===u.getMinY()||l===u.getMaxY()))return!1}for(var E=s.getX(0),P=s.getY(0),O=1;O<=4;O++){var j=s.getX(O),$=s.getY(O),Y=j!==E,re=$!==P;if(Y===re)return!1;E=j,P=$}return!0},e.prototype.equalsExact=function(){var s=this;if(arguments.length===2){var u=arguments[0],p=arguments[1];if(!this.isEquivalentClass(u))return!1;var g=u,l=this._shell,E=g._shell;if(!l.equalsExact(E,p)||this._holes.length!==g._holes.length)return!1;for(var P=0;P<this._holes.length;P++)if(!s._holes[P].equalsExact(g._holes[P],p))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var s=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var u=0;u<this._holes.length;u++)s.normalize(s._holes[u],!1);Ay.sort(this._holes)}else if(arguments.length===2){var p=arguments[0],g=arguments[1];if(p.isEmpty())return null;var l=new Array(p.getCoordinates().length-1).fill(null);Rl.arraycopy(p.getCoordinates(),0,l,0,l.length);var E=Qi.minCoordinate(p.getCoordinates());Qi.scroll(l,E),Rl.arraycopy(l,0,p.getCoordinates(),0,l.length),p.getCoordinates()[l.length]=l[0],kr.isCCW(p.getCoordinates())===g&&Qi.reverse(p.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var s=this,u=0;u+=this._shell.getLength();for(var p=0;p<this._holes.length;p++)u+=s._holes[p].getLength();return u},e.prototype.getNumPoints=function(){for(var s=this,u=this._shell.getNumPoints(),p=0;p<this._holes.length;p++)u+=s._holes[p].getNumPoints();return u},e.prototype.reverse=function(){var s=this,u=this.copy();u._shell=this._shell.copy().reverse(),u._holes=new Array(this._holes.length).fill(null);for(var p=0;p<this._holes.length;p++)u._holes[p]=s._holes[p].copy().reverse();return u},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var s=this;if(arguments.length===1){var u=arguments[0],p=this._shell,g=u._shell;return p.compareToSameClass(g)}else if(arguments.length===2){var l=arguments[0],E=arguments[1],P=l,O=this._shell,j=P._shell,$=O.compareToSameClass(j,E);if($!==0)return $;for(var Y=this.getNumInteriorRing(),re=P.getNumInteriorRing(),_e=0;_e<Y&&_e<re;){var J=s.getInteriorRingN(_e),H=P.getInteriorRingN(_e),te=J.compareToSameClass(H,E);if(te!==0)return te;_e++}return _e<Y?1:_e<re?-1:0}},e.prototype.apply=function(s){var u=this;if(_i(s,dp)){this._shell.apply(s);for(var p=0;p<this._holes.length;p++)u._holes[p].apply(s)}else if(_i(s,od)){if(this._shell.apply(s),!s.isDone())for(var g=0;g<this._holes.length&&(u._holes[g].apply(s),!s.isDone());g++);s.isGeometryChanged()&&this.geometryChanged()}else if(_i(s,rf))s.filter(this);else if(_i(s,Dm)){s.filter(this),this._shell.apply(s);for(var l=0;l<this._holes.length;l++)u._holes[l].apply(s)}},e.prototype.getBoundary=function(){var s=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var u=new Array(this._holes.length+1).fill(null);u[0]=this._shell;for(var p=0;p<this._holes.length;p++)u[p+1]=s._holes[p];return u.length<=1?this.getFactory().createLinearRing(u[0].getCoordinateSequence()):this.getFactory().createMultiLineString(u)},e.prototype.clone=function(){var s=this,u=t.prototype.clone.call(this);u._shell=this._shell.clone(),u._holes=new Array(this._holes.length).fill(null);for(var p=0;p<this._holes.length;p++)u._holes[p]=s._holes[p].clone();return u},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var s=this,u=this._shell.copy(),p=new Array(this._holes.length).fill(null),g=0;g<p.length;g++)p[g]=s._holes[g].copy();return new e(u,p,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(s){return this._holes[s]},e.prototype.interfaces_=function(){return[Yg]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(mi),Sb=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],u=arguments[1];return this.isEquivalentClass(s)?t.prototype.equalsExact.call(this,s,u):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(arguments.length===1){var s=arguments[0];return this._geometries[s].getCoordinate()}else return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return ks.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var s=this,u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=s._geometries[p].copy();return new e(u,this._factory)},e.prototype.interfaces_=function(){return[q5]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(e,n),e}(pu),fp=function(t){function e(r,s){r instanceof Wt&&s instanceof Ji&&(r=s.getCoordinateSequenceFactory().create(r)),t.call(this,r,s),this.validateConstruction()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return ks.FALSE},e.prototype.isClosed=function(){return this.isEmpty()?!0:t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var s=this._points.copy();da.reverse(s);var u=this.getFactory().createLinearRing(s);return u},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new Po("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new Po("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Jo),op=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return mi.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(arguments.length===2){var s=arguments[0],u=arguments[1];return this.isEquivalentClass(s)?t.prototype.equalsExact.call(this,s,u):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var s=this,u=this._geometries.length,p=new Array(u).fill(null),g=0;g<this._geometries.length;g++)p[g]=s._geometries[g].reverse();return this.getFactory().createMultiPolygon(p)},e.prototype.getBoundary=function(){var s=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var u=new vr,p=0;p<this._geometries.length;p++)for(var g=s._geometries[p],l=g.getBoundary(),E=0;E<l.getNumGeometries();E++)u.add(l.getGeometryN(E));var P=new Array(u.size()).fill(null);return this.getFactory().createMultiLineString(u.toArray(P))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var s=this,u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=s._geometries[p].copy();return new e(u,this._factory)},e.prototype.interfaces_=function(){return[Yg]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(pu),bh=function(e){this._factory=e||null,this._isUserDataCopied=!1},MM={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};bh.prototype.setCopyUserData=function(e){this._isUserDataCopied=e};bh.prototype.edit=function(e,n){if(e===null)return null;var r=this.editInternal(e,n);return this._isUserDataCopied&&r.setUserData(e.getUserData()),r};bh.prototype.editInternal=function(e,n){return this._factory===null&&(this._factory=e.getFactory()),e instanceof pu?this.editGeometryCollection(e,n):e instanceof qa?this.editPolygon(e,n):e instanceof ac?n.edit(e,this._factory):e instanceof Jo?n.edit(e,this._factory):(Vi.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)};bh.prototype.editGeometryCollection=function(e,n){for(var r=this,s=n.edit(e,this._factory),u=new vr,p=0;p<s.getNumGeometries();p++){var g=r.edit(s.getGeometryN(p),n);g===null||g.isEmpty()||u.add(g)}return s.getClass()===Sb?this._factory.createMultiPoint(u.toArray([])):s.getClass()===Fy?this._factory.createMultiLineString(u.toArray([])):s.getClass()===op?this._factory.createMultiPolygon(u.toArray([])):this._factory.createGeometryCollection(u.toArray([]))};bh.prototype.editPolygon=function(e,n){var r=this,s=n.edit(e,this._factory);if(s===null&&(s=this._factory.createPolygon(null)),s.isEmpty())return s;var u=this.edit(s.getExteriorRing(),n);if(u===null||u.isEmpty())return this._factory.createPolygon();for(var p=new vr,g=0;g<s.getNumInteriorRing();g++){var l=r.edit(s.getInteriorRingN(g),n);l===null||l.isEmpty()||p.add(l)}return this._factory.createPolygon(u,p.toArray([]))};bh.prototype.interfaces_=function(){return[]};bh.prototype.getClass=function(){return bh};bh.GeometryEditorOperation=function(){};MM.NoOpGeometryOperation.get=function(){return $5};MM.CoordinateOperation.get=function(){return X5};MM.CoordinateSequenceOperation.get=function(){return Z5};Object.defineProperties(bh,MM);var $5=function(){};$5.prototype.edit=function(e,n){return e};$5.prototype.interfaces_=function(){return[bh.GeometryEditorOperation]};$5.prototype.getClass=function(){return $5};var X5=function(){};X5.prototype.edit=function(e,n){var r=this.editCoordinates(e.getCoordinates(),e);return r===null?e:e instanceof fp?n.createLinearRing(r):e instanceof Jo?n.createLineString(r):e instanceof ac?r.length>0?n.createPoint(r[0]):n.createPoint():e};X5.prototype.interfaces_=function(){return[bh.GeometryEditorOperation]};X5.prototype.getClass=function(){return X5};var Z5=function(){};Z5.prototype.edit=function(e,n){return e instanceof fp?n.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof Jo?n.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof ac?n.createPoint(this.edit(e.getCoordinateSequence(),e)):e};Z5.prototype.interfaces_=function(){return[bh.GeometryEditorOperation]};Z5.prototype.getClass=function(){return Z5};var ca=function(){var e=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)e._coordinates[r]=new Wt}else if(_i(arguments[0],gs)){var s=arguments[0];if(s===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=s.getDimension(),this._coordinates=new Array(s.size()).fill(null);for(var u=0;u<this._coordinates.length;u++)e._coordinates[u]=s.getCoordinateCopy(u)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var p=arguments[0],g=arguments[1];this._coordinates=p,this._dimension=g,p===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var l=arguments[0],E=arguments[1];this._coordinates=new Array(l).fill(null),this._dimension=E;for(var P=0;P<l;P++)e._coordinates[P]=new Wt}}},lG={serialVersionUID:{configurable:!0}};ca.prototype.setOrdinate=function(e,n,r){switch(n){case gs.X:this._coordinates[e].x=r;break;case gs.Y:this._coordinates[e].y=r;break;case gs.Z:this._coordinates[e].z=r;break;default:throw new Po("invalid ordinateIndex")}};ca.prototype.size=function(){return this._coordinates.length};ca.prototype.getOrdinate=function(e,n){switch(n){case gs.X:return this._coordinates[e].x;case gs.Y:return this._coordinates[e].y;case gs.Z:return this._coordinates[e].z}return Ai.NaN};ca.prototype.getCoordinate=function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};ca.prototype.getCoordinateCopy=function(e){return new Wt(this._coordinates[e])};ca.prototype.getDimension=function(){return this._dimension};ca.prototype.getX=function(e){return this._coordinates[e].x};ca.prototype.clone=function(){for(var e=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=e._coordinates[r].clone();return new ca(n,this._dimension)};ca.prototype.expandEnvelope=function(e){for(var n=this,r=0;r<this._coordinates.length;r++)e.expandToInclude(n._coordinates[r]);return e};ca.prototype.copy=function(){for(var e=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=e._coordinates[r].copy();return new ca(n,this._dimension)};ca.prototype.toString=function(){var e=this;if(this._coordinates.length>0){var n=new pf(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(e._coordinates[r]);return n.append(")"),n.toString()}else return"()"};ca.prototype.getY=function(e){return this._coordinates[e].y};ca.prototype.toCoordinateArray=function(){return this._coordinates};ca.prototype.interfaces_=function(){return[gs,Sh]};ca.prototype.getClass=function(){return ca};lG.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(ca,lG);var pp=function(){},qI={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};pp.prototype.readResolve=function(){return pp.instance()};pp.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new ca(e)}else if(_i(arguments[0],gs)){var n=arguments[0];return new ca(n)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];return s>3&&(s=3),s<2?new ca(r):new ca(r,s)}};pp.prototype.interfaces_=function(){return[_b,Sh]};pp.prototype.getClass=function(){return pp};pp.instance=function(){return pp.instanceObject};qI.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};qI.instanceObject.get=function(){return new pp};Object.defineProperties(pp,qI);var uG=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(r){return this.map_.get(r)||null},e.prototype.put=function(r,s){return this.map_.set(r,s),s},e.prototype.values=function(){for(var r=new vr,s=this.map_.values(),u=s.next();!u.done;)r.add(u.value),u=s.next();return r},e.prototype.entrySet=function(){var r=new HI;return this.map_.entries().forEach(function(s){return r.add(s)}),r},e.prototype.size=function(){return this.map_.size()},e}(dv),Is=function t(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=t.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof sf){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},$I={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Is.prototype.equals=function(e){if(!(e instanceof Is))return!1;var n=e;return this._modelType===n._modelType&&this._scale===n._scale};Is.prototype.compareTo=function(e){var n=e,r=this.getMaximumSignificantDigits(),s=n.getMaximumSignificantDigits();return new tf(r).compareTo(new tf(s))};Is.prototype.getScale=function(){return this._scale};Is.prototype.isFloating=function(){return this._modelType===Is.FLOATING||this._modelType===Is.FLOATING_SINGLE};Is.prototype.getType=function(){return this._modelType};Is.prototype.toString=function(){var e="UNKNOWN";return this._modelType===Is.FLOATING?e="Floating":this._modelType===Is.FLOATING_SINGLE?e="Floating-Single":this._modelType===Is.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e};Is.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var e=arguments[0];if(Ai.isNaN(e))return e;if(this._modelType===Is.FLOATING_SINGLE){var n=e;return n}return this._modelType===Is.FIXED?Math.round(e*this._scale)/this._scale:e}else if(arguments[0]instanceof Wt){var r=arguments[0];if(this._modelType===Is.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};Is.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===Is.FLOATING?e=16:this._modelType===Is.FLOATING_SINGLE?e=6:this._modelType===Is.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e};Is.prototype.setScale=function(e){this._scale=Math.abs(e)};Is.prototype.interfaces_=function(){return[Sh,Eh]};Is.prototype.getClass=function(){return Is};Is.mostPrecise=function(e,n){return e.compareTo(n)>=0?e:n};$I.serialVersionUID.get=function(){return 7777263578777804e3};$I.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Is,$I);var sf=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},XI={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};sf.prototype.readResolve=function(){return sf.nameToTypeMap.get(this._name)};sf.prototype.toString=function(){return this._name};sf.prototype.interfaces_=function(){return[Sh]};sf.prototype.getClass=function(){return sf};XI.serialVersionUID.get=function(){return-552860263173159e4};XI.nameToTypeMap.get=function(){return new uG};Object.defineProperties(sf,XI);Is.Type=sf;Is.FIXED=new sf("FIXED");Is.FLOATING=new sf("FLOATING");Is.FLOATING_SINGLE=new sf("FLOATING SINGLE");var Ji=function t(){this._precisionModel=new Is,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?_i(arguments[0],_b)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Is&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},cG={serialVersionUID:{configurable:!0}};Ji.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new Wt(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new Wt(e.getMinX(),e.getMinY()),new Wt(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new Wt(e.getMinX(),e.getMinY()),new Wt(e.getMinX(),e.getMaxY()),new Wt(e.getMaxX(),e.getMaxY()),new Wt(e.getMaxX(),e.getMinY()),new Wt(e.getMinX(),e.getMinY())]),null)};Ji.prototype.createLineString=function(e){if(e){if(e instanceof Array)return new Jo(this.getCoordinateSequenceFactory().create(e),this);if(_i(e,gs))return new Jo(e,this)}else return new Jo(this.getCoordinateSequenceFactory().create([]),this)};Ji.prototype.createMultiLineString=function(){if(arguments.length===0)return new Fy(null,this);if(arguments.length===1){var e=arguments[0];return new Fy(e,this)}};Ji.prototype.buildGeometry=function(e){for(var n=null,r=!1,s=!1,u=e.iterator();u.hasNext();){var p=u.next(),g=p.getClass();n===null&&(n=g),g!==n&&(r=!0),p.isGeometryCollectionOrDerived()&&(s=!0)}if(n===null)return this.createGeometryCollection();if(r||s)return this.createGeometryCollection(Ji.toGeometryArray(e));var l=e.iterator().next(),E=e.size()>1;if(E){if(l instanceof qa)return this.createMultiPolygon(Ji.toPolygonArray(e));if(l instanceof Jo)return this.createMultiLineString(Ji.toLineStringArray(e));if(l instanceof ac)return this.createMultiPoint(Ji.toPointArray(e));Vi.shouldNeverReachHere("Unhandled class: "+l.getClass().getName())}return l};Ji.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)};Ji.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Wt){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}else if(_i(arguments[0],gs)){var n=arguments[0];return new ac(n,this)}}};Ji.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};Ji.prototype.createPolygon=function(){if(arguments.length===0)return new qa(null,null,this);if(arguments.length===1){if(_i(arguments[0],gs)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof fp){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var s=arguments[0],u=arguments[1];return new qa(s,u,this)}};Ji.prototype.getSRID=function(){return this._SRID};Ji.prototype.createGeometryCollection=function(){if(arguments.length===0)return new pu(null,this);if(arguments.length===1){var e=arguments[0];return new pu(e,this)}};Ji.prototype.createGeometry=function(e){var n=new bh(this);return n.edit(e,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};Ji.prototype.getPrecisionModel=function(){return this._precisionModel};Ji.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}else if(_i(arguments[0],gs)){var n=arguments[0];return new fp(n,this)}}};Ji.prototype.createMultiPolygon=function(){if(arguments.length===0)return new op(null,this);if(arguments.length===1){var e=arguments[0];return new op(e,this)}};Ji.prototype.createMultiPoint=function(){var e=this;if(arguments.length===0)return new Sb(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new Sb(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(_i(arguments[0],gs)){var s=arguments[0];if(s===null)return this.createMultiPoint(new Array(0).fill(null));for(var u=new Array(s.size()).fill(null),p=0;p<s.size();p++){var g=e.getCoordinateSequenceFactory().create(1,s.getDimension());da.copy(s,p,g,0,1),u[p]=e.createPoint(g)}return this.createMultiPoint(u)}}};Ji.prototype.interfaces_=function(){return[Sh]};Ji.prototype.getClass=function(){return Ji};Ji.toMultiPolygonArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.toGeometryArray=function(e){if(e===null)return null;var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.getDefaultCoordinateSequenceFactory=function(){return pp.instance()};Ji.toMultiLineStringArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.toLineStringArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.toMultiPointArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.toLinearRingArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.toPointArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.toPolygonArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};Ji.createPointFromInternalCoord=function(e,n){return n.getPrecisionModel().makePrecise(e),n.getFactory().createPoint(e)};cG.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(Ji,cG);var Mie=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],kM=function(e){this.geometryFactory=e||new Ji};kM.prototype.read=function(e){var n;typeof e=="string"?n=JSON.parse(e):n=e;var r=n.type;if(!Gd[r])throw new Error("Unknown GeoJSON type: "+n.type);return Mie.indexOf(r)!==-1?Gd[r].apply(this,[n.coordinates]):r==="GeometryCollection"?Gd[r].apply(this,[n.geometries]):Gd[r].apply(this,[n])};kM.prototype.write=function(e){var n=e.getGeometryType();if(!_m[n])throw new Error("Geometry is not supported");return _m[n].apply(this,[e])};var Gd={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!Gd[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Gd.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e=this,n={};if(t.features){n.features=[];for(var r=0;r<t.features.length;++r)n.features.push(e.read(t.features[r]))}return t.bbox&&(n.bbox=this.parse.bbox.apply(this,[t.bbox])),n},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new Wt(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new Wt(t[0],t[1]),new Wt(t[2],t[1]),new Wt(t[2],t[3]),new Wt(t[0],t[3]),new Wt(t[0],t[1])])},Point:function(t){var e=new Wt(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=this,n=[],r=0;r<t.length;++r)n.push(Gd.Point.apply(e,[t[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(t){var e=Gd.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=this,n=[],r=0;r<t.length;++r)n.push(Gd.LineString.apply(e,[t[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(t){for(var e=this,n=Gd.coordinates.apply(this,[t[0]]),r=this.geometryFactory.createLinearRing(n),s=[],u=1;u<t.length;++u){var p=t[u],g=Gd.coordinates.apply(e,[p]),l=e.geometryFactory.createLinearRing(g);s.push(l)}return this.geometryFactory.createPolygon(r,s)},MultiPolygon:function(t){for(var e=this,n=[],r=0;r<t.length;++r){var s=t[r];n.push(Gd.Polygon.apply(e,[s]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(t){for(var e=this,n=[],r=0;r<t.length;++r){var s=t[r];n.push(e.read(s))}return this.geometryFactory.createGeometryCollection(n)}},_m={coordinate:function(t){return[t.x,t.y]},Point:function(t){var e=_m.coordinate.apply(this,[t.getCoordinate()]);return{type:"Point",coordinates:e}},MultiPoint:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],u=_m.Point.apply(e,[s]);n.push(u.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(t){for(var e=this,n=[],r=t.getCoordinates(),s=0;s<r.length;++s){var u=r[s];n.push(_m.coordinate.apply(e,[u]))}return{type:"LineString",coordinates:n}},MultiLineString:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],u=_m.LineString.apply(e,[s]);n.push(u.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(t){var e=this,n=[],r=_m.LineString.apply(this,[t._shell]);n.push(r.coordinates);for(var s=0;s<t._holes.length;++s){var u=t._holes[s],p=_m.LineString.apply(e,[u]);n.push(p.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],u=_m.Polygon.apply(e,[s]);n.push(u.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var s=t._geometries[r],u=s.getGeometryType();n.push(_m[u].apply(e,[s]))}return{type:"GeometryCollection",geometries:n}}},ZI=function(e){this.geometryFactory=e||new Ji,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new kM(this.geometryFactory)};ZI.prototype.read=function(e){var n=this.parser.read(e);return this.precisionModel.getType()===Is.FIXED&&this.reducePrecision(n),n};ZI.prototype.reducePrecision=function(e){var n=this,r,s;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(r=0,s=e.points.length;r<s;r++)n.precisionModel.makePrecise(e.points[r]);else if(e.geometries)for(r=0,s=e.geometries.length;r<s;r++)n.reducePrecision(e.geometries[r])};var hG=function(){this.parser=new kM(this.geometryFactory)};hG.prototype.write=function(e){return this.parser.write(e)};var or=function(){},CM={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};or.prototype.interfaces_=function(){return[]};or.prototype.getClass=function(){return or};or.opposite=function(e){return e===or.LEFT?or.RIGHT:e===or.RIGHT?or.LEFT:e};CM.ON.get=function(){return 0};CM.LEFT.get=function(){return 1};CM.RIGHT.get=function(){return 2};Object.defineProperties(or,CM);function IM(t){this.message=t||""}IM.prototype=new Error;IM.prototype.name="EmptyStackException";function mf(){this.array_=[]}mf.prototype=new ed;mf.prototype.add=function(t){return this.array_.push(t),!0};mf.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]};mf.prototype.push=function(t){return this.array_.push(t),t};mf.prototype.pop=function(t){if(this.array_.length===0)throw new IM;return this.array_.pop()};mf.prototype.peek=function(){if(this.array_.length===0)throw new IM;return this.array_[this.array_.length-1]};mf.prototype.empty=function(){return this.array_.length===0};mf.prototype.isEmpty=function(){return this.empty()};mf.prototype.search=function(t){return this.array_.indexOf(t)};mf.prototype.size=function(){return this.array_.length};mf.prototype.toArray=function(){for(var t=this,e=[],n=0,r=this.array_.length;n<r;n++)e.push(t.array_[n]);return e};var of=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};of.prototype.getCoordinate=function(){return this._minCoord};of.prototype.getRightmostSide=function(e,n){var r=this.getRightmostSideOfSegment(e,n);return r<0&&(r=this.getRightmostSideOfSegment(e,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),r};of.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();Vi.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var n=e[this._minIndex-1],r=e[this._minIndex+1],s=kr.computeOrientation(this._minCoord,r,n),u=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&s===kr.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&s===kr.CLOCKWISE)&&(u=!0),u&&(this._minIndex=this._minIndex-1)};of.prototype.getRightmostSideOfSegment=function(e,n){var r=e.getEdge(),s=r.getCoordinates();if(n<0||n+1>=s.length||s[n].y===s[n+1].y)return-1;var u=or.LEFT;return s[n].y<s[n+1].y&&(u=or.RIGHT),u};of.prototype.getEdge=function(){return this._orientedDe};of.prototype.checkForRightmostCoordinate=function(e){for(var n=this,r=e.getEdge().getCoordinates(),s=0;s<r.length-1;s++)(n._minCoord===null||r[s].x>n._minCoord.x)&&(n._minDe=e,n._minIndex=s,n._minCoord=r[s])};of.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode(),n=e.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};of.prototype.findEdge=function(e){for(var n=this,r=e.iterator();r.hasNext();){var s=r.next();s.isForward()&&n.checkForRightmostCoordinate(s)}Vi.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var u=this.getRightmostSide(this._minDe,this._minIndex);u===or.LEFT&&(this._orientedDe=this._minDe.getSym())};of.prototype.interfaces_=function(){return[]};of.prototype.getClass=function(){return of};var Om=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new Wt(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(r,s){return s?r:r+" [ "+s+" ]"},e}(Nm),AM=function(){this.array_=[]};AM.prototype.addLast=function(e){this.array_.push(e)};AM.prototype.removeFirst=function(){return this.array_.shift()};AM.prototype.isEmpty=function(){return this.array_.length===0};var mu=function(){this._finder=null,this._dirEdgeList=new vr,this._nodes=new vr,this._rightMostCoord=null,this._env=null,this._finder=new of};mu.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var n=e.next();n.setVisited(!1)}};mu.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};mu.prototype.computeNodeDepth=function(e){for(var n=this,r=null,s=e.getEdges().iterator();s.hasNext();){var u=s.next();if(u.isVisited()||u.getSym().isVisited()){r=u;break}}if(r===null)throw new Om("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(r);for(var p=e.getEdges().iterator();p.hasNext();){var g=p.next();g.setVisited(!0),n.copySymDepths(g)}};mu.prototype.computeDepth=function(e){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(or.RIGHT,e),this.copySymDepths(n),this.computeDepths(n)};mu.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};mu.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var n=e.next();n.getDepth(or.RIGHT)>=1&&n.getDepth(or.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};mu.prototype.computeDepths=function(e){var n=this,r=new HI,s=new AM,u=e.getNode();for(s.addLast(u),r.add(u),e.setVisited(!0);!s.isEmpty();){var p=s.removeFirst();r.add(p),n.computeNodeDepth(p);for(var g=p.getEdges().iterator();g.hasNext();){var l=g.next(),E=l.getSym();if(!E.isVisited()){var P=E.getNode();r.contains(P)||(s.addLast(P),r.add(P))}}}};mu.prototype.compareTo=function(e){var n=e;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};mu.prototype.getEnvelope=function(){if(this._env===null){for(var e=new ni,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),s=r.getEdge().getCoordinates(),u=0;u<s.length-1;u++)e.expandToInclude(s[u]);this._env=e}return this._env};mu.prototype.addReachable=function(e){var n=this,r=new mf;for(r.add(e);!r.empty();){var s=r.pop();n.add(s,r)}};mu.prototype.copySymDepths=function(e){var n=e.getSym();n.setDepth(or.LEFT,e.getDepth(or.RIGHT)),n.setDepth(or.RIGHT,e.getDepth(or.LEFT))};mu.prototype.add=function(e,n){var r=this;e.setVisited(!0),this._nodes.add(e);for(var s=e.getEdges().iterator();s.hasNext();){var u=s.next();r._dirEdgeList.add(u);var p=u.getSym(),g=p.getNode();g.isVisited()||n.push(g)}};mu.prototype.getNodes=function(){return this._nodes};mu.prototype.getDirectedEdges=function(){return this._dirEdgeList};mu.prototype.interfaces_=function(){return[Eh]};mu.prototype.getClass=function(){return mu};var lo=function t(){var e=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[or.ON]=r}else if(arguments[0]instanceof t){var s=arguments[0];if(this.init(s.location.length),s!==null)for(var u=0;u<this.location.length;u++)e.location[u]=s.location[u]}}else if(arguments.length===3){var p=arguments[0],g=arguments[1],l=arguments[2];this.init(3),this.location[or.ON]=p,this.location[or.LEFT]=g,this.location[or.RIGHT]=l}};lo.prototype.setAllLocations=function(e){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=e};lo.prototype.isNull=function(){for(var e=this,n=0;n<this.location.length;n++)if(e.location[n]!==tn.NONE)return!1;return!0};lo.prototype.setAllLocationsIfNull=function(e){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===tn.NONE&&(n.location[r]=e)};lo.prototype.isLine=function(){return this.location.length===1};lo.prototype.merge=function(e){var n=this;if(e.location.length>this.location.length){var r=new Array(3).fill(null);r[or.ON]=this.location[or.ON],r[or.LEFT]=tn.NONE,r[or.RIGHT]=tn.NONE,this.location=r}for(var s=0;s<this.location.length;s++)n.location[s]===tn.NONE&&s<e.location.length&&(n.location[s]=e.location[s])};lo.prototype.getLocations=function(){return this.location};lo.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[or.LEFT];this.location[or.LEFT]=this.location[or.RIGHT],this.location[or.RIGHT]=e};lo.prototype.toString=function(){var e=new pf;return this.location.length>1&&e.append(tn.toLocationSymbol(this.location[or.LEFT])),e.append(tn.toLocationSymbol(this.location[or.ON])),this.location.length>1&&e.append(tn.toLocationSymbol(this.location[or.RIGHT])),e.toString()};lo.prototype.setLocations=function(e,n,r){this.location[or.ON]=e,this.location[or.LEFT]=n,this.location[or.RIGHT]=r};lo.prototype.get=function(e){return e<this.location.length?this.location[e]:tn.NONE};lo.prototype.isArea=function(){return this.location.length>1};lo.prototype.isAnyNull=function(){for(var e=this,n=0;n<this.location.length;n++)if(e.location[n]===tn.NONE)return!0;return!1};lo.prototype.setLocation=function(){if(arguments.length===1){var e=arguments[0];this.setLocation(or.ON,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};lo.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(tn.NONE)};lo.prototype.isEqualOnSide=function(e,n){return this.location[n]===e.location[n]};lo.prototype.allPositionsEqual=function(e){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==e)return!1;return!0};lo.prototype.interfaces_=function(){return[]};lo.prototype.getClass=function(){return lo};var Bs=function t(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new lo(e),this.elt[1]=new lo(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new lo(n.elt[0]),this.elt[1]=new lo(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.elt[0]=new lo(tn.NONE),this.elt[1]=new lo(tn.NONE),this.elt[r].setLocation(s)}else if(arguments.length===3){var u=arguments[0],p=arguments[1],g=arguments[2];this.elt[0]=new lo(u,p,g),this.elt[1]=new lo(u,p,g)}else if(arguments.length===4){var l=arguments[0],E=arguments[1],P=arguments[2],O=arguments[3];this.elt[0]=new lo(tn.NONE,tn.NONE,tn.NONE),this.elt[1]=new lo(tn.NONE,tn.NONE,tn.NONE),this.elt[l].setLocations(E,P,O)}};Bs.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e};Bs.prototype.setAllLocations=function(e,n){this.elt[e].setAllLocations(n)};Bs.prototype.isNull=function(e){return this.elt[e].isNull()};Bs.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};Bs.prototype.isLine=function(e){return this.elt[e].isLine()};Bs.prototype.merge=function(e){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&e.elt[r]!==null?n.elt[r]=new lo(e.elt[r]):n.elt[r].merge(e.elt[r])};Bs.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};Bs.prototype.getLocation=function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(or.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};Bs.prototype.toString=function(){var e=new pf;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()};Bs.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}};Bs.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()};Bs.prototype.setLocation=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];this.elt[e].setLocation(or.ON,n)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this.elt[r].setLocation(s,u)}};Bs.prototype.isEqualOnSide=function(e,n){return this.elt[0].isEqualOnSide(e.elt[0],n)&&this.elt[1].isEqualOnSide(e.elt[1],n)};Bs.prototype.allPositionsEqual=function(e,n){return this.elt[e].allPositionsEqual(n)};Bs.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new lo(this.elt[e].location[0]))};Bs.prototype.interfaces_=function(){return[]};Bs.prototype.getClass=function(){return Bs};Bs.toLineLabel=function(e){for(var n=new Bs(tn.NONE),r=0;r<2;r++)n.setLocation(r,e.getLocation(r));return n};var Ca=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new vr,this._pts=new vr,this._label=new Bs(tn.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new vr,this._geometryFactory=null;var e=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(e),this.computeRing()};Ca.prototype.computeRing=function(){var e=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=e._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=kr.isCCW(this._ring.getCoordinates())};Ca.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};Ca.prototype.computePoints=function(e){var n=this;this._startDe=e;var r=e,s=!0;do{if(r===null)throw new Om("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new Om("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var u=r.getLabel();Vi.isTrue(u.isArea()),n.mergeLabel(u),n.addPoints(r.getEdge(),r.isForward(),s),s=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};Ca.prototype.getLinearRing=function(){return this._ring};Ca.prototype.getCoordinate=function(e){return this._pts.get(e)};Ca.prototype.computeMaxNodeDegree=function(){var e=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),s=r.getEdges().getOutgoingDegree(e);s>e._maxNodeDegree&&(e._maxNodeDegree=s),n=e.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};Ca.prototype.addPoints=function(e,n,r){var s=this,u=e.getCoordinates();if(n){var p=1;r&&(p=0);for(var g=p;g<u.length;g++)s._pts.add(u[g])}else{var l=u.length-2;r&&(l=u.length-1);for(var E=l;E>=0;E--)s._pts.add(u[E])}};Ca.prototype.isHole=function(){return this._isHole};Ca.prototype.setInResult=function(){var e=this._startDe;do e.getEdge().setInResult(!0),e=e.getNext();while(e!==this._startDe)};Ca.prototype.containsPoint=function(e){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(e)||!kr.isPointInRing(e,n.getCoordinates()))return!1;for(var s=this._holes.iterator();s.hasNext();){var u=s.next();if(u.containsPoint(e))return!1}return!0};Ca.prototype.addHole=function(e){this._holes.add(e)};Ca.prototype.isShell=function(){return this._shell===null};Ca.prototype.getLabel=function(){return this._label};Ca.prototype.getEdges=function(){return this._edges};Ca.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};Ca.prototype.getShell=function(){return this._shell};Ca.prototype.mergeLabel=function(){if(arguments.length===1){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=n.getLocation(r,or.RIGHT);if(s===tn.NONE)return null;if(this._label.getLocation(r)===tn.NONE)return this._label.setLocation(r,s),null}};Ca.prototype.setShell=function(e){this._shell=e,e!==null&&e.addHole(this)};Ca.prototype.toPolygon=function(e){for(var n=this,r=new Array(this._holes.size()).fill(null),s=0;s<this._holes.size();s++)r[s]=n._holes.get(s).getLinearRing();var u=e.createPolygon(this.getLinearRing(),r);return u};Ca.prototype.interfaces_=function(){return[]};Ca.prototype.getClass=function(){return Ca};var kie=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(r,s){r.setMinEdgeRing(s)},e.prototype.getNext=function(r){return r.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ca),Cie=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var r=this,s=new vr,u=this._startDe;do{if(u.getMinEdgeRing()===null){var p=new kie(u,r._geometryFactory);s.add(p)}u=u.getNext()}while(u!==this._startDe);return s},e.prototype.setEdgeRing=function(r,s){r.setEdgeRing(s)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,s=this._startDe;do{var u=s.getNode();u.getEdges().linkMinimalDirectedEdges(r),s=s.getNext()}while(s!==this._startDe)},e.prototype.getNext=function(r){return r.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ca),Ac=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._label=e}}};Ac.prototype.setVisited=function(e){this._isVisited=e};Ac.prototype.setInResult=function(e){this._isInResult=e};Ac.prototype.isCovered=function(){return this._isCovered};Ac.prototype.isCoveredSet=function(){return this._isCoveredSet};Ac.prototype.setLabel=function(e){this._label=e};Ac.prototype.getLabel=function(){return this._label};Ac.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0};Ac.prototype.updateIM=function(e){Vi.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)};Ac.prototype.isInResult=function(){return this._isInResult};Ac.prototype.isVisited=function(){return this._isVisited};Ac.prototype.interfaces_=function(){return[]};Ac.prototype.getClass=function(){return Ac};var LM=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new Bs(0,tn.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var s=r.next();if(s.getEdge().isInResult())return!0}return!1},e.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(r){},e.prototype.computeMergedLocation=function(r,s){var u=tn.NONE;if(u=this._label.getLocation(s),!r.isNull(s)){var p=r.getLocation(s);u!==tn.BOUNDARY&&(u=p)}return u},e.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];this._label===null?this._label=new Bs(r,s):this._label.setLocation(r,s)}else return t.prototype.setLabel.apply(this,arguments)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof e){var s=arguments[0];this.mergeLabel(s._label)}else if(arguments[0]instanceof Bs)for(var u=arguments[0],p=0;p<2;p++){var g=r.computeMergedLocation(u,p),l=r._label.getLocation(p);l===tn.NONE&&r._label.setLocation(p,g)}},e.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},e.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var s=tn.NONE;this._label!==null&&(s=this._label.getLocation(r));var u=null;switch(s){case tn.BOUNDARY:u=tn.INTERIOR;break;case tn.INTERIOR:u=tn.BOUNDARY;break;default:u=tn.BOUNDARY;break}this._label.setLocation(r,u)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ac),af=function(){this.nodeMap=new Jl,this.nodeFact=null;var e=arguments[0];this.nodeFact=e};af.prototype.find=function(e){return this.nodeMap.get(e)};af.prototype.addNode=function(){if(arguments[0]instanceof Wt){var e=arguments[0],n=this.nodeMap.get(e);return n===null&&(n=this.nodeFact.createNode(e),this.nodeMap.put(e,n)),n}else if(arguments[0]instanceof LM){var r=arguments[0],s=this.nodeMap.get(r.getCoordinate());return s===null?(this.nodeMap.put(r.getCoordinate(),r),r):(s.mergeLabel(r),s)}};af.prototype.print=function(e){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};af.prototype.iterator=function(){return this.nodeMap.values().iterator()};af.prototype.values=function(){return this.nodeMap.values()};af.prototype.getBoundaryNodes=function(e){for(var n=new vr,r=this.iterator();r.hasNext();){var s=r.next();s.getLabel().getLocation(e)===tn.BOUNDARY&&n.add(s)}return n};af.prototype.add=function(e){var n=e.getCoordinate(),r=this.addNode(n);r.add(e)};af.prototype.interfaces_=function(){return[]};af.prototype.getClass=function(){return af};var qs=function(){},L9={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};qs.prototype.interfaces_=function(){return[]};qs.prototype.getClass=function(){return qs};qs.isNorthern=function(e){return e===qs.NE||e===qs.NW};qs.isOpposite=function(e,n){if(e===n)return!1;var r=(e-n+4)%4;return r===2};qs.commonHalfPlane=function(e,n){if(e===n)return e;var r=(e-n+4)%4;if(r===2)return-1;var s=e<n?e:n,u=e>n?e:n;return s===0&&u===3?3:s};qs.isInHalfPlane=function(e,n){return n===qs.SE?e===qs.SE||e===qs.SW:e===n||e===n+1};qs.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];if(e===0&&n===0)throw new Po("Cannot compute the quadrant for point ( "+e+", "+n+" )");return e>=0?n>=0?qs.NE:qs.SE:n>=0?qs.NW:qs.SW}else if(arguments[0]instanceof Wt&&arguments[1]instanceof Wt){var r=arguments[0],s=arguments[1];if(s.x===r.x&&s.y===r.y)throw new Po("Cannot compute the quadrant for two identical points "+r);return s.x>=r.x?s.y>=r.y?qs.NE:qs.SE:s.y>=r.y?qs.NW:qs.SW}};L9.NE.get=function(){return 0};L9.NW.get=function(){return 1};L9.SW.get=function(){return 2};L9.SE.get=function(){return 3};Object.defineProperties(qs,L9);var Ql=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2],u=null;this._edge=n,this.init(r,s),this._label=u}else if(arguments.length===4){var p=arguments[0],g=arguments[1],l=arguments[2],E=arguments[3];this._edge=p,this.init(g,l),this._label=E}};Ql.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:kr.computeOrientation(e._p0,e._p1,this._p1)};Ql.prototype.getDy=function(){return this._dy};Ql.prototype.getCoordinate=function(){return this._p0};Ql.prototype.setNode=function(e){this._node=e};Ql.prototype.print=function(e){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),s=r.lastIndexOf("."),u=r.substring(s+1);e.print("  "+u+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};Ql.prototype.compareTo=function(e){var n=e;return this.compareDirection(n)};Ql.prototype.getDirectedCoordinate=function(){return this._p1};Ql.prototype.getDx=function(){return this._dx};Ql.prototype.getLabel=function(){return this._label};Ql.prototype.getEdge=function(){return this._edge};Ql.prototype.getQuadrant=function(){return this._quadrant};Ql.prototype.getNode=function(){return this._node};Ql.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),s=n.substring(r+1);return"  "+s+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label};Ql.prototype.computeLabel=function(e){};Ql.prototype.init=function(e,n){this._p0=e,this._p1=n,this._dx=n.x-e.x,this._dy=n.y-e.y,this._quadrant=qs.quadrant(this._dx,this._dy),Vi.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};Ql.prototype.interfaces_=function(){return[Eh]};Ql.prototype.getClass=function(){return Ql};var t2=function(t){function e(){var n=arguments[0],r=arguments[1];if(t.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var s=n.getNumPoints()-1;this.init(n.getCoordinate(s),n.getCoordinate(s-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(r){return this._depth[r]},e.prototype.setVisited=function(r){this._isVisited=r},e.prototype.computeDirectedLabel=function(){this._label=new Bs(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(r,s){if(this._depth[r]!==-999&&this._depth[r]!==s)throw new Om("assigned depths do not match",this.getCoordinate());this._depth[r]=s},e.prototype.isInteriorAreaEdge=function(){for(var r=this,s=!0,u=0;u<2;u++)r._label.isArea(u)&&r._label.getLocation(u,or.LEFT)===tn.INTERIOR&&r._label.getLocation(u,or.RIGHT)===tn.INTERIOR||(s=!1);return s},e.prototype.setNextMin=function(r){this._nextMin=r},e.prototype.print=function(r){t.prototype.print.call(this,r),r.print(" "+this._depth[or.LEFT]+"/"+this._depth[or.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},e.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},e.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),s=!this._label.isArea(0)||this._label.allPositionsEqual(0,tn.EXTERIOR),u=!this._label.isArea(1)||this._label.allPositionsEqual(1,tn.EXTERIOR);return r&&s&&u},e.prototype.setEdgeRing=function(r){this._edgeRing=r},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},e.prototype.setInResult=function(r){this._isInResult=r},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},e.prototype.setSym=function(r){this._sym=r},e.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},e.prototype.setEdgeDepths=function(r,s){var u=this.getEdge().getDepthDelta();this._isForward||(u=-u);var p=1;r===or.LEFT&&(p=-1);var g=or.opposite(r),l=u*p,E=s+l;this.setDepth(r,s),this.setDepth(g,E)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(r){this._next=r},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(r,s){return r===tn.EXTERIOR&&s===tn.INTERIOR?1:r===tn.INTERIOR&&s===tn.EXTERIOR?-1:0},e}(Ql),Tb=function(){};Tb.prototype.createNode=function(e){return new LM(e,null)};Tb.prototype.interfaces_=function(){return[]};Tb.prototype.getClass=function(){return Tb};var Bo=function(){if(this._edges=new vr,this._nodes=null,this._edgeEndList=new vr,arguments.length===0)this._nodes=new af(new Tb);else if(arguments.length===1){var e=arguments[0];this._nodes=new af(e)}};Bo.prototype.printEdges=function(e){var n=this;e.println("Edges:");for(var r=0;r<this._edges.size();r++){e.println("edge "+r+":");var s=n._edges.get(r);s.print(e),s.eiList.print(e)}};Bo.prototype.find=function(e){return this._nodes.find(e)};Bo.prototype.addNode=function(){if(arguments[0]instanceof LM){var e=arguments[0];return this._nodes.addNode(e)}else if(arguments[0]instanceof Wt){var n=arguments[0];return this._nodes.addNode(n)}};Bo.prototype.getNodeIterator=function(){return this._nodes.iterator()};Bo.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var n=e.next();n.getEdges().linkResultDirectedEdges()}};Bo.prototype.debugPrintln=function(e){Rl.out.println(e)};Bo.prototype.isBoundaryNode=function(e,n){var r=this._nodes.find(n);if(r===null)return!1;var s=r.getLabel();return s!==null&&s.getLocation(e)===tn.BOUNDARY};Bo.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var n=e.next();n.getEdges().linkAllDirectedEdges()}};Bo.prototype.matchInSameDirection=function(e,n,r,s){return e.equals(r)?kr.computeOrientation(e,n,s)===kr.COLLINEAR&&qs.quadrant(e,n)===qs.quadrant(r,s):!1};Bo.prototype.getEdgeEnds=function(){return this._edgeEndList};Bo.prototype.debugPrint=function(e){Rl.out.print(e)};Bo.prototype.getEdgeIterator=function(){return this._edges.iterator()};Bo.prototype.findEdgeInSameDirection=function(e,n){for(var r=this,s=0;s<this._edges.size();s++){var u=r._edges.get(s),p=u.getCoordinates();if(r.matchInSameDirection(e,n,p[0],p[1])||r.matchInSameDirection(e,n,p[p.length-1],p[p.length-2]))return u}return null};Bo.prototype.insertEdge=function(e){this._edges.add(e)};Bo.prototype.findEdgeEnd=function(e){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===e)return r}return null};Bo.prototype.addEdges=function(e){for(var n=this,r=e.iterator();r.hasNext();){var s=r.next();n._edges.add(s);var u=new t2(s,!0),p=new t2(s,!1);u.setSym(p),p.setSym(u),n.add(u),n.add(p)}};Bo.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)};Bo.prototype.getNodes=function(){return this._nodes.values()};Bo.prototype.findEdge=function(e,n){for(var r=this,s=0;s<this._edges.size();s++){var u=r._edges.get(s),p=u.getCoordinates();if(e.equals(p[0])&&n.equals(p[1]))return u}return null};Bo.prototype.interfaces_=function(){return[]};Bo.prototype.getClass=function(){return Bo};Bo.linkResultDirectedEdges=function(e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var lc=function(){this._geometryFactory=null,this._shellList=new vr;var e=arguments[0];this._geometryFactory=e};lc.prototype.sortShellsAndHoles=function(e,n,r){for(var s=e.iterator();s.hasNext();){var u=s.next();u.isHole()?r.add(u):n.add(u)}};lc.prototype.computePolygons=function(e){for(var n=this,r=new vr,s=e.iterator();s.hasNext();){var u=s.next(),p=u.toPolygon(n._geometryFactory);r.add(p)}return r};lc.prototype.placeFreeHoles=function(e,n){for(var r=this,s=n.iterator();s.hasNext();){var u=s.next();if(u.getShell()===null){var p=r.findEdgeRingContaining(u,e);if(p===null)throw new Om("unable to assign hole to a shell",u.getCoordinate(0));u.setShell(p)}}};lc.prototype.buildMinimalEdgeRings=function(e,n,r){for(var s=this,u=new vr,p=e.iterator();p.hasNext();){var g=p.next();if(g.getMaxNodeDegree()>2){g.linkDirectedEdgesForMinimalEdgeRings();var l=g.buildMinimalRings(),E=s.findShell(l);E!==null?(s.placePolygonHoles(E,l),n.add(E)):r.addAll(l)}else u.add(g)}return u};lc.prototype.containsPoint=function(e){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(e))return!0}return!1};lc.prototype.buildMaximalEdgeRings=function(e){for(var n=this,r=new vr,s=e.iterator();s.hasNext();){var u=s.next();if(u.isInResult()&&u.getLabel().isArea()&&u.getEdgeRing()===null){var p=new Cie(u,n._geometryFactory);r.add(p),p.setInResult()}}return r};lc.prototype.placePolygonHoles=function(e,n){for(var r=n.iterator();r.hasNext();){var s=r.next();s.isHole()&&s.setShell(e)}};lc.prototype.getPolygons=function(){var e=this.computePolygons(this._shellList);return e};lc.prototype.findEdgeRingContaining=function(e,n){for(var r=e.getLinearRing(),s=r.getEnvelopeInternal(),u=r.getCoordinateN(0),p=null,g=null,l=n.iterator();l.hasNext();){var E=l.next(),P=E.getLinearRing(),O=P.getEnvelopeInternal();p!==null&&(g=p.getLinearRing().getEnvelopeInternal());var j=!1;O.contains(s)&&kr.isPointInRing(u,P.getCoordinates())&&(j=!0),j&&(p===null||g.contains(O))&&(p=E)}return p};lc.prototype.findShell=function(e){for(var n=0,r=null,s=e.iterator();s.hasNext();){var u=s.next();u.isHole()||(r=u,n++)}return Vi.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};lc.prototype.add=function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];Bo.linkResultDirectedEdges(r);var s=this.buildMaximalEdgeRings(n),u=new vr,p=this.buildMinimalEdgeRings(s,this._shellList,u);this.sortShellsAndHoles(p,this._shellList,u),this.placeFreeHoles(this._shellList,u)}};lc.prototype.interfaces_=function(){return[]};lc.prototype.getClass=function(){return lc};var Mb=function(){};Mb.prototype.getBounds=function(){};Mb.prototype.interfaces_=function(){return[]};Mb.prototype.getClass=function(){return Mb};var ad=function(){this._bounds=null,this._item=null;var e=arguments[0],n=arguments[1];this._bounds=e,this._item=n};ad.prototype.getItem=function(){return this._item};ad.prototype.getBounds=function(){return this._bounds};ad.prototype.interfaces_=function(){return[Mb,Sh]};ad.prototype.getClass=function(){return ad};var Fm=function(){this._size=null,this._items=null,this._size=0,this._items=new vr,this._items.add(null)};Fm.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e};Fm.prototype.size=function(){return this._size};Fm.prototype.reorder=function(e){for(var n=this,r=null,s=this._items.get(e);e*2<=this._size&&(r=e*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(s)<0);e=r)n._items.set(e,n._items.get(r));this._items.set(e,s)};Fm.prototype.clear=function(){this._size=0,this._items.clear()};Fm.prototype.isEmpty=function(){return this._size===0};Fm.prototype.add=function(e){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,e)};Fm.prototype.interfaces_=function(){return[]};Fm.prototype.getClass=function(){return Fm};var Kg=function(){};Kg.prototype.visitItem=function(e){};Kg.prototype.interfaces_=function(){return[]};Kg.prototype.getClass=function(){return Kg};var X1=function(){};X1.prototype.insert=function(e,n){};X1.prototype.remove=function(e,n){};X1.prototype.query=function(){};X1.prototype.interfaces_=function(){return[]};X1.prototype.getClass=function(){return X1};var Ga=function(){if(this._childBoundables=new vr,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._level=e}}},dG={serialVersionUID:{configurable:!0}};Ga.prototype.getLevel=function(){return this._level};Ga.prototype.size=function(){return this._childBoundables.size()};Ga.prototype.getChildBoundables=function(){return this._childBoundables};Ga.prototype.addChildBoundable=function(e){Vi.isTrue(this._bounds===null),this._childBoundables.add(e)};Ga.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Ga.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Ga.prototype.interfaces_=function(){return[Mb,Sh]};Ga.prototype.getClass=function(){return Ga};dG.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Ga,dG);var ld=function(){};ld.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};ld.min=function(e){return ld.sort(e),e.get(0)};ld.sort=function(e,n){var r=e.toArray();n?Ay.sort(r,n):Ay.sort(r);for(var s=e.iterator(),u=0,p=r.length;u<p;u++)s.next(),s.set(r[u])};ld.singletonList=function(e){var n=new vr;return n.add(e),n};var Ma=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=e,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};Ma.prototype.expandToQueue=function(e,n){var r=Ma.isComposite(this._boundable1),s=Ma.isComposite(this._boundable2);if(r&&s)return Ma.area(this._boundable1)>Ma.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,n),null):(this.expand(this._boundable2,this._boundable1,e,n),null);if(r)return this.expand(this._boundable1,this._boundable2,e,n),null;if(s)return this.expand(this._boundable2,this._boundable1,e,n),null;throw new Po("neither boundable is composite")};Ma.prototype.isLeaves=function(){return!(Ma.isComposite(this._boundable1)||Ma.isComposite(this._boundable2))};Ma.prototype.compareTo=function(e){var n=e;return this._distance<n._distance?-1:this._distance>n._distance?1:0};Ma.prototype.expand=function(e,n,r,s){for(var u=this,p=e.getChildBoundables(),g=p.iterator();g.hasNext();){var l=g.next(),E=new Ma(l,n,u._itemDistance);E.getDistance()<s&&r.add(E)}};Ma.prototype.getBoundable=function(e){return e===0?this._boundable1:this._boundable2};Ma.prototype.getDistance=function(){return this._distance};Ma.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};Ma.prototype.interfaces_=function(){return[Eh]};Ma.prototype.getClass=function(){return Ma};Ma.area=function(e){return e.getBounds().getArea()};Ma.isComposite=function(e){return e instanceof Ga};var pl=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new vr,this._nodeCapacity=null,arguments.length===0){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(arguments.length===1){var n=arguments[0];Vi.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},PM={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};pl.prototype.getNodeCapacity=function(){return this._nodeCapacity};pl.prototype.lastNode=function(e){return e.get(e.size()-1)};pl.prototype.size=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,s=n.getChildBoundables().iterator();s.hasNext();){var u=s.next();u instanceof Ga?r+=e.size(u):u instanceof ad&&(r+=1)}return r}};pl.prototype.removeItem=function(e,n){for(var r=null,s=e.getChildBoundables().iterator();s.hasNext();){var u=s.next();u instanceof ad&&u.getItem()===n&&(r=u)}return r!==null?(e.getChildBoundables().remove(r),!0):!1};pl.prototype.itemsTree=function(){var e=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new vr:n}else if(arguments.length===1){for(var r=arguments[0],s=new vr,u=r.getChildBoundables().iterator();u.hasNext();){var p=u.next();if(p instanceof Ga){var g=e.itemsTree(p);g!==null&&s.add(g)}else p instanceof ad?s.add(p.getItem()):Vi.shouldNeverReachHere()}return s.size()<=0?null:s}};pl.prototype.insert=function(e,n){Vi.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ad(e,n))};pl.prototype.boundablesAtLevel=function(){var e=this;if(arguments.length===1){var n=arguments[0],r=new vr;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2];if(Vi.isTrue(s>-2),u.getLevel()===s)return p.add(u),null;for(var g=u.getChildBoundables().iterator();g.hasNext();){var l=g.next();l instanceof Ga?e.boundablesAtLevel(s,l,p):(Vi.isTrue(l instanceof ad),s===-1&&p.add(l))}return null}};pl.prototype.query=function(){var e=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new vr;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var s=arguments[0],u=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),s)&&this.query(s,this._root,u)}else if(arguments.length===3){if(_i(arguments[2],Kg)&&arguments[0]instanceof Object&&arguments[1]instanceof Ga)for(var p=arguments[0],g=arguments[1],l=arguments[2],E=g.getChildBoundables(),P=0;P<E.size();P++){var O=E.get(P);e.getIntersectsOp().intersects(O.getBounds(),p)&&(O instanceof Ga?e.query(p,O,l):O instanceof ad?l.visitItem(O.getItem()):Vi.shouldNeverReachHere())}else if(_i(arguments[2],ed)&&arguments[0]instanceof Object&&arguments[1]instanceof Ga)for(var j=arguments[0],$=arguments[1],Y=arguments[2],re=$.getChildBoundables(),_e=0;_e<re.size();_e++){var J=re.get(_e);e.getIntersectsOp().intersects(J.getBounds(),j)&&(J instanceof Ga?e.query(j,J,Y):J instanceof ad?Y.add(J.getItem()):Vi.shouldNeverReachHere())}}};pl.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};pl.prototype.getRoot=function(){return this.build(),this._root};pl.prototype.remove=function(){var e=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2],g=this.removeItem(u,p);if(g)return!0;for(var l=null,E=u.getChildBoundables().iterator();E.hasNext();){var P=E.next();if(e.getIntersectsOp().intersects(P.getBounds(),s)&&P instanceof Ga&&(g=e.remove(s,P,p),g)){l=P;break}}return l!==null&&l.getChildBoundables().isEmpty()&&u.getChildBoundables().remove(l),g}};pl.prototype.createHigherLevels=function(e,n){Vi.isTrue(!e.isEmpty());var r=this.createParentBoundables(e,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};pl.prototype.depth=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,s=n.getChildBoundables().iterator();s.hasNext();){var u=s.next();if(u instanceof Ga){var p=e.depth(u);p>r&&(r=p)}}return r+1}};pl.prototype.createParentBoundables=function(e,n){var r=this;Vi.isTrue(!e.isEmpty());var s=new vr;s.add(this.createNode(n));var u=new vr(e);ld.sort(u,this.getComparator());for(var p=u.iterator();p.hasNext();){var g=p.next();r.lastNode(s).getChildBoundables().size()===r.getNodeCapacity()&&s.add(r.createNode(n)),r.lastNode(s).addChildBoundable(g)}return s};pl.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};pl.prototype.interfaces_=function(){return[Sh]};pl.prototype.getClass=function(){return pl};pl.compareDoubles=function(e,n){return e>n?1:e<n?-1:0};PM.IntersectsOp.get=function(){return Iie};PM.serialVersionUID.get=function(){return-3886435814360241e3};PM.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(pl,PM);var Iie=function(){},kb=function(){};kb.prototype.distance=function(e,n){};kb.prototype.interfaces_=function(){return[]};kb.prototype.getClass=function(){return kb};var fG=function(t){function e(r){r=r||e.DEFAULT_NODE_CAPACITY,t.call(this,r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(s,u){var p=this;Vi.isTrue(s.length>0);for(var g=new vr,l=0;l<s.length;l++)g.addAll(p.createParentBoundablesFromVerticalSlice(s[l],u));return g},e.prototype.createNode=function(s){return new v8(s)},e.prototype.size=function(){return arguments.length===0?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(arguments.length===2){var s=arguments[0],u=arguments[1];if(s.isNull())return null;t.prototype.insert.call(this,s,u)}else return t.prototype.insert.apply(this,arguments)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(s,u){for(var p=Math.trunc(Math.ceil(s.size()/u)),g=new Array(u).fill(null),l=s.iterator(),E=0;E<u;E++){g[E]=new vr;for(var P=0;l.hasNext()&&P<p;){var O=l.next();g[E].add(O),P++}}return g},e.prototype.query=function(){if(arguments.length===1){var s=arguments[0];return t.prototype.query.call(this,s)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];t.prototype.query.call(this,u,p)}else if(arguments.length===3){if(_i(arguments[2],Kg)&&arguments[0]instanceof Object&&arguments[1]instanceof Ga){var g=arguments[0],l=arguments[1],E=arguments[2];t.prototype.query.call(this,g,l,E)}else if(_i(arguments[2],ed)&&arguments[0]instanceof Object&&arguments[1]instanceof Ga){var P=arguments[0],O=arguments[1],j=arguments[2];t.prototype.query.call(this,P,O,j)}}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(s,u){return t.prototype.createParentBoundables.call(this,s,u)},e.prototype.remove=function(){if(arguments.length===2){var s=arguments[0],u=arguments[1];return t.prototype.remove.call(this,s,u)}else return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return arguments.length===0?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(s,u){Vi.isTrue(!s.isEmpty());var p=Math.trunc(Math.ceil(s.size()/this.getNodeCapacity())),g=new vr(s);ld.sort(g,e.xComparator);var l=this.verticalSlices(g,Math.trunc(Math.ceil(Math.sqrt(p))));return this.createParentBoundablesFromVerticalSlices(l,u)},e.prototype.nearestNeighbour=function(){if(arguments.length===1){if(_i(arguments[0],kb)){var s=arguments[0],u=new Ma(this.getRoot(),this.getRoot(),s);return this.nearestNeighbour(u)}else if(arguments[0]instanceof Ma){var p=arguments[0];return this.nearestNeighbour(p,Ai.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof e&&_i(arguments[1],kb)){var g=arguments[0],l=arguments[1],E=new Ma(this.getRoot(),g.getRoot(),l);return this.nearestNeighbour(E)}else if(arguments[0]instanceof Ma&&typeof arguments[1]=="number"){var P=arguments[0],O=arguments[1],j=O,$=null,Y=new Fm;for(Y.add(P);!Y.isEmpty()&&j>0;){var re=Y.poll(),_e=re.getDistance();if(_e>=j)break;re.isLeaves()?(j=_e,$=re):re.expandToQueue(Y,j)}return[$.getBoundable(0).getItem(),$.getBoundable(1).getItem()]}}else if(arguments.length===3){var J=arguments[0],H=arguments[1],te=arguments[2],ce=new ad(J,H),Se=new Ma(this.getRoot(),ce,te);return this.nearestNeighbour(Se)[0]}},e.prototype.interfaces_=function(){return[X1,Sh]},e.prototype.getClass=function(){return e},e.centreX=function(s){return e.avg(s.getMinX(),s.getMaxX())},e.avg=function(s,u){return(s+u)/2},e.centreY=function(s){return e.avg(s.getMinY(),s.getMaxY())},n.STRtreeNode.get=function(){return v8},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[yb]},compare:function(r,s){return t.compareDoubles(e.centreX(r.getBounds()),e.centreX(s.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[yb]},compare:function(r,s){return t.compareDoubles(e.centreY(r.getBounds()),e.centreY(s.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(r,s){return r.intersects(s)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(pl),v8=function(t){function e(){var n=arguments[0];t.call(this,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var r=null,s=this.getChildBoundables().iterator();s.hasNext();){var u=s.next();r===null?r=new ni(u.getBounds()):r.expandToInclude(u.getBounds())}return r},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ga),ku=function(){};ku.prototype.interfaces_=function(){return[]};ku.prototype.getClass=function(){return ku};ku.relativeSign=function(e,n){return e<n?-1:e>n?1:0};ku.compare=function(e,n,r){if(n.equals2D(r))return 0;var s=ku.relativeSign(n.x,r.x),u=ku.relativeSign(n.y,r.y);switch(e){case 0:return ku.compareValue(s,u);case 1:return ku.compareValue(u,s);case 2:return ku.compareValue(u,-s);case 3:return ku.compareValue(-s,u);case 4:return ku.compareValue(-s,-u);case 5:return ku.compareValue(-u,-s);case 6:return ku.compareValue(-u,s);case 7:return ku.compareValue(s,-u)}return Vi.shouldNeverReachHere("invalid octant value"),0};ku.compareValue=function(e,n){return e<0?-1:e>0?1:n<0?-1:n>0?1:0};var Jg=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];this._segString=e,this.coord=new Wt(n),this.segmentIndex=r,this._segmentOctant=s,this._isInterior=!n.equals2D(e.getCoordinate(r))};Jg.prototype.getCoordinate=function(){return this.coord};Jg.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)};Jg.prototype.compareTo=function(e){var n=e;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:ku.compare(this._segmentOctant,this.coord,n.coord)};Jg.prototype.isEndPoint=function(e){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===e};Jg.prototype.isInterior=function(){return this._isInterior};Jg.prototype.interfaces_=function(){return[Eh]};Jg.prototype.getClass=function(){return Jg};var gu=function(){this._nodeMap=new Jl,this._edge=null;var e=arguments[0];this._edge=e};gu.prototype.getSplitCoordinates=function(){var e=this,n=new I9;this.addEndpoints();for(var r=this.iterator(),s=r.next();r.hasNext();){var u=r.next();e.addEdgeCoordinates(s,u,n),s=u}return n.toCoordinateArray()};gu.prototype.addCollapsedNodes=function(){var e=this,n=new vr;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var s=r.next().intValue();e.add(e._edge.getCoordinate(s),s)}};gu.prototype.print=function(e){e.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};gu.prototype.findCollapsesFromExistingVertices=function(e){for(var n=this,r=0;r<this._edge.size()-2;r++){var s=n._edge.getCoordinate(r),u=n._edge.getCoordinate(r+2);s.equals2D(u)&&e.add(new tf(r+1))}};gu.prototype.addEdgeCoordinates=function(e,n,r){var s=this,u=this._edge.getCoordinate(n.segmentIndex),p=n.isInterior()||!n.coord.equals2D(u);r.add(new Wt(e.coord),!1);for(var g=e.segmentIndex+1;g<=n.segmentIndex;g++)r.add(s._edge.getCoordinate(g));p&&r.add(new Wt(n.coord))};gu.prototype.iterator=function(){return this._nodeMap.values().iterator()};gu.prototype.addSplitEdges=function(e){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),s=r.next();r.hasNext();){var u=r.next(),p=n.createSplitEdge(s,u);e.add(p),s=u}};gu.prototype.findCollapseIndex=function(e,n,r){if(!e.coord.equals2D(n.coord))return!1;var s=n.segmentIndex-e.segmentIndex;return n.isInterior()||s--,s===1?(r[0]=e.segmentIndex+1,!0):!1};gu.prototype.findCollapsesFromInsertedNodes=function(e){for(var n=this,r=new Array(1).fill(null),s=this.iterator(),u=s.next();s.hasNext();){var p=s.next(),g=n.findCollapseIndex(u,p,r);g&&e.add(new tf(r[0])),u=p}};gu.prototype.getEdge=function(){return this._edge};gu.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)};gu.prototype.createSplitEdge=function(e,n){var r=this,s=n.segmentIndex-e.segmentIndex+2,u=this._edge.getCoordinate(n.segmentIndex),p=n.isInterior()||!n.coord.equals2D(u);p||s--;var g=new Array(s).fill(null),l=0;g[l++]=new Wt(e.coord);for(var E=e.segmentIndex+1;E<=n.segmentIndex;E++)g[l++]=r._edge.getCoordinate(E);return p&&(g[l]=new Wt(n.coord)),new fa(g,this._edge.getData())};gu.prototype.add=function(e,n){var r=new Jg(this._edge,e,n,this._edge.getSegmentOctant(n)),s=this._nodeMap.get(r);return s!==null?(Vi.isTrue(s.coord.equals2D(e),"Found equal nodes with different coordinates"),s):(this._nodeMap.put(r,r),r)};gu.prototype.checkSplitEdgesCorrectness=function(e){var n=this._edge.getCoordinates(),r=e.get(0),s=r.getCoordinate(0);if(!s.equals2D(n[0]))throw new Nm("bad split edge start point at "+s);var u=e.get(e.size()-1),p=u.getCoordinates(),g=p[p.length-1];if(!g.equals2D(n[n.length-1]))throw new Nm("bad split edge end point at "+g)};gu.prototype.interfaces_=function(){return[]};gu.prototype.getClass=function(){return gu};var Z1=function(){};Z1.prototype.interfaces_=function(){return[]};Z1.prototype.getClass=function(){return Z1};Z1.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];if(e===0&&n===0)throw new Po("Cannot compute the octant for point ( "+e+", "+n+" )");var r=Math.abs(e),s=Math.abs(n);return e>=0?n>=0?r>=s?0:1:r>=s?7:6:n>=0?r>=s?3:2:r>=s?4:5}else if(arguments[0]instanceof Wt&&arguments[1]instanceof Wt){var u=arguments[0],p=arguments[1],g=p.x-u.x,l=p.y-u.y;if(g===0&&l===0)throw new Po("Cannot compute the octant for two identical points "+u);return Z1.octant(g,l)}};var mp=function(){};mp.prototype.getCoordinates=function(){};mp.prototype.size=function(){};mp.prototype.getCoordinate=function(e){};mp.prototype.isClosed=function(){};mp.prototype.setData=function(e){};mp.prototype.getData=function(){};mp.prototype.interfaces_=function(){return[]};mp.prototype.getClass=function(){return mp};var Y5=function(){};Y5.prototype.addIntersection=function(e,n){};Y5.prototype.interfaces_=function(){return[mp]};Y5.prototype.getClass=function(){return Y5};var fa=function(){this._nodeList=new gu(this),this._pts=null,this._data=null;var e=arguments[0],n=arguments[1];this._pts=e,this._data=n};fa.prototype.getCoordinates=function(){return this._pts};fa.prototype.size=function(){return this._pts.length};fa.prototype.getCoordinate=function(e){return this._pts[e]};fa.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};fa.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))};fa.prototype.setData=function(e){this._data=e};fa.prototype.safeOctant=function(e,n){return e.equals2D(n)?0:Z1.octant(e,n)};fa.prototype.getData=function(){return this._data};fa.prototype.addIntersection=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];this.addIntersectionNode(e,n)}else if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[3],p=new Wt(r.getIntersection(u));this.addIntersection(p,s)}};fa.prototype.toString=function(){return sd.toLineString(new ca(this._pts))};fa.prototype.getNodeList=function(){return this._nodeList};fa.prototype.addIntersectionNode=function(e,n){var r=n,s=r+1;if(s<this._pts.length){var u=this._pts[s];e.equals2D(u)&&(r=s)}var p=this._nodeList.add(e,r);return p};fa.prototype.addIntersections=function(e,n,r){for(var s=this,u=0;u<e.getIntersectionNum();u++)s.addIntersection(e,n,r,u)};fa.prototype.interfaces_=function(){return[Y5]};fa.prototype.getClass=function(){return fa};fa.getNodedSubstrings=function(){if(arguments.length===1){var e=arguments[0],n=new vr;return fa.getNodedSubstrings(e,n),n}else if(arguments.length===2)for(var r=arguments[0],s=arguments[1],u=r.iterator();u.hasNext();){var p=u.next();p.getNodeList().addSplitEdges(s)}};var ii=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new Wt,this.p1=new Wt;else if(arguments.length===1){var e=arguments[0];this.p0=new Wt(e.p0),this.p1=new Wt(e.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],s=arguments[2],u=arguments[3];this.p0=new Wt(n,r),this.p1=new Wt(s,u)}},pG={serialVersionUID:{configurable:!0}};ii.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};ii.prototype.orientationIndex=function(){if(arguments[0]instanceof ii){var e=arguments[0],n=kr.orientationIndex(this.p0,this.p1,e.p0),r=kr.orientationIndex(this.p0,this.p1,e.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof Wt){var s=arguments[0];return kr.orientationIndex(this.p0,this.p1,s)}};ii.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])};ii.prototype.isVertical=function(){return this.p0.x===this.p1.x};ii.prototype.equals=function(e){if(!(e instanceof ii))return!1;var n=e;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};ii.prototype.intersection=function(e){var n=new t_;return n.computeIntersection(this.p0,this.p1,e.p0,e.p1),n.hasIntersection()?n.getIntersection(0):null};ii.prototype.project=function(){if(arguments[0]instanceof Wt){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new Wt(e);var n=this.projectionFactor(e),r=new Wt;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof ii){var s=arguments[0],u=this.projectionFactor(s.p0),p=this.projectionFactor(s.p1);if(u>=1&&p>=1||u<=0&&p<=0)return null;var g=this.project(s.p0);u<0&&(g=this.p0),u>1&&(g=this.p1);var l=this.project(s.p1);return p<0&&(l=this.p0),p>1&&(l=this.p1),new ii(g,l)}};ii.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};ii.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};ii.prototype.getCoordinate=function(e){return e===0?this.p0:this.p1};ii.prototype.distancePerpendicular=function(e){return kr.distancePointLinePerpendicular(e,this.p0,this.p1)};ii.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};ii.prototype.midPoint=function(){return ii.midPoint(this.p0,this.p1)};ii.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,s=n*n+r*r;if(s<=0)return Ai.NaN;var u=((e.x-this.p0.x)*n+(e.y-this.p0.y)*r)/s;return u};ii.prototype.closestPoints=function(e){var n=this.intersection(e);if(n!==null)return[n,n];var r=new Array(2).fill(null),s=Ai.MAX_VALUE,u=null,p=this.closestPoint(e.p0);s=p.distance(e.p0),r[0]=p,r[1]=e.p0;var g=this.closestPoint(e.p1);u=g.distance(e.p1),u<s&&(s=u,r[0]=g,r[1]=e.p1);var l=e.closestPoint(this.p0);u=l.distance(this.p0),u<s&&(s=u,r[0]=this.p0,r[1]=l);var E=e.closestPoint(this.p1);return u=E.distance(this.p1),u<s&&(s=u,r[0]=this.p1,r[1]=E),r};ii.prototype.closestPoint=function(e){var n=this.projectionFactor(e);if(n>0&&n<1)return this.project(e);var r=this.p0.distance(e),s=this.p1.distance(e);return r<s?this.p0:this.p1};ii.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};ii.prototype.getLength=function(){return this.p0.distance(this.p1)};ii.prototype.compareTo=function(e){var n=e,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};ii.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e};ii.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)};ii.prototype.lineIntersection=function(e){try{var n=Qh.intersection(this.p0,this.p1,e.p0,e.p1);return n}catch(r){if(!(r instanceof o3))throw r}finally{}return null};ii.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};ii.prototype.pointAlongOffset=function(e,n){var r=this.p0.x+e*(this.p1.x-this.p0.x),s=this.p0.y+e*(this.p1.y-this.p0.y),u=this.p1.x-this.p0.x,p=this.p1.y-this.p0.y,g=Math.sqrt(u*u+p*p),l=0,E=0;if(n!==0){if(g<=0)throw new Error("Cannot compute offset from zero-length line segment");l=n*u/g,E=n*p/g}var P=r-E,O=s+l,j=new Wt(P,O);return j};ii.prototype.setCoordinates=function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};ii.prototype.segmentFraction=function(e){var n=this.projectionFactor(e);return n<0?n=0:(n>1||Ai.isNaN(n))&&(n=1),n};ii.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};ii.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};ii.prototype.distance=function(){if(arguments[0]instanceof ii){var e=arguments[0];return kr.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}else if(arguments[0]instanceof Wt){var n=arguments[0];return kr.distancePointLine(n,this.p0,this.p1)}};ii.prototype.pointAlong=function(e){var n=new Wt;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n};ii.prototype.hashCode=function(){var e=Ai.doubleToLongBits(this.p0.x);e^=Ai.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(e)^Math.trunc(e>>32),r=Ai.doubleToLongBits(this.p1.x);r^=Ai.doubleToLongBits(this.p1.y)*31;var s=Math.trunc(r)^Math.trunc(r>>32);return n^s};ii.prototype.interfaces_=function(){return[Eh,Sh]};ii.prototype.getClass=function(){return ii};ii.midPoint=function(e,n){return new Wt((e.x+n.x)/2,(e.y+n.y)/2)};pG.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(ii,pG);var K5=function(){this.tempEnv1=new ni,this.tempEnv2=new ni,this._overlapSeg1=new ii,this._overlapSeg2=new ii};K5.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];e.getLineSegment(n,this._overlapSeg1),r.getLineSegment(s,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};K5.prototype.interfaces_=function(){return[]};K5.prototype.getClass=function(){return K5};var uc=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];this._pts=e,this._start=n,this._end=r,this._context=s};uc.prototype.getLineSegment=function(e,n){n.p0=this._pts[e],n.p1=this._pts[e+1]};uc.prototype.computeSelect=function(e,n,r,s){var u=this._pts[n],p=this._pts[r];if(s.tempEnv1.init(u,p),r-n===1)return s.select(this,n),null;if(!e.intersects(s.tempEnv1))return null;var g=Math.trunc((n+r)/2);n<g&&this.computeSelect(e,n,g,s),g<r&&this.computeSelect(e,g,r,s)};uc.prototype.getCoordinates=function(){for(var e=this,n=new Array(this._end-this._start+1).fill(null),r=0,s=this._start;s<=this._end;s++)n[r++]=e._pts[s];return n};uc.prototype.computeOverlaps=function(e,n){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,n)};uc.prototype.setId=function(e){this._id=e};uc.prototype.select=function(e,n){this.computeSelect(e,this._start,this._end,n)};uc.prototype.getEnvelope=function(){if(this._env===null){var e=this._pts[this._start],n=this._pts[this._end];this._env=new ni(e,n)}return this._env};uc.prototype.getEndIndex=function(){return this._end};uc.prototype.getStartIndex=function(){return this._start};uc.prototype.getContext=function(){return this._context};uc.prototype.getId=function(){return this._id};uc.prototype.computeOverlapsInternal=function(e,n,r,s,u,p){var g=this._pts[e],l=this._pts[n],E=r._pts[s],P=r._pts[u];if(n-e===1&&u-s===1)return p.overlap(this,e,r,s),null;if(p.tempEnv1.init(g,l),p.tempEnv2.init(E,P),!p.tempEnv1.intersects(p.tempEnv2))return null;var O=Math.trunc((e+n)/2),j=Math.trunc((s+u)/2);e<O&&(s<j&&this.computeOverlapsInternal(e,O,r,s,j,p),j<u&&this.computeOverlapsInternal(e,O,r,j,u,p)),O<n&&(s<j&&this.computeOverlapsInternal(O,n,r,s,j,p),j<u&&this.computeOverlapsInternal(O,n,r,j,u,p))};uc.prototype.interfaces_=function(){return[]};uc.prototype.getClass=function(){return uc};var Kd=function(){};Kd.prototype.interfaces_=function(){return[]};Kd.prototype.getClass=function(){return Kd};Kd.getChainStartIndices=function(e){var n=0,r=new vr;r.add(new tf(n));do{var s=Kd.findChainEnd(e,n);r.add(new tf(s)),n=s}while(n<e.length-1);var u=Kd.toIntArray(r);return u};Kd.findChainEnd=function(e,n){for(var r=n;r<e.length-1&&e[r].equals2D(e[r+1]);)r++;if(r>=e.length-1)return e.length-1;for(var s=qs.quadrant(e[r],e[r+1]),u=n+1;u<e.length;){if(!e[u-1].equals2D(e[u])){var p=qs.quadrant(e[u-1],e[u]);if(p!==s)break}u++}return u-1};Kd.getChains=function(){if(arguments.length===1){var e=arguments[0];return Kd.getChains(e,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],s=new vr,u=Kd.getChainStartIndices(n),p=0;p<u.length-1;p++){var g=new uc(n,u[p],u[p+1],r);s.add(g)}return s}};Kd.toIntArray=function(e){for(var n=new Array(e.size()).fill(null),r=0;r<n.length;r++)n[r]=e.get(r).intValue();return n};var zy=function(){};zy.prototype.computeNodes=function(e){};zy.prototype.getNodedSubstrings=function(){};zy.prototype.interfaces_=function(){return[]};zy.prototype.getClass=function(){return zy};var J5=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setSegmentIntersector(e)}}};J5.prototype.setSegmentIntersector=function(e){this._segInt=e};J5.prototype.interfaces_=function(){return[zy]};J5.prototype.getClass=function(){return J5};var YI=function(t){function e(r){r?t.call(this,r):t.call(this),this._monoChains=new vr,this._index=new fG,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return fa.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(s){for(var u=this,p=Kd.getChains(s.getCoordinates(),s),g=p.iterator();g.hasNext();){var l=g.next();l.setId(u._idCounter++),u._index.insert(l.getEnvelope(),l),u._monoChains.add(l)}},e.prototype.computeNodes=function(s){var u=this;this._nodedSegStrings=s;for(var p=s.iterator();p.hasNext();)u.add(p.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var s=this,u=new x8(this._segInt),p=this._monoChains.iterator();p.hasNext();)for(var g=p.next(),l=s._index.query(g.getEnvelope()),E=l.iterator();E.hasNext();){var P=E.next();if(P.getId()>g.getId()&&(g.computeOverlaps(P,u),s._nOverlaps++),s._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return x8},Object.defineProperties(e,n),e}(J5),x8=function(t){function e(){t.call(this),this._si=null;var n=arguments[0];this._si=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[2],p=arguments[3],g=r.getContext(),l=u.getContext();this._si.processIntersections(g,s,l,p)}else return t.prototype.overlap.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(K5),Cs=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var s=arguments[0],u=arguments[1],p=arguments[2],g=arguments[3];this.setQuadrantSegments(s),this.setEndCapStyle(u),this.setJoinStyle(p),this.setMitreLimit(g)}}},jm={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Cs.prototype.getEndCapStyle=function(){return this._endCapStyle};Cs.prototype.isSingleSided=function(){return this._isSingleSided};Cs.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=Cs.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Cs.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==Cs.JOIN_ROUND&&(this._quadrantSegments=Cs.DEFAULT_QUADRANT_SEGMENTS)};Cs.prototype.getJoinStyle=function(){return this._joinStyle};Cs.prototype.setJoinStyle=function(e){this._joinStyle=e};Cs.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e};Cs.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Cs.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Cs.prototype.setEndCapStyle=function(e){this._endCapStyle=e};Cs.prototype.getMitreLimit=function(){return this._mitreLimit};Cs.prototype.setMitreLimit=function(e){this._mitreLimit=e};Cs.prototype.setSingleSided=function(e){this._isSingleSided=e};Cs.prototype.interfaces_=function(){return[]};Cs.prototype.getClass=function(){return Cs};Cs.bufferDistanceError=function(e){var n=Math.PI/2/e;return 1-Math.cos(n/2)};jm.CAP_ROUND.get=function(){return 1};jm.CAP_FLAT.get=function(){return 2};jm.CAP_SQUARE.get=function(){return 3};jm.JOIN_ROUND.get=function(){return 1};jm.JOIN_MITRE.get=function(){return 2};jm.JOIN_BEVEL.get=function(){return 3};jm.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};jm.DEFAULT_MITRE_LIMIT.get=function(){return 5};jm.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Cs,jm);var Qo=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=kr.COUNTERCLOCKWISE,this._inputLine=e||null},P9={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Qo.prototype.isDeletable=function(e,n,r,s){var u=this._inputLine[e],p=this._inputLine[n],g=this._inputLine[r];return!this.isConcave(u,p,g)||!this.isShallow(u,p,g,s)?!1:this.isShallowSampled(u,p,e,r,s)};Qo.prototype.deleteShallowConcavities=function(){for(var e=this,n=1,r=this.findNextNonDeletedIndex(n),s=this.findNextNonDeletedIndex(r),u=!1;s<this._inputLine.length;){var p=!1;e.isDeletable(n,r,s,e._distanceTol)&&(e._isDeleted[r]=Qo.DELETE,p=!0,u=!0),p?n=s:n=r,r=e.findNextNonDeletedIndex(n),s=e.findNextNonDeletedIndex(r)}return u};Qo.prototype.isShallowConcavity=function(e,n,r,s){var u=kr.computeOrientation(e,n,r),p=u===this._angleOrientation;if(!p)return!1;var g=kr.distancePointLine(n,e,r);return g<s};Qo.prototype.isShallowSampled=function(e,n,r,s,u){var p=this,g=Math.trunc((s-r)/Qo.NUM_PTS_TO_CHECK);g<=0&&(g=1);for(var l=r;l<s;l+=g)if(!p.isShallow(e,n,p._inputLine[l],u))return!1;return!0};Qo.prototype.isConcave=function(e,n,r){var s=kr.computeOrientation(e,n,r),u=s===this._angleOrientation;return u};Qo.prototype.simplify=function(e){var n=this;this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=kr.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};Qo.prototype.findNextNonDeletedIndex=function(e){for(var n=e+1;n<this._inputLine.length&&this._isDeleted[n]===Qo.DELETE;)n++;return n};Qo.prototype.isShallow=function(e,n,r,s){var u=kr.distancePointLine(n,e,r);return u<s};Qo.prototype.collapseLine=function(){for(var e=this,n=new I9,r=0;r<this._inputLine.length;r++)e._isDeleted[r]!==Qo.DELETE&&n.add(e._inputLine[r]);return n.toCoordinateArray()};Qo.prototype.interfaces_=function(){return[]};Qo.prototype.getClass=function(){return Qo};Qo.simplify=function(e,n){var r=new Qo(e);return r.simplify(n)};P9.INIT.get=function(){return 0};P9.DELETE.get=function(){return 1};P9.KEEP.get=function(){return 1};P9.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Qo,P9);var Lc=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new vr},mG={COORDINATE_ARRAY_TYPE:{configurable:!0}};Lc.prototype.getCoordinates=function(){var e=this._ptList.toArray(Lc.COORDINATE_ARRAY_TYPE);return e};Lc.prototype.setPrecisionModel=function(e){this._precisionModel=e};Lc.prototype.addPt=function(e){var n=new Wt(e);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};Lc.prototype.revere=function(){};Lc.prototype.addPts=function(e,n){var r=this;if(n)for(var s=0;s<e.length;s++)r.addPt(e[s]);else for(var u=e.length-1;u>=0;u--)r.addPt(e[u])};Lc.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=e.distance(n);return r<this._minimimVertexDistance};Lc.prototype.toString=function(){var e=new Ji,n=e.createLineString(this.getCoordinates());return n.toString()};Lc.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new Wt(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(e.equals(n))return null;this._ptList.add(e)};Lc.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e};Lc.prototype.interfaces_=function(){return[]};Lc.prototype.getClass=function(){return Lc};mG.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(Lc,mG);var cs=function(){},fv={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};cs.prototype.interfaces_=function(){return[]};cs.prototype.getClass=function(){return cs};cs.toDegrees=function(e){return e*180/Math.PI};cs.normalize=function(e){for(;e>Math.PI;)e-=cs.PI_TIMES_2;for(;e<=-Math.PI;)e+=cs.PI_TIMES_2;return e};cs.angle=function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=r.x-n.x,u=r.y-n.y;return Math.atan2(u,s)}};cs.isAcute=function(e,n,r){var s=e.x-n.x,u=e.y-n.y,p=r.x-n.x,g=r.y-n.y,l=s*p+u*g;return l>0};cs.isObtuse=function(e,n,r){var s=e.x-n.x,u=e.y-n.y,p=r.x-n.x,g=r.y-n.y,l=s*p+u*g;return l<0};cs.interiorAngle=function(e,n,r){var s=cs.angle(n,e),u=cs.angle(n,r);return Math.abs(u-s)};cs.normalizePositive=function(e){if(e<0){for(;e<0;)e+=cs.PI_TIMES_2;e>=cs.PI_TIMES_2&&(e=0)}else{for(;e>=cs.PI_TIMES_2;)e-=cs.PI_TIMES_2;e<0&&(e=0)}return e};cs.angleBetween=function(e,n,r){var s=cs.angle(n,e),u=cs.angle(n,r);return cs.diff(s,u)};cs.diff=function(e,n){var r=null;return e<n?r=n-e:r=e-n,r>Math.PI&&(r=2*Math.PI-r),r};cs.toRadians=function(e){return e*Math.PI/180};cs.getTurn=function(e,n){var r=Math.sin(n-e);return r>0?cs.COUNTERCLOCKWISE:r<0?cs.CLOCKWISE:cs.NONE};cs.angleBetweenOriented=function(e,n,r){var s=cs.angle(n,e),u=cs.angle(n,r),p=u-s;return p<=-Math.PI?p+cs.PI_TIMES_2:p>Math.PI?p-cs.PI_TIMES_2:p};fv.PI_TIMES_2.get=function(){return 2*Math.PI};fv.PI_OVER_2.get=function(){return Math.PI/2};fv.PI_OVER_4.get=function(){return Math.PI/4};fv.COUNTERCLOCKWISE.get=function(){return kr.COUNTERCLOCKWISE};fv.CLOCKWISE.get=function(){return kr.CLOCKWISE};fv.NONE.get=function(){return kr.COLLINEAR};Object.defineProperties(cs,fv);var To=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ii,this._seg1=new ii,this._offset0=new ii,this._offset1=new ii,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new t_,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Cs.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},R9={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};To.prototype.addNextSegment=function(e,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=kr.computeOrientation(this._s0,this._s1,this._s2),s=r===kr.CLOCKWISE&&this._side===or.LEFT||r===kr.COUNTERCLOCKWISE&&this._side===or.RIGHT;r===0?this.addCollinear(n):s?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};To.prototype.addLineEndCap=function(e,n){var r=new ii(e,n),s=new ii;this.computeOffsetSegment(r,or.LEFT,this._distance,s);var u=new ii;this.computeOffsetSegment(r,or.RIGHT,this._distance,u);var p=n.x-e.x,g=n.y-e.y,l=Math.atan2(g,p);switch(this._bufParams.getEndCapStyle()){case Cs.CAP_ROUND:this._segList.addPt(s.p1),this.addFilletArc(n,l+Math.PI/2,l-Math.PI/2,kr.CLOCKWISE,this._distance),this._segList.addPt(u.p1);break;case Cs.CAP_FLAT:this._segList.addPt(s.p1),this._segList.addPt(u.p1);break;case Cs.CAP_SQUARE:var E=new Wt;E.x=Math.abs(this._distance)*Math.cos(l),E.y=Math.abs(this._distance)*Math.sin(l);var P=new Wt(s.p1.x+E.x,s.p1.y+E.y),O=new Wt(u.p1.x+E.x,u.p1.y+E.y);this._segList.addPt(P),this._segList.addPt(O);break}};To.prototype.getCoordinates=function(){var e=this._segList.getCoordinates();return e};To.prototype.addMitreJoin=function(e,n,r,s){var u=!0,p=null;try{p=Qh.intersection(n.p0,n.p1,r.p0,r.p1);var g=s<=0?1:p.distance(e)/Math.abs(s);g>this._bufParams.getMitreLimit()&&(u=!1)}catch(l){if(l instanceof o3)p=new Wt(0,0),u=!1;else throw l}finally{}u?this._segList.addPt(p):this.addLimitedMitreJoin(n,r,s,this._bufParams.getMitreLimit())};To.prototype.addFilletCorner=function(e,n,r,s,u){var p=n.x-e.x,g=n.y-e.y,l=Math.atan2(g,p),E=r.x-e.x,P=r.y-e.y,O=Math.atan2(P,E);s===kr.CLOCKWISE?l<=O&&(l+=2*Math.PI):l>=O&&(l-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(e,l,O,s,u),this._segList.addPt(r)};To.prototype.addOutsideTurn=function(e,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*To.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Cs.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Cs.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))};To.prototype.createSquare=function(e){this._segList.addPt(new Wt(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new Wt(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new Wt(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new Wt(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()};To.prototype.addSegments=function(e,n){this._segList.addPts(e,n)};To.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};To.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};To.prototype.initSideSegments=function(e,n,r){this._s1=e,this._s2=n,this._side=r,this._seg1.setCoordinates(e,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};To.prototype.addLimitedMitreJoin=function(e,n,r,s){var u=this._seg0.p1,p=cs.angle(u,this._seg0.p0),g=cs.angleBetweenOriented(this._seg0.p0,u,this._seg1.p1),l=g/2,E=cs.normalize(p+l),P=cs.normalize(E+Math.PI),O=s*r,j=O*Math.abs(Math.sin(l)),$=r-j,Y=u.x+O*Math.cos(P),re=u.y+O*Math.sin(P),_e=new Wt(Y,re),J=new ii(u,_e),H=J.pointAlongOffset(1,$),te=J.pointAlongOffset(1,-$);this._side===or.LEFT?(this._segList.addPt(H),this._segList.addPt(te)):(this._segList.addPt(te),this._segList.addPt(H))};To.prototype.computeOffsetSegment=function(e,n,r,s){var u=n===or.LEFT?1:-1,p=e.p1.x-e.p0.x,g=e.p1.y-e.p0.y,l=Math.sqrt(p*p+g*g),E=u*r*p/l,P=u*r*g/l;s.p0.x=e.p0.x-P,s.p0.y=e.p0.y+E,s.p1.x=e.p1.x-P,s.p1.y=e.p1.y+E};To.prototype.addFilletArc=function(e,n,r,s,u){var p=this,g=s===kr.CLOCKWISE?-1:1,l=Math.abs(n-r),E=Math.trunc(l/this._filletAngleQuantum+.5);if(E<1)return null;for(var P=0,O=l/E,j=P,$=new Wt;j<l;){var Y=n+g*j;$.x=e.x+u*Math.cos(Y),$.y=e.y+u*Math.sin(Y),p._segList.addPt($),j+=O}};To.prototype.addInsideTurn=function(e,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*To.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new Wt((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var s=new Wt((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(s)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};To.prototype.createCircle=function(e){var n=new Wt(e.x+this._distance,e.y);this._segList.addPt(n),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};To.prototype.addBevelJoin=function(e,n){this._segList.addPt(e.p1),this._segList.addPt(n.p0)};To.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Lc,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*To.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};To.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===Cs.JOIN_BEVEL||this._bufParams.getJoinStyle()===Cs.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,kr.CLOCKWISE,this._distance))};To.prototype.closeRing=function(){this._segList.closeRing()};To.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};To.prototype.interfaces_=function(){return[]};To.prototype.getClass=function(){return To};R9.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};R9.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};R9.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};R9.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(To,R9);var zu=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],n=arguments[1];this._precisionModel=e,this._bufParams=n};zu.prototype.getOffsetCurve=function(e,n){if(this._distance=n,n===0)return null;var r=n<0,s=Math.abs(n),u=this.getSegGen(s);e.length<=1?this.computePointCurve(e[0],u):this.computeOffsetCurve(e,r,u);var p=u.getCoordinates();return r&&Qi.reverse(p),p};zu.prototype.computeSingleSidedBufferCurve=function(e,n,r){var s=this.simplifyTolerance(this._distance);if(n){r.addSegments(e,!0);var u=Qo.simplify(e,-s),p=u.length-1;r.initSideSegments(u[p],u[p-1],or.LEFT),r.addFirstSegment();for(var g=p-2;g>=0;g--)r.addNextSegment(u[g],!0)}else{r.addSegments(e,!1);var l=Qo.simplify(e,s),E=l.length-1;r.initSideSegments(l[0],l[1],or.LEFT),r.addFirstSegment();for(var P=2;P<=E;P++)r.addNextSegment(l[P],!0)}r.addLastSegment(),r.closeRing()};zu.prototype.computeRingBufferCurve=function(e,n,r){var s=this.simplifyTolerance(this._distance);n===or.RIGHT&&(s=-s);var u=Qo.simplify(e,s),p=u.length-1;r.initSideSegments(u[p-1],u[0],n);for(var g=1;g<=p;g++){var l=g!==1;r.addNextSegment(u[g],l)}r.closeRing()};zu.prototype.computeLineBufferCurve=function(e,n){var r=this.simplifyTolerance(this._distance),s=Qo.simplify(e,r),u=s.length-1;n.initSideSegments(s[0],s[1],or.LEFT);for(var p=2;p<=u;p++)n.addNextSegment(s[p],!0);n.addLastSegment(),n.addLineEndCap(s[u-1],s[u]);var g=Qo.simplify(e,-r),l=g.length-1;n.initSideSegments(g[l],g[l-1],or.LEFT);for(var E=l-2;E>=0;E--)n.addNextSegment(g[E],!0);n.addLastSegment(),n.addLineEndCap(g[1],g[0]),n.closeRing()};zu.prototype.computePointCurve=function(e,n){switch(this._bufParams.getEndCapStyle()){case Cs.CAP_ROUND:n.createCircle(e);break;case Cs.CAP_SQUARE:n.createSquare(e);break}};zu.prototype.getLineCurve=function(e,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),s=this.getSegGen(r);if(e.length<=1)this.computePointCurve(e[0],s);else if(this._bufParams.isSingleSided()){var u=n<0;this.computeSingleSidedBufferCurve(e,u,s)}else this.computeLineBufferCurve(e,s);var p=s.getCoordinates();return p};zu.prototype.getBufferParameters=function(){return this._bufParams};zu.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()};zu.prototype.getRingCurve=function(e,n,r){if(this._distance=r,e.length<=2)return this.getLineCurve(e,r);if(r===0)return zu.copyCoordinates(e);var s=this.getSegGen(r);return this.computeRingBufferCurve(e,n,s),s.getCoordinates()};zu.prototype.computeOffsetCurve=function(e,n,r){var s=this.simplifyTolerance(this._distance);if(n){var u=Qo.simplify(e,-s),p=u.length-1;r.initSideSegments(u[p],u[p-1],or.LEFT),r.addFirstSegment();for(var g=p-2;g>=0;g--)r.addNextSegment(u[g],!0)}else{var l=Qo.simplify(e,s),E=l.length-1;r.initSideSegments(l[0],l[1],or.LEFT),r.addFirstSegment();for(var P=2;P<=E;P++)r.addNextSegment(l[P],!0)}r.addLastSegment()};zu.prototype.getSegGen=function(e){return new To(this._precisionModel,this._bufParams,e)};zu.prototype.interfaces_=function(){return[]};zu.prototype.getClass=function(){return zu};zu.copyCoordinates=function(e){for(var n=new Array(e.length).fill(null),r=0;r<n.length;r++)n[r]=new Wt(e[r]);return n};var Y1=function(){this._subgraphs=null,this._seg=new ii,this._cga=new kr;var e=arguments[0];this._subgraphs=e},gG={DepthSegment:{configurable:!0}};Y1.prototype.findStabbedSegments=function(){var e=this;if(arguments.length===1){for(var n=arguments[0],r=new vr,s=this._subgraphs.iterator();s.hasNext();){var u=s.next(),p=u.getEnvelope();n.y<p.getMinY()||n.y>p.getMaxY()||e.findStabbedSegments(n,u.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(_i(arguments[2],ed)&&arguments[0]instanceof Wt&&arguments[1]instanceof t2)for(var g=arguments[0],l=arguments[1],E=arguments[2],P=l.getEdge().getCoordinates(),O=0;O<P.length-1;O++){e._seg.p0=P[O],e._seg.p1=P[O+1],e._seg.p0.y>e._seg.p1.y&&e._seg.reverse();var j=Math.max(e._seg.p0.x,e._seg.p1.x);if(!(j<g.x)&&!e._seg.isHorizontal()&&!(g.y<e._seg.p0.y||g.y>e._seg.p1.y)&&kr.computeOrientation(e._seg.p0,e._seg.p1,g)!==kr.RIGHT){var $=l.getDepth(or.LEFT);e._seg.p0.equals(P[O])||($=l.getDepth(or.RIGHT));var Y=new By(e._seg,$);E.add(Y)}}else if(_i(arguments[2],ed)&&arguments[0]instanceof Wt&&_i(arguments[1],ed))for(var re=arguments[0],_e=arguments[1],J=arguments[2],H=_e.iterator();H.hasNext();){var te=H.next();te.isForward()&&e.findStabbedSegments(re,te,J)}}};Y1.prototype.getDepth=function(e){var n=this.findStabbedSegments(e);if(n.size()===0)return 0;var r=ld.min(n);return r._leftDepth};Y1.prototype.interfaces_=function(){return[]};Y1.prototype.getClass=function(){return Y1};gG.DepthSegment.get=function(){return By};Object.defineProperties(Y1,gG);var By=function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],n=arguments[1];this._upwardSeg=new ii(e),this._leftDepth=n};By.prototype.compareTo=function(e){var n=e;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};By.prototype.compareX=function(e,n){var r=e.p0.compareTo(n.p0);return r!==0?r:e.p1.compareTo(n.p1)};By.prototype.toString=function(){return this._upwardSeg.toString()};By.prototype.interfaces_=function(){return[Eh]};By.prototype.getClass=function(){return By};var As=function(e,n,r){this.p0=e||null,this.p1=n||null,this.p2=r||null};As.prototype.area=function(){return As.area(this.p0,this.p1,this.p2)};As.prototype.signedArea=function(){return As.signedArea(this.p0,this.p1,this.p2)};As.prototype.interpolateZ=function(e){if(e===null)throw new Po("Supplied point is null.");return As.interpolateZ(e,this.p0,this.p1,this.p2)};As.prototype.longestSideLength=function(){return As.longestSideLength(this.p0,this.p1,this.p2)};As.prototype.isAcute=function(){return As.isAcute(this.p0,this.p1,this.p2)};As.prototype.circumcentre=function(){return As.circumcentre(this.p0,this.p1,this.p2)};As.prototype.area3D=function(){return As.area3D(this.p0,this.p1,this.p2)};As.prototype.centroid=function(){return As.centroid(this.p0,this.p1,this.p2)};As.prototype.inCentre=function(){return As.inCentre(this.p0,this.p1,this.p2)};As.prototype.interfaces_=function(){return[]};As.prototype.getClass=function(){return As};As.area=function(e,n,r){return Math.abs(((r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y))/2)};As.signedArea=function(e,n,r){return((r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y))/2};As.det=function(e,n,r,s){return e*s-n*r};As.interpolateZ=function(e,n,r,s){var u=n.x,p=n.y,g=r.x-u,l=s.x-u,E=r.y-p,P=s.y-p,O=g*P-l*E,j=e.x-u,$=e.y-p,Y=(P*j-l*$)/O,re=(-E*j+g*$)/O,_e=n.z+Y*(r.z-n.z)+re*(s.z-n.z);return _e};As.longestSideLength=function(e,n,r){var s=e.distance(n),u=n.distance(r),p=r.distance(e),g=s;return u>g&&(g=u),p>g&&(g=p),g};As.isAcute=function(e,n,r){return!(!cs.isAcute(e,n,r)||!cs.isAcute(n,r,e)||!cs.isAcute(r,e,n))};As.circumcentre=function(e,n,r){var s=r.x,u=r.y,p=e.x-s,g=e.y-u,l=n.x-s,E=n.y-u,P=2*As.det(p,g,l,E),O=As.det(g,p*p+g*g,E,l*l+E*E),j=As.det(p,p*p+g*g,l,l*l+E*E),$=s-O/P,Y=u+j/P;return new Wt($,Y)};As.perpendicularBisector=function(e,n){var r=n.x-e.x,s=n.y-e.y,u=new Qh(e.x+r/2,e.y+s/2,1),p=new Qh(e.x-s+r/2,e.y+r+s/2,1);return new Qh(u,p)};As.angleBisector=function(e,n,r){var s=n.distance(e),u=n.distance(r),p=s/(s+u),g=r.x-e.x,l=r.y-e.y,E=new Wt(e.x+p*g,e.y+p*l);return E};As.area3D=function(e,n,r){var s=n.x-e.x,u=n.y-e.y,p=n.z-e.z,g=r.x-e.x,l=r.y-e.y,E=r.z-e.z,P=u*E-p*l,O=p*g-s*E,j=s*l-u*g,$=P*P+O*O+j*j,Y=Math.sqrt($)/2;return Y};As.centroid=function(e,n,r){var s=(e.x+n.x+r.x)/3,u=(e.y+n.y+r.y)/3;return new Wt(s,u)};As.inCentre=function(e,n,r){var s=n.distance(r),u=e.distance(r),p=e.distance(n),g=s+u+p,l=(s*e.x+u*n.x+p*r.x)/g,E=(s*e.y+u*n.y+p*r.y)/g;return new Wt(l,E)};var wh=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new vr;var e=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=e,this._distance=n,this._curveBuilder=r};wh.prototype.addPoint=function(e){if(this._distance<=0)return null;var n=e.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,tn.EXTERIOR,tn.INTERIOR)};wh.prototype.addPolygon=function(e){var n=this,r=this._distance,s=or.LEFT;this._distance<0&&(r=-this._distance,s=or.RIGHT);var u=e.getExteriorRing(),p=Qi.removeRepeatedPoints(u.getCoordinates());if(this._distance<0&&this.isErodedCompletely(u,this._distance)||this._distance<=0&&p.length<3)return null;this.addPolygonRing(p,r,s,tn.EXTERIOR,tn.INTERIOR);for(var g=0;g<e.getNumInteriorRing();g++){var l=e.getInteriorRingN(g),E=Qi.removeRepeatedPoints(l.getCoordinates());n._distance>0&&n.isErodedCompletely(l,-n._distance)||n.addPolygonRing(E,r,or.opposite(s),tn.INTERIOR,tn.EXTERIOR)}};wh.prototype.isTriangleErodedCompletely=function(e,n){var r=new As(e[0],e[1],e[2]),s=r.inCentre(),u=kr.distancePointLine(s,r.p0,r.p1);return u<Math.abs(n)};wh.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=Qi.removeRepeatedPoints(e.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,tn.EXTERIOR,tn.INTERIOR)};wh.prototype.addCurve=function(e,n,r){if(e===null||e.length<2)return null;var s=new fa(e,new Bs(0,tn.BOUNDARY,n,r));this._curveList.add(s)};wh.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};wh.prototype.addPolygonRing=function(e,n,r,s,u){if(n===0&&e.length<fp.MINIMUM_VALID_SIZE)return null;var p=s,g=u;e.length>=fp.MINIMUM_VALID_SIZE&&kr.isCCW(e)&&(p=u,g=s,r=or.opposite(r));var l=this._curveBuilder.getRingCurve(e,r,n);this.addCurve(l,p,g)};wh.prototype.add=function(e){if(e.isEmpty())return null;e instanceof qa?this.addPolygon(e):e instanceof Jo?this.addLineString(e):e instanceof ac?this.addPoint(e):e instanceof Sb?this.addCollection(e):e instanceof Fy?this.addCollection(e):e instanceof op?this.addCollection(e):e instanceof pu&&this.addCollection(e)};wh.prototype.isErodedCompletely=function(e,n){var r=e.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var s=e.getEnvelopeInternal(),u=Math.min(s.getHeight(),s.getWidth());return n<0&&2*Math.abs(n)>u};wh.prototype.addCollection=function(e){for(var n=this,r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);n.add(s)}};wh.prototype.interfaces_=function(){return[]};wh.prototype.getClass=function(){return wh};var Cb=function(){};Cb.prototype.locate=function(e){};Cb.prototype.interfaces_=function(){return[]};Cb.prototype.getClass=function(){return Cb};var ap=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};ap.prototype.next=function(){if(this._atStart)return this._atStart=!1,ap.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new l3;var e=this._parent.getGeometryN(this._index++);return e instanceof pu?(this._subcollectionIterator=new ap(e),this._subcollectionIterator.next()):e};ap.prototype.remove=function(){throw new Error(this.getClass().getName())};ap.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};ap.prototype.interfaces_=function(){return[a3]};ap.prototype.getClass=function(){return ap};ap.isAtomic=function(e){return!(e instanceof pu)};var Cc=function(){this._geom=null;var e=arguments[0];this._geom=e};Cc.prototype.locate=function(e){return Cc.locate(e,this._geom)};Cc.prototype.interfaces_=function(){return[Cb]};Cc.prototype.getClass=function(){return Cc};Cc.isPointInRing=function(e,n){return n.getEnvelopeInternal().intersects(e)?kr.isPointInRing(e,n.getCoordinates()):!1};Cc.containsPointInPolygon=function(e,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!Cc.isPointInRing(e,r))return!1;for(var s=0;s<n.getNumInteriorRing();s++){var u=n.getInteriorRingN(s);if(Cc.isPointInRing(e,u))return!1}return!0};Cc.containsPoint=function(e,n){if(n instanceof qa)return Cc.containsPointInPolygon(e,n);if(n instanceof pu)for(var r=new ap(n);r.hasNext();){var s=r.next();if(s!==n&&Cc.containsPoint(e,s))return!0}return!1};Cc.locate=function(e,n){return n.isEmpty()?tn.EXTERIOR:Cc.containsPoint(e,n)?tn.INTERIOR:tn.EXTERIOR};var eu=function(){this._edgeMap=new Jl,this._edgeList=null,this._ptInAreaLocation=[tn.NONE,tn.NONE]};eu.prototype.getNextCW=function(e){this.getEdges();var n=this._edgeList.indexOf(e),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};eu.prototype.propagateSideLabels=function(e){for(var n=tn.NONE,r=this.iterator();r.hasNext();){var s=r.next(),u=s.getLabel();u.isArea(e)&&u.getLocation(e,or.LEFT)!==tn.NONE&&(n=u.getLocation(e,or.LEFT))}if(n===tn.NONE)return null;for(var p=n,g=this.iterator();g.hasNext();){var l=g.next(),E=l.getLabel();if(E.getLocation(e,or.ON)===tn.NONE&&E.setLocation(e,or.ON,p),E.isArea(e)){var P=E.getLocation(e,or.LEFT),O=E.getLocation(e,or.RIGHT);if(O!==tn.NONE){if(O!==p)throw new Om("side location conflict",l.getCoordinate());P===tn.NONE&&Vi.shouldNeverReachHere("found single null side (at "+l.getCoordinate()+")"),p=P}else Vi.isTrue(E.getLocation(e,or.LEFT)===tn.NONE,"found single null side"),E.setLocation(e,or.RIGHT,p),E.setLocation(e,or.LEFT,p)}}};eu.prototype.getCoordinate=function(){var e=this.iterator();if(!e.hasNext())return null;var n=e.next();return n.getCoordinate()};eu.prototype.print=function(e){Rl.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};eu.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};eu.prototype.checkAreaLabelsConsistent=function(e){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,s=n.get(r).getLabel(),u=s.getLocation(e,or.LEFT);Vi.isTrue(u!==tn.NONE,"Found unlabelled area edge");for(var p=u,g=this.iterator();g.hasNext();){var l=g.next(),E=l.getLabel();Vi.isTrue(E.isArea(e),"Found non-area edge");var P=E.getLocation(e,or.LEFT),O=E.getLocation(e,or.RIGHT);if(P===O||O!==p)return!1;p=P}return!0};eu.prototype.findIndex=function(e){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var s=n._edgeList.get(r);if(s===e)return r}return-1};eu.prototype.iterator=function(){return this.getEdges().iterator()};eu.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new vr(this._edgeMap.values())),this._edgeList};eu.prototype.getLocation=function(e,n,r){return this._ptInAreaLocation[e]===tn.NONE&&(this._ptInAreaLocation[e]=Cc.locate(n,r[e].getGeometry())),this._ptInAreaLocation[e]};eu.prototype.toString=function(){var e=new pf;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();e.append(r),e.append(`
`)}return e.toString()};eu.prototype.computeEdgeEndLabels=function(e){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(e)}};eu.prototype.computeLabelling=function(e){var n=this;this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],s=this.iterator();s.hasNext();)for(var u=s.next(),p=u.getLabel(),g=0;g<2;g++)p.isLine(g)&&p.getLocation(g)===tn.BOUNDARY&&(r[g]=!0);for(var l=this.iterator();l.hasNext();)for(var E=l.next(),P=E.getLabel(),O=0;O<2;O++)if(P.isAnyNull(O)){var j=tn.NONE;if(r[O])j=tn.EXTERIOR;else{var $=E.getCoordinate();j=n.getLocation(O,$,e)}P.setAllLocationsIfNull(O,j)}};eu.prototype.getDegree=function(){return this._edgeMap.size()};eu.prototype.insertEdgeEnd=function(e,n){this._edgeMap.put(e,n),this._edgeList=null};eu.prototype.interfaces_=function(){return[]};eu.prototype.getClass=function(){return eu};var Aie=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var s=null,u=null,p=this._SCANNING_FOR_INCOMING,g=0;g<this._resultAreaEdgeList.size();g++){var l=r._resultAreaEdgeList.get(g),E=l.getSym();if(l.getLabel().isArea())switch(s===null&&l.isInResult()&&(s=l),p){case r._SCANNING_FOR_INCOMING:if(!E.isInResult())continue;u=E,p=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!l.isInResult())continue;u.setNext(l),p=r._SCANNING_FOR_INCOMING;break}}if(p===this._LINKING_TO_OUTGOING){if(s===null)throw new Om("no outgoing dirEdge found",this.getCoordinate());Vi.isTrue(s.isInResult(),"unable to link last incoming dirEdge"),u.setNext(s)}},e.prototype.insert=function(r){var s=r;this.insertEdgeEnd(s,s)},e.prototype.getRightmostEdge=function(){var r=this.getEdges(),s=r.size();if(s<1)return null;var u=r.get(0);if(s===1)return u;var p=r.get(s-1),g=u.getQuadrant(),l=p.getQuadrant();return qs.isNorthern(g)&&qs.isNorthern(l)?u:!qs.isNorthern(g)&&!qs.isNorthern(l)?p:u.getDy()!==0?u:p.getDy()!==0?p:(Vi.shouldNeverReachHere("found two horizontal edges incident on node"),null)},e.prototype.print=function(r){Rl.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var s=this.iterator();s.hasNext();){var u=s.next();r.print("out "),u.print(r),r.println(),r.print("in "),u.getSym().print(r),r.println()}},e.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new vr;for(var s=this.iterator();s.hasNext();){var u=s.next();(u.isInResult()||u.getSym().isInResult())&&r._resultAreaEdgeList.add(u)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(r){for(var s=this.iterator();s.hasNext();){var u=s.next(),p=u.getLabel();p.setAllLocationsIfNull(0,r.getLocation(0)),p.setAllLocationsIfNull(1,r.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var s=null,u=null,p=this._edgeList.size()-1;p>=0;p--){var g=r._edgeList.get(p),l=g.getSym();u===null&&(u=l),s!==null&&l.setNext(s),s=g}u.setNext(s)},e.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var s=arguments[0],u=this.findIndex(s),p=s.getDepth(or.LEFT),g=s.getDepth(or.RIGHT),l=this.computeDepths(u+1,this._edgeList.size(),p),E=this.computeDepths(0,u,l);if(E!==g)throw new Om("depth mismatch at "+s.getCoordinate())}else if(arguments.length===3){for(var P=arguments[0],O=arguments[1],j=arguments[2],$=j,Y=P;Y<O;Y++){var re=r._edgeList.get(Y);re.setEdgeDepths(or.RIGHT,$),$=re.getDepth(or.LEFT)}return $}},e.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var s=r.next(),u=s.getLabel();u.merge(s.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(r){for(var s=this,u=null,p=null,g=this._SCANNING_FOR_INCOMING,l=this._resultAreaEdgeList.size()-1;l>=0;l--){var E=s._resultAreaEdgeList.get(l),P=E.getSym();switch(u===null&&E.getEdgeRing()===r&&(u=E),g){case s._SCANNING_FOR_INCOMING:if(P.getEdgeRing()!==r)continue;p=P,g=s._LINKING_TO_OUTGOING;break;case s._LINKING_TO_OUTGOING:if(E.getEdgeRing()!==r)continue;p.setNextMin(E),g=s._SCANNING_FOR_INCOMING;break}}g===this._LINKING_TO_OUTGOING&&(Vi.isTrue(u!==null,"found null for first outgoing dirEdge"),Vi.isTrue(u.getEdgeRing()===r,"unable to link last incoming dirEdge"),p.setNextMin(u))},e.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,s=this.iterator();s.hasNext();){var u=s.next();u.isInResult()&&r++}return r}else if(arguments.length===1){for(var p=arguments[0],g=0,l=this.iterator();l.hasNext();){var E=l.next();E.getEdgeRing()===p&&g++}return g}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var r=tn.NONE,s=this.iterator();s.hasNext();){var u=s.next(),p=u.getSym();if(!u.isLineEdge()){if(u.isInResult()){r=tn.INTERIOR;break}if(p.isInResult()){r=tn.EXTERIOR;break}}}if(r===tn.NONE)return null;for(var g=r,l=this.iterator();l.hasNext();){var E=l.next(),P=E.getSym();E.isLineEdge()?E.getEdge().setCovered(g===tn.INTERIOR):(E.isInResult()&&(g=tn.EXTERIOR),P.isInResult()&&(g=tn.INTERIOR))}},e.prototype.computeLabelling=function(r){var s=this;t.prototype.computeLabelling.call(this,r),this._label=new Bs(tn.NONE);for(var u=this.iterator();u.hasNext();)for(var p=u.next(),g=p.getEdge(),l=g.getLabel(),E=0;E<2;E++){var P=l.getLocation(E);(P===tn.INTERIOR||P===tn.BOUNDARY)&&s._label.setLocation(E,tn.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(eu),yG=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(r){return new LM(r,new Aie)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Tb),Qg=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Qg.prototype.compareTo=function(e){var n=e,r=Qg.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};Qg.prototype.interfaces_=function(){return[Eh]};Qg.prototype.getClass=function(){return Qg};Qg.orientation=function(e){return Qi.increasingDirection(e)===1};Qg.compareOriented=function(e,n,r,s){for(var u=n?1:-1,p=s?1:-1,g=n?e.length:-1,l=s?r.length:-1,E=n?0:e.length-1,P=s?0:r.length-1;;){var O=e[E].compareTo(r[P]);if(O!==0)return O;E+=u,P+=p;var j=E===g,$=P===l;if(j&&!$)return-1;if(!j&&$)return 1;if(j&&$)return 0}};var ud=function(){this._edges=new vr,this._ocaMap=new Jl};ud.prototype.print=function(e){var n=this;e.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var s=n._edges.get(r);r>0&&e.print(","),e.print("(");for(var u=s.getCoordinates(),p=0;p<u.length;p++)p>0&&e.print(","),e.print(u[p].x+" "+u[p].y);e.println(")")}e.print(")  ")};ud.prototype.addAll=function(e){for(var n=this,r=e.iterator();r.hasNext();)n.add(r.next())};ud.prototype.findEdgeIndex=function(e){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(e))return r;return-1};ud.prototype.iterator=function(){return this._edges.iterator()};ud.prototype.getEdges=function(){return this._edges};ud.prototype.get=function(e){return this._edges.get(e)};ud.prototype.findEqualEdge=function(e){var n=new Qg(e.getCoordinates()),r=this._ocaMap.get(n);return r};ud.prototype.add=function(e){this._edges.add(e);var n=new Qg(e.getCoordinates());this._ocaMap.put(n,e)};ud.prototype.interfaces_=function(){return[]};ud.prototype.getClass=function(){return ud};var Uy=function(){};Uy.prototype.processIntersections=function(e,n,r,s){};Uy.prototype.isDone=function(){};Uy.prototype.interfaces_=function(){return[]};Uy.prototype.getClass=function(){return Uy};var Pc=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e};Pc.prototype.isTrivialIntersection=function(e,n,r,s){if(e===r&&this._li.getIntersectionNum()===1){if(Pc.isAdjacentSegments(n,s))return!0;if(e.isClosed()){var u=e.size()-1;if(n===0&&s===u||s===0&&n===u)return!0}}return!1};Pc.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Pc.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Pc.prototype.getLineIntersector=function(){return this._li};Pc.prototype.hasProperIntersection=function(){return this._hasProper};Pc.prototype.processIntersections=function(e,n,r,s){if(e===r&&n===s)return null;this.numTests++;var u=e.getCoordinates()[n],p=e.getCoordinates()[n+1],g=r.getCoordinates()[s],l=r.getCoordinates()[s+1];this._li.computeIntersection(u,p,g,l),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,n,r,s)||(this._hasIntersection=!0,e.addIntersections(this._li,n,0),r.addIntersections(this._li,s,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};Pc.prototype.hasIntersection=function(){return this._hasIntersection};Pc.prototype.isDone=function(){return!1};Pc.prototype.hasInteriorIntersection=function(){return this._hasInterior};Pc.prototype.interfaces_=function(){return[Uy]};Pc.prototype.getClass=function(){return Pc};Pc.isAdjacentSegments=function(e,n){return Math.abs(e-n)===1};var lf=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],n=arguments[1],r=arguments[2];this.coord=new Wt(e),this.segmentIndex=n,this.dist=r};lf.prototype.getSegmentIndex=function(){return this.segmentIndex};lf.prototype.getCoordinate=function(){return this.coord};lf.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)};lf.prototype.compareTo=function(e){var n=e;return this.compare(n.segmentIndex,n.dist)};lf.prototype.isEndPoint=function(e){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===e};lf.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};lf.prototype.getDistance=function(){return this.dist};lf.prototype.compare=function(e,n){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<n?-1:this.dist>n?1:0};lf.prototype.interfaces_=function(){return[Eh]};lf.prototype.getClass=function(){return lf};var gp=function(){this._nodeMap=new Jl,this.edge=null;var e=arguments[0];this.edge=e};gp.prototype.print=function(e){e.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};gp.prototype.iterator=function(){return this._nodeMap.values().iterator()};gp.prototype.addSplitEdges=function(e){var n=this;this.addEndpoints();for(var r=this.iterator(),s=r.next();r.hasNext();){var u=r.next(),p=n.createSplitEdge(s,u);e.add(p),s=u}};gp.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)};gp.prototype.createSplitEdge=function(e,n){var r=this,s=n.segmentIndex-e.segmentIndex+2,u=this.edge.pts[n.segmentIndex],p=n.dist>0||!n.coord.equals2D(u);p||s--;var g=new Array(s).fill(null),l=0;g[l++]=new Wt(e.coord);for(var E=e.segmentIndex+1;E<=n.segmentIndex;E++)g[l++]=r.edge.pts[E];return p&&(g[l]=n.coord),new PS(g,new Bs(this.edge._label))};gp.prototype.add=function(e,n,r){var s=new lf(e,n,r),u=this._nodeMap.get(s);return u!==null?u:(this._nodeMap.put(s,s),s)};gp.prototype.isIntersection=function(e){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(e))return!0}return!1};gp.prototype.interfaces_=function(){return[]};gp.prototype.getClass=function(){return gp};var jy=function(){};jy.prototype.getChainStartIndices=function(e){var n=this,r=0,s=new vr;s.add(new tf(r));do{var u=n.findChainEnd(e,r);s.add(new tf(u)),r=u}while(r<e.length-1);var p=jy.toIntArray(s);return p};jy.prototype.findChainEnd=function(e,n){for(var r=qs.quadrant(e[n],e[n+1]),s=n+1;s<e.length;){var u=qs.quadrant(e[s-1],e[s]);if(u!==r)break;s++}return s-1};jy.prototype.interfaces_=function(){return[]};jy.prototype.getClass=function(){return jy};jy.toIntArray=function(e){for(var n=new Array(e.size()).fill(null),r=0;r<n.length;r++)n[r]=e.get(r).intValue();return n};var zm=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new ni,this.env2=new ni;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var n=new jy;this.startIndex=n.getChainStartIndices(this.pts)};zm.prototype.getCoordinates=function(){return this.pts};zm.prototype.getMaxX=function(e){var n=this.pts[this.startIndex[e]].x,r=this.pts[this.startIndex[e+1]].x;return n>r?n:r};zm.prototype.getMinX=function(e){var n=this.pts[this.startIndex[e]].x,r=this.pts[this.startIndex[e+1]].x;return n<r?n:r};zm.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],n,n.startIndex[r],n.startIndex[r+1],s)}else if(arguments.length===6){var u=arguments[0],p=arguments[1],g=arguments[2],l=arguments[3],E=arguments[4],P=arguments[5],O=this.pts[u],j=this.pts[p],$=g.pts[l],Y=g.pts[E];if(p-u===1&&E-l===1)return P.addIntersections(this.e,u,g.e,l),null;if(this.env1.init(O,j),this.env2.init($,Y),!this.env1.intersects(this.env2))return null;var re=Math.trunc((u+p)/2),_e=Math.trunc((l+E)/2);u<re&&(l<_e&&this.computeIntersectsForChain(u,re,g,l,_e,P),_e<E&&this.computeIntersectsForChain(u,re,g,_e,E,P)),re<p&&(l<_e&&this.computeIntersectsForChain(re,p,g,l,_e,P),_e<E&&this.computeIntersectsForChain(re,p,g,_e,E,P))}};zm.prototype.getStartIndexes=function(){return this.startIndex};zm.prototype.computeIntersects=function(e,n){for(var r=this,s=0;s<this.startIndex.length-1;s++)for(var u=0;u<e.startIndex.length-1;u++)r.computeIntersectsForChain(s,e,u,n)};zm.prototype.interfaces_=function(){return[]};zm.prototype.getClass=function(){return zm};var Pl=function t(){var e=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)e._depth[n][r]=t.NULL_VALUE},_G={NULL_VALUE:{configurable:!0}};Pl.prototype.getDepth=function(e,n){return this._depth[e][n]};Pl.prototype.setDepth=function(e,n,r){this._depth[e][n]=r};Pl.prototype.isNull=function(){var e=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(e._depth[n][r]!==Pl.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var s=arguments[0];return this._depth[s][1]===Pl.NULL_VALUE}else if(arguments.length===2){var u=arguments[0],p=arguments[1];return this._depth[u][p]===Pl.NULL_VALUE}};Pl.prototype.normalize=function(){for(var e=this,n=0;n<2;n++)if(!e.isNull(n)){var r=e._depth[n][1];e._depth[n][2]<r&&(r=e._depth[n][2]),r<0&&(r=0);for(var s=1;s<3;s++){var u=0;e._depth[n][s]>r&&(u=1),e._depth[n][s]=u}}};Pl.prototype.getDelta=function(e){return this._depth[e][or.RIGHT]-this._depth[e][or.LEFT]};Pl.prototype.getLocation=function(e,n){return this._depth[e][n]<=0?tn.EXTERIOR:tn.INTERIOR};Pl.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};Pl.prototype.add=function(){var e=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var s=1;s<3;s++){var u=n.getLocation(r,s);(u===tn.EXTERIOR||u===tn.INTERIOR)&&(e.isNull(r,s)?e._depth[r][s]=Pl.depthAtLocation(u):e._depth[r][s]+=Pl.depthAtLocation(u))}else if(arguments.length===3){var p=arguments[0],g=arguments[1],l=arguments[2];l===tn.INTERIOR&&this._depth[p][g]++}};Pl.prototype.interfaces_=function(){return[]};Pl.prototype.getClass=function(){return Pl};Pl.depthAtLocation=function(e){return e===tn.EXTERIOR?0:e===tn.INTERIOR?1:Pl.NULL_VALUE};_G.NULL_VALUE.get=function(){return-1};Object.defineProperties(Pl,_G);var PS=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new gp(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Pl,this._depthDelta=0,arguments.length===1){var n=arguments[0];e.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.pts=r,this._label=s}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var s=new e(r,Bs.toLineLabel(this._label));return s},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(r){this._isIsolated=r},e.prototype.setName=function(r){this._name=r},e.prototype.equals=function(r){var s=this;if(!(r instanceof e))return!1;var u=r;if(this.pts.length!==u.pts.length)return!1;for(var p=!0,g=!0,l=this.pts.length,E=0;E<this.pts.length;E++)if(s.pts[E].equals2D(u.pts[E])||(p=!1),s.pts[E].equals2D(u.pts[--l])||(g=!1),!p&&!g)return!1;return!0},e.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},e.prototype.print=function(r){var s=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var u=0;u<this.pts.length;u++)u>0&&r.print(","),r.print(s.pts[u].x+" "+s.pts[u].y);r.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(r){e.updateIM(this._label,r)},e.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(r){var s=this;r.print("edge "+this._name+": ");for(var u=this.pts.length-1;u>=0;u--)r.print(s.pts[u]+" ");r.println("")},e.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new zm(this)),this._mce},e.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new ni;for(var s=0;s<this.pts.length;s++)r._env.expandToInclude(r.pts[s])}return this._env},e.prototype.addIntersection=function(r,s,u,p){var g=new Wt(r.getIntersection(p)),l=s,E=r.getEdgeDistance(u,p),P=l+1;if(P<this.pts.length){var O=this.pts[P];g.equals2D(O)&&(l=P,E=0)}this.eiList.add(g,l,E)},e.prototype.toString=function(){var r=this,s=new pf;s.append("edge "+this._name+": "),s.append("LINESTRING (");for(var u=0;u<this.pts.length;u++)u>0&&s.append(","),s.append(r.pts[u].x+" "+r.pts[u].y);return s.append(")  "+this._label+" "+this._depthDelta),s.toString()},e.prototype.isPointwiseEqual=function(r){var s=this;if(this.pts.length!==r.pts.length)return!1;for(var u=0;u<this.pts.length;u++)if(!s.pts[u].equals2D(r.pts[u]))return!1;return!0},e.prototype.setDepthDelta=function(r){this._depthDelta=r},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(r,s,u){for(var p=this,g=0;g<r.getIntersectionNum();g++)p.addIntersection(r,s,u,g)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];s.setAtLeastIfValid(r.getLocation(0,or.ON),r.getLocation(1,or.ON),1),r.isArea()&&(s.setAtLeastIfValid(r.getLocation(0,or.LEFT),r.getLocation(1,or.LEFT),2),s.setAtLeastIfValid(r.getLocation(0,or.RIGHT),r.getLocation(1,or.RIGHT),2))}else return t.prototype.updateIM.apply(this,arguments)},e}(Ac),fu=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ud,this._bufParams=e||null};fu.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e};fu.prototype.insertUniqueEdge=function(e){var n=this._edgeList.findEqualEdge(e);if(n!==null){var r=n.getLabel(),s=e.getLabel();n.isPointwiseEqual(e)||(s=new Bs(e.getLabel()),s.flip()),r.merge(s);var u=fu.depthDelta(s),p=n.getDepthDelta(),g=p+u;n.setDepthDelta(g)}else this._edgeList.add(e),e.setDepthDelta(fu.depthDelta(e.getLabel()))};fu.prototype.buildSubgraphs=function(e,n){for(var r=new vr,s=e.iterator();s.hasNext();){var u=s.next(),p=u.getRightmostCoordinate(),g=new Y1(r),l=g.getDepth(p);u.computeDepth(l),u.findResultEdges(),r.add(u),n.add(u.getDirectedEdges(),u.getNodes())}};fu.prototype.createSubgraphs=function(e){for(var n=new vr,r=e.getNodes().iterator();r.hasNext();){var s=r.next();if(!s.isVisited()){var u=new mu;u.create(s),n.add(u)}}return ld.sort(n,ld.reverseOrder()),n};fu.prototype.createEmptyResultGeometry=function(){var e=this._geomFact.createPolygon();return e};fu.prototype.getNoder=function(e){if(this._workingNoder!==null)return this._workingNoder;var n=new YI,r=new t_;return r.setPrecisionModel(e),n.setSegmentIntersector(new Pc(r)),n};fu.prototype.buffer=function(e,n){var r=this._workingPrecisionModel;r===null&&(r=e.getPrecisionModel()),this._geomFact=e.getFactory();var s=new zu(r,this._bufParams),u=new wh(e,n,s),p=u.getCurves();if(p.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(p,r),this._graph=new Bo(new yG),this._graph.addEdges(this._edgeList.getEdges());var g=this.createSubgraphs(this._graph),l=new lc(this._geomFact);this.buildSubgraphs(g,l);var E=l.getPolygons();if(E.size()<=0)return this.createEmptyResultGeometry();var P=this._geomFact.buildGeometry(E);return P};fu.prototype.computeNodedEdges=function(e,n){var r=this,s=this.getNoder(n);s.computeNodes(e);for(var u=s.getNodedSubstrings(),p=u.iterator();p.hasNext();){var g=p.next(),l=g.getCoordinates();if(!(l.length===2&&l[0].equals2D(l[1]))){var E=g.getData(),P=new PS(g.getCoordinates(),new Bs(E));r.insertUniqueEdge(P)}}};fu.prototype.setNoder=function(e){this._workingNoder=e};fu.prototype.interfaces_=function(){return[]};fu.prototype.getClass=function(){return fu};fu.depthDelta=function(e){var n=e.getLocation(0,or.LEFT),r=e.getLocation(0,or.RIGHT);return n===tn.INTERIOR&&r===tn.EXTERIOR?1:n===tn.EXTERIOR&&r===tn.INTERIOR?-1:0};fu.convertSegStrings=function(e){for(var n=new Ji,r=new vr;e.hasNext();){var s=e.next(),u=n.createLineString(s.getCoordinates());r.add(u)}return n.buildGeometry(r)};var e0=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],n=arguments[1];this._noder=e,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[2],p=arguments[3];this._noder=r,this._scaleFactor=s,this._offsetX=u,this._offsetY=p,this._isScaled=!this.isIntegerPrecision()}};e0.prototype.rescale=function(){var e=this;if(_i(arguments[0],Ua))for(var n=arguments[0],r=n.iterator();r.hasNext();){var s=r.next();e.rescale(s.getCoordinates())}else if(arguments[0]instanceof Array){for(var u=arguments[0],p=0;p<u.length;p++)u[p].x=u[p].x/e._scaleFactor+e._offsetX,u[p].y=u[p].y/e._scaleFactor+e._offsetY;u.length===2&&u[0].equals2D(u[1])&&Rl.out.println(u)}};e0.prototype.scale=function(){var e=this;if(_i(arguments[0],Ua)){for(var n=arguments[0],r=new vr,s=n.iterator();s.hasNext();){var u=s.next();r.add(new fa(e.scale(u.getCoordinates()),u.getData()))}return r}else if(arguments[0]instanceof Array){for(var p=arguments[0],g=new Array(p.length).fill(null),l=0;l<p.length;l++)g[l]=new Wt(Math.round((p[l].x-e._offsetX)*e._scaleFactor),Math.round((p[l].y-e._offsetY)*e._scaleFactor),p[l].z);var E=Qi.removeRepeatedPoints(g);return E}};e0.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};e0.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e};e0.prototype.computeNodes=function(e){var n=e;this._isScaled&&(n=this.scale(e)),this._noder.computeNodes(n)};e0.prototype.interfaces_=function(){return[zy]};e0.prototype.getClass=function(){return e0};var uf=function(){this._li=new t_,this._segStrings=null;var e=arguments[0];this._segStrings=e},vG={fact:{configurable:!0}};uf.prototype.checkEndPtVertexIntersections=function(){var e=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),s=r.getCoordinates();e.checkEndPtVertexIntersections(s[0],e._segStrings),e.checkEndPtVertexIntersections(s[s.length-1],e._segStrings)}else if(arguments.length===2){for(var u=arguments[0],p=arguments[1],g=p.iterator();g.hasNext();)for(var l=g.next(),E=l.getCoordinates(),P=1;P<E.length-1;P++)if(E[P].equals(u))throw new Nm("found endpt/interior pt intersection at index "+P+" :pt "+u)}};uf.prototype.checkInteriorIntersections=function(){var e=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),s=this._segStrings.iterator();s.hasNext();){var u=s.next();e.checkInteriorIntersections(r,u)}else if(arguments.length===2)for(var p=arguments[0],g=arguments[1],l=p.getCoordinates(),E=g.getCoordinates(),P=0;P<l.length-1;P++)for(var O=0;O<E.length-1;O++)e.checkInteriorIntersections(p,P,g,O);else if(arguments.length===4){var j=arguments[0],$=arguments[1],Y=arguments[2],re=arguments[3];if(j===Y&&$===re)return null;var _e=j.getCoordinates()[$],J=j.getCoordinates()[$+1],H=Y.getCoordinates()[re],te=Y.getCoordinates()[re+1];if(this._li.computeIntersection(_e,J,H,te),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,_e,J)||this.hasInteriorIntersection(this._li,H,te)))throw new Nm("found non-noded intersection at "+_e+"-"+J+" and "+H+"-"+te)}};uf.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};uf.prototype.checkCollapses=function(){var e=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();e.checkCollapses(r)}else if(arguments.length===1)for(var s=arguments[0],u=s.getCoordinates(),p=0;p<u.length-2;p++)e.checkCollapse(u[p],u[p+1],u[p+2])};uf.prototype.hasInteriorIntersection=function(e,n,r){for(var s=0;s<e.getIntersectionNum();s++){var u=e.getIntersection(s);if(!(u.equals(n)||u.equals(r)))return!0}return!1};uf.prototype.checkCollapse=function(e,n,r){if(e.equals(r))throw new Nm("found non-noded collapse at "+uf.fact.createLineString([e,n,r]))};uf.prototype.interfaces_=function(){return[]};uf.prototype.getClass=function(){return uf};vG.fact.get=function(){return new Ji};Object.defineProperties(uf,vG);var Bu=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=n,this._li=r,n<=0)throw new Po("Scale factor must be non-zero");n!==1&&(this._pt=new Wt(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new Wt,this._p1Scaled=new Wt),this.initCorners(this._pt)},xG={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Bu.prototype.intersectsScaled=function(e,n){var r=Math.min(e.x,n.x),s=Math.max(e.x,n.x),u=Math.min(e.y,n.y),p=Math.max(e.y,n.y),g=this._maxx<r||this._minx>s||this._maxy<u||this._miny>p;if(g)return!1;var l=this.intersectsToleranceSquare(e,n);return Vi.isTrue(!(g&&l),"Found bad envelope test"),l};Bu.prototype.initCorners=function(e){var n=.5;this._minx=e.x-n,this._maxx=e.x+n,this._miny=e.y-n,this._maxy=e.y+n,this._corner[0]=new Wt(this._maxx,this._maxy),this._corner[1]=new Wt(this._minx,this._maxy),this._corner[2]=new Wt(this._minx,this._miny),this._corner[3]=new Wt(this._maxx,this._miny)};Bu.prototype.intersects=function(e,n){return this._scaleFactor===1?this.intersectsScaled(e,n):(this.copyScaled(e,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Bu.prototype.scale=function(e){return Math.round(e*this._scaleFactor)};Bu.prototype.getCoordinate=function(){return this._originalPt};Bu.prototype.copyScaled=function(e,n){n.x=this.scale(e.x),n.y=this.scale(e.y)};Bu.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var e=Bu.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new ni(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv};Bu.prototype.intersectsPixelClosure=function(e,n){return this._li.computeIntersection(e,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(e,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(e,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};Bu.prototype.intersectsToleranceSquare=function(e,n){var r=!1,s=!1;return this._li.computeIntersection(e,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(s=!0),this._li.computeIntersection(e,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&s||e.equals(this._pt)||n.equals(this._pt))};Bu.prototype.addSnappedNode=function(e,n){var r=e.getCoordinate(n),s=e.getCoordinate(n+1);return this.intersects(r,s)?(e.addIntersection(this.getCoordinate(),n),!0):!1};Bu.prototype.interfaces_=function(){return[]};Bu.prototype.getClass=function(){return Bu};xG.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(Bu,xG);var Q5=function(){this.tempEnv1=new ni,this.selectedSegment=new ii};Q5.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var e=arguments[0],n=arguments[1];e.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};Q5.prototype.interfaces_=function(){return[]};Q5.prototype.getClass=function(){return Q5};var Ib=function(){this._index=null;var e=arguments[0];this._index=e},bG={HotPixelSnapAction:{configurable:!0}};Ib.prototype.snap=function(){if(arguments.length===1){var e=arguments[0];return this.snap(e,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2],u=n.getSafeEnvelope(),p=new wG(n,r,s);return this._index.query(u,{interfaces_:function(){return[Kg]},visitItem:function(g){var l=g;l.select(u,p)}}),p.isNodeAdded()}};Ib.prototype.interfaces_=function(){return[]};Ib.prototype.getClass=function(){return Ib};bG.HotPixelSnapAction.get=function(){return wG};Object.defineProperties(Ib,bG);var wG=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],s=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1],u=r.getContext();if(this._parentEdge!==null&&u===this._parentEdge&&s===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(u,s)}else return t.prototype.select.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Q5),K1=function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new vr};K1.prototype.processIntersections=function(e,n,r,s){var u=this;if(e===r&&n===s)return null;var p=e.getCoordinates()[n],g=e.getCoordinates()[n+1],l=r.getCoordinates()[s],E=r.getCoordinates()[s+1];if(this._li.computeIntersection(p,g,l,E),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var P=0;P<this._li.getIntersectionNum();P++)u._interiorIntersections.add(u._li.getIntersection(P));e.addIntersections(this._li,n,0),r.addIntersections(this._li,s,1)}};K1.prototype.isDone=function(){return!1};K1.prototype.getInteriorIntersections=function(){return this._interiorIntersections};K1.prototype.interfaces_=function(){return[Uy]};K1.prototype.getClass=function(){return K1};var yp=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new t_,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};yp.prototype.checkCorrectness=function(e){var n=fa.getNodedSubstrings(e),r=new uf(n);try{r.checkValid()}catch(s){if(s instanceof sG)s.printStackTrace();else throw s}finally{}};yp.prototype.getNodedSubstrings=function(){return fa.getNodedSubstrings(this._nodedSegStrings)};yp.prototype.snapRound=function(e,n){var r=this.findInteriorIntersections(e,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(e)};yp.prototype.findInteriorIntersections=function(e,n){var r=new K1(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(e),r.getInteriorIntersections()};yp.prototype.computeVertexSnaps=function(){var e=this;if(_i(arguments[0],Ua))for(var n=arguments[0],r=n.iterator();r.hasNext();){var s=r.next();e.computeVertexSnaps(s)}else if(arguments[0]instanceof fa)for(var u=arguments[0],p=u.getCoordinates(),g=0;g<p.length;g++){var l=new Bu(p[g],e._scaleFactor,e._li),E=e._pointSnapper.snap(l,u,g);E&&u.addIntersection(p[g],g)}};yp.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new YI,this._pointSnapper=new Ib(this._noder.getIndex()),this.snapRound(e,this._li)};yp.prototype.computeIntersectionSnaps=function(e){for(var n=this,r=e.iterator();r.hasNext();){var s=r.next(),u=new Bu(s,n._scaleFactor,n._li);n._pointSnapper.snap(u)}};yp.prototype.interfaces_=function(){return[zy]};yp.prototype.getClass=function(){return yp};var Ll=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Cs,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},u3={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Ll.prototype.bufferFixedPrecision=function(e){var n=new e0(new yp(new Is(1)),e.getScale()),r=new fu(this._bufParams);r.setWorkingPrecisionModel(e),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};Ll.prototype.bufferReducedPrecision=function(){var e=this;if(arguments.length===0){for(var n=Ll.MAX_PRECISION_DIGITS;n>=0;n--){try{e.bufferReducedPrecision(n)}catch(p){if(p instanceof Om)e._saveException=p;else throw p}finally{}if(e._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],s=Ll.precisionScaleFactor(this._argGeom,this._distance,r),u=new Is(s);this.bufferFixedPrecision(u)}};Ll.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===Is.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()};Ll.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)};Ll.prototype.bufferOriginalPrecision=function(){try{var e=new fu(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof Nm)this._saveException=n;else throw n}finally{}};Ll.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry};Ll.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)};Ll.prototype.interfaces_=function(){return[]};Ll.prototype.getClass=function(){return Ll};Ll.bufferOp=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new Ll(e),s=r.getResultGeometry(n);return s}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof mi&&typeof arguments[1]=="number"){var u=arguments[0],p=arguments[1],g=arguments[2],l=new Ll(u);l.setQuadrantSegments(g);var E=l.getResultGeometry(p);return E}else if(arguments[2]instanceof Cs&&arguments[0]instanceof mi&&typeof arguments[1]=="number"){var P=arguments[0],O=arguments[1],j=arguments[2],$=new Ll(P,j),Y=$.getResultGeometry(O);return Y}}else if(arguments.length===4){var re=arguments[0],_e=arguments[1],J=arguments[2],H=arguments[3],te=new Ll(re);te.setQuadrantSegments(J),te.setEndCapStyle(H);var ce=te.getResultGeometry(_e);return ce}};Ll.precisionScaleFactor=function(e,n,r){var s=e.getEnvelopeInternal(),u=Ic.max(Math.abs(s.getMaxX()),Math.abs(s.getMaxY()),Math.abs(s.getMinX()),Math.abs(s.getMinY())),p=n>0?n:0,g=u+2*p,l=Math.trunc(Math.log(g)/Math.log(10)+1),E=r-l,P=Math.pow(10,E);return P};u3.CAP_ROUND.get=function(){return Cs.CAP_ROUND};u3.CAP_BUTT.get=function(){return Cs.CAP_FLAT};u3.CAP_FLAT.get=function(){return Cs.CAP_FLAT};u3.CAP_SQUARE.get=function(){return Cs.CAP_SQUARE};u3.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(Ll,u3);var uu=function(){this._pt=[new Wt,new Wt],this._distance=Ai.NaN,this._isNull=!0};uu.prototype.getCoordinates=function(){return this._pt};uu.prototype.getCoordinate=function(e){return this._pt[e]};uu.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var s=n.distance(r);s<this._distance&&this.initialize(n,r,s)}};uu.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(n),this._distance=e.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(s),this._distance=u,this._isNull=!1}};uu.prototype.getDistance=function(){return this._distance};uu.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var s=n.distance(r);s>this._distance&&this.initialize(n,r,s)}};uu.prototype.interfaces_=function(){return[]};uu.prototype.getClass=function(){return uu};var tp=function(){};tp.prototype.interfaces_=function(){return[]};tp.prototype.getClass=function(){return tp};tp.computeDistance=function(){if(arguments[2]instanceof uu&&arguments[0]instanceof Jo&&arguments[1]instanceof Wt)for(var e=arguments[0],n=arguments[1],r=arguments[2],s=e.getCoordinates(),u=new ii,p=0;p<s.length-1;p++){u.setCoordinates(s[p],s[p+1]);var g=u.closestPoint(n);r.setMinimum(g,n)}else if(arguments[2]instanceof uu&&arguments[0]instanceof qa&&arguments[1]instanceof Wt){var l=arguments[0],E=arguments[1],P=arguments[2];tp.computeDistance(l.getExteriorRing(),E,P);for(var O=0;O<l.getNumInteriorRing();O++)tp.computeDistance(l.getInteriorRingN(O),E,P)}else if(arguments[2]instanceof uu&&arguments[0]instanceof mi&&arguments[1]instanceof Wt){var j=arguments[0],$=arguments[1],Y=arguments[2];if(j instanceof Jo)tp.computeDistance(j,$,Y);else if(j instanceof qa)tp.computeDistance(j,$,Y);else if(j instanceof pu)for(var re=j,_e=0;_e<re.getNumGeometries();_e++){var J=re.getGeometryN(_e);tp.computeDistance(J,$,Y)}else Y.setMinimum(j.getCoordinate(),$)}else if(arguments[2]instanceof uu&&arguments[0]instanceof ii&&arguments[1]instanceof Wt){var H=arguments[0],te=arguments[1],ce=arguments[2],Se=H.closestPoint(te);ce.setMinimum(Se,te)}};var Vy=function(e){this._maxPtDist=new uu,this._inputGeom=e||null},KI={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Vy.prototype.computeMaxMidpointDistance=function(e){var n=new t0(this._inputGeom);e.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};Vy.prototype.computeMaxVertexDistance=function(e){var n=new J1(this._inputGeom);e.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};Vy.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()};Vy.prototype.getDistancePoints=function(){return this._maxPtDist};Vy.prototype.interfaces_=function(){return[]};Vy.prototype.getClass=function(){return Vy};KI.MaxPointDistanceFilter.get=function(){return J1};KI.MaxMidpointDistanceFilter.get=function(){return t0};Object.defineProperties(Vy,KI);var J1=function(e){this._maxPtDist=new uu,this._minPtDist=new uu,this._geom=e||null};J1.prototype.filter=function(e){this._minPtDist.initialize(),tp.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};J1.prototype.getMaxPointDistance=function(){return this._maxPtDist};J1.prototype.interfaces_=function(){return[dp]};J1.prototype.getClass=function(){return J1};var t0=function(e){this._maxPtDist=new uu,this._minPtDist=new uu,this._geom=e||null};t0.prototype.filter=function(e,n){if(n===0)return null;var r=e.getCoordinate(n-1),s=e.getCoordinate(n),u=new Wt((r.x+s.x)/2,(r.y+s.y)/2);this._minPtDist.initialize(),tp.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};t0.prototype.isDone=function(){return!1};t0.prototype.isGeometryChanged=function(){return!1};t0.prototype.getMaxPointDistance=function(){return this._maxPtDist};t0.prototype.interfaces_=function(){return[od]};t0.prototype.getClass=function(){return t0};var Am=function(e){this._comps=e||null};Am.prototype.filter=function(e){e instanceof qa&&this._comps.add(e)};Am.prototype.interfaces_=function(){return[rf]};Am.prototype.getClass=function(){return Am};Am.getPolygons=function(){if(arguments.length===1){var e=arguments[0];return Am.getPolygons(e,new vr)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof qa?r.add(n):n instanceof pu&&n.apply(new Am(r)),r}};var Il=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var e=arguments[0];this._lines=e}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};Il.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof fp){var n=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(n),null}e instanceof Jo&&this._lines.add(e)};Il.prototype.setForceToLineString=function(e){this._isForcedToLineString=e};Il.prototype.interfaces_=function(){return[Dm]};Il.prototype.getClass=function(){return Il};Il.getGeometry=function(){if(arguments.length===1){var e=arguments[0];return e.getFactory().buildGeometry(Il.getLines(e))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(Il.getLines(n,r))}};Il.getLines=function(){if(arguments.length===1){var e=arguments[0];return Il.getLines(e,!1)}else if(arguments.length===2){if(_i(arguments[0],Ua)&&_i(arguments[1],Ua)){for(var n=arguments[0],r=arguments[1],s=n.iterator();s.hasNext();){var u=s.next();Il.getLines(u,r)}return r}else if(arguments[0]instanceof mi&&typeof arguments[1]=="boolean"){var p=arguments[0],g=arguments[1],l=new vr;return p.apply(new Il(l,g)),l}else if(arguments[0]instanceof mi&&_i(arguments[1],Ua)){var E=arguments[0],P=arguments[1];return E instanceof Jo?P.add(E):E.apply(new Il(P)),P}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&_i(arguments[0],Ua)&&_i(arguments[1],Ua)){for(var O=arguments[0],j=arguments[1],$=arguments[2],Y=O.iterator();Y.hasNext();){var re=Y.next();Il.getLines(re,j,$)}return j}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof mi&&_i(arguments[1],Ua)){var _e=arguments[0],J=arguments[1],H=arguments[2];return _e.apply(new Il(J,H)),J}}};var cd=function(){if(this._boundaryRule=xh.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];if(e===null)throw new Po("Rule must be non-null");this._boundaryRule=e}}};cd.prototype.locateInternal=function(){var e=this;if(arguments[0]instanceof Wt&&arguments[1]instanceof qa){var n=arguments[0],r=arguments[1];if(r.isEmpty())return tn.EXTERIOR;var s=r.getExteriorRing(),u=this.locateInPolygonRing(n,s);if(u===tn.EXTERIOR)return tn.EXTERIOR;if(u===tn.BOUNDARY)return tn.BOUNDARY;for(var p=0;p<r.getNumInteriorRing();p++){var g=r.getInteriorRingN(p),l=e.locateInPolygonRing(n,g);if(l===tn.INTERIOR)return tn.EXTERIOR;if(l===tn.BOUNDARY)return tn.BOUNDARY}return tn.INTERIOR}else if(arguments[0]instanceof Wt&&arguments[1]instanceof Jo){var E=arguments[0],P=arguments[1];if(!P.getEnvelopeInternal().intersects(E))return tn.EXTERIOR;var O=P.getCoordinates();return!P.isClosed()&&(E.equals(O[0])||E.equals(O[O.length-1]))?tn.BOUNDARY:kr.isOnLine(E,O)?tn.INTERIOR:tn.EXTERIOR}else if(arguments[0]instanceof Wt&&arguments[1]instanceof ac){var j=arguments[0],$=arguments[1],Y=$.getCoordinate();return Y.equals2D(j)?tn.INTERIOR:tn.EXTERIOR}};cd.prototype.locateInPolygonRing=function(e,n){return n.getEnvelopeInternal().intersects(e)?kr.locatePointInRing(e,n.getCoordinates()):tn.EXTERIOR};cd.prototype.intersects=function(e,n){return this.locate(e,n)!==tn.EXTERIOR};cd.prototype.updateLocationInfo=function(e){e===tn.INTERIOR&&(this._isIn=!0),e===tn.BOUNDARY&&this._numBoundaries++};cd.prototype.computeLocation=function(e,n){var r=this;if(n instanceof ac&&this.updateLocationInfo(this.locateInternal(e,n)),n instanceof Jo)this.updateLocationInfo(this.locateInternal(e,n));else if(n instanceof qa)this.updateLocationInfo(this.locateInternal(e,n));else if(n instanceof Fy)for(var s=n,u=0;u<s.getNumGeometries();u++){var p=s.getGeometryN(u);r.updateLocationInfo(r.locateInternal(e,p))}else if(n instanceof op)for(var g=n,l=0;l<g.getNumGeometries();l++){var E=g.getGeometryN(l);r.updateLocationInfo(r.locateInternal(e,E))}else if(n instanceof pu)for(var P=new ap(n);P.hasNext();){var O=P.next();O!==n&&r.computeLocation(e,O)}};cd.prototype.locate=function(e,n){return n.isEmpty()?tn.EXTERIOR:n instanceof Jo?this.locateInternal(e,n):n instanceof qa?this.locateInternal(e,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,n),this._boundaryRule.isInBoundary(this._numBoundaries)?tn.BOUNDARY:this._numBoundaries>0||this._isIn?tn.INTERIOR:tn.EXTERIOR)};cd.prototype.interfaces_=function(){return[]};cd.prototype.getClass=function(){return cd};var cu=function t(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this._component=r,this._segIndex=s,this._pt=u}},EG={INSIDE_AREA:{configurable:!0}};cu.prototype.isInsideArea=function(){return this._segIndex===cu.INSIDE_AREA};cu.prototype.getCoordinate=function(){return this._pt};cu.prototype.getGeometryComponent=function(){return this._component};cu.prototype.getSegmentIndex=function(){return this._segIndex};cu.prototype.interfaces_=function(){return[]};cu.prototype.getClass=function(){return cu};EG.INSIDE_AREA.get=function(){return-1};Object.defineProperties(cu,EG);var Bg=function(e){this._pts=e||null};Bg.prototype.filter=function(e){e instanceof ac&&this._pts.add(e)};Bg.prototype.interfaces_=function(){return[rf]};Bg.prototype.getClass=function(){return Bg};Bg.getPoints=function(){if(arguments.length===1){var e=arguments[0];return e instanceof ac?ld.singletonList(e):Bg.getPoints(e,new vr)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof ac?r.add(n):n instanceof pu&&n.apply(new Bg(r)),r}};var Q1=function(){this._locations=null;var e=arguments[0];this._locations=e};Q1.prototype.filter=function(e){(e instanceof ac||e instanceof Jo||e instanceof qa)&&this._locations.add(new cu(e,0,e.getCoordinate()))};Q1.prototype.interfaces_=function(){return[rf]};Q1.prototype.getClass=function(){return Q1};Q1.getLocations=function(e){var n=new vr;return e.apply(new Q1(n)),n};var Nl=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new cd,this._minDistanceLocation=null,this._minDistance=Ai.MAX_VALUE,arguments.length===2){var e=arguments[0],n=arguments[1];this._geom=[e,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=s,this._terminateDistance=u}};Nl.prototype.computeContainmentDistance=function(){var e=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],s=arguments[1],u=1-r,p=Am.getPolygons(this._geom[r]);if(p.size()>0){var g=Q1.getLocations(this._geom[u]);if(this.computeContainmentDistance(g,p,s),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[u]=s[0],this._minDistanceLocation[r]=s[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&_i(arguments[0],ed)&&_i(arguments[1],ed)){for(var l=arguments[0],E=arguments[1],P=arguments[2],O=0;O<l.size();O++)for(var j=l.get(O),$=0;$<E.size();$++)if(e.computeContainmentDistance(j,E.get($),P),e._minDistance<=e._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof cu&&arguments[1]instanceof qa){var Y=arguments[0],re=arguments[1],_e=arguments[2],J=Y.getCoordinate();if(tn.EXTERIOR!==this._ptLocator.locate(J,re))return this._minDistance=0,_e[0]=Y,_e[1]=new cu(re,J),null}}};Nl.prototype.computeMinDistanceLinesPoints=function(e,n,r){for(var s=this,u=0;u<e.size();u++)for(var p=e.get(u),g=0;g<n.size();g++){var l=n.get(g);if(s.computeMinDistance(p,l,r),s._minDistance<=s._terminateDistance)return null}};Nl.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),n=Il.getLines(this._geom[0]),r=Il.getLines(this._geom[1]),s=Bg.getPoints(this._geom[0]),u=Bg.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(n,u,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance)||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(r,s,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance))return null;e[0]=null,e[1]=null,this.computeMinDistancePoints(s,u,e),this.updateMinDistance(e,!1)};Nl.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};Nl.prototype.updateMinDistance=function(e,n){if(e[0]===null)return null;n?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])};Nl.prototype.nearestPoints=function(){this.computeMinDistance();var e=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return e};Nl.prototype.computeMinDistance=function(){var e=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Jo&&arguments[1]instanceof ac){var n=arguments[0],r=arguments[1],s=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var u=n.getCoordinates(),p=r.getCoordinate(),g=0;g<u.length-1;g++){var l=kr.distancePointLine(p,u[g],u[g+1]);if(l<e._minDistance){e._minDistance=l;var E=new ii(u[g],u[g+1]),P=E.closestPoint(p);s[0]=new cu(n,g,P),s[1]=new cu(r,0,p)}if(e._minDistance<=e._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Jo&&arguments[1]instanceof Jo){var O=arguments[0],j=arguments[1],$=arguments[2];if(O.getEnvelopeInternal().distance(j.getEnvelopeInternal())>this._minDistance)return null;for(var Y=O.getCoordinates(),re=j.getCoordinates(),_e=0;_e<Y.length-1;_e++)for(var J=0;J<re.length-1;J++){var H=kr.distanceLineLine(Y[_e],Y[_e+1],re[J],re[J+1]);if(H<e._minDistance){e._minDistance=H;var te=new ii(Y[_e],Y[_e+1]),ce=new ii(re[J],re[J+1]),Se=te.closestPoints(ce);$[0]=new cu(O,_e,Se[0]),$[1]=new cu(j,J,Se[1])}if(e._minDistance<=e._terminateDistance)return null}}}};Nl.prototype.computeMinDistancePoints=function(e,n,r){for(var s=this,u=0;u<e.size();u++)for(var p=e.get(u),g=0;g<n.size();g++){var l=n.get(g),E=p.getCoordinate().distance(l.getCoordinate());if(E<s._minDistance&&(s._minDistance=E,r[0]=new cu(p,0,p.getCoordinate()),r[1]=new cu(l,0,l.getCoordinate())),s._minDistance<=s._terminateDistance)return null}};Nl.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Po("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};Nl.prototype.computeMinDistanceLines=function(e,n,r){for(var s=this,u=0;u<e.size();u++)for(var p=e.get(u),g=0;g<n.size();g++){var l=n.get(g);if(s.computeMinDistance(p,l,r),s._minDistance<=s._terminateDistance)return null}};Nl.prototype.interfaces_=function(){return[]};Nl.prototype.getClass=function(){return Nl};Nl.distance=function(e,n){var r=new Nl(e,n);return r.distance()};Nl.isWithinDistance=function(e,n,r){var s=new Nl(e,n,r);return s.distance()<=r};Nl.nearestPoints=function(e,n){var r=new Nl(e,n);return r.nearestPoints()};var Kl=function(){this._pt=[new Wt,new Wt],this._distance=Ai.NaN,this._isNull=!0};Kl.prototype.getCoordinates=function(){return this._pt};Kl.prototype.getCoordinate=function(e){return this._pt[e]};Kl.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var s=n.distance(r);s<this._distance&&this.initialize(n,r,s)}};Kl.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(n),this._distance=e.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(s),this._distance=u,this._isNull=!1}};Kl.prototype.toString=function(){return sd.toLineString(this._pt[0],this._pt[1])};Kl.prototype.getDistance=function(){return this._distance};Kl.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var s=n.distance(r);s>this._distance&&this.initialize(n,r,s)}};Kl.prototype.interfaces_=function(){return[]};Kl.prototype.getClass=function(){return Kl};var $d=function(){};$d.prototype.interfaces_=function(){return[]};$d.prototype.getClass=function(){return $d};$d.computeDistance=function(){if(arguments[2]instanceof Kl&&arguments[0]instanceof Jo&&arguments[1]instanceof Wt)for(var e=arguments[0],n=arguments[1],r=arguments[2],s=new ii,u=e.getCoordinates(),p=0;p<u.length-1;p++){s.setCoordinates(u[p],u[p+1]);var g=s.closestPoint(n);r.setMinimum(g,n)}else if(arguments[2]instanceof Kl&&arguments[0]instanceof qa&&arguments[1]instanceof Wt){var l=arguments[0],E=arguments[1],P=arguments[2];$d.computeDistance(l.getExteriorRing(),E,P);for(var O=0;O<l.getNumInteriorRing();O++)$d.computeDistance(l.getInteriorRingN(O),E,P)}else if(arguments[2]instanceof Kl&&arguments[0]instanceof mi&&arguments[1]instanceof Wt){var j=arguments[0],$=arguments[1],Y=arguments[2];if(j instanceof Jo)$d.computeDistance(j,$,Y);else if(j instanceof qa)$d.computeDistance(j,$,Y);else if(j instanceof pu)for(var re=j,_e=0;_e<re.getNumGeometries();_e++){var J=re.getGeometryN(_e);$d.computeDistance(J,$,Y)}else Y.setMinimum(j.getCoordinate(),$)}else if(arguments[2]instanceof Kl&&arguments[0]instanceof ii&&arguments[1]instanceof Wt){var H=arguments[0],te=arguments[1],ce=arguments[2],Se=H.closestPoint(te);ce.setMinimum(Se,te)}};var _h=function(){this._g0=null,this._g1=null,this._ptDist=new Kl,this._densifyFrac=0;var e=arguments[0],n=arguments[1];this._g0=e,this._g1=n},JI={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};_h.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};_h.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new Po("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e};_h.prototype.compute=function(e,n){this.computeOrientedDistance(e,n,this._ptDist),this.computeOrientedDistance(n,e,this._ptDist)};_h.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};_h.prototype.computeOrientedDistance=function(e,n,r){var s=new ev(n);if(e.apply(s),r.setMaximum(s.getMaxPointDistance()),this._densifyFrac>0){var u=new n0(n,this._densifyFrac);e.apply(u),r.setMaximum(u.getMaxPointDistance())}};_h.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};_h.prototype.interfaces_=function(){return[]};_h.prototype.getClass=function(){return _h};_h.distance=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new _h(e,n);return r.distance()}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2],g=new _h(s,u);return g.setDensifyFraction(p),g.distance()}};JI.MaxPointDistanceFilter.get=function(){return ev};JI.MaxDensifiedByFractionDistanceFilter.get=function(){return n0};Object.defineProperties(_h,JI);var ev=function(){this._maxPtDist=new Kl,this._minPtDist=new Kl,this._euclideanDist=new $d,this._geom=null;var e=arguments[0];this._geom=e};ev.prototype.filter=function(e){this._minPtDist.initialize(),$d.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};ev.prototype.getMaxPointDistance=function(){return this._maxPtDist};ev.prototype.interfaces_=function(){return[dp]};ev.prototype.getClass=function(){return ev};var n0=function(){this._maxPtDist=new Kl,this._minPtDist=new Kl,this._geom=null,this._numSubSegs=0;var e=arguments[0],n=arguments[1];this._geom=e,this._numSubSegs=Math.trunc(Math.round(1/n))};n0.prototype.filter=function(e,n){var r=this;if(n===0)return null;for(var s=e.getCoordinate(n-1),u=e.getCoordinate(n),p=(u.x-s.x)/this._numSubSegs,g=(u.y-s.y)/this._numSubSegs,l=0;l<this._numSubSegs;l++){var E=s.x+l*p,P=s.y+l*g,O=new Wt(E,P);r._minPtDist.initialize(),$d.computeDistance(r._geom,O,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};n0.prototype.isDone=function(){return!1};n0.prototype.isGeometryChanged=function(){return!1};n0.prototype.getMaxPointDistance=function(){return this._maxPtDist};n0.prototype.interfaces_=function(){return[od]};n0.prototype.getClass=function(){return n0};var ic=function(e,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=n||null,this._result=r||null},QI={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ic.prototype.checkMaximumDistance=function(e,n,r){var s=new _h(n,e);if(s.setDensifyFraction(.25),this._maxDistanceFound=s.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var u=s.getCoordinates();this._errorLocation=u[1],this._errorIndicator=e.getFactory().createLineString(u),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+sd.toLineString(u[0],u[1])+")"}};ic.prototype.isValid=function(){var e=Math.abs(this._bufDistance),n=ic.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-n,this._maxValidDistance=e+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ic.VERBOSE&&Rl.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};ic.prototype.checkNegativeValid=function(){if(!(this._input instanceof qa||this._input instanceof op||this._input instanceof pu))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)};ic.prototype.getErrorIndicator=function(){return this._errorIndicator};ic.prototype.checkMinimumDistance=function(e,n,r){var s=new Nl(e,n,r);if(this._minDistanceFound=s.distance(),this._minDistanceFound<r){this._isValid=!1;var u=s.nearestPoints();this._errorLocation=s.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(u),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+sd.toLineString(u[0],u[1])+" )"}};ic.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)};ic.prototype.getErrorLocation=function(){return this._errorLocation};ic.prototype.getPolygonLines=function(e){for(var n=new vr,r=new Il(n),s=Am.getPolygons(e),u=s.iterator();u.hasNext();){var p=u.next();p.apply(r)}return e.getFactory().buildGeometry(n)};ic.prototype.getErrorMessage=function(){return this._errMsg};ic.prototype.interfaces_=function(){return[]};ic.prototype.getClass=function(){return ic};QI.VERBOSE.get=function(){return!1};QI.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(ic,QI);var Dl=function(e,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=n||null,this._result=r||null},eA={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Dl.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};Dl.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*Dl.MAX_ENV_DIFF_FRAC;e===0&&(e=.001);var n=new ni(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new ni(this._result.getEnvelopeInternal());r.expandBy(e),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};Dl.prototype.checkDistance=function(){var e=new ic(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")};Dl.prototype.checkArea=function(){var e=this._input.getArea(),n=this._result.getArea();this._distance>0&&e>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};Dl.prototype.checkPolygonal=function(){this._result instanceof qa||this._result instanceof op||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};Dl.prototype.getErrorIndicator=function(){return this._errorIndicator};Dl.prototype.getErrorLocation=function(){return this._errorLocation};Dl.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};Dl.prototype.report=function(e){if(!Dl.VERBOSE)return null;Rl.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))};Dl.prototype.getErrorMessage=function(){return this._errorMsg};Dl.prototype.interfaces_=function(){return[]};Dl.prototype.getClass=function(){return Dl};Dl.isValidMsg=function(e,n,r){var s=new Dl(e,n,r);return s.isValid()?null:s.getErrorMessage()};Dl.isValid=function(e,n,r){var s=new Dl(e,n,r);return!!s.isValid()};eA.VERBOSE.get=function(){return!1};eA.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Dl,eA);var cf=function(){this._pts=null,this._data=null;var e=arguments[0],n=arguments[1];this._pts=e,this._data=n};cf.prototype.getCoordinates=function(){return this._pts};cf.prototype.size=function(){return this._pts.length};cf.prototype.getCoordinate=function(e){return this._pts[e]};cf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};cf.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:Z1.octant(this.getCoordinate(e),this.getCoordinate(e+1))};cf.prototype.setData=function(e){this._data=e};cf.prototype.getData=function(){return this._data};cf.prototype.toString=function(){return sd.toLineString(new ca(this._pts))};cf.prototype.interfaces_=function(){return[mp]};cf.prototype.getClass=function(){return cf};var ml=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new vr,this._intersectionCount=0,this._keepIntersections=!0;var e=arguments[0];this._li=e,this._interiorIntersection=null};ml.prototype.getInteriorIntersection=function(){return this._interiorIntersection};ml.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e};ml.prototype.getIntersectionSegments=function(){return this._intSegments};ml.prototype.count=function(){return this._intersectionCount};ml.prototype.getIntersections=function(){return this._intersections};ml.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};ml.prototype.setKeepIntersections=function(e){this._keepIntersections=e};ml.prototype.processIntersections=function(e,n,r,s){if(!this._findAllIntersections&&this.hasIntersection()||e===r&&n===s)return null;if(this._isCheckEndSegmentsOnly){var u=this.isEndSegment(e,n)||this.isEndSegment(r,s);if(!u)return null}var p=e.getCoordinates()[n],g=e.getCoordinates()[n+1],l=r.getCoordinates()[s],E=r.getCoordinates()[s+1];this._li.computeIntersection(p,g,l,E),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=p,this._intSegments[1]=g,this._intSegments[2]=l,this._intSegments[3]=E,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};ml.prototype.isEndSegment=function(e,n){return n===0||n>=e.size()-2};ml.prototype.hasIntersection=function(){return this._interiorIntersection!==null};ml.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};ml.prototype.interfaces_=function(){return[Uy]};ml.prototype.getClass=function(){return ml};ml.createAllIntersectionsFinder=function(e){var n=new ml(e);return n.setFindAllIntersections(!0),n};ml.createAnyIntersectionFinder=function(e){return new ml(e)};ml.createIntersectionCounter=function(e){var n=new ml(e);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var hd=function(){this._li=new t_,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=arguments[0];this._segStrings=e};hd.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};hd.prototype.getIntersections=function(){return this._segInt.getIntersections()};hd.prototype.isValid=function(){return this.execute(),this._isValid};hd.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};hd.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new ml(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new YI;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};hd.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Om(this.getErrorMessage(),this._segInt.getInteriorIntersection())};hd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+sd.toLineString(e[0],e[1])+" and "+sd.toLineString(e[2],e[3])};hd.prototype.interfaces_=function(){return[]};hd.prototype.getClass=function(){return hd};hd.computeIntersections=function(e){var n=new hd(e);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var Gy=function t(){this._nv=null;var e=arguments[0];this._nv=new hd(t.toSegmentStrings(e))};Gy.prototype.checkValid=function(){this._nv.checkValid()};Gy.prototype.interfaces_=function(){return[]};Gy.prototype.getClass=function(){return Gy};Gy.toSegmentStrings=function(e){for(var n=new vr,r=e.iterator();r.hasNext();){var s=r.next();n.add(new cf(s.getCoordinates(),s))}return n};Gy.checkValid=function(e){var n=new Gy(e);n.checkValid()};var tv=function(e){this._mapOp=e};tv.prototype.map=function(e){for(var n=this,r=new vr,s=0;s<e.getNumGeometries();s++){var u=n._mapOp.map(e.getGeometryN(s));u.isEmpty()||r.add(u)}return e.getFactory().createGeometryCollection(Ji.toGeometryArray(r))};tv.prototype.interfaces_=function(){return[]};tv.prototype.getClass=function(){return tv};tv.map=function(e,n){var r=new tv(n);return r.map(e)};var hf=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new vr,this._resultLineList=new vr;var e=arguments[0],n=arguments[1],r=arguments[2];this._op=e,this._geometryFactory=n,this._ptLocator=r};hf.prototype.collectLines=function(e){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var s=r.next();n.collectLineEdge(s,e,n._lineEdgesList),n.collectBoundaryTouchEdge(s,e,n._lineEdgesList)}};hf.prototype.labelIsolatedLine=function(e,n){var r=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(n));e.getLabel().setLocation(n,r)};hf.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList};hf.prototype.collectLineEdge=function(e,n,r){var s=e.getLabel(),u=e.getEdge();e.isLineEdge()&&!e.isVisited()&&Ui.isResultOfOp(s,n)&&!u.isCovered()&&(r.add(u),e.setVisitedEdge(!0))};hf.prototype.findCoveredLineEdges=function(){for(var e=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var s=this._op.getGraph().getEdgeEnds().iterator();s.hasNext();){var u=s.next(),p=u.getEdge();if(u.isLineEdge()&&!p.isCoveredSet()){var g=e._op.isCoveredByA(u.getCoordinate());p.setCovered(g)}}};hf.prototype.labelIsolatedLines=function(e){for(var n=this,r=e.iterator();r.hasNext();){var s=r.next(),u=s.getLabel();s.isIsolated()&&(u.isNull(0)?n.labelIsolatedLine(s,0):n.labelIsolatedLine(s,1))}};hf.prototype.buildLines=function(e){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var s=r.next(),u=n._geometryFactory.createLineString(s.getCoordinates());n._resultLineList.add(u),s.setInResult(!0)}};hf.prototype.collectBoundaryTouchEdge=function(e,n,r){var s=e.getLabel();if(e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult())return null;Vi.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),Ui.isResultOfOp(s,n)&&n===Ui.INTERSECTION&&(r.add(e.getEdge()),e.setVisitedEdge(!0))};hf.prototype.interfaces_=function(){return[]};hf.prototype.getClass=function(){return hf};var nv=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new vr;var e=arguments[0],n=arguments[1];this._op=e,this._geometryFactory=n};nv.prototype.filterCoveredNodeToPoint=function(e){var n=e.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};nv.prototype.extractNonCoveredResultNodes=function(e){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var s=r.next();if(!s.isInResult()&&!s.isIncidentEdgeInResult()&&(s.getEdges().getDegree()===0||e===Ui.INTERSECTION)){var u=s.getLabel();Ui.isResultOfOp(u,e)&&n.filterCoveredNodeToPoint(s)}}};nv.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList};nv.prototype.interfaces_=function(){return[]};nv.prototype.getClass=function(){return nv};var Uu=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Uu.prototype.transformPoint=function(e,n){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))};Uu.prototype.transformPolygon=function(e,n){var r=this,s=!0,u=this.transformLinearRing(e.getExteriorRing(),e);(u===null||!(u instanceof fp)||u.isEmpty())&&(s=!1);for(var p=new vr,g=0;g<e.getNumInteriorRing();g++){var l=r.transformLinearRing(e.getInteriorRingN(g),e);l===null||l.isEmpty()||(l instanceof fp||(s=!1),p.add(l))}if(s)return this._factory.createPolygon(u,p.toArray([]));var E=new vr;return u!==null&&E.add(u),E.addAll(p),this._factory.buildGeometry(E)};Uu.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)};Uu.prototype.getInputGeometry=function(){return this._inputGeom};Uu.prototype.transformMultiLineString=function(e,n){for(var r=this,s=new vr,u=0;u<e.getNumGeometries();u++){var p=r.transformLineString(e.getGeometryN(u),e);p!==null&&(p.isEmpty()||s.add(p))}return this._factory.buildGeometry(s)};Uu.prototype.transformCoordinates=function(e,n){return this.copy(e)};Uu.prototype.transformLineString=function(e,n){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))};Uu.prototype.transformMultiPoint=function(e,n){for(var r=this,s=new vr,u=0;u<e.getNumGeometries();u++){var p=r.transformPoint(e.getGeometryN(u),e);p!==null&&(p.isEmpty()||s.add(p))}return this._factory.buildGeometry(s)};Uu.prototype.transformMultiPolygon=function(e,n){for(var r=this,s=new vr,u=0;u<e.getNumGeometries();u++){var p=r.transformPolygon(e.getGeometryN(u),e);p!==null&&(p.isEmpty()||s.add(p))}return this._factory.buildGeometry(s)};Uu.prototype.copy=function(e){return e.copy()};Uu.prototype.transformGeometryCollection=function(e,n){for(var r=this,s=new vr,u=0;u<e.getNumGeometries();u++){var p=r.transform(e.getGeometryN(u));p!==null&&(r._pruneEmptyGeometry&&p.isEmpty()||s.add(p))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Ji.toGeometryArray(s)):this._factory.buildGeometry(s)};Uu.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof ac)return this.transformPoint(e,null);if(e instanceof Sb)return this.transformMultiPoint(e,null);if(e instanceof fp)return this.transformLinearRing(e,null);if(e instanceof Jo)return this.transformLineString(e,null);if(e instanceof Fy)return this.transformMultiLineString(e,null);if(e instanceof qa)return this.transformPolygon(e,null);if(e instanceof op)return this.transformMultiPolygon(e,null);if(e instanceof pu)return this.transformGeometryCollection(e,null);throw new Po("Unknown Geometry subtype: "+e.getClass().getName())};Uu.prototype.transformLinearRing=function(e,n){var r=this.transformCoordinates(e.getCoordinateSequence(),e);if(r===null)return this._factory.createLinearRing(null);var s=r.size();return s>0&&s<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};Uu.prototype.interfaces_=function(){return[]};Uu.prototype.getClass=function(){return Uu};var _p=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ii,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Jo&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],s=arguments[1];this._srcPts=r,this._isClosed=t.isClosed(r),this._snapTolerance=s}};_p.prototype.snapVertices=function(e,n){for(var r=this,s=this._isClosed?e.size()-1:e.size(),u=0;u<s;u++){var p=e.get(u),g=r.findSnapForVertex(p,n);g!==null&&(e.set(u,new Wt(g)),u===0&&r._isClosed&&e.set(e.size()-1,new Wt(g)))}};_p.prototype.findSnapForVertex=function(e,n){for(var r=this,s=0;s<n.length;s++){if(e.equals2D(n[s]))return null;if(e.distance(n[s])<r._snapTolerance)return n[s]}return null};_p.prototype.snapTo=function(e){var n=new I9(this._srcPts);this.snapVertices(n,e),this.snapSegments(n,e);var r=n.toCoordinateArray();return r};_p.prototype.snapSegments=function(e,n){var r=this;if(n.length===0)return null;var s=n.length;n[0].equals2D(n[n.length-1])&&(s=n.length-1);for(var u=0;u<s;u++){var p=n[u],g=r.findSegmentIndexToSnap(p,e);g>=0&&e.add(g+1,new Wt(p),!1)}};_p.prototype.findSegmentIndexToSnap=function(e,n){for(var r=this,s=Ai.MAX_VALUE,u=-1,p=0;p<n.size()-1;p++){if(r._seg.p0=n.get(p),r._seg.p1=n.get(p+1),r._seg.p0.equals2D(e)||r._seg.p1.equals2D(e)){if(r._allowSnappingToSourceVertices)continue;return-1}var g=r._seg.distance(e);g<r._snapTolerance&&g<s&&(s=g,u=p)}return u};_p.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e};_p.prototype.interfaces_=function(){return[]};_p.prototype.getClass=function(){return _p};_p.isClosed=function(e){return e.length<=1?!1:e[0].equals2D(e[e.length-1])};var ha=function(e){this._srcGeom=e||null},SG={SNAP_PRECISION_FACTOR:{configurable:!0}};ha.prototype.snapTo=function(e,n){var r=this.extractTargetCoordinates(e),s=new TG(n,r);return s.transform(this._srcGeom)};ha.prototype.snapToSelf=function(e,n){var r=this.extractTargetCoordinates(this._srcGeom),s=new TG(e,r,!0),u=s.transform(this._srcGeom),p=u;return n&&_i(p,Yg)&&(p=u.buffer(0)),p};ha.prototype.computeSnapTolerance=function(e){var n=this.computeMinimumSegmentLength(e),r=n/10;return r};ha.prototype.extractTargetCoordinates=function(e){for(var n=new nf,r=e.getCoordinates(),s=0;s<r.length;s++)n.add(r[s]);return n.toArray(new Array(0).fill(null))};ha.prototype.computeMinimumSegmentLength=function(e){for(var n=Ai.MAX_VALUE,r=0;r<e.length-1;r++){var s=e[r].distance(e[r+1]);s<n&&(n=s)}return n};ha.prototype.interfaces_=function(){return[]};ha.prototype.getClass=function(){return ha};ha.snap=function(e,n,r){var s=new Array(2).fill(null),u=new ha(e);s[0]=u.snapTo(n,r);var p=new ha(n);return s[1]=p.snapTo(s[0],r),s};ha.computeOverlaySnapTolerance=function(){if(arguments.length===1){var e=arguments[0],n=ha.computeSizeBasedSnapTolerance(e),r=e.getPrecisionModel();if(r.getType()===Is.FIXED){var s=1/r.getScale()*2/1.415;s>n&&(n=s)}return n}else if(arguments.length===2){var u=arguments[0],p=arguments[1];return Math.min(ha.computeOverlaySnapTolerance(u),ha.computeOverlaySnapTolerance(p))}};ha.computeSizeBasedSnapTolerance=function(e){var n=e.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),s=r*ha.SNAP_PRECISION_FACTOR;return s};ha.snapToSelf=function(e,n,r){var s=new ha(e);return s.snapToSelf(n,r)};SG.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(ha,SG);var TG=function(t){function e(n,r,s){t.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=s!==void 0?s:!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(r,s){var u=new _p(r,this._snapTolerance);return u.setAllowSnappingToSourceVertices(this._isSelfSnap),u.snapTo(s)},e.prototype.transformCoordinates=function(r,s){var u=r.toCoordinateArray(),p=this.snapLine(u,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(p)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Uu),lu=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};lu.prototype.getCommon=function(){return Ai.longBitsToDouble(this._commonBits)};lu.prototype.add=function(e){var n=Ai.doubleToLongBits(e);if(this._isFirst)return this._commonBits=n,this._commonSignExp=lu.signExpBits(this._commonBits),this._isFirst=!1,null;var r=lu.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=lu.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=lu.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};lu.prototype.toString=function(){if(arguments.length===1){var e=arguments[0],n=Ai.longBitsToDouble(e),r=Ai.toBinaryString(e),s="0000000000000000000000000000000000000000000000000000000000000000"+r,u=s.substring(s.length-64),p=u.substring(0,1)+"  "+u.substring(1,12)+"(exp) "+u.substring(12)+" [ "+n+" ]";return p}};lu.prototype.interfaces_=function(){return[]};lu.prototype.getClass=function(){return lu};lu.getBit=function(e,n){var r=1<<n;return e&r?1:0};lu.signExpBits=function(e){return e>>52};lu.zeroLowerBits=function(e,n){var r=(1<<n)-1,s=~r,u=e&s;return u};lu.numCommonMostSigMantissaBits=function(e,n){for(var r=0,s=52;s>=0;s--){if(lu.getBit(e,s)!==lu.getBit(n,s))return r;r++}return 52};var r0=function(){this._commonCoord=null,this._ccFilter=new rv},tA={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};r0.prototype.addCommonBits=function(e){var n=new i0(this._commonCoord);e.apply(n),e.geometryChanged()};r0.prototype.removeCommonBits=function(e){if(this._commonCoord.x===0&&this._commonCoord.y===0)return e;var n=new Wt(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new i0(n);return e.apply(r),e.geometryChanged(),e};r0.prototype.getCommonCoordinate=function(){return this._commonCoord};r0.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};r0.prototype.interfaces_=function(){return[]};r0.prototype.getClass=function(){return r0};tA.CommonCoordinateFilter.get=function(){return rv};tA.Translater.get=function(){return i0};Object.defineProperties(r0,tA);var rv=function(){this._commonBitsX=new lu,this._commonBitsY=new lu};rv.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)};rv.prototype.getCommonCoordinate=function(){return new Wt(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};rv.prototype.interfaces_=function(){return[dp]};rv.prototype.getClass=function(){return rv};var i0=function(){this.trans=null;var e=arguments[0];this.trans=e};i0.prototype.filter=function(e,n){var r=e.getOrdinate(n,0)+this.trans.x,s=e.getOrdinate(n,1)+this.trans.y;e.setOrdinate(n,0,r),e.setOrdinate(n,1,s)};i0.prototype.isDone=function(){return!1};i0.prototype.isGeometryChanged=function(){return!0};i0.prototype.interfaces_=function(){return[od]};i0.prototype.getClass=function(){return i0};var gl=function(e,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=n,this.computeSnapTolerance()};gl.prototype.selfSnap=function(e){var n=new ha(e),r=n.snapTo(e,this._snapTolerance);return r};gl.prototype.removeCommonBits=function(e){this._cbr=new r0,this._cbr.add(e[0]),this._cbr.add(e[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(e[0].copy()),n[1]=this._cbr.removeCommonBits(e[1].copy()),n};gl.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e};gl.prototype.getResultGeometry=function(e){var n=this.snap(this._geom),r=Ui.overlayOp(n[0],n[1],e);return this.prepareResult(r)};gl.prototype.checkValid=function(e){e.isValid()||Rl.out.println("Snapped geometry is invalid")};gl.prototype.computeSnapTolerance=function(){this._snapTolerance=ha.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};gl.prototype.snap=function(e){var n=this.removeCommonBits(e),r=ha.snap(n[0],n[1],this._snapTolerance);return r};gl.prototype.interfaces_=function(){return[]};gl.prototype.getClass=function(){return gl};gl.overlayOp=function(e,n,r){var s=new gl(e,n);return s.getResultGeometry(r)};gl.union=function(e,n){return gl.overlayOp(e,n,Ui.UNION)};gl.intersection=function(e,n){return gl.overlayOp(e,n,Ui.INTERSECTION)};gl.symDifference=function(e,n){return gl.overlayOp(e,n,Ui.SYMDIFFERENCE)};gl.difference=function(e,n){return gl.overlayOp(e,n,Ui.DIFFERENCE)};var yu=function(e,n){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=n};yu.prototype.getResultGeometry=function(e){var n=null,r=!1,s=null;try{n=Ui.overlayOp(this._geom[0],this._geom[1],e);var u=!0;u&&(r=!0)}catch(p){if(p instanceof Nm)s=p;else throw p}finally{}if(!r)try{n=gl.overlayOp(this._geom[0],this._geom[1],e)}catch(p){throw p instanceof Nm?s:p}finally{}return n};yu.prototype.interfaces_=function(){return[]};yu.prototype.getClass=function(){return yu};yu.overlayOp=function(e,n,r){var s=new yu(e,n);return s.getResultGeometry(r)};yu.union=function(e,n){return yu.overlayOp(e,n,Ui.UNION)};yu.intersection=function(e,n){return yu.overlayOp(e,n,Ui.INTERSECTION)};yu.symDifference=function(e,n){return yu.overlayOp(e,n,Ui.SYMDIFFERENCE)};yu.difference=function(e,n){return yu.overlayOp(e,n,Ui.DIFFERENCE)};var e9=function(){this.mce=null,this.chainIndex=null;var e=arguments[0],n=arguments[1];this.mce=e,this.chainIndex=n};e9.prototype.computeIntersections=function(e,n){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,n)};e9.prototype.interfaces_=function(){return[]};e9.prototype.getClass=function(){return e9};var cc=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=s,this._obj=u}},nA={INSERT:{configurable:!0},DELETE:{configurable:!0}};cc.prototype.isDelete=function(){return this._eventType===cc.DELETE};cc.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e};cc.prototype.getObject=function(){return this._obj};cc.prototype.compareTo=function(e){var n=e;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};cc.prototype.getInsertEvent=function(){return this._insertEvent};cc.prototype.isInsert=function(){return this._eventType===cc.INSERT};cc.prototype.isSameLabel=function(e){return this._label===null?!1:this._label===e._label};cc.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};cc.prototype.interfaces_=function(){return[Eh]};cc.prototype.getClass=function(){return cc};nA.INSERT.get=function(){return 1};nA.DELETE.get=function(){return 2};Object.defineProperties(cc,nA);var RS=function(){};RS.prototype.interfaces_=function(){return[]};RS.prototype.getClass=function(){return RS};var Ol=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._li=e,this._includeProper=n,this._recordIsolated=r};Ol.prototype.isTrivialIntersection=function(e,n,r,s){if(e===r&&this._li.getIntersectionNum()===1){if(Ol.isAdjacentSegments(n,s))return!0;if(e.isClosed()){var u=e.getNumPoints()-1;if(n===0&&s===u||s===0&&n===u)return!0}}return!1};Ol.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Ol.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e};Ol.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Ol.prototype.isBoundaryPointInternal=function(e,n){for(var r=n.iterator();r.hasNext();){var s=r.next(),u=s.getCoordinate();if(e.isIntersection(u))return!0}return!1};Ol.prototype.hasProperIntersection=function(){return this._hasProper};Ol.prototype.hasIntersection=function(){return this._hasIntersection};Ol.prototype.isDone=function(){return this._isDone};Ol.prototype.isBoundaryPoint=function(e,n){return n===null?!1:!!(this.isBoundaryPointInternal(e,n[0])||this.isBoundaryPointInternal(e,n[1]))};Ol.prototype.setBoundaryNodes=function(e,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=n};Ol.prototype.addIntersections=function(e,n,r,s){if(e===r&&n===s)return null;this.numTests++;var u=e.getCoordinates()[n],p=e.getCoordinates()[n+1],g=r.getCoordinates()[s],l=r.getCoordinates()[s+1];this._li.computeIntersection(u,p,g,l),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,n,r,s)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(e.addIntersections(this._li,n,0),r.addIntersections(this._li,s,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};Ol.prototype.interfaces_=function(){return[]};Ol.prototype.getClass=function(){return Ol};Ol.isAdjacentSegments=function(e,n){return Math.abs(e-n)===1};var Lie=function(t){function e(){t.call(this),this.events=new vr,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){var r=this;ld.sort(this.events);for(var s=0;s<this.events.size();s++){var u=r.events.get(s);u.isDelete()&&u.getInsertEvent().setDeleteEventIndex(s)}},e.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var s=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var u=0;u<this.events.size();u++){var p=r.events.get(u);if(p.isInsert()&&r.processOverlaps(u,p.getDeleteEventIndex(),p,s),s.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Ol&&_i(arguments[0],ed)&&_i(arguments[1],ed)){var g=arguments[0],l=arguments[1],E=arguments[2];this.addEdges(g,g),this.addEdges(l,l),this.computeIntersections(E)}else if(typeof arguments[2]=="boolean"&&_i(arguments[0],ed)&&arguments[1]instanceof Ol){var P=arguments[0],O=arguments[1],j=arguments[2];j?this.addEdges(P,null):this.addEdges(P),this.computeIntersections(O)}}},e.prototype.addEdge=function(r,s){for(var u=this,p=r.getMonotoneChainEdge(),g=p.getStartIndexes(),l=0;l<g.length-1;l++){var E=new e9(p,l),P=new cc(s,p.getMinX(l),E);u.events.add(P),u.events.add(new cc(p.getMaxX(l),P))}},e.prototype.processOverlaps=function(r,s,u,p){for(var g=this,l=u.getObject(),E=r;E<s;E++){var P=g.events.get(E);if(P.isInsert()){var O=P.getObject();u.isSameLabel(P)||(l.computeIntersections(O,p),g.nOverlaps++)}}},e.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var s=arguments[0],u=s.iterator();u.hasNext();){var p=u.next();r.addEdge(p,p)}else if(arguments.length===2)for(var g=arguments[0],l=arguments[1],E=g.iterator();E.hasNext();){var P=E.next();r.addEdge(P,l)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(RS),vp=function(){this._min=Ai.POSITIVE_INFINITY,this._max=Ai.NEGATIVE_INFINITY},MG={NodeComparator:{configurable:!0}};vp.prototype.getMin=function(){return this._min};vp.prototype.intersects=function(e,n){return!(this._min>n||this._max<e)};vp.prototype.getMax=function(){return this._max};vp.prototype.toString=function(){return sd.toLineString(new Wt(this._min,0),new Wt(this._max,0))};vp.prototype.interfaces_=function(){return[]};vp.prototype.getClass=function(){return vp};MG.NodeComparator.get=function(){return t9};Object.defineProperties(vp,MG);var t9=function(){};t9.prototype.compare=function(e,n){var r=e,s=n,u=(r._min+r._max)/2,p=(s._min+s._max)/2;return u<p?-1:u>p?1:0};t9.prototype.interfaces_=function(){return[yb]};t9.prototype.getClass=function(){return t9};var Pie=function(t){function e(){t.call(this),this._item=null;var n=arguments[0],r=arguments[1],s=arguments[2];this._min=n,this._max=r,this._item=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(r,s,u){if(!this.intersects(r,s))return null;u.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(vp),Rie=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(r,s){this._min=Math.min(r._min,s._min),this._max=Math.max(r._max,s._max)},e.prototype.query=function(r,s,u){if(!this.intersects(r,s))return null;this._node1!==null&&this._node1.query(r,s,u),this._node2!==null&&this._node2.query(r,s,u)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(vp),xp=function(){this._leaves=new vr,this._root=null,this._level=0};xp.prototype.buildTree=function(){var e=this;ld.sort(this._leaves,new vp.NodeComparator);for(var n=this._leaves,r=null,s=new vr;;){if(e.buildLevel(n,s),s.size()===1)return s.get(0);r=n,n=s,s=r}};xp.prototype.insert=function(e,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Pie(e,n,r))};xp.prototype.query=function(e,n,r){this.init(),this._root.query(e,n,r)};xp.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};xp.prototype.printNode=function(e){Rl.out.println(sd.toLineString(new Wt(e._min,this._level),new Wt(e._max,this._level)))};xp.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};xp.prototype.buildLevel=function(e,n){this._level++,n.clear();for(var r=0;r<e.size();r+=2){var s=e.get(r),u=r+1<e.size()?e.get(r):null;if(u===null)n.add(s);else{var p=new Rie(e.get(r),e.get(r+1));n.add(p)}}};xp.prototype.interfaces_=function(){return[]};xp.prototype.getClass=function(){return xp};var Ab=function(){this._items=new vr};Ab.prototype.visitItem=function(e){this._items.add(e)};Ab.prototype.getItems=function(){return this._items};Ab.prototype.interfaces_=function(){return[Kg]};Ab.prototype.getClass=function(){return Ab};var Lb=function(){this._index=null;var e=arguments[0];if(!_i(e,Yg))throw new Po("Argument must be Polygonal");this._index=new Hy(e)},rA={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Lb.prototype.locate=function(e){var n=new Yd(e),r=new Pb(n);return this._index.query(e.y,e.y,r),n.getLocation()};Lb.prototype.interfaces_=function(){return[Cb]};Lb.prototype.getClass=function(){return Lb};rA.SegmentVisitor.get=function(){return Pb};rA.IntervalIndexedGeometry.get=function(){return Hy};Object.defineProperties(Lb,rA);var Pb=function(){this._counter=null;var e=arguments[0];this._counter=e};Pb.prototype.visitItem=function(e){var n=e;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};Pb.prototype.interfaces_=function(){return[Kg]};Pb.prototype.getClass=function(){return Pb};var Hy=function(){this._index=new xp;var e=arguments[0];this.init(e)};Hy.prototype.init=function(e){for(var n=this,r=Il.getLines(e),s=r.iterator();s.hasNext();){var u=s.next(),p=u.getCoordinates();n.addLine(p)}};Hy.prototype.addLine=function(e){for(var n=this,r=1;r<e.length;r++){var s=new ii(e[r-1],e[r]),u=Math.min(s.p0.y,s.p1.y),p=Math.max(s.p0.y,s.p1.y);n._index.insert(u,p,s)}};Hy.prototype.query=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new Ab;return this._index.query(e,n,r),r.getItems()}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2];this._index.query(s,u,p)}};Hy.prototype.interfaces_=function(){return[]};Hy.prototype.getClass=function(){return Hy};var Nw=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new uG,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new cd,arguments.length===2){var n=arguments[0],r=arguments[1],s=xh.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=s,r!==null&&this.add(r)}else if(arguments.length===3){var u=arguments[0],p=arguments[1],g=arguments[2];this._argIndex=u,this._parentGeom=p,this._boundaryNodeRule=g,p!==null&&this.add(p)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(r,s){var u=this._nodes.addNode(s),p=u.getLabel(),g=1,l=tn.NONE;l=p.getLocation(r,or.ON),l===tn.BOUNDARY&&g++;var E=e.determineBoundary(this._boundaryNodeRule,g);p.setLocation(r,E)},e.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.computeSelfNodes(r,s,!1)}else if(arguments.length===3){var u=arguments[0],p=arguments[1],g=arguments[2],l=new Ol(u,!0,!1);l.setIsDoneIfProperInt(g);var E=this.createEdgeSetIntersector(),P=this._parentGeom instanceof fp||this._parentGeom instanceof qa||this._parentGeom instanceof op,O=p||!P;return E.computeIntersections(this._edges,l,O),this.addSelfIntersectionNodes(this._argIndex),l}},e.prototype.computeSplitEdges=function(r){for(var s=this._edges.iterator();s.hasNext();){var u=s.next();u.eiList.addSplitEdges(r)}},e.prototype.computeEdgeIntersections=function(r,s,u){var p=new Ol(s,u,!0);p.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var g=this.createEdgeSetIntersector();return g.computeIntersections(this._edges,r._edges,p),p},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof ac){var r=arguments[0],s=r.getCoordinate();this.insertPoint(this._argIndex,s,tn.INTERIOR)}else if(arguments[0]instanceof Wt){var u=arguments[0];this.insertPoint(this._argIndex,u,tn.INTERIOR)}},e.prototype.addPolygon=function(r){var s=this;this.addPolygonRing(r.getExteriorRing(),tn.EXTERIOR,tn.INTERIOR);for(var u=0;u<r.getNumInteriorRing();u++){var p=r.getInteriorRingN(u);s.addPolygonRing(p,tn.INTERIOR,tn.EXTERIOR)}},e.prototype.addEdge=function(r){this.insertEdge(r);var s=r.getCoordinates();this.insertPoint(this._argIndex,s[0],tn.BOUNDARY),this.insertPoint(this._argIndex,s[s.length-1],tn.BOUNDARY)},e.prototype.addLineString=function(r){var s=Qi.removeRepeatedPoints(r.getCoordinates());if(s.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=s[0],null;var u=new PS(s,new Bs(this._argIndex,tn.INTERIOR));this._lineEdgeMap.put(r,u),this.insertEdge(u),Vi.isTrue(s.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,s[0]),this.insertBoundaryPoint(this._argIndex,s[s.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),s=new Array(r.size()).fill(null),u=0,p=r.iterator();p.hasNext();){var g=p.next();s[u++]=g.getCoordinate().copy()}return s},e.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(r,s,u){if(this.isBoundaryNode(r,s))return null;u===tn.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,s):this.insertPoint(r,s,u)},e.prototype.addPolygonRing=function(r,s,u){if(r.isEmpty())return null;var p=Qi.removeRepeatedPoints(r.getCoordinates());if(p.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=p[0],null;var g=s,l=u;kr.isCCW(p)&&(g=u,l=s);var E=new PS(p,new Bs(this._argIndex,tn.BOUNDARY,g,l));this._lineEdgeMap.put(r,E),this.insertEdge(E),this.insertPoint(this._argIndex,p[0],tn.BOUNDARY)},e.prototype.insertPoint=function(r,s,u){var p=this._nodes.addNode(s),g=p.getLabel();g===null?p._label=new Bs(r,u):g.setLocation(r,u)},e.prototype.createEdgeSetIntersector=function(){return new Lie},e.prototype.addSelfIntersectionNodes=function(r){for(var s=this,u=this._edges.iterator();u.hasNext();)for(var p=u.next(),g=p.getLabel().getLocation(r),l=p.eiList.iterator();l.hasNext();){var E=l.next();s.addSelfIntersectionNode(r,E.coord,g)}},e.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof op&&(this._useBoundaryDeterminationRule=!1),r instanceof qa)this.addPolygon(r);else if(r instanceof Jo)this.addLineString(r);else if(r instanceof ac)this.addPoint(r);else if(r instanceof Sb)this.addCollection(r);else if(r instanceof Fy)this.addCollection(r);else if(r instanceof op)this.addCollection(r);else if(r instanceof pu)this.addCollection(r);else throw new Error(r.getClass().getName())}else return t.prototype.add.apply(this,arguments)},e.prototype.addCollection=function(r){for(var s=this,u=0;u<r.getNumGeometries();u++){var p=r.getGeometryN(u);s.add(p)}},e.prototype.locate=function(r){return _i(this._parentGeom,Yg)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Lb(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},e.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(r,s){return r.isInBoundary(s)?tn.BOUNDARY:tn.INTERIOR},e}(Bo),Rb=function(){if(this._li=new t_,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Nw(0,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],s=xh.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Nw(0,n,s),this._arg[1]=new Nw(1,r,s)}else if(arguments.length===3){var u=arguments[0],p=arguments[1],g=arguments[2];u.getPrecisionModel().compareTo(p.getPrecisionModel())>=0?this.setComputationPrecision(u.getPrecisionModel()):this.setComputationPrecision(p.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Nw(0,u,g),this._arg[1]=new Nw(1,p,g)}};Rb.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()};Rb.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)};Rb.prototype.interfaces_=function(){return[]};Rb.prototype.getClass=function(){return Rb};var Ly=function(){};Ly.prototype.interfaces_=function(){return[]};Ly.prototype.getClass=function(){return Ly};Ly.map=function(){if(arguments[0]instanceof mi&&_i(arguments[1],Ly.MapOp)){for(var e=arguments[0],n=arguments[1],r=new vr,s=0;s<e.getNumGeometries();s++){var u=n.map(e.getGeometryN(s));u!==null&&r.add(u)}return e.getFactory().buildGeometry(r)}else if(_i(arguments[0],Ua)&&_i(arguments[1],Ly.MapOp)){for(var p=arguments[0],g=arguments[1],l=new vr,E=p.iterator();E.hasNext();){var P=E.next(),O=g.map(P);O!==null&&l.add(O)}return l}};Ly.MapOp=function(){};var Ui=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r),this._ptLocator=new cd,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new ud,this._resultPolyList=new vr,this._resultLineList=new vr,this._resultPointList=new vr,this._graph=new Bo(new yG),this._geomFact=n.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(r){var s=this._edgeList.findEqualEdge(r);if(s!==null){var u=s.getLabel(),p=r.getLabel();s.isPointwiseEqual(r)||(p=new Bs(r.getLabel()),p.flip());var g=s.getDepth();g.isNull()&&g.add(u),g.add(p),u.merge(p)}else this._edgeList.add(r)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var s=r.next(),u=s.getSym();s.isInResult()&&u.isInResult()&&(s.setInResult(!1),u.setInResult(!1))}},e.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},e.prototype.computeGeometry=function(r,s,u,p){var g=new vr;return g.addAll(r),g.addAll(s),g.addAll(u),g.isEmpty()?e.createEmptyResult(p,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(g)},e.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var s=r.next();s.getEdges().mergeSymLabels()}},e.prototype.isCovered=function(r,s){for(var u=this,p=s.iterator();p.hasNext();){var g=p.next(),l=u._ptLocator.locate(r,g);if(l!==tn.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var r=new vr,s=this._edgeList.iterator();s.hasNext();){var u=s.next();u.isCollapsed()&&(s.remove(),r.add(u.getCollapsedEdge()))}this._edgeList.addAll(r)},e.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var s=r.next(),u=s.getEdges().getLabel();s.getLabel().merge(u)}},e.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},e.prototype.insertUniqueEdges=function(r){for(var s=this,u=r.iterator();u.hasNext();){var p=u.next();s.insertUniqueEdge(p)}},e.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var s=new vr;this._arg[0].computeSplitEdges(s),this._arg[1].computeSplitEdges(s),this.insertUniqueEdges(s),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Gy.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var u=new lc(this._geomFact);u.add(this._graph),this._resultPolyList=u.getPolygons();var p=new hf(this,this._geomFact,this._ptLocator);this._resultLineList=p.build(r);var g=new nv(this,this._geomFact,this._ptLocator);this._resultPointList=g.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},e.prototype.labelIncompleteNode=function(r,s){var u=this._ptLocator.locate(r.getCoordinate(),this._arg[s].getGeometry());r.getLabel().setLocation(s,u)},e.prototype.copyPoints=function(r){for(var s=this,u=this._arg[r].getNodeIterator();u.hasNext();){var p=u.next(),g=s._graph.addNode(p.getCoordinate());g.setLabel(r,p.getLabel().getLocation(r))}},e.prototype.findResultAreaEdges=function(r){for(var s=this._graph.getEdgeEnds().iterator();s.hasNext();){var u=s.next(),p=u.getLabel();p.isArea()&&!u.isInteriorAreaEdge()&&e.isResultOfOp(p.getLocation(0,or.RIGHT),p.getLocation(1,or.RIGHT),r)&&u.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var s=r.next(),u=s.getLabel(),p=s.getDepth();if(!p.isNull()){p.normalize();for(var g=0;g<2;g++)!u.isNull(g)&&u.isArea()&&!p.isNull(g)&&(p.getDelta(g)===0?u.toLine(g):(Vi.isTrue(!p.isNull(g,or.LEFT),"depth of LEFT side has not been initialized"),u.setLocation(g,or.LEFT,p.getLocation(g,or.LEFT)),Vi.isTrue(!p.isNull(g,or.RIGHT),"depth of RIGHT side has not been initialized"),u.setLocation(g,or.RIGHT,p.getLocation(g,or.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var r=this,s=this._graph.getNodes().iterator();s.hasNext();){var u=s.next();u.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var r=this,s=this._graph.getNodes().iterator();s.hasNext();){var u=s.next(),p=u.getLabel();u.isIsolated()&&(p.isNull(0)?r.labelIncompleteNode(u,0):r.labelIncompleteNode(u,1)),u.getEdges().updateLabelling(p)}},e.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Rb);Ui.overlayOp=function(t,e,n){var r=new Ui(t,e),s=r.getResultGeometry(n);return s};Ui.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Ui.createEmptyResult(Ui.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return tv.map(t,{interfaces_:function(){return[Ly.MapOp]},map:function(r){return r.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),yu.overlayOp(t,e,Ui.INTERSECTION)};Ui.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Ui.createEmptyResult(Ui.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),yu.overlayOp(t,e,Ui.SYMDIFFERENCE)};Ui.resultDimension=function(t,e,n){var r=e.getDimension(),s=n.getDimension(),u=-1;switch(t){case Ui.INTERSECTION:u=Math.min(r,s);break;case Ui.UNION:u=Math.max(r,s);break;case Ui.DIFFERENCE:u=r;break;case Ui.SYMDIFFERENCE:u=Math.max(r,s);break}return u};Ui.createEmptyResult=function(t,e,n,r){var s=null;switch(Ui.resultDimension(t,e,n)){case-1:s=r.createGeometryCollection(new Array(0).fill(null));break;case 0:s=r.createPoint();break;case 1:s=r.createLineString();break;case 2:s=r.createPolygon();break}return s};Ui.difference=function(t,e){return t.isEmpty()?Ui.createEmptyResult(Ui.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),yu.overlayOp(t,e,Ui.DIFFERENCE))};Ui.isResultOfOp=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return Ui.isResultOfOp(n,r,e)}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2];switch(s===tn.BOUNDARY&&(s=tn.INTERIOR),u===tn.BOUNDARY&&(u=tn.INTERIOR),p){case Ui.INTERSECTION:return s===tn.INTERIOR&&u===tn.INTERIOR;case Ui.UNION:return s===tn.INTERIOR||u===tn.INTERIOR;case Ui.DIFFERENCE:return s===tn.INTERIOR&&u!==tn.INTERIOR;case Ui.SYMDIFFERENCE:return s===tn.INTERIOR&&u!==tn.INTERIOR||s!==tn.INTERIOR&&u===tn.INTERIOR}return!1}};Ui.INTERSECTION=1;Ui.UNION=2;Ui.DIFFERENCE=3;Ui.SYMDIFFERENCE=4;var Ug=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new cd,this._seg=new ii;var e=arguments[0],n=arguments[1];this._g=e,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(e)};Ug.prototype.isWithinToleranceOfBoundary=function(e){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var s=n._linework.getGeometryN(r),u=s.getCoordinateSequence(),p=0;p<u.size()-1;p++){u.getCoordinate(p,n._seg.p0),u.getCoordinate(p+1,n._seg.p1);var g=n._seg.distance(e);if(g<=n._boundaryDistanceTolerance)return!0}return!1};Ug.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?tn.BOUNDARY:this._ptLocator.locate(e,this._g)};Ug.prototype.extractLinework=function(e){var n=new Nb;e.apply(n);var r=n.getLinework(),s=Ji.toLineStringArray(r);return e.getFactory().createMultiLineString(s)};Ug.prototype.interfaces_=function(){return[]};Ug.prototype.getClass=function(){return Ug};var Nb=function(){this._linework=null,this._linework=new vr};Nb.prototype.getLinework=function(){return this._linework};Nb.prototype.filter=function(e){var n=this;if(e instanceof qa){var r=e;this._linework.add(r.getExteriorRing());for(var s=0;s<r.getNumInteriorRing();s++)n._linework.add(r.getInteriorRingN(s))}};Nb.prototype.interfaces_=function(){return[rf]};Nb.prototype.getClass=function(){return Nb};var Wy=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var e=arguments[0];this._g=e};Wy.prototype.extractPoints=function(e,n,r){for(var s=this,u=e.getCoordinates(),p=0;p<u.length-1;p++)s.computeOffsetPoints(u[p],u[p+1],n,r)};Wy.prototype.setSidesToGenerate=function(e,n){this._doLeft=e,this._doRight=n};Wy.prototype.getPoints=function(e){for(var n=this,r=new vr,s=Il.getLines(this._g),u=s.iterator();u.hasNext();){var p=u.next();n.extractPoints(p,e,r)}return r};Wy.prototype.computeOffsetPoints=function(e,n,r,s){var u=n.x-e.x,p=n.y-e.y,g=Math.sqrt(u*u+p*p),l=r*u/g,E=r*p/g,P=(n.x+e.x)/2,O=(n.y+e.y)/2;if(this._doLeft){var j=new Wt(P-E,O+l);s.add(j)}if(this._doRight){var $=new Wt(P+E,O-l);s.add($)}};Wy.prototype.interfaces_=function(){return[]};Wy.prototype.getClass=function(){return Wy};var Rc=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new vr;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new Ug(this._geom[0],this._boundaryDistanceTolerance),new Ug(this._geom[1],this._boundaryDistanceTolerance),new Ug(this._geom[2],this._boundaryDistanceTolerance)]},kG={TOLERANCE:{configurable:!0}};Rc.prototype.reportResult=function(e,n,r){Rl.out.println("Overlay result invalid - A:"+tn.toLocationSymbol(n[0])+" B:"+tn.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+tn.toLocationSymbol(n[2]))};Rc.prototype.isValid=function(e){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(e);return n};Rc.prototype.checkValid=function(){var e=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var s=e._testCoords.get(r);if(!e.checkValid(n,s))return e._invalidLocation=s,!1}return!0}else if(arguments.length===2){var u=arguments[0],p=arguments[1];return this._location[0]=this._locFinder[0].getLocation(p),this._location[1]=this._locFinder[1].getLocation(p),this._location[2]=this._locFinder[2].getLocation(p),Rc.hasLocation(this._location,tn.BOUNDARY)?!0:this.isValidResult(u,this._location)}};Rc.prototype.addTestPts=function(e){var n=new Wy(e);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};Rc.prototype.isValidResult=function(e,n){var r=Ui.isResultOfOp(n[0],n[1],e),s=n[2]===tn.INTERIOR,u=!(r^s);return u||this.reportResult(e,n,r),u};Rc.prototype.getInvalidLocation=function(){return this._invalidLocation};Rc.prototype.interfaces_=function(){return[]};Rc.prototype.getClass=function(){return Rc};Rc.hasLocation=function(e,n){for(var r=0;r<3;r++)if(e[r]===n)return!0;return!1};Rc.computeBoundaryDistanceTolerance=function(e,n){return Math.min(ha.computeSizeBasedSnapTolerance(e),ha.computeSizeBasedSnapTolerance(n))};Rc.isValid=function(e,n,r,s){var u=new Rc(e,n,s);return u.isValid(r)};kG.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(Rc,kG);var Tc=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Tc.prototype.extractElements=function(e,n){var r=this;if(e===null)return null;for(var s=0;s<e.getNumGeometries();s++){var u=e.getGeometryN(s);r._skipEmpty&&u.isEmpty()||n.add(u)}};Tc.prototype.combine=function(){for(var e=this,n=new vr,r=this._inputGeoms.iterator();r.hasNext();){var s=r.next();e.extractElements(s,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};Tc.prototype.interfaces_=function(){return[]};Tc.prototype.getClass=function(){return Tc};Tc.combine=function(){if(arguments.length===1){var e=arguments[0],n=new Tc(e);return n.combine()}else if(arguments.length===2){var r=arguments[0],s=arguments[1],u=new Tc(Tc.createList(r,s));return u.combine()}else if(arguments.length===3){var p=arguments[0],g=arguments[1],l=arguments[2],E=new Tc(Tc.createList(p,g,l));return E.combine()}};Tc.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()};Tc.createList=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new vr;return r.add(e),r.add(n),r}else if(arguments.length===3){var s=arguments[0],u=arguments[1],p=arguments[2],g=new vr;return g.add(s),g.add(u),g.add(p),g}};var ka=function(){this._inputPolys=null,this._geomFactory=null;var e=arguments[0];this._inputPolys=e,this._inputPolys===null&&(this._inputPolys=new vr)},CG={STRTREE_NODE_CAPACITY:{configurable:!0}};ka.prototype.reduceToGeometries=function(e){for(var n=this,r=new vr,s=e.iterator();s.hasNext();){var u=s.next(),p=null;_i(u,ed)?p=n.unionTree(u):u instanceof mi&&(p=u),r.add(p)}return r};ka.prototype.extractByEnvelope=function(e,n,r){for(var s=new vr,u=0;u<n.getNumGeometries();u++){var p=n.getGeometryN(u);p.getEnvelopeInternal().intersects(e)?s.add(p):r.add(p)}return this._geomFactory.buildGeometry(s)};ka.prototype.unionOptimized=function(e,n){var r=e.getEnvelopeInternal(),s=n.getEnvelopeInternal();if(!r.intersects(s)){var u=Tc.combine(e,n);return u}if(e.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(e,n);var p=r.intersection(s);return this.unionUsingEnvelopeIntersection(e,n,p)};ka.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new fG(ka.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();e.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var s=e.itemsTree(),u=this.unionTree(s);return u};ka.prototype.binaryUnion=function(){if(arguments.length===1){var e=arguments[0];return this.binaryUnion(e,0,e.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];if(s-r<=1){var u=ka.getGeometry(n,r);return this.unionSafe(u,null)}else{if(s-r===2)return this.unionSafe(ka.getGeometry(n,r),ka.getGeometry(n,r+1));var p=Math.trunc((s+r)/2),g=this.binaryUnion(n,r,p),l=this.binaryUnion(n,p,s);return this.unionSafe(g,l)}}};ka.prototype.repeatedUnion=function(e){for(var n=null,r=e.iterator();r.hasNext();){var s=r.next();n===null?n=s.copy():n=n.union(s)}return n};ka.prototype.unionSafe=function(e,n){return e===null&&n===null?null:e===null?n.copy():n===null?e.copy():this.unionOptimized(e,n)};ka.prototype.unionActual=function(e,n){return ka.restrictToPolygons(e.union(n))};ka.prototype.unionTree=function(e){var n=this.reduceToGeometries(e),r=this.binaryUnion(n);return r};ka.prototype.unionUsingEnvelopeIntersection=function(e,n,r){var s=new vr,u=this.extractByEnvelope(r,e,s),p=this.extractByEnvelope(r,n,s),g=this.unionActual(u,p);s.add(g);var l=Tc.combine(s);return l};ka.prototype.bufferUnion=function(){if(arguments.length===1){var e=arguments[0],n=e.get(0).getFactory(),r=n.buildGeometry(e),s=r.buffer(0);return s}else if(arguments.length===2){var u=arguments[0],p=arguments[1],g=u.getFactory(),l=g.createGeometryCollection([u,p]),E=l.buffer(0);return E}};ka.prototype.interfaces_=function(){return[]};ka.prototype.getClass=function(){return ka};ka.restrictToPolygons=function(e){if(_i(e,Yg))return e;var n=Am.getPolygons(e);return n.size()===1?n.get(0):e.getFactory().createMultiPolygon(Ji.toPolygonArray(n))};ka.getGeometry=function(e,n){return n>=e.size()?null:e.get(n)};ka.union=function(e){var n=new ka(e);return n.union()};CG.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(ka,CG);var NS=function(){};NS.prototype.interfaces_=function(){return[]};NS.prototype.getClass=function(){return NS};NS.union=function(e,n){if(e.isEmpty()||n.isEmpty()){if(e.isEmpty()&&n.isEmpty())return Ui.createEmptyResult(Ui.UNION,e,n,e.getFactory());if(e.isEmpty())return n.copy();if(n.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(n),yu.overlayOp(e,n,Ui.UNION)};function n_(){return new DS}function DS(){this.reset()}DS.prototype={constructor:DS,reset:function(){this.s=this.t=0},add:function(t){b8(sE,t,this.t),b8(this,sE.s,this.s),this.s?this.t+=sE.t:this.s=sE.t},valueOf:function(){return this.s}};var sE=new DS;function b8(t,e,n){var r=t.s=e+n,s=r-e,u=r-s;t.t=e-u+(n-s)}var Yo=1e-6,to=Math.PI,Sm=to/2,w8=to/4,Bm=to*2,sy=180/to,Ud=to/180,hu=Math.abs,Nie=Math.atan,Db=Math.atan2,ja=Math.cos,Va=Math.sin,c3=Math.sqrt;function IG(t){return t>1?0:t<-1?to:Math.acos(t)}function iv(t){return t>1?Sm:t<-1?-Sm:Math.asin(t)}function Xw(){}function OS(t,e){t&&S8.hasOwnProperty(t.type)&&S8[t.type](t,e)}var E8={Feature:function(t,e){OS(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,s=n.length;++r<s;)OS(n[r].geometry,e)}},S8={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,s=n.length;++r<s;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){n2(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,s=n.length;++r<s;)n2(n[r],e,0)},Polygon:function(t,e){T8(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,s=n.length;++r<s;)T8(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,s=n.length;++r<s;)OS(n[r],e)}};function n2(t,e,n){var r=-1,s=t.length-n,u;for(e.lineStart();++r<s;)u=t[r],e.point(u[0],u[1],u[2]);e.lineEnd()}function T8(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)n2(t[n],e,1);e.polygonEnd()}function Die(t,e){t&&E8.hasOwnProperty(t.type)?E8[t.type](t,e):OS(t,e)}n_();n_();function r2(t){return[Db(t[1],t[0]),iv(t[2])]}function Ob(t){var e=t[0],n=t[1],r=ja(n);return[r*ja(e),r*Va(e),Va(n)]}function oE(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function FS(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function k7(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function aE(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function i2(t){var e=c3(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}n_();function AG(t,e){function n(r,s){return r=t(r,s),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,s){return r=e.invert(r,s),r&&t.invert(r[0],r[1])}),n}function s2(t,e){return[t>to?t-Bm:t<-to?t+Bm:t,e]}s2.invert=s2;function Oie(t,e,n){return(t%=Bm)?e||n?AG(k8(t),C8(e,n)):k8(t):e||n?C8(e,n):s2}function M8(t){return function(e,n){return e+=t,[e>to?e-Bm:e<-to?e+Bm:e,n]}}function k8(t){var e=M8(t);return e.invert=M8(-t),e}function C8(t,e){var n=ja(t),r=Va(t),s=ja(e),u=Va(e);function p(g,l){var E=ja(l),P=ja(g)*E,O=Va(g)*E,j=Va(l),$=j*n+P*r;return[Db(O*s-$*u,P*n-j*r),iv($*s+O*u)]}return p.invert=function(g,l){var E=ja(l),P=ja(g)*E,O=Va(g)*E,j=Va(l),$=j*s-O*u;return[Db(O*s+j*u,P*n+$*r),iv($*n-P*r)]},p}function Fie(t,e,n,r,s,u){if(n){var p=ja(e),g=Va(e),l=r*n;s==null?(s=e+r*Bm,u=e-l/2):(s=I8(p,s),u=I8(p,u),(r>0?s<u:s>u)&&(s+=r*Bm));for(var E,P=s;r>0?P>u:P<u;P-=l)E=r2([p,-g*ja(P),-g*Va(P)]),t.point(E[0],E[1])}}function I8(t,e){e=Ob(e),e[0]-=t,i2(e);var n=IG(-e[1]);return((-e[2]<0?-n:n)+Bm-Yo)%Bm}function LG(){var t=[],e;return{point:function(n,r){e.push([n,r])},lineStart:function(){t.push(e=[])},lineEnd:Xw,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function zie(t,e,n,r,s,u){var p=t[0],g=t[1],l=e[0],E=e[1],P=0,O=1,j=l-p,$=E-g,Y;if(Y=n-p,!(!j&&Y>0)){if(Y/=j,j<0){if(Y<P)return;Y<O&&(O=Y)}else if(j>0){if(Y>O)return;Y>P&&(P=Y)}if(Y=s-p,!(!j&&Y<0)){if(Y/=j,j<0){if(Y>O)return;Y>P&&(P=Y)}else if(j>0){if(Y<P)return;Y<O&&(O=Y)}if(Y=r-g,!(!$&&Y>0)){if(Y/=$,$<0){if(Y<P)return;Y<O&&(O=Y)}else if($>0){if(Y>O)return;Y>P&&(P=Y)}if(Y=u-g,!(!$&&Y<0)){if(Y/=$,$<0){if(Y>O)return;Y>P&&(P=Y)}else if($>0){if(Y<P)return;Y<O&&(O=Y)}return P>0&&(t[0]=p+P*j,t[1]=g+P*$),O<1&&(e[0]=p+O*j,e[1]=g+O*$),!0}}}}}function NE(t,e){return hu(t[0]-e[0])<Yo&&hu(t[1]-e[1])<Yo}function lE(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function PG(t,e,n,r,s){var u=[],p=[],g,l;if(t.forEach(function(Y){if(!((re=Y.length-1)<=0)){var re,_e=Y[0],J=Y[re],H;if(NE(_e,J)){for(s.lineStart(),g=0;g<re;++g)s.point((_e=Y[g])[0],_e[1]);s.lineEnd();return}u.push(H=new lE(_e,Y,null,!0)),p.push(H.o=new lE(_e,null,H,!1)),u.push(H=new lE(J,Y,null,!1)),p.push(H.o=new lE(J,null,H,!0))}}),!!u.length){for(p.sort(e),A8(u),A8(p),g=0,l=p.length;g<l;++g)p[g].e=n=!n;for(var E=u[0],P,O;;){for(var j=E,$=!0;j.v;)if((j=j.n)===E)return;P=j.z,s.lineStart();do{if(j.v=j.o.v=!0,j.e){if($)for(g=0,l=P.length;g<l;++g)s.point((O=P[g])[0],O[1]);else r(j.x,j.n.x,1,s);j=j.n}else{if($)for(P=j.p.z,g=P.length-1;g>=0;--g)s.point((O=P[g])[0],O[1]);else r(j.x,j.p.x,-1,s);j=j.p}j=j.o,P=j.z,$=!$}while(!j.v);s.lineEnd()}}}function A8(t){if(e=t.length){for(var e,n=0,r=t[0],s;++n<e;)r.n=s=t[n],s.p=r,r=s;r.n=s=t[0],s.p=r}}function RG(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Bie(t){return t.length===1&&(t=Uie(t)),{left:function(e,n,r,s){for(r==null&&(r=0),s==null&&(s=e.length);r<s;){var u=r+s>>>1;t(e[u],n)<0?r=u+1:s=u}return r},right:function(e,n,r,s){for(r==null&&(r=0),s==null&&(s=e.length);r<s;){var u=r+s>>>1;t(e[u],n)>0?s=u:r=u+1}return r}}}function Uie(t){return function(e,n){return RG(t(e),n)}}Bie(RG);function NG(t){for(var e=t.length,n,r=-1,s=0,u,p;++r<e;)s+=t[r].length;for(u=new Array(s);--e>=0;)for(p=t[e],n=p.length;--n>=0;)u[--s]=p[n];return u}var Zw=1e9,uE=-Zw;function jie(t,e,n,r){function s(E,P){return t<=E&&E<=n&&e<=P&&P<=r}function u(E,P,O,j){var $=0,Y=0;if(E==null||($=p(E,O))!==(Y=p(P,O))||l(E,P)<0^O>0)do j.point($===0||$===3?t:n,$>1?r:e);while(($=($+O+4)%4)!==Y);else j.point(P[0],P[1])}function p(E,P){return hu(E[0]-t)<Yo?P>0?0:3:hu(E[0]-n)<Yo?P>0?2:1:hu(E[1]-e)<Yo?P>0?1:0:P>0?3:2}function g(E,P){return l(E.x,P.x)}function l(E,P){var O=p(E,1),j=p(P,1);return O!==j?O-j:O===0?P[1]-E[1]:O===1?E[0]-P[0]:O===2?E[1]-P[1]:P[0]-E[0]}return function(E){var P=E,O=LG(),j,$,Y,re,_e,J,H,te,ce,Se,Ie,Ne={point:ut,lineStart:st,lineEnd:qe,polygonStart:We,polygonEnd:Ot};function ut(Q,ye){s(Q,ye)&&P.point(Q,ye)}function mt(){for(var Q=0,ye=0,ge=$.length;ye<ge;++ye)for(var xe=$[ye],Ce=1,tt=xe.length,Je=xe[0],rt,Ut,ht=Je[0],Ft=Je[1];Ce<tt;++Ce)rt=ht,Ut=Ft,Je=xe[Ce],ht=Je[0],Ft=Je[1],Ut<=r?Ft>r&&(ht-rt)*(r-Ut)>(Ft-Ut)*(t-rt)&&++Q:Ft<=r&&(ht-rt)*(r-Ut)<(Ft-Ut)*(t-rt)&&--Q;return Q}function We(){P=O,j=[],$=[],Ie=!0}function Ot(){var Q=mt(),ye=Ie&&Q,ge=(j=NG(j)).length;(ye||ge)&&(E.polygonStart(),ye&&(E.lineStart(),u(null,null,1,E),E.lineEnd()),ge&&PG(j,g,Q,u,E),E.polygonEnd()),P=E,j=$=Y=null}function st(){Ne.point=et,$&&$.push(Y=[]),Se=!0,ce=!1,H=te=NaN}function qe(){j&&(et(re,_e),J&&ce&&O.rejoin(),j.push(O.result())),Ne.point=ut,ce&&P.lineEnd()}function et(Q,ye){var ge=s(Q,ye);if($&&Y.push([Q,ye]),Se)re=Q,_e=ye,J=ge,Se=!1,ge&&(P.lineStart(),P.point(Q,ye));else if(ge&&ce)P.point(Q,ye);else{var xe=[H=Math.max(uE,Math.min(Zw,H)),te=Math.max(uE,Math.min(Zw,te))],Ce=[Q=Math.max(uE,Math.min(Zw,Q)),ye=Math.max(uE,Math.min(Zw,ye))];zie(xe,Ce,t,e,n,r)?(ce||(P.lineStart(),P.point(xe[0],xe[1])),P.point(Ce[0],Ce[1]),ge||P.lineEnd(),Ie=!1):ge&&(P.lineStart(),P.point(Q,ye),Ie=!1)}H=Q,te=ye,ce=ge}return Ne}}var C7=n_();function Vie(t,e){var n=e[0],r=e[1],s=[Va(n),-ja(n),0],u=0,p=0;C7.reset();for(var g=0,l=t.length;g<l;++g)if(P=(E=t[g]).length)for(var E,P,O=E[P-1],j=O[0],$=O[1]/2+w8,Y=Va($),re=ja($),_e=0;_e<P;++_e,j=H,Y=ce,re=Se,O=J){var J=E[_e],H=J[0],te=J[1]/2+w8,ce=Va(te),Se=ja(te),Ie=H-j,Ne=Ie>=0?1:-1,ut=Ne*Ie,mt=ut>to,We=Y*ce;if(C7.add(Db(We*Ne*Va(ut),re*Se+We*ja(ut))),u+=mt?Ie+Ne*Bm:Ie,mt^j>=n^H>=n){var Ot=FS(Ob(O),Ob(J));i2(Ot);var st=FS(s,Ot);i2(st);var qe=(mt^Ie>=0?-1:1)*iv(st[2]);(r>qe||r===qe&&(Ot[0]||Ot[1]))&&(p+=mt^Ie>=0?1:-1)}}return(u<-Yo||u<Yo&&C7<-Yo)^p&1}n_();function L8(t){return t}n_();n_();var Fb=1/0,zS=Fb,n9=-Fb,BS=n9,P8={point:Gie,lineStart:Xw,lineEnd:Xw,polygonStart:Xw,polygonEnd:Xw,result:function(){var t=[[Fb,zS],[n9,BS]];return n9=BS=-(zS=Fb=1/0),t}};function Gie(t,e){t<Fb&&(Fb=t),t>n9&&(n9=t),e<zS&&(zS=e),e>BS&&(BS=e)}n_();function DG(t,e,n,r){return function(s,u){var p=e(u),g=s.invert(r[0],r[1]),l=LG(),E=e(l),P=!1,O,j,$,Y={point:re,lineStart:J,lineEnd:H,polygonStart:function(){Y.point=te,Y.lineStart=ce,Y.lineEnd=Se,j=[],O=[]},polygonEnd:function(){Y.point=re,Y.lineStart=J,Y.lineEnd=H,j=NG(j);var Ie=Vie(O,g);j.length?(P||(u.polygonStart(),P=!0),PG(j,Wie,Ie,n,u)):Ie&&(P||(u.polygonStart(),P=!0),u.lineStart(),n(null,null,1,u),u.lineEnd()),P&&(u.polygonEnd(),P=!1),j=O=null},sphere:function(){u.polygonStart(),u.lineStart(),n(null,null,1,u),u.lineEnd(),u.polygonEnd()}};function re(Ie,Ne){var ut=s(Ie,Ne);t(Ie=ut[0],Ne=ut[1])&&u.point(Ie,Ne)}function _e(Ie,Ne){var ut=s(Ie,Ne);p.point(ut[0],ut[1])}function J(){Y.point=_e,p.lineStart()}function H(){Y.point=re,p.lineEnd()}function te(Ie,Ne){$.push([Ie,Ne]);var ut=s(Ie,Ne);E.point(ut[0],ut[1])}function ce(){E.lineStart(),$=[]}function Se(){te($[0][0],$[0][1]),E.lineEnd();var Ie=E.clean(),Ne=l.result(),ut,mt=Ne.length,We,Ot,st;if($.pop(),O.push($),$=null,!!mt){if(Ie&1){if(Ot=Ne[0],(We=Ot.length-1)>0){for(P||(u.polygonStart(),P=!0),u.lineStart(),ut=0;ut<We;++ut)u.point((st=Ot[ut])[0],st[1]);u.lineEnd()}return}mt>1&&Ie&2&&Ne.push(Ne.pop().concat(Ne.shift())),j.push(Ne.filter(Hie))}}return Y}}function Hie(t){return t.length>1}function Wie(t,e){return((t=t.x)[0]<0?t[1]-Sm-Yo:Sm-t[1])-((e=e.x)[0]<0?e[1]-Sm-Yo:Sm-e[1])}const R8=DG(function(){return!0},qie,Xie,[-to,-Sm]);function qie(t){var e=NaN,n=NaN,r=NaN,s;return{lineStart:function(){t.lineStart(),s=1},point:function(u,p){var g=u>0?to:-to,l=hu(u-e);hu(l-to)<Yo?(t.point(e,n=(n+p)/2>0?Sm:-Sm),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(g,n),t.point(u,n),s=0):r!==g&&l>=to&&(hu(e-r)<Yo&&(e-=r*Yo),hu(u-g)<Yo&&(u-=g*Yo),n=$ie(e,n,u,p),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(g,n),s=0),t.point(e=u,n=p),r=g},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-s}}}function $ie(t,e,n,r){var s,u,p=Va(t-n);return hu(p)>Yo?Nie((Va(e)*(u=ja(r))*Va(n)-Va(r)*(s=ja(e))*Va(t))/(s*u*p)):(e+r)/2}function Xie(t,e,n,r){var s;if(t==null)s=n*Sm,r.point(-to,s),r.point(0,s),r.point(to,s),r.point(to,0),r.point(to,-s),r.point(0,-s),r.point(-to,-s),r.point(-to,0),r.point(-to,s);else if(hu(t[0]-e[0])>Yo){var u=t[0]<e[0]?to:-to;s=n*u/2,r.point(-u,s),r.point(0,s),r.point(u,s)}else r.point(e[0],e[1])}function Zie(t,e){var n=ja(t),r=n>0,s=hu(n)>Yo;function u(P,O,j,$){Fie($,t,e,j,P,O)}function p(P,O){return ja(P)*ja(O)>n}function g(P){var O,j,$,Y,re;return{lineStart:function(){Y=$=!1,re=1},point:function(_e,J){var H=[_e,J],te,ce=p(_e,J),Se=r?ce?0:E(_e,J):ce?E(_e+(_e<0?to:-to),J):0;if(!O&&(Y=$=ce)&&P.lineStart(),ce!==$&&(te=l(O,H),(!te||NE(O,te)||NE(H,te))&&(H[0]+=Yo,H[1]+=Yo,ce=p(H[0],H[1]))),ce!==$)re=0,ce?(P.lineStart(),te=l(H,O),P.point(te[0],te[1])):(te=l(O,H),P.point(te[0],te[1]),P.lineEnd()),O=te;else if(s&&O&&r^ce){var Ie;!(Se&j)&&(Ie=l(H,O,!0))&&(re=0,r?(P.lineStart(),P.point(Ie[0][0],Ie[0][1]),P.point(Ie[1][0],Ie[1][1]),P.lineEnd()):(P.point(Ie[1][0],Ie[1][1]),P.lineEnd(),P.lineStart(),P.point(Ie[0][0],Ie[0][1])))}ce&&(!O||!NE(O,H))&&P.point(H[0],H[1]),O=H,$=ce,j=Se},lineEnd:function(){$&&P.lineEnd(),O=null},clean:function(){return re|(Y&&$)<<1}}}function l(P,O,j){var $=Ob(P),Y=Ob(O),re=[1,0,0],_e=FS($,Y),J=oE(_e,_e),H=_e[0],te=J-H*H;if(!te)return!j&&P;var ce=n*J/te,Se=-n*H/te,Ie=FS(re,_e),Ne=aE(re,ce),ut=aE(_e,Se);k7(Ne,ut);var mt=Ie,We=oE(Ne,mt),Ot=oE(mt,mt),st=We*We-Ot*(oE(Ne,Ne)-1);if(!(st<0)){var qe=c3(st),et=aE(mt,(-We-qe)/Ot);if(k7(et,Ne),et=r2(et),!j)return et;var Q=P[0],ye=O[0],ge=P[1],xe=O[1],Ce;ye<Q&&(Ce=Q,Q=ye,ye=Ce);var tt=ye-Q,Je=hu(tt-to)<Yo,rt=Je||tt<Yo;if(!Je&&xe<ge&&(Ce=ge,ge=xe,xe=Ce),rt?Je?ge+xe>0^et[1]<(hu(et[0]-Q)<Yo?ge:xe):ge<=et[1]&&et[1]<=xe:tt>to^(Q<=et[0]&&et[0]<=ye)){var Ut=aE(mt,(-We+qe)/Ot);return k7(Ut,Ne),[et,r2(Ut)]}}}function E(P,O){var j=r?t:to-t,$=0;return P<-j?$|=1:P>j&&($|=2),O<-j?$|=4:O>j&&($|=8),$}return DG(p,g,u,r?[0,-t]:[-to,t-to])}function OG(t){return function(e){var n=new o2;for(var r in t)n[r]=t[r];return n.stream=e,n}}function o2(){}o2.prototype={constructor:o2,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function FG(t,e,n){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],u=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),u!=null&&t.clipExtent(null),Die(n,t.stream(P8));var p=P8.result(),g=Math.min(r/(p[1][0]-p[0][0]),s/(p[1][1]-p[0][1])),l=+e[0][0]+(r-g*(p[1][0]+p[0][0]))/2,E=+e[0][1]+(s-g*(p[1][1]+p[0][1]))/2;return u!=null&&t.clipExtent(u),t.scale(g*150).translate([l,E])}function Yie(t,e,n){return FG(t,[[0,0],e],n)}var N8=16,Kie=ja(30*Ud);function D8(t,e){return+e?Qie(t,e):Jie(t)}function Jie(t){return OG({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function Qie(t,e){function n(r,s,u,p,g,l,E,P,O,j,$,Y,re,_e){var J=E-r,H=P-s,te=J*J+H*H;if(te>4*e&&re--){var ce=p+j,Se=g+$,Ie=l+Y,Ne=c3(ce*ce+Se*Se+Ie*Ie),ut=iv(Ie/=Ne),mt=hu(hu(Ie)-1)<Yo||hu(u-O)<Yo?(u+O)/2:Db(Se,ce),We=t(mt,ut),Ot=We[0],st=We[1],qe=Ot-r,et=st-s,Q=H*qe-J*et;(Q*Q/te>e||hu((J*qe+H*et)/te-.5)>.3||p*j+g*$+l*Y<Kie)&&(n(r,s,u,p,g,l,Ot,st,mt,ce/=Ne,Se/=Ne,Ie,re,_e),_e.point(Ot,st),n(Ot,st,mt,ce,Se,Ie,E,P,O,j,$,Y,re,_e))}}return function(r){var s,u,p,g,l,E,P,O,j,$,Y,re,_e={point:J,lineStart:H,lineEnd:ce,polygonStart:function(){r.polygonStart(),_e.lineStart=Se},polygonEnd:function(){r.polygonEnd(),_e.lineStart=H}};function J(ut,mt){ut=t(ut,mt),r.point(ut[0],ut[1])}function H(){O=NaN,_e.point=te,r.lineStart()}function te(ut,mt){var We=Ob([ut,mt]),Ot=t(ut,mt);n(O,j,P,$,Y,re,O=Ot[0],j=Ot[1],P=ut,$=We[0],Y=We[1],re=We[2],N8,r),r.point(O,j)}function ce(){_e.point=J,r.lineEnd()}function Se(){H(),_e.point=Ie,_e.lineEnd=Ne}function Ie(ut,mt){te(s=ut,mt),u=O,p=j,g=$,l=Y,E=re,_e.point=te}function Ne(){n(O,j,P,$,Y,re,u,p,s,g,l,E,N8,r),_e.lineEnd=ce,ce()}return _e}}var ese=OG({point:function(t,e){this.stream.point(t*Ud,e*Ud)}});function tse(t){return nse(function(){return t})()}function nse(t){var e,n=150,r=480,s=250,u,p,g=0,l=0,E=0,P=0,O=0,j,$,Y=null,re=R8,_e=null,J,H,te,ce=L8,Se=.5,Ie=D8(Ot,Se),Ne,ut;function mt(et){return et=$(et[0]*Ud,et[1]*Ud),[et[0]*n+u,p-et[1]*n]}function We(et){return et=$.invert((et[0]-u)/n,(p-et[1])/n),et&&[et[0]*sy,et[1]*sy]}function Ot(et,Q){return et=e(et,Q),[et[0]*n+u,p-et[1]*n]}mt.stream=function(et){return Ne&&ut===et?Ne:Ne=ese(re(j,Ie(ce(ut=et))))},mt.clipAngle=function(et){return arguments.length?(re=+et?Zie(Y=et*Ud,6*Ud):(Y=null,R8),qe()):Y*sy},mt.clipExtent=function(et){return arguments.length?(ce=et==null?(_e=J=H=te=null,L8):jie(_e=+et[0][0],J=+et[0][1],H=+et[1][0],te=+et[1][1]),qe()):_e==null?null:[[_e,J],[H,te]]},mt.scale=function(et){return arguments.length?(n=+et,st()):n},mt.translate=function(et){return arguments.length?(r=+et[0],s=+et[1],st()):[r,s]},mt.center=function(et){return arguments.length?(g=et[0]%360*Ud,l=et[1]%360*Ud,st()):[g*sy,l*sy]},mt.rotate=function(et){return arguments.length?(E=et[0]%360*Ud,P=et[1]%360*Ud,O=et.length>2?et[2]%360*Ud:0,st()):[E*sy,P*sy,O*sy]},mt.precision=function(et){return arguments.length?(Ie=D8(Ot,Se=et*et),qe()):c3(Se)},mt.fitExtent=function(et,Q){return FG(mt,et,Q)},mt.fitSize=function(et,Q){return Yie(mt,et,Q)};function st(){$=AG(j=Oie(E,P,O),e);var et=e(g,l);return u=r-et[0]*n,p=s+et[1]*n,qe()}function qe(){return Ne=ut=null,mt}return function(){return e=t.apply(this,arguments),mt.invert=e.invert&&We,st()}}function zG(t){return function(e,n){var r=ja(e),s=ja(n),u=t(r*s);return[u*s*Va(e),u*Va(n)]}}function BG(t){return function(e,n){var r=c3(e*e+n*n),s=t(r),u=Va(s),p=ja(s);return[Db(e*u,r*p),iv(r&&n*u/r)]}}var rse=zG(function(t){return c3(2/(1+t))});rse.invert=BG(function(t){return 2*iv(t/2)});var UG=zG(function(t){return(t=IG(t))&&t/Va(t)});UG.invert=BG(function(t){return t});function ise(){return tse(UG).scale(79.4188).clipAngle(180-.001)}function O8(t,e){return[t,e]}O8.invert=O8;function iA(t,e,n){n=n||{};var r=n.units||"kilometers",s=n.steps||8;if(!t)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof s!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(s<=0)throw new Error("steps must be greater than 0");var u=[];switch(t.type){case"GeometryCollection":return M9(t,function(p){var g=DE(p,e,r,s);g&&u.push(g)}),hp(u);case"FeatureCollection":return mb(t,function(p){var g=DE(p,e,r,s);g&&mb(g,function(l){l&&u.push(l)})}),hp(u)}return DE(t,e,r,s)}function DE(t,e,n,r){var s=t.properties||{},u=t.type==="Feature"?t.geometry:t;if(u.type==="GeometryCollection"){var p=[];return M9(t,function(re){var _e=DE(re,e,n,r);_e&&p.push(_e)}),hp(p)}var g=sse(u),l={type:u.type,coordinates:VG(u.coordinates,g)},E=new ZI,P=E.read(l),O=yM(_M(e,n),"meters"),j=Ll.bufferOp(P,O,r),$=new hG;if(j=$.write(j),!jG(j.coordinates)){var Y={type:j.type,coordinates:GG(j.coordinates,g)};return id(Y,s)}}function jG(t){return Array.isArray(t[0])?jG(t[0]):isNaN(t[0])}function VG(t,e){return typeof t[0]!="object"?e(t):t.map(function(n){return VG(n,e)})}function GG(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(n){return GG(n,e)})}function sse(t){var e=gie(t).geometry.coordinates,n=[-e[0],-e[1]];return ise().rotate(n).scale(Xl)}function sA(t){const{rotation:e,coordinates:n,modelSize:r}=t,[s,u]=n,{x:p,y:g}=r,l=e2(p,"meters"),E=e2(g/2,"meters"),P=gM([[[s-l,u-E],[s+l,u-E],[s+l,u+E],[s-l,u+E],[s-l,u-E]]]);if(e.z!==0){const O=pb(e.z);pie(P,-O,{pivot:[n[0],n[1]],mutate:!0})}return P}function ose(t,e=-4){const n=t.geometry,r=ase(n,e);return r.properties=t.properties,r}function ase(t,e=50){return iA(t,e,{units:"meters"})}function lse(t){t.addSource("naturtyper-utvalgte",{type:"geojson",data:Lre}),t.addLayer({id:"border",type:"line",source:"naturtyper-utvalgte",paint:{"line-color":"red","line-width":1,"line-dasharray":[2,1]},filter:["all",["==","utvalgtNaturtype","UN03"]]}),t.addLayer({id:"hul-eik",type:"fill",source:"naturtyper-utvalgte",paint:{"fill-color":"red","fill-opacity":.4},filter:["all",["==","utvalgtNaturtype","UN03"]]})}function use(t){t.addSource("ullevl_Eiendomsgrense",{type:"geojson",data:Ore}),t.addLayer({id:"ullevl-Eiendomsgrense",type:"line",source:"ullevl_Eiendomsgrense",paint:{"line-color":"green","line-width":2}})}function cse(t,e){t.addSource("Eiendoms_teig",{type:"geojson",data:e}),t.addLayer({id:"Eiendoms_teig",type:"fill",source:"Eiendoms_teig",paint:{"fill-color":"green","fill-opacity":.2}}),hse(t,e),console.log('Buildings:{["type": "111 - Enebolig","type": "181 - Garasjeuthus anneks til bolig",], AREAL = !??!?!}'),console.log("Eidoms teig {Areal=noko,}")}function hse(t,e){const n=ose(e,-4);t.addSource("Eiendomsgrense_bygg_Tillatt_Line",{type:"geojson",data:n}),t.addLayer({id:"Eiendomsgrense_bygg_Tillatt_Line",type:"line",source:"Eiendomsgrense_bygg_Tillatt_Line",paint:{"line-color":"red","line-width":1,"line-dasharray":[2,1]}})}function dse(t){t.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),t.setTerrain({source:"mapbox-dem",exaggeration:1})}var HG={};Object.defineProperty(HG,"__esModule",{value:!0});class fse{constructor(e){this._pitch=e.pitch||70,this._bearing=e.bearing||null,this._minpitchzoom=e.minpitchzoom||null}onAdd(e){this._map=e;let n=this;return this._btn=document.createElement("button"),this._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-pitchtoggle-3d",this._btn.type="button",this._btn["aria-label"]="Toggle Pitch",this._btn.onclick=function(){if(e.getPitch()===0){let r={pitch:n._pitch,bearing:0,zoom:e.getZoom()};n._bearing?r.bearing=n._bearing:r.bearing=e.getBearing(),n._minpitchzoom&&e.getZoom()>n._minpitchzoom&&(r.zoom=n._minpitchzoom),e.easeTo(r),n._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-pitchtoggle-2d"}else e.easeTo({pitch:0,bearing:e.getBearing()}),n._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-pitchtoggle-3d"},this._map.on("pitchend",function(){n._map&&(n._map.getPitch()===0?n._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-pitchtoggle-3d":n._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-pitchtoggle-2d")}),this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl mapboxgl-ctrl-group",this._container.appendChild(this._btn),this._container}onRemove(){!this._container||!this._container.parentNode||!this._map||(this._container.parentNode.removeChild(this._container),this._map=void 0)}}var pse=HG.default=fse;function WG(t,e){return function(){return t.apply(e,arguments)}}const{toString:mse}=Object.prototype,{getPrototypeOf:oA}=Object,RM=(t=>e=>{const n=mse.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Vm=t=>(t=t.toLowerCase(),e=>RM(e)===t),NM=t=>e=>typeof e===t,{isArray:h3}=Array,r9=NM("undefined");function gse(t){return t!==null&&!r9(t)&&t.constructor!==null&&!r9(t.constructor)&&Jd(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const qG=Vm("ArrayBuffer");function yse(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&qG(t.buffer),e}const _se=NM("string"),Jd=NM("function"),$G=NM("number"),DM=t=>t!==null&&typeof t=="object",vse=t=>t===!0||t===!1,OE=t=>{if(RM(t)!=="object")return!1;const e=oA(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},xse=Vm("Date"),bse=Vm("File"),wse=Vm("Blob"),Ese=Vm("FileList"),Sse=t=>DM(t)&&Jd(t.pipe),Tse=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Jd(t.append)&&((e=RM(t))==="formdata"||e==="object"&&Jd(t.toString)&&t.toString()==="[object FormData]"))},Mse=Vm("URLSearchParams"),kse=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function N9(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),h3(t))for(r=0,s=t.length;r<s;r++)e.call(null,t[r],r,t);else{const u=n?Object.getOwnPropertyNames(t):Object.keys(t),p=u.length;let g;for(r=0;r<p;r++)g=u[r],e.call(null,t[g],g,t)}}function XG(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,s;for(;r-- >0;)if(s=n[r],e===s.toLowerCase())return s;return null}const ZG=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,YG=t=>!r9(t)&&t!==ZG;function a2(){const{caseless:t}=YG(this)&&this||{},e={},n=(r,s)=>{const u=t&&XG(e,s)||s;OE(e[u])&&OE(r)?e[u]=a2(e[u],r):OE(r)?e[u]=a2({},r):h3(r)?e[u]=r.slice():e[u]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&N9(arguments[r],n);return e}const Cse=(t,e,n,{allOwnKeys:r}={})=>(N9(e,(s,u)=>{n&&Jd(s)?t[u]=WG(s,n):t[u]=s},{allOwnKeys:r}),t),Ise=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Ase=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Lse=(t,e,n,r)=>{let s,u,p;const g={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),u=s.length;u-- >0;)p=s[u],(!r||r(p,t,e))&&!g[p]&&(e[p]=t[p],g[p]=!0);t=n!==!1&&oA(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},Pse=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},Rse=t=>{if(!t)return null;if(h3(t))return t;let e=t.length;if(!$G(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},Nse=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&oA(Uint8Array)),Dse=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const u=s.value;e.call(t,u[0],u[1])}},Ose=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},Fse=Vm("HTMLFormElement"),zse=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),F8=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Bse=Vm("RegExp"),KG=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};N9(n,(s,u)=>{let p;(p=e(s,u,t))!==!1&&(r[u]=p||s)}),Object.defineProperties(t,r)},Use=t=>{KG(t,(e,n)=>{if(Jd(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Jd(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},jse=(t,e)=>{const n={},r=s=>{s.forEach(u=>{n[u]=!0})};return h3(t)?r(t):r(String(t).split(e)),n},Vse=()=>{},Gse=(t,e)=>(t=+t,Number.isFinite(t)?t:e),I7="abcdefghijklmnopqrstuvwxyz",z8="0123456789",JG={DIGIT:z8,ALPHA:I7,ALPHA_DIGIT:I7+I7.toUpperCase()+z8},Hse=(t=16,e=JG.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function Wse(t){return!!(t&&Jd(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const qse=t=>{const e=new Array(10),n=(r,s)=>{if(DM(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const u=h3(r)?[]:{};return N9(r,(p,g)=>{const l=n(p,s+1);!r9(l)&&(u[g]=l)}),e[s]=void 0,u}}return r};return n(t,0)},$se=Vm("AsyncFunction"),Xse=t=>t&&(DM(t)||Jd(t))&&Jd(t.then)&&Jd(t.catch),Qn={isArray:h3,isArrayBuffer:qG,isBuffer:gse,isFormData:Tse,isArrayBufferView:yse,isString:_se,isNumber:$G,isBoolean:vse,isObject:DM,isPlainObject:OE,isUndefined:r9,isDate:xse,isFile:bse,isBlob:wse,isRegExp:Bse,isFunction:Jd,isStream:Sse,isURLSearchParams:Mse,isTypedArray:Nse,isFileList:Ese,forEach:N9,merge:a2,extend:Cse,trim:kse,stripBOM:Ise,inherits:Ase,toFlatObject:Lse,kindOf:RM,kindOfTest:Vm,endsWith:Pse,toArray:Rse,forEachEntry:Dse,matchAll:Ose,isHTMLForm:Fse,hasOwnProperty:F8,hasOwnProp:F8,reduceDescriptors:KG,freezeMethods:Use,toObjectSet:jse,toCamelCase:zse,noop:Vse,toFiniteNumber:Gse,findKey:XG,global:ZG,isContextDefined:YG,ALPHABET:JG,generateString:Hse,isSpecCompliantForm:Wse,toJSONObject:qse,isAsyncFn:$se,isThenable:Xse};function Vs(t,e,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}Qn.inherits(Vs,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Qn.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const QG=Vs.prototype,eH={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{eH[t]={value:t}});Object.defineProperties(Vs,eH);Object.defineProperty(QG,"isAxiosError",{value:!0});Vs.from=(t,e,n,r,s,u)=>{const p=Object.create(QG);return Qn.toFlatObject(t,p,function(l){return l!==Error.prototype},g=>g!=="isAxiosError"),Vs.call(p,t.message,e,n,r,s),p.cause=t,p.name=t.name,u&&Object.assign(p,u),p};const Zse=null;function l2(t){return Qn.isPlainObject(t)||Qn.isArray(t)}function tH(t){return Qn.endsWith(t,"[]")?t.slice(0,-2):t}function B8(t,e,n){return t?t.concat(e).map(function(s,u){return s=tH(s),!n&&u?"["+s+"]":s}).join(n?".":""):e}function Yse(t){return Qn.isArray(t)&&!t.some(l2)}const Kse=Qn.toFlatObject(Qn,{},null,function(e){return/^is[A-Z]/.test(e)});function OM(t,e,n){if(!Qn.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=Qn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(re,_e){return!Qn.isUndefined(_e[re])});const r=n.metaTokens,s=n.visitor||P,u=n.dots,p=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&Qn.isSpecCompliantForm(e);if(!Qn.isFunction(s))throw new TypeError("visitor must be a function");function E(Y){if(Y===null)return"";if(Qn.isDate(Y))return Y.toISOString();if(!l&&Qn.isBlob(Y))throw new Vs("Blob is not supported. Use a Buffer instead.");return Qn.isArrayBuffer(Y)||Qn.isTypedArray(Y)?l&&typeof Blob=="function"?new Blob([Y]):Buffer.from(Y):Y}function P(Y,re,_e){let J=Y;if(Y&&!_e&&typeof Y=="object"){if(Qn.endsWith(re,"{}"))re=r?re:re.slice(0,-2),Y=JSON.stringify(Y);else if(Qn.isArray(Y)&&Yse(Y)||(Qn.isFileList(Y)||Qn.endsWith(re,"[]"))&&(J=Qn.toArray(Y)))return re=tH(re),J.forEach(function(te,ce){!(Qn.isUndefined(te)||te===null)&&e.append(p===!0?B8([re],ce,u):p===null?re:re+"[]",E(te))}),!1}return l2(Y)?!0:(e.append(B8(_e,re,u),E(Y)),!1)}const O=[],j=Object.assign(Kse,{defaultVisitor:P,convertValue:E,isVisitable:l2});function $(Y,re){if(!Qn.isUndefined(Y)){if(O.indexOf(Y)!==-1)throw Error("Circular reference detected in "+re.join("."));O.push(Y),Qn.forEach(Y,function(J,H){(!(Qn.isUndefined(J)||J===null)&&s.call(e,J,Qn.isString(H)?H.trim():H,re,j))===!0&&$(J,re?re.concat(H):[H])}),O.pop()}}if(!Qn.isObject(t))throw new TypeError("data must be an object");return $(t),e}function U8(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function aA(t,e){this._pairs=[],t&&OM(t,this,e)}const nH=aA.prototype;nH.append=function(e,n){this._pairs.push([e,n])};nH.toString=function(e){const n=e?function(r){return e.call(this,r,U8)}:U8;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function Jse(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function rH(t,e,n){if(!e)return t;const r=n&&n.encode||Jse,s=n&&n.serialize;let u;if(s?u=s(e,n):u=Qn.isURLSearchParams(e)?e.toString():new aA(e,n).toString(r),u){const p=t.indexOf("#");p!==-1&&(t=t.slice(0,p)),t+=(t.indexOf("?")===-1?"?":"&")+u}return t}class Qse{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Qn.forEach(this.handlers,function(r){r!==null&&e(r)})}}const j8=Qse,iH={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},eoe=typeof URLSearchParams<"u"?URLSearchParams:aA,toe=typeof FormData<"u"?FormData:null,noe=typeof Blob<"u"?Blob:null,roe={isBrowser:!0,classes:{URLSearchParams:eoe,FormData:toe,Blob:noe},protocols:["http","https","file","blob","url","data"]},sH=typeof window<"u"&&typeof document<"u",ioe=(t=>sH&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),soe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ooe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sH,hasStandardBrowserEnv:ioe,hasStandardBrowserWebWorkerEnv:soe},Symbol.toStringTag,{value:"Module"})),Tm={...ooe,...roe};function aoe(t,e){return OM(t,new Tm.classes.URLSearchParams,Object.assign({visitor:function(n,r,s,u){return Tm.isNode&&Qn.isBuffer(n)?(this.append(r,n.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},e))}function loe(t){return Qn.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function uoe(t){const e={},n=Object.keys(t);let r;const s=n.length;let u;for(r=0;r<s;r++)u=n[r],e[u]=t[u];return e}function oH(t){function e(n,r,s,u){let p=n[u++];const g=Number.isFinite(+p),l=u>=n.length;return p=!p&&Qn.isArray(s)?s.length:p,l?(Qn.hasOwnProp(s,p)?s[p]=[s[p],r]:s[p]=r,!g):((!s[p]||!Qn.isObject(s[p]))&&(s[p]=[]),e(n,r,s[p],u)&&Qn.isArray(s[p])&&(s[p]=uoe(s[p])),!g)}if(Qn.isFormData(t)&&Qn.isFunction(t.entries)){const n={};return Qn.forEachEntry(t,(r,s)=>{e(loe(r),s,n,0)}),n}return null}function coe(t,e,n){if(Qn.isString(t))try{return(e||JSON.parse)(t),Qn.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const lA={transitional:iH,adapter:["xhr","http"],transformRequest:[function(e,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,u=Qn.isObject(e);if(u&&Qn.isHTMLForm(e)&&(e=new FormData(e)),Qn.isFormData(e))return s&&s?JSON.stringify(oH(e)):e;if(Qn.isArrayBuffer(e)||Qn.isBuffer(e)||Qn.isStream(e)||Qn.isFile(e)||Qn.isBlob(e))return e;if(Qn.isArrayBufferView(e))return e.buffer;if(Qn.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let g;if(u){if(r.indexOf("application/x-www-form-urlencoded")>-1)return aoe(e,this.formSerializer).toString();if((g=Qn.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return OM(g?{"files[]":e}:e,l&&new l,this.formSerializer)}}return u||s?(n.setContentType("application/json",!1),coe(e)):e}],transformResponse:[function(e){const n=this.transitional||lA.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(e&&Qn.isString(e)&&(r&&!this.responseType||s)){const p=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(g){if(p)throw g.name==="SyntaxError"?Vs.from(g,Vs.ERR_BAD_RESPONSE,this,null,this.response):g}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Tm.classes.FormData,Blob:Tm.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Qn.forEach(["delete","get","head","post","put","patch"],t=>{lA.headers[t]={}});const uA=lA,hoe=Qn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),doe=t=>{const e={};let n,r,s;return t&&t.split(`
`).forEach(function(p){s=p.indexOf(":"),n=p.substring(0,s).trim().toLowerCase(),r=p.substring(s+1).trim(),!(!n||e[n]&&hoe[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},V8=Symbol("internals");function Dw(t){return t&&String(t).trim().toLowerCase()}function FE(t){return t===!1||t==null?t:Qn.isArray(t)?t.map(FE):String(t)}function foe(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const poe=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function A7(t,e,n,r,s){if(Qn.isFunction(r))return r.call(this,e,n);if(s&&(e=n),!!Qn.isString(e)){if(Qn.isString(r))return e.indexOf(r)!==-1;if(Qn.isRegExp(r))return r.test(e)}}function moe(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function goe(t,e){const n=Qn.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(s,u,p){return this[r].call(this,e,s,u,p)},configurable:!0})})}class FM{constructor(e){e&&this.set(e)}set(e,n,r){const s=this;function u(g,l,E){const P=Dw(l);if(!P)throw new Error("header name must be a non-empty string");const O=Qn.findKey(s,P);(!O||s[O]===void 0||E===!0||E===void 0&&s[O]!==!1)&&(s[O||l]=FE(g))}const p=(g,l)=>Qn.forEach(g,(E,P)=>u(E,P,l));return Qn.isPlainObject(e)||e instanceof this.constructor?p(e,n):Qn.isString(e)&&(e=e.trim())&&!poe(e)?p(doe(e),n):e!=null&&u(n,e,r),this}get(e,n){if(e=Dw(e),e){const r=Qn.findKey(this,e);if(r){const s=this[r];if(!n)return s;if(n===!0)return foe(s);if(Qn.isFunction(n))return n.call(this,s,r);if(Qn.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Dw(e),e){const r=Qn.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||A7(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let s=!1;function u(p){if(p=Dw(p),p){const g=Qn.findKey(r,p);g&&(!n||A7(r,r[g],g,n))&&(delete r[g],s=!0)}}return Qn.isArray(e)?e.forEach(u):u(e),s}clear(e){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const u=n[r];(!e||A7(this,this[u],u,e,!0))&&(delete this[u],s=!0)}return s}normalize(e){const n=this,r={};return Qn.forEach(this,(s,u)=>{const p=Qn.findKey(r,u);if(p){n[p]=FE(s),delete n[u];return}const g=e?moe(u):String(u).trim();g!==u&&delete n[u],n[g]=FE(s),r[g]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Qn.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=e&&Qn.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[V8]=this[V8]={accessors:{}}).accessors,s=this.prototype;function u(p){const g=Dw(p);r[g]||(goe(s,p),r[g]=!0)}return Qn.isArray(e)?e.forEach(u):u(e),this}}FM.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Qn.reduceDescriptors(FM.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});Qn.freezeMethods(FM);const jg=FM;function L7(t,e){const n=this||uA,r=e||n,s=jg.from(r.headers);let u=r.data;return Qn.forEach(t,function(g){u=g.call(n,u,s.normalize(),e?e.status:void 0)}),s.normalize(),u}function aH(t){return!!(t&&t.__CANCEL__)}function D9(t,e,n){Vs.call(this,t??"canceled",Vs.ERR_CANCELED,e,n),this.name="CanceledError"}Qn.inherits(D9,Vs,{__CANCEL__:!0});function yoe(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Vs("Request failed with status code "+n.status,[Vs.ERR_BAD_REQUEST,Vs.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const _oe=Tm.hasStandardBrowserEnv?{write(t,e,n,r,s,u){const p=[t+"="+encodeURIComponent(e)];Qn.isNumber(n)&&p.push("expires="+new Date(n).toGMTString()),Qn.isString(r)&&p.push("path="+r),Qn.isString(s)&&p.push("domain="+s),u===!0&&p.push("secure"),document.cookie=p.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function voe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function xoe(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function lH(t,e){return t&&!voe(e)?xoe(t,e):e}const boe=Tm.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function s(u){let p=u;return e&&(n.setAttribute("href",p),p=n.href),n.setAttribute("href",p),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(p){const g=Qn.isString(p)?s(p):p;return g.protocol===r.protocol&&g.host===r.host}}():function(){return function(){return!0}}();function woe(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Eoe(t,e){t=t||10;const n=new Array(t),r=new Array(t);let s=0,u=0,p;return e=e!==void 0?e:1e3,function(l){const E=Date.now(),P=r[u];p||(p=E),n[s]=l,r[s]=E;let O=u,j=0;for(;O!==s;)j+=n[O++],O=O%t;if(s=(s+1)%t,s===u&&(u=(u+1)%t),E-p<e)return;const $=P&&E-P;return $?Math.round(j*1e3/$):void 0}}function G8(t,e){let n=0;const r=Eoe(50,250);return s=>{const u=s.loaded,p=s.lengthComputable?s.total:void 0,g=u-n,l=r(g),E=u<=p;n=u;const P={loaded:u,total:p,progress:p?u/p:void 0,bytes:g,rate:l||void 0,estimated:l&&p&&E?(p-u)/l:void 0,event:s};P[e?"download":"upload"]=!0,t(P)}}const Soe=typeof XMLHttpRequest<"u",Toe=Soe&&function(t){return new Promise(function(n,r){let s=t.data;const u=jg.from(t.headers).normalize();let{responseType:p,withXSRFToken:g}=t,l;function E(){t.cancelToken&&t.cancelToken.unsubscribe(l),t.signal&&t.signal.removeEventListener("abort",l)}let P;if(Qn.isFormData(s)){if(Tm.hasStandardBrowserEnv||Tm.hasStandardBrowserWebWorkerEnv)u.setContentType(!1);else if((P=u.getContentType())!==!1){const[re,..._e]=P?P.split(";").map(J=>J.trim()).filter(Boolean):[];u.setContentType([re||"multipart/form-data",..._e].join("; "))}}let O=new XMLHttpRequest;if(t.auth){const re=t.auth.username||"",_e=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";u.set("Authorization","Basic "+btoa(re+":"+_e))}const j=lH(t.baseURL,t.url);O.open(t.method.toUpperCase(),rH(j,t.params,t.paramsSerializer),!0),O.timeout=t.timeout;function $(){if(!O)return;const re=jg.from("getAllResponseHeaders"in O&&O.getAllResponseHeaders()),J={data:!p||p==="text"||p==="json"?O.responseText:O.response,status:O.status,statusText:O.statusText,headers:re,config:t,request:O};yoe(function(te){n(te),E()},function(te){r(te),E()},J),O=null}if("onloadend"in O?O.onloadend=$:O.onreadystatechange=function(){!O||O.readyState!==4||O.status===0&&!(O.responseURL&&O.responseURL.indexOf("file:")===0)||setTimeout($)},O.onabort=function(){O&&(r(new Vs("Request aborted",Vs.ECONNABORTED,t,O)),O=null)},O.onerror=function(){r(new Vs("Network Error",Vs.ERR_NETWORK,t,O)),O=null},O.ontimeout=function(){let _e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const J=t.transitional||iH;t.timeoutErrorMessage&&(_e=t.timeoutErrorMessage),r(new Vs(_e,J.clarifyTimeoutError?Vs.ETIMEDOUT:Vs.ECONNABORTED,t,O)),O=null},Tm.hasStandardBrowserEnv&&(g&&Qn.isFunction(g)&&(g=g(t)),g||g!==!1&&boe(j))){const re=t.xsrfHeaderName&&t.xsrfCookieName&&_oe.read(t.xsrfCookieName);re&&u.set(t.xsrfHeaderName,re)}s===void 0&&u.setContentType(null),"setRequestHeader"in O&&Qn.forEach(u.toJSON(),function(_e,J){O.setRequestHeader(J,_e)}),Qn.isUndefined(t.withCredentials)||(O.withCredentials=!!t.withCredentials),p&&p!=="json"&&(O.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&O.addEventListener("progress",G8(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&O.upload&&O.upload.addEventListener("progress",G8(t.onUploadProgress)),(t.cancelToken||t.signal)&&(l=re=>{O&&(r(!re||re.type?new D9(null,t,O):re),O.abort(),O=null)},t.cancelToken&&t.cancelToken.subscribe(l),t.signal&&(t.signal.aborted?l():t.signal.addEventListener("abort",l)));const Y=woe(j);if(Y&&Tm.protocols.indexOf(Y)===-1){r(new Vs("Unsupported protocol "+Y+":",Vs.ERR_BAD_REQUEST,t));return}O.send(s||null)})},u2={http:Zse,xhr:Toe};Qn.forEach(u2,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const H8=t=>`- ${t}`,Moe=t=>Qn.isFunction(t)||t===null||t===!1,uH={getAdapter:t=>{t=Qn.isArray(t)?t:[t];const{length:e}=t;let n,r;const s={};for(let u=0;u<e;u++){n=t[u];let p;if(r=n,!Moe(n)&&(r=u2[(p=String(n)).toLowerCase()],r===void 0))throw new Vs(`Unknown adapter '${p}'`);if(r)break;s[p||"#"+u]=r}if(!r){const u=Object.entries(s).map(([g,l])=>`adapter ${g} `+(l===!1?"is not supported by the environment":"is not available in the build"));let p=e?u.length>1?`since :
`+u.map(H8).join(`
`):" "+H8(u[0]):"as no adapter specified";throw new Vs("There is no suitable adapter to dispatch the request "+p,"ERR_NOT_SUPPORT")}return r},adapters:u2};function P7(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new D9(null,t)}function W8(t){return P7(t),t.headers=jg.from(t.headers),t.data=L7.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),uH.getAdapter(t.adapter||uA.adapter)(t).then(function(r){return P7(t),r.data=L7.call(t,t.transformResponse,r),r.headers=jg.from(r.headers),r},function(r){return aH(r)||(P7(t),r&&r.response&&(r.response.data=L7.call(t,t.transformResponse,r.response),r.response.headers=jg.from(r.response.headers))),Promise.reject(r)})}const q8=t=>t instanceof jg?t.toJSON():t;function zb(t,e){e=e||{};const n={};function r(E,P,O){return Qn.isPlainObject(E)&&Qn.isPlainObject(P)?Qn.merge.call({caseless:O},E,P):Qn.isPlainObject(P)?Qn.merge({},P):Qn.isArray(P)?P.slice():P}function s(E,P,O){if(Qn.isUndefined(P)){if(!Qn.isUndefined(E))return r(void 0,E,O)}else return r(E,P,O)}function u(E,P){if(!Qn.isUndefined(P))return r(void 0,P)}function p(E,P){if(Qn.isUndefined(P)){if(!Qn.isUndefined(E))return r(void 0,E)}else return r(void 0,P)}function g(E,P,O){if(O in e)return r(E,P);if(O in t)return r(void 0,E)}const l={url:u,method:u,data:u,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,withXSRFToken:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:g,headers:(E,P)=>s(q8(E),q8(P),!0)};return Qn.forEach(Object.keys(Object.assign({},t,e)),function(P){const O=l[P]||s,j=O(t[P],e[P],P);Qn.isUndefined(j)&&O!==g||(n[P]=j)}),n}const cH="1.6.2",cA={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{cA[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const $8={};cA.transitional=function(e,n,r){function s(u,p){return"[Axios v"+cH+"] Transitional option '"+u+"'"+p+(r?". "+r:"")}return(u,p,g)=>{if(e===!1)throw new Vs(s(p," has been removed"+(n?" in "+n:"")),Vs.ERR_DEPRECATED);return n&&!$8[p]&&($8[p]=!0,console.warn(s(p," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(u,p,g):!0}};function koe(t,e,n){if(typeof t!="object")throw new Vs("options must be an object",Vs.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const u=r[s],p=e[u];if(p){const g=t[u],l=g===void 0||p(g,u,t);if(l!==!0)throw new Vs("option "+u+" must be "+l,Vs.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Vs("Unknown option "+u,Vs.ERR_BAD_OPTION)}}const c2={assertOptions:koe,validators:cA},oy=c2.validators;class US{constructor(e){this.defaults=e,this.interceptors={request:new j8,response:new j8}}request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=zb(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:u}=n;r!==void 0&&c2.assertOptions(r,{silentJSONParsing:oy.transitional(oy.boolean),forcedJSONParsing:oy.transitional(oy.boolean),clarifyTimeoutError:oy.transitional(oy.boolean)},!1),s!=null&&(Qn.isFunction(s)?n.paramsSerializer={serialize:s}:c2.assertOptions(s,{encode:oy.function,serialize:oy.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let p=u&&Qn.merge(u.common,u[n.method]);u&&Qn.forEach(["delete","get","head","post","put","patch","common"],Y=>{delete u[Y]}),n.headers=jg.concat(p,u);const g=[];let l=!0;this.interceptors.request.forEach(function(re){typeof re.runWhen=="function"&&re.runWhen(n)===!1||(l=l&&re.synchronous,g.unshift(re.fulfilled,re.rejected))});const E=[];this.interceptors.response.forEach(function(re){E.push(re.fulfilled,re.rejected)});let P,O=0,j;if(!l){const Y=[W8.bind(this),void 0];for(Y.unshift.apply(Y,g),Y.push.apply(Y,E),j=Y.length,P=Promise.resolve(n);O<j;)P=P.then(Y[O++],Y[O++]);return P}j=g.length;let $=n;for(O=0;O<j;){const Y=g[O++],re=g[O++];try{$=Y($)}catch(_e){re.call(this,_e);break}}try{P=W8.call(this,$)}catch(Y){return Promise.reject(Y)}for(O=0,j=E.length;O<j;)P=P.then(E[O++],E[O++]);return P}getUri(e){e=zb(this.defaults,e);const n=lH(e.baseURL,e.url);return rH(n,e.params,e.paramsSerializer)}}Qn.forEach(["delete","get","head","options"],function(e){US.prototype[e]=function(n,r){return this.request(zb(r||{},{method:e,url:n,data:(r||{}).data}))}});Qn.forEach(["post","put","patch"],function(e){function n(r){return function(u,p,g){return this.request(zb(g||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:u,data:p}))}}US.prototype[e]=n(),US.prototype[e+"Form"]=n(!0)});const zE=US;class hA{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(u){n=u});const r=this;this.promise.then(s=>{if(!r._listeners)return;let u=r._listeners.length;for(;u-- >0;)r._listeners[u](s);r._listeners=null}),this.promise.then=s=>{let u;const p=new Promise(g=>{r.subscribe(g),u=g}).then(s);return p.cancel=function(){r.unsubscribe(u)},p},e(function(u,p,g){r.reason||(r.reason=new D9(u,p,g),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new hA(function(s){e=s}),cancel:e}}}const Coe=hA;function Ioe(t){return function(n){return t.apply(null,n)}}function Aoe(t){return Qn.isObject(t)&&t.isAxiosError===!0}const h2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(h2).forEach(([t,e])=>{h2[e]=t});const Loe=h2;function hH(t){const e=new zE(t),n=WG(zE.prototype.request,e);return Qn.extend(n,zE.prototype,e,{allOwnKeys:!0}),Qn.extend(n,e,null,{allOwnKeys:!0}),n.create=function(s){return hH(zb(t,s))},n}const Fl=hH(uA);Fl.Axios=zE;Fl.CanceledError=D9;Fl.CancelToken=Coe;Fl.isCancel=aH;Fl.VERSION=cH;Fl.toFormData=OM;Fl.AxiosError=Vs;Fl.Cancel=Fl.CanceledError;Fl.all=function(e){return Promise.all(e)};Fl.spread=Ioe;Fl.isAxiosError=Aoe;Fl.mergeConfig=zb;Fl.AxiosHeaders=jg;Fl.formToJSON=t=>oH(Qn.isHTMLForm(t)?new FormData(t):t);Fl.getAdapter=uH.getAdapter;Fl.HttpStatusCode=Loe;Fl.default=Fl;const Poe=Fl,Roe="pk.eyJ1IjoibWd0dXNlciIsImEiOiJjbHE2aGl1b2Mwb2k3Mmtwc3J6ZjkxM3N0In0.HiiE9WHT6-RvummmnlU73w";function Noe(t,e){const n={center:[e.lat,e.long],zoom:18,pitch:0,bearing:0},r=new Yk.Map({accessToken:Roe,container:t,style:"mapbox://styles/mgtuser/clq6hqnqg001a01o97vv29h7v",...n});return r.addControl(new Yk.NavigationControl),r.addControl(new m8.ScaleControl),r.addControl(new m8.FullscreenControl),r.addControl(new pse({minpitchzoom:0})),window.tb=new v1.Threebox(r,r.getCanvas().getContext("webgl"),{defaultLights:!0,enableSelectingObjects:!0,enableDraggingObjects:!0,enableRotatingObjects:!0}),r.on("load",async()=>{lse(r),use(r);const s=await Doe(e.long,e.lat,100);cse(r,s),setTimeout(()=>{r.jumpTo(n),t.classList.add("ready")},500)}),r.on("style.load",()=>{dse(r)}),r}async function Doe(t,e,n,r=1){const s=`https://ws.geonorge.no/eiendom/v1/punkt/omrader?ost=${e}&nord=${t}&koordsys=4326&radius=${n}&utkoordsys=4258&maksTreff=${r}`;return(await Poe.get(s)).data.features[0]}const Ooe=[{kontekstType:"Byggesak-treff-aktsomhet-flom",id:"44ef4297-d5a5-4fab-9db3-d67429d7a5f0",tittel:"Aktsomhetsomrde for flom og erosjon",forklarendeTekst:`NVEs aktsomhetskart for flom viser hvilke arealer som kan vre utsatt for flom- og erosjonsfare. Kartet er egnet til bruk i kommuneplanens arealdel. Kartet vil aldri kunne bli helt nyaktig, men er godt nok til  gi en indikasjon p hvor flomfaren br vurderes nrmere, dersom det er aktuelt med ny utbygging. [Klikk her](https://gis3.nve.no/metadata/produktark/Produktark_FlomAktsomhet.pdf) for mer informasjon om aktsomhetskartet.

Sikkerhet mot flom m dokumenteres ivaretatt i henhold til krav gitt i byggteknisk forskrift (TEK17) [ 7-2](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-2/). Se NVEs retningslinjer 2/2011 [Flaum og skredfare i arealplanar](https://publikasjoner.nve.no/retningslinjer/2011/retningslinjer2011_02.pdf) for mer informasjon om videre fremgangsmte.

For tiltak i sikkerhetsklasse F3 og tiltak som omfattes av  7-2 frste ledd, m det alltid gjennomfres en faresonekartlegging/-utredning. **Merk likevel at aktsomhetskartet kan vre unyaktig. Lokale terrengforhold br vurderes fr flomfaren kan utelukkes. Det samme gjelder tilstedevrelsen av mindre bekker som ikke har blitt plukket opp i analysen.**

Langs sm vassdrag (nedbrsfelt < 20 km2) br byggegrense til vassdraget vre minimum 20 m. For strre vassdrag br byggegrense settes til minimum 50-100 meter. Lokalt terreng og hydeforskjell kan tilsi at strre avstand br vurderes.`,lenker:[{href:"https://publikasjoner.nve.no/retningslinjer/2011/retningslinjer2011_02.pdf",tittel:"NVEs retningslinjer 2/2011 Flaum og skredfare i arealplanar"},{href:"http://publikasjoner.nve.no/veileder/2015/veileder2015_03.pdf",tittel:"NVEs veileder 3/2015 Flaumfare langs bekker"},{href:"https://www.nve.no/arealplanlegging/bygge-og-dispensasjonssaker/",tittel:"NVEs nettsider om bygge- og dispensasjonssaker"}],dialogtekst:"Tiltaket ligger innenfor et omrde hvor det kan vre fare for flom og/eller erosjon. Reell fare m avklares og tas hensyn til.",muligeTiltak:`Flytt tiltaket vekk fra fareutsatt omrde.
Dokumenter tilstrekkelig sikkerhet mot flom og erosjon i henhold til krav gitt i byggteknisk forskrift (TEK17)  7-2.`,veiledning:"Merk likevel at aktsomhetskartet kan vre unyaktig. Lokale terrengforhold br vurderes fr flomfaren kan utelukkes. Det samme gjelder tilstedevrelsen av mindre bekker som ikke har blitt plukket opp i analysen.",status:"Ferdig",datasett:{tittel:"Flom aktsomhetsomrder",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/60c5024f-bf93-4d7a-888a-5fe001427195",bufferAvstand:null,bufferText:"Tiltaket ligger nrt et omrde hvor det kan vre fare for flom. Reell flomfare m avklares og tas hensyn til.",bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Flomaktsomhetsomrader/1.1",typeReferanse:{objekttype:"FlomAktsomhetOmr",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-2/",tittel:"TEK17 Kapittel 7 - Sikkerhet mot naturpkjenninger  7-2. Sikkerhet mot flom og stormflo"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-aktsomhet-Jord-og-flomskred",id:"643479b5-41d9-4d66-8069-18f746141a41",tittel:"Aktsomhetsomrder for jord- og flomskred",forklarendeTekst:"Tiltaket ligger helt eller delvis innenfor aktsomhetsomrde for jord- og flomskred. Dette betyr at omrde kan vre utsatt for skred og en fagkyndig m utrede den reelle faren i henhold til krav til sikkerhet gitt i byggteknisk forskrift (TEK17 ) [ 7-3](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/).",lenker:[{href:"https://veileder-skredfareutredning-bratt-terreng.nve.no/",tittel:"NVEs veileder Utredning av sikkerhet mot skred i bratt terreng"},{href:"https://www.nve.no/arealplanlegging/bygge-og-dispensasjonssaker/",tittel:"NVEs nettsider om bygge- og dispensasjonssaker"}],dialogtekst:"Tiltaket ligger helt eller delvis innenfor aktsomhetsomrde for jord- og flomskred. Tiltakshaver m srge for at sikkerhet mot skred dokumenteres ivaretatt av fagkyndig i henhold til byggteknisk forskrift (TEK17)  7-3.",muligeTiltak:`Flytte tiltaket ut av aktsomhetsomrdet.
F fagkyndig til  dokumentere tilstrekkelig sikkerhet mot skred for tiltaket i henhold til byggteknisk forskrift (TEK17) 7-3.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Jord- og flomskred aktsomhetsomrder",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/30e1883e-70e9-4510-9e97-00edbdcddc02",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Skredaktsomhet/1.2",typeReferanse:{objekttype:"PotensieltSkredfareOmr",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-aktsomhet-kvikkleireskred",id:"d34718b6-da67-47c7-a61d-05f222f8e613",tittel:"Aktsomhetsomrder for kvikkleireskred",forklarendeTekst:`Kvikkleire kan  finnes i omrder hvor det er marin leire. Marin leire finnes under marin grense, som er grensen for hvor hyt havet stod inn over land etter forrige istid. 

Benytt [NVEs kartbaserte veileder](https://arcg.is/T9rXy), steg 12-14 for  avgjre om tiltaket ligger innenfor et aktsomhetsomrde for kvikkleireskred i henhold til [NVEs veileder 1/2019 *Sikkerhet mot kvikkleireskred*](https://publikasjoner.nve.no/veileder/2019/veileder2019_01.pdf). Ved pvist berg i dagen eller grunt til berg (< 2 m), er det ikke fare for at det vil utlses kvikkleireskred.  Du m ogs vurdere om det kan finnes marin leire hyere opp i terrenget - slik at planomrdet kan bli truffet av et skred som lsner derfra (Terreng som kan inng i utlpsomrdet for et skred er typisk 3x lsneomrdets lengde mlt fra nedkant av lsneomrdet (se neste steg for mer informasjon)).`,lenker:[{href:"https://arcg.is/T9rXy",tittel:"NVEs kartbaserte veileder"},{href:"https://publikasjoner.nve.no/veileder/2019/veileder2019_01.pdf",tittel:"NVEs veileder 1/2019 Sikkerhet mot kvikkleireskred"},{href:"https://geo.ngu.no/kart/nadag_mobil/",tittel:"Karttjenesten NADAG (grunnunderskelser)"},{href:"https://www.ngu.no/emne/nadag",tittel:"Informasjon om NADAG (grunnunderskelser)"}],dialogtekst:"Tiltaket ligger under marin grense. Det kan vre marin leire i grunnen og dermed ogs mulighet for at tiltaket ligger innenfor et aktsomhetsomrde for kvikkleireskred.",muligeTiltak:`Sjekk om tiltaket ligger innenfor areal som defineres som aktsomhetsomrde ved  flge steg 12-14 i NVEs kartbaserte veileder.
Flytte tiltaket ut av aktsomhetsomrdet.
F fagkyndig til  dokumentere tilstrekkelig sikkerhet mot skred for tiltaket i henhold til NVEs veileder 1/2019 og byggteknisk forskrift (TEK17) 7-3.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Mulighet for marin leire",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/641a81c2-9354-473b-b8f0-2b1e2ab3930a",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:null,typeReferanse:{objekttype:null,attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-aktsomhet-snskred",id:"7831236b-c9c1-4d5f-af4b-cac0304d7d6e",tittel:"Aktsomhetsomrder for snskred",forklarendeTekst:"Tiltaket ligger helt eller delvis innenfor aktsomhetsomrde for jord- og flomskred. Dette betyr at omrde kan vre utsatt for skred og en fagkyndig m utrede den reelle faren i henhold til krav til sikkerhet gitt i byggteknisk forskrift (TEK17 ) [ 7-3](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/).",lenker:[{href:"https://veileder-skredfareutredning-bratt-terreng.nve.no/",tittel:"NVEs veileder Utredning av sikkerhet mot skred i bratt terreng"},{href:"https://www.nve.no/arealplanlegging/bygge-og-dispensasjonssaker/",tittel:"NVEs nettsider om bygge- og dispensasjonssaker"}],dialogtekst:"Tiltaket ligger helt eller delvis innenfor aktsomhetsomrde for jord- og flomskred. Tiltakshaver m srge for at sikkerhet mot skred dokumenteres ivaretatt av fagkyndig i henhold til byggteknisk forskrift (TEK17)  7-3.",muligeTiltak:`Flytte tiltaket ut av aktsomhetsomrdet.
F fagkyndig til  dokumentere tilstrekkelig sikkerhet mot skred for tiltaket i henhold til byggteknisk forskrift (TEK17) 7-3.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Snskred - aktsomhetsomrder",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/e9542260-6315-4770-b085-86e95179f735",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Skredaktsomhet/1.2",typeReferanse:{objekttype:"PotensieltSkredfareOmr",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-aktsomhet-steinsprang",id:"2d405ce6-98ea-40f9-905b-f8a0d5c96224",tittel:"Aktsomhetsomrder for steinsprang",forklarendeTekst:"Tiltaket ligger helt eller delvis innenfor aktsomhetsomrde for steinsprang. Dette betyr at omrde kan vre utsatt for skred og en fagkyndig m utrede den reelle faren i henhold til krav til sikkerhet gitt i byggteknisk forskrift (TEK17 ) [ 7-3](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/).",lenker:[{href:"https://veileder-skredfareutredning-bratt-terreng.nve.no/",tittel:"NVEs veileder Utredning av sikkerhet mot skred i bratt terreng"},{href:"https://www.nve.no/arealplanlegging/bygge-og-dispensasjonssaker/",tittel:"NVEs nettsider om bygge- og dispensasjonssaker"}],dialogtekst:"Tiltaket ligger helt eller delvis innenfor aktsomhetsomrde for steinsprang. Tiltakshaver m srge for at sikkerhet mot skred dokumenteres ivaretatt av fagkyndig i henhold til byggteknisk forskrift (TEK17)  7-3.",muligeTiltak:`Flytte tiltaket ut av aktsomhetsomrdet.
F fagkyndig til  dokumentere tilstrekkelig sikkerhet mot skred for tiltaket i henhold til byggteknisk forskrift (TEK17) 7-3.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Steinsprang - aktsomhetsomrder",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/02c6d51c-4e8c-4948-a620-dc046c8cb747",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Skredaktsomhet/1.2",typeReferanse:{objekttype:"PotensieltSkredfareOmr",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-brnner",id:"83356f63-ada8-437b-8cc9-ae8f73cf1a3b",tittel:"Brnner",forklarendeTekst:"Dataene viser lokalisering av grunnvanns- og energibrnner. Det er innmeldingsplikt av brnner i Norge. Borefirma skal registrere brnner nr det bores, men privatpersoner kan etterregistrere brnner.",lenker:[{href:"https://www.ngu.no/grunnvanninorge",tittel:"Grunnvann i Norge"}],dialogtekst:"Data om brnnen er basert p informasjon meldt inn av borefirma.",muligeTiltak:"",veiledning:"Om det finnes eksisterende brnner kan det vre nyttig  vite for ev.  dele brnn eller i forhold til deleggelse eller pvirkning av eksisterende brnner.",status:"Ferdig",datasett:{tittel:"Grunnvannsborehull",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/82cd33ef-52dd-4c83-b2d6-e55a0941b33b",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"Produktspesifikasjon for Grunnvannsborehull er tilgjengelig p https://register.geonorge.no/data/documents/produktspesifikasjoner_Grunnvannsborehull_v1_produktspesifikasjon-ngu-grunnvannsborehull-ver1_0_.pdf",typeReferanse:{objekttype:"GrunnvannBorehull",attributt:null,kodeverdi:null}},referanse:null,tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-dybde-til-fjell",id:"aeae22d8-0880-495a-9978-3a6ff97503bf",tittel:"Dybde til fjell",forklarendeTekst:"Boredata kan gi informasjon om dybde til fjell. ",lenker:[{href:"https://geo.ngu.no/kart/nadag_mobil/",tittel:"Karttjenesten NADAG (grunnunderskelser)"},{href:"https://geo.ngu.no/kart/granada_mobil/",tittel:"Karttjenesten GRANADA (Nasjonal grunnvannsdatabase)"},{href:"https://geo.ngu.no/kart/losmasse_mobil/",tittel:"Karttjenesten Lsmasser"}],dialogtekst:"Informasjon om grunnforhold kan man finne p lsmassekart fra NGU. For  f Informasjon om forholdene under overflaten kan man f.eks. benytte data fra boringer. Informasjon om boringer finnes bde i GRANADA (nasjonal grunnvannsdatabase) og i NADAG (nasjonal database for grunnunderskelse). Bde data fra lsmassekart og fra boringer vil vre av ulik kvalitet og detaljeringsgrad. Og omrdene er grovt kartlagt i overflaten i forhold til utbredelsen av lsmasser.",muligeTiltak:"Boredata kan gi verdifull informasjon, og det anbefales  sjekke hva som finnes av informasjon om boringer i databasene NADAG (geotekniske grunnunderskelser) og GRANADA (grunnvannsborehull) for det aktuelle omrdet.",veiledning:"",status:"Ferdig",datasett:{tittel:"Grunnvannsborehull",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/82cd33ef-52dd-4c83-b2d6-e55a0941b33b",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/GrunnvannBorehull/1.0",typeReferanse:{objekttype:"GrunnvannBorehull",attributt:"boretLengdeTilBerg",kodeverdi:null}},referanse:null,tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-energianlegg",id:"cc04ba06-1ad4-40cc-b961-389786a269ad",tittel:"Hensynssone for energianlegg",forklarendeTekst:`Sentral- og regionalnettanlegg, transformatorstasjoner og andre strre kraftledninger som krever konsesjon etter energilova er unntatt saksbehandling etter pbl, jf.  1-3. Mindre hyspenningsanlegg innenfor omrdekonsesjonene faller innenfor virkeomrdet til pbl. Disse kan reguleres som "Teknisk infrastruktur" etter pbl  11-7 nr. 2.

Til en konsesjon kan det flge rettighet til et rydde- og byggeforbudsbeltet, ogs omtalt som klausuleringsbelte, ryddebelte o.l. Dette er en korridor som nettselskapene fr bruksrett til, for  kunne drifte og vedlikeholde nettanleggene p en forsvarlig mte. Nettselskapene bestemmer hva som er tillatt utover de absolutte kravene som fremkommer av forskrift om elektriske forsyningsanlegg. Innenfor beltet vil et nettselskap normalt ikke tillate oppfring av nybygg. Det er ingen fast bredde p byggeforbudsbeltet, men basert p erfaring fra konsesjonssknader er totalt rydde- og byggeforbudsbelte for 66/132 kV p 20-30 meter og for 300/420 kV p 40 meter. 

Det m vurderes om tiltaket skal avklares med netteier.

Minstekrav til avstand til kraftledninger er regulert gjennom forskrift om elektriske forsyningsanlegg. Direktoratet for samfunnssikkerhet og beredskap (DSB) har i Veiledning til forskrift om elektriske forsyningsanlegg publisert tabeller med minsteavstandskrav til kraftledninger. De absolutte avstandskravene er i strrelsesorden 2-10 meter. `,lenker:[{href:"https://www.dsb.no/lover/elektriske-anlegg-og-elektrisk-utstyr/veiledning-til-forskrift/veiledning-til-forskrift-om-elektriske-forsyningsanlegg/",tittel:" Veiledning til forskrift om elektriske forsyningsanlegg"}],dialogtekst:"Tiltaket ligger nrt energianlegg (Hyspentlinjer, transformatorstasjoner, etc. Det kan foreligge restriksjoner for oppfring av tiltak nrt slike anlegg.",muligeTiltak:`Plasser tiltaket lenger vekk fra energianlegget.
Ta kontakt med netteier for avklaring om det er greit at tiltaket gjennomfres.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Nettanlegg",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/9f71a24b-9997-409f-8e42-ce6f0c62e073",bufferAvstand:40,bufferText:"Tiltaket ligger nrt energianlegg (Hyspentlinjer, transformatorstasjoner, etc. Det kan foreligge restriksjoner for oppfring av tiltak nrt slike anlegg.",bufferMuligeTiltak:`Plasser tiltaket lenger vekk fra energianlegget.
Ta kontakt med netteier for avklaring om det er greit at tiltaket gjennomfres.`,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Nettanlegg/1.0",typeReferanse:{objekttype:"EL_Luftlinje",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/NL/lov/1990-06-29-50",tittel:"Energilova"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-faresone-fjellskred",id:"a43cee7f-bcc4-44a9-b144-419a0c134a25",tittel:"Faresoner for fjellskred",forklarendeTekst:`Gjennom det statlige kartleggingsprogrammet for fjellskred blir ustabile fjellparti i Norge kartlagt og overvket. NVE har ansvar for  kartlegge faren for fjellskred, og NGU utfrer arbeidet p oppdrag fra NVE. Det blir gjort en systematisk oversiktskartlegging for  avdekke mulige ustabile fjellparti.

Ustabile fjellparti er klassifisert med fare og risiko. Utvalgte fjellpartier overvkes kontinuerlig eller periodisk. Hvis fjellskredet treffer elv eller sj oppstr det en flodblge (sekundr virkning) som ogs kan berre omrder langt fra skredet. For utvalgte fjellskredobjekt er fareomrder fra flodblgen kartlagt som faresoner med sannsynlighet. Faresonene kan brukes direkte i arealplanlegging.

Krav til sikkerhet er gitt i byggteknisk forskrift (TEK17) [ 7-3](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/). For sekundromrder fra kontinuerlig overvkede fjellpartier kan unntaksregel i TEK17 [ 7-4](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-4/) vurderes. Merk her at det ikke gjelder frsteledds-tiltak og at alle vilkr i  7-4 skal vre oppfylt.`,lenker:[],dialogtekst:"Tiltaket ligger i et omrde som kan bli berrt av fjellskred eller sekundre virkninger etter et fjellskred.",muligeTiltak:`Sjekke hvilke krav til sikkerhet som gjelder for nsket tiltak i byggteknisk forskrift (TEK17)  7-3 og 7-4 og om nsket tiltak likevel oppfyller krav til sikkerhet.
Flytte tiltaket ut av faresonen.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.
`,veiledning:"",status:"Ferdig",datasett:{tittel:"Store fjellskred",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/17149f79-1289-4e3c-b964-94113eeb14c8",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"",typeReferanse:{objekttype:null,attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-faresone-flom",id:"5adab8dc-b327-49ed-9336-e85fe2453a05",tittel:"Faresoner for flom",forklarendeTekst:`Det er utarbeidet faresonekart for flom (flomsonekart) for mange flomutsatte byer og tettsteder.

Faresonekartene inneholder faresoner som skal vise oversvmt areal ved ulike gjentaksintervall for flom, for eksempel 20-rsflom, 200-rsflom, 1000-rsflom, og 200-rsflom med klimapslag. I omrder der det finnes bde aktsomhetskart og faresonekart, gjelder faresonekartene foran aktsomhetskartene. Merk at faresonekartene i mange tilfeller ikke inkluderer mindre sidevassdrag. I slike tilfeller m aktsomhetskartet likevel vurderes.

Selv om omrdet er farekartlagt kan det likevel vre lov  oppfre tiltak. Sjekk hvilke krav til sikkerhet som gjelder for nsket tiltak i byggteknisk forskrift (TEK17) [ 7-2](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-2/).  For  se detaljerte kart som viser utstrekning av de ulike flomsonene (med ulike gjentagelsesintervall), se [NVEs temakart for flom](https://temakart.nve.no/tema/flomsone). Avgjr hvordan det skal tas hensyn til klimaendringer, sjekk [klimaprofil](hhttps://klimaservicesenter.no/) for ditt fylke.

Ligger tiltaket innenfor kartlagt omrde, men utenfor aktuell faresone, er det dokumentert at sikkerhet mot flom er ivaretatt. Ligger planomrdet innenfor aktuell flomsone m det planlegges sikringstiltak.`,lenker:[],dialogtekst:"Tiltaket ligger helt eller delvis innenfor en faresone for flom.",muligeTiltak:`Sjekke hvilke krav til sikkerhet som gjelder for nsket tiltak i byggteknisk forskrift (TEK17)  7-2 og om nsket tiltak likevel oppfyller krav til sikkerhet.
Flytte tiltaket ut av faresonen.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Flomsoner",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/e95008fc-0945-4d66-8bc9-e50ab3f50401",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Flomsoner/1.1",typeReferanse:{objekttype:"Analyseomrde",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-2/",tittel:"TEK17 Kapittel 7 - Sikkerhet mot naturpkjenninger  7-2. Sikkerhet mot flom og stormflo"},annenLov:{href:"Plan- og bygningsloven  28-1",tittel:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-faresone-kvikkleireskred",id:"2e84d54f-9e93-4559-8214-8cb21567fa04",tittel:"Faresoner for kvikkleireskred",forklarendeTekst:"Kvikkleire kan finnes i omrder hvor det er marin leire. Marin leire finnes under marin grense, som er grensen for hvor hyt havet stod inn over land etter forrige istid. Det er utarbeidet faresonekart for kvikkleireskred for utvalgte omrder i Norge.",lenker:[],dialogtekst:"Tiltaket ligger innenfor kartlagt faresone for kvikkleireskred. Det m dokumenteres at tiltaket tilfredsstiller krav til sikkerhet i henhold til NVEs veileder 1/2019 og byggteknisk forskrift (TEK17) 7-3.",muligeTiltak:`Flytte tiltaket ut av faresonen.
Sjekk om tiltaket faller inn under tiltakskategori K0 i henhold til NVEs veileder 1/2019, og om tiltaket kan utfres etter fringer gitt i vedlegg to i veilederen. Hvis fringer ikke kan flges, m det utarbeides en geoteknisk vurderings om dokumenterer tilfredsstillende sikkerhet.
F geotekniker med tilstrekkelig kompetanse til  dokumentere tilstrekkelig sikkerhet mot skred for tiltaket i henhold til NVEs veileder 1/2019 og byggteknisk forskrift (TEK17) 7-3.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Skredfaresoner",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/b2d5aaf8-79ac-40f3-9cd6-fdc30bc42ea1",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Skredfare/1.2",typeReferanse:{objekttype:"KvikkleireFaresone",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-faresone-skred-i-bratt-terreng",id:"c37bac2a-1e32-49f8-b633-a305c166ec38",tittel:"Faresoner for skred i bratt terreng",forklarendeTekst:`Det er utarbeidet faresonekart for skred i bratt terreng (snskred, srpeskred, flomskred, jordskred, steinsprang og steinskred) for utvalgte omrder i Norge. Faresonekartene viser vanligvis faresoner med rlig gjentaksintervall i henhold til sikkerhetskravene i TEK17  7-3. Les mer om faresonekartene p NVEs nettsider [Om kartlegging av skredfare i bratt terreng.](https://www.nve.no/naturfare/utredning-av-naturfare/om-kart-og-kartlegging-av-naturfare/om-kartlegging-av-skredfare-i-bratt-terreng/).

I omrder som er farekartlagt kan man se bort ifra aktsomhetskartene for ulike typer skred i bratt terreng.

Selv om omrdet er farekartlagt  kan det likevel vre lov  oppfre tiltak. Sjekk hvilke krav til sikkerhet som gjelder for nsket tiltak i byggteknisk forskrift (TEK17) [ 7-3](https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/). For  se detaljerte kart som viser utstrekning av de ulike faresonene (med ulike gjentagelsesintervall), se [NVEs temakart for skred i bratt terreng](https://temakart.nve.no/tema/skredfaresone). 

Ligger tiltaket innenfor kartlagt omrde, men utenfor aktuell skredsone, er det dokumentert at sikkerhet mot skred er ivaretatt. Ligger planomrdet innenfor aktuell skredsone m det planlegges sikringstiltak.`,lenker:[],dialogtekst:"Tiltaket ligger helt eller delvis innenfor et omrde hvor reell fare for skred i bratt terreng er blitt kartlagt.",muligeTiltak:`Sjekke hvilke krav til sikkerhet som gjelder for nsket tiltak i byggteknisk forskrift (TEK17)  7-3 og om nsket tiltak likevel oppfyller krav til sikkerhet.
Flytte tiltaket ut av faresonen.
Hvis behov, utfre sikringstiltak etter rd fra fagkyndig.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Skredfaresoner",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/b2d5aaf8-79ac-40f3-9cd6-fdc30bc42ea1",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Skredfare/1.2",typeReferanse:{objekttype:"AnalyseomrdeGr",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17/7/7-3/",tittel:"TEK 17 Kapittel 7 - Sikkerhet mot naturpkjenninger -  7-3 Sikkerhet mot skred"},annenLov:{href:"https://lovdata.no/dokument/NL/lov/2008-06-27-71/KAPITTEL_4-9#%C2%A728-1",tittel:"Plan- og bygningsloven  28-1"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-grunnvannspotensiale",id:"7e7686c3-114e-4398-bfaf-a5f4f3faeb25",tittel:"Grunnvannspotensiale",forklarendeTekst:"Grunnvann brukes til mange forml. Der grunnvann tradisjonelt ble brukt til drikkevann, brukes grunnvann i dag i industri, akvakultur og ikke minst som en kilde til energi.",lenker:[{href:"https://www.ngu.no/grunnvanninorge",tittel:"Grunnvann i Norge"}],dialogtekst:"Grunnvannspotensialet er grovt kartlagt, og andre kilder kan gi mer detaljert informasjon.",muligeTiltak:"Boredata og andre grunnunderskelser kan ogs gi verdifull informasjon. Kontakt konsulenter for mer detaljert vurdering av grunnvannspotensialet.",veiledning:"",status:"Ferdig",datasett:{tittel:"Lsmasser",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/3de4ddf6-d6b8-4398-8222-f5c47791a757",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"Produktspesifikasjon for Lsmasser er tilgjengelig p  https://register.geonorge.no/data/documents/produktspesifikasjoner_L%C3%B8smasser%20N50%20N250_v2_produktspesifikasjon-ngu-losmasser-ver3_0_.pdf",typeReferanse:{objekttype:"LosmasseFlate",attributt:"GrunnvannPotensiale",kodeverdi:null}},referanse:null,tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-marin-leire",id:"c2d69df7-2cb1-44c3-a0d0-de8f706850a6",tittel:"Mulighet for marin leire",forklarendeTekst:"Omrder med marin leire kan vre utsatt for skred. Omrdene er grovt kartlagt i overflaten med hensyn til utbredelse av marin leire og data vil vre av ulik kvalitet. Boredata vil gi mer informasjon om lsmasser og deres egenskaper i dybden.",lenker:[{href:"https://www.ngu.no/emne/mulighet-marin-leire",tittel:"Informasjon om datasettet mulighet for marin leire"},{href:"https://geo.ngu.no/kart/losmasse_mobil/",tittel:"Karttjenesten Lsmasser"},{href:"https://geo.ngu.no/kart/nadag_mobil/",tittel:"Karttjenesten NADAG (grunnunderskelser)"},{href:"https://www.ngu.no/emne/nadag",tittel:"Informasjon om NADAG (grunnunderskelser)"}],dialogtekst:"Vurder skredfaren i dette omrdet om du skal sette opp bygninger eller legge adkomstvei.",muligeTiltak:"For  f vurdert skredfaren, kan du kontakte kommunen eller konsulent med geoteknisk kompetanse.",veiledning:"Her kan du lese mer om mulighet for marin leire: https://www.ngu.no/emne/mulighet-marin-leire",status:"Ferdig",datasett:{tittel:"Mulighet for marin leire",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/641a81c2-9354-473b-b8f0-2b1e2ab3930a",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"Produktspesifikasjon er tilgjengelig p https://register.geonorge.no/register/versjoner/produktspesifikasjoner/norges-geologiske-undersokelse/mulighet-for-marin-leire",typeReferanse:{objekttype:"",attributt:"MuligMarinLeire",kodeverdi:""}},referanse:null,tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-mulighet-for-spredningsgrft",id:"e7d74d62-be3a-47b4-a61c-6ae66bad2823",tittel:"Mulighet for spredningsgrft",forklarendeTekst:`Her kan du antagelig bruke godkjent biologisk/kjemisk minirenseanlegg. Renseanlegg skal vre sertifisert.
Renset avlpsvann kan ledes til vassdrag med minimum 5 meters dyp, jordbruksgrft eller konstruert spredningsgrft.
`,lenker:[{href:"https://geo.ngu.no/kart/losmasse_mobil/",tittel:"Velg temakart Infiltrasjonspotensiale i karttjenesten for Lsmasser"},{href:"https://nibio.no/tema/miljo/mindre-avlop/valg-av-renselosning",tittel:"Lenke til NIBIO om hvordan velge avlpslsning"}],dialogtekst:"Avlpsmulighetene er grovt kartlagt, og andre kilder kan gi mer detaljert informasjon.",muligeTiltak:"Det anbefales at du foretar en befaring p stedet, gjerne sammen med konsulenter eller ingenirer med kompetanse p vann- og avlpsanlegg. Boredata kan ogs gi verdifull informasjon. Kontakt kommunen vedrrende eventuelle krav mht. areal.",veiledning:"I karttjenesten for Lsmasser velges temakart Infiltrasjonspotensiale.",status:"Ferdig",datasett:{tittel:"Lsmasser",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/3de4ddf6-d6b8-4398-8222-f5c47791a757",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"Produktspesifikasjon for Lsmasser er tilgjengelig p  https://register.geonorge.no/data/documents/produktspesifikasjoner_L%C3%B8smasser%20N50%20N250_v2_produktspesifikasjon-ngu-losmasser-ver3_0_.pdf",typeReferanse:{objekttype:"LosmasseFlate",attributt:"InfiltrasjonPotensiale",kodeverdi:null}},referanse:null,tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturfare-stormflo-200-rs",id:"9331fc68-bd27-4484-8570-c191a6bda5b1",tittel:"Stormflo 200-rs niv",forklarendeTekst:"Stormflo oppstr nr pvirkning fra vret gjr havets vannstand ekstra hy. Lavt luftttrykk frer til hy vannstand og vind kan i tillegg presse vann inn mot land. En ekstrem hy vannstand fr vi nr en stormflo faller sammen med hyt tidevann. Vr oppmerksom p at effekten av eventuelle overflateblger vil komme i tillegg. Et 200-rs returniv er basert p en statistisk beregning p historiske data og betyr at nivet blir oversvmt i gjennomsnitt en gang hvert 200. r.",lenker:[{href:"https://kartverket.no/til-sjos/se-havniva/referanseniva/vannstandsniva/",tittel:"Les mer om vannstandsniv"},{href:"https://www.kartverket.no/til-sjos/se-havniva/lar-om-tidevann-og-vannstand/hva-er-stormflo/",tittel:"Les mer om stormflo"}],dialogtekst:"Bygget er plassert i en risikosone for ekstrem vannstand (stormflo)",muligeTiltak:`- Flytt bygget ut av utsatt omrde
- Sikre bygget mot oversvmmelse ved  heve byggegrunnen til flomsikkert niv, bygge uten kjeller, eller bygge flomvoller eller andre konstruksjoner som holder vannet unna bebyggelsen.
- Dimensjonere og konstruere byggverket for at det tler belastning og unngr skade
Dersom du har behov for hjelp, kan du engasjere et rdgivende ingenirfirma med byggeteknisk og flomfaglig kompetanse`,veiledning:"",status:"Ferdig",datasett:{tittel:"Stormflo og havniv",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/fbb95c67-623f-430a-9fa5-9cfcea8366b3",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Stormflo/20180601",typeReferanse:{objekttype:"StormfloN_Intervall200r",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/byggereglene/byggteknisk-forskrift-tek17/7/7-2/",tittel:"TEK-17"},annenLov:null,rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturfare-stormflo-200-rs",id:"219f938f-e551-476d-bac0-74ac56779976",tittel:"Stormflo 200-rs niv med havnivstigning",forklarendeTekst:`Stormflo oppstr nr pvirkning fra vret gjr havets vannstand ekstra hy. Lavt luftttrykk frer til hy vannstand og vind kan i tillegg presse vann inn mot land. En ekstrem hy vannstand fr vi nr en stormflo faller sammen med hyt tidevann. Vr oppmerksom p at effekten av eventuelle overflateblger vil komme i tillegg. Et 20-rs returniv er basert p en statistisk beregning p historiske data og betyr at nivet blir oversvmt i gjennomsnitt en gang hvert 20. r.


Det globale havnivet stiger i hovedsak p grunn av kte havtemperaturer og smelting av isbreer. Samtidig som det globale havnivet stiger, reduserer landheving virkningen av kt havniv langs Norskekysten. Havnivstigningen som ligger til grunn her er det beregnet for perioden 2081-2100, for et hyt utslippsscenario (RCP8.5) og inkluderer effekten av landheving.`,lenker:[{href:"https://kartverket.no/til-sjos/se-havniva/referanseniva/vannstandsniva/",tittel:"Les mer om vannstandsniv"},{href:"https://www.kartverket.no/til-sjos/se-havniva/lar-om-tidevann-og-vannstand/hva-er-stormflo/",tittel:"Les mer om stormflo"},{href:"https://www.kartverket.no/til-sjos/se-havniva/havniva/framtidig-havniva-langs-norskekysten/",tittel:"Les mer om havnivstigning"}],dialogtekst:"Bygget er plassert i en risikosone for ekstrem vannstand (stormflo) med havnivstigning.",muligeTiltak:`- Flytt bygget ut av utsatt omrde
- Sikre bygget mot oversvmmelse ved  heve byggegrunnen til flomsikkert niv, bygge uten kjeller, eller bygge flomvoller eller andre konstruksjoner som holder vannet unna bebyggelsen.
- Dimensjonere og konstruere byggverket for at det tler belastning og unngr skade
Dersom du har behov for hjelp, kan du engasjere et rdgivende ingenirfirma med byggeteknisk og flomfaglig kompetanse`,veiledning:"",status:"Ferdig",datasett:{tittel:"Stormflo og havniv",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/fbb95c67-623f-430a-9fa5-9cfcea8366b3",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Stormflo/20180601",typeReferanse:{objekttype:"Stormflo2090_Intervall200r",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/byggereglene/byggteknisk-forskrift-tek17/7/7-2/",tittel:"TEK-17"},annenLov:null,rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturfare-stormflo-20-rs",id:"0c5dc043-e5b3-4349-8587-9b464d013d6b",tittel:"Stormflo 20-rs niv",forklarendeTekst:"Stormflo oppstr nr pvirkning fra vret gjr havets vannstand ekstra hy. Lavt luftttrykk frer til hy vannstand og vind kan i tillegg presse vann inn mot land. En ekstrem hy vannstand fr vi nr en stormflo faller sammen med hyt tidevann. Vr oppmerksom p at effekten av eventuelle overflateblger vil komme i tillegg. Et 20-rs returniv er basert p en statistisk beregning p historiske data og betyr at nivet blir oversvmt i gjennomsnitt en gang hvert 20. r.",lenker:[{href:"https://kartverket.no/til-sjos/se-havniva/referanseniva/vannstandsniva/",tittel:"Les mer om vannstandsniv"},{href:"https://www.kartverket.no/til-sjos/se-havniva/lar-om-tidevann-og-vannstand/hva-er-stormflo/",tittel:"Les mer om stormflo"}],dialogtekst:"Bygget er plassert i en risikosone for ekstrem vannstand (stormflo)",muligeTiltak:`- Flytt bygget ut av utsatt omrde
- Sikre bygget mot oversvmmelse ved  heve byggegrunnen til flomsikkert niv, bygge uten kjeller, eller bygge flomvoller eller andre konstruksjoner som holder vannet unna bebyggelsen.
- Dimensjonere og konstruere byggverket for at det tler belastning og unngr skade
Dersom du har behov for hjelp, kan du engasjere et rdgivende ingenirfirma med byggeteknisk og flomfaglig kompetanse`,veiledning:"",status:"Ferdig",datasett:{tittel:"Stormflo og havniv",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/fbb95c67-623f-430a-9fa5-9cfcea8366b3",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/Stormflo/20180601",typeReferanse:{objekttype:"StormfloN_Intervall20r",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/byggereglene/byggteknisk-forskrift-tek17/7/7-2/",tittel:"TEK-17"},annenLov:null,rundskrivFraDep:null},tekniskKommentar:"Gr p lag/objekttyper i datasettet og ikke kodeverdi",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"5f93f5a9-84f8-4529-b5ae-5a02597d914b",tittel:"Hule eiker",forklarendeTekst:"Eiketrr kan bli flere hundre r gamle og et stort mangfold av arter lever i hulrom, dype barkesprekker og p dde grener i slike trr. S mange som 1500 arter kan leve p og i hule eiker. Hul eik er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden.",lenker:[{href:"https://miljostatus.miljodirektoratet.no/tema/naturomrader-pa-land/skog/hule-eiker/",tittel:"Les mer om hul eik"}],dialogtekst:"Tiltaket er plassert nrmere enn 15m fra stammen til en hul eik som er utvalgt naturtype.",muligeTiltak:`Tiltaket kan plasseres 15m eller lengre fra stammen.
Dersom tiltaket m plasseres nrmere enn 15m fra stammen, skal kommunen vurdere tiltaket i henhold til bestemmelsene i naturmangfoldloven. Rotsystemet p treet m ikke skades. En arborist kan vurdere det for deg. Gi en begrunnelse for behovet og legg ved en eventuell uttalelse fra arborist.`,veiledning:"En arborist er en utdannet yrkesutver innenfor trekonservering, tre-vedlikehold og planting. Arborister er kompetente nr det kommer til trr og deres behov, og de er utdannet og utrustet for  gjennomfre de behandlingene som trengs. (Kilde: http://www.trefelling.nu/arborist/). Du kan finne arborister via Gule sider eller andre katalogtjenester.",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:15,bufferText:"Tiltaket er plassert like ved en hul eik som er utvalgt naturtype. Dette kan pvirke den hule eika negativt.",bufferMuligeTiltak:`Unng rigg og annen aktivitet tett opp til den hule eika.
Avgrens tilgang til den hule eika ved hjelp av byggegjerde.
Dersom tiltaket ikke kan gjennomfres uten at den hule eika pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"Hule eiker"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"41c0fc6a-b938-4877-9a62-183ecba6cd48",tittel:"Slttemark",forklarendeTekst:"Slttemarker er ugjdsla enger som tradisjonelt ble sltt for  skaffe vinterfr til husdyrene. Svrt mange arter har slttemarker som leveomrde. I dag har bde slttemarkene og mange av artene som lever der blitt sjeldne. Slttemark er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden. Vis hensyn til forekomsten av utvalgt naturtype ved  unng eller minimere eventuelle inngrep i slttemarka.",lenker:[{href:"https://miljostatus.miljodirektoratet.no/tema/naturomrader-pa-land/kulturlandskap/slattemark/",tittel:"Les mer om slttemark"}],dialogtekst:"Tiltaket kommer i overlapp med en slttemark som er utvalgt naturtype. Det kan fre til avslag p byggesknaden din.",muligeTiltak:`Plasser tiltaket utenom slttemarka.
Plasser tiltaket i ytterkanten av slttemarka.
Gjr tiltaket s lite arealkrevende som mulig.
Dersom tiltaket helt eller delvis m plasseres inn p slttemarka, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:25,bufferText:"Tiltaket er plassert like ved en slttemark som er utvalgt naturtype. Dette kan pvirke slttemarka negativt.",bufferMuligeTiltak:`Gjr tiltaket s lite arealkrevende som mulig.
Unng at tunge kjretyer o.l. m inn p slttemarka i byggeperioden.
Dersom tiltaket ikke kan gjennomfres uten at slttemarka pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"Slttemark"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"f6e743f8-1081-469c-829c-f13201ec943c",tittel:"Slttemyr",forklarendeTekst:"Slttemyr er myr med vegetasjon som er betinget av tradisjonell sltt og som fortsatt brer preg av dette. Svrt mange arter har slttemyrer som leveomrde. I dag er bde slttemyrene og mange av artene som lever der blitt sjeldne. Slttemyr er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden. Vis hensyn til forekomsten av utvalgt naturtype ved  unng eller minimere eventuelle inngrep i slttemyra.",lenker:[{href:"https://miljostatus.miljodirektoratet.no/tema/naturomrader-pa-land/kulturlandskap/slattemyr/",tittel:"Les mer om slttemyr"}],dialogtekst:"Tiltaket kommer i overlapp med en slttemyr som er utvalgt naturtype. Det kan fre til avslag p byggesknaden din.",muligeTiltak:`Plasser tiltaket utenom slttemyra.
Plasser tiltaket i ytterkanten av slttemyra.
Gjr tiltaket s lite arealkrevende som mulig.
Dersom tiltaket helt eller delvis m plasseres inn p slttemyra, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:25,bufferText:"Tiltaket er plassert like ved en slttemyr som er utvalgt naturtype. Det kan pvirke slttemyra negativt og kan fre til avslag p byggesknaden din.",bufferMuligeTiltak:`Gjr tiltaket s lite arealkrevende som mulig.
Pass p at tiltaket ikke pvirker vanntilfrsel og avrenning fra slttemyra.
Unng at tunge kjretyer o.l. m inn p slttemyra i byggeperioden.
Dersom tiltaket ikke kan gjennomfres uten at slttemyra pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"Slttemark"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"a2e49e65-2f5e-4188-b848-94cbc32315ff",tittel:"Kalklindeskog",forklarendeTekst:"Kalklindeskog er en skogstype som vokser p kalkrik mark. Skogtypen finnes nesten bare i Norge. Svrt mange trua arter lever i kalklindeskog, og naturtypen er i tilbakegang. Kalklindeskog er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden. Vis hensyn til forekomsten av utvalgt naturtype ved  unng eller minimere eventuelle inngrep i kalklindeskogen.",lenker:[{href:"https://miljostatus.miljodirektoratet.no/tema/naturomrader-pa-land/skog/kalklindeskog/",tittel:"Les mer om kalklindeskog"}],dialogtekst:"Tiltaket kommer i overlapp med en kalklindeskog som er utvalgt naturtype. Det kan fre til avslag p byggesknaden din.",muligeTiltak:`Plasser tiltaket utenom kalklindskogen.
Plasser tiltaket i ytterkanten av kalklindeskogen.
Gjr tiltaket s lite arealkrevende som mulig.
Dersom tiltaket helt eller delvis m plasseres inn i kalklindeskogen, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:25,bufferText:"Tiltaket er plassert like ved en kalklindeskog som er utvalgt naturtype. Dette kan pvirke kalklindeskogen negativt.",bufferMuligeTiltak:`Gjr tiltaket s lite arealkrevende som mulig.
Unng at felling av trr og bruk av tunge kjretyer i kalklindeskogen i byggeperioden.
Ikke plasser tiltaket slik at det skapes et senere behov for  felle trr i kalklindeskogen.
Dersom tiltaket ikke kan gjennomfres uten at kalklindeskogen pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"Kalklindeskog"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"0f18bebe-9fe3-44dd-b6d1-b34e932ff438",tittel:"Kalksjer",forklarendeTekst:"Kalksjer er innsjer, tjern og dammer som er naturlig pvirket av kalk. De er unike levesteder for flere sjeldne kalkkrevende arter, srlig kransalger. Kalksjer er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden. Vis hensyn til forekomsten av utvalgt naturtype ved  unng eller minimere eventuelle inngrep i kalksjen eller i bekker som drenerer til sjen.",lenker:[{href:"https://miljostatus.miljodirektoratet.no/tema/ferskvann/kalksjoer/",tittel:"Les mer om kalksjer"}],dialogtekst:"Tiltaket kommer i overlapp med en kalksj som er utvalgt naturtype. Det kan fre til avslag p byggesknaden din.",muligeTiltak:`Plasser tiltaket utenom kalksjen, og  unng pvirkning av tilfrselsbekker.
Unng ogs myr eller vegetasjonsbelter som hrer til sjen.
Dersom tiltaket helt eller delvis m plasseres inn p kalksjen, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:50,bufferText:"Tiltaket er plassert like ved en kalksj som er utvalgt naturtype. Det kan pvirke kalksjen negativt og kan fre til avslag p byggesknaden din.",bufferMuligeTiltak:`Gjr tiltaket s lite arealkrevende som mulig.
Pass p at tiltaket ikke pvirker vanntilfrsel av avrenning fra kalksjen.
Unng myr eller vegetasjonsbelter som hrer til sjen.
Dersom tiltaket ikke kan gjennomfres uten at kalksjen pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"Kalksjer"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"ee52d09e-341b-493d-942b-09e5a218fdca",tittel:"Kystlynghei",forklarendeTekst:"Kystlyngheier er flere tusen r gamle kulturmarkstyper som er formet av beiting, brenning og sltt. Svrt mange arter har kystlynghei som leveomrde. Utbredelsen av kystlynghei er sterkt redusert. Kystlynghei er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden. Vis hensyn til forekomsten av utvalgt naturtype ved  unng eller minimere eventuelle inngrep i kystlyngheia.",lenker:[{href:"https://miljostatus.miljodirektoratet.no/tema/naturomrader-pa-land/kulturlandskap/kystlynghei/",tittel:"Les mer om kystlynghei"}],dialogtekst:"Tiltaket kommer i overlapp med en kystlynghei som er utvalgt naturtype. Det kan fre til avslag p byggesknaden din.",muligeTiltak:`Plasser tiltaket utenom kystlyngheia.
Plasser tiltaket i ytterkanten av kystlyngheia.
Gjr tiltaket s lite arealkrevende som mulig.
Dersom tiltaket helt eller delvis m plasseres inn p kystlyngheia, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:25,bufferText:"Tiltaket er plassert like ved en kystlynghei som er utvalgt naturtype. Dette kan pvirke kystlyngheia negativt.",bufferMuligeTiltak:`Gjr tiltaket s lite arealkrevende som mulig.
Unng at tunge kjretyer o.l. m inn p kystlyngheia i byggeperioden.
Dersom tiltaket ikke kan gjennomfres uten at kystlyngheia pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"Kystlynghei"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-naturtyper-utvalgte",id:"39592497-57fc-418b-b3f1-8947aa8453b7",tittel:"pen grunnlendt kalkmark i boreonemoral sone",forklarendeTekst:"pen grunnlendt kalkrik mark i boreonemoral sone er en svrt artsrik naturtype som oftest finnes som sm arealer i overganger mellom nakent berg og skogsmark. Naturtypen og mange av artene som lever der, er trua. Naturtypen har en srstlig utbredelse i Norge, med tyngdepunkt i kalkomrdene i Oslofjorden. TIl sammen har vi bare 1-2 km2. pen grunnlendt kalkmark i boreonemoral sone er en utvalgt naturtype som skal tas hensyn til og vurderes i byggesknaden. Vis hensyn til forekomsten ved  unng eller minimere eventuelle inngrep.",lenker:[{href:"https://artsdatabanken.no/RLN2018/266/aapen_grunnlendt_kalkrik_mark_i_boreonemoral_sone",tittel:"Rdlistevurdering 2018 (Artsdatabanken)"}],dialogtekst:"Tiltaket kommer i overlapp med en pen grunnlendt kalkmark som er utvalgt naturtype. Det kan fre til avslag p byggesknaden din.",muligeTiltak:`Plasser tiltaket utenom kalkmarka.
Plasser tiltaket i ytterkanten av kalkmarka.
Gjr tiltaket s lite arealkrevende som mulig.
Dersom tiltaket helt eller delvis m plasseres inn p kalkmarka, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,veiledning:"",status:"Ferdig",datasett:{tittel:"Naturtyper - utvalgte",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/2c0072de-f702-401e-bfb3-5ad3d08d4c2d",bufferAvstand:25,bufferText:"Tiltaket er plassert like ved en pen grunnlendt kalkmark som er utvalgt naturtype. Dette kan pvirke kalkmarka negativt.",bufferMuligeTiltak:`Gjr tiltaket s lite arealkrevende som mulig.
Unng at tunge kjretyer o.l. m inn p kalkmarka i byggeperioden.
Dersom tiltaket ikke kan gjennomfres uten at kalkmarka pvirkes, skal kommunen vurdere tiltaket i henhold til naturmangfoldloven. Gi en begrunnelse for behovet.`,gmlSkjema:null,navnerom:"https://data.geonorge.no/sosi/natur",typeReferanse:{objekttype:null,attributt:"utvalgtNaturtype",kodeverdi:"pen grunnlendt kalkmark i boreonemoral sone"}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/SF/forskrift/2011-05-13-512",tittel:"Forskrift om utvalgte naturtyper etter naturmangfoldloven"},rundskrivFraDep:null},tekniskKommentar:"Gjeldende versjon av datasettet Naturtyper - Utvalgte ble satt i drift 19.10.2021. Produktspesifikasjon er under arbeid.",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-radon-aktsomhet",id:"a39a8a5d-3fd3-4d0e-a634-bd70dae880ca",tittel:"Radon aktsomhet",forklarendeTekst:"Datasettet/kartet Radon aktsomhet gir en frste vurdering av aktsomhet for radon, og kan brukes som et hjelpemiddel for  vurdere behovet for nye mlinger i boliger og ved planlegging av nybygging av boliger. Har et omrde ftt klassifiseringen hy aktsomhet eller srlig hy aktsomhet br det tas hensyn til dette. Kartet viser sannsynlighet for at det kan vre eller vil bli et radonproblem.",lenker:[{href:"https://www.ngu.no/emne/radonfare",tittel:"Les mer om radonfare"},{href:"https://geo.ngu.no/kart/radon_mobil/",tittel:"Karttjenesten Radon aktsomhet"}],dialogtekst:"Det nasjonale aktsomhetskartet for radon gir kommunene et grunnlag for en frste vurdering av radonfare. I omrder med hy eller srlig hy aktsomhet br kommunen underske om det er behov for  flge opp radonproblematikken i henhold til Plan og bygningsloven og Folkehelseloven med forskrifter. Kartet kan ikke benyttes til  forutsi radonkonsentrasjonen i enkeltbygninger. Den eneste mten  f sikker kunnskap om radon i en bygning, er  gjennomfre en mling.",muligeTiltak:"Ref krav i Byggteknisk forskrift (TEK17)",veiledning:"",status:"Ferdig",datasett:{tittel:"Radon aktsomhet",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/dc0605f3-2301-4abe-a91f-6da42464c281",bufferAvstand:null,bufferText:null,bufferMuligeTiltak:null,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/RadonAktsomhet/1.1",typeReferanse:{objekttype:"RadonAktsomhet",attributt:"aktsomhetGrad",kodeverdi:""}},referanse:{tittel:"Mangler",tek17:{href:"https://dibk.no/regelverk/byggteknisk-forskrift-tek17",tittel:"Byggteknisk forskrift TEK17"},annenLov:null,rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-vannforsyningssystemer",id:"ea9ba9b3-5f0d-4bf8-b4d1-0d8c276f3e1a",tittel:"Sm vannverk",forklarendeTekst:"Sm vannverk leverer drikkevann til inntil ca. 50 personer, bde til boliger og fritidseiendommer. I Norge har vi flere tusen sm vannerk, gjerne i lite bebygde strk. Vannverkseieren er ansvarlig for  levere trygt, nok drikkevann, mens det er forbudt for alle  forurense drikkevannet. De som skal gjre inngrep i omrder med sm vannverk, m srge for at det ikke utgjr en risiko for drikkevannet.",lenker:[{href:"https://lovdata.no/dokument/SF/forskrift/2016-12-22-1868?q=drikkevannsforskriften",tittel:"Drikkevannsforskriften"},{href:"https://www.mattilsynet.no/mat_og_vann/drikkevann/registreringogplangodkjenning/",tittel:"Mattilsynet: drikkevannshensyn"}],dialogtekst:"Inngrepet er planlagt i nrheten av ett eller flere vannverk. Det kan f innvirkning p sknadsbehandlingen.",muligeTiltak:`Tilpass om mulig inngrepet for  unng omrder der drikkevann kan vre utsatt. Gjr tiltak for  minimere forurensning fra anleggsmaskiner og annen aktivitet under og etter inngrepet. 
Om ndvendig kan dere etablere en annen drikkevannskilde, enten permanent, eller midlertidig mens inngrepet pgr. Det gr ogs an  srge for midlertidig leveranse av annet drikkevann. Det m skje i samrd med vannverkseier. 
Det er uansett en fordel  kontakte vannverkseieren, bde for  informere, og avklare forhold rundt inngrepet, og leveranse av trygt og nok drikkevann. `,veiledning:"",status:"Ferdig",datasett:{tittel:"Sm vannverk",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/8adefb0a-d020-4adb-858f-a27d03dd4184",bufferAvstand:300,bufferText:"Inngrepet er planlagt i nrheten av ett eller flere vannverk, og kan pvirke leveransen av drikkevann.",bufferMuligeTiltak:"Planlegg inngrepet slik at drikkevannet blir pvirket s lite som mulig. Gjr vannverkseieren kjent med inngrepet. Vurder tiltak som minimerer risikoen for forurensning under og etter inngrepet. Husk ogs  vurdere tiltak ved bygging av infrastruktur (vei ol.) som er ndvendig for  gjennomfre inngrepet.",gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/SmaVannverk/20210701",typeReferanse:{objekttype:"Vannverk",attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/forskrift/2016-12-22-1868/4",tittel:"Drikkevannsforskriften  4"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""},{kontekstType:"Byggesak-treff-vassdrag",id:"1e5a3686-450d-4a3b-a479-e14f638e20bf",tittel:"Nrhet til vassdrag",forklarendeTekst:`Det enkelte tiltaket m ta hensyn til allmenne interesser i vassdrag og grunnvann, jf. vannressursloven (vrl).

Vannressursloven har som forml  sikre en samfunnsmessig forsvarlig bruk og forvaltning av vassdrag og grunnvann. Det foreligger en generell aktsomhetsplikt for tiltak i vassdrag, som innebrer at enhver skal opptre aktsomt slik at skade eller ulempe i vassdraget for allmenne eller private interesser unngs.  

Som vassdrag regnes alt stillestende eller rennende overflatevann med rssikker vannfring, med tilhrende bunn og bredder inntil hyeste vanlige flomvannstand. Selv om et vassdrag p enkelte strekninger renner under jorden eller under isbreer, regnes det i sin helhet som vassdrag. Som vassdrag regnes ogs vannlp uten rssikker vannfring dersom det atskiller seg tydelig fra omgivelsene (vannressursloven 2).

Det foreligger en generell aktsomhetsplikt for tiltak i vassdrag (vrl 5), som innebrer at enhver skal opptre aktsomt slik at skade eller ulempe i vassdraget for allmenne eller private interesser unngs. Begrepet allmenne interesser omfatter et bredt spekter av interesser av samfunnsmessig betydning, herunder biologisk mangfold, fiske, flom- og erosjonsfare, kulturverdier, landskap og friluftsliv i tilknytning til vassdrag og grunnvann. 

Dersom et tiltak legger til rette for vassdragstiltak som kan vre til nevneverdig skade eller ulempe for noen allmenne interesser i vassdraget, vil NVE vurdere tiltaket opp mot bestemmelsene i vannressursloven (konsesjonspliktsvurdering).


`,lenker:[{href:"https://publikasjoner.nve.no/veileder/2021/veileder2021_01.pdf",tittel:"NVEs veileder 1/2021 Veileder til vannressursloven og NVEs behandling av vassdrags- og grunnvannstiltak."}],dialogtekst:"Tiltaket ligger nrt et vassdrag. Det m tas hensyn til vassdraget. Unng inngrep i vassdraget. Unng bekkelukkinger. Unng inngrep i kantvegetasjon",muligeTiltak:`Flytte tiltaket lengre vekk fra vassdraget.
Unng inngrep i vassdraget. 
Unng bekkelukkinger. 
Unng inngrep i kantvegetasjonen.
Unng kt tilfrsel av vann til vassdrag, som flge av kt overvannsavrenning som kan medfre skader og ulemper i form av kte flomproblemer og oversvmmelse nedstrms.
`,veiledning:"Tiltaket ligger nrt et vassdrag. Det m tas hensyn til vassdraget.",status:"Ferdig",datasett:{tittel:"FKB-Vann",urlMetadata:"https://kartkatalog.geonorge.no/metadata/uuid/595e47d9-d201-479c-a77d-cbc1f573a76b",bufferAvstand:20,bufferText:null,bufferMuligeTiltak:`Flytte tiltaket lengre vekk fra vassdraget.
Unng inngrep i vassdraget. 
Unng bekkelukkinger. 
Unng inngrep i kantvegetasjonen.
Unng kt tilfrsel av vann til vassdrag, som flge av kt overvannsavrenning som kan medfre skader og ulemper i form av kte flomproblemer og oversvmmelse nedstrms.`,gmlSkjema:null,navnerom:"http://skjema.geonorge.no/SOSI/produktspesifikasjon/FKB-Vann/4.61",typeReferanse:{objekttype:null,attributt:null,kodeverdi:null}},referanse:{tittel:"Mangler",tek17:null,annenLov:{href:"https://lovdata.no/dokument/NL/lov/2000-11-24-82",tittel:"Vannressursloven"},rundskrivFraDep:null},tekniskKommentar:"",annenKommentar:"",tegn1:"",tegn2:"",tegn3:"",tegn4:"",tegn5:"",tegn6:""}];function Foe(t){var n;const e=Ooe.find(t);return e?{title:e.tittel,description:e.forklarendeTekst,possibleActions:e.muligeTiltak.split(`
`),links:((n=e.lenker)==null?void 0:n.map(r=>({title:r.tittel,url:r.href})))||[],icon:{tree:bj}}:null}const zoe="_popup_p7vu2_1",Boe="_location_p7vu2_7",Uoe="_description_p7vu2_12",joe="_posibleActions_p7vu2_13",Voe="_links_p7vu2_17",Ow={popup:zoe,location:Boe,description:Uoe,posibleActions:joe,links:Voe};function Goe({contextType:{title:t,location:e,description:n,possibleActions:r,links:s}}){return xn.jsxs("div",{className:Ow.popup,children:[xn.jsx("h3",{children:t}),xn.jsx("div",{className:Ow.location,children:e}),xn.jsx("div",{className:Ow.description,children:n}),xn.jsx("ul",{className:Ow.posibleActions,children:r.map(u=>xn.jsx("li",{children:u},u))}),s?xn.jsx("ul",{className:Ow.links,children:s.map(u=>xn.jsx("li",{children:xn.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",children:u.title})},u.url))}):null]})}const Hoe="_mapContainer_1kcr0_1",Woe="_map_1kcr0_1",qoe="_infoDrawer_1kcr0_10",cE={mapContainer:Hoe,map:Woe,infoDrawer:qoe},$oe={lat:10.731297345319604,long:59.940718947056325,altitude:95,realestatetotal:1534,occupied:265,possible:.25},Xoe={lat:6.000046563369295,long:60.24463724364986,altitude:60,realestatetotal:1534,occupied:265,possible:.25},u5={oslo:$oe,kvam:Xoe};function Zoe(){const{location:t}=PT();return xn.jsxs("div",{children:[xn.jsx("h3",{children:"Om eiendommen"}),xn.jsxs("p",{children:["Total kvadratmeter for tomt: ",xn.jsxs("strong",{children:[u5[t].realestatetotal,"  "]})," ",xn.jsx("br",{}),"Utnyttelsesgraden er ",xn.jsx("strong",{children:" %"}),xn.jsx("br",{}),"Eksisternde bebygd areal er:",xn.jsx("strong",{children:"  BYA"}),xn.jsx("br",{}),"Du kan bygge totalt ",xn.jsx("strong",{children:" BYA"})]})]})}function i9(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=vy(t),s=xM(e),u=s.type,p=e.bbox,g=s.coordinates;if(p&&Yoe(r,p)===!1)return!1;u==="Polygon"&&(g=[g]);for(var l=!1,E=0;E<g.length&&!l;E++)if(X8(r,g[E][0],n.ignoreBoundary)){for(var P=!1,O=1;O<g[E].length&&!P;)X8(r,g[E][O],!n.ignoreBoundary)&&(P=!0),O++;P||(l=!0)}return l}function X8(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var s=0,u=e.length-1;s<e.length;u=s++){var p=e[s][0],g=e[s][1],l=e[u][0],E=e[u][1],P=t[1]*(p-l)+g*(l-t[0])+E*(t[0]-p)===0&&(p-t[0])*(l-t[0])<=0&&(g-t[1])*(E-t[1])<=0;if(P)return!n;var O=g>t[1]!=E>t[1]&&t[0]<(l-p)*(t[1]-g)/(E-g)+p;O&&(r=!r)}return r}function Yoe(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function Z8(t){if(!t)throw new Error("geojson is required");var e=[];return Zg(t,function(n){Koe(n,e)}),hp(e)}function Koe(t,e){var n=[],r=t.geometry;if(r!==null){switch(r.type){case"Polygon":n=gb(r);break;case"LineString":n=[gb(r)]}n.forEach(function(s){var u=Joe(s,t.properties);u.forEach(function(p){p.id=e.length,e.push(p)})})}}function Joe(t,e){var n=[];return t.reduce(function(r,s){var u=rp([r,s],e);return u.bbox=Qoe(r,s),n.push(u),s}),n}function Qoe(t,e){var n=t[0],r=t[1],s=e[0],u=e[1],p=n<s?n:s,g=r<u?r:u,l=n>s?n:s,E=r>u?r:u;return[p,g,l,E]}var dA={exports:{}},dH={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(m2,function(){function n(H,te,ce,Se,Ie){(function Ne(ut,mt,We,Ot,st){for(;Ot>We;){if(Ot-We>600){var qe=Ot-We+1,et=mt-We+1,Q=Math.log(qe),ye=.5*Math.exp(2*Q/3),ge=.5*Math.sqrt(Q*ye*(qe-ye)/qe)*(et-qe/2<0?-1:1),xe=Math.max(We,Math.floor(mt-et*ye/qe+ge)),Ce=Math.min(Ot,Math.floor(mt+(qe-et)*ye/qe+ge));Ne(ut,mt,xe,Ce,st)}var tt=ut[mt],Je=We,rt=Ot;for(r(ut,We,mt),st(ut[Ot],tt)>0&&r(ut,We,Ot);Je<rt;){for(r(ut,Je,rt),Je++,rt--;st(ut[Je],tt)<0;)Je++;for(;st(ut[rt],tt)>0;)rt--}st(ut[We],tt)===0?r(ut,We,rt):r(ut,++rt,Ot),rt<=mt&&(We=rt+1),mt<=rt&&(Ot=rt-1)}})(H,te,ce||0,Se||H.length-1,Ie||s)}function r(H,te,ce){var Se=H[te];H[te]=H[ce],H[ce]=Se}function s(H,te){return H<te?-1:H>te?1:0}var u=function(H){H===void 0&&(H=9),this._maxEntries=Math.max(4,H),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function p(H,te,ce){if(!ce)return te.indexOf(H);for(var Se=0;Se<te.length;Se++)if(ce(H,te[Se]))return Se;return-1}function g(H,te){l(H,0,H.children.length,te,H)}function l(H,te,ce,Se,Ie){Ie||(Ie=_e(null)),Ie.minX=1/0,Ie.minY=1/0,Ie.maxX=-1/0,Ie.maxY=-1/0;for(var Ne=te;Ne<ce;Ne++){var ut=H.children[Ne];E(Ie,H.leaf?Se(ut):ut)}return Ie}function E(H,te){return H.minX=Math.min(H.minX,te.minX),H.minY=Math.min(H.minY,te.minY),H.maxX=Math.max(H.maxX,te.maxX),H.maxY=Math.max(H.maxY,te.maxY),H}function P(H,te){return H.minX-te.minX}function O(H,te){return H.minY-te.minY}function j(H){return(H.maxX-H.minX)*(H.maxY-H.minY)}function $(H){return H.maxX-H.minX+(H.maxY-H.minY)}function Y(H,te){return H.minX<=te.minX&&H.minY<=te.minY&&te.maxX<=H.maxX&&te.maxY<=H.maxY}function re(H,te){return te.minX<=H.maxX&&te.minY<=H.maxY&&te.maxX>=H.minX&&te.maxY>=H.minY}function _e(H){return{children:H,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function J(H,te,ce,Se,Ie){for(var Ne=[te,ce];Ne.length;)if(!((ce=Ne.pop())-(te=Ne.pop())<=Se)){var ut=te+Math.ceil((ce-te)/Se/2)*Se;n(H,ut,te,ce,Ie),Ne.push(te,ut,ut,ce)}}return u.prototype.all=function(){return this._all(this.data,[])},u.prototype.search=function(H){var te=this.data,ce=[];if(!re(H,te))return ce;for(var Se=this.toBBox,Ie=[];te;){for(var Ne=0;Ne<te.children.length;Ne++){var ut=te.children[Ne],mt=te.leaf?Se(ut):ut;re(H,mt)&&(te.leaf?ce.push(ut):Y(H,mt)?this._all(ut,ce):Ie.push(ut))}te=Ie.pop()}return ce},u.prototype.collides=function(H){var te=this.data;if(!re(H,te))return!1;for(var ce=[];te;){for(var Se=0;Se<te.children.length;Se++){var Ie=te.children[Se],Ne=te.leaf?this.toBBox(Ie):Ie;if(re(H,Ne)){if(te.leaf||Y(H,Ne))return!0;ce.push(Ie)}}te=ce.pop()}return!1},u.prototype.load=function(H){if(!H||!H.length)return this;if(H.length<this._minEntries){for(var te=0;te<H.length;te++)this.insert(H[te]);return this}var ce=this._build(H.slice(),0,H.length-1,0);if(this.data.children.length)if(this.data.height===ce.height)this._splitRoot(this.data,ce);else{if(this.data.height<ce.height){var Se=this.data;this.data=ce,ce=Se}this._insert(ce,this.data.height-ce.height-1,!0)}else this.data=ce;return this},u.prototype.insert=function(H){return H&&this._insert(H,this.data.height-1),this},u.prototype.clear=function(){return this.data=_e([]),this},u.prototype.remove=function(H,te){if(!H)return this;for(var ce,Se,Ie,Ne=this.data,ut=this.toBBox(H),mt=[],We=[];Ne||mt.length;){if(Ne||(Ne=mt.pop(),Se=mt[mt.length-1],ce=We.pop(),Ie=!0),Ne.leaf){var Ot=p(H,Ne.children,te);if(Ot!==-1)return Ne.children.splice(Ot,1),mt.push(Ne),this._condense(mt),this}Ie||Ne.leaf||!Y(Ne,ut)?Se?(ce++,Ne=Se.children[ce],Ie=!1):Ne=null:(mt.push(Ne),We.push(ce),ce=0,Se=Ne,Ne=Ne.children[0])}return this},u.prototype.toBBox=function(H){return H},u.prototype.compareMinX=function(H,te){return H.minX-te.minX},u.prototype.compareMinY=function(H,te){return H.minY-te.minY},u.prototype.toJSON=function(){return this.data},u.prototype.fromJSON=function(H){return this.data=H,this},u.prototype._all=function(H,te){for(var ce=[];H;)H.leaf?te.push.apply(te,H.children):ce.push.apply(ce,H.children),H=ce.pop();return te},u.prototype._build=function(H,te,ce,Se){var Ie,Ne=ce-te+1,ut=this._maxEntries;if(Ne<=ut)return g(Ie=_e(H.slice(te,ce+1)),this.toBBox),Ie;Se||(Se=Math.ceil(Math.log(Ne)/Math.log(ut)),ut=Math.ceil(Ne/Math.pow(ut,Se-1))),(Ie=_e([])).leaf=!1,Ie.height=Se;var mt=Math.ceil(Ne/ut),We=mt*Math.ceil(Math.sqrt(ut));J(H,te,ce,We,this.compareMinX);for(var Ot=te;Ot<=ce;Ot+=We){var st=Math.min(Ot+We-1,ce);J(H,Ot,st,mt,this.compareMinY);for(var qe=Ot;qe<=st;qe+=mt){var et=Math.min(qe+mt-1,st);Ie.children.push(this._build(H,qe,et,Se-1))}}return g(Ie,this.toBBox),Ie},u.prototype._chooseSubtree=function(H,te,ce,Se){for(;Se.push(te),!te.leaf&&Se.length-1!==ce;){for(var Ie=1/0,Ne=1/0,ut=void 0,mt=0;mt<te.children.length;mt++){var We=te.children[mt],Ot=j(We),st=(qe=H,et=We,(Math.max(et.maxX,qe.maxX)-Math.min(et.minX,qe.minX))*(Math.max(et.maxY,qe.maxY)-Math.min(et.minY,qe.minY))-Ot);st<Ne?(Ne=st,Ie=Ot<Ie?Ot:Ie,ut=We):st===Ne&&Ot<Ie&&(Ie=Ot,ut=We)}te=ut||te.children[0]}var qe,et;return te},u.prototype._insert=function(H,te,ce){var Se=ce?H:this.toBBox(H),Ie=[],Ne=this._chooseSubtree(Se,this.data,te,Ie);for(Ne.children.push(H),E(Ne,Se);te>=0&&Ie[te].children.length>this._maxEntries;)this._split(Ie,te),te--;this._adjustParentBBoxes(Se,Ie,te)},u.prototype._split=function(H,te){var ce=H[te],Se=ce.children.length,Ie=this._minEntries;this._chooseSplitAxis(ce,Ie,Se);var Ne=this._chooseSplitIndex(ce,Ie,Se),ut=_e(ce.children.splice(Ne,ce.children.length-Ne));ut.height=ce.height,ut.leaf=ce.leaf,g(ce,this.toBBox),g(ut,this.toBBox),te?H[te-1].children.push(ut):this._splitRoot(ce,ut)},u.prototype._splitRoot=function(H,te){this.data=_e([H,te]),this.data.height=H.height+1,this.data.leaf=!1,g(this.data,this.toBBox)},u.prototype._chooseSplitIndex=function(H,te,ce){for(var Se,Ie,Ne,ut,mt,We,Ot,st=1/0,qe=1/0,et=te;et<=ce-te;et++){var Q=l(H,0,et,this.toBBox),ye=l(H,et,ce,this.toBBox),ge=(Ie=Q,Ne=ye,ut=void 0,mt=void 0,We=void 0,Ot=void 0,ut=Math.max(Ie.minX,Ne.minX),mt=Math.max(Ie.minY,Ne.minY),We=Math.min(Ie.maxX,Ne.maxX),Ot=Math.min(Ie.maxY,Ne.maxY),Math.max(0,We-ut)*Math.max(0,Ot-mt)),xe=j(Q)+j(ye);ge<st?(st=ge,Se=et,qe=xe<qe?xe:qe):ge===st&&xe<qe&&(qe=xe,Se=et)}return Se||ce-te},u.prototype._chooseSplitAxis=function(H,te,ce){var Se=H.leaf?this.compareMinX:P,Ie=H.leaf?this.compareMinY:O;this._allDistMargin(H,te,ce,Se)<this._allDistMargin(H,te,ce,Ie)&&H.children.sort(Se)},u.prototype._allDistMargin=function(H,te,ce,Se){H.children.sort(Se);for(var Ie=this.toBBox,Ne=l(H,0,te,Ie),ut=l(H,ce-te,ce,Ie),mt=$(Ne)+$(ut),We=te;We<ce-te;We++){var Ot=H.children[We];E(Ne,H.leaf?Ie(Ot):Ot),mt+=$(Ne)}for(var st=ce-te-1;st>=te;st--){var qe=H.children[st];E(ut,H.leaf?Ie(qe):qe),mt+=$(ut)}return mt},u.prototype._adjustParentBBoxes=function(H,te,ce){for(var Se=ce;Se>=0;Se--)E(te[Se],H)},u.prototype._condense=function(H){for(var te=H.length-1,ce=void 0;te>=0;te--)H[te].children.length===0?te>0?(ce=H[te-1].children).splice(ce.indexOf(H[te]),1):this.clear():g(H[te],this.toBBox)},u})})(dH);var eae=dH.exports;const tae=Ls(Xre),nae=Ls(sie),rae=Ls(mie);var hm=eae,fH=tae,pH=nae,Cx=rae.default,iae=pH.featureEach;pH.coordEach;fH.polygon;var Y8=fH.featureCollection;function mH(t){var e=new hm(t);return e.insert=function(n){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:Cx(n),hm.prototype.insert.call(this,n)},e.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(s){if(s.type!=="Feature")throw new Error("invalid features");s.bbox=s.bbox?s.bbox:Cx(s),r.push(s)}):iae(n,function(s){if(s.type!=="Feature")throw new Error("invalid features");s.bbox=s.bbox?s.bbox:Cx(s),r.push(s)}),hm.prototype.load.call(this,r)},e.remove=function(n,r){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:Cx(n),hm.prototype.remove.call(this,n,r)},e.clear=function(){return hm.prototype.clear.call(this)},e.search=function(n){var r=hm.prototype.search.call(this,this.toBBox(n));return Y8(r)},e.collides=function(n){return hm.prototype.collides.call(this,this.toBBox(n))},e.all=function(){var n=hm.prototype.all.call(this);return Y8(n)},e.toJSON=function(){return hm.prototype.toJSON.call(this)},e.fromJSON=function(n){return hm.prototype.fromJSON.call(this,n)},e.toBBox=function(n){var r;if(n.bbox)r=n.bbox;else if(Array.isArray(n)&&n.length===4)r=n;else if(Array.isArray(n)&&n.length===6)r=[n[0],n[1],n[3],n[4]];else if(n.type==="Feature")r=Cx(n);else if(n.type==="FeatureCollection")r=Cx(n);else throw new Error("invalid geojson");return{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},e}dA.exports=mH;dA.exports.default=mH;var sae=dA.exports;const oae=HS(sae);function fA(t,e){var n={},r=[];if(t.type==="LineString"&&(t=id(t)),e.type==="LineString"&&(e=id(e)),t.type==="Feature"&&e.type==="Feature"&&t.geometry!==null&&e.geometry!==null&&t.geometry.type==="LineString"&&e.geometry.type==="LineString"&&t.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var s=K8(t,e);return s&&r.push(s),hp(r)}var u=oae();return u.load(Z8(e)),mb(Z8(t),function(p){mb(u.search(p),function(g){var l=K8(p,g);if(l){var E=gb(l).join(",");n[E]||(n[E]=!0,r.push(l))}})}),hp(r)}function K8(t,e){var n=gb(t),r=gb(e);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var s=n[0][0],u=n[0][1],p=n[1][0],g=n[1][1],l=r[0][0],E=r[0][1],P=r[1][0],O=r[1][1],j=(O-E)*(p-s)-(P-l)*(g-u),$=(P-l)*(u-E)-(O-E)*(s-l),Y=(p-s)*(u-E)-(g-u)*(s-l);if(j===0)return null;var re=$/j,_e=Y/j;if(re>=0&&re<=1&&_e>=0&&_e<=1){var J=s+re*(p-s),H=u+re*(g-u);return Zh([J,H])}return null}function d2(t,e){e===void 0&&(e={});var n=xM(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),n.type){case"Polygon":return aae(n,e);case"MultiPolygon":return lae(n,e);default:throw new Error("invalid poly")}}function aae(t,e){e===void 0&&(e={});var n=xM(t),r=n.coordinates,s=e.properties?e.properties:t.type==="Feature"?t.properties:{};return gH(r,s)}function lae(t,e){e===void 0&&(e={});var n=xM(t),r=n.coordinates,s=e.properties?e.properties:t.type==="Feature"?t.properties:{},u=[];return r.forEach(function(p){u.push(gH(p,s))}),hp(u)}function gH(t,e){return t.length>1?BI(t,e):rp(t[0],e)}function uae(t,e){var n=!0;return Zg(t,function(r){Zg(e,function(s){if(n===!1)return!1;n=cae(r.geometry,s.geometry)})}),n}function cae(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!pae(t.coordinates,e.coordinates);case"LineString":return!J8(e,t);case"Polygon":return!i9(t,e)}break;case"LineString":switch(e.type){case"Point":return!J8(t,e);case"LineString":return!hae(t,e);case"Polygon":return!Q8(e,t)}break;case"Polygon":switch(e.type){case"Point":return!i9(e,t);case"LineString":return!Q8(t,e);case"Polygon":return!dae(e,t)}}return!1}function J8(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(fae(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function hae(t,e){var n=fA(t,e);return n.features.length>0}function Q8(t,e){for(var n=0,r=e.coordinates;n<r.length;n++){var s=r[n];if(i9(s,t))return!0}var u=fA(e,d2(t));return u.features.length>0}function dae(t,e){for(var n=0,r=t.coordinates[0];n<r.length;n++){var s=r[n];if(i9(s,e))return!0}for(var u=0,p=e.coordinates[0];u<p.length;u++){var g=p[u];if(i9(g,t))return!0}var l=fA(d2(t),d2(e));return l.features.length>0}function fae(t,e,n){var r=n[0]-t[0],s=n[1]-t[1],u=e[0]-t[0],p=e[1]-t[1],g=r*p-s*u;return g!==0?!1:Math.abs(u)>=Math.abs(p)?u>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:p>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]}function pae(t,e){return t[0]===e[0]&&t[1]===e[1]}function eN(t,e){var n=!1;return Zg(t,function(r){Zg(e,function(s){if(n===!0)return!0;n=!uae(r.geometry,s.geometry)})}),n}function us(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}class R7{static equalsWithTolerance(e,n,r){return Math.abs(e-n)<=r}}class r_ extends Error{constructor(e){super(e),this.name=Object.keys({Exception:r_})[0]}toString(){return this.message}}class yo extends r_{constructor(e){super(e),this.name=Object.keys({IllegalArgumentException:yo})[0]}}class Fw{constructor(e,n){this.low=n||0,this.high=e||0}static toBinaryString(e){let n,r="";for(n=2147483648;n>0;n>>>=1)r+=(e.high&n)===n?"1":"0";for(n=2147483648;n>0;n>>>=1)r+=(e.low&n)===n?"1":"0";return r}}function ji(){}ji.NaN=NaN;ji.isNaN=t=>Number.isNaN(t);ji.isInfinite=t=>!Number.isFinite(t);ji.MAX_VALUE=Number.MAX_VALUE;ji.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;ji.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;typeof Float64Array=="function"&&typeof Int32Array=="function"?function(){const n=new Float64Array(1),r=new Int32Array(n.buffer);ji.doubleToLongBits=function(s){n[0]=s;let u=r[0]|0,p=r[1]|0;return(p&2146435072)===2146435072&&p&1048575&&u!==0&&(u=0,p=2146959360),new Fw(p,u)},ji.longBitsToDouble=function(s){return r[0]=s.low,r[1]=s.high,n[0]}}():function(){const e=Math.log2,n=Math.floor,r=Math.pow,s=function(){for(let u=53;u>0;u--){const p=r(2,u)-1;if(n(e(p))+1===u)return p}return 0}();ji.doubleToLongBits=function(u){let p,g,l,E,P,O,j,$,Y;if(u<0||1/u===Number.NEGATIVE_INFINITY?(O=1<<31,u=-u):O=0,u===0)return Y=0,$=O,new Fw($,Y);if(u===1/0)return Y=0,$=O|2146435072,new Fw($,Y);if(u!==u)return Y=0,$=2146959360,new Fw($,Y);if(E=0,Y=0,p=n(u),p>1)if(p<=s)E=n(e(p)),E<=20?(Y=0,$=p<<20-E&1048575):(l=E-20,g=r(2,l),Y=p%g<<32-l,$=p/g&1048575);else for(l=p,Y=0;g=l/2,l=n(g),l!==0;)E++,Y>>>=1,Y|=($&1)<<31,$>>>=1,g!==l&&($|=524288);if(j=E+1023,P=p===0,p=u-p,E<52&&p!==0)for(l=0;;){if(g=p*2,g>=1?(p=g-1,P?(j--,P=!1):(l<<=1,l|=1,E++)):(p=g,P?--j===0&&(E++,P=!1):(l<<=1,E++)),E===20)$|=l,l=0;else if(E===52){Y|=l;break}if(g===1){E<20?$|=l<<20-E:E<52&&(Y|=l<<52-E);break}}return $|=j<<20,$|=O,new Fw($,Y)},ji.longBitsToDouble=function(u){let p,g,l,E;const P=u.high,O=u.low,j=P&1<<31?-1:1;for(l=((P&2146435072)>>20)-1023,E=0,g=1<<19,p=1;p<=20;p++)P&g&&(E+=r(2,-p)),g>>>=1;for(g=1<<31,p=21;p<=52;p++)O&g&&(E+=r(2,-p)),g>>>=1;if(l===-1023){if(E===0)return j*0;l=-1022}else{if(l===1024)return E===0?j/0:NaN;E+=1}return j*E*r(2,l)}}();function d3(){}function Gm(){}class c5 extends r_{constructor(e){super(e),this.name=Object.keys({RuntimeException:c5})[0]}}class Wx extends c5{constructor(){super(),Wx.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)c5.constructor_.call(this);else if(arguments.length===1){const e=arguments[0];c5.constructor_.call(this,e)}}}class Lm{static isTrue(){if(arguments.length===1){const e=arguments[0];Lm.isTrue(e,null)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];if(!e)throw n===null?new Wx:new Wx(n)}}static shouldNeverReachHere(){if(arguments.length===0)Lm.shouldNeverReachHere(null);else if(arguments.length===1){const e=arguments[0];throw new Wx("Should never reach here"+(e!==null?": "+e:""))}}static equals(){if(arguments.length===2){const e=arguments[0],n=arguments[1];Lm.equals(e,n,null)}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];if(!n.equals(e))throw new Wx("Expected "+e+" but encountered "+n+(r!==null?": "+r:""))}}}function zM(){}function pA(){}const yH=new ArrayBuffer(8),mae=new Float64Array(yH),tN=new Int32Array(yH);class Dn{constructor(){Dn.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)Dn.constructor_.call(this,0,0);else if(arguments.length===1){const e=arguments[0];Dn.constructor_.call(this,e.x,e.y,e.getZ())}else if(arguments.length===2){const e=arguments[0],n=arguments[1];Dn.constructor_.call(this,e,n,Dn.NULL_ORDINATE)}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];this.x=e,this.y=n,this.z=r}}static hashCode(e){return mae[0]=e,tN[0]^tN[1]}equals2D(){if(arguments.length===1){const e=arguments[0];return!(this.x!==e.x||this.y!==e.y)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return!(!R7.equalsWithTolerance(this.x,e.x,n)||!R7.equalsWithTolerance(this.y,e.y,n))}}setM(e){throw new yo("Invalid ordinate index: "+Dn.M)}equals3D(e){return this.x===e.x&&this.y===e.y&&(this.getZ()===e.getZ()||ji.isNaN(this.getZ())&&ji.isNaN(e.getZ()))}setX(e){this.x=e}compareTo(e){const n=e;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0}getX(){return this.x}copy(){return new Dn(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(e){const n=this.x-e.x,r=this.y-e.y,s=this.getZ()-e.getZ();return Math.sqrt(n*n+r*r+s*s)}getY(){return this.y}getM(){return ji.NaN}setOrdinate(e,n){switch(e){case Dn.X:this.x=n;break;case Dn.Y:this.y=n;break;case Dn.Z:this.setZ(n);break;default:throw new yo("Invalid ordinate index: "+e)}}getZ(){return this.z}getOrdinate(e){switch(e){case Dn.X:return this.x;case Dn.Y:return this.y;case Dn.Z:return this.getZ()}throw new yo("Invalid ordinate index: "+e)}equals(e){return e instanceof Dn?this.equals2D(e):!1}equalInZ(e,n){return R7.equalsWithTolerance(this.getZ(),e.getZ(),n)}setZ(e){this.z=e}clone(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return Lm.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw e}finally{}}setY(e){this.y=e}distance(e){const n=this.x-e.x,r=this.y-e.y;return Math.sqrt(n*n+r*r)}hashCode(){let e=17;return e=37*e+Dn.hashCode(this.x),e=37*e+Dn.hashCode(this.y),e}setCoordinate(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}get interfaces_(){return[d3,zM,Gm]}}class S1{constructor(){S1.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,arguments.length===0)S1.constructor_.call(this,2);else if(arguments.length===1){const e=arguments[0];if(e!==2&&e!==3)throw new yo("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}static compare(e,n){return e<n?-1:e>n?1:ji.isNaN(e)?ji.isNaN(n)?0:-1:ji.isNaN(n)?1:0}compare(e,n){const r=S1.compare(e.x,n.x);if(r!==0)return r;const s=S1.compare(e.y,n.y);return s!==0?s:this._dimensionsToTest<=2?0:S1.compare(e.getZ(),n.getZ())}get interfaces_(){return[pA]}}Dn.DimensionalComparator=S1;Dn.NULL_ORDINATE=ji.NaN;Dn.X=0;Dn.Y=1;Dn.Z=2;Dn.M=3;class gae{static ofLine(e){const n=e.size();if(n<=1)return 0;let r=0;const s=new Dn;e.getCoordinate(0,s);let u=s.x,p=s.y;for(let g=1;g<n;g++){e.getCoordinate(g,s);const l=s.x,E=s.y,P=l-u,O=E-p;r+=Math.sqrt(P*P+O*O),u=l,p=E}return r}}class f3{filter(e){}}class a0 extends r_{constructor(e){super(e),this.name=Object.keys({UnsupportedOperationException:a0})[0]}}class Yh{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class mA extends r_{constructor(e){super(e),this.name=Object.keys({IndexOutOfBoundsException:mA})[0]}}class jS extends Yh{get(){}set(){}isEmpty(){}}class p3 extends r_{constructor(e){super(e),this.name=Object.keys({NoSuchElementException:p3})[0]}}class Hm extends jS{constructor(e){super(),this.array=[],e instanceof Yh&&this.addAll(e)}get interfaces_(){return[jS,Yh]}ensureCapacity(){}add(e){return arguments.length===1?this.array.push(e):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(e){for(const n of e)this.array.push(n)}set(e,n){const r=this.array[e];return this.array[e]=n,r}iterator(){return new yae(this)}get(e){if(e<0||e>=this.size())throw new mA;return this.array[e]}isEmpty(){return this.array.length===0}sort(e){e?this.array.sort((n,r)=>e.compare(n,r)):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(e){for(let n=0,r=this.array.length;n<r;n++)if(this.array[n]===e)return!!this.array.splice(n,1);return!1}[Symbol.iterator](){return this.array.values()}}let yae=class{constructor(e){this.arrayList=e,this.position=0}next(){if(this.position===this.arrayList.size())throw new p3;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(e){return this.arrayList.set(this.position-1,e)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}};class O1 extends Hm{constructor(){super(),O1.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length!==0){if(arguments.length===1){const e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}}getCoordinate(e){return this.get(e)}addAll(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&us(arguments[0],Yh)){const e=arguments[0],n=arguments[1];let r=!1;for(let s=e.iterator();s.hasNext();)this.add(s.next(),n),r=!0;return r}else return super.addAll.apply(this,arguments)}clone(){const e=super.clone.call(this);for(let n=0;n<this.size();n++)e.add(n,this.get(n).clone());return e}closeRing(){if(this.size()>0){const e=this.get(0).copy();this.add(e,!1)}}toCoordinateArray(){if(arguments.length===0)return this.toArray(O1.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(O1.coordArrayType);const n=this.size(),r=new Array(n).fill(null);for(let s=0;s<n;s++)r[s]=this.get(n-s-1);return r}}add(){if(arguments.length===1){const e=arguments[0];return super.add.call(this,e)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}else if(arguments[0]instanceof Dn&&typeof arguments[1]=="boolean"){const e=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(e))return null;super.add.call(this,e)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){const e=arguments[0],n=arguments[1];return this.add(e,n),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const e=arguments[0],n=arguments[1];if(arguments[2])for(let s=0;s<e.length;s++)this.add(e[s],n);else for(let s=e.length-1;s>=0;s--)this.add(e[s],n);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Dn){const e=arguments[0],n=arguments[1];if(!arguments[2]){const s=this.size();if(s>0&&(e>0&&this.get(e-1).equals2D(n)||e<s&&this.get(e).equals2D(n)))return null}super.add.call(this,e,n)}}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];let u=1;r>s&&(u=-1);for(let p=r;p!==s;p+=u)this.add(e[p],n);return!0}}}O1.coordArrayType=new Array(0).fill(null);class Sc extends Dn{constructor(){super(),Sc.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)Dn.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof Sc){const e=arguments[0];Dn.constructor_.call(this,e.x,e.y)}else if(arguments[0]instanceof Dn){const e=arguments[0];Dn.constructor_.call(this,e.x,e.y)}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];Dn.constructor_.call(this,e,n,Dn.NULL_ORDINATE)}}setOrdinate(e,n){switch(e){case Sc.X:this.x=n;break;case Sc.Y:this.y=n;break;default:throw new yo("Invalid ordinate index: "+e)}}setZ(e){throw new yo("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Sc(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}getZ(){return Dn.NULL_ORDINATE}getOrdinate(e){switch(e){case Sc.X:return this.x;case Sc.Y:return this.y}throw new yo("Invalid ordinate index: "+e)}}Sc.X=0;Sc.Y=1;Sc.Z=-1;Sc.M=-1;class Cu extends Dn{constructor(){super(),Cu.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)Dn.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof Cu){const e=arguments[0];Dn.constructor_.call(this,e.x,e.y),this._m=e._m}else if(arguments[0]instanceof Dn){const e=arguments[0];Dn.constructor_.call(this,e.x,e.y),this._m=this.getM()}}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];Dn.constructor_.call(this,e,n,Dn.NULL_ORDINATE),this._m=r}}setM(e){this._m=e}setZ(e){throw new yo("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Cu(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}getM(){return this._m}setOrdinate(e,n){switch(e){case Cu.X:this.x=n;break;case Cu.Y:this.y=n;break;case Cu.M:this._m=n;break;default:throw new yo("Invalid ordinate index: "+e)}}getZ(){return Dn.NULL_ORDINATE}getOrdinate(e){switch(e){case Cu.X:return this.x;case Cu.Y:return this.y;case Cu.M:return this._m}throw new yo("Invalid ordinate index: "+e)}}Cu.X=0;Cu.Y=1;Cu.Z=-1;Cu.M=2;class F1 extends Dn{constructor(){super(),F1.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)Dn.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof F1){const e=arguments[0];Dn.constructor_.call(this,e),this._m=e._m}else if(arguments[0]instanceof Dn){const e=arguments[0];Dn.constructor_.call(this,e),this._m=this.getM()}}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];Dn.constructor_.call(this,e,n,r),this._m=s}}setM(e){this._m=e}getOrdinate(e){switch(e){case Dn.X:return this.x;case Dn.Y:return this.y;case Dn.Z:return this.getZ();case Dn.M:return this.getM()}throw new yo("Invalid ordinate index: "+e)}copy(){return new F1(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}getM(){return this._m}setOrdinate(e,n){switch(e){case Dn.X:this.x=n;break;case Dn.Y:this.y=n;break;case Dn.Z:this.z=n;break;case Dn.M:this._m=n;break;default:throw new yo("Invalid ordinate index: "+e)}}}class Bb{static measures(e){return e instanceof Sc?0:e instanceof Cu||e instanceof F1?1:(e instanceof Dn,0)}static create(){if(arguments.length===1){const e=arguments[0];return Bb.create(e,0)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return e===2?new Sc:e===3&&n===0?new Dn:e===3&&n===1?new Cu:e===4&&n===1?new F1:new Dn}}static dimension(e){return e instanceof Sc?2:e instanceof Cu?3:e instanceof F1?4:(e instanceof Dn,3)}}class Ub{static log10(e){const n=Math.log(e);return ji.isInfinite(n)||ji.isNaN(n)?n:n/Ub.LOG_10}static min(e,n,r,s){let u=e;return n<u&&(u=n),r<u&&(u=r),s<u&&(u=s),u}static clamp(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const e=arguments[0],n=arguments[1],r=arguments[2];return e<n?n:e>r?r:e}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const e=arguments[0],n=arguments[1],r=arguments[2];return e<n?n:e>r?r:e}}static average(e,n){return(e+n)/2}static wrap(e,n){return e<0?n- -e%n:e%n}static max(){if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];let s=e;return n>s&&(s=n),r>s&&(s=r),s}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];let u=e;return n>u&&(u=n),r>u&&(u=r),s>u&&(u=s),u}}}Ub.LOG_10=Math.log(10);class h5{static arraycopy(e,n,r,s,u){let p=0;for(let g=n;g<n+u;g++)r[s+p]=e[g],p++}static getProperty(e){return{"line.separator":`
`}[e]}}class go{constructor(){go.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Dn){const e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof go){const e=arguments[0];this.init(e)}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.init(e.x,n.x,e.y,n.y)}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];this.init(e,n,r,s)}}static intersects(){if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(e.x<n.x?e.x:n.x)&&r.x<=(e.x>n.x?e.x:n.x)&&r.y>=(e.y<n.y?e.y:n.y)&&r.y<=(e.y>n.y?e.y:n.y)}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];let u=Math.min(r.x,s.x),p=Math.max(r.x,s.x),g=Math.min(e.x,n.x),l=Math.max(e.x,n.x);return!(g>p||l<u||(u=Math.min(r.y,s.y),p=Math.max(r.y,s.y),g=Math.min(e.y,n.y),l=Math.max(e.y,n.y),g>p)||l<u)}}getArea(){return this.getWidth()*this.getHeight()}getMinX(){return this._minx}expandToInclude(){if(arguments.length===1){if(arguments[0]instanceof Dn){const e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof go){const e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.isNull()?(this._minx=e,this._maxx=e,this._miny=n,this._maxy=n):(e<this._minx&&(this._minx=e),e>this._maxx&&(this._maxx=e),n<this._miny&&(this._miny=n),n>this._maxy&&(this._maxy=n))}}compareTo(e){const n=e;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0}translate(e,n){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+n,this.getMaxY()+n)}copy(){return new go(this)}expandBy(){if(arguments.length===1){const e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(arguments.length===1){if(arguments[0]instanceof go){const e=arguments[0];return this.covers(e)}else if(arguments[0]instanceof Dn){const e=arguments[0];return this.covers(e)}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return this.covers(e,n)}}hashCode(){let e=17;return e=37*e+Dn.hashCode(this._minx),e=37*e+Dn.hashCode(this._maxx),e=37*e+Dn.hashCode(this._miny),e=37*e+Dn.hashCode(this._maxy),e}equals(e){if(!(e instanceof go))return!1;const n=e;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()}intersection(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new go;const n=this._minx>e._minx?this._minx:e._minx,r=this._miny>e._miny?this._miny:e._miny,s=this._maxx<e._maxx?this._maxx:e._maxx,u=this._maxy<e._maxy?this._maxy:e._maxy;return new go(n,s,r,u)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(arguments.length===1){if(arguments[0]instanceof Dn){const e=arguments[0];return this.covers(e.x,e.y)}else if(arguments[0]instanceof go){const e=arguments[0];return this.isNull()||e.isNull()?!1:e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return this.isNull()?!1:e>=this._minx&&e<=this._maxx&&n>=this._miny&&n<=this._maxy}}intersects(){if(arguments.length===1){if(arguments[0]instanceof go){const e=arguments[0];return this.isNull()||e.isNull()?!1:!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}else if(arguments[0]instanceof Dn){const e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){if(arguments[0]instanceof Dn&&arguments[1]instanceof Dn){const e=arguments[0],n=arguments[1];return!(this.isNull()||(e.x<n.x?e.x:n.x)>this._maxx||(e.x>n.x?e.x:n.x)<this._minx||(e.y<n.y?e.y:n.y)>this._maxy||(e.y>n.y?e.y:n.y)<this._miny)}else if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const e=arguments[0],n=arguments[1];return this.isNull()?!1:!(e>this._maxx||e<this._minx||n>this._maxy||n<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const e=this.getWidth(),n=this.getHeight();return Math.sqrt(e*e+n*n)}minExtent(){if(this.isNull())return 0;const e=this.getWidth(),n=this.getHeight();return e<n?e:n}getWidth(){return this.isNull()?0:this._maxx-this._minx}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(e){return this.isNull()||e.isNull()?!0:e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const e=this.getWidth(),n=this.getHeight();return e>n?e:n}centre(){return this.isNull()?null:new Dn((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Dn){const e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof go){const e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.init(e.x,n.x,e.y,n.y)}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];e<n?(this._minx=e,this._maxx=n):(this._minx=n,this._maxx=e),r<s?(this._miny=r,this._maxy=s):(this._miny=s,this._maxy=r)}}getMaxY(){return this._maxy}distance(e){if(this.intersects(e))return 0;let n=0;this._maxx<e._minx?n=e._minx-this._maxx:this._minx>e._maxx&&(n=this._minx-e._maxx);let r=0;return this._maxy<e._miny?r=e._miny-this._maxy:this._miny>e._maxy&&(r=this._miny-e._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)}get interfaces_(){return[d3,Gm]}}class Pu{static scroll(e,n){const r=Pu.indexOf(n,e);if(r<0)return null;const s=new Array(e.length).fill(null);h5.arraycopy(e,r,s,0,e.length-r),h5.arraycopy(e,0,s,e.length-r,r),h5.arraycopy(s,0,e,0,e.length)}static removeRepeatedPoints(e){return Pu.hasRepeatedPoints(e)?new O1(e,!1).toCoordinateArray():e}static reverse(e){const n=e.length-1,r=Math.trunc(n/2);for(let s=0;s<=r;s++){const u=e[s];e[s]=e[n-s],e[n-s]=u}}static removeNull(e){let n=0;for(let u=0;u<e.length;u++)e[u]!==null&&n++;const r=new Array(n).fill(null);if(n===0)return r;let s=0;for(let u=0;u<e.length;u++)e[u]!==null&&(r[s++]=e[u]);return r}static copyDeep(){if(arguments.length===1){const e=arguments[0],n=new Array(e.length).fill(null);for(let r=0;r<e.length;r++)n[r]=e[r].copy();return n}else if(arguments.length===5){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3],u=arguments[4];for(let p=0;p<u;p++)r[s+p]=e[n+p].copy()}}static isEqualReversed(e,n){for(let r=0;r<e.length;r++){const s=e[r],u=n[e.length-r-1];if(s.compareTo(u)!==0)return!1}return!0}static envelope(e){const n=new go;for(let r=0;r<e.length;r++)n.expandToInclude(e[r]);return n}static extract(e,n,r){n=Ub.clamp(n,0,e.length),r=Ub.clamp(r,-1,e.length);let s=r-n+1;r<0&&(s=0),n>=e.length&&(s=0),r<n&&(s=0);const u=new Array(s).fill(null);if(s===0)return u;let p=0;for(let g=n;g<=r;g++)u[p++]=e[g];return u}static isRing(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))}static ptNotInList(e,n){for(let r=0;r<e.length;r++){const s=e[r];if(Pu.indexOf(s,n)<0)return s}return null}static equals(){if(arguments.length===2){const e=arguments[0],n=arguments[1];if(e===n)return!0;if(e===null||n===null||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];if(e===n)return!0;if(e===null||n===null||e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(r.compare(e[s],n[s])!==0)return!1;return!0}}static intersection(e,n){const r=new O1;for(let s=0;s<e.length;s++)n.intersects(e[s])&&r.add(e[s],!0);return r.toCoordinateArray()}static measures(e){if(e===null||e.length===0)return 0;let n=0;for(const r of e)n=Math.max(n,Bb.measures(r));return n}static hasRepeatedPoints(e){for(let n=1;n<e.length;n++)if(e[n-1].equals(e[n]))return!0;return!1}static toCoordinateArray(e){return e.toArray(Pu.coordArrayType)}static dimension(e){if(e===null||e.length===0)return 3;let n=0;for(const r of e)n=Math.max(n,Bb.dimension(r));return n}static atLeastNCoordinatesOrNothing(e,n){return n.length>=e?n:[]}static indexOf(e,n){for(let r=0;r<n.length;r++)if(e.equals(n[r]))return r;return-1}static increasingDirection(e){for(let n=0;n<Math.trunc(e.length/2);n++){const r=e.length-1-n,s=e[n].compareTo(e[r]);if(s!==0)return s}return 1}static compare(e,n){let r=0;for(;r<e.length&&r<n.length;){const s=e[r].compareTo(n[r]);if(s!==0)return s;r++}return r<n.length?-1:r<e.length?1:0}static minCoordinate(e){let n=null;for(let r=0;r<e.length;r++)(n===null||n.compareTo(e[r])>0)&&(n=e[r]);return n}}class _ae{compare(e,n){const r=e,s=n;return Pu.compare(r,s)}get interfaces_(){return[pA]}}class vae{compare(e,n){const r=e,s=n;if(r.length<s.length)return-1;if(r.length>s.length)return 1;if(r.length===0)return 0;const u=Pu.compare(r,s);return Pu.isEqualReversed(r,s)?0:u}OLDcompare(e,n){const r=e,s=n;if(r.length<s.length)return-1;if(r.length>s.length)return 1;if(r.length===0)return 0;const u=Pu.increasingDirection(r),p=Pu.increasingDirection(s);let g=u>0?0:r.length-1,l=p>0?0:r.length-1;for(let E=0;E<r.length;E++){const P=r[g].compareTo(s[l]);if(P!==0)return P;g+=u,l+=p}return 0}get interfaces_(){return[pA]}}Pu.ForwardComparator=_ae;Pu.BidirectionalComparator=vae;Pu.coordArrayType=new Array(0).fill(null);class f2{static isWhitespace(e){return e<=32&&e>=0||e===127}static toUpperCase(e){return e.toUpperCase()}}class Ki{static toDimensionSymbol(e){switch(e){case Ki.FALSE:return Ki.SYM_FALSE;case Ki.TRUE:return Ki.SYM_TRUE;case Ki.DONTCARE:return Ki.SYM_DONTCARE;case Ki.P:return Ki.SYM_P;case Ki.L:return Ki.SYM_L;case Ki.A:return Ki.SYM_A}throw new yo("Unknown dimension value: "+e)}static toDimensionValue(e){switch(f2.toUpperCase(e)){case Ki.SYM_FALSE:return Ki.FALSE;case Ki.SYM_TRUE:return Ki.TRUE;case Ki.SYM_DONTCARE:return Ki.DONTCARE;case Ki.SYM_P:return Ki.P;case Ki.SYM_L:return Ki.L;case Ki.SYM_A:return Ki.A}throw new yo("Unknown dimension symbol: "+e)}}Ki.P=0;Ki.L=1;Ki.A=2;Ki.FALSE=-1;Ki.TRUE=-2;Ki.DONTCARE=-3;Ki.SYM_FALSE="F";Ki.SYM_TRUE="T";Ki.SYM_DONTCARE="*";Ki.SYM_P="0";Ki.SYM_L="1";Ki.SYM_A="2";class oi{constructor(){oi.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===oi.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(e){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(e){return this===e||this.equalsExact(e,0)}geometryChanged(){this.apply(oi.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(e){return e===null?!1:this.norm().equalsExact(e.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let e;if(arguments.length===1){const n=arguments[0];return e=n,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n)}else if(arguments.length===2){const n=arguments[0],r=arguments[1];return e=n,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,r)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(e){if(e.getTypeCode()===oi.TYPECODE_GEOMETRYCOLLECTION)throw new yo("This method does not support GeometryCollection arguments")}equal(e,n,r){return r===0?e.equals(n):e.distance(n)<=r}norm(){const e=this.copy();return e.normalize(),e}reverse(){const e=this.reverseInternal();return this.envelope!=null&&(e.envelope=this.envelope.copy()),e.setSRID(this.getSRID()),e}copy(){const e=this.copyInternal();return e.envelope=this._envelope==null?null:this._envelope.copy(),e._SRID=this._SRID,e._userData=this._userData,e}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new go(this._envelope)}setSRID(e){this._SRID=e}setUserData(e){this._userData=e}compare(e,n){const r=e.iterator(),s=n.iterator();for(;r.hasNext()&&s.hasNext();){const u=r.next(),p=s.next(),g=u.compareTo(p);if(g!==0)return g}return r.hasNext()?1:s.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(e){return this.getTypeCode()==e.getTypeCode()}get interfaces_(){return[zM,d3,Gm]}getClass(){return oi}static hasNonEmptyElements(e){for(let n=0;n<e.length;n++)if(!e[n].isEmpty())return!0;return!1}static hasNullElements(e){for(let n=0;n<e.length;n++)if(e[n]===null)return!0;return!1}}oi.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())};oi.TYPECODE_POINT=0;oi.TYPECODE_MULTIPOINT=1;oi.TYPECODE_LINESTRING=2;oi.TYPECODE_LINEARRING=3;oi.TYPECODE_MULTILINESTRING=4;oi.TYPECODE_POLYGON=5;oi.TYPECODE_MULTIPOLYGON=6;oi.TYPECODE_GEOMETRYCOLLECTION=7;oi.TYPENAME_POINT="Point";oi.TYPENAME_MULTIPOINT="MultiPoint";oi.TYPENAME_LINESTRING="LineString";oi.TYPENAME_LINEARRING="LinearRing";oi.TYPENAME_MULTILINESTRING="MultiLineString";oi.TYPENAME_POLYGON="Polygon";oi.TYPENAME_MULTIPOLYGON="MultiPolygon";oi.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection";oi.geometryChangedFilter={get interfaces_(){return[f3]},filter(t){t.geometryChangedAction()}};class BM{filter(e){}}class _H{}class js{getCoordinate(){}getCoordinateCopy(e){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(e){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(e){}copy(){}getY(e){}toCoordinateArray(){}getM(e){if(this.hasM()){const n=this.getDimension()-this.getMeasures();return this.getOrdinate(e,n)}else return ji.NaN}setOrdinate(e,n,r){}getZ(e){return this.hasZ()?this.getOrdinate(e,2):ji.NaN}size(){}getOrdinate(e,n){}get interfaces_(){return[zM]}}js.X=0;js.Y=1;js.Z=2;js.M=3;class cl{static scroll(){if(arguments.length===2){if(us(arguments[0],js)&&Number.isInteger(arguments[1])){const e=arguments[0],n=arguments[1];cl.scroll(e,n,cl.isRing(e))}else if(us(arguments[0],js)&&arguments[1]instanceof Dn){const e=arguments[0],n=arguments[1],r=cl.indexOf(n,e);if(r<=0)return null;cl.scroll(e,r)}}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];if(n<=0)return null;const u=e.copy(),p=r?e.size()-1:e.size();for(let g=0;g<p;g++)for(let l=0;l<e.getDimension();l++)e.setOrdinate(g,l,u.getOrdinate((n+g)%p,l));if(r)for(let g=0;g<e.getDimension();g++)e.setOrdinate(p,g,e.getOrdinate(0,g))}}static isEqual(e,n){const r=e.size(),s=n.size();if(r!==s)return!1;const u=Math.min(e.getDimension(),n.getDimension());for(let p=0;p<r;p++)for(let g=0;g<u;g++){const l=e.getOrdinate(p,g),E=n.getOrdinate(p,g);if(e.getOrdinate(p,g)!==n.getOrdinate(p,g)&&!(ji.isNaN(l)&&ji.isNaN(E)))return!1}return!0}static minCoordinateIndex(){if(arguments.length===1){const e=arguments[0];return cl.minCoordinateIndex(e,0,e.size()-1)}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];let s=-1,u=null;for(let p=n;p<=r;p++){const g=e.getCoordinate(p);(u===null||u.compareTo(g)>0)&&(u=g,s=p)}return s}}static extend(e,n,r){const s=e.create(r,n.getDimension()),u=n.size();if(cl.copy(n,0,s,0,u),u>0)for(let p=u;p<r;p++)cl.copy(n,u-1,s,p,1);return s}static reverse(e){const n=e.size()-1,r=Math.trunc(n/2);for(let s=0;s<=r;s++)cl.swap(e,s,n-s)}static ensureValidRing(e,n){const r=n.size();return r===0?n:r<=3?cl.createClosedRing(e,n,4):n.getOrdinate(0,js.X)===n.getOrdinate(r-1,js.X)&&n.getOrdinate(0,js.Y)===n.getOrdinate(r-1,js.Y)?n:cl.createClosedRing(e,n,r+1)}static minCoordinate(e){let n=null;for(let r=0;r<e.size();r++){const s=e.getCoordinate(r);(n===null||n.compareTo(s)>0)&&(n=s)}return n}static copyCoord(e,n,r,s){const u=Math.min(e.getDimension(),r.getDimension());for(let p=0;p<u;p++)r.setOrdinate(s,p,e.getOrdinate(n,p))}static isRing(e){const n=e.size();return n===0?!0:n<=3?!1:e.getOrdinate(0,js.X)===e.getOrdinate(n-1,js.X)&&e.getOrdinate(0,js.Y)===e.getOrdinate(n-1,js.Y)}static swap(e,n,r){if(n===r)return null;for(let s=0;s<e.getDimension();s++){const u=e.getOrdinate(n,s);e.setOrdinate(n,s,e.getOrdinate(r,s)),e.setOrdinate(r,s,u)}}static copy(e,n,r,s,u){for(let p=0;p<u;p++)cl.copyCoord(e,n+p,r,s+p)}static indexOf(e,n){for(let r=0;r<n.size();r++)if(e.x===n.getOrdinate(r,js.X)&&e.y===n.getOrdinate(r,js.Y))return r;return-1}static createClosedRing(e,n,r){const s=e.create(r,n.getDimension()),u=n.size();cl.copy(n,0,s,0,u);for(let p=u;p<r;p++)cl.copy(n,0,s,p,1);return s}}class pv{filter(e){}}class UM{filter(e,n){}isGeometryChanged(){}isDone(){}}class sc extends oi{constructor(){super(),sc.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,arguments.length!==0){if(arguments.length===2){const e=arguments[0],n=arguments[1];oi.constructor_.call(this,n),this.init(e)}}}computeEnvelopeInternal(){return this.isEmpty()?new go:this._points.expandEnvelope(new go)}isRing(){return this.isClosed()&&Pu.isRing(this.getCoordinates())}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new sc(this._points.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;const r=e;if(this._points.size()!==r._points.size())return!1;for(let s=0;s<this._points.size();s++)if(!this.equal(this._points.getCoordinate(s),r._points.getCoordinate(s),n))return!1;return!0}else return super.equalsExact.apply(this,arguments)}isClosed(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const e=this._points.copy();return cl.reverse(e),this.getFactory().createLineString(e)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return oi.TYPECODE_LINESTRING}getDimension(){return 1}getBoundary(){throw new a0}isEquivalentClass(e){return e instanceof sc}getCoordinateSequence(){return this._points}getPointN(e){return this.getFactory().createPoint(this._points.getCoordinate(e))}normalize(){for(let e=0;e<Math.trunc(this._points.size()/2);e++){const n=this._points.size()-1-e;if(!this._points.getCoordinate(e).equals(this._points.getCoordinate(n))){if(this._points.getCoordinate(e).compareTo(this._points.getCoordinate(n))>0){const r=this._points.copy();cl.reverse(r),this._points=r}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?Ki.FALSE:0}getLength(){return gae.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(arguments.length===1){const n=arguments[0];let r=0,s=0;for(;r<this._points.size()&&s<n._points.size();){const u=this._points.getCoordinate(r).compareTo(n._points.getCoordinate(s));if(u!==0)return u;r++,s++}return r<this._points.size()?1:s<n._points.size()?-1:0}else if(arguments.length===2){const e=arguments[0],n=arguments[1],r=e;return n.compare(this._points,r._points)}}apply(){if(us(arguments[0],BM)){const e=arguments[0];for(let n=0;n<this._points.size();n++)e.filter(this._points.getCoordinate(n))}else if(us(arguments[0],UM)){const e=arguments[0];if(this._points.size()===0)return null;for(let n=0;n<this._points.size()&&(e.filter(this._points,n),!e.isDone());n++);e.isGeometryChanged()&&this.geometryChanged()}else us(arguments[0],pv)?arguments[0].filter(this):us(arguments[0],f3)&&arguments[0].filter(this)}getCoordinateN(e){return this._points.getCoordinate(e)}getGeometryType(){return oi.TYPENAME_LINESTRING}isEmpty(){return this._points.size()===0}init(e){if(e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),e.size()===1)throw new yo("Invalid number of points in LineString (found "+e.size()+" - must be 0 or >= 2)");this._points=e}isCoordinate(e){for(let n=0;n<this._points.size();n++)if(this._points.getCoordinate(n).equals(e))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}get interfaces_(){return[_H]}}class Py extends sc{constructor(){super(),Py.constructor_.apply(this,arguments)}static constructor_(){const e=arguments[0],n=arguments[1];sc.constructor_.call(this,e,n),this.validateConstruction()}copyInternal(){return new Py(this._points.copy(),this._factory)}getBoundaryDimension(){return Ki.FALSE}isClosed(){return this.isEmpty()?!0:super.isClosed.call(this)}reverseInternal(){const e=this._points.copy();return cl.reverse(e),this.getFactory().createLinearRing(e)}getTypeCode(){return oi.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new yo("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Py.MINIMUM_VALID_SIZE)throw new yo("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return oi.TYPENAME_LINEARRING}}Py.MINIMUM_VALID_SIZE=4;class vH{create(){if(arguments.length===1)arguments[0]instanceof Array||us(arguments[0],js);else if(arguments.length!==2){if(arguments.length===3){const e=arguments[0],n=arguments[1];return this.create(e,n)}}}}class xH{constructor(e){this.str=e}append(e){this.str+=e}setCharAt(e,n){this.str=this.str.substr(0,e)+n+this.str.substr(e+1)}toString(){return this.str}}class Fg{constructor(){Fg.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){const e=arguments[0];Fg.constructor_.call(this,e,Pu.dimension(e),Pu.measures(e))}else if(Number.isInteger(arguments[0])){const e=arguments[0];this._coordinates=new Array(e).fill(null);for(let n=0;n<e;n++)this._coordinates[n]=new Dn}else if(us(arguments[0],js)){const e=arguments[0];if(e===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=e.getDimension(),this._measures=e.getMeasures(),this._coordinates=new Array(e.size()).fill(null);for(let n=0;n<this._coordinates.length;n++)this._coordinates[n]=e.getCoordinateCopy(n)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const e=arguments[0],n=arguments[1];Fg.constructor_.call(this,e,n,Pu.measures(e))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const e=arguments[0],n=arguments[1];this._coordinates=new Array(e).fill(null),this._dimension=n;for(let r=0;r<e;r++)this._coordinates[r]=Bb.create(n)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const e=arguments[0],n=arguments[1],r=arguments[2];this._dimension=n,this._measures=r,e===null?this._coordinates=new Array(0).fill(null):this._coordinates=e}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const e=arguments[0],n=arguments[1],r=arguments[2];this._coordinates=new Array(e).fill(null),this._dimension=n,this._measures=r;for(let s=0;s<e;s++)this._coordinates[s]=this.createCoordinate()}}}getCoordinate(){if(arguments.length===1){const e=arguments[0];return this._coordinates[e]}else if(arguments.length===2){const e=arguments[0];arguments[1].setCoordinate(this._coordinates[e])}}getCoordinateCopy(e){const n=this.createCoordinate();return n.setCoordinate(this._coordinates[e]),n}createCoordinate(){return Bb.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(e){return this._coordinates[e].x}getMeasures(){return this._measures}expandEnvelope(e){for(let n=0;n<this._coordinates.length;n++)e.expandToInclude(this._coordinates[n]);return e}copy(){const e=new Array(this.size()).fill(null);for(let n=0;n<this._coordinates.length;n++){const r=this.createCoordinate();r.setCoordinate(this._coordinates[n]),e[n]=r}return new Fg(e,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const e=new xH(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(let n=1;n<this._coordinates.length;n++)e.append(", "),e.append(this._coordinates[n]);return e.append(")"),e.toString()}else return"()"}getY(e){return this._coordinates[e].y}toCoordinateArray(){return this._coordinates}getM(e){return this.hasM()?this._coordinates[e].getM():ji.NaN}setOrdinate(e,n,r){switch(n){case js.X:this._coordinates[e].x=r;break;case js.Y:this._coordinates[e].y=r;break;default:this._coordinates[e].setOrdinate(n,r)}}getZ(e){return this.hasZ()?this._coordinates[e].getZ():ji.NaN}size(){return this._coordinates.length}getOrdinate(e,n){switch(n){case js.X:return this._coordinates[e].x;case js.Y:return this._coordinates[e].y;default:return this._coordinates[e].getOrdinate(n)}}get interfaces_(){return[js,Gm]}}class jb{static instance(){return jb.instanceObject}readResolve(){return jb.instance()}create(){if(arguments.length===1){if(arguments[0]instanceof Array){const e=arguments[0];return new Fg(e)}else if(us(arguments[0],js)){const e=arguments[0];return new Fg(e)}}else if(arguments.length===2){let e=arguments[0],n=arguments[1];return n>3&&(n=3),n<2&&(n=2),new Fg(e,n)}else if(arguments.length===3){let e=arguments[0],n=arguments[1],r=arguments[2],s=n-r;return r>1&&(r=1),s>3&&(s=3),s<2&&(s=2),new Fg(e,s+r,r)}}get interfaces_(){return[vH,Gm]}}jb.instanceObject=new jb;let bH=class extends Yh{contains(){}};class xae extends bH{}class nN extends xae{constructor(e){super(),this.array=[],e instanceof Yh&&this.addAll(e)}contains(e){for(const n of this.array)if(n.compareTo(e)===0)return!0;return!1}add(e){if(this.contains(e))return!1;for(let n=0,r=this.array.length;n<r;n++)if(this.array[n].compareTo(e)===1)return!!this.array.splice(n,0,e);return this.array.push(e),!0}addAll(e){for(const n of e)this.add(n);return!0}remove(){throw new a0}size(){return this.array.length}isEmpty(){return this.array.length===0}toArray(){return this.array.slice()}iterator(){return new bae(this.array)}}let bae=class{constructor(e){this.array=e,this.position=0}next(){if(this.position===this.array.length)throw new p3;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new a0}};class nb{static sort(){const e=arguments[0];if(arguments.length===1)e.sort((n,r)=>n.compareTo(r));else if(arguments.length===2)e.sort((n,r)=>arguments[1].compare(n,r));else if(arguments.length===3){const n=e.slice(arguments[1],arguments[2]);n.sort();const r=e.slice(0,arguments[1]).concat(n,e.slice(arguments[2],e.length));e.splice(0,e.length);for(const s of r)e.push(s)}else if(arguments.length===4){const n=e.slice(arguments[1],arguments[2]);n.sort((s,u)=>arguments[3].compare(s,u));const r=e.slice(0,arguments[1]).concat(n,e.slice(arguments[2],e.length));e.splice(0,e.length);for(const s of r)e.push(s)}}static asList(e){const n=new Hm;for(const r of e)n.add(r);return n}static copyOf(e,n){return e.slice(0,n)}}class Nu extends oi{constructor(){super(),Nu.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){let e=arguments[0],n=arguments[1];if(oi.constructor_.call(this,n),e===null&&(e=[]),oi.hasNullElements(e))throw new yo("geometries must not contain null elements");this._geometries=e}}}computeEnvelopeInternal(){const e=new go;for(let n=0;n<this._geometries.length;n++)e.expandToInclude(this._geometries[n].getEnvelopeInternal());return e}getGeometryN(e){return this._geometries[e]}getCoordinates(){const e=new Array(this.getNumPoints()).fill(null);let n=-1;for(let r=0;r<this._geometries.length;r++){const s=this._geometries[r].getCoordinates();for(let u=0;u<s.length;u++)n++,e[n]=s[u]}return e}getArea(){let e=0;for(let n=0;n<this._geometries.length;n++)e+=this._geometries[n].getArea();return e}copyInternal(){const e=new Array(this._geometries.length).fill(null);for(let n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new Nu(e,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;const r=e;if(this._geometries.length!==r._geometries.length)return!1;for(let s=0;s<this._geometries.length;s++)if(!this._geometries[s].equalsExact(r._geometries[s],n))return!1;return!0}else return super.equalsExact.apply(this,arguments)}reverseInternal(){const e=this._geometries.length,n=new Hm(e);for(let r=0;r<e;r++)n.add(this._geometries[r].reverse());return this.getFactory().buildGeometry(n)}getTypeCode(){return oi.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let e=Ki.FALSE;for(let n=0;n<this._geometries.length;n++)e=Math.max(e,this._geometries[n].getDimension());return e}getNumGeometries(){return this._geometries.length}getBoundary(){return oi.checkNotGeometryCollection(this),Lm.shouldNeverReachHere(),null}getGeometryType(){return oi.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let e=0;e<this._geometries.length;e++)if(!this._geometries[e].isEmpty())return!1;return!0}normalize(){for(let e=0;e<this._geometries.length;e++)this._geometries[e].normalize();nb.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let e=Ki.FALSE;for(let n=0;n<this._geometries.length;n++)e=Math.max(e,this._geometries[n].getBoundaryDimension());return e}getLength(){let e=0;for(let n=0;n<this._geometries.length;n++)e+=this._geometries[n].getLength();return e}getNumPoints(){let e=0;for(let n=0;n<this._geometries.length;n++)e+=this._geometries[n].getNumPoints();return e}compareToSameClass(){if(arguments.length===1){const e=arguments[0],n=new nN(nb.asList(this._geometries)),r=new nN(nb.asList(e._geometries));return this.compare(n,r)}else if(arguments.length===2){const e=arguments[0],n=arguments[1],r=e,s=this.getNumGeometries(),u=r.getNumGeometries();let p=0;for(;p<s&&p<u;){const g=this.getGeometryN(p),l=r.getGeometryN(p),E=g.compareToSameClass(l,n);if(E!==0)return E;p++}return p<s?1:p<u?-1:0}}apply(){if(us(arguments[0],BM)){const e=arguments[0];for(let n=0;n<this._geometries.length;n++)this._geometries[n].apply(e)}else if(us(arguments[0],UM)){const e=arguments[0];if(this._geometries.length===0)return null;for(let n=0;n<this._geometries.length&&(this._geometries[n].apply(e),!e.isDone());n++);e.isGeometryChanged()&&this.geometryChanged()}else if(us(arguments[0],pv)){const e=arguments[0];e.filter(this);for(let n=0;n<this._geometries.length;n++)this._geometries[n].apply(e)}else if(us(arguments[0],f3)){const e=arguments[0];e.filter(this);for(let n=0;n<this._geometries.length;n++)this._geometries[n].apply(e)}}}class wH{}class Vb extends Nu{constructor(){super(),Vb.constructor_.apply(this,arguments)}static constructor_(){const e=arguments[0],n=arguments[1];Nu.constructor_.call(this,e,n)}copyInternal(){const e=new Array(this._geometries.length).fill(null);for(let n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new Vb(e,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];return this.isEquivalentClass(e)?super.equalsExact.call(this,e,n):!1}else return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return oi.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const e=new Hm;for(let r=0;r<this._geometries.length;r++){const u=this._geometries[r].getBoundary();for(let p=0;p<u.getNumGeometries();p++)e.add(u.getGeometryN(p))}const n=new Array(e.size()).fill(null);return this.getFactory().createMultiLineString(e.toArray(n))}getGeometryType(){return oi.TYPENAME_MULTIPOLYGON}get interfaces_(){return[wH]}}let wae=class{get(){}put(){}size(){}values(){}entrySet(){}};class Eae extends bH{constructor(e){super(),this.map=new Map,e instanceof Yh&&this.addAll(e)}contains(e){const n=e.hashCode?e.hashCode():e;return!!this.map.has(n)}add(e){const n=e.hashCode?e.hashCode():e;return this.map.has(n)?!1:!!this.map.set(n,e)}addAll(e){for(const n of e)this.add(n);return!0}remove(){throw new a0}size(){return this.map.size}isEmpty(){return this.map.size===0}toArray(){return Array.from(this.map.values())}iterator(){return new Sae(this.map)}[Symbol.iterator](){return this.map}}let Sae=class{constructor(e){this.iterator=e.values();const{done:n,value:r}=this.iterator.next();this.done=n,this.value=r}next(){if(this.done)throw new p3;const e=this.value,{done:n,value:r}=this.iterator.next();return this.done=n,this.value=r,e}hasNext(){return!this.done}remove(){throw new a0}};class Tae extends wae{constructor(){super(),this.map=new Map}get(e){return this.map.get(e)||null}put(e,n){return this.map.set(e,n),n}values(){const e=new Hm,n=this.map.values();let r=n.next();for(;!r.done;)e.add(r.value),r=n.next();return e}entrySet(){const e=new Eae;return this.map.entries().forEach(n=>e.add(n)),e}size(){return this.map.size()}}class jM{constructor(e){this.value=e}intValue(){return this.value}compareTo(e){return this.value<e?-1:this.value>e?1:0}static compare(e,n){return e<n?-1:e>n?1:0}static isNan(e){return Number.isNaN(e)}static valueOf(e){return new jM(e)}}class qo{constructor(){qo.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=qo.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Pm){const e=arguments[0];this._modelType=e,e===qo.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){const e=arguments[0];this._modelType=qo.FIXED,this.setScale(e)}else if(arguments[0]instanceof qo){const e=arguments[0];this._modelType=e._modelType,this._scale=e._scale}}}static mostPrecise(e,n){return e.compareTo(n)>=0?e:n}equals(e){if(!(e instanceof qo))return!1;const n=e;return this._modelType===n._modelType&&this._scale===n._scale}compareTo(e){const n=e,r=this.getMaximumSignificantDigits(),s=n.getMaximumSignificantDigits();return jM.compare(r,s)}getType(){return this._modelType}toString(){let e="UNKNOWN";return this._modelType===qo.FLOATING?e="Floating":this._modelType===qo.FLOATING_SINGLE?e="Floating-Single":this._modelType===qo.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e}makePrecise(){if(typeof arguments[0]=="number"){const e=arguments[0];return ji.isNaN(e)||this._modelType===qo.FLOATING_SINGLE?e:this._modelType===qo.FIXED?Math.round(e*this._scale)/this._scale:e}else if(arguments[0]instanceof Dn){const e=arguments[0];if(this._modelType===qo.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}}getMaximumSignificantDigits(){let e=16;return this._modelType===qo.FLOATING?e=16:this._modelType===qo.FLOATING_SINGLE?e=6:this._modelType===qo.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e}setScale(e){this._scale=Math.abs(e)}getScale(){return this._scale}isFloating(){return this._modelType===qo.FLOATING||this._modelType===qo.FLOATING_SINGLE}get interfaces_(){return[Gm,d3]}}class Pm{constructor(){Pm.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const e=arguments[0];this._name=e,Pm.nameToTypeMap.put(e,this)}readResolve(){return Pm.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[Gm]}}Pm.nameToTypeMap=new Tae;qo.Type=Pm;qo.FIXED=new Pm("FIXED");qo.FLOATING=new Pm("FLOATING");qo.FLOATING_SINGLE=new Pm("FLOATING SINGLE");qo.maximumPreciseValue=9007199254740992;class Gb extends Nu{constructor(){super(),Gb.constructor_.apply(this,arguments)}static constructor_(){const e=arguments[0],n=arguments[1];Nu.constructor_.call(this,e,n)}copyInternal(){const e=new Array(this._geometries.length).fill(null);for(let n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new Gb(e,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];return this.isEquivalentClass(e)?super.equalsExact.call(this,e,n):!1}else return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?Ki.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let e=0;e<this._geometries.length;e++)if(!this._geometries[e].isClosed())return!1;return!0}getTypeCode(){return oi.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new a0}getGeometryType(){return oi.TYPENAME_MULTILINESTRING}get interfaces_(){return[_H]}}class EH{}class Hb extends r_{constructor(e){super(e),this.name=Object.keys({IllegalStateException:Hb})[0]}}class lp extends oi{constructor(){super(),lp.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const e=arguments[0],n=arguments[1];oi.constructor_.call(this,n),this.init(e)}computeEnvelopeInternal(){if(this.isEmpty())return new go;const e=new go;return e.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),e}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new lp(this._coordinates.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];return this.isEquivalentClass(e)?this.isEmpty()&&e.isEmpty()?!0:this.isEmpty()!==e.isEmpty()?!1:this.equal(e.getCoordinate(),this.getCoordinate(),n):!1}else return super.equalsExact.apply(this,arguments)}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return oi.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(this.getCoordinate()===null)throw new Hb("getX called on empty Point");return this.getCoordinate().x}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return oi.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(this.getCoordinate()===null)throw new Hb("getY called on empty Point");return this.getCoordinate().y}isSimple(){return!0}normalize(){}getCoordinate(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return Ki.FALSE}compareToSameClass(){if(arguments.length===1){const n=arguments[0];return this.getCoordinate().compareTo(n.getCoordinate())}else if(arguments.length===2){const e=arguments[0],n=arguments[1],r=e;return n.compare(this._coordinates,r._coordinates)}}apply(){if(us(arguments[0],BM)){const e=arguments[0];if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(us(arguments[0],UM)){const e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else us(arguments[0],pv)?arguments[0].filter(this):us(arguments[0],f3)&&arguments[0].filter(this)}isEmpty(){return this._coordinates.size()===0}init(e){e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),Lm.isTrue(e.size()<=1),this._coordinates=e}get interfaces_(){return[EH]}}class s9{static ofRingSigned(){if(arguments[0]instanceof Array){const e=arguments[0];if(e.length<3)return 0;let n=0;const r=e[0].x;for(let s=1;s<e.length-1;s++){const u=e[s].x-r,p=e[s+1].y,g=e[s-1].y;n+=u*(g-p)}return n/2}else if(us(arguments[0],js)){const e=arguments[0],n=e.size();if(n<3)return 0;const r=new Dn,s=new Dn,u=new Dn;e.getCoordinate(0,s),e.getCoordinate(1,u);const p=s.x;u.x-=p;let g=0;for(let l=1;l<n-1;l++)r.y=s.y,s.x=u.x,s.y=u.y,e.getCoordinate(l+1,u),u.x-=p,g+=s.x*(r.y-u.y);return g/2}}static ofRing(){if(arguments[0]instanceof Array){const e=arguments[0];return Math.abs(s9.ofRingSigned(e))}else if(us(arguments[0],js)){const e=arguments[0];return Math.abs(s9.ofRingSigned(e))}}}class rN{constructor(e){this.str=e}append(e){this.str+=e}setCharAt(e,n){this.str=this.str.substr(0,e)+n+this.str.substr(e+1)}toString(){return this.str}}class Wn{constructor(){Wn.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){const e=arguments[0];this.init(e)}else if(arguments[0]instanceof Wn){const e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){const e=arguments[0];Wn.constructor_.call(this,Wn.parse(e))}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.init(e,n)}}static determinant(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];return Wn.determinant(Wn.valueOf(e),Wn.valueOf(n),Wn.valueOf(r),Wn.valueOf(s))}else if(arguments[3]instanceof Wn&&arguments[2]instanceof Wn&&arguments[0]instanceof Wn&&arguments[1]instanceof Wn){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];return e.multiply(s).selfSubtract(n.multiply(r))}}static sqr(e){return Wn.valueOf(e).selfMultiply(e)}static valueOf(){if(typeof arguments[0]=="string"){const e=arguments[0];return Wn.parse(e)}else if(typeof arguments[0]=="number"){const e=arguments[0];return new Wn(e)}}static sqrt(e){return Wn.valueOf(e).sqrt()}static parse(e){let n=0;const r=e.length;for(;f2.isWhitespace(e.charAt(n));)n++;let s=!1;if(n<r){const j=e.charAt(n);(j==="-"||j==="+")&&(n++,j==="-"&&(s=!0))}const u=new Wn;let p=0,g=0,l=0,E=!1;for(;!(n>=r);){const j=e.charAt(n);if(n++,f2.isDigit(j)){const $=j-"0";u.selfMultiply(Wn.TEN),u.selfAdd($),p++;continue}if(j==="."){g=p,E=!0;continue}if(j==="e"||j==="E"){const $=e.substring(n);try{l=jM.parseInt($)}catch(Y){throw Y instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+$+" in string "+e):Y}finally{}break}throw new NumberFormatException("Unexpected character '"+j+"' at position "+n+" in string "+e)}let P=u;E||(g=p);const O=p-g-l;if(O===0)P=u;else if(O>0){const j=Wn.TEN.pow(O);P=u.divide(j)}else if(O<0){const j=Wn.TEN.pow(-O);P=u.multiply(j)}return s?P.negate():P}static createNaN(){return new Wn(ji.NaN,ji.NaN)}static copy(e){return new Wn(e)}static magnitude(e){const n=Math.abs(e),r=Math.log(n)/Math.log(10);let s=Math.trunc(Math.floor(r));return Math.pow(10,s)*10<=n&&(s+=1),s}static stringOfChar(e,n){const r=new rN;for(let s=0;s<n;s++)r.append(e);return r.toString()}le(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<=e._lo}extractSignificantDigits(e,n){let r=this.abs(),s=Wn.magnitude(r._hi);const u=Wn.TEN.pow(s);r=r.divide(u),r.gt(Wn.TEN)?(r=r.divide(Wn.TEN),s+=1):r.lt(Wn.ONE)&&(r=r.multiply(Wn.TEN),s-=1);const p=s+1,g=new rN,l=Wn.MAX_PRINT_DIGITS-1;for(let E=0;E<=l;E++){e&&E===p&&g.append(".");const P=Math.trunc(r._hi);if(P<0)break;let O=!1,j=0;P>9?(O=!0,j="9"):j="0"+P,g.append(j),r=r.subtract(Wn.valueOf(P)).multiply(Wn.TEN),O&&r.selfAdd(Wn.TEN);let $=!0;const Y=Wn.magnitude(r._hi);if(Y<0&&Math.abs(Y)>=l-E&&($=!1),!$)break}return n[0]=s,g.toString()}sqr(){return this.multiply(this)}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}setValue(){if(arguments[0]instanceof Wn){const e=arguments[0];return this.init(e),this}else if(typeof arguments[0]=="number"){const e=arguments[0];return this.init(e),this}}multiply(){if(arguments[0]instanceof Wn){const e=arguments[0];return e.isNaN()?Wn.createNaN():Wn.copy(this).selfMultiply(e)}else if(typeof arguments[0]=="number"){const e=arguments[0];return ji.isNaN(e)?Wn.createNaN():Wn.copy(this).selfMultiply(e,0)}}isNaN(){return ji.isNaN(this._hi)}reciprocal(){let e=null,n=null,r=null,s=null,u=null,p=null,g=null,l=null;u=1/this._hi,p=Wn.SPLIT*u,e=p-u,l=Wn.SPLIT*this._hi,e=p-e,n=u-e,r=l-this._hi,g=u*this._hi,r=l-r,s=this._hi-r,l=e*r-g+e*s+n*r+n*s,p=(1-g-l-u*this._lo)/this._hi;const E=u+p,P=u-E+p;return new Wn(E,P)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof Wn){const e=arguments[0];return this.add(e.negate())}else if(typeof arguments[0]=="number"){const e=arguments[0];return this.add(-e)}}equals(){if(arguments.length===1&&arguments[0]instanceof Wn){const e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}}isZero(){return this._hi===0&&this._lo===0}selfSubtract(){if(arguments[0]instanceof Wn){const e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}else if(typeof arguments[0]=="number"){const e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}}min(e){return this.le(e)?this:e}selfDivide(){if(arguments.length===1){if(arguments[0]instanceof Wn){const e=arguments[0];return this.selfDivide(e._hi,e._lo)}else if(typeof arguments[0]=="number"){const e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];let r=null,s=null,u=null,p=null,g=null,l=null,E=null,P=null;return g=this._hi/e,l=Wn.SPLIT*g,r=l-g,P=Wn.SPLIT*e,r=l-r,s=g-r,u=P-e,E=g*e,u=P-u,p=e-u,P=r*u-E+r*p+s*u+s*p,l=(this._hi-E-P+this._lo-g*n)/e,P=g+l,this._hi=P,this._lo=g-P+l,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof Wn){const e=arguments[0];let n=null,r=null,s=null,u=null,p=null,g=null,l=null,E=null;p=this._hi/e._hi,g=Wn.SPLIT*p,n=g-p,E=Wn.SPLIT*e._hi,n=g-n,r=p-n,s=E-e._hi,l=p*e._hi,s=E-s,u=e._hi-s,E=n*s-l+n*u+r*s+r*u,g=(this._hi-l-E+this._lo-p*e._lo)/e._hi,E=p+g;const P=E,O=p-E+g;return new Wn(P,O)}else if(typeof arguments[0]=="number"){const e=arguments[0];return ji.isNaN(e)?Wn.createNaN():Wn.copy(this).selfDivide(e,0)}}ge(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>=e._lo}pow(e){if(e===0)return Wn.valueOf(1);let n=new Wn(this),r=Wn.valueOf(1),s=Math.abs(e);if(s>1)for(;s>0;)s%2===1&&r.selfMultiply(n),s/=2,s>0&&(n=n.sqr());else r=n;return e<0?r.reciprocal():r}ceil(){if(this.isNaN())return Wn.NaN;const e=Math.ceil(this._hi);let n=0;return e===this._hi&&(n=Math.ceil(this._lo)),new Wn(e,n)}compareTo(e){const n=e;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}max(e){return this.ge(e)?this:e}sqrt(){if(this.isZero())return Wn.valueOf(0);if(this.isNegative())return Wn.NaN;const e=1/Math.sqrt(this._hi),n=this._hi*e,r=Wn.valueOf(n),u=this.subtract(r.sqr())._hi*(e*.5);return r.add(u)}selfAdd(){if(arguments.length===1){if(arguments[0]instanceof Wn){const e=arguments[0];return this.selfAdd(e._hi,e._lo)}else if(typeof arguments[0]=="number"){const e=arguments[0];let n=null,r=null,s=null,u=null,p=null,g=null;return s=this._hi+e,p=s-this._hi,u=s-p,u=e-p+(this._hi-u),g=u+this._lo,n=s+g,r=g+(s-n),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];let r=null,s=null,u=null,p=null,g=null,l=null,E=null,P=null;g=this._hi+e,u=this._lo+n,E=g-this._hi,P=u-this._lo,l=g-E,p=u-P,l=e-E+(this._hi-l),p=n-P+(this._lo-p),E=l+u,r=g+E,s=E+(g-r),E=p+s;const O=r+E,j=E+(r-O);return this._hi=O,this._lo=j,this}}selfMultiply(){if(arguments.length===1){if(arguments[0]instanceof Wn){const e=arguments[0];return this.selfMultiply(e._hi,e._lo)}else if(typeof arguments[0]=="number"){const e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];let r=null,s=null,u=null,p=null,g=null,l=null;g=Wn.SPLIT*this._hi,r=g-this._hi,l=Wn.SPLIT*e,r=g-r,s=this._hi-r,u=l-e,g=this._hi*e,u=l-u,p=e-u,l=r*u-g+r*p+s*u+s*p+(this._hi*n+this._lo*e);const E=g+l;r=g-E;const P=l+r;return this._hi=E,this._lo=P,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return Wn.NaN;const e=Math.floor(this._hi);let n=0;return e===this._hi&&(n=Math.floor(this._lo)),new Wn(e,n)}negate(){return this.isNaN()?this:new Wn(-this._hi,-this._lo)}clone(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return null;throw e}finally{}}intValue(){return Math.trunc(this._hi)}toString(){const e=Wn.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const e=this.getSpecialNumberString();if(e!==null)return e;const n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),s=n[0]+1;let u=r;if(r.charAt(0)===".")u="0"+r;else if(s<0)u="0."+Wn.stringOfChar("0",-s)+r;else if(r.indexOf(".")===-1){const p=s-r.length,g=Wn.stringOfChar("0",p);u=r+g+".0"}return this.isNegative()?"-"+u:u}toSciNotation(){if(this.isZero())return Wn.SCI_NOT_ZERO;const e=this.getSpecialNumberString();if(e!==null)return e;const n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),s=Wn.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Hb("Found leading zero: "+r);let u="";r.length>1&&(u=r.substring(1));const p=r.charAt(0)+"."+u;return this.isNegative()?"-"+p+s:p+s}abs(){return this.isNaN()?Wn.NaN:this.isNegative()?this.negate():new Wn(this)}isPositive(){return this._hi>0||this._hi===0&&this._lo>0}lt(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<e._lo}add(){if(arguments[0]instanceof Wn){const e=arguments[0];return Wn.copy(this).selfAdd(e)}else if(typeof arguments[0]=="number"){const e=arguments[0];return Wn.copy(this).selfAdd(e)}}init(){if(arguments.length===1){if(typeof arguments[0]=="number"){const e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof Wn){const e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this._hi=e,this._lo=n}}gt(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>e._lo}isNegative(){return this._hi<0||this._hi===0&&this._lo<0}trunc(){return this.isNaN()?Wn.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[Gm,d3,zM]}}Wn.PI=new Wn(3.141592653589793,12246467991473532e-32);Wn.TWO_PI=new Wn(6.283185307179586,24492935982947064e-32);Wn.PI_2=new Wn(1.5707963267948966,6123233995736766e-32);Wn.E=new Wn(2.718281828459045,14456468917292502e-32);Wn.NaN=new Wn(ji.NaN,ji.NaN);Wn.EPS=123259516440783e-46;Wn.SPLIT=134217729;Wn.MAX_PRINT_DIGITS=32;Wn.TEN=Wn.valueOf(10);Wn.ONE=Wn.valueOf(1);Wn.SCI_NOT_EXPONENT_CHAR="E";Wn.SCI_NOT_ZERO="0.0E0";class wm{static orientationIndex(e,n,r){const s=wm.orientationIndexFilter(e,n,r);if(s<=1)return s;const u=Wn.valueOf(n.x).selfAdd(-e.x),p=Wn.valueOf(n.y).selfAdd(-e.y),g=Wn.valueOf(r.x).selfAdd(-n.x),l=Wn.valueOf(r.y).selfAdd(-n.y);return u.selfMultiply(l).selfSubtract(p.selfMultiply(g)).signum()}static signOfDet2x2(){if(arguments[3]instanceof Wn&&arguments[2]instanceof Wn&&arguments[0]instanceof Wn&&arguments[1]instanceof Wn){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];return e.multiply(s).selfSubtract(n.multiply(r)).signum()}else if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3],u=Wn.valueOf(e),p=Wn.valueOf(n),g=Wn.valueOf(r),l=Wn.valueOf(s);return u.multiply(l).selfSubtract(p.multiply(g)).signum()}}static intersection(e,n,r,s){const u=new Wn(e.y).selfSubtract(n.y),p=new Wn(n.x).selfSubtract(e.x),g=new Wn(e.x).selfMultiply(n.y).selfSubtract(new Wn(n.x).selfMultiply(e.y)),l=new Wn(r.y).selfSubtract(s.y),E=new Wn(s.x).selfSubtract(r.x),P=new Wn(r.x).selfMultiply(s.y).selfSubtract(new Wn(s.x).selfMultiply(r.y)),O=p.multiply(P).selfSubtract(E.multiply(g)),j=l.multiply(g).selfSubtract(u.multiply(P)),$=u.multiply(E).selfSubtract(l.multiply(p)),Y=O.selfDivide($).doubleValue(),re=j.selfDivide($).doubleValue();return ji.isNaN(Y)||ji.isInfinite(Y)||ji.isNaN(re)||ji.isInfinite(re)?null:new Dn(Y,re)}static orientationIndexFilter(e,n,r){let s=null;const u=(e.x-r.x)*(n.y-r.y),p=(e.y-r.y)*(n.x-r.x),g=u-p;if(u>0){if(p<=0)return wm.signum(g);s=u+p}else if(u<0){if(p>=0)return wm.signum(g);s=-u-p}else return wm.signum(g);const l=wm.DP_SAFE_EPSILON*s;return g>=l||-g>=l?wm.signum(g):2}static signum(e){return e>0?1:e<0?-1:0}}wm.DP_SAFE_EPSILON=1e-15;class la{static isCCW(){if(arguments[0]instanceof Array){const e=arguments[0],n=e.length-1;if(n<3)throw new yo("Ring has fewer than 4 points, so orientation cannot be determined");let r=e[0],s=0;for(let O=1;O<=n;O++){const j=e[O];j.y>r.y&&(r=j,s=O)}let u=s;do u=u-1,u<0&&(u=n);while(e[u].equals2D(r)&&u!==s);let p=s;do p=(p+1)%n;while(e[p].equals2D(r)&&p!==s);const g=e[u],l=e[p];if(g.equals2D(r)||l.equals2D(r)||g.equals2D(l))return!1;const E=la.index(g,r,l);let P=null;return E===0?P=g.x>l.x:P=E>0,P}else if(us(arguments[0],js)){const e=arguments[0],n=e.size()-1;if(n<3)throw new yo("Ring has fewer than 4 points, so orientation cannot be determined");let r=e.getCoordinate(0),s=0;for(let O=1;O<=n;O++){const j=e.getCoordinate(O);j.y>r.y&&(r=j,s=O)}let u=null,p=s;do p=p-1,p<0&&(p=n),u=e.getCoordinate(p);while(u.equals2D(r)&&p!==s);let g=null,l=s;do l=(l+1)%n,g=e.getCoordinate(l);while(g.equals2D(r)&&l!==s);if(u.equals2D(r)||g.equals2D(r)||u.equals2D(g))return!1;const E=la.index(u,r,g);let P=null;return E===0?P=u.x>g.x:P=E>0,P}}static index(e,n,r){return wm.orientationIndex(e,n,r)}}la.CLOCKWISE=-1;la.RIGHT=la.CLOCKWISE;la.COUNTERCLOCKWISE=1;la.LEFT=la.COUNTERCLOCKWISE;la.COLLINEAR=0;la.STRAIGHT=la.COLLINEAR;class bp extends oi{constructor(){super(),bp.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let e=arguments[0],n=arguments[1],r=arguments[2];if(oi.constructor_.call(this,r),e===null&&(e=this.getFactory().createLinearRing()),n===null&&(n=[]),oi.hasNullElements(n))throw new yo("holes must not contain null elements");if(e.isEmpty()&&oi.hasNonEmptyElements(n))throw new yo("shell is empty but holes are not");this._shell=e,this._holes=n}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const e=new Array(this.getNumPoints()).fill(null);let n=-1;const r=this._shell.getCoordinates();for(let s=0;s<r.length;s++)n++,e[n]=r[s];for(let s=0;s<this._holes.length;s++){const u=this._holes[s].getCoordinates();for(let p=0;p<u.length;p++)n++,e[n]=u[p]}return e}getArea(){let e=0;e+=s9.ofRing(this._shell.getCoordinateSequence());for(let n=0;n<this._holes.length;n++)e-=s9.ofRing(this._holes[n].getCoordinateSequence());return e}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;const r=e,s=this._shell,u=r._shell;if(!s.equalsExact(u,n)||this._holes.length!==r._holes.length)return!1;for(let p=0;p<this._holes.length;p++)if(!this._holes[p].equalsExact(r._holes[p],n))return!1;return!0}else return super.equalsExact.apply(this,arguments)}reverseInternal(){const e=this.getExteriorRing().reverse(),n=new Array(this.getNumInteriorRing()).fill(null);for(let r=0;r<n.length;r++)n[r]=this.getInteriorRingN(r).reverse();return this.getFactory().createPolygon(e,n)}getTypeCode(){return oi.TYPECODE_POLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const e=new Array(this._holes.length+1).fill(null);e[0]=this._shell;for(let n=0;n<this._holes.length;n++)e[n+1]=this._holes[n];return e.length<=1?this.getFactory().createLinearRing(e[0].getCoordinateSequence()):this.getFactory().createMultiLineString(e)}getGeometryType(){return oi.TYPENAME_POLYGON}getExteriorRing(){return this._shell}copyInternal(){const e=this._shell.copy(),n=new Array(this._holes.length).fill(null);for(let r=0;r<this._holes.length;r++)n[r]=this._holes[r].copy();return new bp(e,n,this._factory)}isRectangle(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;const e=this._shell.getCoordinateSequence(),n=this.getEnvelopeInternal();for(let u=0;u<5;u++){const p=e.getX(u);if(!(p===n.getMinX()||p===n.getMaxX()))return!1;const g=e.getY(u);if(!(g===n.getMinY()||g===n.getMaxY()))return!1}let r=e.getX(0),s=e.getY(0);for(let u=1;u<=4;u++){const p=e.getX(u),g=e.getY(u);if(p!==r===(g!==s))return!1;r=p,s=g}return!0}normalize(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(let e=0;e<this._holes.length;e++)this._holes[e]=this.normalized(this._holes[e],!1);nb.sort(this._holes)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];if(e.isEmpty())return null;const r=e.getCoordinateSequence(),s=cl.minCoordinateIndex(r,0,r.size()-2);cl.scroll(r,s,!0),la.isCCW(r)===n&&cl.reverse(r)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getLength(){let e=0;e+=this._shell.getLength();for(let n=0;n<this._holes.length;n++)e+=this._holes[n].getLength();return e}getNumPoints(){let e=this._shell.getNumPoints();for(let n=0;n<this._holes.length;n++)e+=this._holes[n].getNumPoints();return e}convexHull(){return this.getExteriorRing().convexHull()}normalized(e,n){const r=e.copy();return this.normalize(r,n),r}compareToSameClass(){if(arguments.length===1){const e=arguments[0],n=this._shell,r=e._shell;return n.compareToSameClass(r)}else if(arguments.length===2){const e=arguments[0],n=arguments[1],r=e,s=this._shell,u=r._shell,p=s.compareToSameClass(u,n);if(p!==0)return p;const g=this.getNumInteriorRing(),l=r.getNumInteriorRing();let E=0;for(;E<g&&E<l;){const P=this.getInteriorRingN(E),O=r.getInteriorRingN(E),j=P.compareToSameClass(O,n);if(j!==0)return j;E++}return E<g?1:E<l?-1:0}}apply(){if(us(arguments[0],BM)){const e=arguments[0];this._shell.apply(e);for(let n=0;n<this._holes.length;n++)this._holes[n].apply(e)}else if(us(arguments[0],UM)){const e=arguments[0];if(this._shell.apply(e),!e.isDone())for(let n=0;n<this._holes.length&&(this._holes[n].apply(e),!e.isDone());n++);e.isGeometryChanged()&&this.geometryChanged()}else if(us(arguments[0],pv))arguments[0].filter(this);else if(us(arguments[0],f3)){const e=arguments[0];e.filter(this),this._shell.apply(e);for(let n=0;n<this._holes.length;n++)this._holes[n].apply(e)}}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(e){return this._holes[e]}get interfaces_(){return[wH]}}class o9 extends Nu{constructor(){super(),o9.constructor_.apply(this,arguments)}static constructor_(){const e=arguments[0],n=arguments[1];Nu.constructor_.call(this,e,n)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oi){const e=arguments[0],n=arguments[1];return this.isEquivalentClass(e)?super.equalsExact.call(this,e,n):!1}else return super.equalsExact.apply(this,arguments)}getTypeCode(){return oi.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return oi.TYPENAME_MULTIPOINT}copyInternal(){const e=new Array(this._geometries.length).fill(null);for(let n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new o9(e,this._factory)}isValid(){return!0}getCoordinate(){if(arguments.length===1&&Number.isInteger(arguments[0])){const e=arguments[0];return this._geometries[e].getCoordinate()}else return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return Ki.FALSE}get interfaces_(){return[EH]}}class bc{constructor(){bc.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)bc.constructor_.call(this,new qo,0);else if(arguments.length===1){if(us(arguments[0],vH)){const e=arguments[0];bc.constructor_.call(this,new qo,0,e)}else if(arguments[0]instanceof qo){const e=arguments[0];bc.constructor_.call(this,e,0,bc.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];bc.constructor_.call(this,e,n,bc.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._coordinateSequenceFactory=r,this._SRID=n}}static toMultiPolygonArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static toGeometryArray(e){if(e===null)return null;const n=new Array(e.size()).fill(null);return e.toArray(n)}static getDefaultCoordinateSequenceFactory(){return jb.instance()}static toMultiLineStringArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static toLineStringArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static toMultiPointArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static toLinearRingArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static toPointArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static toPolygonArray(e){const n=new Array(e.size()).fill(null);return e.toArray(n)}static createPointFromInternalCoord(e,n){return n.getPrecisionModel().makePrecise(e),n.getFactory().createPoint(e)}createEmpty(e){switch(e){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new yo("Invalid dimension: "+e)}}toGeometry(e){return e.isNull()?this.createPoint():e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new Dn(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new Dn(e.getMinX(),e.getMinY()),new Dn(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new Dn(e.getMinX(),e.getMinY()),new Dn(e.getMinX(),e.getMaxY()),new Dn(e.getMaxX(),e.getMaxY()),new Dn(e.getMaxX(),e.getMinY()),new Dn(e.getMinX(),e.getMinY())]),null)}createLineString(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const e=arguments[0];return this.createLineString(e!==null?this.getCoordinateSequenceFactory().create(e):null)}else if(us(arguments[0],js)){const e=arguments[0];return new sc(e,this)}}}createMultiLineString(){if(arguments.length===0)return new Gb(null,this);if(arguments.length===1){const e=arguments[0];return new Gb(e,this)}}createPolygon(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(us(arguments[0],js)){const e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof Array){const e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof Py){const e=arguments[0];return this.createPolygon(e,null)}}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return new bp(e,n,this)}}getSRID(){return this._SRID}createGeometryCollection(){if(arguments.length===0)return new Nu(null,this);if(arguments.length===1){const e=arguments[0];return new Nu(e,this)}}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}else if(us(arguments[0],js)){const e=arguments[0];return new Py(e,this)}}}createMultiPolygon(){if(arguments.length===0)return new Vb(null,this);if(arguments.length===1){const e=arguments[0];return new Vb(e,this)}}createMultiPoint(){if(arguments.length===0)return new o9(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){const e=arguments[0];return new o9(e,this)}else if(us(arguments[0],js)){const e=arguments[0];if(e===null)return this.createMultiPoint(new Array(0).fill(null));const n=new Array(e.size()).fill(null);for(let r=0;r<e.size();r++){const s=this.getCoordinateSequenceFactory().create(1,e.getDimension(),e.getMeasures());cl.copy(e,r,s,0,1),n[r]=this.createPoint(s)}return this.createMultiPoint(n)}}}buildGeometry(e){let n=null,r=!1,s=!1;for(let g=e.iterator();g.hasNext();){const l=g.next(),E=l.getTypeCode();n===null&&(n=E),E!==n&&(r=!0),l instanceof Nu&&(s=!0)}if(n===null)return this.createGeometryCollection();if(r||s)return this.createGeometryCollection(bc.toGeometryArray(e));const u=e.iterator().next();if(e.size()>1){if(u instanceof bp)return this.createMultiPolygon(bc.toPolygonArray(e));if(u instanceof sc)return this.createMultiLineString(bc.toLineStringArray(e));if(u instanceof lp)return this.createMultiPoint(bc.toPointArray(e));Lm.shouldNeverReachHere("Unhandled geometry type: "+u.getGeometryType())}return u}createMultiPointFromCoords(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)}createPoint(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Dn){const e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}else if(us(arguments[0],js)){const e=arguments[0];return new lp(e,this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}get interfaces_(){return[Gm]}}const Mae=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class kae{constructor(e){this.geometryFactory=e||new bc}read(e){let n;typeof e=="string"?n=JSON.parse(e):n=e;const r=n.type;if(!Hd[r])throw new Error("Unknown GeoJSON type: "+n.type);return Mae.indexOf(r)!==-1?Hd[r].call(this,n.coordinates):r==="GeometryCollection"?Hd[r].call(this,n.geometries):Hd[r].call(this,n)}write(e){const n=e.getGeometryType();if(!vm[n])throw new Error("Geometry is not supported");return vm[n].call(this,e)}}const Hd={Feature:function(t){const e={};for(const n in t)e[n]=t[n];if(t.geometry){const n=t.geometry.type;if(!Hd[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Hd.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n];e.push(new Dn(...r))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new Dn(t[0],t[1]),new Dn(t[2],t[1]),new Dn(t[2],t[3]),new Dn(t[0],t[3]),new Dn(t[0],t[1])])},Point:function(t){const e=new Dn(...t);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(Hd.Point.call(this,t[n]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=Hd.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let n=0;n<t.length;++n)e.push(Hd.LineString.call(this,t[n]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=Hd.coordinates.call(this,t[0]),n=this.geometryFactory.createLinearRing(e),r=[];for(let s=1;s<t.length;++s){const u=t[s],p=Hd.coordinates.call(this,u),g=this.geometryFactory.createLinearRing(p);r.push(g)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n];e.push(Hd.Polygon.call(this,r))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},vm={coordinate:function(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e},Point:function(t){return{type:"Point",coordinates:vm.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const r=t._geometries[n],s=vm.Point.call(this,r);e.push(s.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],n=t.getCoordinates();for(let r=0;r<n.length;++r){const s=n[r];e.push(vm.coordinate.call(this,s))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const r=t._geometries[n],s=vm.LineString.call(this,r);e.push(s.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],n=vm.LineString.call(this,t._shell);e.push(n.coordinates);for(let r=0;r<t._holes.length;++r){const s=t._holes[r],u=vm.LineString.call(this,s);e.push(u.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const r=t._geometries[n],s=vm.Polygon.call(this,r);e.push(s.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let n=0;n<t._geometries.length;++n){const r=t._geometries[n],s=r.getGeometryType();e.push(vm[s].call(this,r))}return{type:"GeometryCollection",geometries:e}}};class iN{constructor(e){this.parser=new kae(e||new bc)}read(e){return this.parser.read(e)}}const Ix={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},sN={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},SH="EMPTY",TH="Z",MH="M",Cae="ZM",mo={TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6};for(const t in sN)sN[t].toUpperCase();class Iae{constructor(e){this.wkt=e,this.index_=-1}isAlpha_(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}isNumeric_(e,n){const r=n!==void 0?n:!1;return e>="0"&&e<="9"||e=="."&&!r}isWhiteSpace_(e){return e==" "||e=="	"||e=="\r"||e==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const e=this.nextChar_(),n=this.index_;let r=e,s;if(e=="(")s=mo.LEFT_PAREN;else if(e==",")s=mo.COMMA;else if(e==")")s=mo.RIGHT_PAREN;else if(this.isNumeric_(e)||e=="-")s=mo.NUMBER,r=this.readNumber_();else if(this.isAlpha_(e))s=mo.TEXT,r=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e==="")s=mo.EOF;else throw new Error("Unexpected character: "+e)}return{position:n,value:r,type:s}}readNumber_(){let e;const n=this.index_;let r=!1,s=!1;do e=="."?r=!0:(e=="e"||e=="E")&&(s=!0),e=this.nextChar_();while(this.isNumeric_(e,r)||!s&&(e=="e"||e=="E")||s&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(n,this.index_--))}readText_(){let e;const n=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(n,this.index_--).toUpperCase()}}class Aae{constructor(e,n){this.lexer_=e,this.token_,this.layout_=Ix.XY,this.factory=n}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(e){return this.token_.type==e}match(e){const n=this.isTokenType(e);return n&&this.consume_(),n}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let e=Ix.XY;const n=this.token_;if(this.isTokenType(mo.TEXT)){const r=n.value;r===TH?e=Ix.XYZ:r===MH?e=Ix.XYM:r===Cae&&(e=Ix.XYZM),e!==Ix.XY&&this.consume_()}return e}parseGeometryCollectionText_(){if(this.match(mo.LEFT_PAREN)){const e=[];do e.push(this.parseGeometry_());while(this.match(mo.COMMA));if(this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(mo.LEFT_PAREN)){const e=this.parsePoint_();if(this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(mo.LEFT_PAREN)){const e=this.parsePointList_();if(this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(mo.LEFT_PAREN)){const e=this.parseLineStringTextList_();if(this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(mo.LEFT_PAREN)){let e;if(this.token_.type==mo.LEFT_PAREN?e=this.parsePointTextList_():e=this.parsePointList_(),this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(mo.LEFT_PAREN)){const e=this.parseLineStringTextList_();if(this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(mo.LEFT_PAREN)){const e=this.parsePolygonTextList_();if(this.match(mo.RIGHT_PAREN))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePoint_(){const e=[],n=this.layout_.length;for(let r=0;r<n;++r){const s=this.token_;if(this.match(mo.NUMBER))e.push(s.value);else break}if(e.length==n)return e;throw new Error(this.formatErrorMessage_())}parsePointList_(){const e=[this.parsePoint_()];for(;this.match(mo.COMMA);)e.push(this.parsePoint_());return e}parsePointTextList_(){const e=[this.parsePointText_()];for(;this.match(mo.COMMA);)e.push(this.parsePointText_());return e}parseLineStringTextList_(){const e=[this.parseLineStringText_()];for(;this.match(mo.COMMA);)e.push(this.parseLineStringText_());return e}parsePolygonTextList_(){const e=[this.parsePolygonText_()];for(;this.match(mo.COMMA);)e.push(this.parsePolygonText_());return e}isEmptyGeometry_(){const e=this.isTokenType(mo.TEXT)&&this.token_.value==SH;return e&&this.consume_(),e}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const e=this.factory,n=u=>u?new Dn(...u):new Dn,r=u=>{const p=u.map(g=>e.createLinearRing(g.map(n)));return p.length>1?e.createPolygon(p[0],p.slice(1)):p.length===1?e.createPolygon(p[0]):e.createPolygon()},s=this.token_;if(this.match(mo.TEXT)){const u=s.value;if(this.layout_=this.parseGeometryLayout_(),u=="GEOMETRYCOLLECTION"){const p=this.parseGeometryCollectionText_();return e.createGeometryCollection(p)}else switch(u){case"POINT":{const p=this.parsePointText_();return p?e.createPoint(new Dn(...p)):e.createPoint()}case"LINESTRING":{const g=this.parseLineStringText_().map(n);return e.createLineString(g)}case"LINEARRING":{const g=this.parseLineStringText_().map(n);return e.createLinearRing(g)}case"POLYGON":{const p=this.parsePolygonText_();return!p||p.length===0?e.createPolygon():r(p)}case"MULTIPOINT":{const p=this.parseMultiPointText_();if(!p||p.length===0)return e.createMultiPoint();const g=p.map(n).map(l=>e.createPoint(l));return e.createMultiPoint(g)}case"MULTILINESTRING":{const g=this.parseMultiLineStringText_().map(l=>e.createLineString(l.map(n)));return e.createMultiLineString(g)}case"MULTIPOLYGON":{const p=this.parseMultiPolygonText_();if(!p||p.length===0)return e.createMultiPolygon();const g=p.map(r);return e.createMultiPolygon(g)}default:throw new Error("Invalid geometry type: "+u)}}throw new Error(this.formatErrorMessage_())}}function kH(t){if(t.isEmpty())return"";const e=t.getCoordinate(),n=[e.x,e.y];return e.z!==void 0&&!Number.isNaN(e.z)&&n.push(e.z),e.m!==void 0&&!Number.isNaN(e.m)&&n.push(e.m),n.join(" ")}function Lae(t){const e=[];for(let n=0,r=t.getNumGeometries();n<r;++n)e.push("("+kH(t.getGeometryN(n))+")");return e.join(", ")}function Pae(t){const e=[];for(let n=0,r=t.getNumGeometries();n<r;++n)e.push(IH(t.getGeometryN(n)));return e.join(", ")}function a9(t){const e=t.getCoordinates().map(r=>{const s=[r.x,r.y];return r.z!==void 0&&!Number.isNaN(r.z)&&s.push(r.z),r.m!==void 0&&!Number.isNaN(r.m)&&s.push(r.m),s}),n=[];for(let r=0,s=e.length;r<s;++r)n.push(e[r].join(" "));return n.join(", ")}function Rae(t){const e=[];for(let n=0,r=t.getNumGeometries();n<r;++n)e.push("("+a9(t.getGeometryN(n))+")");return e.join(", ")}function CH(t){const e=[];e.push("("+a9(t.getExteriorRing())+")");for(let n=0,r=t.getNumInteriorRing();n<r;++n)e.push("("+a9(t.getInteriorRingN(n))+")");return e.join(", ")}function Nae(t){const e=[];for(let n=0,r=t.getNumGeometries();n<r;++n)e.push("("+CH(t.getGeometryN(n))+")");return e.join(", ")}function Dae(t){let e="";if(t.isEmpty())return e;const n=t.getCoordinate();return n.z!==void 0&&!Number.isNaN(n.z)&&(e+=TH),n.m!==void 0&&!Number.isNaN(n.m)&&(e+=MH),e}const Oae={Point:kH,LineString:a9,LinearRing:a9,Polygon:CH,MultiPoint:Lae,MultiLineString:Rae,MultiPolygon:Nae,GeometryCollection:Pae};function IH(t){let e=t.getGeometryType();const n=Oae[e];e=e.toUpperCase();const r=Dae(t);if(r.length>0&&(e+=" "+r),t.isEmpty())return e+" "+SH;const s=n(t);return e+" ("+s+")"}class Fae{constructor(e){this.geometryFactory=e||new bc,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(e){const n=new Iae(e);return new Aae(n,this.geometryFactory).parse()}write(e){return IH(e)}}class p2{constructor(e){this.parser=new Fae(e)}write(e){return this.parser.write(e)}static toLineString(e,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+n.x+" "+n.y+" )"}}class Ec{constructor(){Ec.constructor_.apply(this,arguments)}static constructor_(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){const e=arguments[0],n=arguments[1];Ec.constructor_.call(this,e,Ec.INSIDE_AREA,n)}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];this._component=e,this._segIndex=n,this._pt=r}}getSegmentIndex(){return this._segIndex}getCoordinate(){return this._pt}isInsideArea(){return this._segIndex===Ec.INSIDE_AREA}toString(){return this._component.getGeometryType()+"["+this._segIndex+"]-"+p2.toPoint(this._pt)}getGeometryComponent(){return this._component}}Ec.INSIDE_AREA=-1;class jd{constructor(){jd.constructor_.apply(this,arguments)}static constructor_(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){const e=arguments[0];this._lines=e}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}}static getLines(){if(arguments.length===1){const e=arguments[0];return jd.getLines(e,!1)}else if(arguments.length===2){if(us(arguments[0],Yh)&&us(arguments[1],Yh)){const e=arguments[0],n=arguments[1];for(let r=e.iterator();r.hasNext();){const s=r.next();jd.getLines(s,n)}return n}else if(arguments[0]instanceof oi&&typeof arguments[1]=="boolean"){const e=arguments[0],n=arguments[1],r=new Hm;return e.apply(new jd(r,n)),r}else if(arguments[0]instanceof oi&&us(arguments[1],Yh)){const e=arguments[0],n=arguments[1];return e instanceof sc?n.add(e):e.apply(new jd(n)),n}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&us(arguments[0],Yh)&&us(arguments[1],Yh)){const e=arguments[0],n=arguments[1],r=arguments[2];for(let s=e.iterator();s.hasNext();){const u=s.next();jd.getLines(u,n,r)}return n}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof oi&&us(arguments[1],Yh)){const e=arguments[0],n=arguments[1],r=arguments[2];return e.apply(new jd(n,r)),n}}}static getGeometry(){if(arguments.length===1){const e=arguments[0];return e.getFactory().buildGeometry(jd.getLines(e))}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(jd.getLines(e,n))}}filter(e){if(this._isForcedToLineString&&e instanceof Py){const n=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(n),null}e instanceof sc&&this._lines.add(e)}setForceToLineString(e){this._isForcedToLineString=e}get interfaces_(){return[f3]}}class Iu{static pointToSegmentString(e,n){if(n.length===0)throw new yo("Line array must contain at least one vertex");let r=e.distance(n[0]);for(let s=0;s<n.length-1;s++){const u=Iu.pointToSegment(e,n[s],n[s+1]);u<r&&(r=u)}return r}static segmentToSegment(e,n,r,s){if(e.equals(n))return Iu.pointToSegment(e,r,s);if(r.equals(s))return Iu.pointToSegment(s,e,n);let u=!1;if(!go.intersects(e,n,r,s))u=!0;else{const p=(n.x-e.x)*(s.y-r.y)-(n.y-e.y)*(s.x-r.x);if(p===0)u=!0;else{const g=(e.y-r.y)*(s.x-r.x)-(e.x-r.x)*(s.y-r.y),E=((e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y))/p,P=g/p;(P<0||P>1||E<0||E>1)&&(u=!0)}}return u?Ub.min(Iu.pointToSegment(e,r,s),Iu.pointToSegment(n,r,s),Iu.pointToSegment(r,e,n),Iu.pointToSegment(s,e,n)):0}static pointToLinePerpendicular(e,n,r){const s=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),u=((n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y))/s;return Math.abs(u)*Math.sqrt(s)}static pointToSegment(e,n,r){if(n.x===r.x&&n.y===r.y)return e.distance(n);const s=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),u=((e.x-n.x)*(r.x-n.x)+(e.y-n.y)*(r.y-n.y))/s;if(u<=0)return e.distance(n);if(u>=1)return e.distance(r);const p=((n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y))/s;return Math.abs(p)*Math.sqrt(s)}}class _s{static toLocationSymbol(e){switch(e){case _s.EXTERIOR:return"e";case _s.BOUNDARY:return"b";case _s.INTERIOR:return"i";case _s.NONE:return"-"}throw new yo("Unknown location value: "+e)}}_s.INTERIOR=0;_s.BOUNDARY=1;_s.EXTERIOR=2;_s.NONE=-1;class AH{static intersection(e,n,r,s){const u=e.x<n.x?e.x:n.x,p=e.y<n.y?e.y:n.y,g=e.x>n.x?e.x:n.x,l=e.y>n.y?e.y:n.y,E=r.x<s.x?r.x:s.x,P=r.y<s.y?r.y:s.y,O=r.x>s.x?r.x:s.x,j=r.y>s.y?r.y:s.y,$=u>E?u:E,Y=g<O?g:O,re=p>P?p:P,_e=l<j?l:j,J=($+Y)/2,H=(re+_e)/2,te=e.x-J,ce=e.y-H,Se=n.x-J,Ie=n.y-H,Ne=r.x-J,ut=r.y-H,mt=s.x-J,We=s.y-H,Ot=ce-Ie,st=Se-te,qe=te*Ie-Se*ce,et=ut-We,Q=mt-Ne,ye=Ne*We-mt*ut,ge=st*ye-Q*qe,xe=et*qe-Ot*ye,Ce=Ot*Q-et*st,tt=ge/Ce,Je=xe/Ce;return ji.isNaN(tt)||ji.isInfinite(tt)||ji.isNaN(Je)||ji.isInfinite(Je)?null:new Dn(tt+J,Je+H)}}class Eo{constructor(){Eo.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Dn,this._intPt[1]=new Dn,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static nonRobustComputeEdgeDistance(e,n,r){const s=e.x-n.x,u=e.y-n.y,p=Math.sqrt(s*s+u*u);return Lm.isTrue(!(p===0&&!e.equals(n)),"Invalid distance calculation"),p}static computeEdgeDistance(e,n,r){const s=Math.abs(r.x-n.x),u=Math.abs(r.y-n.y);let p=-1;if(e.equals(n))p=0;else if(e.equals(r))s>u?p=s:p=u;else{const g=Math.abs(e.x-n.x),l=Math.abs(e.y-n.y);s>u?p=g:p=l,p===0&&!e.equals(n)&&(p=Math.max(g,l))}return Lm.isTrue(!(p===0&&!e.equals(n)),"Bad distance calculation"),p}computeIntersection(e,n,r,s){this._inputLines[0][0]=e,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=s,this._result=this.computeIntersect(e,n,r,s)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){const e=arguments[0],n=this.getEdgeDistance(e,0),r=this.getEdgeDistance(e,1);n>r?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}}isInteriorIntersection(){if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){const e=arguments[0];for(let n=0;n<this._result;n++)if(!(this._intPt[n].equals2D(this._inputLines[e][0])||this._intPt[n].equals2D(this._inputLines[e][1])))return!0;return!1}}getIntersection(e){return this._intPt[e]}getEdgeDistance(e,n){return Eo.computeEdgeDistance(this._intPt[n],this._inputLines[e][0],this._inputLines[e][1])}isCollinear(){return this._result===Eo.COLLINEAR_INTERSECTION}toString(){return p2.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+p2.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(e,n){return this._inputLines[e][n]}getIndexAlongSegment(e,n){return this.computeIntLineIndex(),this._intLineIndex[e][n]}getTopologySummary(){const e=new xH;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(e){this._precisionModel=e}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==Eo.NO_INTERSECTION}isIntersection(e){for(let n=0;n<this._result;n++)if(this._intPt[n].equals2D(e))return!0;return!1}getIntersectionAlongSegment(e,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][n]]}}Eo.DONT_INTERSECT=0;Eo.DO_INTERSECT=1;Eo.COLLINEAR=2;Eo.NO_INTERSECTION=0;Eo.POINT_INTERSECTION=1;Eo.COLLINEAR_INTERSECTION=2;class Wb extends Eo{constructor(){super()}static nearestEndpoint(e,n,r,s){let u=e,p=Iu.pointToSegment(e,r,s),g=Iu.pointToSegment(n,r,s);return g<p&&(p=g,u=n),g=Iu.pointToSegment(r,e,n),g<p&&(p=g,u=r),g=Iu.pointToSegment(s,e,n),g<p&&(p=g,u=s),u}isInSegmentEnvelopes(e){const n=new go(this._inputLines[0][0],this._inputLines[0][1]),r=new go(this._inputLines[1][0],this._inputLines[1][1]);return n.contains(e)&&r.contains(e)}computeIntersection(){if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,go.intersects(n,r,e)&&la.index(n,r,e)===0&&la.index(r,n,e)===0)return this._isProper=!0,(e.equals(n)||e.equals(r))&&(this._isProper=!1),this._result=Eo.POINT_INTERSECTION,null;this._result=Eo.NO_INTERSECTION}else return super.computeIntersection.apply(this,arguments)}intersection(e,n,r,s){let u=this.intersectionSafe(e,n,r,s);return this.isInSegmentEnvelopes(u)||(u=new Dn(Wb.nearestEndpoint(e,n,r,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u}checkDD(e,n,r,s,u){const p=wm.intersection(e,n,r,s),g=this.isInSegmentEnvelopes(p);h5.out.println("DD in env = "+g+"  --------------------- "+p),u.distance(p)>1e-4&&h5.out.println("Distance = "+u.distance(p))}intersectionSafe(e,n,r,s){let u=AH.intersection(e,n,r,s);return u===null&&(u=Wb.nearestEndpoint(e,n,r,s)),u}computeCollinearIntersection(e,n,r,s){const u=go.intersects(e,n,r),p=go.intersects(e,n,s),g=go.intersects(r,s,e),l=go.intersects(r,s,n);return u&&p?(this._intPt[0]=r,this._intPt[1]=s,Eo.COLLINEAR_INTERSECTION):g&&l?(this._intPt[0]=e,this._intPt[1]=n,Eo.COLLINEAR_INTERSECTION):u&&g?(this._intPt[0]=r,this._intPt[1]=e,r.equals(e)&&!p&&!l?Eo.POINT_INTERSECTION:Eo.COLLINEAR_INTERSECTION):u&&l?(this._intPt[0]=r,this._intPt[1]=n,r.equals(n)&&!p&&!g?Eo.POINT_INTERSECTION:Eo.COLLINEAR_INTERSECTION):p&&g?(this._intPt[0]=s,this._intPt[1]=e,s.equals(e)&&!u&&!l?Eo.POINT_INTERSECTION:Eo.COLLINEAR_INTERSECTION):p&&l?(this._intPt[0]=s,this._intPt[1]=n,s.equals(n)&&!u&&!g?Eo.POINT_INTERSECTION:Eo.COLLINEAR_INTERSECTION):Eo.NO_INTERSECTION}computeIntersect(e,n,r,s){if(this._isProper=!1,!go.intersects(e,n,r,s))return Eo.NO_INTERSECTION;const u=la.index(e,n,r),p=la.index(e,n,s);if(u>0&&p>0||u<0&&p<0)return Eo.NO_INTERSECTION;const g=la.index(r,s,e),l=la.index(r,s,n);return g>0&&l>0||g<0&&l<0?Eo.NO_INTERSECTION:u===0&&p===0&&g===0&&l===0?this.computeCollinearIntersection(e,n,r,s):(u===0||p===0||g===0||l===0?(this._isProper=!1,e.equals2D(r)||e.equals2D(s)?this._intPt[0]=e:n.equals2D(r)||n.equals2D(s)?this._intPt[0]=n:u===0?this._intPt[0]=new Dn(r):p===0?this._intPt[0]=new Dn(s):g===0?this._intPt[0]=new Dn(e):l===0&&(this._intPt[0]=new Dn(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,r,s)),Eo.POINT_INTERSECTION)}}class d5{constructor(){d5.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;const e=arguments[0];this._p=e}static locatePointInRing(){if(arguments[0]instanceof Dn&&us(arguments[1],js)){const e=arguments[0],n=arguments[1],r=new d5(e),s=new Dn,u=new Dn;for(let p=1;p<n.size();p++)if(n.getCoordinate(p,s),n.getCoordinate(p-1,u),r.countSegment(s,u),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof Dn&&arguments[1]instanceof Array){const e=arguments[0],n=arguments[1],r=new d5(e);for(let s=1;s<n.length;s++){const u=n[s],p=n[s-1];if(r.countSegment(u,p),r.isOnSegment())return r.getLocation()}return r.getLocation()}}getLocation(){return this._isPointOnSegment?_s.BOUNDARY:this._crossingCount%2===1?_s.INTERIOR:_s.EXTERIOR}isPointInPolygon(){return this.getLocation()!==_s.EXTERIOR}isOnSegment(){return this._isPointOnSegment}countSegment(e,n){if(e.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&n.y===this._p.y){let r=e.x,s=n.x;return r>s&&(r=n.x,s=e.x),this._p.x>=r&&this._p.x<=s&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&e.y<=this._p.y){let r=la.index(e,n,this._p);if(r===la.COLLINEAR)return this._isPointOnSegment=!0,null;n.y<e.y&&(r=-r),r===la.LEFT&&this._crossingCount++}}}class VS{static isInRing(e,n){return VS.locateInRing(e,n)!==_s.EXTERIOR}static locateInRing(e,n){return d5.locatePointInRing(e,n)}static isOnLine(){if(arguments[0]instanceof Dn&&us(arguments[1],js)){const e=arguments[0],n=arguments[1],r=new Wb,s=new Dn,u=new Dn,p=n.size();for(let g=1;g<p;g++)if(n.getCoordinate(g-1,s),n.getCoordinate(g,u),r.computeIntersection(e,s,u),r.hasIntersection())return!0;return!1}else if(arguments[0]instanceof Dn&&arguments[1]instanceof Array){const e=arguments[0],n=arguments[1],r=new Wb;for(let s=1;s<n.length;s++){const u=n[s-1],p=n[s];if(r.computeIntersection(e,u,p),r.hasIntersection())return!0}return!1}}}class Nc{isInBoundary(e){}}class LH{isInBoundary(e){return e%2===1}get interfaces_(){return[Nc]}}class PH{isInBoundary(e){return e>0}get interfaces_(){return[Nc]}}class RH{isInBoundary(e){return e>1}get interfaces_(){return[Nc]}}class NH{isInBoundary(e){return e===1}get interfaces_(){return[Nc]}}Nc.Mod2BoundaryNodeRule=LH;Nc.EndPointBoundaryNodeRule=PH;Nc.MultiValentEndPointBoundaryNodeRule=RH;Nc.MonoValentEndPointBoundaryNodeRule=NH;Nc.MOD2_BOUNDARY_RULE=new LH;Nc.ENDPOINT_BOUNDARY_RULE=new PH;Nc.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new RH;Nc.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new NH;Nc.OGC_SFS_BOUNDARY_RULE=Nc.MOD2_BOUNDARY_RULE;class zae{hasNext(){}next(){}remove(){}}class f5{constructor(){f5.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;const e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}static isAtomic(e){return!(e instanceof Nu)}next(){if(this._atStart)return this._atStart=!1,f5.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new p3;const e=this._parent.getGeometryN(this._index++);return e instanceof Nu?(this._subcollectionIterator=new f5(e),this._subcollectionIterator.next()):e}hasNext(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}remove(){throw new a0(this.getClass().getName())}get interfaces_(){return[zae]}}class gA{constructor(){gA.constructor_.apply(this,arguments)}static constructor_(){if(this._boundaryRule=Nc.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){const e=arguments[0];if(e===null)throw new yo("Rule must be non-null");this._boundaryRule=e}}}locateInPolygonRing(e,n){return n.getEnvelopeInternal().intersects(e)?VS.locateInRing(e,n.getCoordinates()):_s.EXTERIOR}intersects(e,n){return this.locate(e,n)!==_s.EXTERIOR}updateLocationInfo(e){e===_s.INTERIOR&&(this._isIn=!0),e===_s.BOUNDARY&&this._numBoundaries++}computeLocation(e,n){if(n instanceof lp&&this.updateLocationInfo(this.locateOnPoint(e,n)),n instanceof sc)this.updateLocationInfo(this.locateOnLineString(e,n));else if(n instanceof bp)this.updateLocationInfo(this.locateInPolygon(e,n));else if(n instanceof Gb){const r=n;for(let s=0;s<r.getNumGeometries();s++){const u=r.getGeometryN(s);this.updateLocationInfo(this.locateOnLineString(e,u))}}else if(n instanceof Vb){const r=n;for(let s=0;s<r.getNumGeometries();s++){const u=r.getGeometryN(s);this.updateLocationInfo(this.locateInPolygon(e,u))}}else if(n instanceof Nu){const r=new f5(n);for(;r.hasNext();){const s=r.next();s!==n&&this.computeLocation(e,s)}}}locateOnPoint(e,n){return n.getCoordinate().equals2D(e)?_s.INTERIOR:_s.EXTERIOR}locateOnLineString(e,n){if(!n.getEnvelopeInternal().intersects(e))return _s.EXTERIOR;const r=n.getCoordinateSequence();return!n.isClosed()&&(e.equals(r.getCoordinate(0))||e.equals(r.getCoordinate(r.size()-1)))?_s.BOUNDARY:VS.isOnLine(e,r)?_s.INTERIOR:_s.EXTERIOR}locateInPolygon(e,n){if(n.isEmpty())return _s.EXTERIOR;const r=n.getExteriorRing(),s=this.locateInPolygonRing(e,r);if(s===_s.EXTERIOR)return _s.EXTERIOR;if(s===_s.BOUNDARY)return _s.BOUNDARY;for(let u=0;u<n.getNumInteriorRing();u++){const p=n.getInteriorRingN(u),g=this.locateInPolygonRing(e,p);if(g===_s.INTERIOR)return _s.EXTERIOR;if(g===_s.BOUNDARY)return _s.BOUNDARY}return _s.INTERIOR}locate(e,n){return n.isEmpty()?_s.EXTERIOR:n instanceof sc?this.locateOnLineString(e,n):n instanceof bp?this.locateInPolygon(e,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,n),this._boundaryRule.isInBoundary(this._numBoundaries)?_s.BOUNDARY:this._numBoundaries>0||this._isIn?_s.INTERIOR:_s.EXTERIOR)}}class p5{constructor(){p5.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;const e=arguments[0];this._comps=e}static getPolygons(){if(arguments.length===1){const e=arguments[0];return p5.getPolygons(e,new Hm)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return e instanceof bp?n.add(e):e instanceof Nu&&e.apply(new p5(n)),n}}filter(e){e instanceof bp&&this._comps.add(e)}get interfaces_(){return[pv]}}const DH={reverseOrder:function(){return{compare(t,e){return e.compareTo(t)}}},min:function(t){return DH.sort(t),t.get(0)},sort:function(t,e){const n=t.toArray();e?nb.sort(n,e):nb.sort(n);const r=t.iterator();for(let s=0,u=n.length;s<u;s++)r.next(),r.set(n[s])},singletonList:function(t){const e=new Hm;return e.add(t),e}};class rb{constructor(){rb.constructor_.apply(this,arguments)}static constructor_(){this._pts=null;const e=arguments[0];this._pts=e}static getPoints(){if(arguments.length===1){const e=arguments[0];return e instanceof lp?DH.singletonList(e):rb.getPoints(e,new Hm)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];return e instanceof lp?n.add(e):e instanceof Nu&&e.apply(new rb(n)),n}}filter(e){e instanceof lp&&this._pts.add(e)}get interfaces_(){return[pv]}}class GS{constructor(){GS.constructor_.apply(this,arguments)}static constructor_(){this._locations=null;const e=arguments[0];this._locations=e}static getLocations(e){const n=new Hm;return e.apply(new GS(n)),n}filter(e){if(e.isEmpty())return null;(e instanceof lp||e instanceof sc||e instanceof bp)&&this._locations.add(new Ec(e,0,e.getCoordinate()))}get interfaces_(){return[pv]}}class ah{constructor(){ah.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,arguments.length===0)ah.constructor_.call(this,new Dn,new Dn);else if(arguments.length===1){const e=arguments[0];ah.constructor_.call(this,e.p0,e.p1)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(arguments.length===4){const e=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3];ah.constructor_.call(this,new Dn(e,n),new Dn(r,s))}}static midPoint(e,n){return new Dn((e.x+n.x)/2,(e.y+n.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof ah){const e=arguments[0],n=la.index(this.p0,this.p1,e.p0),r=la.index(this.p0,this.p1,e.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof Dn){const e=arguments[0];return la.index(this.p0,this.p1,e)}}toGeometry(e){return e.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return ah.midPoint(this.p0,this.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(e,n){const r=this.p0.x+e*(this.p1.x-this.p0.x),s=this.p0.y+e*(this.p1.y-this.p0.y),u=this.p1.x-this.p0.x,p=this.p1.y-this.p0.y,g=Math.sqrt(u*u+p*p);let l=0,E=0;if(n!==0){if(g<=0)throw new Hb("Cannot compute offset from zero-length line segment");l=n*u/g,E=n*p/g}const P=r-E,O=s+l;return new Dn(P,O)}setCoordinates(){if(arguments.length===1){const e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){const e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}}segmentFraction(e){let n=this.projectionFactor(e);return n<0?n=0:(n>1||ji.isNaN(n))&&(n=1),n}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}distance(){if(arguments[0]instanceof ah){const e=arguments[0];return Iu.segmentToSegment(this.p0,this.p1,e.p0,e.p1)}else if(arguments[0]instanceof Dn){const e=arguments[0];return Iu.pointToSegment(e,this.p0,this.p1)}}equals(e){if(!(e instanceof ah))return!1;const n=e;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)}intersection(e){const n=new Wb;return n.computeIntersection(this.p0,this.p1,e.p0,e.p1),n.hasIntersection()?n.getIntersection(0):null}project(){if(arguments[0]instanceof Dn){const e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new Dn(e);const n=this.projectionFactor(e),r=new Dn;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof ah){const e=arguments[0],n=this.projectionFactor(e.p0),r=this.projectionFactor(e.p1);if(n>=1&&r>=1||n<=0&&r<=0)return null;let s=this.project(e.p0);n<0&&(s=this.p0),n>1&&(s=this.p1);let u=this.project(e.p1);return r<0&&(u=this.p0),r>1&&(u=this.p1),new ah(s,u)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(e){return e===0?this.p0:this.p1}distancePerpendicular(e){return Iu.pointToLinePerpendicular(e,this.p0,this.p1)}closestPoint(e){const n=this.projectionFactor(e);if(n>0&&n<1)return this.project(e);const r=this.p0.distance(e),s=this.p1.distance(e);return r<s?this.p0:this.p1}projectionFactor(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;const n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,s=n*n+r*r;return s<=0?ji.NaN:((e.x-this.p0.x)*n+(e.y-this.p0.y)*r)/s}closestPoints(e){const n=this.intersection(e);if(n!==null)return[n,n];const r=new Array(2).fill(null);let s=ji.MAX_VALUE,u=null;const p=this.closestPoint(e.p0);s=p.distance(e.p0),r[0]=p,r[1]=e.p0;const g=this.closestPoint(e.p1);u=g.distance(e.p1),u<s&&(s=u,r[0]=g,r[1]=e.p1);const l=e.closestPoint(this.p0);u=l.distance(this.p0),u<s&&(s=u,r[0]=this.p0,r[1]=l);const E=e.closestPoint(this.p1);return u=E.distance(this.p1),u<s&&(s=u,r[0]=this.p1,r[1]=E),r}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(e){const n=e,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)}reverse(){const e=this.p0;this.p0=this.p1,this.p1=e}equalsTopo(e){return this.p0.equals(e.p0)&&this.p1.equals(e.p1)||this.p0.equals(e.p1)&&this.p1.equals(e.p0)}lineIntersection(e){return AH.intersection(this.p0,this.p1,e.p0,e.p1)}isHorizontal(){return this.p0.y===this.p1.y}reflect(e){const n=this.p1.getY()-this.p0.getY(),r=this.p0.getX()-this.p1.getX(),s=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),u=n*n+r*r,p=n*n-r*r,g=e.getX(),l=e.getY(),E=(-p*g-2*n*r*l-2*n*s)/u,P=(p*l-2*n*r*g-2*r*s)/u;return new Dn(E,P)}pointAlong(e){const n=new Dn;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}hashCode(){let e=ji.doubleToLongBits(this.p0.x);e^=ji.doubleToLongBits(this.p0.y)*31;const n=Math.trunc(e)^Math.trunc(e>>32);let r=ji.doubleToLongBits(this.p1.x);r^=ji.doubleToLongBits(this.p1.y)*31;const s=Math.trunc(r)^Math.trunc(r>>32);return n^s}get interfaces_(){return[d3,Gm]}}class T1{constructor(){T1.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new gA,this._minDistanceLocation=null,this._minDistance=ji.MAX_VALUE,arguments.length===2){const e=arguments[0],n=arguments[1];T1.constructor_.call(this,e,n,0)}else if(arguments.length===3){const e=arguments[0],n=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=n,this._terminateDistance=r}}static distance(e,n){return new T1(e,n).distance()}static isWithinDistance(e,n,r){return e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>r?!1:new T1(e,n,r).distance()<=r}static nearestPoints(e,n){return new T1(e,n).nearestPoints()}computeContainmentDistance(){if(arguments.length===0){const e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(arguments.length===2){const e=arguments[0],n=arguments[1],r=this._geom[e];if(r.getDimension()<2)return null;const s=1-e,u=p5.getPolygons(r);if(u.size()>0){const p=GS.getLocations(this._geom[s]);if(this.computeContainmentDistance(p,u,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[s]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&us(arguments[0],jS)&&us(arguments[1],jS)){const e=arguments[0],n=arguments[1],r=arguments[2];for(let s=0;s<e.size();s++){const u=e.get(s);for(let p=0;p<n.size();p++)if(this.computeContainmentDistance(u,n.get(p),r),this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ec&&arguments[1]instanceof bp){const e=arguments[0],n=arguments[1],r=arguments[2],s=e.getCoordinate();if(_s.EXTERIOR!==this._ptLocator.locate(s,n))return this._minDistance=0,r[0]=e,r[1]=new Ec(n,s),null}}}computeMinDistanceLinesPoints(e,n,r){for(let s=0;s<e.size();s++){const u=e.get(s);for(let p=0;p<n.size();p++){const g=n.get(p);if(this.computeMinDistance(u,g,r),this._minDistance<=this._terminateDistance)return null}}}computeFacetDistance(){const e=new Array(2).fill(null),n=jd.getLines(this._geom[0]),r=jd.getLines(this._geom[1]),s=rb.getPoints(this._geom[0]),u=rb.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(n,u,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance)||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(r,s,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance))return null;e[0]=null,e[1]=null,this.computeMinDistancePoints(s,u,e),this.updateMinDistance(e,!1)}nearestLocations(){return this.computeMinDistance(),this._minDistanceLocation}updateMinDistance(e,n){if(e[0]===null)return null;n?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])}nearestPoints(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}computeMinDistance(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof sc&&arguments[1]instanceof lp){const e=arguments[0],n=arguments[1],r=arguments[2];if(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this._minDistance)return null;const s=e.getCoordinates(),u=n.getCoordinate();for(let p=0;p<s.length-1;p++){const g=Iu.pointToSegment(u,s[p],s[p+1]);if(g<this._minDistance){this._minDistance=g;const E=new ah(s[p],s[p+1]).closestPoint(u);r[0]=new Ec(e,p,E),r[1]=new Ec(n,0,u)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof sc&&arguments[1]instanceof sc){const e=arguments[0],n=arguments[1],r=arguments[2];if(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this._minDistance)return null;const s=e.getCoordinates(),u=n.getCoordinates();for(let p=0;p<s.length-1;p++){const g=new go(s[p],s[p+1]);if(!(g.distance(n.getEnvelopeInternal())>this._minDistance))for(let l=0;l<u.length-1;l++){const E=new go(u[l],u[l+1]);if(g.distance(E)>this._minDistance)continue;const P=Iu.segmentToSegment(s[p],s[p+1],u[l],u[l+1]);if(P<this._minDistance){this._minDistance=P;const O=new ah(s[p],s[p+1]),j=new ah(u[l],u[l+1]),$=O.closestPoints(j);r[0]=new Ec(e,p,$[0]),r[1]=new Ec(n,l,$[1])}if(this._minDistance<=this._terminateDistance)return null}}}}}computeMinDistancePoints(e,n,r){for(let s=0;s<e.size();s++){const u=e.get(s);for(let p=0;p<n.size();p++){const g=n.get(p),l=u.getCoordinate().distance(g.getCoordinate());if(l<this._minDistance&&(this._minDistance=l,r[0]=new Ec(u,0,u.getCoordinate()),r[1]=new Ec(g,0,g.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}}distance(){if(this._geom[0]===null||this._geom[1]===null)throw new yo("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}computeMinDistanceLines(e,n,r){for(let s=0;s<e.size();s++){const u=e.get(s);for(let p=0;p<n.size();p++){const g=n.get(p);if(this.computeMinDistance(u,g,r),this._minDistance<=this._terminateDistance)return null}}}}async function Bae(t,e,n){return new Promise(r=>{t.addLayer({id:"building-bygglett",type:"custom",renderingMode:"3d",onAdd:()=>{const u={obj:`/${n}.glb`,type:"glb",scale:{x:.6,y:.6,z:.6},units:"meters",anchor:"center",rotation:{x:90,y:-90,z:0}};window.tb.loadObj(u,p=>{p.setCoords([e.lat,e.long,e.altitude]),Uae(t,p),jae(t,p),p.addEventListener("ObjectDragged",g=>{mm(g.target,t)},!1),window.tb.add(p),r(p)})},render:()=>{window.tb.update()}})})}function mm(t,e){const n=sA(t);e.getSource("object-area").setData(n);const r=iA(n,50,{units:"meters"}),u=new iN().read(n.geometry),g=e.querySourceFeatures("naturtyper-utvalgte").filter(P=>eN(P.geometry,r));if(g.length){const P=g.map(J=>{const te=new iN().read(J.geometry),ce=new T1(te,u).distance(),Se=D1(ce);return yM(Se,"meters")}),O=Math.min(...P),j=Math.round(O*10)/10,$=()=>j>0?`Du er ${j} meter fra grensen mot Hul Eik`:"Bygget er plassert nrmere enn 15 meter fra stammen",Y=()=>"Kritiske funn",re=()=>{if(j<=0)return"Mulige tiltak"},_e=()=>{if(j<=0)return"Flytt tiltaket vekk fra fareutsatt omrde. Dokumenter tilstrekkelig sikkerhet mot flom og erosjon i henhold til krav gitt i byggteknisk forskrift (TEK17)  7-2."};Gw.dispatch(eR({title:Y(),body:$(),tiltak:re(),tiltakstekst:_e()}))}else Gw.dispatch(eR(!1));const l=g.find(P=>eN(P.geometry,n));let E="green";if(l){const{state:P,tile:O,...j}=l.toJSON();Gw.dispatch(QP(j)),E="red"}else Gw.dispatch(QP(null));e.setPaintProperty("object-area","fill-color",E)}function Uae(t,e){t.addSource("object-area",{type:"geojson",data:sA(e)}),t.addLayer({id:"object-area",type:"fill",source:"object-area",paint:{"fill-color":"green","fill-opacity":.4}})}function jae(t,e){const n=sA(e),r=iA(n,50,{units:"meters"});t.addSource("object-bufferArea",{type:"geojson",data:r}),t.addLayer({id:"object-byfferArea",type:"fill",source:"object-bufferArea",paint:{"fill-color":"blue","fill-opacity":0}})}function Vae(){const{setMap:t,setBuilding:e,location:n,building:r}=Ej(),s=Lt.useRef(!0),u=Lt.useRef(null),p=CO(g=>g.map.dialog);return Lt.useEffect(()=>{if(s.current){s.current=!1;const g=Noe(u.current,n);g.on("style.load",async()=>{const l=await Bae(g,n,r);e(l)}),g.on("click","hul-eik",l=>{var O;const E=(O=l.features[0])==null?void 0:O.properties;if(!E)return;const P=Foe(j=>j.datasett.typeReferanse.kodeverdi===E.utvalgtNaturtypeTekst);if(P!==null){const j=ore(xn.jsx(Goe,{contextType:P}));document.getElementById("drawer").innerHTML+=j}}),t(g)}},[r,n,t]),xn.jsxs("div",{className:cE.mapContainer,children:[xn.jsx("div",{ref:u,className:cE.map}),xn.jsxs("div",{className:cE.infoDrawer,id:"drawer",children:[xn.jsx(Zoe,{}),p!=null?xn.jsxs("div",{className:cE.content,children:[xn.jsxs("h3",{children:[p.title," "]}),xn.jsx("p",{children:p.body}),xn.jsx("strong",{children:p.tiltak}),xn.jsx("p",{children:p.tiltakstekst})]}):null]})]})}const Gae="_sidePanel_14bpg_1",Hae="_mapView_14bpg_6",Wae="_container_14bpg_11",qae="_textbox_14bpg_16",$ae="_staticDialog_14bpg_26",Xae="_nostaticDialog_14bpg_43",N7={sidePanel:Gae,mapView:Hae,container:Wae,textbox:qae,staticDialog:$ae,nostaticDialog:Xae},Zae="_content_1bc25_1",Yae="_btn_1bc25_10",Kae="_reset_1bc25_28",Jae="_up_1bc25_173",Qae="_hidden_1bc25_44",ele="_widthLabel_1bc25_56",tle="_directions_1bc25_61",nle="_arrow_1bc25_68",rle="_rotateOnce_1bc25_104",ile="_rotateTwice_1bc25_107",sle="_rotateThird_1bc25_110",ole="_rotateIcon_1bc25_113",ale="_house3d_1bc25_134",lle="_rotations_1bc25_140",ule="_left_1bc25_157",cle="_right_1bc25_160",hle="_elevations_1bc25_164",dle="_down_1bc25_177",fle="_spm_1bc25_181",ple="_spmIcon_1bc25_184",mle="_textbox_1bc25_192",gle="_showInfo_1bc25_200",yle="_fadein_1bc25_1",_le="_hideInfo_1bc25_226",zs={content:Zae,btn:Yae,reset:Kae,up:Jae,hidden:Qae,widthLabel:ele,directions:tle,arrow:nle,rotateOnce:rle,rotateTwice:ile,rotateThird:sle,rotateIcon:ole,house3d:ale,rotations:lle,left:ule,right:cle,elevations:hle,down:dle,spm:fle,spmIcon:ple,textbox:mle,showInfo:gle,fadein:yle,hideInfo:_le};function vle(){const{location:t,building:e}=PT(),[n,r]=Lt.useState(!1),{map:s,getBuilding:u}=Ej(),p=()=>{r(J=>!J)};function g(){const J=u();J.set({worldTranslate:new v1.THREE.Vector3(.015,0,0)}),mm(J,s)}function l(){const J=u();J.set({worldTranslate:new v1.THREE.Vector3(-.015,0,0)}),mm(J,s)}function E(){const J=u();J.set({worldTranslate:new v1.THREE.Vector3(0,.015,0)}),mm(J,s)}function P(){const J=u();J.set({worldTranslate:new v1.THREE.Vector3(0,-.015,0)}),mm(J,s)}function O(){const J=u();J.set({worldTranslate:new v1.THREE.Vector3(0,0,.05)}),mm(J,s)}function j(){const J=u();J.set({worldTranslate:new v1.THREE.Vector3(0,0,-.05)}),mm(J,s)}function $(){const J=u(),H=pb(J.rotation.z);J.setRotation({z:H+5}),mm(J,s)}function Y(){const J=u(),H=pb(J.rotation.z);J.setRotation({z:H-5}),mm(J,s)}function re(){const J=u();J.setCoords([u5[t].lat,u5[t].long,u5[t].altitude]),J.set({rotation:{x:0,y:0,z:0}}),mm(J,s)}const _e=J=>{var H=J.which||J.KeyCode;switch(console.log(J.keyCode),H){case 37:g();break;case 38:P();break;case 39:l();break;case 40:E();break;case 32:$();break;default:return}};return Lt.useEffect(()=>(document.addEventListener("keydown",_e),()=>document.removeEventListener("keydown",_e)),[_e]),xn.jsxs("div",{className:zs.content,children:[xn.jsxs("div",{className:zs.widthLabel,children:[xn.jsx("label",{htmlFor:"reset",children:"Nullstill visning"}),xn.jsx("button",{onClick:re,id:"reset",className:zs.btn,children:xn.jsx("div",{className:zs.reset})})]}),xn.jsxs("div",{className:zs.directions,children:[xn.jsxs("div",{children:[xn.jsx("label",{className:zs.hidden,htmlFor:"left",children:"Sr"}),xn.jsx("button",{id:"left",onClick:l,className:zs.btn,children:xn.jsx("div",{className:zs.arrow})})]}),xn.jsxs("div",{children:[xn.jsx("label",{className:zs.hidden,htmlFor:"up",children:"Nord"}),xn.jsx("button",{id:"up",onClick:E,className:zs.btn,children:xn.jsx("div",{className:zs.rotateOnce,children:xn.jsx("div",{className:zs.arrow})})})]}),xn.jsxs("div",{children:[xn.jsx("label",{className:zs.hidden,htmlFor:"right",children:"Vest"}),xn.jsx("button",{id:"right",onClick:g,className:zs.btn,children:xn.jsx("div",{className:zs.rotateTwice,children:xn.jsx("div",{className:zs.arrow})})})]}),xn.jsxs("div",{children:[xn.jsx("label",{className:zs.hidden,htmlFor:"down",children:"st"}),xn.jsx("button",{id:"down",onClick:P,className:zs.btn,children:xn.jsx("div",{className:zs.rotateThird,children:xn.jsx("div",{className:zs.arrow})})})]}),xn.jsx("div",{className:zs.house,children:xn.jsx("div",{className:zs.house3d})}),xn.jsx("div",{className:zs.label,children:"Horisontalt"})]}),xn.jsxs("div",{className:zs.rotations,children:[xn.jsx("button",{onClick:$,className:zs.left}),xn.jsx("div",{className:zs.house3d}),xn.jsx("button",{onClick:Y,className:zs.right}),xn.jsx("div",{children:"Rotere"})]}),xn.jsxs("div",{className:zs.elevations,children:[xn.jsx("button",{onClick:O,className:zs.up}),xn.jsx("div",{className:zs.house3d}),xn.jsx("button",{onClick:j,className:zs.down}),xn.jsx("div",{children:"Vertikalt"})]}),xn.jsx("div",{className:zs.spm,onClick:p,children:xn.jsx("div",{className:zs.spmIcon})}),xn.jsx("div",{className:n?zs.showInfo:zs.hideInfo,children:"For  flytte p bygningen i kartet s kan dette ogs gjres med muspeker. Klikk p bygget s det blir grnt, hold shift tasten inne for  flytte horisontalt. Hold ctr tasten inne for  flytte vertikalt og alt tasten inne for  rotere bygget."})]})}function xle(){const{location:t,building:e}=PT(),n=CO(r=>r.map.intersection);return Lt.useEffect(()=>{},[n]),xn.jsx("div",{className:N7.container,children:xn.jsxs(Kee,{location:u5[t],building:e,children:[xn.jsx("div",{className:N7.sidePanel,children:xn.jsx(vle,{})}),xn.jsx("div",{className:N7.mapView,children:xn.jsx(Vae,{})})]})})}const ble="_home_i8hkl_1",wle={home:ble};function Ele(){return xn.jsxs(wa.Container,{children:[xn.jsxs("a",{className:wle.home,href:"/",children:[xn.jsx("svg",{width:"72",height:"64",viewBox:"0 0 576 512",xmlns:"http://www.w3.org/2000/svg",children:xn.jsx("path",{fill:"#000000",d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0M571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93"})}),"Til forsiden"]}),xn.jsx(wa.Header,{children:xn.jsx(bm.Fragment,{children:"Disclaimer"},".0")}),xn.jsxs(wa.Paper,{children:[xn.jsx(wa.Header,{size:3,children:"Ansvarsfraskrivelse for programvaredemonstrasjon"}),xn.jsx("p",{children:"DIBK leverer denne programvaren kun for demonstrasjonsforml. Ved  bruke eller f tilgang til programvaren godtar du  vre bundet av vilkrene og betingelsene som er beskrevet i denne ansvarsfraskrivelsen. Denne programvaren er ikke ment for bruk som dokumentasjon for byggesknader."}),xn.jsx("pre",{children:"Oppdatert 13.12.2023"}),xn.jsx(wa.Header,{size:5,children:" Hensikt"}),"Denne programvaren er utformet utelukkende for demonstrasjons- og pedagogiske forml. Den er ikke ment  tjene som dokumentasjon for byggeapplikasjoner, og brukere br ikke stole p den for slike forml.",xn.jsx(wa.Header,{size:5,children:"Begrenset funksjonalitet"}),"Funksjonene og funksjonene til denne programvaren under demonstrasjonen kan vre begrenset og representerer ikke de fullstendige egenskapene til sluttproduktet. Den er ikke egnet for konstruksjonsdokumentasjon eller noen kritiske applikasjoner. Bygglett 3.0 fraskriver seg ethvert ansvar for eventuelle feil, mangler eller unyaktigheter i kartdataene eller kartlagene.",xn.jsx(wa.Header,{size:5,children:"Ingen garanti"}),'Denne programvaren leveres "som den er"  og uten noen form for garanti, enten det er uttrykkelig eller underforsttt. DIBK gir ingen representasjoner eller garantier angende nyaktigheten, fullstendigheten eller pliteligheten til programvaren for konstruksjonsdokumentasjon.',xn.jsx(wa.Header,{size:5,children:"Brukeransvar"}),"Brukere er eneansvarlig for  verifisere all informasjon innhentet fra programvaren og for  ske profesjonell rdgivning skreddersydd for deres spesifikke behov. Denne programvaren erstatter ikke profesjonell vurdering i byggedokumentasjon. Brukeren er ansvarlig for  tolke og bruke kartinformasjonen p egen risiko. Bygglett 3.0 ptar seg ikke ansvar for eventuelle skader eller tap som flge av brukerens handlinger basert p kartdataene.",xn.jsx(wa.Header,{size:5,children:"Ikke for operativ bruk"}),"Denne programvaren skal ikke under noen omstendigheter brukes til drifts- eller produksjonsforml relatert til byggeapplikasjoner. Det er ikke en erstatning for industristandard dokumentasjonspraksis og verkty. DIBK forbeholder seg retten til  endre eller oppdatere kartene, kartlagene eller programvaren uten forhndsvarsel. Det er brukerens ansvar  holde seg oppdatert om eventuelle endringer.",xn.jsx(wa.Header,{size:5,children:"Ansvarsbegrensning"}),"DIBK skal ikke holdes ansvarlig for noen direkte, indirekte, tilfeldige, spesielle eller flgeskader som oppstr som flge av bruk eller manglende evne til  bruke denne programvaren, selv om det er gjort oppmerksom p muligheten for slike skader. Kartene og kartlagene som tilbys i Bygglett 3.0 er kun ment for generell informasjon og veiledning. Det er viktig  presisere at kartdata kan vre unyaktige eller foreldede. Bygglett 3.0 kan inneholde lenker til tredjeparts nettsteder eller tjenester. DIBK ptar seg ikke ansvar for innholdet eller personvernpraksisen til slike nettsteder eller tjenester.",xn.jsx(wa.Header,{size:5,children:"Aksept av vilkr"}),"Ved  bruke denne programvaren, erkjenner du at du har lest, forsttt og godtatt vilkrene og betingelsene som er beskrevet i denne ansvarsfraskrivelsen. Hvis du ikke er enig i disse vilkrene, vennligst avst fra  bruke programvaren.",xn.jsx(wa.Header,{size:5,children:"Endringer"}),"DIBK forbeholder seg retten til  endre eller oppdatere denne ansvarsfraskrivelsen nr som helst uten varsel. Brukere oppfordres til  gjennomg denne ansvarsfraskrivelsen regelmessig for eventuelle endringer. Ved  bruke denne programvaren godtar du og godtar  overholde vilkrene og betingelsene i denne ansvarsfraskrivelsen. Hvis du har sprsml eller bekymringer, vennligst kontakt DIBK for avklaring."]}),xn.jsx(wa.ContentBox,{color:"lightCyan",title:"Kilder",children:xn.jsxs(bm.Fragment,{children:[xn.jsxs("ul",{children:[xn.jsx("li",{children:"Geonorge - www.geonorge.no "}),xn.jsx("li",{children:"Open street map - www.openstreetmap.org"})]}),xn.jsxs("p",{children:["Lsningen er utviklet av Arkitektum AS - ",xn.jsx("a",{href:"http://www.arkitektum.no",children:"Arkitektum AS"})]})]},".0")})]})}const Sle=dF([{id:"root",element:xn.jsx(Zee,{}),children:[{path:"/",element:xn.jsx(Yee,{}),index:!0},{path:"/kart/:location/:building",element:xn.jsx(xle,{}),index:!0},{path:"/disclaimer",element:xn.jsx(Ele,{}),index:!0},{path:"*",loader:()=>mC("/")}]}],{basename:"/bygglett-3.0-mapbox"}),Tle=document.getElementById("root");D7.createRoot(Tle).render(xn.jsx(bm.StrictMode,{children:xn.jsx(PX,{store:Gw,children:xn.jsx(pF,{router:Sle})})}));
